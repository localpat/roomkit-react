{
  "version": 3,
  "sources": ["<define:process.env>", "../../../node_modules/lodash/lodash.js", "../../../node_modules/ua-parser-js/src/ua-parser.js", "../../../node_modules/lodash.isequal/index.js", "../../../node_modules/sdp/sdp.js", "../../../node_modules/sdp-transform/lib/grammar.js", "../../../node_modules/sdp-transform/lib/parser.js", "../../../node_modules/sdp-transform/lib/writer.js", "../../../node_modules/sdp-transform/lib/index.js", "../../../node_modules/prop-types/node_modules/react-is/cjs/react-is.production.min.js", "../../../node_modules/prop-types/node_modules/react-is/cjs/react-is.development.js", "../../../node_modules/prop-types/node_modules/react-is/index.js", "../../../node_modules/object-assign/index.js", "../../../node_modules/prop-types/lib/ReactPropTypesSecret.js", "../../../node_modules/prop-types/lib/has.js", "../../../node_modules/prop-types/checkPropTypes.js", "../../../node_modules/prop-types/factoryWithTypeCheckers.js", "../../../node_modules/prop-types/factoryWithThrowingShims.js", "../../../node_modules/prop-types/index.js", "../src/index.ts", "../src/Button/index.tsx", "../src/Button/Button.tsx", "../src/Layout/index.tsx", "../src/Layout/Flex.tsx", "../src/Theme/stitches.config.ts", "../src/Theme/base.config.ts", "../src/Prebuilt/common/constants.ts", "../src/Theme/ThemeProvider.tsx", "../src/Theme/useSSR.tsx", "../src/Layout/Box.tsx", "../src/Loading/index.ts", "../src/Loading/Loading.tsx", "../src/utils/styles.ts", "../src/Text/index.tsx", "../src/Text/Text.tsx", "../src/IconButton/index.tsx", "../src/IconButton/IconButton.tsx", "../src/Avatar/index.ts", "../src/Avatar/Avatar.tsx", "../src/Avatar/getAvatarBg.ts", "../src/Divider/index.ts", "../src/Divider/Divider.tsx", "../src/Switch/index.ts", "../src/Switch/Switch.tsx", "../src/Tooltip/index.ts", "../src/Tooltip/Tooltip.tsx", "../src/utils/animations.ts", "../src/Select/index.ts", "../src/Select/Select.tsx", "../src/Slider/index.ts", "../src/Slider/Slider.tsx", "../src/Modal/index.ts", "../src/Modal/Dialog.tsx", "../src/Modal/DialogContent.tsx", "../src/hooks/useDialogContainerSelector.tsx", "../src/context/DialogContext.tsx", "../src/Input/Input.tsx", "../src/VideoTile/index.tsx", "../src/VideoTile/StyledVideoTile.tsx", "../src/VideoList/index.tsx", "../src/VideoList/videoListUtils.tsx", "../src/VideoList/StyledVideoList.tsx", "../src/Pagination/index.tsx", "../src/Pagination/StyledPagination.tsx", "../src/Dropdown/Dropdown.tsx", "../src/Video/index.tsx", "../src/Video/Video.tsx", "../src/TileMenu/index.tsx", "../src/TileMenu/StyledMenuTile.tsx", "../src/AudioLevel/index.ts", "../src/AudioLevel/useBorderAudioLevel.tsx", "../src/AudioLevel/AudioLevel.tsx", "../src/Popover/index.tsx", "../src/Stats/index.tsx", "../src/Stats/Stats.tsx", "../src/Stats/formatBytes.ts", "../src/Stats/StyledStats.tsx", "../src/Stats/useQoE.ts", "../src/Checkbox/Checkbox.tsx", "../src/Label/Label.tsx", "../src/RadioGroup/RadioGroup.tsx", "../src/Toast/Toast.tsx", "../src/Accordion/index.ts", "../src/Accordion/Accordion.tsx", "../src/Fieldset/Fieldset.tsx", "../src/Footer/index.tsx", "../src/Footer/Footer.tsx", "../src/ReactSelect/index.ts", "../src/ReactSelect/ReactSelect.tsx", "../src/Tabs/Tabs.tsx", "../src/QRCode/QRCode.tsx", "../src/Link/index.tsx", "../src/Link/Link.tsx", "../src/Collapsible/Collapsible.tsx", "../src/Prebuilt/App.tsx", "../src/Prebuilt/components/AppData/AppData.tsx", "../src/Prebuilt/components/Settings/LayoutSettings.tsx", "../src/Prebuilt/components/Settings/SwitchWithLabel.tsx", "../src/Prebuilt/components/AppData/useUISettings.js", "../src/Prebuilt/components/hooks/useUserPreferences.jsx", "../src/Prebuilt/components/Settings/common.ts", "../src/Prebuilt/provider/roomLayoutProvider/hooks/useRoomLayoutScreen.ts", "../src/Prebuilt/provider/roomLayoutProvider/index.tsx", "../src/Prebuilt/provider/roomLayoutProvider/hooks/useFetchRoomLayout.ts", "../src/Prebuilt/provider/roomLayoutProvider/constants/index.ts", "../src/Prebuilt/common/utils.js", "../src/Prebuilt/components/AppData/useSidepane.js", "../src/Prebuilt/components/MoreSettings/constants.ts", "../src/Prebuilt/components/AuthToken.tsx", "../src/Prebuilt/AppContext.tsx", "../src/Prebuilt/AppStateContext.tsx", "../src/Prebuilt/components/VirtualBackground/VBHandler.tsx", "../src/Prebuilt/components/hooks/useRedirectToLeave.tsx", "../src/Prebuilt/components/PIP/PIPManager.ts", "../src/Prebuilt/components/PIP/pipUtils.js", "../src/Prebuilt/components/Toast/ToastManager.js", "../src/Prebuilt/components/ConferenceScreen.tsx", "../src/Prebuilt/components/Footer/Footer.tsx", "../src/Prebuilt/components/AudioVideoToggle.tsx", "../src/Prebuilt/components/IconButtonWithOptions/IconButtonWithOptions.tsx", "../src/Prebuilt/IconButton.tsx", "../src/Prebuilt/components/MoreSettings/ActionTile.jsx", "../src/Prebuilt/components/Settings/SettingsModal.jsx", "../src/Sheet/index.ts", "../src/Sheet/Sheet.tsx", "../src/Prebuilt/components/Settings/DeviceSettings.jsx", "../src/Prebuilt/primitives/DropdownTrigger.jsx", "../src/Prebuilt/components/hooks/useAudioOutputTest.tsx", "../src/Prebuilt/components/hooks/useDropdownSelection.jsx", "../src/Prebuilt/components/Settings/NotificationSettings.tsx", "../src/Prebuilt/components/CaptionIcon.tsx", "../src/Prebuilt/components/EmojiReaction.jsx", "../src/Prebuilt/components/Footer/EmojiCard.jsx", "../src/Prebuilt/components/hooks/useDropdownList.ts", "../src/Prebuilt/common/hooks.ts", "../src/Prebuilt/components/Leave/LeaveRoom.tsx", "../src/Prebuilt/components/Leave/DesktopLeaveRoom.tsx", "../src/Prebuilt/components/Leave/EndSessionContent.tsx", "../src/Prebuilt/components/Leave/LeaveAtoms.tsx", "../src/Prebuilt/components/Leave/LeaveCard.tsx", "../src/Prebuilt/components/Leave/LeaveSessionContent.tsx", "../src/Prebuilt/components/Leave/MwebLeaveRoom.tsx", "../src/Prebuilt/components/MoreSettings/MoreSettings.tsx", "../src/Prebuilt/components/MoreSettings/SplitComponents/DesktopOptions.tsx", "../src/Prebuilt/components/PIP/index.jsx", "../src/Prebuilt/components/PIP/PIPComponent.tsx", "../src/Prebuilt/components/PIP/SetupMediaSession.js", "../src/Prebuilt/components/PIP/PIPChat.tsx", "../src/TextArea/index.tsx", "../src/TextArea/TextArea.tsx", "../src/Prebuilt/components/Chat/ChatBody.tsx", "../src/Prebuilt/components/Chat/ChatActions.tsx", "../src/Prebuilt/components/Chat/MwebChatOption.tsx", "../src/Prebuilt/components/hooks/useChatBlacklist.ts", "../src/Prebuilt/components/hooks/usePinnedMessages.ts", "../src/Prebuilt/components/Chat/EmptyChat.tsx", "../src/Prebuilt/components/hooks/usePinnedBy.tsx", "../src/Prebuilt/components/Chat/utils.ts", "../src/Prebuilt/components/PIP/PIPChatOption.tsx", "../src/Prebuilt/components/PIP/PIPWindow.tsx", "../src/Prebuilt/components/RoleChangeModal.tsx", "../src/Prebuilt/components/Settings/StartRecording.jsx", "../src/Prebuilt/components/Streaming/ResolutionInput.jsx", "../src/Prebuilt/primitives/DialogContent.jsx", "../src/Prebuilt/components/StatsForNerds.jsx", "../src/Prebuilt/components/MoreSettings/BulkRoleChangeModal.jsx", "../src/Prebuilt/components/MoreSettings/CaptionModal.tsx", "../src/Prebuilt/components/MoreSettings/CaptionContent.tsx", "../src/Prebuilt/components/MoreSettings/FullScreenItem.tsx", "../src/Prebuilt/components/hooks/useFullscreen.ts", "../src/Prebuilt/components/MoreSettings/MuteAllModal.tsx", "../src/Prebuilt/components/MoreSettings/MuteAllContent.tsx", "../src/Prebuilt/components/hooks/useMetadata.tsx", "../src/Prebuilt/components/PIP/usePIPChat.tsx", "../src/Prebuilt/components/PIP/usePIPWindow.tsx", "../src/Prebuilt/components/PIP/context.ts", "../src/Prebuilt/components/MoreSettings/SplitComponents/MwebOptions.tsx", "../src/Prebuilt/components/Header/StreamActions.tsx", "../../../node_modules/reselect/es/index.js", "../../hms-video-store/package.json", "../../hms-video-store/src/schema/room.ts", "../../hms-video-store/src/schema/schema.ts", "../../hms-video-store/src/schema/message.ts", "../../hms-video-store/src/schema/notification.ts", "../../hms-video-store/src/schema/playlist.ts", "../../hms-video-store/src/selectors/selectors.ts", "../../hms-video-store/src/selectors/selectorUtils.ts", "../../hms-video-store/src/utils/logger.ts", "../../hms-video-store/src/media/streams/HMSMediaStream.ts", "../../hms-video-store/src/utils/support.ts", "../../hms-video-store/src/analytics/AnalyticsEvent.ts", "../../hms-video-store/src/analytics/AnalyticsEventDomains.ts", "../../hms-video-store/src/analytics/domain-analytics.ts", "../../hms-video-store/src/utils/analytics-deviceId.ts", "../../hms-video-store/src/error/ErrorCodes.ts", "../../hms-video-store/src/error/HMSException.ts", "../../hms-video-store/src/signal/jsonrpc/models.ts", "../../hms-video-store/src/error/ErrorFactory.ts", "../../hms-video-store/src/utils/local-storage-polyfill.ts", "../../hms-video-store/src/utils/local-storage.ts", "../../hms-video-store/src/utils/validations.ts", "../../hms-video-store/src/utils/user-agent.ts", "../../hms-video-store/src/analytics/AnalyticsEventFactory.ts", "../../hms-video-store/src/utils/json.ts", "../../hms-video-store/src/media/tracks/HMSTrack.ts", "../../hms-video-store/src/media/tracks/HMSAudioTrack.ts", "../../hms-video-store/src/media/tracks/HMSLocalAudioTrack.ts", "../../hms-video-store/src/device-manager/DeviceStorage.ts", "../../hms-video-store/src/plugins/audio/HMSAudioPlugin.ts", "../../hms-video-store/src/analytics/MediaPluginsAnalyticsFactory.ts", "../../hms-video-store/src/plugins/audio/AudioPluginsAnalytics.ts", "../../hms-video-store/src/plugins/audio/HMSAudioPluginsManager.ts", "../../hms-video-store/src/error/utils.ts", "../../hms-video-store/src/utils/track.ts", "../../hms-video-store/src/utils/media.ts", "../../hms-video-store/src/utils/queue.ts", "../../hms-video-store/src/utils/timer-utils.ts", "../../hms-video-store/src/utils/track-audio-level-monitor.ts", "../../hms-video-store/src/interfaces/peer/hms-peer.ts", "../../hms-video-store/src/interfaces/room.ts", "../../hms-video-store/src/interfaces/simulcast-layers.ts", "../../hms-video-store/src/interfaces/track-settings.ts", "../../hms-video-store/src/interfaces/devices.ts", "../../hms-video-store/src/media/settings/HMSAudioTrackSettings.ts", "../../hms-video-store/src/media/settings/HMSVideoTrackSettings.ts", "../../hms-video-store/src/media/settings/HMSTrackSettings.ts", "../../hms-video-store/src/media/tracks/HMSRemoteAudioTrack.ts", "../../hms-video-store/src/media/tracks/HMSVideoTrack.ts", "../../hms-video-store/src/media/tracks/HMSLocalVideoTrack.ts", "../../hms-video-store/src/media/tracks/VideoElementManager.ts", "../../hms-video-store/src/media/tracks/trackUtils.ts", "../../hms-video-store/src/utils/intersection-observer.ts", "../../hms-video-store/src/utils/resize-observer.ts", "../../hms-video-store/src/plugins/video/HMSVideoPlugin.ts", "../../hms-video-store/src/utils/math.ts", "../../hms-video-store/src/plugins/video/VideoPluginsAnalytics.ts", "../../hms-video-store/src/plugins/video/HMSVideoPluginsManager.ts", "../../hms-video-store/src/plugins/video/HMSMediaStreamPluginsManager.ts", "../../hms-video-store/src/sdk/LocalTrackManager.ts", "../../hms-video-store/src/analytics/AnalyticsTimer.ts", "../../hms-video-store/src/utils/constants.ts", "../../hms-video-store/src/media/tracks/HMSRemoteVideoTrack.ts", "../../hms-video-store/src/media/streams/HMSLocalStream.ts", "../../hms-video-store/src/media/streams/HMSRemoteStream.ts", "../../hms-video-store/src/rtc-stats/utils.ts", "../../hms-video-store/src/rtc-stats/HMSWebrtcStats.ts", "../../hms-video-store/src/rtc-stats/HMSWebrtcInternals.ts", "../../hms-video-store/src/sdk/models/peer/HMSPeer.ts", "../../hms-video-store/src/utils/id-factory.ts", "../../hms-video-store/src/sdk/models/peer/HMSLocalPeer.ts", "../../hms-video-store/src/sdk/models/peer/HMSRemotePeer.ts", "../../hms-video-store/src/notification-manager/managers/utils.ts", "../../hms-video-store/src/sdk/HMSPeerListIterator.ts", "../../hms-video-store/src/playlist-manager/AudioContextManager.ts", "../../hms-video-store/src/utils/typed-event-emitter.ts", "../../hms-video-store/src/playlist-manager/PlaylistAudioManager.ts", "../../hms-video-store/src/playlist-manager/PlaylistVideoManager.ts", "../../hms-video-store/src/playlist-manager/PlaylistManager.ts", "../../hms-video-store/src/selectors/playlistselectors.ts", "../../hms-video-store/src/selectors/selectorsByID.ts", "../../hms-video-store/src/selectors/common.ts", "../../hms-video-store/src/common/ui-logger.ts", "../../hms-video-store/src/selectors/derivedSelectors.ts", "../../hms-video-store/src/selectors/selectorsByReference.ts", "../../hms-video-store/src/reactive-store/HMSReactiveStore.ts", "../../hms-video-store/src/reactive-store/HMSNotifications.ts", "../../hms-video-store/src/reactive-store/common/mapping.ts", "../../hms-video-store/src/reactive-store/sdkUtils/ActionBatcher.ts", "../../hms-video-store/src/reactive-store/sdkUtils/sdkUtils.ts", "../../hms-video-store/src/reactive-store/sdkUtils/storeMergeUtils.ts", "../../hms-video-store/src/reactive-store/adapter.ts", "../../hms-video-store/src/reactive-store/HMSPlaylist.ts", "../../hms-video-store/src/reactive-store/HMSSessionStore.ts", "../../hms-video-store/src/controller/beam/BeamSpeakerLabelsLogger.ts", "../../hms-video-store/src/diagnostics/constants.ts", "../../hms-video-store/src/diagnostics/CQSCalculator.ts", "../../hms-video-store/src/diagnostics/DiagnosticsStatsCollector.ts", "../../hms-video-store/src/diagnostics/interfaces.ts", "../../hms-video-store/src/diagnostics/ConnectivityCheck.ts", "../../hms-video-store/src/sdk/models/HMSRoom.ts", "../../hms-video-store/src/utils/fetch.ts", "../../hms-video-store/src/diagnostics/HMSDiagnostics.ts", "../../hms-video-store/src/reactive-store/HMSSDKActions.ts", "../../hms-video-store/src/common/storeName.ts", "../../hms-video-store/src/sdk/NetworkTestManager.ts", "../../hms-video-store/src/sdk/RoleChangeManager.ts", "../../hms-video-store/src/analytics/HTTPAnalyticsTransport.ts", "../../hms-video-store/src/notification-manager/HMSNotifications.ts", "../../hms-video-store/src/sdk/store/Store.ts", "../../hms-video-store/src/sdk/WakeLockManager.ts", "../../hms-video-store/src/analytics/AnalyticsEventsService.ts", "../../hms-video-store/src/audio-sink-manager/AudioSinkManager.ts", "../../hms-video-store/src/common/PluginUsageTracker.ts", "../../hms-video-store/src/device-manager/DeviceManager.ts", "../../hms-video-store/src/device-manager/AudioOutputManager.ts", "../../hms-video-store/src/end-call-feedback/feedback.ts", "../../hms-video-store/src/events/EventBus.ts", "../../hms-video-store/src/events/HMSInternalEvent.ts", "../../hms-video-store/src/notification-manager/managers/ActiveSpeakerManager.ts", "../../hms-video-store/src/notification-manager/managers/BroadcastManager.ts", "../../hms-video-store/src/notification-manager/managers/ConnectionQualityManager.ts", "../../hms-video-store/src/notification-manager/managers/TrackManager.ts", "../../hms-video-store/src/notification-manager/managers/onDemandTrackManager.ts", "../../hms-video-store/src/notification-manager/managers/PeerListManager.ts", "../../hms-video-store/src/utils/date.ts", "../../hms-video-store/src/notification-manager/managers/PeerManager.ts", "../../hms-video-store/src/notification-manager/managers/PolicyChangeManager.ts", "../../hms-video-store/src/utils/whiteboard.ts", "../../hms-video-store/src/session-store/interactivity-center/HMSWhiteboardCenter.ts", "../../hms-video-store/src/session-store/interactivity-center/HMSInteractivityCenter.ts", "../../hms-video-store/src/notification-manager/managers/PollsManager.ts", "../../hms-video-store/src/notification-manager/managers/RequestManager.ts", "../../hms-video-store/src/notification-manager/managers/RoomUpdateManager.ts", "../../hms-video-store/src/notification-manager/managers/SessionMetadataManager.ts", "../../hms-video-store/src/notification-manager/managers/WhiteboardManager.ts", "../../hms-video-store/src/notification-manager/NotificationManager.ts", "../../hms-video-store/src/session-store/index.ts", "../../hms-video-store/src/transport/models/JoinParameters.ts", "../../hms-video-store/src/transport/models/TransportFailureCategory.ts", "../../hms-video-store/src/transport/models/TransportState.ts", "../../hms-video-store/src/utils/promise.ts", "../../hms-video-store/src/transport/RetryScheduler.ts", "../../hms-video-store/src/analytics/signal-transport/LocalStoageEvents.ts", "../../hms-video-store/src/analytics/AnalyticsTransport.ts", "../../hms-video-store/src/analytics/signal-transport/SignalAnalyticsTransport.ts", "../../hms-video-store/src/analytics/stats/BaseStatsAnalytics.ts", "../../hms-video-store/src/analytics/stats/PublishStatsAnalytics.ts", "../../hms-video-store/src/analytics/stats/SubscribeStatsAnalytics.ts", "../../hms-video-store/src/connection/model.ts", "../../hms-video-store/src/utils/session-description.ts", "../../hms-video-store/src/connection/HMSConnection.ts", "../../hms-video-store/src/connection/publish/publishConnection.ts", "../../hms-video-store/src/connection/subscribe/subscribeConnection.ts", "../../hms-video-store/src/connection/HMSDataChannel.ts", "../../hms-video-store/src/utils/ice-server-config.ts", "../../hms-video-store/src/signal/init/index.ts", "../../hms-video-store/src/signal/jsonrpc/index.ts", "../../hms-video-store/src/utils/network-info.ts", "../../hms-video-store/src/transport/index.ts", "../../hms-video-store/src/utils/jwt.ts", "../../hms-video-store/src/sdk/index.ts", "../../hms-video-store/src/webrtc-stats/webrtc-stats-store.ts", "../../hms-video-store/src/webrtc-stats/HMSStats.ts", "../../hms-video-store/src/webrtc-stats/selectors.ts", "../../../node_modules/webrtc-adapter/src/js/adapter_core.js", "../../../node_modules/webrtc-adapter/src/js/adapter_factory.js", "../../../node_modules/webrtc-adapter/src/js/utils.js", "../../../node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js", "../../../node_modules/webrtc-adapter/src/js/chrome/getusermedia.js", "../../../node_modules/webrtc-adapter/src/js/chrome/getdisplaymedia.js", "../../../node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js", "../../../node_modules/webrtc-adapter/src/js/firefox/getusermedia.js", "../../../node_modules/webrtc-adapter/src/js/firefox/getdisplaymedia.js", "../../../node_modules/webrtc-adapter/src/js/safari/safari_shim.js", "../../../node_modules/webrtc-adapter/src/js/common_shim.js", "../src/Prebuilt/components/MoreSettings/ChangeNameModal.tsx", "../src/Prebuilt/components/MoreSettings/ChangeNameContent.tsx", "../src/Prebuilt/components/AppData/useSheet.ts", "../src/Prebuilt/components/hooks/useUnreadPollQuizPresent.tsx", "../src/Prebuilt/components/RaiseHand.tsx", "../src/Prebuilt/components/ScreenShareToggle.jsx", "../src/Prebuilt/components/pdfAnnotator/shareScreenOptions.jsx", "../src/Prebuilt/components/ShareMenuIcon.jsx", "../src/Prebuilt/components/pdfAnnotator/pdfFileOptions.jsx", "../src/Prebuilt/components/pdfAnnotator/pdfHeader.jsx", "../src/Prebuilt/components/pdfAnnotator/submitPdf.jsx", "../src/Prebuilt/components/pdfAnnotator/uploadedFile.jsx", "../src/Prebuilt/components/pdfAnnotator/pdfInfo.jsx", "../src/Prebuilt/components/VirtualBackground/VBToggle.tsx", "../src/Prebuilt/components/Footer/ChatToggle.tsx", "../src/Prebuilt/components/Footer/ParticipantList.tsx", "../src/Prebuilt/components/Connection/ConnectionIndicator.tsx", "../src/Prebuilt/components/Connection/connectionQualityUtils.js", "../src/Prebuilt/components/RemoveParticipant.tsx", "../src/Prebuilt/components/Footer/RoleAccordion.tsx", "../src/Prebuilt/components/Footer/RoleOptions.tsx", "../src/Prebuilt/components/hooks/useGroupOnStageActions.tsx", "../src/Prebuilt/components/AppData/useSidepaneResetOnLayoutUpdate.tsx", "../src/Prebuilt/components/hooks/usePeerOnStageActions.tsx", "../src/Prebuilt/components/Footer/PollsToggle.tsx", "../src/Prebuilt/components/Footer/WhiteboardToggle.tsx", "../src/Prebuilt/components/Notifications/HLSFailureModal.tsx", "../src/Prebuilt/components/RoleChangeRequest/RoleChangeRequestModal.tsx", "../src/Prebuilt/components/Preview/PreviewJoin.tsx", "../src/Prebuilt/layouts/SidePane.tsx", "../src/Prebuilt/components/Polls/Polls.tsx", "../src/Prebuilt/components/Polls/CreatePollQuiz/PollsQuizMenu.tsx", "../src/Prebuilt/components/Streaming/Common.jsx", "../src/Prebuilt/components/Polls/common/StatusIndicator.tsx", "../src/Prebuilt/components/Polls/CreateQuestions/CreateQuestions.jsx", "../src/Prebuilt/components/Polls/CreateQuestions/QuestionForm.tsx", "../src/Prebuilt/components/Polls/CreateQuestions/DeleteQuestionModal.tsx", "../src/Prebuilt/components/Polls/common/Line.tsx", "../src/Prebuilt/components/Polls/common/MultipleChoiceOptions.jsx", "../src/Prebuilt/components/Polls/common/OptionInputWithDelete.tsx", "../src/Prebuilt/components/Polls/common/VoteCount.tsx", "../src/Prebuilt/components/Polls/common/VoteProgress.tsx", "../src/Prebuilt/components/Polls/common/SingleChoiceOptions.jsx", "../src/Prebuilt/components/Polls/CreateQuestions/SavedQuestion.tsx", "../src/Prebuilt/components/Polls/Voting/LeaderboardSummary.tsx", "../src/Prebuilt/components/Polls/Voting/LeaderboardEntry.tsx", "../src/Prebuilt/components/Polls/common/utils.ts", "../src/Prebuilt/components/Polls/Voting/PeerParticipationSummary.tsx", "../src/Prebuilt/components/Polls/Voting/StatisticBox.tsx", "../src/Prebuilt/components/Polls/Voting/useQuizSummary.tsx", "../src/Prebuilt/components/Polls/Voting/Voting.tsx", "../src/Prebuilt/components/Polls/Voting/StandardVoting.tsx", "../src/Prebuilt/components/Polls/Voting/QuestionCard.jsx", "../src/Prebuilt/components/Polls/Voting/TimedVoting.tsx", "../src/Prebuilt/components/RoomDetails/RoomDetailsPane.tsx", "../src/Prebuilt/components/Header/HeaderComponents.jsx", "../src/Prebuilt/components/RoomDetails/RoomDetailsRow.tsx", "../src/Prebuilt/components/RoomDetails/Duration.tsx", "../src/Prebuilt/components/SidePaneTabs.tsx", "../src/Prebuilt/components/Chat/Chat.tsx", "../src/Prebuilt/components/Chat/ChatFooter.tsx", "../src/Prebuilt/components/Chat/ChatSelectorContainer.tsx", "../src/Prebuilt/components/Chat/ChatSelector.tsx", "../src/Prebuilt/components/AppData/useChatState.js", "../src/Prebuilt/components/Chat/useEmojiPickerStyles.js", "../src/Prebuilt/components/Chat/ChatStates.tsx", "../src/Prebuilt/components/Chat/PinnedMessage.tsx", "../src/Prebuilt/components/Chat/ArrowNavigation.tsx", "../src/Prebuilt/components/Chat/StickIndicator.tsx", "../src/Prebuilt/components/Footer/PaginatedParticipants.tsx", "../src/Prebuilt/components/ChatSettings.tsx", "../src/Prebuilt/components/VideoTile.tsx", "../src/Prebuilt/components/Connection/TileConnection.tsx", "../src/Prebuilt/components/TileMenu/TileMenu.tsx", "../src/Prebuilt/components/TileMenu/TileMenuContent.tsx", "../src/Prebuilt/components/TileMenu/utils.ts", "../src/Prebuilt/components/peerTileUtils.jsx", "../src/Prebuilt/components/VirtualBackground/VBPicker.tsx", "../src/Prebuilt/components/VirtualBackground/VBCollection.tsx", "../src/Prebuilt/components/VirtualBackground/VBOption.tsx", "../src/Prebuilt/components/Chip.tsx", "../src/Prebuilt/components/FullPageProgress.tsx", "../src/Prebuilt/components/Preview/PreviewForm.tsx", "../src/Prebuilt/components/RoleChangeRequest/RequestPrompt.tsx", "../src/Prebuilt/layouts/VideoStreamingSection.tsx", "../src/Prebuilt/components/VideoLayouts/GridLayout.tsx", "../src/Prebuilt/components/VideoLayouts/EqualProminence.tsx", "../src/Prebuilt/layouts/WaitingView.tsx", "../src/Prebuilt/components/InsetTile.tsx", "../src/Prebuilt/components/hooks/useVideoTileLayout.ts", "../src/Prebuilt/components/Pagination.tsx", "../src/Prebuilt/components/VideoLayouts/Grid.tsx", "../src/Prebuilt/components/hooks/useTileLayout.tsx", "../src/Prebuilt/components/VideoLayouts/RoleProminence.tsx", "../src/Prebuilt/components/SecondaryTiles.tsx", "../src/Prebuilt/components/VideoLayouts/ProminenceLayout.tsx", "../src/Prebuilt/components/hooks/useRoleProminencePeers.tsx", "../src/Prebuilt/components/VideoLayouts/ScreenshareLayout.tsx", "../src/Prebuilt/components/ScreenshareTile.tsx", "../src/Prebuilt/components/LayoutModeSelector.tsx", "../src/Prebuilt/components/ScreenshareDisplay.tsx", "../src/Prebuilt/components/VideoLayouts/WhiteboardLayout.tsx", "../src/Prebuilt/common/PeersSorter.ts", "../src/Prebuilt/layouts/EmbedView.jsx", "../src/Prebuilt/layouts/PDFView.jsx", "../src/Prebuilt/plugins/CaptionsViewer.tsx", "../src/Prebuilt/components/hooks/useCloseScreenshareWhiteboard.tsx", "../src/Prebuilt/components/Header/index.tsx", "../src/Prebuilt/components/Header/Header.tsx", "../src/Prebuilt/components/Header/RoomDetailsHeader.tsx", "../src/Prebuilt/components/Header/common.jsx", "../src/Prebuilt/components/PreviousRoleInMetadata.tsx", "../src/Prebuilt/components/ErrorBoundary.jsx", "../src/Prebuilt/components/init/Init.jsx", "../src/Prebuilt/services/FeatureFlags.jsx", "../src/Prebuilt/components/Input/KeyboardInputManager.js", "../src/Prebuilt/components/LeaveScreen.tsx", "../src/Prebuilt/components/EndCallFeedback/Feedback.tsx", "../src/Prebuilt/components/EndCallFeedback/FeedbackForm.tsx", "../src/Prebuilt/components/EndCallFeedback/ThankyouView.tsx", "../src/Prebuilt/components/MwebLandscapePrompt.tsx", "../src/Prebuilt/components/Notifications/index.tsx", "../src/Prebuilt/components/Notifications/Notifications.tsx", "../src/Prebuilt/components/Notifications/AutoplayBlockedModal.tsx", "../src/Prebuilt/components/Notifications/ChatNotifications.tsx", "../src/Prebuilt/components/Notifications/HandRaisedNotifications.tsx", "../src/Prebuilt/components/Toast/ToastBatcher.js", "../src/Prebuilt/components/Toast/ToastConfig.jsx", "../src/Prebuilt/components/Notifications/InitErrorModal.tsx", "../src/Prebuilt/components/Notifications/PeerNotifications.tsx", "../src/Prebuilt/components/Notifications/PermissionErrorModal.tsx", "../src/Prebuilt/components/Notifications/ReconnectNotifications.tsx", "../src/Prebuilt/components/Notifications/TrackBulkUnmuteModal.tsx", "../src/Prebuilt/components/Notifications/TrackNotifications.tsx", "../src/Prebuilt/components/Notifications/TrackUnmuteModal.tsx", "../src/Prebuilt/components/Notifications/TranscriptionNotifications.tsx", "../src/Prebuilt/components/PIP/PIPProvider.tsx", "../src/Prebuilt/components/Preview/PreviewScreen.tsx", "../src/Prebuilt/components/Toast/ToastContainer.jsx", "../src/Prebuilt/components/Toast/Toast.jsx", "../src/Prebuilt/layouts/Sheet.tsx", "../src/Prebuilt/components/RoomDetails/RoomDetailsSheet.tsx", "../src/Prebuilt/plugins/FlyingEmoji.jsx", "../src/Prebuilt/plugins/RemoteStopScreenshare.jsx", "../src/Prebuilt/components/hooks/useAutoStartStreaming.tsx", "../src/Progress/index.tsx", "../src/Diagnostics/index.ts", "../src/Diagnostics/Diagnostics.tsx", "../src/Diagnostics/AudioTest.tsx", "../src/Diagnostics/components.tsx", "../src/Diagnostics/DiagnosticsContext.ts", "../src/Diagnostics/DeviceSelector.jsx", "../src/Diagnostics/BrowserTest.tsx", "../src/Diagnostics/ConnectivityTest.tsx", "../src/Diagnostics/VideoTest.tsx"],
  "sourcesContent": ["", "/**\n * @license\n * Lodash <https://lodash.com/>\n * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n;(function() {\n\n  /** Used as a safe reference for `undefined` in pre-ES5 environments. */\n  var undefined;\n\n  /** Used as the semantic version number. */\n  var VERSION = '4.17.21';\n\n  /** Used as the size to enable large array optimizations. */\n  var LARGE_ARRAY_SIZE = 200;\n\n  /** Error message constants. */\n  var CORE_ERROR_TEXT = 'Unsupported core-js use. Try https://npms.io/search?q=ponyfill.',\n      FUNC_ERROR_TEXT = 'Expected a function',\n      INVALID_TEMPL_VAR_ERROR_TEXT = 'Invalid `variable` option passed into `_.template`';\n\n  /** Used to stand-in for `undefined` hash values. */\n  var HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n  /** Used as the maximum memoize cache size. */\n  var MAX_MEMOIZE_SIZE = 500;\n\n  /** Used as the internal argument placeholder. */\n  var PLACEHOLDER = '__lodash_placeholder__';\n\n  /** Used to compose bitmasks for cloning. */\n  var CLONE_DEEP_FLAG = 1,\n      CLONE_FLAT_FLAG = 2,\n      CLONE_SYMBOLS_FLAG = 4;\n\n  /** Used to compose bitmasks for value comparisons. */\n  var COMPARE_PARTIAL_FLAG = 1,\n      COMPARE_UNORDERED_FLAG = 2;\n\n  /** Used to compose bitmasks for function metadata. */\n  var WRAP_BIND_FLAG = 1,\n      WRAP_BIND_KEY_FLAG = 2,\n      WRAP_CURRY_BOUND_FLAG = 4,\n      WRAP_CURRY_FLAG = 8,\n      WRAP_CURRY_RIGHT_FLAG = 16,\n      WRAP_PARTIAL_FLAG = 32,\n      WRAP_PARTIAL_RIGHT_FLAG = 64,\n      WRAP_ARY_FLAG = 128,\n      WRAP_REARG_FLAG = 256,\n      WRAP_FLIP_FLAG = 512;\n\n  /** Used as default options for `_.truncate`. */\n  var DEFAULT_TRUNC_LENGTH = 30,\n      DEFAULT_TRUNC_OMISSION = '...';\n\n  /** Used to detect hot functions by number of calls within a span of milliseconds. */\n  var HOT_COUNT = 800,\n      HOT_SPAN = 16;\n\n  /** Used to indicate the type of lazy iteratees. */\n  var LAZY_FILTER_FLAG = 1,\n      LAZY_MAP_FLAG = 2,\n      LAZY_WHILE_FLAG = 3;\n\n  /** Used as references for various `Number` constants. */\n  var INFINITY = 1 / 0,\n      MAX_SAFE_INTEGER = 9007199254740991,\n      MAX_INTEGER = 1.7976931348623157e+308,\n      NAN = 0 / 0;\n\n  /** Used as references for the maximum length and index of an array. */\n  var MAX_ARRAY_LENGTH = 4294967295,\n      MAX_ARRAY_INDEX = MAX_ARRAY_LENGTH - 1,\n      HALF_MAX_ARRAY_LENGTH = MAX_ARRAY_LENGTH >>> 1;\n\n  /** Used to associate wrap methods with their bit flags. */\n  var wrapFlags = [\n    ['ary', WRAP_ARY_FLAG],\n    ['bind', WRAP_BIND_FLAG],\n    ['bindKey', WRAP_BIND_KEY_FLAG],\n    ['curry', WRAP_CURRY_FLAG],\n    ['curryRight', WRAP_CURRY_RIGHT_FLAG],\n    ['flip', WRAP_FLIP_FLAG],\n    ['partial', WRAP_PARTIAL_FLAG],\n    ['partialRight', WRAP_PARTIAL_RIGHT_FLAG],\n    ['rearg', WRAP_REARG_FLAG]\n  ];\n\n  /** `Object#toString` result references. */\n  var argsTag = '[object Arguments]',\n      arrayTag = '[object Array]',\n      asyncTag = '[object AsyncFunction]',\n      boolTag = '[object Boolean]',\n      dateTag = '[object Date]',\n      domExcTag = '[object DOMException]',\n      errorTag = '[object Error]',\n      funcTag = '[object Function]',\n      genTag = '[object GeneratorFunction]',\n      mapTag = '[object Map]',\n      numberTag = '[object Number]',\n      nullTag = '[object Null]',\n      objectTag = '[object Object]',\n      promiseTag = '[object Promise]',\n      proxyTag = '[object Proxy]',\n      regexpTag = '[object RegExp]',\n      setTag = '[object Set]',\n      stringTag = '[object String]',\n      symbolTag = '[object Symbol]',\n      undefinedTag = '[object Undefined]',\n      weakMapTag = '[object WeakMap]',\n      weakSetTag = '[object WeakSet]';\n\n  var arrayBufferTag = '[object ArrayBuffer]',\n      dataViewTag = '[object DataView]',\n      float32Tag = '[object Float32Array]',\n      float64Tag = '[object Float64Array]',\n      int8Tag = '[object Int8Array]',\n      int16Tag = '[object Int16Array]',\n      int32Tag = '[object Int32Array]',\n      uint8Tag = '[object Uint8Array]',\n      uint8ClampedTag = '[object Uint8ClampedArray]',\n      uint16Tag = '[object Uint16Array]',\n      uint32Tag = '[object Uint32Array]';\n\n  /** Used to match empty string literals in compiled template source. */\n  var reEmptyStringLeading = /\\b__p \\+= '';/g,\n      reEmptyStringMiddle = /\\b(__p \\+=) '' \\+/g,\n      reEmptyStringTrailing = /(__e\\(.*?\\)|\\b__t\\)) \\+\\n'';/g;\n\n  /** Used to match HTML entities and HTML characters. */\n  var reEscapedHtml = /&(?:amp|lt|gt|quot|#39);/g,\n      reUnescapedHtml = /[&<>\"']/g,\n      reHasEscapedHtml = RegExp(reEscapedHtml.source),\n      reHasUnescapedHtml = RegExp(reUnescapedHtml.source);\n\n  /** Used to match template delimiters. */\n  var reEscape = /<%-([\\s\\S]+?)%>/g,\n      reEvaluate = /<%([\\s\\S]+?)%>/g,\n      reInterpolate = /<%=([\\s\\S]+?)%>/g;\n\n  /** Used to match property names within property paths. */\n  var reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n      reIsPlainProp = /^\\w*$/,\n      rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n  /**\n   * Used to match `RegExp`\n   * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n   */\n  var reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g,\n      reHasRegExpChar = RegExp(reRegExpChar.source);\n\n  /** Used to match leading whitespace. */\n  var reTrimStart = /^\\s+/;\n\n  /** Used to match a single whitespace character. */\n  var reWhitespace = /\\s/;\n\n  /** Used to match wrap detail comments. */\n  var reWrapComment = /\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/,\n      reWrapDetails = /\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,\n      reSplitDetails = /,? & /;\n\n  /** Used to match words composed of alphanumeric characters. */\n  var reAsciiWord = /[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g;\n\n  /**\n   * Used to validate the `validate` option in `_.template` variable.\n   *\n   * Forbids characters which could potentially change the meaning of the function argument definition:\n   * - \"(),\" (modification of function parameters)\n   * - \"=\" (default value)\n   * - \"[]{}\" (destructuring of function parameters)\n   * - \"/\" (beginning of a comment)\n   * - whitespace\n   */\n  var reForbiddenIdentifierChars = /[()=,{}\\[\\]\\/\\s]/;\n\n  /** Used to match backslashes in property paths. */\n  var reEscapeChar = /\\\\(\\\\)?/g;\n\n  /**\n   * Used to match\n   * [ES template delimiters](http://ecma-international.org/ecma-262/7.0/#sec-template-literal-lexical-components).\n   */\n  var reEsTemplate = /\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g;\n\n  /** Used to match `RegExp` flags from their coerced string values. */\n  var reFlags = /\\w*$/;\n\n  /** Used to detect bad signed hexadecimal string values. */\n  var reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n  /** Used to detect binary string values. */\n  var reIsBinary = /^0b[01]+$/i;\n\n  /** Used to detect host constructors (Safari). */\n  var reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n  /** Used to detect octal string values. */\n  var reIsOctal = /^0o[0-7]+$/i;\n\n  /** Used to detect unsigned integer values. */\n  var reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n  /** Used to match Latin Unicode letters (excluding mathematical operators). */\n  var reLatin = /[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g;\n\n  /** Used to ensure capturing order of template delimiters. */\n  var reNoMatch = /($^)/;\n\n  /** Used to match unescaped characters in compiled string literals. */\n  var reUnescapedString = /['\\n\\r\\u2028\\u2029\\\\]/g;\n\n  /** Used to compose unicode character classes. */\n  var rsAstralRange = '\\\\ud800-\\\\udfff',\n      rsComboMarksRange = '\\\\u0300-\\\\u036f',\n      reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n      rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n      rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n      rsDingbatRange = '\\\\u2700-\\\\u27bf',\n      rsLowerRange = 'a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff',\n      rsMathOpRange = '\\\\xac\\\\xb1\\\\xd7\\\\xf7',\n      rsNonCharRange = '\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf',\n      rsPunctuationRange = '\\\\u2000-\\\\u206f',\n      rsSpaceRange = ' \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000',\n      rsUpperRange = 'A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde',\n      rsVarRange = '\\\\ufe0e\\\\ufe0f',\n      rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;\n\n  /** Used to compose unicode capture groups. */\n  var rsApos = \"['\\u2019]\",\n      rsAstral = '[' + rsAstralRange + ']',\n      rsBreak = '[' + rsBreakRange + ']',\n      rsCombo = '[' + rsComboRange + ']',\n      rsDigits = '\\\\d+',\n      rsDingbat = '[' + rsDingbatRange + ']',\n      rsLower = '[' + rsLowerRange + ']',\n      rsMisc = '[^' + rsAstralRange + rsBreakRange + rsDigits + rsDingbatRange + rsLowerRange + rsUpperRange + ']',\n      rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]',\n      rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',\n      rsNonAstral = '[^' + rsAstralRange + ']',\n      rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}',\n      rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]',\n      rsUpper = '[' + rsUpperRange + ']',\n      rsZWJ = '\\\\u200d';\n\n  /** Used to compose unicode regexes. */\n  var rsMiscLower = '(?:' + rsLower + '|' + rsMisc + ')',\n      rsMiscUpper = '(?:' + rsUpper + '|' + rsMisc + ')',\n      rsOptContrLower = '(?:' + rsApos + '(?:d|ll|m|re|s|t|ve))?',\n      rsOptContrUpper = '(?:' + rsApos + '(?:D|LL|M|RE|S|T|VE))?',\n      reOptMod = rsModifier + '?',\n      rsOptVar = '[' + rsVarRange + ']?',\n      rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',\n      rsOrdLower = '\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])',\n      rsOrdUpper = '\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])',\n      rsSeq = rsOptVar + reOptMod + rsOptJoin,\n      rsEmoji = '(?:' + [rsDingbat, rsRegional, rsSurrPair].join('|') + ')' + rsSeq,\n      rsSymbol = '(?:' + [rsNonAstral + rsCombo + '?', rsCombo, rsRegional, rsSurrPair, rsAstral].join('|') + ')';\n\n  /** Used to match apostrophes. */\n  var reApos = RegExp(rsApos, 'g');\n\n  /**\n   * Used to match [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks) and\n   * [combining diacritical marks for symbols](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks_for_Symbols).\n   */\n  var reComboMark = RegExp(rsCombo, 'g');\n\n  /** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */\n  var reUnicode = RegExp(rsFitz + '(?=' + rsFitz + ')|' + rsSymbol + rsSeq, 'g');\n\n  /** Used to match complex or compound words. */\n  var reUnicodeWord = RegExp([\n    rsUpper + '?' + rsLower + '+' + rsOptContrLower + '(?=' + [rsBreak, rsUpper, '$'].join('|') + ')',\n    rsMiscUpper + '+' + rsOptContrUpper + '(?=' + [rsBreak, rsUpper + rsMiscLower, '$'].join('|') + ')',\n    rsUpper + '?' + rsMiscLower + '+' + rsOptContrLower,\n    rsUpper + '+' + rsOptContrUpper,\n    rsOrdUpper,\n    rsOrdLower,\n    rsDigits,\n    rsEmoji\n  ].join('|'), 'g');\n\n  /** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */\n  var reHasUnicode = RegExp('[' + rsZWJ + rsAstralRange  + rsComboRange + rsVarRange + ']');\n\n  /** Used to detect strings that need a more robust regexp to match words. */\n  var reHasUnicodeWord = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;\n\n  /** Used to assign default `context` object properties. */\n  var contextProps = [\n    'Array', 'Buffer', 'DataView', 'Date', 'Error', 'Float32Array', 'Float64Array',\n    'Function', 'Int8Array', 'Int16Array', 'Int32Array', 'Map', 'Math', 'Object',\n    'Promise', 'RegExp', 'Set', 'String', 'Symbol', 'TypeError', 'Uint8Array',\n    'Uint8ClampedArray', 'Uint16Array', 'Uint32Array', 'WeakMap',\n    '_', 'clearTimeout', 'isFinite', 'parseInt', 'setTimeout'\n  ];\n\n  /** Used to make template sourceURLs easier to identify. */\n  var templateCounter = -1;\n\n  /** Used to identify `toStringTag` values of typed arrays. */\n  var typedArrayTags = {};\n  typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\n  typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\n  typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\n  typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\n  typedArrayTags[uint32Tag] = true;\n  typedArrayTags[argsTag] = typedArrayTags[arrayTag] =\n  typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\n  typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\n  typedArrayTags[errorTag] = typedArrayTags[funcTag] =\n  typedArrayTags[mapTag] = typedArrayTags[numberTag] =\n  typedArrayTags[objectTag] = typedArrayTags[regexpTag] =\n  typedArrayTags[setTag] = typedArrayTags[stringTag] =\n  typedArrayTags[weakMapTag] = false;\n\n  /** Used to identify `toStringTag` values supported by `_.clone`. */\n  var cloneableTags = {};\n  cloneableTags[argsTag] = cloneableTags[arrayTag] =\n  cloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\n  cloneableTags[boolTag] = cloneableTags[dateTag] =\n  cloneableTags[float32Tag] = cloneableTags[float64Tag] =\n  cloneableTags[int8Tag] = cloneableTags[int16Tag] =\n  cloneableTags[int32Tag] = cloneableTags[mapTag] =\n  cloneableTags[numberTag] = cloneableTags[objectTag] =\n  cloneableTags[regexpTag] = cloneableTags[setTag] =\n  cloneableTags[stringTag] = cloneableTags[symbolTag] =\n  cloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\n  cloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\n  cloneableTags[errorTag] = cloneableTags[funcTag] =\n  cloneableTags[weakMapTag] = false;\n\n  /** Used to map Latin Unicode letters to basic Latin letters. */\n  var deburredLetters = {\n    // Latin-1 Supplement block.\n    '\\xc0': 'A',  '\\xc1': 'A', '\\xc2': 'A', '\\xc3': 'A', '\\xc4': 'A', '\\xc5': 'A',\n    '\\xe0': 'a',  '\\xe1': 'a', '\\xe2': 'a', '\\xe3': 'a', '\\xe4': 'a', '\\xe5': 'a',\n    '\\xc7': 'C',  '\\xe7': 'c',\n    '\\xd0': 'D',  '\\xf0': 'd',\n    '\\xc8': 'E',  '\\xc9': 'E', '\\xca': 'E', '\\xcb': 'E',\n    '\\xe8': 'e',  '\\xe9': 'e', '\\xea': 'e', '\\xeb': 'e',\n    '\\xcc': 'I',  '\\xcd': 'I', '\\xce': 'I', '\\xcf': 'I',\n    '\\xec': 'i',  '\\xed': 'i', '\\xee': 'i', '\\xef': 'i',\n    '\\xd1': 'N',  '\\xf1': 'n',\n    '\\xd2': 'O',  '\\xd3': 'O', '\\xd4': 'O', '\\xd5': 'O', '\\xd6': 'O', '\\xd8': 'O',\n    '\\xf2': 'o',  '\\xf3': 'o', '\\xf4': 'o', '\\xf5': 'o', '\\xf6': 'o', '\\xf8': 'o',\n    '\\xd9': 'U',  '\\xda': 'U', '\\xdb': 'U', '\\xdc': 'U',\n    '\\xf9': 'u',  '\\xfa': 'u', '\\xfb': 'u', '\\xfc': 'u',\n    '\\xdd': 'Y',  '\\xfd': 'y', '\\xff': 'y',\n    '\\xc6': 'Ae', '\\xe6': 'ae',\n    '\\xde': 'Th', '\\xfe': 'th',\n    '\\xdf': 'ss',\n    // Latin Extended-A block.\n    '\\u0100': 'A',  '\\u0102': 'A', '\\u0104': 'A',\n    '\\u0101': 'a',  '\\u0103': 'a', '\\u0105': 'a',\n    '\\u0106': 'C',  '\\u0108': 'C', '\\u010a': 'C', '\\u010c': 'C',\n    '\\u0107': 'c',  '\\u0109': 'c', '\\u010b': 'c', '\\u010d': 'c',\n    '\\u010e': 'D',  '\\u0110': 'D', '\\u010f': 'd', '\\u0111': 'd',\n    '\\u0112': 'E',  '\\u0114': 'E', '\\u0116': 'E', '\\u0118': 'E', '\\u011a': 'E',\n    '\\u0113': 'e',  '\\u0115': 'e', '\\u0117': 'e', '\\u0119': 'e', '\\u011b': 'e',\n    '\\u011c': 'G',  '\\u011e': 'G', '\\u0120': 'G', '\\u0122': 'G',\n    '\\u011d': 'g',  '\\u011f': 'g', '\\u0121': 'g', '\\u0123': 'g',\n    '\\u0124': 'H',  '\\u0126': 'H', '\\u0125': 'h', '\\u0127': 'h',\n    '\\u0128': 'I',  '\\u012a': 'I', '\\u012c': 'I', '\\u012e': 'I', '\\u0130': 'I',\n    '\\u0129': 'i',  '\\u012b': 'i', '\\u012d': 'i', '\\u012f': 'i', '\\u0131': 'i',\n    '\\u0134': 'J',  '\\u0135': 'j',\n    '\\u0136': 'K',  '\\u0137': 'k', '\\u0138': 'k',\n    '\\u0139': 'L',  '\\u013b': 'L', '\\u013d': 'L', '\\u013f': 'L', '\\u0141': 'L',\n    '\\u013a': 'l',  '\\u013c': 'l', '\\u013e': 'l', '\\u0140': 'l', '\\u0142': 'l',\n    '\\u0143': 'N',  '\\u0145': 'N', '\\u0147': 'N', '\\u014a': 'N',\n    '\\u0144': 'n',  '\\u0146': 'n', '\\u0148': 'n', '\\u014b': 'n',\n    '\\u014c': 'O',  '\\u014e': 'O', '\\u0150': 'O',\n    '\\u014d': 'o',  '\\u014f': 'o', '\\u0151': 'o',\n    '\\u0154': 'R',  '\\u0156': 'R', '\\u0158': 'R',\n    '\\u0155': 'r',  '\\u0157': 'r', '\\u0159': 'r',\n    '\\u015a': 'S',  '\\u015c': 'S', '\\u015e': 'S', '\\u0160': 'S',\n    '\\u015b': 's',  '\\u015d': 's', '\\u015f': 's', '\\u0161': 's',\n    '\\u0162': 'T',  '\\u0164': 'T', '\\u0166': 'T',\n    '\\u0163': 't',  '\\u0165': 't', '\\u0167': 't',\n    '\\u0168': 'U',  '\\u016a': 'U', '\\u016c': 'U', '\\u016e': 'U', '\\u0170': 'U', '\\u0172': 'U',\n    '\\u0169': 'u',  '\\u016b': 'u', '\\u016d': 'u', '\\u016f': 'u', '\\u0171': 'u', '\\u0173': 'u',\n    '\\u0174': 'W',  '\\u0175': 'w',\n    '\\u0176': 'Y',  '\\u0177': 'y', '\\u0178': 'Y',\n    '\\u0179': 'Z',  '\\u017b': 'Z', '\\u017d': 'Z',\n    '\\u017a': 'z',  '\\u017c': 'z', '\\u017e': 'z',\n    '\\u0132': 'IJ', '\\u0133': 'ij',\n    '\\u0152': 'Oe', '\\u0153': 'oe',\n    '\\u0149': \"'n\", '\\u017f': 's'\n  };\n\n  /** Used to map characters to HTML entities. */\n  var htmlEscapes = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n  };\n\n  /** Used to map HTML entities to characters. */\n  var htmlUnescapes = {\n    '&amp;': '&',\n    '&lt;': '<',\n    '&gt;': '>',\n    '&quot;': '\"',\n    '&#39;': \"'\"\n  };\n\n  /** Used to escape characters for inclusion in compiled string literals. */\n  var stringEscapes = {\n    '\\\\': '\\\\',\n    \"'\": \"'\",\n    '\\n': 'n',\n    '\\r': 'r',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  /** Built-in method references without a dependency on `root`. */\n  var freeParseFloat = parseFloat,\n      freeParseInt = parseInt;\n\n  /** Detect free variable `global` from Node.js. */\n  var freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n  /** Detect free variable `self`. */\n  var freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n  /** Used as a reference to the global object. */\n  var root = freeGlobal || freeSelf || Function('return this')();\n\n  /** Detect free variable `exports`. */\n  var freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module`. */\n  var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n  /** Detect the popular CommonJS extension `module.exports`. */\n  var moduleExports = freeModule && freeModule.exports === freeExports;\n\n  /** Detect free variable `process` from Node.js. */\n  var freeProcess = moduleExports && freeGlobal.process;\n\n  /** Used to access faster Node.js helpers. */\n  var nodeUtil = (function() {\n    try {\n      // Use `util.types` for Node.js 10+.\n      var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n      if (types) {\n        return types;\n      }\n\n      // Legacy `process.binding('util')` for Node.js < 10.\n      return freeProcess && freeProcess.binding && freeProcess.binding('util');\n    } catch (e) {}\n  }());\n\n  /* Node.js helper references. */\n  var nodeIsArrayBuffer = nodeUtil && nodeUtil.isArrayBuffer,\n      nodeIsDate = nodeUtil && nodeUtil.isDate,\n      nodeIsMap = nodeUtil && nodeUtil.isMap,\n      nodeIsRegExp = nodeUtil && nodeUtil.isRegExp,\n      nodeIsSet = nodeUtil && nodeUtil.isSet,\n      nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * A faster alternative to `Function#apply`, this function invokes `func`\n   * with the `this` binding of `thisArg` and the arguments of `args`.\n   *\n   * @private\n   * @param {Function} func The function to invoke.\n   * @param {*} thisArg The `this` binding of `func`.\n   * @param {Array} args The arguments to invoke `func` with.\n   * @returns {*} Returns the result of `func`.\n   */\n  function apply(func, thisArg, args) {\n    switch (args.length) {\n      case 0: return func.call(thisArg);\n      case 1: return func.call(thisArg, args[0]);\n      case 2: return func.call(thisArg, args[0], args[1]);\n      case 3: return func.call(thisArg, args[0], args[1], args[2]);\n    }\n    return func.apply(thisArg, args);\n  }\n\n  /**\n   * A specialized version of `baseAggregator` for arrays.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} setter The function to set `accumulator` values.\n   * @param {Function} iteratee The iteratee to transform keys.\n   * @param {Object} accumulator The initial aggregated object.\n   * @returns {Function} Returns `accumulator`.\n   */\n  function arrayAggregator(array, setter, iteratee, accumulator) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      var value = array[index];\n      setter(accumulator, value, iteratee(value), array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.forEach` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayEach(array, iteratee) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (iteratee(array[index], index, array) === false) {\n        break;\n      }\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.forEachRight` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayEachRight(array, iteratee) {\n    var length = array == null ? 0 : array.length;\n\n    while (length--) {\n      if (iteratee(array[length], length, array) === false) {\n        break;\n      }\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.every` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {boolean} Returns `true` if all elements pass the predicate check,\n   *  else `false`.\n   */\n  function arrayEvery(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (!predicate(array[index], index, array)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * A specialized version of `_.filter` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {Array} Returns the new filtered array.\n   */\n  function arrayFilter(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length,\n        resIndex = 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (predicate(value, index, array)) {\n        result[resIndex++] = value;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * A specialized version of `_.includes` for arrays without support for\n   * specifying an index to search from.\n   *\n   * @private\n   * @param {Array} [array] The array to inspect.\n   * @param {*} target The value to search for.\n   * @returns {boolean} Returns `true` if `target` is found, else `false`.\n   */\n  function arrayIncludes(array, value) {\n    var length = array == null ? 0 : array.length;\n    return !!length && baseIndexOf(array, value, 0) > -1;\n  }\n\n  /**\n   * This function is like `arrayIncludes` except that it accepts a comparator.\n   *\n   * @private\n   * @param {Array} [array] The array to inspect.\n   * @param {*} target The value to search for.\n   * @param {Function} comparator The comparator invoked per element.\n   * @returns {boolean} Returns `true` if `target` is found, else `false`.\n   */\n  function arrayIncludesWith(array, value, comparator) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (comparator(value, array[index])) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * A specialized version of `_.map` for arrays without support for iteratee\n   * shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns the new mapped array.\n   */\n  function arrayMap(array, iteratee) {\n    var index = -1,\n        length = array == null ? 0 : array.length,\n        result = Array(length);\n\n    while (++index < length) {\n      result[index] = iteratee(array[index], index, array);\n    }\n    return result;\n  }\n\n  /**\n   * Appends the elements of `values` to `array`.\n   *\n   * @private\n   * @param {Array} array The array to modify.\n   * @param {Array} values The values to append.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayPush(array, values) {\n    var index = -1,\n        length = values.length,\n        offset = array.length;\n\n    while (++index < length) {\n      array[offset + index] = values[index];\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.reduce` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} [accumulator] The initial value.\n   * @param {boolean} [initAccum] Specify using the first element of `array` as\n   *  the initial value.\n   * @returns {*} Returns the accumulated value.\n   */\n  function arrayReduce(array, iteratee, accumulator, initAccum) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    if (initAccum && length) {\n      accumulator = array[++index];\n    }\n    while (++index < length) {\n      accumulator = iteratee(accumulator, array[index], index, array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.reduceRight` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} [accumulator] The initial value.\n   * @param {boolean} [initAccum] Specify using the last element of `array` as\n   *  the initial value.\n   * @returns {*} Returns the accumulated value.\n   */\n  function arrayReduceRight(array, iteratee, accumulator, initAccum) {\n    var length = array == null ? 0 : array.length;\n    if (initAccum && length) {\n      accumulator = array[--length];\n    }\n    while (length--) {\n      accumulator = iteratee(accumulator, array[length], length, array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.some` for arrays without support for iteratee\n   * shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {boolean} Returns `true` if any element passes the predicate check,\n   *  else `false`.\n   */\n  function arraySome(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (predicate(array[index], index, array)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Gets the size of an ASCII `string`.\n   *\n   * @private\n   * @param {string} string The string inspect.\n   * @returns {number} Returns the string size.\n   */\n  var asciiSize = baseProperty('length');\n\n  /**\n   * Converts an ASCII `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function asciiToArray(string) {\n    return string.split('');\n  }\n\n  /**\n   * Splits an ASCII `string` into an array of its words.\n   *\n   * @private\n   * @param {string} The string to inspect.\n   * @returns {Array} Returns the words of `string`.\n   */\n  function asciiWords(string) {\n    return string.match(reAsciiWord) || [];\n  }\n\n  /**\n   * The base implementation of methods like `_.findKey` and `_.findLastKey`,\n   * without support for iteratee shorthands, which iterates over `collection`\n   * using `eachFunc`.\n   *\n   * @private\n   * @param {Array|Object} collection The collection to inspect.\n   * @param {Function} predicate The function invoked per iteration.\n   * @param {Function} eachFunc The function to iterate over `collection`.\n   * @returns {*} Returns the found element or its key, else `undefined`.\n   */\n  function baseFindKey(collection, predicate, eachFunc) {\n    var result;\n    eachFunc(collection, function(value, key, collection) {\n      if (predicate(value, key, collection)) {\n        result = key;\n        return false;\n      }\n    });\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.findIndex` and `_.findLastIndex` without\n   * support for iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {Function} predicate The function invoked per iteration.\n   * @param {number} fromIndex The index to search from.\n   * @param {boolean} [fromRight] Specify iterating from right to left.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseFindIndex(array, predicate, fromIndex, fromRight) {\n    var length = array.length,\n        index = fromIndex + (fromRight ? 1 : -1);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (predicate(array[index], index, array)) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseIndexOf(array, value, fromIndex) {\n    return value === value\n      ? strictIndexOf(array, value, fromIndex)\n      : baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n\n  /**\n   * This function is like `baseIndexOf` except that it accepts a comparator.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @param {Function} comparator The comparator invoked per element.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseIndexOfWith(array, value, fromIndex, comparator) {\n    var index = fromIndex - 1,\n        length = array.length;\n\n    while (++index < length) {\n      if (comparator(array[index], value)) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * The base implementation of `_.isNaN` without support for number objects.\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n   */\n  function baseIsNaN(value) {\n    return value !== value;\n  }\n\n  /**\n   * The base implementation of `_.mean` and `_.meanBy` without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {number} Returns the mean.\n   */\n  function baseMean(array, iteratee) {\n    var length = array == null ? 0 : array.length;\n    return length ? (baseSum(array, iteratee) / length) : NAN;\n  }\n\n  /**\n   * The base implementation of `_.property` without support for deep paths.\n   *\n   * @private\n   * @param {string} key The key of the property to get.\n   * @returns {Function} Returns the new accessor function.\n   */\n  function baseProperty(key) {\n    return function(object) {\n      return object == null ? undefined : object[key];\n    };\n  }\n\n  /**\n   * The base implementation of `_.propertyOf` without support for deep paths.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @returns {Function} Returns the new accessor function.\n   */\n  function basePropertyOf(object) {\n    return function(key) {\n      return object == null ? undefined : object[key];\n    };\n  }\n\n  /**\n   * The base implementation of `_.reduce` and `_.reduceRight`, without support\n   * for iteratee shorthands, which iterates over `collection` using `eachFunc`.\n   *\n   * @private\n   * @param {Array|Object} collection The collection to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} accumulator The initial value.\n   * @param {boolean} initAccum Specify using the first or last element of\n   *  `collection` as the initial value.\n   * @param {Function} eachFunc The function to iterate over `collection`.\n   * @returns {*} Returns the accumulated value.\n   */\n  function baseReduce(collection, iteratee, accumulator, initAccum, eachFunc) {\n    eachFunc(collection, function(value, index, collection) {\n      accumulator = initAccum\n        ? (initAccum = false, value)\n        : iteratee(accumulator, value, index, collection);\n    });\n    return accumulator;\n  }\n\n  /**\n   * The base implementation of `_.sortBy` which uses `comparer` to define the\n   * sort order of `array` and replaces criteria objects with their corresponding\n   * values.\n   *\n   * @private\n   * @param {Array} array The array to sort.\n   * @param {Function} comparer The function to define sort order.\n   * @returns {Array} Returns `array`.\n   */\n  function baseSortBy(array, comparer) {\n    var length = array.length;\n\n    array.sort(comparer);\n    while (length--) {\n      array[length] = array[length].value;\n    }\n    return array;\n  }\n\n  /**\n   * The base implementation of `_.sum` and `_.sumBy` without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {number} Returns the sum.\n   */\n  function baseSum(array, iteratee) {\n    var result,\n        index = -1,\n        length = array.length;\n\n    while (++index < length) {\n      var current = iteratee(array[index]);\n      if (current !== undefined) {\n        result = result === undefined ? current : (result + current);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.times` without support for iteratee shorthands\n   * or max array length checks.\n   *\n   * @private\n   * @param {number} n The number of times to invoke `iteratee`.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns the array of results.\n   */\n  function baseTimes(n, iteratee) {\n    var index = -1,\n        result = Array(n);\n\n    while (++index < n) {\n      result[index] = iteratee(index);\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.toPairs` and `_.toPairsIn` which creates an array\n   * of key-value pairs for `object` corresponding to the property names of `props`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {Array} props The property names to get values for.\n   * @returns {Object} Returns the key-value pairs.\n   */\n  function baseToPairs(object, props) {\n    return arrayMap(props, function(key) {\n      return [key, object[key]];\n    });\n  }\n\n  /**\n   * The base implementation of `_.trim`.\n   *\n   * @private\n   * @param {string} string The string to trim.\n   * @returns {string} Returns the trimmed string.\n   */\n  function baseTrim(string) {\n    return string\n      ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n      : string;\n  }\n\n  /**\n   * The base implementation of `_.unary` without support for storing metadata.\n   *\n   * @private\n   * @param {Function} func The function to cap arguments for.\n   * @returns {Function} Returns the new capped function.\n   */\n  function baseUnary(func) {\n    return function(value) {\n      return func(value);\n    };\n  }\n\n  /**\n   * The base implementation of `_.values` and `_.valuesIn` which creates an\n   * array of `object` property values corresponding to the property names\n   * of `props`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {Array} props The property names to get values for.\n   * @returns {Object} Returns the array of property values.\n   */\n  function baseValues(object, props) {\n    return arrayMap(props, function(key) {\n      return object[key];\n    });\n  }\n\n  /**\n   * Checks if a `cache` value for `key` exists.\n   *\n   * @private\n   * @param {Object} cache The cache to query.\n   * @param {string} key The key of the entry to check.\n   * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n   */\n  function cacheHas(cache, key) {\n    return cache.has(key);\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimStart` to get the index of the first string symbol\n   * that is not found in the character symbols.\n   *\n   * @private\n   * @param {Array} strSymbols The string symbols to inspect.\n   * @param {Array} chrSymbols The character symbols to find.\n   * @returns {number} Returns the index of the first unmatched string symbol.\n   */\n  function charsStartIndex(strSymbols, chrSymbols) {\n    var index = -1,\n        length = strSymbols.length;\n\n    while (++index < length && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n    return index;\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimEnd` to get the index of the last string symbol\n   * that is not found in the character symbols.\n   *\n   * @private\n   * @param {Array} strSymbols The string symbols to inspect.\n   * @param {Array} chrSymbols The character symbols to find.\n   * @returns {number} Returns the index of the last unmatched string symbol.\n   */\n  function charsEndIndex(strSymbols, chrSymbols) {\n    var index = strSymbols.length;\n\n    while (index-- && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n    return index;\n  }\n\n  /**\n   * Gets the number of `placeholder` occurrences in `array`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} placeholder The placeholder to search for.\n   * @returns {number} Returns the placeholder count.\n   */\n  function countHolders(array, placeholder) {\n    var length = array.length,\n        result = 0;\n\n    while (length--) {\n      if (array[length] === placeholder) {\n        ++result;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Used by `_.deburr` to convert Latin-1 Supplement and Latin Extended-A\n   * letters to basic Latin letters.\n   *\n   * @private\n   * @param {string} letter The matched letter to deburr.\n   * @returns {string} Returns the deburred letter.\n   */\n  var deburrLetter = basePropertyOf(deburredLetters);\n\n  /**\n   * Used by `_.escape` to convert characters to HTML entities.\n   *\n   * @private\n   * @param {string} chr The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  var escapeHtmlChar = basePropertyOf(htmlEscapes);\n\n  /**\n   * Used by `_.template` to escape characters for inclusion in compiled string literals.\n   *\n   * @private\n   * @param {string} chr The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  function escapeStringChar(chr) {\n    return '\\\\' + stringEscapes[chr];\n  }\n\n  /**\n   * Gets the value at `key` of `object`.\n   *\n   * @private\n   * @param {Object} [object] The object to query.\n   * @param {string} key The key of the property to get.\n   * @returns {*} Returns the property value.\n   */\n  function getValue(object, key) {\n    return object == null ? undefined : object[key];\n  }\n\n  /**\n   * Checks if `string` contains Unicode symbols.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {boolean} Returns `true` if a symbol is found, else `false`.\n   */\n  function hasUnicode(string) {\n    return reHasUnicode.test(string);\n  }\n\n  /**\n   * Checks if `string` contains a word composed of Unicode symbols.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {boolean} Returns `true` if a word is found, else `false`.\n   */\n  function hasUnicodeWord(string) {\n    return reHasUnicodeWord.test(string);\n  }\n\n  /**\n   * Converts `iterator` to an array.\n   *\n   * @private\n   * @param {Object} iterator The iterator to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function iteratorToArray(iterator) {\n    var data,\n        result = [];\n\n    while (!(data = iterator.next()).done) {\n      result.push(data.value);\n    }\n    return result;\n  }\n\n  /**\n   * Converts `map` to its key-value pairs.\n   *\n   * @private\n   * @param {Object} map The map to convert.\n   * @returns {Array} Returns the key-value pairs.\n   */\n  function mapToArray(map) {\n    var index = -1,\n        result = Array(map.size);\n\n    map.forEach(function(value, key) {\n      result[++index] = [key, value];\n    });\n    return result;\n  }\n\n  /**\n   * Creates a unary function that invokes `func` with its argument transformed.\n   *\n   * @private\n   * @param {Function} func The function to wrap.\n   * @param {Function} transform The argument transform.\n   * @returns {Function} Returns the new function.\n   */\n  function overArg(func, transform) {\n    return function(arg) {\n      return func(transform(arg));\n    };\n  }\n\n  /**\n   * Replaces all `placeholder` elements in `array` with an internal placeholder\n   * and returns an array of their indexes.\n   *\n   * @private\n   * @param {Array} array The array to modify.\n   * @param {*} placeholder The placeholder to replace.\n   * @returns {Array} Returns the new array of placeholder indexes.\n   */\n  function replaceHolders(array, placeholder) {\n    var index = -1,\n        length = array.length,\n        resIndex = 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (value === placeholder || value === PLACEHOLDER) {\n        array[index] = PLACEHOLDER;\n        result[resIndex++] = index;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Converts `set` to an array of its values.\n   *\n   * @private\n   * @param {Object} set The set to convert.\n   * @returns {Array} Returns the values.\n   */\n  function setToArray(set) {\n    var index = -1,\n        result = Array(set.size);\n\n    set.forEach(function(value) {\n      result[++index] = value;\n    });\n    return result;\n  }\n\n  /**\n   * Converts `set` to its value-value pairs.\n   *\n   * @private\n   * @param {Object} set The set to convert.\n   * @returns {Array} Returns the value-value pairs.\n   */\n  function setToPairs(set) {\n    var index = -1,\n        result = Array(set.size);\n\n    set.forEach(function(value) {\n      result[++index] = [value, value];\n    });\n    return result;\n  }\n\n  /**\n   * A specialized version of `_.indexOf` which performs strict equality\n   * comparisons of values, i.e. `===`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function strictIndexOf(array, value, fromIndex) {\n    var index = fromIndex - 1,\n        length = array.length;\n\n    while (++index < length) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * A specialized version of `_.lastIndexOf` which performs strict equality\n   * comparisons of values, i.e. `===`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function strictLastIndexOf(array, value, fromIndex) {\n    var index = fromIndex + 1;\n    while (index--) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return index;\n  }\n\n  /**\n   * Gets the number of symbols in `string`.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {number} Returns the string size.\n   */\n  function stringSize(string) {\n    return hasUnicode(string)\n      ? unicodeSize(string)\n      : asciiSize(string);\n  }\n\n  /**\n   * Converts `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function stringToArray(string) {\n    return hasUnicode(string)\n      ? unicodeToArray(string)\n      : asciiToArray(string);\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n   * character of `string`.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {number} Returns the index of the last non-whitespace character.\n   */\n  function trimmedEndIndex(string) {\n    var index = string.length;\n\n    while (index-- && reWhitespace.test(string.charAt(index))) {}\n    return index;\n  }\n\n  /**\n   * Used by `_.unescape` to convert HTML entities to characters.\n   *\n   * @private\n   * @param {string} chr The matched character to unescape.\n   * @returns {string} Returns the unescaped character.\n   */\n  var unescapeHtmlChar = basePropertyOf(htmlUnescapes);\n\n  /**\n   * Gets the size of a Unicode `string`.\n   *\n   * @private\n   * @param {string} string The string inspect.\n   * @returns {number} Returns the string size.\n   */\n  function unicodeSize(string) {\n    var result = reUnicode.lastIndex = 0;\n    while (reUnicode.test(string)) {\n      ++result;\n    }\n    return result;\n  }\n\n  /**\n   * Converts a Unicode `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function unicodeToArray(string) {\n    return string.match(reUnicode) || [];\n  }\n\n  /**\n   * Splits a Unicode `string` into an array of its words.\n   *\n   * @private\n   * @param {string} The string to inspect.\n   * @returns {Array} Returns the words of `string`.\n   */\n  function unicodeWords(string) {\n    return string.match(reUnicodeWord) || [];\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Create a new pristine `lodash` function using the `context` object.\n   *\n   * @static\n   * @memberOf _\n   * @since 1.1.0\n   * @category Util\n   * @param {Object} [context=root] The context object.\n   * @returns {Function} Returns a new `lodash` function.\n   * @example\n   *\n   * _.mixin({ 'foo': _.constant('foo') });\n   *\n   * var lodash = _.runInContext();\n   * lodash.mixin({ 'bar': lodash.constant('bar') });\n   *\n   * _.isFunction(_.foo);\n   * // => true\n   * _.isFunction(_.bar);\n   * // => false\n   *\n   * lodash.isFunction(lodash.foo);\n   * // => false\n   * lodash.isFunction(lodash.bar);\n   * // => true\n   *\n   * // Create a suped-up `defer` in Node.js.\n   * var defer = _.runInContext({ 'setTimeout': setImmediate }).defer;\n   */\n  var runInContext = (function runInContext(context) {\n    context = context == null ? root : _.defaults(root.Object(), context, _.pick(root, contextProps));\n\n    /** Built-in constructor references. */\n    var Array = context.Array,\n        Date = context.Date,\n        Error = context.Error,\n        Function = context.Function,\n        Math = context.Math,\n        Object = context.Object,\n        RegExp = context.RegExp,\n        String = context.String,\n        TypeError = context.TypeError;\n\n    /** Used for built-in method references. */\n    var arrayProto = Array.prototype,\n        funcProto = Function.prototype,\n        objectProto = Object.prototype;\n\n    /** Used to detect overreaching core-js shims. */\n    var coreJsData = context['__core-js_shared__'];\n\n    /** Used to resolve the decompiled source of functions. */\n    var funcToString = funcProto.toString;\n\n    /** Used to check objects for own properties. */\n    var hasOwnProperty = objectProto.hasOwnProperty;\n\n    /** Used to generate unique IDs. */\n    var idCounter = 0;\n\n    /** Used to detect methods masquerading as native. */\n    var maskSrcKey = (function() {\n      var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n      return uid ? ('Symbol(src)_1.' + uid) : '';\n    }());\n\n    /**\n     * Used to resolve the\n     * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n     * of values.\n     */\n    var nativeObjectToString = objectProto.toString;\n\n    /** Used to infer the `Object` constructor. */\n    var objectCtorString = funcToString.call(Object);\n\n    /** Used to restore the original `_` reference in `_.noConflict`. */\n    var oldDash = root._;\n\n    /** Used to detect if a method is native. */\n    var reIsNative = RegExp('^' +\n      funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n      .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n    );\n\n    /** Built-in value references. */\n    var Buffer = moduleExports ? context.Buffer : undefined,\n        Symbol = context.Symbol,\n        Uint8Array = context.Uint8Array,\n        allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined,\n        getPrototype = overArg(Object.getPrototypeOf, Object),\n        objectCreate = Object.create,\n        propertyIsEnumerable = objectProto.propertyIsEnumerable,\n        splice = arrayProto.splice,\n        spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined,\n        symIterator = Symbol ? Symbol.iterator : undefined,\n        symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n    var defineProperty = (function() {\n      try {\n        var func = getNative(Object, 'defineProperty');\n        func({}, '', {});\n        return func;\n      } catch (e) {}\n    }());\n\n    /** Mocked built-ins. */\n    var ctxClearTimeout = context.clearTimeout !== root.clearTimeout && context.clearTimeout,\n        ctxNow = Date && Date.now !== root.Date.now && Date.now,\n        ctxSetTimeout = context.setTimeout !== root.setTimeout && context.setTimeout;\n\n    /* Built-in method references for those with the same name as other `lodash` methods. */\n    var nativeCeil = Math.ceil,\n        nativeFloor = Math.floor,\n        nativeGetSymbols = Object.getOwnPropertySymbols,\n        nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined,\n        nativeIsFinite = context.isFinite,\n        nativeJoin = arrayProto.join,\n        nativeKeys = overArg(Object.keys, Object),\n        nativeMax = Math.max,\n        nativeMin = Math.min,\n        nativeNow = Date.now,\n        nativeParseInt = context.parseInt,\n        nativeRandom = Math.random,\n        nativeReverse = arrayProto.reverse;\n\n    /* Built-in method references that are verified to be native. */\n    var DataView = getNative(context, 'DataView'),\n        Map = getNative(context, 'Map'),\n        Promise = getNative(context, 'Promise'),\n        Set = getNative(context, 'Set'),\n        WeakMap = getNative(context, 'WeakMap'),\n        nativeCreate = getNative(Object, 'create');\n\n    /** Used to store function metadata. */\n    var metaMap = WeakMap && new WeakMap;\n\n    /** Used to lookup unminified function names. */\n    var realNames = {};\n\n    /** Used to detect maps, sets, and weakmaps. */\n    var dataViewCtorString = toSource(DataView),\n        mapCtorString = toSource(Map),\n        promiseCtorString = toSource(Promise),\n        setCtorString = toSource(Set),\n        weakMapCtorString = toSource(WeakMap);\n\n    /** Used to convert symbols to primitives and strings. */\n    var symbolProto = Symbol ? Symbol.prototype : undefined,\n        symbolValueOf = symbolProto ? symbolProto.valueOf : undefined,\n        symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` object which wraps `value` to enable implicit method\n     * chain sequences. Methods that operate on and return arrays, collections,\n     * and functions can be chained together. Methods that retrieve a single value\n     * or may return a primitive value will automatically end the chain sequence\n     * and return the unwrapped value. Otherwise, the value must be unwrapped\n     * with `_#value`.\n     *\n     * Explicit chain sequences, which must be unwrapped with `_#value`, may be\n     * enabled using `_.chain`.\n     *\n     * The execution of chained methods is lazy, that is, it's deferred until\n     * `_#value` is implicitly or explicitly called.\n     *\n     * Lazy evaluation allows several methods to support shortcut fusion.\n     * Shortcut fusion is an optimization to merge iteratee calls; this avoids\n     * the creation of intermediate arrays and can greatly reduce the number of\n     * iteratee executions. Sections of a chain sequence qualify for shortcut\n     * fusion if the section is applied to an array and iteratees accept only\n     * one argument. The heuristic for whether a section qualifies for shortcut\n     * fusion is subject to change.\n     *\n     * Chaining is supported in custom builds as long as the `_#value` method is\n     * directly or indirectly included in the build.\n     *\n     * In addition to lodash methods, wrappers have `Array` and `String` methods.\n     *\n     * The wrapper `Array` methods are:\n     * `concat`, `join`, `pop`, `push`, `shift`, `sort`, `splice`, and `unshift`\n     *\n     * The wrapper `String` methods are:\n     * `replace` and `split`\n     *\n     * The wrapper methods that support shortcut fusion are:\n     * `at`, `compact`, `drop`, `dropRight`, `dropWhile`, `filter`, `find`,\n     * `findLast`, `head`, `initial`, `last`, `map`, `reject`, `reverse`, `slice`,\n     * `tail`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, and `toArray`\n     *\n     * The chainable wrapper methods are:\n     * `after`, `ary`, `assign`, `assignIn`, `assignInWith`, `assignWith`, `at`,\n     * `before`, `bind`, `bindAll`, `bindKey`, `castArray`, `chain`, `chunk`,\n     * `commit`, `compact`, `concat`, `conforms`, `constant`, `countBy`, `create`,\n     * `curry`, `debounce`, `defaults`, `defaultsDeep`, `defer`, `delay`,\n     * `difference`, `differenceBy`, `differenceWith`, `drop`, `dropRight`,\n     * `dropRightWhile`, `dropWhile`, `extend`, `extendWith`, `fill`, `filter`,\n     * `flatMap`, `flatMapDeep`, `flatMapDepth`, `flatten`, `flattenDeep`,\n     * `flattenDepth`, `flip`, `flow`, `flowRight`, `fromPairs`, `functions`,\n     * `functionsIn`, `groupBy`, `initial`, `intersection`, `intersectionBy`,\n     * `intersectionWith`, `invert`, `invertBy`, `invokeMap`, `iteratee`, `keyBy`,\n     * `keys`, `keysIn`, `map`, `mapKeys`, `mapValues`, `matches`, `matchesProperty`,\n     * `memoize`, `merge`, `mergeWith`, `method`, `methodOf`, `mixin`, `negate`,\n     * `nthArg`, `omit`, `omitBy`, `once`, `orderBy`, `over`, `overArgs`,\n     * `overEvery`, `overSome`, `partial`, `partialRight`, `partition`, `pick`,\n     * `pickBy`, `plant`, `property`, `propertyOf`, `pull`, `pullAll`, `pullAllBy`,\n     * `pullAllWith`, `pullAt`, `push`, `range`, `rangeRight`, `rearg`, `reject`,\n     * `remove`, `rest`, `reverse`, `sampleSize`, `set`, `setWith`, `shuffle`,\n     * `slice`, `sort`, `sortBy`, `splice`, `spread`, `tail`, `take`, `takeRight`,\n     * `takeRightWhile`, `takeWhile`, `tap`, `throttle`, `thru`, `toArray`,\n     * `toPairs`, `toPairsIn`, `toPath`, `toPlainObject`, `transform`, `unary`,\n     * `union`, `unionBy`, `unionWith`, `uniq`, `uniqBy`, `uniqWith`, `unset`,\n     * `unshift`, `unzip`, `unzipWith`, `update`, `updateWith`, `values`,\n     * `valuesIn`, `without`, `wrap`, `xor`, `xorBy`, `xorWith`, `zip`,\n     * `zipObject`, `zipObjectDeep`, and `zipWith`\n     *\n     * The wrapper methods that are **not** chainable by default are:\n     * `add`, `attempt`, `camelCase`, `capitalize`, `ceil`, `clamp`, `clone`,\n     * `cloneDeep`, `cloneDeepWith`, `cloneWith`, `conformsTo`, `deburr`,\n     * `defaultTo`, `divide`, `each`, `eachRight`, `endsWith`, `eq`, `escape`,\n     * `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`, `findLast`,\n     * `findLastIndex`, `findLastKey`, `first`, `floor`, `forEach`, `forEachRight`,\n     * `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `get`, `gt`, `gte`, `has`,\n     * `hasIn`, `head`, `identity`, `includes`, `indexOf`, `inRange`, `invoke`,\n     * `isArguments`, `isArray`, `isArrayBuffer`, `isArrayLike`, `isArrayLikeObject`,\n     * `isBoolean`, `isBuffer`, `isDate`, `isElement`, `isEmpty`, `isEqual`,\n     * `isEqualWith`, `isError`, `isFinite`, `isFunction`, `isInteger`, `isLength`,\n     * `isMap`, `isMatch`, `isMatchWith`, `isNaN`, `isNative`, `isNil`, `isNull`,\n     * `isNumber`, `isObject`, `isObjectLike`, `isPlainObject`, `isRegExp`,\n     * `isSafeInteger`, `isSet`, `isString`, `isUndefined`, `isTypedArray`,\n     * `isWeakMap`, `isWeakSet`, `join`, `kebabCase`, `last`, `lastIndexOf`,\n     * `lowerCase`, `lowerFirst`, `lt`, `lte`, `max`, `maxBy`, `mean`, `meanBy`,\n     * `min`, `minBy`, `multiply`, `noConflict`, `noop`, `now`, `nth`, `pad`,\n     * `padEnd`, `padStart`, `parseInt`, `pop`, `random`, `reduce`, `reduceRight`,\n     * `repeat`, `result`, `round`, `runInContext`, `sample`, `shift`, `size`,\n     * `snakeCase`, `some`, `sortedIndex`, `sortedIndexBy`, `sortedLastIndex`,\n     * `sortedLastIndexBy`, `startCase`, `startsWith`, `stubArray`, `stubFalse`,\n     * `stubObject`, `stubString`, `stubTrue`, `subtract`, `sum`, `sumBy`,\n     * `template`, `times`, `toFinite`, `toInteger`, `toJSON`, `toLength`,\n     * `toLower`, `toNumber`, `toSafeInteger`, `toString`, `toUpper`, `trim`,\n     * `trimEnd`, `trimStart`, `truncate`, `unescape`, `uniqueId`, `upperCase`,\n     * `upperFirst`, `value`, and `words`\n     *\n     * @name _\n     * @constructor\n     * @category Seq\n     * @param {*} value The value to wrap in a `lodash` instance.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var wrapped = _([1, 2, 3]);\n     *\n     * // Returns an unwrapped value.\n     * wrapped.reduce(_.add);\n     * // => 6\n     *\n     * // Returns a wrapped value.\n     * var squares = wrapped.map(square);\n     *\n     * _.isArray(squares);\n     * // => false\n     *\n     * _.isArray(squares.value());\n     * // => true\n     */\n    function lodash(value) {\n      if (isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)) {\n        if (value instanceof LodashWrapper) {\n          return value;\n        }\n        if (hasOwnProperty.call(value, '__wrapped__')) {\n          return wrapperClone(value);\n        }\n      }\n      return new LodashWrapper(value);\n    }\n\n    /**\n     * The base implementation of `_.create` without support for assigning\n     * properties to the created object.\n     *\n     * @private\n     * @param {Object} proto The object to inherit from.\n     * @returns {Object} Returns the new object.\n     */\n    var baseCreate = (function() {\n      function object() {}\n      return function(proto) {\n        if (!isObject(proto)) {\n          return {};\n        }\n        if (objectCreate) {\n          return objectCreate(proto);\n        }\n        object.prototype = proto;\n        var result = new object;\n        object.prototype = undefined;\n        return result;\n      };\n    }());\n\n    /**\n     * The function whose prototype chain sequence wrappers inherit from.\n     *\n     * @private\n     */\n    function baseLodash() {\n      // No operation performed.\n    }\n\n    /**\n     * The base constructor for creating `lodash` wrapper objects.\n     *\n     * @private\n     * @param {*} value The value to wrap.\n     * @param {boolean} [chainAll] Enable explicit method chain sequences.\n     */\n    function LodashWrapper(value, chainAll) {\n      this.__wrapped__ = value;\n      this.__actions__ = [];\n      this.__chain__ = !!chainAll;\n      this.__index__ = 0;\n      this.__values__ = undefined;\n    }\n\n    /**\n     * By default, the template delimiters used by lodash are like those in\n     * embedded Ruby (ERB) as well as ES2015 template strings. Change the\n     * following template settings to use alternative delimiters.\n     *\n     * @static\n     * @memberOf _\n     * @type {Object}\n     */\n    lodash.templateSettings = {\n\n      /**\n       * Used to detect `data` property values to be HTML-escaped.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'escape': reEscape,\n\n      /**\n       * Used to detect code to be evaluated.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'evaluate': reEvaluate,\n\n      /**\n       * Used to detect `data` property values to inject.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'interpolate': reInterpolate,\n\n      /**\n       * Used to reference the data object in the template text.\n       *\n       * @memberOf _.templateSettings\n       * @type {string}\n       */\n      'variable': '',\n\n      /**\n       * Used to import variables into the compiled template.\n       *\n       * @memberOf _.templateSettings\n       * @type {Object}\n       */\n      'imports': {\n\n        /**\n         * A reference to the `lodash` function.\n         *\n         * @memberOf _.templateSettings.imports\n         * @type {Function}\n         */\n        '_': lodash\n      }\n    };\n\n    // Ensure wrappers are instances of `baseLodash`.\n    lodash.prototype = baseLodash.prototype;\n    lodash.prototype.constructor = lodash;\n\n    LodashWrapper.prototype = baseCreate(baseLodash.prototype);\n    LodashWrapper.prototype.constructor = LodashWrapper;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.\n     *\n     * @private\n     * @constructor\n     * @param {*} value The value to wrap.\n     */\n    function LazyWrapper(value) {\n      this.__wrapped__ = value;\n      this.__actions__ = [];\n      this.__dir__ = 1;\n      this.__filtered__ = false;\n      this.__iteratees__ = [];\n      this.__takeCount__ = MAX_ARRAY_LENGTH;\n      this.__views__ = [];\n    }\n\n    /**\n     * Creates a clone of the lazy wrapper object.\n     *\n     * @private\n     * @name clone\n     * @memberOf LazyWrapper\n     * @returns {Object} Returns the cloned `LazyWrapper` object.\n     */\n    function lazyClone() {\n      var result = new LazyWrapper(this.__wrapped__);\n      result.__actions__ = copyArray(this.__actions__);\n      result.__dir__ = this.__dir__;\n      result.__filtered__ = this.__filtered__;\n      result.__iteratees__ = copyArray(this.__iteratees__);\n      result.__takeCount__ = this.__takeCount__;\n      result.__views__ = copyArray(this.__views__);\n      return result;\n    }\n\n    /**\n     * Reverses the direction of lazy iteration.\n     *\n     * @private\n     * @name reverse\n     * @memberOf LazyWrapper\n     * @returns {Object} Returns the new reversed `LazyWrapper` object.\n     */\n    function lazyReverse() {\n      if (this.__filtered__) {\n        var result = new LazyWrapper(this);\n        result.__dir__ = -1;\n        result.__filtered__ = true;\n      } else {\n        result = this.clone();\n        result.__dir__ *= -1;\n      }\n      return result;\n    }\n\n    /**\n     * Extracts the unwrapped value from its lazy wrapper.\n     *\n     * @private\n     * @name value\n     * @memberOf LazyWrapper\n     * @returns {*} Returns the unwrapped value.\n     */\n    function lazyValue() {\n      var array = this.__wrapped__.value(),\n          dir = this.__dir__,\n          isArr = isArray(array),\n          isRight = dir < 0,\n          arrLength = isArr ? array.length : 0,\n          view = getView(0, arrLength, this.__views__),\n          start = view.start,\n          end = view.end,\n          length = end - start,\n          index = isRight ? end : (start - 1),\n          iteratees = this.__iteratees__,\n          iterLength = iteratees.length,\n          resIndex = 0,\n          takeCount = nativeMin(length, this.__takeCount__);\n\n      if (!isArr || (!isRight && arrLength == length && takeCount == length)) {\n        return baseWrapperValue(array, this.__actions__);\n      }\n      var result = [];\n\n      outer:\n      while (length-- && resIndex < takeCount) {\n        index += dir;\n\n        var iterIndex = -1,\n            value = array[index];\n\n        while (++iterIndex < iterLength) {\n          var data = iteratees[iterIndex],\n              iteratee = data.iteratee,\n              type = data.type,\n              computed = iteratee(value);\n\n          if (type == LAZY_MAP_FLAG) {\n            value = computed;\n          } else if (!computed) {\n            if (type == LAZY_FILTER_FLAG) {\n              continue outer;\n            } else {\n              break outer;\n            }\n          }\n        }\n        result[resIndex++] = value;\n      }\n      return result;\n    }\n\n    // Ensure `LazyWrapper` is an instance of `baseLodash`.\n    LazyWrapper.prototype = baseCreate(baseLodash.prototype);\n    LazyWrapper.prototype.constructor = LazyWrapper;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a hash object.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function Hash(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the hash.\n     *\n     * @private\n     * @name clear\n     * @memberOf Hash\n     */\n    function hashClear() {\n      this.__data__ = nativeCreate ? nativeCreate(null) : {};\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the hash.\n     *\n     * @private\n     * @name delete\n     * @memberOf Hash\n     * @param {Object} hash The hash to modify.\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function hashDelete(key) {\n      var result = this.has(key) && delete this.__data__[key];\n      this.size -= result ? 1 : 0;\n      return result;\n    }\n\n    /**\n     * Gets the hash value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf Hash\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function hashGet(key) {\n      var data = this.__data__;\n      if (nativeCreate) {\n        var result = data[key];\n        return result === HASH_UNDEFINED ? undefined : result;\n      }\n      return hasOwnProperty.call(data, key) ? data[key] : undefined;\n    }\n\n    /**\n     * Checks if a hash value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf Hash\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function hashHas(key) {\n      var data = this.__data__;\n      return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n    }\n\n    /**\n     * Sets the hash `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf Hash\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the hash instance.\n     */\n    function hashSet(key, value) {\n      var data = this.__data__;\n      this.size += this.has(key) ? 0 : 1;\n      data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n      return this;\n    }\n\n    // Add methods to `Hash`.\n    Hash.prototype.clear = hashClear;\n    Hash.prototype['delete'] = hashDelete;\n    Hash.prototype.get = hashGet;\n    Hash.prototype.has = hashHas;\n    Hash.prototype.set = hashSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an list cache object.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function ListCache(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the list cache.\n     *\n     * @private\n     * @name clear\n     * @memberOf ListCache\n     */\n    function listCacheClear() {\n      this.__data__ = [];\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the list cache.\n     *\n     * @private\n     * @name delete\n     * @memberOf ListCache\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function listCacheDelete(key) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      if (index < 0) {\n        return false;\n      }\n      var lastIndex = data.length - 1;\n      if (index == lastIndex) {\n        data.pop();\n      } else {\n        splice.call(data, index, 1);\n      }\n      --this.size;\n      return true;\n    }\n\n    /**\n     * Gets the list cache value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf ListCache\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function listCacheGet(key) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      return index < 0 ? undefined : data[index][1];\n    }\n\n    /**\n     * Checks if a list cache value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf ListCache\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function listCacheHas(key) {\n      return assocIndexOf(this.__data__, key) > -1;\n    }\n\n    /**\n     * Sets the list cache `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf ListCache\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the list cache instance.\n     */\n    function listCacheSet(key, value) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      if (index < 0) {\n        ++this.size;\n        data.push([key, value]);\n      } else {\n        data[index][1] = value;\n      }\n      return this;\n    }\n\n    // Add methods to `ListCache`.\n    ListCache.prototype.clear = listCacheClear;\n    ListCache.prototype['delete'] = listCacheDelete;\n    ListCache.prototype.get = listCacheGet;\n    ListCache.prototype.has = listCacheHas;\n    ListCache.prototype.set = listCacheSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a map cache object to store key-value pairs.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function MapCache(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the map.\n     *\n     * @private\n     * @name clear\n     * @memberOf MapCache\n     */\n    function mapCacheClear() {\n      this.size = 0;\n      this.__data__ = {\n        'hash': new Hash,\n        'map': new (Map || ListCache),\n        'string': new Hash\n      };\n    }\n\n    /**\n     * Removes `key` and its value from the map.\n     *\n     * @private\n     * @name delete\n     * @memberOf MapCache\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function mapCacheDelete(key) {\n      var result = getMapData(this, key)['delete'](key);\n      this.size -= result ? 1 : 0;\n      return result;\n    }\n\n    /**\n     * Gets the map value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf MapCache\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function mapCacheGet(key) {\n      return getMapData(this, key).get(key);\n    }\n\n    /**\n     * Checks if a map value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf MapCache\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function mapCacheHas(key) {\n      return getMapData(this, key).has(key);\n    }\n\n    /**\n     * Sets the map `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf MapCache\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the map cache instance.\n     */\n    function mapCacheSet(key, value) {\n      var data = getMapData(this, key),\n          size = data.size;\n\n      data.set(key, value);\n      this.size += data.size == size ? 0 : 1;\n      return this;\n    }\n\n    // Add methods to `MapCache`.\n    MapCache.prototype.clear = mapCacheClear;\n    MapCache.prototype['delete'] = mapCacheDelete;\n    MapCache.prototype.get = mapCacheGet;\n    MapCache.prototype.has = mapCacheHas;\n    MapCache.prototype.set = mapCacheSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     *\n     * Creates an array cache object to store unique values.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [values] The values to cache.\n     */\n    function SetCache(values) {\n      var index = -1,\n          length = values == null ? 0 : values.length;\n\n      this.__data__ = new MapCache;\n      while (++index < length) {\n        this.add(values[index]);\n      }\n    }\n\n    /**\n     * Adds `value` to the array cache.\n     *\n     * @private\n     * @name add\n     * @memberOf SetCache\n     * @alias push\n     * @param {*} value The value to cache.\n     * @returns {Object} Returns the cache instance.\n     */\n    function setCacheAdd(value) {\n      this.__data__.set(value, HASH_UNDEFINED);\n      return this;\n    }\n\n    /**\n     * Checks if `value` is in the array cache.\n     *\n     * @private\n     * @name has\n     * @memberOf SetCache\n     * @param {*} value The value to search for.\n     * @returns {number} Returns `true` if `value` is found, else `false`.\n     */\n    function setCacheHas(value) {\n      return this.__data__.has(value);\n    }\n\n    // Add methods to `SetCache`.\n    SetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\n    SetCache.prototype.has = setCacheHas;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a stack cache object to store key-value pairs.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function Stack(entries) {\n      var data = this.__data__ = new ListCache(entries);\n      this.size = data.size;\n    }\n\n    /**\n     * Removes all key-value entries from the stack.\n     *\n     * @private\n     * @name clear\n     * @memberOf Stack\n     */\n    function stackClear() {\n      this.__data__ = new ListCache;\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the stack.\n     *\n     * @private\n     * @name delete\n     * @memberOf Stack\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function stackDelete(key) {\n      var data = this.__data__,\n          result = data['delete'](key);\n\n      this.size = data.size;\n      return result;\n    }\n\n    /**\n     * Gets the stack value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf Stack\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function stackGet(key) {\n      return this.__data__.get(key);\n    }\n\n    /**\n     * Checks if a stack value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf Stack\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function stackHas(key) {\n      return this.__data__.has(key);\n    }\n\n    /**\n     * Sets the stack `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf Stack\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the stack cache instance.\n     */\n    function stackSet(key, value) {\n      var data = this.__data__;\n      if (data instanceof ListCache) {\n        var pairs = data.__data__;\n        if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n          pairs.push([key, value]);\n          this.size = ++data.size;\n          return this;\n        }\n        data = this.__data__ = new MapCache(pairs);\n      }\n      data.set(key, value);\n      this.size = data.size;\n      return this;\n    }\n\n    // Add methods to `Stack`.\n    Stack.prototype.clear = stackClear;\n    Stack.prototype['delete'] = stackDelete;\n    Stack.prototype.get = stackGet;\n    Stack.prototype.has = stackHas;\n    Stack.prototype.set = stackSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of the enumerable property names of the array-like `value`.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @param {boolean} inherited Specify returning inherited property names.\n     * @returns {Array} Returns the array of property names.\n     */\n    function arrayLikeKeys(value, inherited) {\n      var isArr = isArray(value),\n          isArg = !isArr && isArguments(value),\n          isBuff = !isArr && !isArg && isBuffer(value),\n          isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n          skipIndexes = isArr || isArg || isBuff || isType,\n          result = skipIndexes ? baseTimes(value.length, String) : [],\n          length = result.length;\n\n      for (var key in value) {\n        if ((inherited || hasOwnProperty.call(value, key)) &&\n            !(skipIndexes && (\n               // Safari 9 has enumerable `arguments.length` in strict mode.\n               key == 'length' ||\n               // Node.js 0.10 has enumerable non-index properties on buffers.\n               (isBuff && (key == 'offset' || key == 'parent')) ||\n               // PhantomJS 2 has enumerable non-index properties on typed arrays.\n               (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n               // Skip index properties.\n               isIndex(key, length)\n            ))) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * A specialized version of `_.sample` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to sample.\n     * @returns {*} Returns the random element.\n     */\n    function arraySample(array) {\n      var length = array.length;\n      return length ? array[baseRandom(0, length - 1)] : undefined;\n    }\n\n    /**\n     * A specialized version of `_.sampleSize` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to sample.\n     * @param {number} n The number of elements to sample.\n     * @returns {Array} Returns the random elements.\n     */\n    function arraySampleSize(array, n) {\n      return shuffleSelf(copyArray(array), baseClamp(n, 0, array.length));\n    }\n\n    /**\n     * A specialized version of `_.shuffle` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     */\n    function arrayShuffle(array) {\n      return shuffleSelf(copyArray(array));\n    }\n\n    /**\n     * This function is like `assignValue` except that it doesn't assign\n     * `undefined` values.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function assignMergeValue(object, key, value) {\n      if ((value !== undefined && !eq(object[key], value)) ||\n          (value === undefined && !(key in object))) {\n        baseAssignValue(object, key, value);\n      }\n    }\n\n    /**\n     * Assigns `value` to `key` of `object` if the existing value is not equivalent\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function assignValue(object, key, value) {\n      var objValue = object[key];\n      if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n          (value === undefined && !(key in object))) {\n        baseAssignValue(object, key, value);\n      }\n    }\n\n    /**\n     * Gets the index at which the `key` is found in `array` of key-value pairs.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {*} key The key to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     */\n    function assocIndexOf(array, key) {\n      var length = array.length;\n      while (length--) {\n        if (eq(array[length][0], key)) {\n          return length;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * Aggregates elements of `collection` on `accumulator` with keys transformed\n     * by `iteratee` and values set by `setter`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} setter The function to set `accumulator` values.\n     * @param {Function} iteratee The iteratee to transform keys.\n     * @param {Object} accumulator The initial aggregated object.\n     * @returns {Function} Returns `accumulator`.\n     */\n    function baseAggregator(collection, setter, iteratee, accumulator) {\n      baseEach(collection, function(value, key, collection) {\n        setter(accumulator, value, iteratee(value), collection);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The base implementation of `_.assign` without support for multiple sources\n     * or `customizer` functions.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @returns {Object} Returns `object`.\n     */\n    function baseAssign(object, source) {\n      return object && copyObject(source, keys(source), object);\n    }\n\n    /**\n     * The base implementation of `_.assignIn` without support for multiple sources\n     * or `customizer` functions.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @returns {Object} Returns `object`.\n     */\n    function baseAssignIn(object, source) {\n      return object && copyObject(source, keysIn(source), object);\n    }\n\n    /**\n     * The base implementation of `assignValue` and `assignMergeValue` without\n     * value checks.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function baseAssignValue(object, key, value) {\n      if (key == '__proto__' && defineProperty) {\n        defineProperty(object, key, {\n          'configurable': true,\n          'enumerable': true,\n          'value': value,\n          'writable': true\n        });\n      } else {\n        object[key] = value;\n      }\n    }\n\n    /**\n     * The base implementation of `_.at` without support for individual paths.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {string[]} paths The property paths to pick.\n     * @returns {Array} Returns the picked elements.\n     */\n    function baseAt(object, paths) {\n      var index = -1,\n          length = paths.length,\n          result = Array(length),\n          skip = object == null;\n\n      while (++index < length) {\n        result[index] = skip ? undefined : get(object, paths[index]);\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.clamp` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {number} number The number to clamp.\n     * @param {number} [lower] The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the clamped number.\n     */\n    function baseClamp(number, lower, upper) {\n      if (number === number) {\n        if (upper !== undefined) {\n          number = number <= upper ? number : upper;\n        }\n        if (lower !== undefined) {\n          number = number >= lower ? number : lower;\n        }\n      }\n      return number;\n    }\n\n    /**\n     * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n     * traversed objects.\n     *\n     * @private\n     * @param {*} value The value to clone.\n     * @param {boolean} bitmask The bitmask flags.\n     *  1 - Deep clone\n     *  2 - Flatten inherited properties\n     *  4 - Clone symbols\n     * @param {Function} [customizer] The function to customize cloning.\n     * @param {string} [key] The key of `value`.\n     * @param {Object} [object] The parent object of `value`.\n     * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n     * @returns {*} Returns the cloned value.\n     */\n    function baseClone(value, bitmask, customizer, key, object, stack) {\n      var result,\n          isDeep = bitmask & CLONE_DEEP_FLAG,\n          isFlat = bitmask & CLONE_FLAT_FLAG,\n          isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n      if (customizer) {\n        result = object ? customizer(value, key, object, stack) : customizer(value);\n      }\n      if (result !== undefined) {\n        return result;\n      }\n      if (!isObject(value)) {\n        return value;\n      }\n      var isArr = isArray(value);\n      if (isArr) {\n        result = initCloneArray(value);\n        if (!isDeep) {\n          return copyArray(value, result);\n        }\n      } else {\n        var tag = getTag(value),\n            isFunc = tag == funcTag || tag == genTag;\n\n        if (isBuffer(value)) {\n          return cloneBuffer(value, isDeep);\n        }\n        if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n          result = (isFlat || isFunc) ? {} : initCloneObject(value);\n          if (!isDeep) {\n            return isFlat\n              ? copySymbolsIn(value, baseAssignIn(result, value))\n              : copySymbols(value, baseAssign(result, value));\n          }\n        } else {\n          if (!cloneableTags[tag]) {\n            return object ? value : {};\n          }\n          result = initCloneByTag(value, tag, isDeep);\n        }\n      }\n      // Check for circular references and return its corresponding clone.\n      stack || (stack = new Stack);\n      var stacked = stack.get(value);\n      if (stacked) {\n        return stacked;\n      }\n      stack.set(value, result);\n\n      if (isSet(value)) {\n        value.forEach(function(subValue) {\n          result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n        });\n      } else if (isMap(value)) {\n        value.forEach(function(subValue, key) {\n          result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n        });\n      }\n\n      var keysFunc = isFull\n        ? (isFlat ? getAllKeysIn : getAllKeys)\n        : (isFlat ? keysIn : keys);\n\n      var props = isArr ? undefined : keysFunc(value);\n      arrayEach(props || value, function(subValue, key) {\n        if (props) {\n          key = subValue;\n          subValue = value[key];\n        }\n        // Recursively populate clone (susceptible to call stack limits).\n        assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.conforms` which doesn't clone `source`.\n     *\n     * @private\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseConforms(source) {\n      var props = keys(source);\n      return function(object) {\n        return baseConformsTo(object, source, props);\n      };\n    }\n\n    /**\n     * The base implementation of `_.conformsTo` which accepts `props` to check.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {boolean} Returns `true` if `object` conforms, else `false`.\n     */\n    function baseConformsTo(object, source, props) {\n      var length = props.length;\n      if (object == null) {\n        return !length;\n      }\n      object = Object(object);\n      while (length--) {\n        var key = props[length],\n            predicate = source[key],\n            value = object[key];\n\n        if ((value === undefined && !(key in object)) || !predicate(value)) {\n          return false;\n        }\n      }\n      return true;\n    }\n\n    /**\n     * The base implementation of `_.delay` and `_.defer` which accepts `args`\n     * to provide to `func`.\n     *\n     * @private\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @param {Array} args The arguments to provide to `func`.\n     * @returns {number|Object} Returns the timer id or timeout object.\n     */\n    function baseDelay(func, wait, args) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      return setTimeout(function() { func.apply(undefined, args); }, wait);\n    }\n\n    /**\n     * The base implementation of methods like `_.difference` without support\n     * for excluding multiple arrays or iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Array} values The values to exclude.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     */\n    function baseDifference(array, values, iteratee, comparator) {\n      var index = -1,\n          includes = arrayIncludes,\n          isCommon = true,\n          length = array.length,\n          result = [],\n          valuesLength = values.length;\n\n      if (!length) {\n        return result;\n      }\n      if (iteratee) {\n        values = arrayMap(values, baseUnary(iteratee));\n      }\n      if (comparator) {\n        includes = arrayIncludesWith;\n        isCommon = false;\n      }\n      else if (values.length >= LARGE_ARRAY_SIZE) {\n        includes = cacheHas;\n        isCommon = false;\n        values = new SetCache(values);\n      }\n      outer:\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee == null ? value : iteratee(value);\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (isCommon && computed === computed) {\n          var valuesIndex = valuesLength;\n          while (valuesIndex--) {\n            if (values[valuesIndex] === computed) {\n              continue outer;\n            }\n          }\n          result.push(value);\n        }\n        else if (!includes(values, computed, comparator)) {\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.forEach` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     */\n    var baseEach = createBaseEach(baseForOwn);\n\n    /**\n     * The base implementation of `_.forEachRight` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     */\n    var baseEachRight = createBaseEach(baseForOwnRight, true);\n\n    /**\n     * The base implementation of `_.every` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {boolean} Returns `true` if all elements pass the predicate check,\n     *  else `false`\n     */\n    function baseEvery(collection, predicate) {\n      var result = true;\n      baseEach(collection, function(value, index, collection) {\n        result = !!predicate(value, index, collection);\n        return result;\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of methods like `_.max` and `_.min` which accepts a\n     * `comparator` to determine the extremum value.\n     *\n     * @private\n     * @param {Array} array The array to iterate over.\n     * @param {Function} iteratee The iteratee invoked per iteration.\n     * @param {Function} comparator The comparator used to compare values.\n     * @returns {*} Returns the extremum value.\n     */\n    function baseExtremum(array, iteratee, comparator) {\n      var index = -1,\n          length = array.length;\n\n      while (++index < length) {\n        var value = array[index],\n            current = iteratee(value);\n\n        if (current != null && (computed === undefined\n              ? (current === current && !isSymbol(current))\n              : comparator(current, computed)\n            )) {\n          var computed = current,\n              result = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.fill` without an iteratee call guard.\n     *\n     * @private\n     * @param {Array} array The array to fill.\n     * @param {*} value The value to fill `array` with.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns `array`.\n     */\n    function baseFill(array, value, start, end) {\n      var length = array.length;\n\n      start = toInteger(start);\n      if (start < 0) {\n        start = -start > length ? 0 : (length + start);\n      }\n      end = (end === undefined || end > length) ? length : toInteger(end);\n      if (end < 0) {\n        end += length;\n      }\n      end = start > end ? 0 : toLength(end);\n      while (start < end) {\n        array[start++] = value;\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.filter` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     */\n    function baseFilter(collection, predicate) {\n      var result = [];\n      baseEach(collection, function(value, index, collection) {\n        if (predicate(value, index, collection)) {\n          result.push(value);\n        }\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.flatten` with support for restricting flattening.\n     *\n     * @private\n     * @param {Array} array The array to flatten.\n     * @param {number} depth The maximum recursion depth.\n     * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n     * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n     * @param {Array} [result=[]] The initial result value.\n     * @returns {Array} Returns the new flattened array.\n     */\n    function baseFlatten(array, depth, predicate, isStrict, result) {\n      var index = -1,\n          length = array.length;\n\n      predicate || (predicate = isFlattenable);\n      result || (result = []);\n\n      while (++index < length) {\n        var value = array[index];\n        if (depth > 0 && predicate(value)) {\n          if (depth > 1) {\n            // Recursively flatten arrays (susceptible to call stack limits).\n            baseFlatten(value, depth - 1, predicate, isStrict, result);\n          } else {\n            arrayPush(result, value);\n          }\n        } else if (!isStrict) {\n          result[result.length] = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `baseForOwn` which iterates over `object`\n     * properties returned by `keysFunc` and invokes `iteratee` for each property.\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @returns {Object} Returns `object`.\n     */\n    var baseFor = createBaseFor();\n\n    /**\n     * This function is like `baseFor` except that it iterates over properties\n     * in the opposite order.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @returns {Object} Returns `object`.\n     */\n    var baseForRight = createBaseFor(true);\n\n    /**\n     * The base implementation of `_.forOwn` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     */\n    function baseForOwn(object, iteratee) {\n      return object && baseFor(object, iteratee, keys);\n    }\n\n    /**\n     * The base implementation of `_.forOwnRight` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     */\n    function baseForOwnRight(object, iteratee) {\n      return object && baseForRight(object, iteratee, keys);\n    }\n\n    /**\n     * The base implementation of `_.functions` which creates an array of\n     * `object` function property names filtered from `props`.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Array} props The property names to filter.\n     * @returns {Array} Returns the function names.\n     */\n    function baseFunctions(object, props) {\n      return arrayFilter(props, function(key) {\n        return isFunction(object[key]);\n      });\n    }\n\n    /**\n     * The base implementation of `_.get` without support for default values.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to get.\n     * @returns {*} Returns the resolved value.\n     */\n    function baseGet(object, path) {\n      path = castPath(path, object);\n\n      var index = 0,\n          length = path.length;\n\n      while (object != null && index < length) {\n        object = object[toKey(path[index++])];\n      }\n      return (index && index == length) ? object : undefined;\n    }\n\n    /**\n     * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n     * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n     * symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @param {Function} symbolsFunc The function to get the symbols of `object`.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function baseGetAllKeys(object, keysFunc, symbolsFunc) {\n      var result = keysFunc(object);\n      return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n    }\n\n    /**\n     * The base implementation of `getTag` without fallbacks for buggy environments.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the `toStringTag`.\n     */\n    function baseGetTag(value) {\n      if (value == null) {\n        return value === undefined ? undefinedTag : nullTag;\n      }\n      return (symToStringTag && symToStringTag in Object(value))\n        ? getRawTag(value)\n        : objectToString(value);\n    }\n\n    /**\n     * The base implementation of `_.gt` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than `other`,\n     *  else `false`.\n     */\n    function baseGt(value, other) {\n      return value > other;\n    }\n\n    /**\n     * The base implementation of `_.has` without support for deep paths.\n     *\n     * @private\n     * @param {Object} [object] The object to query.\n     * @param {Array|string} key The key to check.\n     * @returns {boolean} Returns `true` if `key` exists, else `false`.\n     */\n    function baseHas(object, key) {\n      return object != null && hasOwnProperty.call(object, key);\n    }\n\n    /**\n     * The base implementation of `_.hasIn` without support for deep paths.\n     *\n     * @private\n     * @param {Object} [object] The object to query.\n     * @param {Array|string} key The key to check.\n     * @returns {boolean} Returns `true` if `key` exists, else `false`.\n     */\n    function baseHasIn(object, key) {\n      return object != null && key in Object(object);\n    }\n\n    /**\n     * The base implementation of `_.inRange` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {number} number The number to check.\n     * @param {number} start The start of the range.\n     * @param {number} end The end of the range.\n     * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n     */\n    function baseInRange(number, start, end) {\n      return number >= nativeMin(start, end) && number < nativeMax(start, end);\n    }\n\n    /**\n     * The base implementation of methods like `_.intersection`, without support\n     * for iteratee shorthands, that accepts an array of arrays to inspect.\n     *\n     * @private\n     * @param {Array} arrays The arrays to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of shared values.\n     */\n    function baseIntersection(arrays, iteratee, comparator) {\n      var includes = comparator ? arrayIncludesWith : arrayIncludes,\n          length = arrays[0].length,\n          othLength = arrays.length,\n          othIndex = othLength,\n          caches = Array(othLength),\n          maxLength = Infinity,\n          result = [];\n\n      while (othIndex--) {\n        var array = arrays[othIndex];\n        if (othIndex && iteratee) {\n          array = arrayMap(array, baseUnary(iteratee));\n        }\n        maxLength = nativeMin(array.length, maxLength);\n        caches[othIndex] = !comparator && (iteratee || (length >= 120 && array.length >= 120))\n          ? new SetCache(othIndex && array)\n          : undefined;\n      }\n      array = arrays[0];\n\n      var index = -1,\n          seen = caches[0];\n\n      outer:\n      while (++index < length && result.length < maxLength) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (!(seen\n              ? cacheHas(seen, computed)\n              : includes(result, computed, comparator)\n            )) {\n          othIndex = othLength;\n          while (--othIndex) {\n            var cache = caches[othIndex];\n            if (!(cache\n                  ? cacheHas(cache, computed)\n                  : includes(arrays[othIndex], computed, comparator))\n                ) {\n              continue outer;\n            }\n          }\n          if (seen) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.invert` and `_.invertBy` which inverts\n     * `object` with values transformed by `iteratee` and set by `setter`.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} setter The function to set `accumulator` values.\n     * @param {Function} iteratee The iteratee to transform values.\n     * @param {Object} accumulator The initial inverted object.\n     * @returns {Function} Returns `accumulator`.\n     */\n    function baseInverter(object, setter, iteratee, accumulator) {\n      baseForOwn(object, function(value, key, object) {\n        setter(accumulator, iteratee(value), key, object);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The base implementation of `_.invoke` without support for individual\n     * method arguments.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {Array} args The arguments to invoke the method with.\n     * @returns {*} Returns the result of the invoked method.\n     */\n    function baseInvoke(object, path, args) {\n      path = castPath(path, object);\n      object = parent(object, path);\n      var func = object == null ? object : object[toKey(last(path))];\n      return func == null ? undefined : apply(func, object, args);\n    }\n\n    /**\n     * The base implementation of `_.isArguments`.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n     */\n    function baseIsArguments(value) {\n      return isObjectLike(value) && baseGetTag(value) == argsTag;\n    }\n\n    /**\n     * The base implementation of `_.isArrayBuffer` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.\n     */\n    function baseIsArrayBuffer(value) {\n      return isObjectLike(value) && baseGetTag(value) == arrayBufferTag;\n    }\n\n    /**\n     * The base implementation of `_.isDate` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a date object, else `false`.\n     */\n    function baseIsDate(value) {\n      return isObjectLike(value) && baseGetTag(value) == dateTag;\n    }\n\n    /**\n     * The base implementation of `_.isEqual` which supports partial comparisons\n     * and tracks traversed objects.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @param {boolean} bitmask The bitmask flags.\n     *  1 - Unordered comparison\n     *  2 - Partial comparison\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     */\n    function baseIsEqual(value, other, bitmask, customizer, stack) {\n      if (value === other) {\n        return true;\n      }\n      if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n        return value !== value && other !== other;\n      }\n      return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n    }\n\n    /**\n     * A specialized version of `baseIsEqual` for arrays and objects which performs\n     * deep comparisons and tracks traversed objects enabling objects with circular\n     * references to be compared.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n      var objIsArr = isArray(object),\n          othIsArr = isArray(other),\n          objTag = objIsArr ? arrayTag : getTag(object),\n          othTag = othIsArr ? arrayTag : getTag(other);\n\n      objTag = objTag == argsTag ? objectTag : objTag;\n      othTag = othTag == argsTag ? objectTag : othTag;\n\n      var objIsObj = objTag == objectTag,\n          othIsObj = othTag == objectTag,\n          isSameTag = objTag == othTag;\n\n      if (isSameTag && isBuffer(object)) {\n        if (!isBuffer(other)) {\n          return false;\n        }\n        objIsArr = true;\n        objIsObj = false;\n      }\n      if (isSameTag && !objIsObj) {\n        stack || (stack = new Stack);\n        return (objIsArr || isTypedArray(object))\n          ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n          : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n      }\n      if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n        var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n            othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n        if (objIsWrapped || othIsWrapped) {\n          var objUnwrapped = objIsWrapped ? object.value() : object,\n              othUnwrapped = othIsWrapped ? other.value() : other;\n\n          stack || (stack = new Stack);\n          return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n        }\n      }\n      if (!isSameTag) {\n        return false;\n      }\n      stack || (stack = new Stack);\n      return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n    }\n\n    /**\n     * The base implementation of `_.isMap` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n     */\n    function baseIsMap(value) {\n      return isObjectLike(value) && getTag(value) == mapTag;\n    }\n\n    /**\n     * The base implementation of `_.isMatch` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @param {Array} matchData The property names, values, and compare flags to match.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     */\n    function baseIsMatch(object, source, matchData, customizer) {\n      var index = matchData.length,\n          length = index,\n          noCustomizer = !customizer;\n\n      if (object == null) {\n        return !length;\n      }\n      object = Object(object);\n      while (index--) {\n        var data = matchData[index];\n        if ((noCustomizer && data[2])\n              ? data[1] !== object[data[0]]\n              : !(data[0] in object)\n            ) {\n          return false;\n        }\n      }\n      while (++index < length) {\n        data = matchData[index];\n        var key = data[0],\n            objValue = object[key],\n            srcValue = data[1];\n\n        if (noCustomizer && data[2]) {\n          if (objValue === undefined && !(key in object)) {\n            return false;\n          }\n        } else {\n          var stack = new Stack;\n          if (customizer) {\n            var result = customizer(objValue, srcValue, key, object, source, stack);\n          }\n          if (!(result === undefined\n                ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n                : result\n              )) {\n            return false;\n          }\n        }\n      }\n      return true;\n    }\n\n    /**\n     * The base implementation of `_.isNative` without bad shim checks.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a native function,\n     *  else `false`.\n     */\n    function baseIsNative(value) {\n      if (!isObject(value) || isMasked(value)) {\n        return false;\n      }\n      var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n      return pattern.test(toSource(value));\n    }\n\n    /**\n     * The base implementation of `_.isRegExp` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.\n     */\n    function baseIsRegExp(value) {\n      return isObjectLike(value) && baseGetTag(value) == regexpTag;\n    }\n\n    /**\n     * The base implementation of `_.isSet` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n     */\n    function baseIsSet(value) {\n      return isObjectLike(value) && getTag(value) == setTag;\n    }\n\n    /**\n     * The base implementation of `_.isTypedArray` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n     */\n    function baseIsTypedArray(value) {\n      return isObjectLike(value) &&\n        isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n    }\n\n    /**\n     * The base implementation of `_.iteratee`.\n     *\n     * @private\n     * @param {*} [value=_.identity] The value to convert to an iteratee.\n     * @returns {Function} Returns the iteratee.\n     */\n    function baseIteratee(value) {\n      // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n      // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n      if (typeof value == 'function') {\n        return value;\n      }\n      if (value == null) {\n        return identity;\n      }\n      if (typeof value == 'object') {\n        return isArray(value)\n          ? baseMatchesProperty(value[0], value[1])\n          : baseMatches(value);\n      }\n      return property(value);\n    }\n\n    /**\n     * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function baseKeys(object) {\n      if (!isPrototype(object)) {\n        return nativeKeys(object);\n      }\n      var result = [];\n      for (var key in Object(object)) {\n        if (hasOwnProperty.call(object, key) && key != 'constructor') {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function baseKeysIn(object) {\n      if (!isObject(object)) {\n        return nativeKeysIn(object);\n      }\n      var isProto = isPrototype(object),\n          result = [];\n\n      for (var key in object) {\n        if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.lt` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than `other`,\n     *  else `false`.\n     */\n    function baseLt(value, other) {\n      return value < other;\n    }\n\n    /**\n     * The base implementation of `_.map` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array} Returns the new mapped array.\n     */\n    function baseMap(collection, iteratee) {\n      var index = -1,\n          result = isArrayLike(collection) ? Array(collection.length) : [];\n\n      baseEach(collection, function(value, key, collection) {\n        result[++index] = iteratee(value, key, collection);\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.matches` which doesn't clone `source`.\n     *\n     * @private\n     * @param {Object} source The object of property values to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseMatches(source) {\n      var matchData = getMatchData(source);\n      if (matchData.length == 1 && matchData[0][2]) {\n        return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n      }\n      return function(object) {\n        return object === source || baseIsMatch(object, source, matchData);\n      };\n    }\n\n    /**\n     * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n     *\n     * @private\n     * @param {string} path The path of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseMatchesProperty(path, srcValue) {\n      if (isKey(path) && isStrictComparable(srcValue)) {\n        return matchesStrictComparable(toKey(path), srcValue);\n      }\n      return function(object) {\n        var objValue = get(object, path);\n        return (objValue === undefined && objValue === srcValue)\n          ? hasIn(object, path)\n          : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n      };\n    }\n\n    /**\n     * The base implementation of `_.merge` without support for multiple sources.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {number} srcIndex The index of `source`.\n     * @param {Function} [customizer] The function to customize merged values.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     */\n    function baseMerge(object, source, srcIndex, customizer, stack) {\n      if (object === source) {\n        return;\n      }\n      baseFor(source, function(srcValue, key) {\n        stack || (stack = new Stack);\n        if (isObject(srcValue)) {\n          baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n        }\n        else {\n          var newValue = customizer\n            ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n            : undefined;\n\n          if (newValue === undefined) {\n            newValue = srcValue;\n          }\n          assignMergeValue(object, key, newValue);\n        }\n      }, keysIn);\n    }\n\n    /**\n     * A specialized version of `baseMerge` for arrays and objects which performs\n     * deep merges and tracks traversed objects enabling objects with circular\n     * references to be merged.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {string} key The key of the value to merge.\n     * @param {number} srcIndex The index of `source`.\n     * @param {Function} mergeFunc The function to merge values.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     */\n    function baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n      var objValue = safeGet(object, key),\n          srcValue = safeGet(source, key),\n          stacked = stack.get(srcValue);\n\n      if (stacked) {\n        assignMergeValue(object, key, stacked);\n        return;\n      }\n      var newValue = customizer\n        ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      var isCommon = newValue === undefined;\n\n      if (isCommon) {\n        var isArr = isArray(srcValue),\n            isBuff = !isArr && isBuffer(srcValue),\n            isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n        newValue = srcValue;\n        if (isArr || isBuff || isTyped) {\n          if (isArray(objValue)) {\n            newValue = objValue;\n          }\n          else if (isArrayLikeObject(objValue)) {\n            newValue = copyArray(objValue);\n          }\n          else if (isBuff) {\n            isCommon = false;\n            newValue = cloneBuffer(srcValue, true);\n          }\n          else if (isTyped) {\n            isCommon = false;\n            newValue = cloneTypedArray(srcValue, true);\n          }\n          else {\n            newValue = [];\n          }\n        }\n        else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n          newValue = objValue;\n          if (isArguments(objValue)) {\n            newValue = toPlainObject(objValue);\n          }\n          else if (!isObject(objValue) || isFunction(objValue)) {\n            newValue = initCloneObject(srcValue);\n          }\n        }\n        else {\n          isCommon = false;\n        }\n      }\n      if (isCommon) {\n        // Recursively merge objects and arrays (susceptible to call stack limits).\n        stack.set(srcValue, newValue);\n        mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n        stack['delete'](srcValue);\n      }\n      assignMergeValue(object, key, newValue);\n    }\n\n    /**\n     * The base implementation of `_.nth` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {Array} array The array to query.\n     * @param {number} n The index of the element to return.\n     * @returns {*} Returns the nth element of `array`.\n     */\n    function baseNth(array, n) {\n      var length = array.length;\n      if (!length) {\n        return;\n      }\n      n += n < 0 ? length : 0;\n      return isIndex(n, length) ? array[n] : undefined;\n    }\n\n    /**\n     * The base implementation of `_.orderBy` without param guards.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.\n     * @param {string[]} orders The sort orders of `iteratees`.\n     * @returns {Array} Returns the new sorted array.\n     */\n    function baseOrderBy(collection, iteratees, orders) {\n      if (iteratees.length) {\n        iteratees = arrayMap(iteratees, function(iteratee) {\n          if (isArray(iteratee)) {\n            return function(value) {\n              return baseGet(value, iteratee.length === 1 ? iteratee[0] : iteratee);\n            }\n          }\n          return iteratee;\n        });\n      } else {\n        iteratees = [identity];\n      }\n\n      var index = -1;\n      iteratees = arrayMap(iteratees, baseUnary(getIteratee()));\n\n      var result = baseMap(collection, function(value, key, collection) {\n        var criteria = arrayMap(iteratees, function(iteratee) {\n          return iteratee(value);\n        });\n        return { 'criteria': criteria, 'index': ++index, 'value': value };\n      });\n\n      return baseSortBy(result, function(object, other) {\n        return compareMultiple(object, other, orders);\n      });\n    }\n\n    /**\n     * The base implementation of `_.pick` without support for individual\n     * property identifiers.\n     *\n     * @private\n     * @param {Object} object The source object.\n     * @param {string[]} paths The property paths to pick.\n     * @returns {Object} Returns the new object.\n     */\n    function basePick(object, paths) {\n      return basePickBy(object, paths, function(value, path) {\n        return hasIn(object, path);\n      });\n    }\n\n    /**\n     * The base implementation of  `_.pickBy` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The source object.\n     * @param {string[]} paths The property paths to pick.\n     * @param {Function} predicate The function invoked per property.\n     * @returns {Object} Returns the new object.\n     */\n    function basePickBy(object, paths, predicate) {\n      var index = -1,\n          length = paths.length,\n          result = {};\n\n      while (++index < length) {\n        var path = paths[index],\n            value = baseGet(object, path);\n\n        if (predicate(value, path)) {\n          baseSet(result, castPath(path, object), value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseProperty` which supports deep paths.\n     *\n     * @private\n     * @param {Array|string} path The path of the property to get.\n     * @returns {Function} Returns the new accessor function.\n     */\n    function basePropertyDeep(path) {\n      return function(object) {\n        return baseGet(object, path);\n      };\n    }\n\n    /**\n     * The base implementation of `_.pullAllBy` without support for iteratee\n     * shorthands.\n     *\n     * @private\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns `array`.\n     */\n    function basePullAll(array, values, iteratee, comparator) {\n      var indexOf = comparator ? baseIndexOfWith : baseIndexOf,\n          index = -1,\n          length = values.length,\n          seen = array;\n\n      if (array === values) {\n        values = copyArray(values);\n      }\n      if (iteratee) {\n        seen = arrayMap(array, baseUnary(iteratee));\n      }\n      while (++index < length) {\n        var fromIndex = 0,\n            value = values[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        while ((fromIndex = indexOf(seen, computed, fromIndex, comparator)) > -1) {\n          if (seen !== array) {\n            splice.call(seen, fromIndex, 1);\n          }\n          splice.call(array, fromIndex, 1);\n        }\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.pullAt` without support for individual\n     * indexes or capturing the removed elements.\n     *\n     * @private\n     * @param {Array} array The array to modify.\n     * @param {number[]} indexes The indexes of elements to remove.\n     * @returns {Array} Returns `array`.\n     */\n    function basePullAt(array, indexes) {\n      var length = array ? indexes.length : 0,\n          lastIndex = length - 1;\n\n      while (length--) {\n        var index = indexes[length];\n        if (length == lastIndex || index !== previous) {\n          var previous = index;\n          if (isIndex(index)) {\n            splice.call(array, index, 1);\n          } else {\n            baseUnset(array, index);\n          }\n        }\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.random` without support for returning\n     * floating-point numbers.\n     *\n     * @private\n     * @param {number} lower The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the random number.\n     */\n    function baseRandom(lower, upper) {\n      return lower + nativeFloor(nativeRandom() * (upper - lower + 1));\n    }\n\n    /**\n     * The base implementation of `_.range` and `_.rangeRight` which doesn't\n     * coerce arguments.\n     *\n     * @private\n     * @param {number} start The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} step The value to increment or decrement by.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Array} Returns the range of numbers.\n     */\n    function baseRange(start, end, step, fromRight) {\n      var index = -1,\n          length = nativeMax(nativeCeil((end - start) / (step || 1)), 0),\n          result = Array(length);\n\n      while (length--) {\n        result[fromRight ? length : ++index] = start;\n        start += step;\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.repeat` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {string} string The string to repeat.\n     * @param {number} n The number of times to repeat the string.\n     * @returns {string} Returns the repeated string.\n     */\n    function baseRepeat(string, n) {\n      var result = '';\n      if (!string || n < 1 || n > MAX_SAFE_INTEGER) {\n        return result;\n      }\n      // Leverage the exponentiation by squaring algorithm for a faster repeat.\n      // See https://en.wikipedia.org/wiki/Exponentiation_by_squaring for more details.\n      do {\n        if (n % 2) {\n          result += string;\n        }\n        n = nativeFloor(n / 2);\n        if (n) {\n          string += string;\n        }\n      } while (n);\n\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @returns {Function} Returns the new function.\n     */\n    function baseRest(func, start) {\n      return setToString(overRest(func, start, identity), func + '');\n    }\n\n    /**\n     * The base implementation of `_.sample`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to sample.\n     * @returns {*} Returns the random element.\n     */\n    function baseSample(collection) {\n      return arraySample(values(collection));\n    }\n\n    /**\n     * The base implementation of `_.sampleSize` without param guards.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to sample.\n     * @param {number} n The number of elements to sample.\n     * @returns {Array} Returns the random elements.\n     */\n    function baseSampleSize(collection, n) {\n      var array = values(collection);\n      return shuffleSelf(array, baseClamp(n, 0, array.length));\n    }\n\n    /**\n     * The base implementation of `_.set`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @param {Function} [customizer] The function to customize path creation.\n     * @returns {Object} Returns `object`.\n     */\n    function baseSet(object, path, value, customizer) {\n      if (!isObject(object)) {\n        return object;\n      }\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length,\n          lastIndex = length - 1,\n          nested = object;\n\n      while (nested != null && ++index < length) {\n        var key = toKey(path[index]),\n            newValue = value;\n\n        if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n          return object;\n        }\n\n        if (index != lastIndex) {\n          var objValue = nested[key];\n          newValue = customizer ? customizer(objValue, key, nested) : undefined;\n          if (newValue === undefined) {\n            newValue = isObject(objValue)\n              ? objValue\n              : (isIndex(path[index + 1]) ? [] : {});\n          }\n        }\n        assignValue(nested, key, newValue);\n        nested = nested[key];\n      }\n      return object;\n    }\n\n    /**\n     * The base implementation of `setData` without support for hot loop shorting.\n     *\n     * @private\n     * @param {Function} func The function to associate metadata with.\n     * @param {*} data The metadata.\n     * @returns {Function} Returns `func`.\n     */\n    var baseSetData = !metaMap ? identity : function(func, data) {\n      metaMap.set(func, data);\n      return func;\n    };\n\n    /**\n     * The base implementation of `setToString` without support for hot loop shorting.\n     *\n     * @private\n     * @param {Function} func The function to modify.\n     * @param {Function} string The `toString` result.\n     * @returns {Function} Returns `func`.\n     */\n    var baseSetToString = !defineProperty ? identity : function(func, string) {\n      return defineProperty(func, 'toString', {\n        'configurable': true,\n        'enumerable': false,\n        'value': constant(string),\n        'writable': true\n      });\n    };\n\n    /**\n     * The base implementation of `_.shuffle`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     */\n    function baseShuffle(collection) {\n      return shuffleSelf(values(collection));\n    }\n\n    /**\n     * The base implementation of `_.slice` without an iteratee call guard.\n     *\n     * @private\n     * @param {Array} array The array to slice.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function baseSlice(array, start, end) {\n      var index = -1,\n          length = array.length;\n\n      if (start < 0) {\n        start = -start > length ? 0 : (length + start);\n      }\n      end = end > length ? length : end;\n      if (end < 0) {\n        end += length;\n      }\n      length = start > end ? 0 : ((end - start) >>> 0);\n      start >>>= 0;\n\n      var result = Array(length);\n      while (++index < length) {\n        result[index] = array[index + start];\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.some` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {boolean} Returns `true` if any element passes the predicate check,\n     *  else `false`.\n     */\n    function baseSome(collection, predicate) {\n      var result;\n\n      baseEach(collection, function(value, index, collection) {\n        result = predicate(value, index, collection);\n        return !result;\n      });\n      return !!result;\n    }\n\n    /**\n     * The base implementation of `_.sortedIndex` and `_.sortedLastIndex` which\n     * performs a binary search of `array` to determine the index at which `value`\n     * should be inserted into `array` in order to maintain its sort order.\n     *\n     * @private\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {boolean} [retHighest] Specify returning the highest qualified index.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     */\n    function baseSortedIndex(array, value, retHighest) {\n      var low = 0,\n          high = array == null ? low : array.length;\n\n      if (typeof value == 'number' && value === value && high <= HALF_MAX_ARRAY_LENGTH) {\n        while (low < high) {\n          var mid = (low + high) >>> 1,\n              computed = array[mid];\n\n          if (computed !== null && !isSymbol(computed) &&\n              (retHighest ? (computed <= value) : (computed < value))) {\n            low = mid + 1;\n          } else {\n            high = mid;\n          }\n        }\n        return high;\n      }\n      return baseSortedIndexBy(array, value, identity, retHighest);\n    }\n\n    /**\n     * The base implementation of `_.sortedIndexBy` and `_.sortedLastIndexBy`\n     * which invokes `iteratee` for `value` and each element of `array` to compute\n     * their sort ranking. The iteratee is invoked with one argument; (value).\n     *\n     * @private\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} iteratee The iteratee invoked per element.\n     * @param {boolean} [retHighest] Specify returning the highest qualified index.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     */\n    function baseSortedIndexBy(array, value, iteratee, retHighest) {\n      var low = 0,\n          high = array == null ? 0 : array.length;\n      if (high === 0) {\n        return 0;\n      }\n\n      value = iteratee(value);\n      var valIsNaN = value !== value,\n          valIsNull = value === null,\n          valIsSymbol = isSymbol(value),\n          valIsUndefined = value === undefined;\n\n      while (low < high) {\n        var mid = nativeFloor((low + high) / 2),\n            computed = iteratee(array[mid]),\n            othIsDefined = computed !== undefined,\n            othIsNull = computed === null,\n            othIsReflexive = computed === computed,\n            othIsSymbol = isSymbol(computed);\n\n        if (valIsNaN) {\n          var setLow = retHighest || othIsReflexive;\n        } else if (valIsUndefined) {\n          setLow = othIsReflexive && (retHighest || othIsDefined);\n        } else if (valIsNull) {\n          setLow = othIsReflexive && othIsDefined && (retHighest || !othIsNull);\n        } else if (valIsSymbol) {\n          setLow = othIsReflexive && othIsDefined && !othIsNull && (retHighest || !othIsSymbol);\n        } else if (othIsNull || othIsSymbol) {\n          setLow = false;\n        } else {\n          setLow = retHighest ? (computed <= value) : (computed < value);\n        }\n        if (setLow) {\n          low = mid + 1;\n        } else {\n          high = mid;\n        }\n      }\n      return nativeMin(high, MAX_ARRAY_INDEX);\n    }\n\n    /**\n     * The base implementation of `_.sortedUniq` and `_.sortedUniqBy` without\n     * support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     */\n    function baseSortedUniq(array, iteratee) {\n      var index = -1,\n          length = array.length,\n          resIndex = 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        if (!index || !eq(computed, seen)) {\n          var seen = computed;\n          result[resIndex++] = value === 0 ? 0 : value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.toNumber` which doesn't ensure correct\n     * conversions of binary, hexadecimal, or octal string values.\n     *\n     * @private\n     * @param {*} value The value to process.\n     * @returns {number} Returns the number.\n     */\n    function baseToNumber(value) {\n      if (typeof value == 'number') {\n        return value;\n      }\n      if (isSymbol(value)) {\n        return NAN;\n      }\n      return +value;\n    }\n\n    /**\n     * The base implementation of `_.toString` which doesn't convert nullish\n     * values to empty strings.\n     *\n     * @private\n     * @param {*} value The value to process.\n     * @returns {string} Returns the string.\n     */\n    function baseToString(value) {\n      // Exit early for strings to avoid a performance hit in some environments.\n      if (typeof value == 'string') {\n        return value;\n      }\n      if (isArray(value)) {\n        // Recursively convert values (susceptible to call stack limits).\n        return arrayMap(value, baseToString) + '';\n      }\n      if (isSymbol(value)) {\n        return symbolToString ? symbolToString.call(value) : '';\n      }\n      var result = (value + '');\n      return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n    }\n\n    /**\n     * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     */\n    function baseUniq(array, iteratee, comparator) {\n      var index = -1,\n          includes = arrayIncludes,\n          length = array.length,\n          isCommon = true,\n          result = [],\n          seen = result;\n\n      if (comparator) {\n        isCommon = false;\n        includes = arrayIncludesWith;\n      }\n      else if (length >= LARGE_ARRAY_SIZE) {\n        var set = iteratee ? null : createSet(array);\n        if (set) {\n          return setToArray(set);\n        }\n        isCommon = false;\n        includes = cacheHas;\n        seen = new SetCache;\n      }\n      else {\n        seen = iteratee ? [] : result;\n      }\n      outer:\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (isCommon && computed === computed) {\n          var seenIndex = seen.length;\n          while (seenIndex--) {\n            if (seen[seenIndex] === computed) {\n              continue outer;\n            }\n          }\n          if (iteratee) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n        else if (!includes(seen, computed, comparator)) {\n          if (seen !== result) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.unset`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The property path to unset.\n     * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n     */\n    function baseUnset(object, path) {\n      path = castPath(path, object);\n      object = parent(object, path);\n      return object == null || delete object[toKey(last(path))];\n    }\n\n    /**\n     * The base implementation of `_.update`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to update.\n     * @param {Function} updater The function to produce the updated value.\n     * @param {Function} [customizer] The function to customize path creation.\n     * @returns {Object} Returns `object`.\n     */\n    function baseUpdate(object, path, updater, customizer) {\n      return baseSet(object, path, updater(baseGet(object, path)), customizer);\n    }\n\n    /**\n     * The base implementation of methods like `_.dropWhile` and `_.takeWhile`\n     * without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to query.\n     * @param {Function} predicate The function invoked per iteration.\n     * @param {boolean} [isDrop] Specify dropping elements instead of taking them.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function baseWhile(array, predicate, isDrop, fromRight) {\n      var length = array.length,\n          index = fromRight ? length : -1;\n\n      while ((fromRight ? index-- : ++index < length) &&\n        predicate(array[index], index, array)) {}\n\n      return isDrop\n        ? baseSlice(array, (fromRight ? 0 : index), (fromRight ? index + 1 : length))\n        : baseSlice(array, (fromRight ? index + 1 : 0), (fromRight ? length : index));\n    }\n\n    /**\n     * The base implementation of `wrapperValue` which returns the result of\n     * performing a sequence of actions on the unwrapped `value`, where each\n     * successive action is supplied the return value of the previous.\n     *\n     * @private\n     * @param {*} value The unwrapped value.\n     * @param {Array} actions Actions to perform to resolve the unwrapped value.\n     * @returns {*} Returns the resolved value.\n     */\n    function baseWrapperValue(value, actions) {\n      var result = value;\n      if (result instanceof LazyWrapper) {\n        result = result.value();\n      }\n      return arrayReduce(actions, function(result, action) {\n        return action.func.apply(action.thisArg, arrayPush([result], action.args));\n      }, result);\n    }\n\n    /**\n     * The base implementation of methods like `_.xor`, without support for\n     * iteratee shorthands, that accepts an array of arrays to inspect.\n     *\n     * @private\n     * @param {Array} arrays The arrays to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of values.\n     */\n    function baseXor(arrays, iteratee, comparator) {\n      var length = arrays.length;\n      if (length < 2) {\n        return length ? baseUniq(arrays[0]) : [];\n      }\n      var index = -1,\n          result = Array(length);\n\n      while (++index < length) {\n        var array = arrays[index],\n            othIndex = -1;\n\n        while (++othIndex < length) {\n          if (othIndex != index) {\n            result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n          }\n        }\n      }\n      return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n    }\n\n    /**\n     * This base implementation of `_.zipObject` which assigns values using `assignFunc`.\n     *\n     * @private\n     * @param {Array} props The property identifiers.\n     * @param {Array} values The property values.\n     * @param {Function} assignFunc The function to assign values.\n     * @returns {Object} Returns the new object.\n     */\n    function baseZipObject(props, values, assignFunc) {\n      var index = -1,\n          length = props.length,\n          valsLength = values.length,\n          result = {};\n\n      while (++index < length) {\n        var value = index < valsLength ? values[index] : undefined;\n        assignFunc(result, props[index], value);\n      }\n      return result;\n    }\n\n    /**\n     * Casts `value` to an empty array if it's not an array like object.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {Array|Object} Returns the cast array-like object.\n     */\n    function castArrayLikeObject(value) {\n      return isArrayLikeObject(value) ? value : [];\n    }\n\n    /**\n     * Casts `value` to `identity` if it's not a function.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {Function} Returns cast function.\n     */\n    function castFunction(value) {\n      return typeof value == 'function' ? value : identity;\n    }\n\n    /**\n     * Casts `value` to a path array if it's not one.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @param {Object} [object] The object to query keys on.\n     * @returns {Array} Returns the cast property path array.\n     */\n    function castPath(value, object) {\n      if (isArray(value)) {\n        return value;\n      }\n      return isKey(value, object) ? [value] : stringToPath(toString(value));\n    }\n\n    /**\n     * A `baseRest` alias which can be replaced with `identity` by module\n     * replacement plugins.\n     *\n     * @private\n     * @type {Function}\n     * @param {Function} func The function to apply a rest parameter to.\n     * @returns {Function} Returns the new function.\n     */\n    var castRest = baseRest;\n\n    /**\n     * Casts `array` to a slice if it's needed.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {number} start The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the cast slice.\n     */\n    function castSlice(array, start, end) {\n      var length = array.length;\n      end = end === undefined ? length : end;\n      return (!start && end >= length) ? array : baseSlice(array, start, end);\n    }\n\n    /**\n     * A simple wrapper around the global [`clearTimeout`](https://mdn.io/clearTimeout).\n     *\n     * @private\n     * @param {number|Object} id The timer id or timeout object of the timer to clear.\n     */\n    var clearTimeout = ctxClearTimeout || function(id) {\n      return root.clearTimeout(id);\n    };\n\n    /**\n     * Creates a clone of  `buffer`.\n     *\n     * @private\n     * @param {Buffer} buffer The buffer to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Buffer} Returns the cloned buffer.\n     */\n    function cloneBuffer(buffer, isDeep) {\n      if (isDeep) {\n        return buffer.slice();\n      }\n      var length = buffer.length,\n          result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n      buffer.copy(result);\n      return result;\n    }\n\n    /**\n     * Creates a clone of `arrayBuffer`.\n     *\n     * @private\n     * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n     * @returns {ArrayBuffer} Returns the cloned array buffer.\n     */\n    function cloneArrayBuffer(arrayBuffer) {\n      var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n      new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n      return result;\n    }\n\n    /**\n     * Creates a clone of `dataView`.\n     *\n     * @private\n     * @param {Object} dataView The data view to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the cloned data view.\n     */\n    function cloneDataView(dataView, isDeep) {\n      var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n      return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n    }\n\n    /**\n     * Creates a clone of `regexp`.\n     *\n     * @private\n     * @param {Object} regexp The regexp to clone.\n     * @returns {Object} Returns the cloned regexp.\n     */\n    function cloneRegExp(regexp) {\n      var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n      result.lastIndex = regexp.lastIndex;\n      return result;\n    }\n\n    /**\n     * Creates a clone of the `symbol` object.\n     *\n     * @private\n     * @param {Object} symbol The symbol object to clone.\n     * @returns {Object} Returns the cloned symbol object.\n     */\n    function cloneSymbol(symbol) {\n      return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n    }\n\n    /**\n     * Creates a clone of `typedArray`.\n     *\n     * @private\n     * @param {Object} typedArray The typed array to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the cloned typed array.\n     */\n    function cloneTypedArray(typedArray, isDeep) {\n      var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n      return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n    }\n\n    /**\n     * Compares values to sort them in ascending order.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {number} Returns the sort order indicator for `value`.\n     */\n    function compareAscending(value, other) {\n      if (value !== other) {\n        var valIsDefined = value !== undefined,\n            valIsNull = value === null,\n            valIsReflexive = value === value,\n            valIsSymbol = isSymbol(value);\n\n        var othIsDefined = other !== undefined,\n            othIsNull = other === null,\n            othIsReflexive = other === other,\n            othIsSymbol = isSymbol(other);\n\n        if ((!othIsNull && !othIsSymbol && !valIsSymbol && value > other) ||\n            (valIsSymbol && othIsDefined && othIsReflexive && !othIsNull && !othIsSymbol) ||\n            (valIsNull && othIsDefined && othIsReflexive) ||\n            (!valIsDefined && othIsReflexive) ||\n            !valIsReflexive) {\n          return 1;\n        }\n        if ((!valIsNull && !valIsSymbol && !othIsSymbol && value < other) ||\n            (othIsSymbol && valIsDefined && valIsReflexive && !valIsNull && !valIsSymbol) ||\n            (othIsNull && valIsDefined && valIsReflexive) ||\n            (!othIsDefined && valIsReflexive) ||\n            !othIsReflexive) {\n          return -1;\n        }\n      }\n      return 0;\n    }\n\n    /**\n     * Used by `_.orderBy` to compare multiple properties of a value to another\n     * and stable sort them.\n     *\n     * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,\n     * specify an order of \"desc\" for descending or \"asc\" for ascending sort order\n     * of corresponding values.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {boolean[]|string[]} orders The order to sort by for each property.\n     * @returns {number} Returns the sort order indicator for `object`.\n     */\n    function compareMultiple(object, other, orders) {\n      var index = -1,\n          objCriteria = object.criteria,\n          othCriteria = other.criteria,\n          length = objCriteria.length,\n          ordersLength = orders.length;\n\n      while (++index < length) {\n        var result = compareAscending(objCriteria[index], othCriteria[index]);\n        if (result) {\n          if (index >= ordersLength) {\n            return result;\n          }\n          var order = orders[index];\n          return result * (order == 'desc' ? -1 : 1);\n        }\n      }\n      // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n      // that causes it, under certain circumstances, to provide the same value for\n      // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247\n      // for more details.\n      //\n      // This also ensures a stable sort in V8 and other engines.\n      // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n      return object.index - other.index;\n    }\n\n    /**\n     * Creates an array that is the composition of partially applied arguments,\n     * placeholders, and provided arguments into a single array of arguments.\n     *\n     * @private\n     * @param {Array} args The provided arguments.\n     * @param {Array} partials The arguments to prepend to those provided.\n     * @param {Array} holders The `partials` placeholder indexes.\n     * @params {boolean} [isCurried] Specify composing for a curried function.\n     * @returns {Array} Returns the new array of composed arguments.\n     */\n    function composeArgs(args, partials, holders, isCurried) {\n      var argsIndex = -1,\n          argsLength = args.length,\n          holdersLength = holders.length,\n          leftIndex = -1,\n          leftLength = partials.length,\n          rangeLength = nativeMax(argsLength - holdersLength, 0),\n          result = Array(leftLength + rangeLength),\n          isUncurried = !isCurried;\n\n      while (++leftIndex < leftLength) {\n        result[leftIndex] = partials[leftIndex];\n      }\n      while (++argsIndex < holdersLength) {\n        if (isUncurried || argsIndex < argsLength) {\n          result[holders[argsIndex]] = args[argsIndex];\n        }\n      }\n      while (rangeLength--) {\n        result[leftIndex++] = args[argsIndex++];\n      }\n      return result;\n    }\n\n    /**\n     * This function is like `composeArgs` except that the arguments composition\n     * is tailored for `_.partialRight`.\n     *\n     * @private\n     * @param {Array} args The provided arguments.\n     * @param {Array} partials The arguments to append to those provided.\n     * @param {Array} holders The `partials` placeholder indexes.\n     * @params {boolean} [isCurried] Specify composing for a curried function.\n     * @returns {Array} Returns the new array of composed arguments.\n     */\n    function composeArgsRight(args, partials, holders, isCurried) {\n      var argsIndex = -1,\n          argsLength = args.length,\n          holdersIndex = -1,\n          holdersLength = holders.length,\n          rightIndex = -1,\n          rightLength = partials.length,\n          rangeLength = nativeMax(argsLength - holdersLength, 0),\n          result = Array(rangeLength + rightLength),\n          isUncurried = !isCurried;\n\n      while (++argsIndex < rangeLength) {\n        result[argsIndex] = args[argsIndex];\n      }\n      var offset = argsIndex;\n      while (++rightIndex < rightLength) {\n        result[offset + rightIndex] = partials[rightIndex];\n      }\n      while (++holdersIndex < holdersLength) {\n        if (isUncurried || argsIndex < argsLength) {\n          result[offset + holders[holdersIndex]] = args[argsIndex++];\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Copies the values of `source` to `array`.\n     *\n     * @private\n     * @param {Array} source The array to copy values from.\n     * @param {Array} [array=[]] The array to copy values to.\n     * @returns {Array} Returns `array`.\n     */\n    function copyArray(source, array) {\n      var index = -1,\n          length = source.length;\n\n      array || (array = Array(length));\n      while (++index < length) {\n        array[index] = source[index];\n      }\n      return array;\n    }\n\n    /**\n     * Copies properties of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy properties from.\n     * @param {Array} props The property identifiers to copy.\n     * @param {Object} [object={}] The object to copy properties to.\n     * @param {Function} [customizer] The function to customize copied values.\n     * @returns {Object} Returns `object`.\n     */\n    function copyObject(source, props, object, customizer) {\n      var isNew = !object;\n      object || (object = {});\n\n      var index = -1,\n          length = props.length;\n\n      while (++index < length) {\n        var key = props[index];\n\n        var newValue = customizer\n          ? customizer(object[key], source[key], key, object, source)\n          : undefined;\n\n        if (newValue === undefined) {\n          newValue = source[key];\n        }\n        if (isNew) {\n          baseAssignValue(object, key, newValue);\n        } else {\n          assignValue(object, key, newValue);\n        }\n      }\n      return object;\n    }\n\n    /**\n     * Copies own symbols of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy symbols from.\n     * @param {Object} [object={}] The object to copy symbols to.\n     * @returns {Object} Returns `object`.\n     */\n    function copySymbols(source, object) {\n      return copyObject(source, getSymbols(source), object);\n    }\n\n    /**\n     * Copies own and inherited symbols of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy symbols from.\n     * @param {Object} [object={}] The object to copy symbols to.\n     * @returns {Object} Returns `object`.\n     */\n    function copySymbolsIn(source, object) {\n      return copyObject(source, getSymbolsIn(source), object);\n    }\n\n    /**\n     * Creates a function like `_.groupBy`.\n     *\n     * @private\n     * @param {Function} setter The function to set accumulator values.\n     * @param {Function} [initializer] The accumulator object initializer.\n     * @returns {Function} Returns the new aggregator function.\n     */\n    function createAggregator(setter, initializer) {\n      return function(collection, iteratee) {\n        var func = isArray(collection) ? arrayAggregator : baseAggregator,\n            accumulator = initializer ? initializer() : {};\n\n        return func(collection, setter, getIteratee(iteratee, 2), accumulator);\n      };\n    }\n\n    /**\n     * Creates a function like `_.assign`.\n     *\n     * @private\n     * @param {Function} assigner The function to assign values.\n     * @returns {Function} Returns the new assigner function.\n     */\n    function createAssigner(assigner) {\n      return baseRest(function(object, sources) {\n        var index = -1,\n            length = sources.length,\n            customizer = length > 1 ? sources[length - 1] : undefined,\n            guard = length > 2 ? sources[2] : undefined;\n\n        customizer = (assigner.length > 3 && typeof customizer == 'function')\n          ? (length--, customizer)\n          : undefined;\n\n        if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n          customizer = length < 3 ? undefined : customizer;\n          length = 1;\n        }\n        object = Object(object);\n        while (++index < length) {\n          var source = sources[index];\n          if (source) {\n            assigner(object, source, index, customizer);\n          }\n        }\n        return object;\n      });\n    }\n\n    /**\n     * Creates a `baseEach` or `baseEachRight` function.\n     *\n     * @private\n     * @param {Function} eachFunc The function to iterate over a collection.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new base function.\n     */\n    function createBaseEach(eachFunc, fromRight) {\n      return function(collection, iteratee) {\n        if (collection == null) {\n          return collection;\n        }\n        if (!isArrayLike(collection)) {\n          return eachFunc(collection, iteratee);\n        }\n        var length = collection.length,\n            index = fromRight ? length : -1,\n            iterable = Object(collection);\n\n        while ((fromRight ? index-- : ++index < length)) {\n          if (iteratee(iterable[index], index, iterable) === false) {\n            break;\n          }\n        }\n        return collection;\n      };\n    }\n\n    /**\n     * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new base function.\n     */\n    function createBaseFor(fromRight) {\n      return function(object, iteratee, keysFunc) {\n        var index = -1,\n            iterable = Object(object),\n            props = keysFunc(object),\n            length = props.length;\n\n        while (length--) {\n          var key = props[fromRight ? length : ++index];\n          if (iteratee(iterable[key], key, iterable) === false) {\n            break;\n          }\n        }\n        return object;\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with the optional `this`\n     * binding of `thisArg`.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createBind(func, bitmask, thisArg) {\n      var isBind = bitmask & WRAP_BIND_FLAG,\n          Ctor = createCtor(func);\n\n      function wrapper() {\n        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n        return fn.apply(isBind ? thisArg : this, arguments);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a function like `_.lowerFirst`.\n     *\n     * @private\n     * @param {string} methodName The name of the `String` case method to use.\n     * @returns {Function} Returns the new case function.\n     */\n    function createCaseFirst(methodName) {\n      return function(string) {\n        string = toString(string);\n\n        var strSymbols = hasUnicode(string)\n          ? stringToArray(string)\n          : undefined;\n\n        var chr = strSymbols\n          ? strSymbols[0]\n          : string.charAt(0);\n\n        var trailing = strSymbols\n          ? castSlice(strSymbols, 1).join('')\n          : string.slice(1);\n\n        return chr[methodName]() + trailing;\n      };\n    }\n\n    /**\n     * Creates a function like `_.camelCase`.\n     *\n     * @private\n     * @param {Function} callback The function to combine each word.\n     * @returns {Function} Returns the new compounder function.\n     */\n    function createCompounder(callback) {\n      return function(string) {\n        return arrayReduce(words(deburr(string).replace(reApos, '')), callback, '');\n      };\n    }\n\n    /**\n     * Creates a function that produces an instance of `Ctor` regardless of\n     * whether it was invoked as part of a `new` expression or by `call` or `apply`.\n     *\n     * @private\n     * @param {Function} Ctor The constructor to wrap.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createCtor(Ctor) {\n      return function() {\n        // Use a `switch` statement to work with class constructors. See\n        // http://ecma-international.org/ecma-262/7.0/#sec-ecmascript-function-objects-call-thisargument-argumentslist\n        // for more details.\n        var args = arguments;\n        switch (args.length) {\n          case 0: return new Ctor;\n          case 1: return new Ctor(args[0]);\n          case 2: return new Ctor(args[0], args[1]);\n          case 3: return new Ctor(args[0], args[1], args[2]);\n          case 4: return new Ctor(args[0], args[1], args[2], args[3]);\n          case 5: return new Ctor(args[0], args[1], args[2], args[3], args[4]);\n          case 6: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5]);\n          case 7: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5], args[6]);\n        }\n        var thisBinding = baseCreate(Ctor.prototype),\n            result = Ctor.apply(thisBinding, args);\n\n        // Mimic the constructor's `return` behavior.\n        // See https://es5.github.io/#x13.2.2 for more details.\n        return isObject(result) ? result : thisBinding;\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to enable currying.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {number} arity The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createCurry(func, bitmask, arity) {\n      var Ctor = createCtor(func);\n\n      function wrapper() {\n        var length = arguments.length,\n            args = Array(length),\n            index = length,\n            placeholder = getHolder(wrapper);\n\n        while (index--) {\n          args[index] = arguments[index];\n        }\n        var holders = (length < 3 && args[0] !== placeholder && args[length - 1] !== placeholder)\n          ? []\n          : replaceHolders(args, placeholder);\n\n        length -= holders.length;\n        if (length < arity) {\n          return createRecurry(\n            func, bitmask, createHybrid, wrapper.placeholder, undefined,\n            args, holders, undefined, undefined, arity - length);\n        }\n        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n        return apply(fn, this, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a `_.find` or `_.findLast` function.\n     *\n     * @private\n     * @param {Function} findIndexFunc The function to find the collection index.\n     * @returns {Function} Returns the new find function.\n     */\n    function createFind(findIndexFunc) {\n      return function(collection, predicate, fromIndex) {\n        var iterable = Object(collection);\n        if (!isArrayLike(collection)) {\n          var iteratee = getIteratee(predicate, 3);\n          collection = keys(collection);\n          predicate = function(key) { return iteratee(iterable[key], key, iterable); };\n        }\n        var index = findIndexFunc(collection, predicate, fromIndex);\n        return index > -1 ? iterable[iteratee ? collection[index] : index] : undefined;\n      };\n    }\n\n    /**\n     * Creates a `_.flow` or `_.flowRight` function.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new flow function.\n     */\n    function createFlow(fromRight) {\n      return flatRest(function(funcs) {\n        var length = funcs.length,\n            index = length,\n            prereq = LodashWrapper.prototype.thru;\n\n        if (fromRight) {\n          funcs.reverse();\n        }\n        while (index--) {\n          var func = funcs[index];\n          if (typeof func != 'function') {\n            throw new TypeError(FUNC_ERROR_TEXT);\n          }\n          if (prereq && !wrapper && getFuncName(func) == 'wrapper') {\n            var wrapper = new LodashWrapper([], true);\n          }\n        }\n        index = wrapper ? index : length;\n        while (++index < length) {\n          func = funcs[index];\n\n          var funcName = getFuncName(func),\n              data = funcName == 'wrapper' ? getData(func) : undefined;\n\n          if (data && isLaziable(data[0]) &&\n                data[1] == (WRAP_ARY_FLAG | WRAP_CURRY_FLAG | WRAP_PARTIAL_FLAG | WRAP_REARG_FLAG) &&\n                !data[4].length && data[9] == 1\n              ) {\n            wrapper = wrapper[getFuncName(data[0])].apply(wrapper, data[3]);\n          } else {\n            wrapper = (func.length == 1 && isLaziable(func))\n              ? wrapper[funcName]()\n              : wrapper.thru(func);\n          }\n        }\n        return function() {\n          var args = arguments,\n              value = args[0];\n\n          if (wrapper && args.length == 1 && isArray(value)) {\n            return wrapper.plant(value).value();\n          }\n          var index = 0,\n              result = length ? funcs[index].apply(this, args) : value;\n\n          while (++index < length) {\n            result = funcs[index].call(this, result);\n          }\n          return result;\n        };\n      });\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with optional `this`\n     * binding of `thisArg`, partial application, and currying.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to prepend to those provided to\n     *  the new function.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [partialsRight] The arguments to append to those provided\n     *  to the new function.\n     * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createHybrid(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {\n      var isAry = bitmask & WRAP_ARY_FLAG,\n          isBind = bitmask & WRAP_BIND_FLAG,\n          isBindKey = bitmask & WRAP_BIND_KEY_FLAG,\n          isCurried = bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG),\n          isFlip = bitmask & WRAP_FLIP_FLAG,\n          Ctor = isBindKey ? undefined : createCtor(func);\n\n      function wrapper() {\n        var length = arguments.length,\n            args = Array(length),\n            index = length;\n\n        while (index--) {\n          args[index] = arguments[index];\n        }\n        if (isCurried) {\n          var placeholder = getHolder(wrapper),\n              holdersCount = countHolders(args, placeholder);\n        }\n        if (partials) {\n          args = composeArgs(args, partials, holders, isCurried);\n        }\n        if (partialsRight) {\n          args = composeArgsRight(args, partialsRight, holdersRight, isCurried);\n        }\n        length -= holdersCount;\n        if (isCurried && length < arity) {\n          var newHolders = replaceHolders(args, placeholder);\n          return createRecurry(\n            func, bitmask, createHybrid, wrapper.placeholder, thisArg,\n            args, newHolders, argPos, ary, arity - length\n          );\n        }\n        var thisBinding = isBind ? thisArg : this,\n            fn = isBindKey ? thisBinding[func] : func;\n\n        length = args.length;\n        if (argPos) {\n          args = reorder(args, argPos);\n        } else if (isFlip && length > 1) {\n          args.reverse();\n        }\n        if (isAry && ary < length) {\n          args.length = ary;\n        }\n        if (this && this !== root && this instanceof wrapper) {\n          fn = Ctor || createCtor(fn);\n        }\n        return fn.apply(thisBinding, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a function like `_.invertBy`.\n     *\n     * @private\n     * @param {Function} setter The function to set accumulator values.\n     * @param {Function} toIteratee The function to resolve iteratees.\n     * @returns {Function} Returns the new inverter function.\n     */\n    function createInverter(setter, toIteratee) {\n      return function(object, iteratee) {\n        return baseInverter(object, setter, toIteratee(iteratee), {});\n      };\n    }\n\n    /**\n     * Creates a function that performs a mathematical operation on two values.\n     *\n     * @private\n     * @param {Function} operator The function to perform the operation.\n     * @param {number} [defaultValue] The value used for `undefined` arguments.\n     * @returns {Function} Returns the new mathematical operation function.\n     */\n    function createMathOperation(operator, defaultValue) {\n      return function(value, other) {\n        var result;\n        if (value === undefined && other === undefined) {\n          return defaultValue;\n        }\n        if (value !== undefined) {\n          result = value;\n        }\n        if (other !== undefined) {\n          if (result === undefined) {\n            return other;\n          }\n          if (typeof value == 'string' || typeof other == 'string') {\n            value = baseToString(value);\n            other = baseToString(other);\n          } else {\n            value = baseToNumber(value);\n            other = baseToNumber(other);\n          }\n          result = operator(value, other);\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function like `_.over`.\n     *\n     * @private\n     * @param {Function} arrayFunc The function to iterate over iteratees.\n     * @returns {Function} Returns the new over function.\n     */\n    function createOver(arrayFunc) {\n      return flatRest(function(iteratees) {\n        iteratees = arrayMap(iteratees, baseUnary(getIteratee()));\n        return baseRest(function(args) {\n          var thisArg = this;\n          return arrayFunc(iteratees, function(iteratee) {\n            return apply(iteratee, thisArg, args);\n          });\n        });\n      });\n    }\n\n    /**\n     * Creates the padding for `string` based on `length`. The `chars` string\n     * is truncated if the number of characters exceeds `length`.\n     *\n     * @private\n     * @param {number} length The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padding for `string`.\n     */\n    function createPadding(length, chars) {\n      chars = chars === undefined ? ' ' : baseToString(chars);\n\n      var charsLength = chars.length;\n      if (charsLength < 2) {\n        return charsLength ? baseRepeat(chars, length) : chars;\n      }\n      var result = baseRepeat(chars, nativeCeil(length / stringSize(chars)));\n      return hasUnicode(chars)\n        ? castSlice(stringToArray(result), 0, length).join('')\n        : result.slice(0, length);\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with the `this` binding\n     * of `thisArg` and `partials` prepended to the arguments it receives.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} thisArg The `this` binding of `func`.\n     * @param {Array} partials The arguments to prepend to those provided to\n     *  the new function.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createPartial(func, bitmask, thisArg, partials) {\n      var isBind = bitmask & WRAP_BIND_FLAG,\n          Ctor = createCtor(func);\n\n      function wrapper() {\n        var argsIndex = -1,\n            argsLength = arguments.length,\n            leftIndex = -1,\n            leftLength = partials.length,\n            args = Array(leftLength + argsLength),\n            fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n\n        while (++leftIndex < leftLength) {\n          args[leftIndex] = partials[leftIndex];\n        }\n        while (argsLength--) {\n          args[leftIndex++] = arguments[++argsIndex];\n        }\n        return apply(fn, isBind ? thisArg : this, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a `_.range` or `_.rangeRight` function.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new range function.\n     */\n    function createRange(fromRight) {\n      return function(start, end, step) {\n        if (step && typeof step != 'number' && isIterateeCall(start, end, step)) {\n          end = step = undefined;\n        }\n        // Ensure the sign of `-0` is preserved.\n        start = toFinite(start);\n        if (end === undefined) {\n          end = start;\n          start = 0;\n        } else {\n          end = toFinite(end);\n        }\n        step = step === undefined ? (start < end ? 1 : -1) : toFinite(step);\n        return baseRange(start, end, step, fromRight);\n      };\n    }\n\n    /**\n     * Creates a function that performs a relational operation on two values.\n     *\n     * @private\n     * @param {Function} operator The function to perform the operation.\n     * @returns {Function} Returns the new relational operation function.\n     */\n    function createRelationalOperation(operator) {\n      return function(value, other) {\n        if (!(typeof value == 'string' && typeof other == 'string')) {\n          value = toNumber(value);\n          other = toNumber(other);\n        }\n        return operator(value, other);\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to continue currying.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {Function} wrapFunc The function to create the `func` wrapper.\n     * @param {*} placeholder The placeholder value.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to prepend to those provided to\n     *  the new function.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createRecurry(func, bitmask, wrapFunc, placeholder, thisArg, partials, holders, argPos, ary, arity) {\n      var isCurry = bitmask & WRAP_CURRY_FLAG,\n          newHolders = isCurry ? holders : undefined,\n          newHoldersRight = isCurry ? undefined : holders,\n          newPartials = isCurry ? partials : undefined,\n          newPartialsRight = isCurry ? undefined : partials;\n\n      bitmask |= (isCurry ? WRAP_PARTIAL_FLAG : WRAP_PARTIAL_RIGHT_FLAG);\n      bitmask &= ~(isCurry ? WRAP_PARTIAL_RIGHT_FLAG : WRAP_PARTIAL_FLAG);\n\n      if (!(bitmask & WRAP_CURRY_BOUND_FLAG)) {\n        bitmask &= ~(WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG);\n      }\n      var newData = [\n        func, bitmask, thisArg, newPartials, newHolders, newPartialsRight,\n        newHoldersRight, argPos, ary, arity\n      ];\n\n      var result = wrapFunc.apply(undefined, newData);\n      if (isLaziable(func)) {\n        setData(result, newData);\n      }\n      result.placeholder = placeholder;\n      return setWrapToString(result, func, bitmask);\n    }\n\n    /**\n     * Creates a function like `_.round`.\n     *\n     * @private\n     * @param {string} methodName The name of the `Math` method to use when rounding.\n     * @returns {Function} Returns the new round function.\n     */\n    function createRound(methodName) {\n      var func = Math[methodName];\n      return function(number, precision) {\n        number = toNumber(number);\n        precision = precision == null ? 0 : nativeMin(toInteger(precision), 292);\n        if (precision && nativeIsFinite(number)) {\n          // Shift with exponential notation to avoid floating-point issues.\n          // See [MDN](https://mdn.io/round#Examples) for more details.\n          var pair = (toString(number) + 'e').split('e'),\n              value = func(pair[0] + 'e' + (+pair[1] + precision));\n\n          pair = (toString(value) + 'e').split('e');\n          return +(pair[0] + 'e' + (+pair[1] - precision));\n        }\n        return func(number);\n      };\n    }\n\n    /**\n     * Creates a set object of `values`.\n     *\n     * @private\n     * @param {Array} values The values to add to the set.\n     * @returns {Object} Returns the new set.\n     */\n    var createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n      return new Set(values);\n    };\n\n    /**\n     * Creates a `_.toPairs` or `_.toPairsIn` function.\n     *\n     * @private\n     * @param {Function} keysFunc The function to get the keys of a given object.\n     * @returns {Function} Returns the new pairs function.\n     */\n    function createToPairs(keysFunc) {\n      return function(object) {\n        var tag = getTag(object);\n        if (tag == mapTag) {\n          return mapToArray(object);\n        }\n        if (tag == setTag) {\n          return setToPairs(object);\n        }\n        return baseToPairs(object, keysFunc(object));\n      };\n    }\n\n    /**\n     * Creates a function that either curries or invokes `func` with optional\n     * `this` binding and partially applied arguments.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to wrap.\n     * @param {number} bitmask The bitmask flags.\n     *    1 - `_.bind`\n     *    2 - `_.bindKey`\n     *    4 - `_.curry` or `_.curryRight` of a bound function\n     *    8 - `_.curry`\n     *   16 - `_.curryRight`\n     *   32 - `_.partial`\n     *   64 - `_.partialRight`\n     *  128 - `_.rearg`\n     *  256 - `_.ary`\n     *  512 - `_.flip`\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to be partially applied.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createWrap(func, bitmask, thisArg, partials, holders, argPos, ary, arity) {\n      var isBindKey = bitmask & WRAP_BIND_KEY_FLAG;\n      if (!isBindKey && typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      var length = partials ? partials.length : 0;\n      if (!length) {\n        bitmask &= ~(WRAP_PARTIAL_FLAG | WRAP_PARTIAL_RIGHT_FLAG);\n        partials = holders = undefined;\n      }\n      ary = ary === undefined ? ary : nativeMax(toInteger(ary), 0);\n      arity = arity === undefined ? arity : toInteger(arity);\n      length -= holders ? holders.length : 0;\n\n      if (bitmask & WRAP_PARTIAL_RIGHT_FLAG) {\n        var partialsRight = partials,\n            holdersRight = holders;\n\n        partials = holders = undefined;\n      }\n      var data = isBindKey ? undefined : getData(func);\n\n      var newData = [\n        func, bitmask, thisArg, partials, holders, partialsRight, holdersRight,\n        argPos, ary, arity\n      ];\n\n      if (data) {\n        mergeData(newData, data);\n      }\n      func = newData[0];\n      bitmask = newData[1];\n      thisArg = newData[2];\n      partials = newData[3];\n      holders = newData[4];\n      arity = newData[9] = newData[9] === undefined\n        ? (isBindKey ? 0 : func.length)\n        : nativeMax(newData[9] - length, 0);\n\n      if (!arity && bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG)) {\n        bitmask &= ~(WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG);\n      }\n      if (!bitmask || bitmask == WRAP_BIND_FLAG) {\n        var result = createBind(func, bitmask, thisArg);\n      } else if (bitmask == WRAP_CURRY_FLAG || bitmask == WRAP_CURRY_RIGHT_FLAG) {\n        result = createCurry(func, bitmask, arity);\n      } else if ((bitmask == WRAP_PARTIAL_FLAG || bitmask == (WRAP_BIND_FLAG | WRAP_PARTIAL_FLAG)) && !holders.length) {\n        result = createPartial(func, bitmask, thisArg, partials);\n      } else {\n        result = createHybrid.apply(undefined, newData);\n      }\n      var setter = data ? baseSetData : setData;\n      return setWrapToString(setter(result, newData), func, bitmask);\n    }\n\n    /**\n     * Used by `_.defaults` to customize its `_.assignIn` use to assign properties\n     * of source objects to the destination object for all destination properties\n     * that resolve to `undefined`.\n     *\n     * @private\n     * @param {*} objValue The destination value.\n     * @param {*} srcValue The source value.\n     * @param {string} key The key of the property to assign.\n     * @param {Object} object The parent object of `objValue`.\n     * @returns {*} Returns the value to assign.\n     */\n    function customDefaultsAssignIn(objValue, srcValue, key, object) {\n      if (objValue === undefined ||\n          (eq(objValue, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n        return srcValue;\n      }\n      return objValue;\n    }\n\n    /**\n     * Used by `_.defaultsDeep` to customize its `_.merge` use to merge source\n     * objects into destination objects that are passed thru.\n     *\n     * @private\n     * @param {*} objValue The destination value.\n     * @param {*} srcValue The source value.\n     * @param {string} key The key of the property to merge.\n     * @param {Object} object The parent object of `objValue`.\n     * @param {Object} source The parent object of `srcValue`.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     * @returns {*} Returns the value to assign.\n     */\n    function customDefaultsMerge(objValue, srcValue, key, object, source, stack) {\n      if (isObject(objValue) && isObject(srcValue)) {\n        // Recursively merge objects and arrays (susceptible to call stack limits).\n        stack.set(srcValue, objValue);\n        baseMerge(objValue, srcValue, undefined, customDefaultsMerge, stack);\n        stack['delete'](srcValue);\n      }\n      return objValue;\n    }\n\n    /**\n     * Used by `_.omit` to customize its `_.cloneDeep` use to only clone plain\n     * objects.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @param {string} key The key of the property to inspect.\n     * @returns {*} Returns the uncloned value or `undefined` to defer cloning to `_.cloneDeep`.\n     */\n    function customOmitClone(value) {\n      return isPlainObject(value) ? undefined : value;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for arrays with support for\n     * partial deep comparisons.\n     *\n     * @private\n     * @param {Array} array The array to compare.\n     * @param {Array} other The other array to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `array` and `other` objects.\n     * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n     */\n    function equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n          arrLength = array.length,\n          othLength = other.length;\n\n      if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n        return false;\n      }\n      // Check that cyclic values are equal.\n      var arrStacked = stack.get(array);\n      var othStacked = stack.get(other);\n      if (arrStacked && othStacked) {\n        return arrStacked == other && othStacked == array;\n      }\n      var index = -1,\n          result = true,\n          seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n      stack.set(array, other);\n      stack.set(other, array);\n\n      // Ignore non-index properties.\n      while (++index < arrLength) {\n        var arrValue = array[index],\n            othValue = other[index];\n\n        if (customizer) {\n          var compared = isPartial\n            ? customizer(othValue, arrValue, index, other, array, stack)\n            : customizer(arrValue, othValue, index, array, other, stack);\n        }\n        if (compared !== undefined) {\n          if (compared) {\n            continue;\n          }\n          result = false;\n          break;\n        }\n        // Recursively compare arrays (susceptible to call stack limits).\n        if (seen) {\n          if (!arraySome(other, function(othValue, othIndex) {\n                if (!cacheHas(seen, othIndex) &&\n                    (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n                  return seen.push(othIndex);\n                }\n              })) {\n            result = false;\n            break;\n          }\n        } else if (!(\n              arrValue === othValue ||\n                equalFunc(arrValue, othValue, bitmask, customizer, stack)\n            )) {\n          result = false;\n          break;\n        }\n      }\n      stack['delete'](array);\n      stack['delete'](other);\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for comparing objects of\n     * the same `toStringTag`.\n     *\n     * **Note:** This function only supports comparing values with tags of\n     * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {string} tag The `toStringTag` of the objects to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n      switch (tag) {\n        case dataViewTag:\n          if ((object.byteLength != other.byteLength) ||\n              (object.byteOffset != other.byteOffset)) {\n            return false;\n          }\n          object = object.buffer;\n          other = other.buffer;\n\n        case arrayBufferTag:\n          if ((object.byteLength != other.byteLength) ||\n              !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n            return false;\n          }\n          return true;\n\n        case boolTag:\n        case dateTag:\n        case numberTag:\n          // Coerce booleans to `1` or `0` and dates to milliseconds.\n          // Invalid dates are coerced to `NaN`.\n          return eq(+object, +other);\n\n        case errorTag:\n          return object.name == other.name && object.message == other.message;\n\n        case regexpTag:\n        case stringTag:\n          // Coerce regexes to strings and treat strings, primitives and objects,\n          // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n          // for more details.\n          return object == (other + '');\n\n        case mapTag:\n          var convert = mapToArray;\n\n        case setTag:\n          var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n          convert || (convert = setToArray);\n\n          if (object.size != other.size && !isPartial) {\n            return false;\n          }\n          // Assume cyclic values are equal.\n          var stacked = stack.get(object);\n          if (stacked) {\n            return stacked == other;\n          }\n          bitmask |= COMPARE_UNORDERED_FLAG;\n\n          // Recursively compare objects (susceptible to call stack limits).\n          stack.set(object, other);\n          var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n          stack['delete'](object);\n          return result;\n\n        case symbolTag:\n          if (symbolValueOf) {\n            return symbolValueOf.call(object) == symbolValueOf.call(other);\n          }\n      }\n      return false;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for objects with support for\n     * partial deep comparisons.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n          objProps = getAllKeys(object),\n          objLength = objProps.length,\n          othProps = getAllKeys(other),\n          othLength = othProps.length;\n\n      if (objLength != othLength && !isPartial) {\n        return false;\n      }\n      var index = objLength;\n      while (index--) {\n        var key = objProps[index];\n        if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n          return false;\n        }\n      }\n      // Check that cyclic values are equal.\n      var objStacked = stack.get(object);\n      var othStacked = stack.get(other);\n      if (objStacked && othStacked) {\n        return objStacked == other && othStacked == object;\n      }\n      var result = true;\n      stack.set(object, other);\n      stack.set(other, object);\n\n      var skipCtor = isPartial;\n      while (++index < objLength) {\n        key = objProps[index];\n        var objValue = object[key],\n            othValue = other[key];\n\n        if (customizer) {\n          var compared = isPartial\n            ? customizer(othValue, objValue, key, other, object, stack)\n            : customizer(objValue, othValue, key, object, other, stack);\n        }\n        // Recursively compare objects (susceptible to call stack limits).\n        if (!(compared === undefined\n              ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n              : compared\n            )) {\n          result = false;\n          break;\n        }\n        skipCtor || (skipCtor = key == 'constructor');\n      }\n      if (result && !skipCtor) {\n        var objCtor = object.constructor,\n            othCtor = other.constructor;\n\n        // Non `Object` object instances with different constructors are not equal.\n        if (objCtor != othCtor &&\n            ('constructor' in object && 'constructor' in other) &&\n            !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n              typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n          result = false;\n        }\n      }\n      stack['delete'](object);\n      stack['delete'](other);\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseRest` which flattens the rest array.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @returns {Function} Returns the new function.\n     */\n    function flatRest(func) {\n      return setToString(overRest(func, undefined, flatten), func + '');\n    }\n\n    /**\n     * Creates an array of own enumerable property names and symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function getAllKeys(object) {\n      return baseGetAllKeys(object, keys, getSymbols);\n    }\n\n    /**\n     * Creates an array of own and inherited enumerable property names and\n     * symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function getAllKeysIn(object) {\n      return baseGetAllKeys(object, keysIn, getSymbolsIn);\n    }\n\n    /**\n     * Gets metadata for `func`.\n     *\n     * @private\n     * @param {Function} func The function to query.\n     * @returns {*} Returns the metadata for `func`.\n     */\n    var getData = !metaMap ? noop : function(func) {\n      return metaMap.get(func);\n    };\n\n    /**\n     * Gets the name of `func`.\n     *\n     * @private\n     * @param {Function} func The function to query.\n     * @returns {string} Returns the function name.\n     */\n    function getFuncName(func) {\n      var result = (func.name + ''),\n          array = realNames[result],\n          length = hasOwnProperty.call(realNames, result) ? array.length : 0;\n\n      while (length--) {\n        var data = array[length],\n            otherFunc = data.func;\n        if (otherFunc == null || otherFunc == func) {\n          return data.name;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Gets the argument placeholder value for `func`.\n     *\n     * @private\n     * @param {Function} func The function to inspect.\n     * @returns {*} Returns the placeholder value.\n     */\n    function getHolder(func) {\n      var object = hasOwnProperty.call(lodash, 'placeholder') ? lodash : func;\n      return object.placeholder;\n    }\n\n    /**\n     * Gets the appropriate \"iteratee\" function. If `_.iteratee` is customized,\n     * this function returns the custom method, otherwise it returns `baseIteratee`.\n     * If arguments are provided, the chosen function is invoked with them and\n     * its result is returned.\n     *\n     * @private\n     * @param {*} [value] The value to convert to an iteratee.\n     * @param {number} [arity] The arity of the created iteratee.\n     * @returns {Function} Returns the chosen function or its result.\n     */\n    function getIteratee() {\n      var result = lodash.iteratee || iteratee;\n      result = result === iteratee ? baseIteratee : result;\n      return arguments.length ? result(arguments[0], arguments[1]) : result;\n    }\n\n    /**\n     * Gets the data for `map`.\n     *\n     * @private\n     * @param {Object} map The map to query.\n     * @param {string} key The reference key.\n     * @returns {*} Returns the map data.\n     */\n    function getMapData(map, key) {\n      var data = map.__data__;\n      return isKeyable(key)\n        ? data[typeof key == 'string' ? 'string' : 'hash']\n        : data.map;\n    }\n\n    /**\n     * Gets the property names, values, and compare flags of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the match data of `object`.\n     */\n    function getMatchData(object) {\n      var result = keys(object),\n          length = result.length;\n\n      while (length--) {\n        var key = result[length],\n            value = object[key];\n\n        result[length] = [key, value, isStrictComparable(value)];\n      }\n      return result;\n    }\n\n    /**\n     * Gets the native function at `key` of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {string} key The key of the method to get.\n     * @returns {*} Returns the function if it's native, else `undefined`.\n     */\n    function getNative(object, key) {\n      var value = getValue(object, key);\n      return baseIsNative(value) ? value : undefined;\n    }\n\n    /**\n     * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the raw `toStringTag`.\n     */\n    function getRawTag(value) {\n      var isOwn = hasOwnProperty.call(value, symToStringTag),\n          tag = value[symToStringTag];\n\n      try {\n        value[symToStringTag] = undefined;\n        var unmasked = true;\n      } catch (e) {}\n\n      var result = nativeObjectToString.call(value);\n      if (unmasked) {\n        if (isOwn) {\n          value[symToStringTag] = tag;\n        } else {\n          delete value[symToStringTag];\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array of the own enumerable symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of symbols.\n     */\n    var getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n      if (object == null) {\n        return [];\n      }\n      object = Object(object);\n      return arrayFilter(nativeGetSymbols(object), function(symbol) {\n        return propertyIsEnumerable.call(object, symbol);\n      });\n    };\n\n    /**\n     * Creates an array of the own and inherited enumerable symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of symbols.\n     */\n    var getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n      var result = [];\n      while (object) {\n        arrayPush(result, getSymbols(object));\n        object = getPrototype(object);\n      }\n      return result;\n    };\n\n    /**\n     * Gets the `toStringTag` of `value`.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the `toStringTag`.\n     */\n    var getTag = baseGetTag;\n\n    // Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\n    if ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n        (Map && getTag(new Map) != mapTag) ||\n        (Promise && getTag(Promise.resolve()) != promiseTag) ||\n        (Set && getTag(new Set) != setTag) ||\n        (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n      getTag = function(value) {\n        var result = baseGetTag(value),\n            Ctor = result == objectTag ? value.constructor : undefined,\n            ctorString = Ctor ? toSource(Ctor) : '';\n\n        if (ctorString) {\n          switch (ctorString) {\n            case dataViewCtorString: return dataViewTag;\n            case mapCtorString: return mapTag;\n            case promiseCtorString: return promiseTag;\n            case setCtorString: return setTag;\n            case weakMapCtorString: return weakMapTag;\n          }\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Gets the view, applying any `transforms` to the `start` and `end` positions.\n     *\n     * @private\n     * @param {number} start The start of the view.\n     * @param {number} end The end of the view.\n     * @param {Array} transforms The transformations to apply to the view.\n     * @returns {Object} Returns an object containing the `start` and `end`\n     *  positions of the view.\n     */\n    function getView(start, end, transforms) {\n      var index = -1,\n          length = transforms.length;\n\n      while (++index < length) {\n        var data = transforms[index],\n            size = data.size;\n\n        switch (data.type) {\n          case 'drop':      start += size; break;\n          case 'dropRight': end -= size; break;\n          case 'take':      end = nativeMin(end, start + size); break;\n          case 'takeRight': start = nativeMax(start, end - size); break;\n        }\n      }\n      return { 'start': start, 'end': end };\n    }\n\n    /**\n     * Extracts wrapper details from the `source` body comment.\n     *\n     * @private\n     * @param {string} source The source to inspect.\n     * @returns {Array} Returns the wrapper details.\n     */\n    function getWrapDetails(source) {\n      var match = source.match(reWrapDetails);\n      return match ? match[1].split(reSplitDetails) : [];\n    }\n\n    /**\n     * Checks if `path` exists on `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @param {Function} hasFunc The function to check properties.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     */\n    function hasPath(object, path, hasFunc) {\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length,\n          result = false;\n\n      while (++index < length) {\n        var key = toKey(path[index]);\n        if (!(result = object != null && hasFunc(object, key))) {\n          break;\n        }\n        object = object[key];\n      }\n      if (result || ++index != length) {\n        return result;\n      }\n      length = object == null ? 0 : object.length;\n      return !!length && isLength(length) && isIndex(key, length) &&\n        (isArray(object) || isArguments(object));\n    }\n\n    /**\n     * Initializes an array clone.\n     *\n     * @private\n     * @param {Array} array The array to clone.\n     * @returns {Array} Returns the initialized clone.\n     */\n    function initCloneArray(array) {\n      var length = array.length,\n          result = new array.constructor(length);\n\n      // Add properties assigned by `RegExp#exec`.\n      if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n        result.index = array.index;\n        result.input = array.input;\n      }\n      return result;\n    }\n\n    /**\n     * Initializes an object clone.\n     *\n     * @private\n     * @param {Object} object The object to clone.\n     * @returns {Object} Returns the initialized clone.\n     */\n    function initCloneObject(object) {\n      return (typeof object.constructor == 'function' && !isPrototype(object))\n        ? baseCreate(getPrototype(object))\n        : {};\n    }\n\n    /**\n     * Initializes an object clone based on its `toStringTag`.\n     *\n     * **Note:** This function only supports cloning values with tags of\n     * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n     *\n     * @private\n     * @param {Object} object The object to clone.\n     * @param {string} tag The `toStringTag` of the object to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the initialized clone.\n     */\n    function initCloneByTag(object, tag, isDeep) {\n      var Ctor = object.constructor;\n      switch (tag) {\n        case arrayBufferTag:\n          return cloneArrayBuffer(object);\n\n        case boolTag:\n        case dateTag:\n          return new Ctor(+object);\n\n        case dataViewTag:\n          return cloneDataView(object, isDeep);\n\n        case float32Tag: case float64Tag:\n        case int8Tag: case int16Tag: case int32Tag:\n        case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n          return cloneTypedArray(object, isDeep);\n\n        case mapTag:\n          return new Ctor;\n\n        case numberTag:\n        case stringTag:\n          return new Ctor(object);\n\n        case regexpTag:\n          return cloneRegExp(object);\n\n        case setTag:\n          return new Ctor;\n\n        case symbolTag:\n          return cloneSymbol(object);\n      }\n    }\n\n    /**\n     * Inserts wrapper `details` in a comment at the top of the `source` body.\n     *\n     * @private\n     * @param {string} source The source to modify.\n     * @returns {Array} details The details to insert.\n     * @returns {string} Returns the modified source.\n     */\n    function insertWrapDetails(source, details) {\n      var length = details.length;\n      if (!length) {\n        return source;\n      }\n      var lastIndex = length - 1;\n      details[lastIndex] = (length > 1 ? '& ' : '') + details[lastIndex];\n      details = details.join(length > 2 ? ', ' : ' ');\n      return source.replace(reWrapComment, '{\\n/* [wrapped with ' + details + '] */\\n');\n    }\n\n    /**\n     * Checks if `value` is a flattenable `arguments` object or array.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n     */\n    function isFlattenable(value) {\n      return isArray(value) || isArguments(value) ||\n        !!(spreadableSymbol && value && value[spreadableSymbol]);\n    }\n\n    /**\n     * Checks if `value` is a valid array-like index.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n     * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n     */\n    function isIndex(value, length) {\n      var type = typeof value;\n      length = length == null ? MAX_SAFE_INTEGER : length;\n\n      return !!length &&\n        (type == 'number' ||\n          (type != 'symbol' && reIsUint.test(value))) &&\n            (value > -1 && value % 1 == 0 && value < length);\n    }\n\n    /**\n     * Checks if the given arguments are from an iteratee call.\n     *\n     * @private\n     * @param {*} value The potential iteratee value argument.\n     * @param {*} index The potential iteratee index or key argument.\n     * @param {*} object The potential iteratee object argument.\n     * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n     *  else `false`.\n     */\n    function isIterateeCall(value, index, object) {\n      if (!isObject(object)) {\n        return false;\n      }\n      var type = typeof index;\n      if (type == 'number'\n            ? (isArrayLike(object) && isIndex(index, object.length))\n            : (type == 'string' && index in object)\n          ) {\n        return eq(object[index], value);\n      }\n      return false;\n    }\n\n    /**\n     * Checks if `value` is a property name and not a property path.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @param {Object} [object] The object to query keys on.\n     * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n     */\n    function isKey(value, object) {\n      if (isArray(value)) {\n        return false;\n      }\n      var type = typeof value;\n      if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n          value == null || isSymbol(value)) {\n        return true;\n      }\n      return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n        (object != null && value in Object(object));\n    }\n\n    /**\n     * Checks if `value` is suitable for use as unique object key.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n     */\n    function isKeyable(value) {\n      var type = typeof value;\n      return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n        ? (value !== '__proto__')\n        : (value === null);\n    }\n\n    /**\n     * Checks if `func` has a lazy counterpart.\n     *\n     * @private\n     * @param {Function} func The function to check.\n     * @returns {boolean} Returns `true` if `func` has a lazy counterpart,\n     *  else `false`.\n     */\n    function isLaziable(func) {\n      var funcName = getFuncName(func),\n          other = lodash[funcName];\n\n      if (typeof other != 'function' || !(funcName in LazyWrapper.prototype)) {\n        return false;\n      }\n      if (func === other) {\n        return true;\n      }\n      var data = getData(other);\n      return !!data && func === data[0];\n    }\n\n    /**\n     * Checks if `func` has its source masked.\n     *\n     * @private\n     * @param {Function} func The function to check.\n     * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n     */\n    function isMasked(func) {\n      return !!maskSrcKey && (maskSrcKey in func);\n    }\n\n    /**\n     * Checks if `func` is capable of being masked.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `func` is maskable, else `false`.\n     */\n    var isMaskable = coreJsData ? isFunction : stubFalse;\n\n    /**\n     * Checks if `value` is likely a prototype object.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n     */\n    function isPrototype(value) {\n      var Ctor = value && value.constructor,\n          proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n      return value === proto;\n    }\n\n    /**\n     * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` if suitable for strict\n     *  equality comparisons, else `false`.\n     */\n    function isStrictComparable(value) {\n      return value === value && !isObject(value);\n    }\n\n    /**\n     * A specialized version of `matchesProperty` for source values suitable\n     * for strict equality comparisons, i.e. `===`.\n     *\n     * @private\n     * @param {string} key The key of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function matchesStrictComparable(key, srcValue) {\n      return function(object) {\n        if (object == null) {\n          return false;\n        }\n        return object[key] === srcValue &&\n          (srcValue !== undefined || (key in Object(object)));\n      };\n    }\n\n    /**\n     * A specialized version of `_.memoize` which clears the memoized function's\n     * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n     *\n     * @private\n     * @param {Function} func The function to have its output memoized.\n     * @returns {Function} Returns the new memoized function.\n     */\n    function memoizeCapped(func) {\n      var result = memoize(func, function(key) {\n        if (cache.size === MAX_MEMOIZE_SIZE) {\n          cache.clear();\n        }\n        return key;\n      });\n\n      var cache = result.cache;\n      return result;\n    }\n\n    /**\n     * Merges the function metadata of `source` into `data`.\n     *\n     * Merging metadata reduces the number of wrappers used to invoke a function.\n     * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`\n     * may be applied regardless of execution order. Methods like `_.ary` and\n     * `_.rearg` modify function arguments, making the order in which they are\n     * executed important, preventing the merging of metadata. However, we make\n     * an exception for a safe combined case where curried functions have `_.ary`\n     * and or `_.rearg` applied.\n     *\n     * @private\n     * @param {Array} data The destination metadata.\n     * @param {Array} source The source metadata.\n     * @returns {Array} Returns `data`.\n     */\n    function mergeData(data, source) {\n      var bitmask = data[1],\n          srcBitmask = source[1],\n          newBitmask = bitmask | srcBitmask,\n          isCommon = newBitmask < (WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG | WRAP_ARY_FLAG);\n\n      var isCombo =\n        ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_CURRY_FLAG)) ||\n        ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_REARG_FLAG) && (data[7].length <= source[8])) ||\n        ((srcBitmask == (WRAP_ARY_FLAG | WRAP_REARG_FLAG)) && (source[7].length <= source[8]) && (bitmask == WRAP_CURRY_FLAG));\n\n      // Exit early if metadata can't be merged.\n      if (!(isCommon || isCombo)) {\n        return data;\n      }\n      // Use source `thisArg` if available.\n      if (srcBitmask & WRAP_BIND_FLAG) {\n        data[2] = source[2];\n        // Set when currying a bound function.\n        newBitmask |= bitmask & WRAP_BIND_FLAG ? 0 : WRAP_CURRY_BOUND_FLAG;\n      }\n      // Compose partial arguments.\n      var value = source[3];\n      if (value) {\n        var partials = data[3];\n        data[3] = partials ? composeArgs(partials, value, source[4]) : value;\n        data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : source[4];\n      }\n      // Compose partial right arguments.\n      value = source[5];\n      if (value) {\n        partials = data[5];\n        data[5] = partials ? composeArgsRight(partials, value, source[6]) : value;\n        data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : source[6];\n      }\n      // Use source `argPos` if available.\n      value = source[7];\n      if (value) {\n        data[7] = value;\n      }\n      // Use source `ary` if it's smaller.\n      if (srcBitmask & WRAP_ARY_FLAG) {\n        data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);\n      }\n      // Use source `arity` if one is not provided.\n      if (data[9] == null) {\n        data[9] = source[9];\n      }\n      // Use source `func` and merge bitmasks.\n      data[0] = source[0];\n      data[1] = newBitmask;\n\n      return data;\n    }\n\n    /**\n     * This function is like\n     * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n     * except that it includes inherited enumerable properties.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function nativeKeysIn(object) {\n      var result = [];\n      if (object != null) {\n        for (var key in Object(object)) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Converts `value` to a string using `Object.prototype.toString`.\n     *\n     * @private\n     * @param {*} value The value to convert.\n     * @returns {string} Returns the converted string.\n     */\n    function objectToString(value) {\n      return nativeObjectToString.call(value);\n    }\n\n    /**\n     * A specialized version of `baseRest` which transforms the rest array.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @param {Function} transform The rest array transform.\n     * @returns {Function} Returns the new function.\n     */\n    function overRest(func, start, transform) {\n      start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n      return function() {\n        var args = arguments,\n            index = -1,\n            length = nativeMax(args.length - start, 0),\n            array = Array(length);\n\n        while (++index < length) {\n          array[index] = args[start + index];\n        }\n        index = -1;\n        var otherArgs = Array(start + 1);\n        while (++index < start) {\n          otherArgs[index] = args[index];\n        }\n        otherArgs[start] = transform(array);\n        return apply(func, this, otherArgs);\n      };\n    }\n\n    /**\n     * Gets the parent value at `path` of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array} path The path to get the parent value of.\n     * @returns {*} Returns the parent value.\n     */\n    function parent(object, path) {\n      return path.length < 2 ? object : baseGet(object, baseSlice(path, 0, -1));\n    }\n\n    /**\n     * Reorder `array` according to the specified indexes where the element at\n     * the first index is assigned as the first element, the element at\n     * the second index is assigned as the second element, and so on.\n     *\n     * @private\n     * @param {Array} array The array to reorder.\n     * @param {Array} indexes The arranged array indexes.\n     * @returns {Array} Returns `array`.\n     */\n    function reorder(array, indexes) {\n      var arrLength = array.length,\n          length = nativeMin(indexes.length, arrLength),\n          oldArray = copyArray(array);\n\n      while (length--) {\n        var index = indexes[length];\n        array[length] = isIndex(index, arrLength) ? oldArray[index] : undefined;\n      }\n      return array;\n    }\n\n    /**\n     * Gets the value at `key`, unless `key` is \"__proto__\" or \"constructor\".\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {string} key The key of the property to get.\n     * @returns {*} Returns the property value.\n     */\n    function safeGet(object, key) {\n      if (key === 'constructor' && typeof object[key] === 'function') {\n        return;\n      }\n\n      if (key == '__proto__') {\n        return;\n      }\n\n      return object[key];\n    }\n\n    /**\n     * Sets metadata for `func`.\n     *\n     * **Note:** If this function becomes hot, i.e. is invoked a lot in a short\n     * period of time, it will trip its breaker and transition to an identity\n     * function to avoid garbage collection pauses in V8. See\n     * [V8 issue 2070](https://bugs.chromium.org/p/v8/issues/detail?id=2070)\n     * for more details.\n     *\n     * @private\n     * @param {Function} func The function to associate metadata with.\n     * @param {*} data The metadata.\n     * @returns {Function} Returns `func`.\n     */\n    var setData = shortOut(baseSetData);\n\n    /**\n     * A simple wrapper around the global [`setTimeout`](https://mdn.io/setTimeout).\n     *\n     * @private\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @returns {number|Object} Returns the timer id or timeout object.\n     */\n    var setTimeout = ctxSetTimeout || function(func, wait) {\n      return root.setTimeout(func, wait);\n    };\n\n    /**\n     * Sets the `toString` method of `func` to return `string`.\n     *\n     * @private\n     * @param {Function} func The function to modify.\n     * @param {Function} string The `toString` result.\n     * @returns {Function} Returns `func`.\n     */\n    var setToString = shortOut(baseSetToString);\n\n    /**\n     * Sets the `toString` method of `wrapper` to mimic the source of `reference`\n     * with wrapper details in a comment at the top of the source body.\n     *\n     * @private\n     * @param {Function} wrapper The function to modify.\n     * @param {Function} reference The reference function.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @returns {Function} Returns `wrapper`.\n     */\n    function setWrapToString(wrapper, reference, bitmask) {\n      var source = (reference + '');\n      return setToString(wrapper, insertWrapDetails(source, updateWrapDetails(getWrapDetails(source), bitmask)));\n    }\n\n    /**\n     * Creates a function that'll short out and invoke `identity` instead\n     * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n     * milliseconds.\n     *\n     * @private\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new shortable function.\n     */\n    function shortOut(func) {\n      var count = 0,\n          lastCalled = 0;\n\n      return function() {\n        var stamp = nativeNow(),\n            remaining = HOT_SPAN - (stamp - lastCalled);\n\n        lastCalled = stamp;\n        if (remaining > 0) {\n          if (++count >= HOT_COUNT) {\n            return arguments[0];\n          }\n        } else {\n          count = 0;\n        }\n        return func.apply(undefined, arguments);\n      };\n    }\n\n    /**\n     * A specialized version of `_.shuffle` which mutates and sets the size of `array`.\n     *\n     * @private\n     * @param {Array} array The array to shuffle.\n     * @param {number} [size=array.length] The size of `array`.\n     * @returns {Array} Returns `array`.\n     */\n    function shuffleSelf(array, size) {\n      var index = -1,\n          length = array.length,\n          lastIndex = length - 1;\n\n      size = size === undefined ? length : size;\n      while (++index < size) {\n        var rand = baseRandom(index, lastIndex),\n            value = array[rand];\n\n        array[rand] = array[index];\n        array[index] = value;\n      }\n      array.length = size;\n      return array;\n    }\n\n    /**\n     * Converts `string` to a property path array.\n     *\n     * @private\n     * @param {string} string The string to convert.\n     * @returns {Array} Returns the property path array.\n     */\n    var stringToPath = memoizeCapped(function(string) {\n      var result = [];\n      if (string.charCodeAt(0) === 46 /* . */) {\n        result.push('');\n      }\n      string.replace(rePropName, function(match, number, quote, subString) {\n        result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n      });\n      return result;\n    });\n\n    /**\n     * Converts `value` to a string key if it's not a string or symbol.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {string|symbol} Returns the key.\n     */\n    function toKey(value) {\n      if (typeof value == 'string' || isSymbol(value)) {\n        return value;\n      }\n      var result = (value + '');\n      return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n    }\n\n    /**\n     * Converts `func` to its source code.\n     *\n     * @private\n     * @param {Function} func The function to convert.\n     * @returns {string} Returns the source code.\n     */\n    function toSource(func) {\n      if (func != null) {\n        try {\n          return funcToString.call(func);\n        } catch (e) {}\n        try {\n          return (func + '');\n        } catch (e) {}\n      }\n      return '';\n    }\n\n    /**\n     * Updates wrapper `details` based on `bitmask` flags.\n     *\n     * @private\n     * @returns {Array} details The details to modify.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @returns {Array} Returns `details`.\n     */\n    function updateWrapDetails(details, bitmask) {\n      arrayEach(wrapFlags, function(pair) {\n        var value = '_.' + pair[0];\n        if ((bitmask & pair[1]) && !arrayIncludes(details, value)) {\n          details.push(value);\n        }\n      });\n      return details.sort();\n    }\n\n    /**\n     * Creates a clone of `wrapper`.\n     *\n     * @private\n     * @param {Object} wrapper The wrapper to clone.\n     * @returns {Object} Returns the cloned wrapper.\n     */\n    function wrapperClone(wrapper) {\n      if (wrapper instanceof LazyWrapper) {\n        return wrapper.clone();\n      }\n      var result = new LodashWrapper(wrapper.__wrapped__, wrapper.__chain__);\n      result.__actions__ = copyArray(wrapper.__actions__);\n      result.__index__  = wrapper.__index__;\n      result.__values__ = wrapper.__values__;\n      return result;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of elements split into groups the length of `size`.\n     * If `array` can't be split evenly, the final chunk will be the remaining\n     * elements.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to process.\n     * @param {number} [size=1] The length of each chunk\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the new array of chunks.\n     * @example\n     *\n     * _.chunk(['a', 'b', 'c', 'd'], 2);\n     * // => [['a', 'b'], ['c', 'd']]\n     *\n     * _.chunk(['a', 'b', 'c', 'd'], 3);\n     * // => [['a', 'b', 'c'], ['d']]\n     */\n    function chunk(array, size, guard) {\n      if ((guard ? isIterateeCall(array, size, guard) : size === undefined)) {\n        size = 1;\n      } else {\n        size = nativeMax(toInteger(size), 0);\n      }\n      var length = array == null ? 0 : array.length;\n      if (!length || size < 1) {\n        return [];\n      }\n      var index = 0,\n          resIndex = 0,\n          result = Array(nativeCeil(length / size));\n\n      while (index < length) {\n        result[resIndex++] = baseSlice(array, index, (index += size));\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array with all falsey values removed. The values `false`, `null`,\n     * `0`, `\"\"`, `undefined`, and `NaN` are falsey.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to compact.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.compact([0, 1, false, 2, '', 3]);\n     * // => [1, 2, 3]\n     */\n    function compact(array) {\n      var index = -1,\n          length = array == null ? 0 : array.length,\n          resIndex = 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index];\n        if (value) {\n          result[resIndex++] = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates a new array concatenating `array` with any additional arrays\n     * and/or values.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to concatenate.\n     * @param {...*} [values] The values to concatenate.\n     * @returns {Array} Returns the new concatenated array.\n     * @example\n     *\n     * var array = [1];\n     * var other = _.concat(array, 2, [3], [[4]]);\n     *\n     * console.log(other);\n     * // => [1, 2, 3, [4]]\n     *\n     * console.log(array);\n     * // => [1]\n     */\n    function concat() {\n      var length = arguments.length;\n      if (!length) {\n        return [];\n      }\n      var args = Array(length - 1),\n          array = arguments[0],\n          index = length;\n\n      while (index--) {\n        args[index - 1] = arguments[index];\n      }\n      return arrayPush(isArray(array) ? copyArray(array) : [array], baseFlatten(args, 1));\n    }\n\n    /**\n     * Creates an array of `array` values not included in the other given arrays\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. The order and references of result values are\n     * determined by the first array.\n     *\n     * **Note:** Unlike `_.pullAll`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.without, _.xor\n     * @example\n     *\n     * _.difference([2, 1], [2, 3]);\n     * // => [1]\n     */\n    var difference = baseRest(function(array, values) {\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))\n        : [];\n    });\n\n    /**\n     * This method is like `_.difference` except that it accepts `iteratee` which\n     * is invoked for each element of `array` and `values` to generate the criterion\n     * by which they're compared. The order and references of result values are\n     * determined by the first array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * **Note:** Unlike `_.pullAllBy`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.differenceBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.differenceBy([{ 'x': 2 }, { 'x': 1 }], [{ 'x': 1 }], 'x');\n     * // => [{ 'x': 2 }]\n     */\n    var differenceBy = baseRest(function(array, values) {\n      var iteratee = last(values);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), getIteratee(iteratee, 2))\n        : [];\n    });\n\n    /**\n     * This method is like `_.difference` except that it accepts `comparator`\n     * which is invoked to compare elements of `array` to `values`. The order and\n     * references of result values are determined by the first array. The comparator\n     * is invoked with two arguments: (arrVal, othVal).\n     *\n     * **Note:** Unlike `_.pullAllWith`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     *\n     * _.differenceWith(objects, [{ 'x': 1, 'y': 2 }], _.isEqual);\n     * // => [{ 'x': 2, 'y': 1 }]\n     */\n    var differenceWith = baseRest(function(array, values) {\n      var comparator = last(values);\n      if (isArrayLikeObject(comparator)) {\n        comparator = undefined;\n      }\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), undefined, comparator)\n        : [];\n    });\n\n    /**\n     * Creates a slice of `array` with `n` elements dropped from the beginning.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to drop.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.drop([1, 2, 3]);\n     * // => [2, 3]\n     *\n     * _.drop([1, 2, 3], 2);\n     * // => [3]\n     *\n     * _.drop([1, 2, 3], 5);\n     * // => []\n     *\n     * _.drop([1, 2, 3], 0);\n     * // => [1, 2, 3]\n     */\n    function drop(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      return baseSlice(array, n < 0 ? 0 : n, length);\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements dropped from the end.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to drop.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.dropRight([1, 2, 3]);\n     * // => [1, 2]\n     *\n     * _.dropRight([1, 2, 3], 2);\n     * // => [1]\n     *\n     * _.dropRight([1, 2, 3], 5);\n     * // => []\n     *\n     * _.dropRight([1, 2, 3], 0);\n     * // => [1, 2, 3]\n     */\n    function dropRight(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      n = length - n;\n      return baseSlice(array, 0, n < 0 ? 0 : n);\n    }\n\n    /**\n     * Creates a slice of `array` excluding elements dropped from the end.\n     * Elements are dropped until `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.dropRightWhile(users, function(o) { return !o.active; });\n     * // => objects for ['barney']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.dropRightWhile(users, { 'user': 'pebbles', 'active': false });\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.dropRightWhile(users, ['active', false]);\n     * // => objects for ['barney']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.dropRightWhile(users, 'active');\n     * // => objects for ['barney', 'fred', 'pebbles']\n     */\n    function dropRightWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), true, true)\n        : [];\n    }\n\n    /**\n     * Creates a slice of `array` excluding elements dropped from the beginning.\n     * Elements are dropped until `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.dropWhile(users, function(o) { return !o.active; });\n     * // => objects for ['pebbles']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.dropWhile(users, { 'user': 'barney', 'active': false });\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.dropWhile(users, ['active', false]);\n     * // => objects for ['pebbles']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.dropWhile(users, 'active');\n     * // => objects for ['barney', 'fred', 'pebbles']\n     */\n    function dropWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), true)\n        : [];\n    }\n\n    /**\n     * Fills elements of `array` with `value` from `start` up to, but not\n     * including, `end`.\n     *\n     * **Note:** This method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Array\n     * @param {Array} array The array to fill.\n     * @param {*} value The value to fill `array` with.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _.fill(array, 'a');\n     * console.log(array);\n     * // => ['a', 'a', 'a']\n     *\n     * _.fill(Array(3), 2);\n     * // => [2, 2, 2]\n     *\n     * _.fill([4, 6, 8, 10], '*', 1, 3);\n     * // => [4, '*', '*', 10]\n     */\n    function fill(array, value, start, end) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      if (start && typeof start != 'number' && isIterateeCall(array, value, start)) {\n        start = 0;\n        end = length;\n      }\n      return baseFill(array, value, start, end);\n    }\n\n    /**\n     * This method is like `_.find` except that it returns the index of the first\n     * element `predicate` returns truthy for instead of the element itself.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.findIndex(users, function(o) { return o.user == 'barney'; });\n     * // => 0\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findIndex(users, { 'user': 'fred', 'active': false });\n     * // => 1\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findIndex(users, ['active', false]);\n     * // => 0\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findIndex(users, 'active');\n     * // => 2\n     */\n    function findIndex(array, predicate, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = fromIndex == null ? 0 : toInteger(fromIndex);\n      if (index < 0) {\n        index = nativeMax(length + index, 0);\n      }\n      return baseFindIndex(array, getIteratee(predicate, 3), index);\n    }\n\n    /**\n     * This method is like `_.findIndex` except that it iterates over elements\n     * of `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.findLastIndex(users, function(o) { return o.user == 'pebbles'; });\n     * // => 2\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findLastIndex(users, { 'user': 'barney', 'active': true });\n     * // => 0\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findLastIndex(users, ['active', false]);\n     * // => 2\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findLastIndex(users, 'active');\n     * // => 0\n     */\n    function findLastIndex(array, predicate, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = length - 1;\n      if (fromIndex !== undefined) {\n        index = toInteger(fromIndex);\n        index = fromIndex < 0\n          ? nativeMax(length + index, 0)\n          : nativeMin(index, length - 1);\n      }\n      return baseFindIndex(array, getIteratee(predicate, 3), index, true);\n    }\n\n    /**\n     * Flattens `array` a single level deep.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * _.flatten([1, [2, [3, [4]], 5]]);\n     * // => [1, 2, [3, [4]], 5]\n     */\n    function flatten(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseFlatten(array, 1) : [];\n    }\n\n    /**\n     * Recursively flattens `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * _.flattenDeep([1, [2, [3, [4]], 5]]);\n     * // => [1, 2, 3, 4, 5]\n     */\n    function flattenDeep(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseFlatten(array, INFINITY) : [];\n    }\n\n    /**\n     * Recursively flatten `array` up to `depth` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.4.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @param {number} [depth=1] The maximum recursion depth.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * var array = [1, [2, [3, [4]], 5]];\n     *\n     * _.flattenDepth(array, 1);\n     * // => [1, 2, [3, [4]], 5]\n     *\n     * _.flattenDepth(array, 2);\n     * // => [1, 2, 3, [4], 5]\n     */\n    function flattenDepth(array, depth) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      depth = depth === undefined ? 1 : toInteger(depth);\n      return baseFlatten(array, depth);\n    }\n\n    /**\n     * The inverse of `_.toPairs`; this method returns an object composed\n     * from key-value `pairs`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} pairs The key-value pairs.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.fromPairs([['a', 1], ['b', 2]]);\n     * // => { 'a': 1, 'b': 2 }\n     */\n    function fromPairs(pairs) {\n      var index = -1,\n          length = pairs == null ? 0 : pairs.length,\n          result = {};\n\n      while (++index < length) {\n        var pair = pairs[index];\n        result[pair[0]] = pair[1];\n      }\n      return result;\n    }\n\n    /**\n     * Gets the first element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @alias first\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {*} Returns the first element of `array`.\n     * @example\n     *\n     * _.head([1, 2, 3]);\n     * // => 1\n     *\n     * _.head([]);\n     * // => undefined\n     */\n    function head(array) {\n      return (array && array.length) ? array[0] : undefined;\n    }\n\n    /**\n     * Gets the index at which the first occurrence of `value` is found in `array`\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. If `fromIndex` is negative, it's used as the\n     * offset from the end of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.indexOf([1, 2, 1, 2], 2);\n     * // => 1\n     *\n     * // Search from the `fromIndex`.\n     * _.indexOf([1, 2, 1, 2], 2, 2);\n     * // => 3\n     */\n    function indexOf(array, value, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = fromIndex == null ? 0 : toInteger(fromIndex);\n      if (index < 0) {\n        index = nativeMax(length + index, 0);\n      }\n      return baseIndexOf(array, value, index);\n    }\n\n    /**\n     * Gets all but the last element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.initial([1, 2, 3]);\n     * // => [1, 2]\n     */\n    function initial(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseSlice(array, 0, -1) : [];\n    }\n\n    /**\n     * Creates an array of unique values that are included in all given arrays\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. The order and references of result values are\n     * determined by the first array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * _.intersection([2, 1], [2, 3]);\n     * // => [2]\n     */\n    var intersection = baseRest(function(arrays) {\n      var mapped = arrayMap(arrays, castArrayLikeObject);\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped)\n        : [];\n    });\n\n    /**\n     * This method is like `_.intersection` except that it accepts `iteratee`\n     * which is invoked for each element of each `arrays` to generate the criterion\n     * by which they're compared. The order and references of result values are\n     * determined by the first array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * _.intersectionBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [2.1]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.intersectionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }]\n     */\n    var intersectionBy = baseRest(function(arrays) {\n      var iteratee = last(arrays),\n          mapped = arrayMap(arrays, castArrayLikeObject);\n\n      if (iteratee === last(mapped)) {\n        iteratee = undefined;\n      } else {\n        mapped.pop();\n      }\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped, getIteratee(iteratee, 2))\n        : [];\n    });\n\n    /**\n     * This method is like `_.intersection` except that it accepts `comparator`\n     * which is invoked to compare elements of `arrays`. The order and references\n     * of result values are determined by the first array. The comparator is\n     * invoked with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.intersectionWith(objects, others, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }]\n     */\n    var intersectionWith = baseRest(function(arrays) {\n      var comparator = last(arrays),\n          mapped = arrayMap(arrays, castArrayLikeObject);\n\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      if (comparator) {\n        mapped.pop();\n      }\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped, undefined, comparator)\n        : [];\n    });\n\n    /**\n     * Converts all elements in `array` into a string separated by `separator`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to convert.\n     * @param {string} [separator=','] The element separator.\n     * @returns {string} Returns the joined string.\n     * @example\n     *\n     * _.join(['a', 'b', 'c'], '~');\n     * // => 'a~b~c'\n     */\n    function join(array, separator) {\n      return array == null ? '' : nativeJoin.call(array, separator);\n    }\n\n    /**\n     * Gets the last element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {*} Returns the last element of `array`.\n     * @example\n     *\n     * _.last([1, 2, 3]);\n     * // => 3\n     */\n    function last(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? array[length - 1] : undefined;\n    }\n\n    /**\n     * This method is like `_.indexOf` except that it iterates over elements of\n     * `array` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.lastIndexOf([1, 2, 1, 2], 2);\n     * // => 3\n     *\n     * // Search from the `fromIndex`.\n     * _.lastIndexOf([1, 2, 1, 2], 2, 2);\n     * // => 1\n     */\n    function lastIndexOf(array, value, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = length;\n      if (fromIndex !== undefined) {\n        index = toInteger(fromIndex);\n        index = index < 0 ? nativeMax(length + index, 0) : nativeMin(index, length - 1);\n      }\n      return value === value\n        ? strictLastIndexOf(array, value, index)\n        : baseFindIndex(array, baseIsNaN, index, true);\n    }\n\n    /**\n     * Gets the element at index `n` of `array`. If `n` is negative, the nth\n     * element from the end is returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.11.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=0] The index of the element to return.\n     * @returns {*} Returns the nth element of `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'd'];\n     *\n     * _.nth(array, 1);\n     * // => 'b'\n     *\n     * _.nth(array, -2);\n     * // => 'c';\n     */\n    function nth(array, n) {\n      return (array && array.length) ? baseNth(array, toInteger(n)) : undefined;\n    }\n\n    /**\n     * Removes all given values from `array` using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * **Note:** Unlike `_.without`, this method mutates `array`. Use `_.remove`\n     * to remove elements from an array by predicate.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {...*} [values] The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'a', 'b', 'c'];\n     *\n     * _.pull(array, 'a', 'c');\n     * console.log(array);\n     * // => ['b', 'b']\n     */\n    var pull = baseRest(pullAll);\n\n    /**\n     * This method is like `_.pull` except that it accepts an array of values to remove.\n     *\n     * **Note:** Unlike `_.difference`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'a', 'b', 'c'];\n     *\n     * _.pullAll(array, ['a', 'c']);\n     * console.log(array);\n     * // => ['b', 'b']\n     */\n    function pullAll(array, values) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values)\n        : array;\n    }\n\n    /**\n     * This method is like `_.pullAll` except that it accepts `iteratee` which is\n     * invoked for each element of `array` and `values` to generate the criterion\n     * by which they're compared. The iteratee is invoked with one argument: (value).\n     *\n     * **Note:** Unlike `_.differenceBy`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [{ 'x': 1 }, { 'x': 2 }, { 'x': 3 }, { 'x': 1 }];\n     *\n     * _.pullAllBy(array, [{ 'x': 1 }, { 'x': 3 }], 'x');\n     * console.log(array);\n     * // => [{ 'x': 2 }]\n     */\n    function pullAllBy(array, values, iteratee) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values, getIteratee(iteratee, 2))\n        : array;\n    }\n\n    /**\n     * This method is like `_.pullAll` except that it accepts `comparator` which\n     * is invoked to compare elements of `array` to `values`. The comparator is\n     * invoked with two arguments: (arrVal, othVal).\n     *\n     * **Note:** Unlike `_.differenceWith`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [{ 'x': 1, 'y': 2 }, { 'x': 3, 'y': 4 }, { 'x': 5, 'y': 6 }];\n     *\n     * _.pullAllWith(array, [{ 'x': 3, 'y': 4 }], _.isEqual);\n     * console.log(array);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 5, 'y': 6 }]\n     */\n    function pullAllWith(array, values, comparator) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values, undefined, comparator)\n        : array;\n    }\n\n    /**\n     * Removes elements from `array` corresponding to `indexes` and returns an\n     * array of removed elements.\n     *\n     * **Note:** Unlike `_.at`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {...(number|number[])} [indexes] The indexes of elements to remove.\n     * @returns {Array} Returns the new array of removed elements.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'd'];\n     * var pulled = _.pullAt(array, [1, 3]);\n     *\n     * console.log(array);\n     * // => ['a', 'c']\n     *\n     * console.log(pulled);\n     * // => ['b', 'd']\n     */\n    var pullAt = flatRest(function(array, indexes) {\n      var length = array == null ? 0 : array.length,\n          result = baseAt(array, indexes);\n\n      basePullAt(array, arrayMap(indexes, function(index) {\n        return isIndex(index, length) ? +index : index;\n      }).sort(compareAscending));\n\n      return result;\n    });\n\n    /**\n     * Removes all elements from `array` that `predicate` returns truthy for\n     * and returns an array of the removed elements. The predicate is invoked\n     * with three arguments: (value, index, array).\n     *\n     * **Note:** Unlike `_.filter`, this method mutates `array`. Use `_.pull`\n     * to pull elements from an array by value.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new array of removed elements.\n     * @example\n     *\n     * var array = [1, 2, 3, 4];\n     * var evens = _.remove(array, function(n) {\n     *   return n % 2 == 0;\n     * });\n     *\n     * console.log(array);\n     * // => [1, 3]\n     *\n     * console.log(evens);\n     * // => [2, 4]\n     */\n    function remove(array, predicate) {\n      var result = [];\n      if (!(array && array.length)) {\n        return result;\n      }\n      var index = -1,\n          indexes = [],\n          length = array.length;\n\n      predicate = getIteratee(predicate, 3);\n      while (++index < length) {\n        var value = array[index];\n        if (predicate(value, index, array)) {\n          result.push(value);\n          indexes.push(index);\n        }\n      }\n      basePullAt(array, indexes);\n      return result;\n    }\n\n    /**\n     * Reverses `array` so that the first element becomes the last, the second\n     * element becomes the second to last, and so on.\n     *\n     * **Note:** This method mutates `array` and is based on\n     * [`Array#reverse`](https://mdn.io/Array/reverse).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _.reverse(array);\n     * // => [3, 2, 1]\n     *\n     * console.log(array);\n     * // => [3, 2, 1]\n     */\n    function reverse(array) {\n      return array == null ? array : nativeReverse.call(array);\n    }\n\n    /**\n     * Creates a slice of `array` from `start` up to, but not including, `end`.\n     *\n     * **Note:** This method is used instead of\n     * [`Array#slice`](https://mdn.io/Array/slice) to ensure dense arrays are\n     * returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to slice.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function slice(array, start, end) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      if (end && typeof end != 'number' && isIterateeCall(array, start, end)) {\n        start = 0;\n        end = length;\n      }\n      else {\n        start = start == null ? 0 : toInteger(start);\n        end = end === undefined ? length : toInteger(end);\n      }\n      return baseSlice(array, start, end);\n    }\n\n    /**\n     * Uses a binary search to determine the lowest index at which `value`\n     * should be inserted into `array` in order to maintain its sort order.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedIndex([30, 50], 40);\n     * // => 1\n     */\n    function sortedIndex(array, value) {\n      return baseSortedIndex(array, value);\n    }\n\n    /**\n     * This method is like `_.sortedIndex` except that it accepts `iteratee`\n     * which is invoked for `value` and each element of `array` to compute their\n     * sort ranking. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * var objects = [{ 'x': 4 }, { 'x': 5 }];\n     *\n     * _.sortedIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });\n     * // => 0\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sortedIndexBy(objects, { 'x': 4 }, 'x');\n     * // => 0\n     */\n    function sortedIndexBy(array, value, iteratee) {\n      return baseSortedIndexBy(array, value, getIteratee(iteratee, 2));\n    }\n\n    /**\n     * This method is like `_.indexOf` except that it performs a binary\n     * search on a sorted `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.sortedIndexOf([4, 5, 5, 5, 6], 5);\n     * // => 1\n     */\n    function sortedIndexOf(array, value) {\n      var length = array == null ? 0 : array.length;\n      if (length) {\n        var index = baseSortedIndex(array, value);\n        if (index < length && eq(array[index], value)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.sortedIndex` except that it returns the highest\n     * index at which `value` should be inserted into `array` in order to\n     * maintain its sort order.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedLastIndex([4, 5, 5, 5, 6], 5);\n     * // => 4\n     */\n    function sortedLastIndex(array, value) {\n      return baseSortedIndex(array, value, true);\n    }\n\n    /**\n     * This method is like `_.sortedLastIndex` except that it accepts `iteratee`\n     * which is invoked for `value` and each element of `array` to compute their\n     * sort ranking. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * var objects = [{ 'x': 4 }, { 'x': 5 }];\n     *\n     * _.sortedLastIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });\n     * // => 1\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sortedLastIndexBy(objects, { 'x': 4 }, 'x');\n     * // => 1\n     */\n    function sortedLastIndexBy(array, value, iteratee) {\n      return baseSortedIndexBy(array, value, getIteratee(iteratee, 2), true);\n    }\n\n    /**\n     * This method is like `_.lastIndexOf` except that it performs a binary\n     * search on a sorted `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.sortedLastIndexOf([4, 5, 5, 5, 6], 5);\n     * // => 3\n     */\n    function sortedLastIndexOf(array, value) {\n      var length = array == null ? 0 : array.length;\n      if (length) {\n        var index = baseSortedIndex(array, value, true) - 1;\n        if (eq(array[index], value)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.uniq` except that it's designed and optimized\n     * for sorted arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.sortedUniq([1, 1, 2]);\n     * // => [1, 2]\n     */\n    function sortedUniq(array) {\n      return (array && array.length)\n        ? baseSortedUniq(array)\n        : [];\n    }\n\n    /**\n     * This method is like `_.uniqBy` except that it's designed and optimized\n     * for sorted arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.sortedUniqBy([1.1, 1.2, 2.3, 2.4], Math.floor);\n     * // => [1.1, 2.3]\n     */\n    function sortedUniqBy(array, iteratee) {\n      return (array && array.length)\n        ? baseSortedUniq(array, getIteratee(iteratee, 2))\n        : [];\n    }\n\n    /**\n     * Gets all but the first element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.tail([1, 2, 3]);\n     * // => [2, 3]\n     */\n    function tail(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseSlice(array, 1, length) : [];\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements taken from the beginning.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to take.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.take([1, 2, 3]);\n     * // => [1]\n     *\n     * _.take([1, 2, 3], 2);\n     * // => [1, 2]\n     *\n     * _.take([1, 2, 3], 5);\n     * // => [1, 2, 3]\n     *\n     * _.take([1, 2, 3], 0);\n     * // => []\n     */\n    function take(array, n, guard) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      return baseSlice(array, 0, n < 0 ? 0 : n);\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements taken from the end.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to take.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.takeRight([1, 2, 3]);\n     * // => [3]\n     *\n     * _.takeRight([1, 2, 3], 2);\n     * // => [2, 3]\n     *\n     * _.takeRight([1, 2, 3], 5);\n     * // => [1, 2, 3]\n     *\n     * _.takeRight([1, 2, 3], 0);\n     * // => []\n     */\n    function takeRight(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      n = length - n;\n      return baseSlice(array, n < 0 ? 0 : n, length);\n    }\n\n    /**\n     * Creates a slice of `array` with elements taken from the end. Elements are\n     * taken until `predicate` returns falsey. The predicate is invoked with\n     * three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.takeRightWhile(users, function(o) { return !o.active; });\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.takeRightWhile(users, { 'user': 'pebbles', 'active': false });\n     * // => objects for ['pebbles']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.takeRightWhile(users, ['active', false]);\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.takeRightWhile(users, 'active');\n     * // => []\n     */\n    function takeRightWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), false, true)\n        : [];\n    }\n\n    /**\n     * Creates a slice of `array` with elements taken from the beginning. Elements\n     * are taken until `predicate` returns falsey. The predicate is invoked with\n     * three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.takeWhile(users, function(o) { return !o.active; });\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.takeWhile(users, { 'user': 'barney', 'active': false });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.takeWhile(users, ['active', false]);\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.takeWhile(users, 'active');\n     * // => []\n     */\n    function takeWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3))\n        : [];\n    }\n\n    /**\n     * Creates an array of unique values, in order, from all given arrays using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * _.union([2], [1, 2]);\n     * // => [2, 1]\n     */\n    var union = baseRest(function(arrays) {\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true));\n    });\n\n    /**\n     * This method is like `_.union` except that it accepts `iteratee` which is\n     * invoked for each element of each `arrays` to generate the criterion by\n     * which uniqueness is computed. Result values are chosen from the first\n     * array in which the value occurs. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * _.unionBy([2.1], [1.2, 2.3], Math.floor);\n     * // => [2.1, 1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.unionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    var unionBy = baseRest(function(arrays) {\n      var iteratee = last(arrays);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), getIteratee(iteratee, 2));\n    });\n\n    /**\n     * This method is like `_.union` except that it accepts `comparator` which\n     * is invoked to compare elements of `arrays`. Result values are chosen from\n     * the first array in which the value occurs. The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.unionWith(objects, others, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]\n     */\n    var unionWith = baseRest(function(arrays) {\n      var comparator = last(arrays);\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), undefined, comparator);\n    });\n\n    /**\n     * Creates a duplicate-free version of an array, using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons, in which only the first occurrence of each element\n     * is kept. The order of result values is determined by the order they occur\n     * in the array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.uniq([2, 1, 2]);\n     * // => [2, 1]\n     */\n    function uniq(array) {\n      return (array && array.length) ? baseUniq(array) : [];\n    }\n\n    /**\n     * This method is like `_.uniq` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * uniqueness is computed. The order of result values is determined by the\n     * order they occur in the array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.uniqBy([2.1, 1.2, 2.3], Math.floor);\n     * // => [2.1, 1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.uniqBy([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    function uniqBy(array, iteratee) {\n      return (array && array.length) ? baseUniq(array, getIteratee(iteratee, 2)) : [];\n    }\n\n    /**\n     * This method is like `_.uniq` except that it accepts `comparator` which\n     * is invoked to compare elements of `array`. The order of result values is\n     * determined by the order they occur in the array.The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.uniqWith(objects, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }]\n     */\n    function uniqWith(array, comparator) {\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return (array && array.length) ? baseUniq(array, undefined, comparator) : [];\n    }\n\n    /**\n     * This method is like `_.zip` except that it accepts an array of grouped\n     * elements and creates an array regrouping the elements to their pre-zip\n     * configuration.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.2.0\n     * @category Array\n     * @param {Array} array The array of grouped elements to process.\n     * @returns {Array} Returns the new array of regrouped elements.\n     * @example\n     *\n     * var zipped = _.zip(['a', 'b'], [1, 2], [true, false]);\n     * // => [['a', 1, true], ['b', 2, false]]\n     *\n     * _.unzip(zipped);\n     * // => [['a', 'b'], [1, 2], [true, false]]\n     */\n    function unzip(array) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      var length = 0;\n      array = arrayFilter(array, function(group) {\n        if (isArrayLikeObject(group)) {\n          length = nativeMax(group.length, length);\n          return true;\n        }\n      });\n      return baseTimes(length, function(index) {\n        return arrayMap(array, baseProperty(index));\n      });\n    }\n\n    /**\n     * This method is like `_.unzip` except that it accepts `iteratee` to specify\n     * how regrouped values should be combined. The iteratee is invoked with the\n     * elements of each group: (...group).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Array\n     * @param {Array} array The array of grouped elements to process.\n     * @param {Function} [iteratee=_.identity] The function to combine\n     *  regrouped values.\n     * @returns {Array} Returns the new array of regrouped elements.\n     * @example\n     *\n     * var zipped = _.zip([1, 2], [10, 20], [100, 200]);\n     * // => [[1, 10, 100], [2, 20, 200]]\n     *\n     * _.unzipWith(zipped, _.add);\n     * // => [3, 30, 300]\n     */\n    function unzipWith(array, iteratee) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      var result = unzip(array);\n      if (iteratee == null) {\n        return result;\n      }\n      return arrayMap(result, function(group) {\n        return apply(iteratee, undefined, group);\n      });\n    }\n\n    /**\n     * Creates an array excluding all given values using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * **Note:** Unlike `_.pull`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...*} [values] The values to exclude.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.difference, _.xor\n     * @example\n     *\n     * _.without([2, 1, 2, 3], 1, 2);\n     * // => [3]\n     */\n    var without = baseRest(function(array, values) {\n      return isArrayLikeObject(array)\n        ? baseDifference(array, values)\n        : [];\n    });\n\n    /**\n     * Creates an array of unique values that is the\n     * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n     * of the given arrays. The order of result values is determined by the order\n     * they occur in the arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.difference, _.without\n     * @example\n     *\n     * _.xor([2, 1], [2, 3]);\n     * // => [1, 3]\n     */\n    var xor = baseRest(function(arrays) {\n      return baseXor(arrayFilter(arrays, isArrayLikeObject));\n    });\n\n    /**\n     * This method is like `_.xor` except that it accepts `iteratee` which is\n     * invoked for each element of each `arrays` to generate the criterion by\n     * which by which they're compared. The order of result values is determined\n     * by the order they occur in the arrays. The iteratee is invoked with one\n     * argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.xorBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [1.2, 3.4]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.xorBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 2 }]\n     */\n    var xorBy = baseRest(function(arrays) {\n      var iteratee = last(arrays);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return baseXor(arrayFilter(arrays, isArrayLikeObject), getIteratee(iteratee, 2));\n    });\n\n    /**\n     * This method is like `_.xor` except that it accepts `comparator` which is\n     * invoked to compare elements of `arrays`. The order of result values is\n     * determined by the order they occur in the arrays. The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.xorWith(objects, others, _.isEqual);\n     * // => [{ 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]\n     */\n    var xorWith = baseRest(function(arrays) {\n      var comparator = last(arrays);\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return baseXor(arrayFilter(arrays, isArrayLikeObject), undefined, comparator);\n    });\n\n    /**\n     * Creates an array of grouped elements, the first of which contains the\n     * first elements of the given arrays, the second of which contains the\n     * second elements of the given arrays, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to process.\n     * @returns {Array} Returns the new array of grouped elements.\n     * @example\n     *\n     * _.zip(['a', 'b'], [1, 2], [true, false]);\n     * // => [['a', 1, true], ['b', 2, false]]\n     */\n    var zip = baseRest(unzip);\n\n    /**\n     * This method is like `_.fromPairs` except that it accepts two arrays,\n     * one of property identifiers and one of corresponding values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.4.0\n     * @category Array\n     * @param {Array} [props=[]] The property identifiers.\n     * @param {Array} [values=[]] The property values.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.zipObject(['a', 'b'], [1, 2]);\n     * // => { 'a': 1, 'b': 2 }\n     */\n    function zipObject(props, values) {\n      return baseZipObject(props || [], values || [], assignValue);\n    }\n\n    /**\n     * This method is like `_.zipObject` except that it supports property paths.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.1.0\n     * @category Array\n     * @param {Array} [props=[]] The property identifiers.\n     * @param {Array} [values=[]] The property values.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.zipObjectDeep(['a.b[0].c', 'a.b[1].d'], [1, 2]);\n     * // => { 'a': { 'b': [{ 'c': 1 }, { 'd': 2 }] } }\n     */\n    function zipObjectDeep(props, values) {\n      return baseZipObject(props || [], values || [], baseSet);\n    }\n\n    /**\n     * This method is like `_.zip` except that it accepts `iteratee` to specify\n     * how grouped values should be combined. The iteratee is invoked with the\n     * elements of each group: (...group).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to process.\n     * @param {Function} [iteratee=_.identity] The function to combine\n     *  grouped values.\n     * @returns {Array} Returns the new array of grouped elements.\n     * @example\n     *\n     * _.zipWith([1, 2], [10, 20], [100, 200], function(a, b, c) {\n     *   return a + b + c;\n     * });\n     * // => [111, 222]\n     */\n    var zipWith = baseRest(function(arrays) {\n      var length = arrays.length,\n          iteratee = length > 1 ? arrays[length - 1] : undefined;\n\n      iteratee = typeof iteratee == 'function' ? (arrays.pop(), iteratee) : undefined;\n      return unzipWith(arrays, iteratee);\n    });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` wrapper instance that wraps `value` with explicit method\n     * chain sequences enabled. The result of such sequences must be unwrapped\n     * with `_#value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.3.0\n     * @category Seq\n     * @param {*} value The value to wrap.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36 },\n     *   { 'user': 'fred',    'age': 40 },\n     *   { 'user': 'pebbles', 'age': 1 }\n     * ];\n     *\n     * var youngest = _\n     *   .chain(users)\n     *   .sortBy('age')\n     *   .map(function(o) {\n     *     return o.user + ' is ' + o.age;\n     *   })\n     *   .head()\n     *   .value();\n     * // => 'pebbles is 1'\n     */\n    function chain(value) {\n      var result = lodash(value);\n      result.__chain__ = true;\n      return result;\n    }\n\n    /**\n     * This method invokes `interceptor` and returns `value`. The interceptor\n     * is invoked with one argument; (value). The purpose of this method is to\n     * \"tap into\" a method chain sequence in order to modify intermediate results.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * _([1, 2, 3])\n     *  .tap(function(array) {\n     *    // Mutate input array.\n     *    array.pop();\n     *  })\n     *  .reverse()\n     *  .value();\n     * // => [2, 1]\n     */\n    function tap(value, interceptor) {\n      interceptor(value);\n      return value;\n    }\n\n    /**\n     * This method is like `_.tap` except that it returns the result of `interceptor`.\n     * The purpose of this method is to \"pass thru\" values replacing intermediate\n     * results in a method chain sequence.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Seq\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns the result of `interceptor`.\n     * @example\n     *\n     * _('  abc  ')\n     *  .chain()\n     *  .trim()\n     *  .thru(function(value) {\n     *    return [value];\n     *  })\n     *  .value();\n     * // => ['abc']\n     */\n    function thru(value, interceptor) {\n      return interceptor(value);\n    }\n\n    /**\n     * This method is the wrapper version of `_.at`.\n     *\n     * @name at\n     * @memberOf _\n     * @since 1.0.0\n     * @category Seq\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };\n     *\n     * _(object).at(['a[0].b.c', 'a[1]']).value();\n     * // => [3, 4]\n     */\n    var wrapperAt = flatRest(function(paths) {\n      var length = paths.length,\n          start = length ? paths[0] : 0,\n          value = this.__wrapped__,\n          interceptor = function(object) { return baseAt(object, paths); };\n\n      if (length > 1 || this.__actions__.length ||\n          !(value instanceof LazyWrapper) || !isIndex(start)) {\n        return this.thru(interceptor);\n      }\n      value = value.slice(start, +start + (length ? 1 : 0));\n      value.__actions__.push({\n        'func': thru,\n        'args': [interceptor],\n        'thisArg': undefined\n      });\n      return new LodashWrapper(value, this.__chain__).thru(function(array) {\n        if (length && !array.length) {\n          array.push(undefined);\n        }\n        return array;\n      });\n    });\n\n    /**\n     * Creates a `lodash` wrapper instance with explicit method chain sequences enabled.\n     *\n     * @name chain\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36 },\n     *   { 'user': 'fred',   'age': 40 }\n     * ];\n     *\n     * // A sequence without explicit chaining.\n     * _(users).head();\n     * // => { 'user': 'barney', 'age': 36 }\n     *\n     * // A sequence with explicit chaining.\n     * _(users)\n     *   .chain()\n     *   .head()\n     *   .pick('user')\n     *   .value();\n     * // => { 'user': 'barney' }\n     */\n    function wrapperChain() {\n      return chain(this);\n    }\n\n    /**\n     * Executes the chain sequence and returns the wrapped result.\n     *\n     * @name commit\n     * @memberOf _\n     * @since 3.2.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var array = [1, 2];\n     * var wrapped = _(array).push(3);\n     *\n     * console.log(array);\n     * // => [1, 2]\n     *\n     * wrapped = wrapped.commit();\n     * console.log(array);\n     * // => [1, 2, 3]\n     *\n     * wrapped.last();\n     * // => 3\n     *\n     * console.log(array);\n     * // => [1, 2, 3]\n     */\n    function wrapperCommit() {\n      return new LodashWrapper(this.value(), this.__chain__);\n    }\n\n    /**\n     * Gets the next value on a wrapped object following the\n     * [iterator protocol](https://mdn.io/iteration_protocols#iterator).\n     *\n     * @name next\n     * @memberOf _\n     * @since 4.0.0\n     * @category Seq\n     * @returns {Object} Returns the next iterator value.\n     * @example\n     *\n     * var wrapped = _([1, 2]);\n     *\n     * wrapped.next();\n     * // => { 'done': false, 'value': 1 }\n     *\n     * wrapped.next();\n     * // => { 'done': false, 'value': 2 }\n     *\n     * wrapped.next();\n     * // => { 'done': true, 'value': undefined }\n     */\n    function wrapperNext() {\n      if (this.__values__ === undefined) {\n        this.__values__ = toArray(this.value());\n      }\n      var done = this.__index__ >= this.__values__.length,\n          value = done ? undefined : this.__values__[this.__index__++];\n\n      return { 'done': done, 'value': value };\n    }\n\n    /**\n     * Enables the wrapper to be iterable.\n     *\n     * @name Symbol.iterator\n     * @memberOf _\n     * @since 4.0.0\n     * @category Seq\n     * @returns {Object} Returns the wrapper object.\n     * @example\n     *\n     * var wrapped = _([1, 2]);\n     *\n     * wrapped[Symbol.iterator]() === wrapped;\n     * // => true\n     *\n     * Array.from(wrapped);\n     * // => [1, 2]\n     */\n    function wrapperToIterator() {\n      return this;\n    }\n\n    /**\n     * Creates a clone of the chain sequence planting `value` as the wrapped value.\n     *\n     * @name plant\n     * @memberOf _\n     * @since 3.2.0\n     * @category Seq\n     * @param {*} value The value to plant.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var wrapped = _([1, 2]).map(square);\n     * var other = wrapped.plant([3, 4]);\n     *\n     * other.value();\n     * // => [9, 16]\n     *\n     * wrapped.value();\n     * // => [1, 4]\n     */\n    function wrapperPlant(value) {\n      var result,\n          parent = this;\n\n      while (parent instanceof baseLodash) {\n        var clone = wrapperClone(parent);\n        clone.__index__ = 0;\n        clone.__values__ = undefined;\n        if (result) {\n          previous.__wrapped__ = clone;\n        } else {\n          result = clone;\n        }\n        var previous = clone;\n        parent = parent.__wrapped__;\n      }\n      previous.__wrapped__ = value;\n      return result;\n    }\n\n    /**\n     * This method is the wrapper version of `_.reverse`.\n     *\n     * **Note:** This method mutates the wrapped array.\n     *\n     * @name reverse\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _(array).reverse().value()\n     * // => [3, 2, 1]\n     *\n     * console.log(array);\n     * // => [3, 2, 1]\n     */\n    function wrapperReverse() {\n      var value = this.__wrapped__;\n      if (value instanceof LazyWrapper) {\n        var wrapped = value;\n        if (this.__actions__.length) {\n          wrapped = new LazyWrapper(this);\n        }\n        wrapped = wrapped.reverse();\n        wrapped.__actions__.push({\n          'func': thru,\n          'args': [reverse],\n          'thisArg': undefined\n        });\n        return new LodashWrapper(wrapped, this.__chain__);\n      }\n      return this.thru(reverse);\n    }\n\n    /**\n     * Executes the chain sequence to resolve the unwrapped value.\n     *\n     * @name value\n     * @memberOf _\n     * @since 0.1.0\n     * @alias toJSON, valueOf\n     * @category Seq\n     * @returns {*} Returns the resolved unwrapped value.\n     * @example\n     *\n     * _([1, 2, 3]).value();\n     * // => [1, 2, 3]\n     */\n    function wrapperValue() {\n      return baseWrapperValue(this.__wrapped__, this.__actions__);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The corresponding value of\n     * each key is the number of times the key was returned by `iteratee`. The\n     * iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.countBy([6.1, 4.2, 6.3], Math.floor);\n     * // => { '4': 1, '6': 2 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.countBy(['one', 'two', 'three'], 'length');\n     * // => { '3': 2, '5': 1 }\n     */\n    var countBy = createAggregator(function(result, value, key) {\n      if (hasOwnProperty.call(result, key)) {\n        ++result[key];\n      } else {\n        baseAssignValue(result, key, 1);\n      }\n    });\n\n    /**\n     * Checks if `predicate` returns truthy for **all** elements of `collection`.\n     * Iteration is stopped once `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index|key, collection).\n     *\n     * **Note:** This method returns `true` for\n     * [empty collections](https://en.wikipedia.org/wiki/Empty_set) because\n     * [everything is true](https://en.wikipedia.org/wiki/Vacuous_truth) of\n     * elements of empty collections.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {boolean} Returns `true` if all elements pass the predicate check,\n     *  else `false`.\n     * @example\n     *\n     * _.every([true, 1, null, 'yes'], Boolean);\n     * // => false\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': false },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.every(users, { 'user': 'barney', 'active': false });\n     * // => false\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.every(users, ['active', false]);\n     * // => true\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.every(users, 'active');\n     * // => false\n     */\n    function every(collection, predicate, guard) {\n      var func = isArray(collection) ? arrayEvery : baseEvery;\n      if (guard && isIterateeCall(collection, predicate, guard)) {\n        predicate = undefined;\n      }\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Iterates over elements of `collection`, returning an array of all elements\n     * `predicate` returns truthy for. The predicate is invoked with three\n     * arguments: (value, index|key, collection).\n     *\n     * **Note:** Unlike `_.remove`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     * @see _.reject\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': true },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * _.filter(users, function(o) { return !o.active; });\n     * // => objects for ['fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.filter(users, { 'age': 36, 'active': true });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.filter(users, ['active', false]);\n     * // => objects for ['fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.filter(users, 'active');\n     * // => objects for ['barney']\n     *\n     * // Combining several predicates using `_.overEvery` or `_.overSome`.\n     * _.filter(users, _.overSome([{ 'age': 36 }, ['age', 40]]));\n     * // => objects for ['fred', 'barney']\n     */\n    function filter(collection, predicate) {\n      var func = isArray(collection) ? arrayFilter : baseFilter;\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Iterates over elements of `collection`, returning the first element\n     * `predicate` returns truthy for. The predicate is invoked with three\n     * arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {*} Returns the matched element, else `undefined`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36, 'active': true },\n     *   { 'user': 'fred',    'age': 40, 'active': false },\n     *   { 'user': 'pebbles', 'age': 1,  'active': true }\n     * ];\n     *\n     * _.find(users, function(o) { return o.age < 40; });\n     * // => object for 'barney'\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.find(users, { 'age': 1, 'active': true });\n     * // => object for 'pebbles'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.find(users, ['active', false]);\n     * // => object for 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.find(users, 'active');\n     * // => object for 'barney'\n     */\n    var find = createFind(findIndex);\n\n    /**\n     * This method is like `_.find` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=collection.length-1] The index to search from.\n     * @returns {*} Returns the matched element, else `undefined`.\n     * @example\n     *\n     * _.findLast([1, 2, 3, 4], function(n) {\n     *   return n % 2 == 1;\n     * });\n     * // => 3\n     */\n    var findLast = createFind(findLastIndex);\n\n    /**\n     * Creates a flattened array of values by running each element in `collection`\n     * thru `iteratee` and flattening the mapped results. The iteratee is invoked\n     * with three arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [n, n];\n     * }\n     *\n     * _.flatMap([1, 2], duplicate);\n     * // => [1, 1, 2, 2]\n     */\n    function flatMap(collection, iteratee) {\n      return baseFlatten(map(collection, iteratee), 1);\n    }\n\n    /**\n     * This method is like `_.flatMap` except that it recursively flattens the\n     * mapped results.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [[[n, n]]];\n     * }\n     *\n     * _.flatMapDeep([1, 2], duplicate);\n     * // => [1, 1, 2, 2]\n     */\n    function flatMapDeep(collection, iteratee) {\n      return baseFlatten(map(collection, iteratee), INFINITY);\n    }\n\n    /**\n     * This method is like `_.flatMap` except that it recursively flattens the\n     * mapped results up to `depth` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {number} [depth=1] The maximum recursion depth.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [[[n, n]]];\n     * }\n     *\n     * _.flatMapDepth([1, 2], duplicate, 2);\n     * // => [[1, 1], [2, 2]]\n     */\n    function flatMapDepth(collection, iteratee, depth) {\n      depth = depth === undefined ? 1 : toInteger(depth);\n      return baseFlatten(map(collection, iteratee), depth);\n    }\n\n    /**\n     * Iterates over elements of `collection` and invokes `iteratee` for each element.\n     * The iteratee is invoked with three arguments: (value, index|key, collection).\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n     * property are iterated like arrays. To avoid this behavior use `_.forIn`\n     * or `_.forOwn` for object iteration.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @alias each\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     * @see _.forEachRight\n     * @example\n     *\n     * _.forEach([1, 2], function(value) {\n     *   console.log(value);\n     * });\n     * // => Logs `1` then `2`.\n     *\n     * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n     */\n    function forEach(collection, iteratee) {\n      var func = isArray(collection) ? arrayEach : baseEach;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.forEach` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @alias eachRight\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     * @see _.forEach\n     * @example\n     *\n     * _.forEachRight([1, 2], function(value) {\n     *   console.log(value);\n     * });\n     * // => Logs `2` then `1`.\n     */\n    function forEachRight(collection, iteratee) {\n      var func = isArray(collection) ? arrayEachRight : baseEachRight;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The order of grouped values\n     * is determined by the order they occur in `collection`. The corresponding\n     * value of each key is an array of elements responsible for generating the\n     * key. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.groupBy([6.1, 4.2, 6.3], Math.floor);\n     * // => { '4': [4.2], '6': [6.1, 6.3] }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.groupBy(['one', 'two', 'three'], 'length');\n     * // => { '3': ['one', 'two'], '5': ['three'] }\n     */\n    var groupBy = createAggregator(function(result, value, key) {\n      if (hasOwnProperty.call(result, key)) {\n        result[key].push(value);\n      } else {\n        baseAssignValue(result, key, [value]);\n      }\n    });\n\n    /**\n     * Checks if `value` is in `collection`. If `collection` is a string, it's\n     * checked for a substring of `value`, otherwise\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * is used for equality comparisons. If `fromIndex` is negative, it's used as\n     * the offset from the end of `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n     * @returns {boolean} Returns `true` if `value` is found, else `false`.\n     * @example\n     *\n     * _.includes([1, 2, 3], 1);\n     * // => true\n     *\n     * _.includes([1, 2, 3], 1, 2);\n     * // => false\n     *\n     * _.includes({ 'a': 1, 'b': 2 }, 1);\n     * // => true\n     *\n     * _.includes('abcd', 'bc');\n     * // => true\n     */\n    function includes(collection, value, fromIndex, guard) {\n      collection = isArrayLike(collection) ? collection : values(collection);\n      fromIndex = (fromIndex && !guard) ? toInteger(fromIndex) : 0;\n\n      var length = collection.length;\n      if (fromIndex < 0) {\n        fromIndex = nativeMax(length + fromIndex, 0);\n      }\n      return isString(collection)\n        ? (fromIndex <= length && collection.indexOf(value, fromIndex) > -1)\n        : (!!length && baseIndexOf(collection, value, fromIndex) > -1);\n    }\n\n    /**\n     * Invokes the method at `path` of each element in `collection`, returning\n     * an array of the results of each invoked method. Any additional arguments\n     * are provided to each invoked method. If `path` is a function, it's invoked\n     * for, and `this` bound to, each element in `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Array|Function|string} path The path of the method to invoke or\n     *  the function invoked per iteration.\n     * @param {...*} [args] The arguments to invoke each method with.\n     * @returns {Array} Returns the array of results.\n     * @example\n     *\n     * _.invokeMap([[5, 1, 7], [3, 2, 1]], 'sort');\n     * // => [[1, 5, 7], [1, 2, 3]]\n     *\n     * _.invokeMap([123, 456], String.prototype.split, '');\n     * // => [['1', '2', '3'], ['4', '5', '6']]\n     */\n    var invokeMap = baseRest(function(collection, path, args) {\n      var index = -1,\n          isFunc = typeof path == 'function',\n          result = isArrayLike(collection) ? Array(collection.length) : [];\n\n      baseEach(collection, function(value) {\n        result[++index] = isFunc ? apply(path, value, args) : baseInvoke(value, path, args);\n      });\n      return result;\n    });\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The corresponding value of\n     * each key is the last element responsible for generating the key. The\n     * iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * var array = [\n     *   { 'dir': 'left', 'code': 97 },\n     *   { 'dir': 'right', 'code': 100 }\n     * ];\n     *\n     * _.keyBy(array, function(o) {\n     *   return String.fromCharCode(o.code);\n     * });\n     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n     *\n     * _.keyBy(array, 'dir');\n     * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }\n     */\n    var keyBy = createAggregator(function(result, value, key) {\n      baseAssignValue(result, key, value);\n    });\n\n    /**\n     * Creates an array of values by running each element in `collection` thru\n     * `iteratee`. The iteratee is invoked with three arguments:\n     * (value, index|key, collection).\n     *\n     * Many lodash methods are guarded to work as iteratees for methods like\n     * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n     *\n     * The guarded methods are:\n     * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n     * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n     * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n     * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new mapped array.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * _.map([4, 8], square);\n     * // => [16, 64]\n     *\n     * _.map({ 'a': 4, 'b': 8 }, square);\n     * // => [16, 64] (iteration order is not guaranteed)\n     *\n     * var users = [\n     *   { 'user': 'barney' },\n     *   { 'user': 'fred' }\n     * ];\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.map(users, 'user');\n     * // => ['barney', 'fred']\n     */\n    function map(collection, iteratee) {\n      var func = isArray(collection) ? arrayMap : baseMap;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.sortBy` except that it allows specifying the sort\n     * orders of the iteratees to sort by. If `orders` is unspecified, all values\n     * are sorted in ascending order. Otherwise, specify an order of \"desc\" for\n     * descending or \"asc\" for ascending sort order of corresponding values.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Array[]|Function[]|Object[]|string[]} [iteratees=[_.identity]]\n     *  The iteratees to sort by.\n     * @param {string[]} [orders] The sort orders of `iteratees`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n     * @returns {Array} Returns the new sorted array.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'fred',   'age': 48 },\n     *   { 'user': 'barney', 'age': 34 },\n     *   { 'user': 'fred',   'age': 40 },\n     *   { 'user': 'barney', 'age': 36 }\n     * ];\n     *\n     * // Sort by `user` in ascending order and by `age` in descending order.\n     * _.orderBy(users, ['user', 'age'], ['asc', 'desc']);\n     * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]\n     */\n    function orderBy(collection, iteratees, orders, guard) {\n      if (collection == null) {\n        return [];\n      }\n      if (!isArray(iteratees)) {\n        iteratees = iteratees == null ? [] : [iteratees];\n      }\n      orders = guard ? undefined : orders;\n      if (!isArray(orders)) {\n        orders = orders == null ? [] : [orders];\n      }\n      return baseOrderBy(collection, iteratees, orders);\n    }\n\n    /**\n     * Creates an array of elements split into two groups, the first of which\n     * contains elements `predicate` returns truthy for, the second of which\n     * contains elements `predicate` returns falsey for. The predicate is\n     * invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the array of grouped elements.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36, 'active': false },\n     *   { 'user': 'fred',    'age': 40, 'active': true },\n     *   { 'user': 'pebbles', 'age': 1,  'active': false }\n     * ];\n     *\n     * _.partition(users, function(o) { return o.active; });\n     * // => objects for [['fred'], ['barney', 'pebbles']]\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.partition(users, { 'age': 1, 'active': false });\n     * // => objects for [['pebbles'], ['barney', 'fred']]\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.partition(users, ['active', false]);\n     * // => objects for [['barney', 'pebbles'], ['fred']]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.partition(users, 'active');\n     * // => objects for [['fred'], ['barney', 'pebbles']]\n     */\n    var partition = createAggregator(function(result, value, key) {\n      result[key ? 0 : 1].push(value);\n    }, function() { return [[], []]; });\n\n    /**\n     * Reduces `collection` to a value which is the accumulated result of running\n     * each element in `collection` thru `iteratee`, where each successive\n     * invocation is supplied the return value of the previous. If `accumulator`\n     * is not given, the first element of `collection` is used as the initial\n     * value. The iteratee is invoked with four arguments:\n     * (accumulator, value, index|key, collection).\n     *\n     * Many lodash methods are guarded to work as iteratees for methods like\n     * `_.reduce`, `_.reduceRight`, and `_.transform`.\n     *\n     * The guarded methods are:\n     * `assign`, `defaults`, `defaultsDeep`, `includes`, `merge`, `orderBy`,\n     * and `sortBy`\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The initial value.\n     * @returns {*} Returns the accumulated value.\n     * @see _.reduceRight\n     * @example\n     *\n     * _.reduce([1, 2], function(sum, n) {\n     *   return sum + n;\n     * }, 0);\n     * // => 3\n     *\n     * _.reduce({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n     *   (result[value] || (result[value] = [])).push(key);\n     *   return result;\n     * }, {});\n     * // => { '1': ['a', 'c'], '2': ['b'] } (iteration order is not guaranteed)\n     */\n    function reduce(collection, iteratee, accumulator) {\n      var func = isArray(collection) ? arrayReduce : baseReduce,\n          initAccum = arguments.length < 3;\n\n      return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEach);\n    }\n\n    /**\n     * This method is like `_.reduce` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The initial value.\n     * @returns {*} Returns the accumulated value.\n     * @see _.reduce\n     * @example\n     *\n     * var array = [[0, 1], [2, 3], [4, 5]];\n     *\n     * _.reduceRight(array, function(flattened, other) {\n     *   return flattened.concat(other);\n     * }, []);\n     * // => [4, 5, 2, 3, 0, 1]\n     */\n    function reduceRight(collection, iteratee, accumulator) {\n      var func = isArray(collection) ? arrayReduceRight : baseReduce,\n          initAccum = arguments.length < 3;\n\n      return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEachRight);\n    }\n\n    /**\n     * The opposite of `_.filter`; this method returns the elements of `collection`\n     * that `predicate` does **not** return truthy for.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     * @see _.filter\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': false },\n     *   { 'user': 'fred',   'age': 40, 'active': true }\n     * ];\n     *\n     * _.reject(users, function(o) { return !o.active; });\n     * // => objects for ['fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.reject(users, { 'age': 40, 'active': true });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.reject(users, ['active', false]);\n     * // => objects for ['fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.reject(users, 'active');\n     * // => objects for ['barney']\n     */\n    function reject(collection, predicate) {\n      var func = isArray(collection) ? arrayFilter : baseFilter;\n      return func(collection, negate(getIteratee(predicate, 3)));\n    }\n\n    /**\n     * Gets a random element from `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to sample.\n     * @returns {*} Returns the random element.\n     * @example\n     *\n     * _.sample([1, 2, 3, 4]);\n     * // => 2\n     */\n    function sample(collection) {\n      var func = isArray(collection) ? arraySample : baseSample;\n      return func(collection);\n    }\n\n    /**\n     * Gets `n` random elements at unique keys from `collection` up to the\n     * size of `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to sample.\n     * @param {number} [n=1] The number of elements to sample.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the random elements.\n     * @example\n     *\n     * _.sampleSize([1, 2, 3], 2);\n     * // => [3, 1]\n     *\n     * _.sampleSize([1, 2, 3], 4);\n     * // => [2, 3, 1]\n     */\n    function sampleSize(collection, n, guard) {\n      if ((guard ? isIterateeCall(collection, n, guard) : n === undefined)) {\n        n = 1;\n      } else {\n        n = toInteger(n);\n      }\n      var func = isArray(collection) ? arraySampleSize : baseSampleSize;\n      return func(collection, n);\n    }\n\n    /**\n     * Creates an array of shuffled values, using a version of the\n     * [Fisher-Yates shuffle](https://en.wikipedia.org/wiki/Fisher-Yates_shuffle).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     * @example\n     *\n     * _.shuffle([1, 2, 3, 4]);\n     * // => [4, 1, 3, 2]\n     */\n    function shuffle(collection) {\n      var func = isArray(collection) ? arrayShuffle : baseShuffle;\n      return func(collection);\n    }\n\n    /**\n     * Gets the size of `collection` by returning its length for array-like\n     * values or the number of own enumerable string keyed properties for objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @returns {number} Returns the collection size.\n     * @example\n     *\n     * _.size([1, 2, 3]);\n     * // => 3\n     *\n     * _.size({ 'a': 1, 'b': 2 });\n     * // => 2\n     *\n     * _.size('pebbles');\n     * // => 7\n     */\n    function size(collection) {\n      if (collection == null) {\n        return 0;\n      }\n      if (isArrayLike(collection)) {\n        return isString(collection) ? stringSize(collection) : collection.length;\n      }\n      var tag = getTag(collection);\n      if (tag == mapTag || tag == setTag) {\n        return collection.size;\n      }\n      return baseKeys(collection).length;\n    }\n\n    /**\n     * Checks if `predicate` returns truthy for **any** element of `collection`.\n     * Iteration is stopped once `predicate` returns truthy. The predicate is\n     * invoked with three arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {boolean} Returns `true` if any element passes the predicate check,\n     *  else `false`.\n     * @example\n     *\n     * _.some([null, 0, 'yes', false], Boolean);\n     * // => true\n     *\n     * var users = [\n     *   { 'user': 'barney', 'active': true },\n     *   { 'user': 'fred',   'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.some(users, { 'user': 'barney', 'active': false });\n     * // => false\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.some(users, ['active', false]);\n     * // => true\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.some(users, 'active');\n     * // => true\n     */\n    function some(collection, predicate, guard) {\n      var func = isArray(collection) ? arraySome : baseSome;\n      if (guard && isIterateeCall(collection, predicate, guard)) {\n        predicate = undefined;\n      }\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Creates an array of elements, sorted in ascending order by the results of\n     * running each element in a collection thru each iteratee. This method\n     * performs a stable sort, that is, it preserves the original sort order of\n     * equal elements. The iteratees are invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {...(Function|Function[])} [iteratees=[_.identity]]\n     *  The iteratees to sort by.\n     * @returns {Array} Returns the new sorted array.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'fred',   'age': 48 },\n     *   { 'user': 'barney', 'age': 36 },\n     *   { 'user': 'fred',   'age': 30 },\n     *   { 'user': 'barney', 'age': 34 }\n     * ];\n     *\n     * _.sortBy(users, [function(o) { return o.user; }]);\n     * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 30]]\n     *\n     * _.sortBy(users, ['user', 'age']);\n     * // => objects for [['barney', 34], ['barney', 36], ['fred', 30], ['fred', 48]]\n     */\n    var sortBy = baseRest(function(collection, iteratees) {\n      if (collection == null) {\n        return [];\n      }\n      var length = iteratees.length;\n      if (length > 1 && isIterateeCall(collection, iteratees[0], iteratees[1])) {\n        iteratees = [];\n      } else if (length > 2 && isIterateeCall(iteratees[0], iteratees[1], iteratees[2])) {\n        iteratees = [iteratees[0]];\n      }\n      return baseOrderBy(collection, baseFlatten(iteratees, 1), []);\n    });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Gets the timestamp of the number of milliseconds that have elapsed since\n     * the Unix epoch (1 January 1970 00:00:00 UTC).\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Date\n     * @returns {number} Returns the timestamp.\n     * @example\n     *\n     * _.defer(function(stamp) {\n     *   console.log(_.now() - stamp);\n     * }, _.now());\n     * // => Logs the number of milliseconds it took for the deferred invocation.\n     */\n    var now = ctxNow || function() {\n      return root.Date.now();\n    };\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The opposite of `_.before`; this method creates a function that invokes\n     * `func` once it's called `n` or more times.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {number} n The number of calls before `func` is invoked.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var saves = ['profile', 'settings'];\n     *\n     * var done = _.after(saves.length, function() {\n     *   console.log('done saving!');\n     * });\n     *\n     * _.forEach(saves, function(type) {\n     *   asyncSave({ 'type': type, 'complete': done });\n     * });\n     * // => Logs 'done saving!' after the two async saves have completed.\n     */\n    function after(n, func) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      n = toInteger(n);\n      return function() {\n        if (--n < 1) {\n          return func.apply(this, arguments);\n        }\n      };\n    }\n\n    /**\n     * Creates a function that invokes `func`, with up to `n` arguments,\n     * ignoring any additional arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to cap arguments for.\n     * @param {number} [n=func.length] The arity cap.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new capped function.\n     * @example\n     *\n     * _.map(['6', '8', '10'], _.ary(parseInt, 1));\n     * // => [6, 8, 10]\n     */\n    function ary(func, n, guard) {\n      n = guard ? undefined : n;\n      n = (func && n == null) ? func.length : n;\n      return createWrap(func, WRAP_ARY_FLAG, undefined, undefined, undefined, undefined, n);\n    }\n\n    /**\n     * Creates a function that invokes `func`, with the `this` binding and arguments\n     * of the created function, while it's called less than `n` times. Subsequent\n     * calls to the created function return the result of the last `func` invocation.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {number} n The number of calls at which `func` is no longer invoked.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * jQuery(element).on('click', _.before(5, addContactToList));\n     * // => Allows adding up to 4 contacts to the list.\n     */\n    function before(n, func) {\n      var result;\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      n = toInteger(n);\n      return function() {\n        if (--n > 0) {\n          result = func.apply(this, arguments);\n        }\n        if (n <= 1) {\n          func = undefined;\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of `thisArg`\n     * and `partials` prepended to the arguments it receives.\n     *\n     * The `_.bind.placeholder` value, which defaults to `_` in monolithic builds,\n     * may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** Unlike native `Function#bind`, this method doesn't set the \"length\"\n     * property of bound functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to bind.\n     * @param {*} thisArg The `this` binding of `func`.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * function greet(greeting, punctuation) {\n     *   return greeting + ' ' + this.user + punctuation;\n     * }\n     *\n     * var object = { 'user': 'fred' };\n     *\n     * var bound = _.bind(greet, object, 'hi');\n     * bound('!');\n     * // => 'hi fred!'\n     *\n     * // Bound with placeholders.\n     * var bound = _.bind(greet, object, _, '!');\n     * bound('hi');\n     * // => 'hi fred!'\n     */\n    var bind = baseRest(function(func, thisArg, partials) {\n      var bitmask = WRAP_BIND_FLAG;\n      if (partials.length) {\n        var holders = replaceHolders(partials, getHolder(bind));\n        bitmask |= WRAP_PARTIAL_FLAG;\n      }\n      return createWrap(func, bitmask, thisArg, partials, holders);\n    });\n\n    /**\n     * Creates a function that invokes the method at `object[key]` with `partials`\n     * prepended to the arguments it receives.\n     *\n     * This method differs from `_.bind` by allowing bound functions to reference\n     * methods that may be redefined or don't yet exist. See\n     * [Peter Michaux's article](http://peter.michaux.ca/articles/lazy-function-definition-pattern)\n     * for more details.\n     *\n     * The `_.bindKey.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.10.0\n     * @category Function\n     * @param {Object} object The object to invoke the method on.\n     * @param {string} key The key of the method.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * var object = {\n     *   'user': 'fred',\n     *   'greet': function(greeting, punctuation) {\n     *     return greeting + ' ' + this.user + punctuation;\n     *   }\n     * };\n     *\n     * var bound = _.bindKey(object, 'greet', 'hi');\n     * bound('!');\n     * // => 'hi fred!'\n     *\n     * object.greet = function(greeting, punctuation) {\n     *   return greeting + 'ya ' + this.user + punctuation;\n     * };\n     *\n     * bound('!');\n     * // => 'hiya fred!'\n     *\n     * // Bound with placeholders.\n     * var bound = _.bindKey(object, 'greet', _, '!');\n     * bound('hi');\n     * // => 'hiya fred!'\n     */\n    var bindKey = baseRest(function(object, key, partials) {\n      var bitmask = WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG;\n      if (partials.length) {\n        var holders = replaceHolders(partials, getHolder(bindKey));\n        bitmask |= WRAP_PARTIAL_FLAG;\n      }\n      return createWrap(key, bitmask, object, partials, holders);\n    });\n\n    /**\n     * Creates a function that accepts arguments of `func` and either invokes\n     * `func` returning its result, if at least `arity` number of arguments have\n     * been provided, or returns a function that accepts the remaining `func`\n     * arguments, and so on. The arity of `func` may be specified if `func.length`\n     * is not sufficient.\n     *\n     * The `_.curry.placeholder` value, which defaults to `_` in monolithic builds,\n     * may be used as a placeholder for provided arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of curried functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Function\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var abc = function(a, b, c) {\n     *   return [a, b, c];\n     * };\n     *\n     * var curried = _.curry(abc);\n     *\n     * curried(1)(2)(3);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2)(3);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2, 3);\n     * // => [1, 2, 3]\n     *\n     * // Curried with placeholders.\n     * curried(1)(_, 3)(2);\n     * // => [1, 2, 3]\n     */\n    function curry(func, arity, guard) {\n      arity = guard ? undefined : arity;\n      var result = createWrap(func, WRAP_CURRY_FLAG, undefined, undefined, undefined, undefined, undefined, arity);\n      result.placeholder = curry.placeholder;\n      return result;\n    }\n\n    /**\n     * This method is like `_.curry` except that arguments are applied to `func`\n     * in the manner of `_.partialRight` instead of `_.partial`.\n     *\n     * The `_.curryRight.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for provided arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of curried functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var abc = function(a, b, c) {\n     *   return [a, b, c];\n     * };\n     *\n     * var curried = _.curryRight(abc);\n     *\n     * curried(3)(2)(1);\n     * // => [1, 2, 3]\n     *\n     * curried(2, 3)(1);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2, 3);\n     * // => [1, 2, 3]\n     *\n     * // Curried with placeholders.\n     * curried(3)(1, _)(2);\n     * // => [1, 2, 3]\n     */\n    function curryRight(func, arity, guard) {\n      arity = guard ? undefined : arity;\n      var result = createWrap(func, WRAP_CURRY_RIGHT_FLAG, undefined, undefined, undefined, undefined, undefined, arity);\n      result.placeholder = curryRight.placeholder;\n      return result;\n    }\n\n    /**\n     * Creates a debounced function that delays invoking `func` until after `wait`\n     * milliseconds have elapsed since the last time the debounced function was\n     * invoked. The debounced function comes with a `cancel` method to cancel\n     * delayed `func` invocations and a `flush` method to immediately invoke them.\n     * Provide `options` to indicate whether `func` should be invoked on the\n     * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n     * with the last arguments provided to the debounced function. Subsequent\n     * calls to the debounced function return the result of the last `func`\n     * invocation.\n     *\n     * **Note:** If `leading` and `trailing` options are `true`, `func` is\n     * invoked on the trailing edge of the timeout only if the debounced function\n     * is invoked more than once during the `wait` timeout.\n     *\n     * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n     * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n     *\n     * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n     * for details over the differences between `_.debounce` and `_.throttle`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to debounce.\n     * @param {number} [wait=0] The number of milliseconds to delay.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.leading=false]\n     *  Specify invoking on the leading edge of the timeout.\n     * @param {number} [options.maxWait]\n     *  The maximum time `func` is allowed to be delayed before it's invoked.\n     * @param {boolean} [options.trailing=true]\n     *  Specify invoking on the trailing edge of the timeout.\n     * @returns {Function} Returns the new debounced function.\n     * @example\n     *\n     * // Avoid costly calculations while the window size is in flux.\n     * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n     *\n     * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n     * jQuery(element).on('click', _.debounce(sendMail, 300, {\n     *   'leading': true,\n     *   'trailing': false\n     * }));\n     *\n     * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n     * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n     * var source = new EventSource('/stream');\n     * jQuery(source).on('message', debounced);\n     *\n     * // Cancel the trailing debounced invocation.\n     * jQuery(window).on('popstate', debounced.cancel);\n     */\n    function debounce(func, wait, options) {\n      var lastArgs,\n          lastThis,\n          maxWait,\n          result,\n          timerId,\n          lastCallTime,\n          lastInvokeTime = 0,\n          leading = false,\n          maxing = false,\n          trailing = true;\n\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      wait = toNumber(wait) || 0;\n      if (isObject(options)) {\n        leading = !!options.leading;\n        maxing = 'maxWait' in options;\n        maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n        trailing = 'trailing' in options ? !!options.trailing : trailing;\n      }\n\n      function invokeFunc(time) {\n        var args = lastArgs,\n            thisArg = lastThis;\n\n        lastArgs = lastThis = undefined;\n        lastInvokeTime = time;\n        result = func.apply(thisArg, args);\n        return result;\n      }\n\n      function leadingEdge(time) {\n        // Reset any `maxWait` timer.\n        lastInvokeTime = time;\n        // Start the timer for the trailing edge.\n        timerId = setTimeout(timerExpired, wait);\n        // Invoke the leading edge.\n        return leading ? invokeFunc(time) : result;\n      }\n\n      function remainingWait(time) {\n        var timeSinceLastCall = time - lastCallTime,\n            timeSinceLastInvoke = time - lastInvokeTime,\n            timeWaiting = wait - timeSinceLastCall;\n\n        return maxing\n          ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n          : timeWaiting;\n      }\n\n      function shouldInvoke(time) {\n        var timeSinceLastCall = time - lastCallTime,\n            timeSinceLastInvoke = time - lastInvokeTime;\n\n        // Either this is the first call, activity has stopped and we're at the\n        // trailing edge, the system time has gone backwards and we're treating\n        // it as the trailing edge, or we've hit the `maxWait` limit.\n        return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n          (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n      }\n\n      function timerExpired() {\n        var time = now();\n        if (shouldInvoke(time)) {\n          return trailingEdge(time);\n        }\n        // Restart the timer.\n        timerId = setTimeout(timerExpired, remainingWait(time));\n      }\n\n      function trailingEdge(time) {\n        timerId = undefined;\n\n        // Only invoke if we have `lastArgs` which means `func` has been\n        // debounced at least once.\n        if (trailing && lastArgs) {\n          return invokeFunc(time);\n        }\n        lastArgs = lastThis = undefined;\n        return result;\n      }\n\n      function cancel() {\n        if (timerId !== undefined) {\n          clearTimeout(timerId);\n        }\n        lastInvokeTime = 0;\n        lastArgs = lastCallTime = lastThis = timerId = undefined;\n      }\n\n      function flush() {\n        return timerId === undefined ? result : trailingEdge(now());\n      }\n\n      function debounced() {\n        var time = now(),\n            isInvoking = shouldInvoke(time);\n\n        lastArgs = arguments;\n        lastThis = this;\n        lastCallTime = time;\n\n        if (isInvoking) {\n          if (timerId === undefined) {\n            return leadingEdge(lastCallTime);\n          }\n          if (maxing) {\n            // Handle invocations in a tight loop.\n            clearTimeout(timerId);\n            timerId = setTimeout(timerExpired, wait);\n            return invokeFunc(lastCallTime);\n          }\n        }\n        if (timerId === undefined) {\n          timerId = setTimeout(timerExpired, wait);\n        }\n        return result;\n      }\n      debounced.cancel = cancel;\n      debounced.flush = flush;\n      return debounced;\n    }\n\n    /**\n     * Defers invoking the `func` until the current call stack has cleared. Any\n     * additional arguments are provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to defer.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.defer(function(text) {\n     *   console.log(text);\n     * }, 'deferred');\n     * // => Logs 'deferred' after one millisecond.\n     */\n    var defer = baseRest(function(func, args) {\n      return baseDelay(func, 1, args);\n    });\n\n    /**\n     * Invokes `func` after `wait` milliseconds. Any additional arguments are\n     * provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.delay(function(text) {\n     *   console.log(text);\n     * }, 1000, 'later');\n     * // => Logs 'later' after one second.\n     */\n    var delay = baseRest(function(func, wait, args) {\n      return baseDelay(func, toNumber(wait) || 0, args);\n    });\n\n    /**\n     * Creates a function that invokes `func` with arguments reversed.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to flip arguments for.\n     * @returns {Function} Returns the new flipped function.\n     * @example\n     *\n     * var flipped = _.flip(function() {\n     *   return _.toArray(arguments);\n     * });\n     *\n     * flipped('a', 'b', 'c', 'd');\n     * // => ['d', 'c', 'b', 'a']\n     */\n    function flip(func) {\n      return createWrap(func, WRAP_FLIP_FLAG);\n    }\n\n    /**\n     * Creates a function that memoizes the result of `func`. If `resolver` is\n     * provided, it determines the cache key for storing the result based on the\n     * arguments provided to the memoized function. By default, the first argument\n     * provided to the memoized function is used as the map cache key. The `func`\n     * is invoked with the `this` binding of the memoized function.\n     *\n     * **Note:** The cache is exposed as the `cache` property on the memoized\n     * function. Its creation may be customized by replacing the `_.memoize.Cache`\n     * constructor with one whose instances implement the\n     * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n     * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to have its output memoized.\n     * @param {Function} [resolver] The function to resolve the cache key.\n     * @returns {Function} Returns the new memoized function.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     * var other = { 'c': 3, 'd': 4 };\n     *\n     * var values = _.memoize(_.values);\n     * values(object);\n     * // => [1, 2]\n     *\n     * values(other);\n     * // => [3, 4]\n     *\n     * object.a = 2;\n     * values(object);\n     * // => [1, 2]\n     *\n     * // Modify the result cache.\n     * values.cache.set(object, ['a', 'b']);\n     * values(object);\n     * // => ['a', 'b']\n     *\n     * // Replace `_.memoize.Cache`.\n     * _.memoize.Cache = WeakMap;\n     */\n    function memoize(func, resolver) {\n      if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      var memoized = function() {\n        var args = arguments,\n            key = resolver ? resolver.apply(this, args) : args[0],\n            cache = memoized.cache;\n\n        if (cache.has(key)) {\n          return cache.get(key);\n        }\n        var result = func.apply(this, args);\n        memoized.cache = cache.set(key, result) || cache;\n        return result;\n      };\n      memoized.cache = new (memoize.Cache || MapCache);\n      return memoized;\n    }\n\n    // Expose `MapCache`.\n    memoize.Cache = MapCache;\n\n    /**\n     * Creates a function that negates the result of the predicate `func`. The\n     * `func` predicate is invoked with the `this` binding and arguments of the\n     * created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} predicate The predicate to negate.\n     * @returns {Function} Returns the new negated function.\n     * @example\n     *\n     * function isEven(n) {\n     *   return n % 2 == 0;\n     * }\n     *\n     * _.filter([1, 2, 3, 4, 5, 6], _.negate(isEven));\n     * // => [1, 3, 5]\n     */\n    function negate(predicate) {\n      if (typeof predicate != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      return function() {\n        var args = arguments;\n        switch (args.length) {\n          case 0: return !predicate.call(this);\n          case 1: return !predicate.call(this, args[0]);\n          case 2: return !predicate.call(this, args[0], args[1]);\n          case 3: return !predicate.call(this, args[0], args[1], args[2]);\n        }\n        return !predicate.apply(this, args);\n      };\n    }\n\n    /**\n     * Creates a function that is restricted to invoking `func` once. Repeat calls\n     * to the function return the value of the first invocation. The `func` is\n     * invoked with the `this` binding and arguments of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var initialize = _.once(createApplication);\n     * initialize();\n     * initialize();\n     * // => `createApplication` is invoked once\n     */\n    function once(func) {\n      return before(2, func);\n    }\n\n    /**\n     * Creates a function that invokes `func` with its arguments transformed.\n     *\n     * @static\n     * @since 4.0.0\n     * @memberOf _\n     * @category Function\n     * @param {Function} func The function to wrap.\n     * @param {...(Function|Function[])} [transforms=[_.identity]]\n     *  The argument transforms.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * function doubled(n) {\n     *   return n * 2;\n     * }\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var func = _.overArgs(function(x, y) {\n     *   return [x, y];\n     * }, [square, doubled]);\n     *\n     * func(9, 3);\n     * // => [81, 6]\n     *\n     * func(10, 5);\n     * // => [100, 10]\n     */\n    var overArgs = castRest(function(func, transforms) {\n      transforms = (transforms.length == 1 && isArray(transforms[0]))\n        ? arrayMap(transforms[0], baseUnary(getIteratee()))\n        : arrayMap(baseFlatten(transforms, 1), baseUnary(getIteratee()));\n\n      var funcsLength = transforms.length;\n      return baseRest(function(args) {\n        var index = -1,\n            length = nativeMin(args.length, funcsLength);\n\n        while (++index < length) {\n          args[index] = transforms[index].call(this, args[index]);\n        }\n        return apply(func, this, args);\n      });\n    });\n\n    /**\n     * Creates a function that invokes `func` with `partials` prepended to the\n     * arguments it receives. This method is like `_.bind` except it does **not**\n     * alter the `this` binding.\n     *\n     * The `_.partial.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of partially\n     * applied functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.2.0\n     * @category Function\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * function greet(greeting, name) {\n     *   return greeting + ' ' + name;\n     * }\n     *\n     * var sayHelloTo = _.partial(greet, 'hello');\n     * sayHelloTo('fred');\n     * // => 'hello fred'\n     *\n     * // Partially applied with placeholders.\n     * var greetFred = _.partial(greet, _, 'fred');\n     * greetFred('hi');\n     * // => 'hi fred'\n     */\n    var partial = baseRest(function(func, partials) {\n      var holders = replaceHolders(partials, getHolder(partial));\n      return createWrap(func, WRAP_PARTIAL_FLAG, undefined, partials, holders);\n    });\n\n    /**\n     * This method is like `_.partial` except that partially applied arguments\n     * are appended to the arguments it receives.\n     *\n     * The `_.partialRight.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of partially\n     * applied functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Function\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * function greet(greeting, name) {\n     *   return greeting + ' ' + name;\n     * }\n     *\n     * var greetFred = _.partialRight(greet, 'fred');\n     * greetFred('hi');\n     * // => 'hi fred'\n     *\n     * // Partially applied with placeholders.\n     * var sayHelloTo = _.partialRight(greet, 'hello', _);\n     * sayHelloTo('fred');\n     * // => 'hello fred'\n     */\n    var partialRight = baseRest(function(func, partials) {\n      var holders = replaceHolders(partials, getHolder(partialRight));\n      return createWrap(func, WRAP_PARTIAL_RIGHT_FLAG, undefined, partials, holders);\n    });\n\n    /**\n     * Creates a function that invokes `func` with arguments arranged according\n     * to the specified `indexes` where the argument value at the first index is\n     * provided as the first argument, the argument value at the second index is\n     * provided as the second argument, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to rearrange arguments for.\n     * @param {...(number|number[])} indexes The arranged argument indexes.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var rearged = _.rearg(function(a, b, c) {\n     *   return [a, b, c];\n     * }, [2, 0, 1]);\n     *\n     * rearged('b', 'c', 'a')\n     * // => ['a', 'b', 'c']\n     */\n    var rearg = flatRest(function(func, indexes) {\n      return createWrap(func, WRAP_REARG_FLAG, undefined, undefined, undefined, indexes);\n    });\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of the\n     * created function and arguments from `start` and beyond provided as\n     * an array.\n     *\n     * **Note:** This method is based on the\n     * [rest parameter](https://mdn.io/rest_parameters).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var say = _.rest(function(what, names) {\n     *   return what + ' ' + _.initial(names).join(', ') +\n     *     (_.size(names) > 1 ? ', & ' : '') + _.last(names);\n     * });\n     *\n     * say('hello', 'fred', 'barney', 'pebbles');\n     * // => 'hello fred, barney, & pebbles'\n     */\n    function rest(func, start) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      start = start === undefined ? start : toInteger(start);\n      return baseRest(func, start);\n    }\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of the\n     * create function and an array of arguments much like\n     * [`Function#apply`](http://www.ecma-international.org/ecma-262/7.0/#sec-function.prototype.apply).\n     *\n     * **Note:** This method is based on the\n     * [spread operator](https://mdn.io/spread_operator).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Function\n     * @param {Function} func The function to spread arguments over.\n     * @param {number} [start=0] The start position of the spread.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var say = _.spread(function(who, what) {\n     *   return who + ' says ' + what;\n     * });\n     *\n     * say(['fred', 'hello']);\n     * // => 'fred says hello'\n     *\n     * var numbers = Promise.all([\n     *   Promise.resolve(40),\n     *   Promise.resolve(36)\n     * ]);\n     *\n     * numbers.then(_.spread(function(x, y) {\n     *   return x + y;\n     * }));\n     * // => a Promise of 76\n     */\n    function spread(func, start) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      start = start == null ? 0 : nativeMax(toInteger(start), 0);\n      return baseRest(function(args) {\n        var array = args[start],\n            otherArgs = castSlice(args, 0, start);\n\n        if (array) {\n          arrayPush(otherArgs, array);\n        }\n        return apply(func, this, otherArgs);\n      });\n    }\n\n    /**\n     * Creates a throttled function that only invokes `func` at most once per\n     * every `wait` milliseconds. The throttled function comes with a `cancel`\n     * method to cancel delayed `func` invocations and a `flush` method to\n     * immediately invoke them. Provide `options` to indicate whether `func`\n     * should be invoked on the leading and/or trailing edge of the `wait`\n     * timeout. The `func` is invoked with the last arguments provided to the\n     * throttled function. Subsequent calls to the throttled function return the\n     * result of the last `func` invocation.\n     *\n     * **Note:** If `leading` and `trailing` options are `true`, `func` is\n     * invoked on the trailing edge of the timeout only if the throttled function\n     * is invoked more than once during the `wait` timeout.\n     *\n     * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n     * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n     *\n     * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n     * for details over the differences between `_.throttle` and `_.debounce`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to throttle.\n     * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.leading=true]\n     *  Specify invoking on the leading edge of the timeout.\n     * @param {boolean} [options.trailing=true]\n     *  Specify invoking on the trailing edge of the timeout.\n     * @returns {Function} Returns the new throttled function.\n     * @example\n     *\n     * // Avoid excessively updating the position while scrolling.\n     * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n     *\n     * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n     * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n     * jQuery(element).on('click', throttled);\n     *\n     * // Cancel the trailing throttled invocation.\n     * jQuery(window).on('popstate', throttled.cancel);\n     */\n    function throttle(func, wait, options) {\n      var leading = true,\n          trailing = true;\n\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      if (isObject(options)) {\n        leading = 'leading' in options ? !!options.leading : leading;\n        trailing = 'trailing' in options ? !!options.trailing : trailing;\n      }\n      return debounce(func, wait, {\n        'leading': leading,\n        'maxWait': wait,\n        'trailing': trailing\n      });\n    }\n\n    /**\n     * Creates a function that accepts up to one argument, ignoring any\n     * additional arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to cap arguments for.\n     * @returns {Function} Returns the new capped function.\n     * @example\n     *\n     * _.map(['6', '8', '10'], _.unary(parseInt));\n     * // => [6, 8, 10]\n     */\n    function unary(func) {\n      return ary(func, 1);\n    }\n\n    /**\n     * Creates a function that provides `value` to `wrapper` as its first\n     * argument. Any additional arguments provided to the function are appended\n     * to those provided to the `wrapper`. The wrapper is invoked with the `this`\n     * binding of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {*} value The value to wrap.\n     * @param {Function} [wrapper=identity] The wrapper function.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var p = _.wrap(_.escape, function(func, text) {\n     *   return '<p>' + func(text) + '</p>';\n     * });\n     *\n     * p('fred, barney, & pebbles');\n     * // => '<p>fred, barney, &amp; pebbles</p>'\n     */\n    function wrap(value, wrapper) {\n      return partial(castFunction(wrapper), value);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Casts `value` as an array if it's not one.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.4.0\n     * @category Lang\n     * @param {*} value The value to inspect.\n     * @returns {Array} Returns the cast array.\n     * @example\n     *\n     * _.castArray(1);\n     * // => [1]\n     *\n     * _.castArray({ 'a': 1 });\n     * // => [{ 'a': 1 }]\n     *\n     * _.castArray('abc');\n     * // => ['abc']\n     *\n     * _.castArray(null);\n     * // => [null]\n     *\n     * _.castArray(undefined);\n     * // => [undefined]\n     *\n     * _.castArray();\n     * // => []\n     *\n     * var array = [1, 2, 3];\n     * console.log(_.castArray(array) === array);\n     * // => true\n     */\n    function castArray() {\n      if (!arguments.length) {\n        return [];\n      }\n      var value = arguments[0];\n      return isArray(value) ? value : [value];\n    }\n\n    /**\n     * Creates a shallow clone of `value`.\n     *\n     * **Note:** This method is loosely based on the\n     * [structured clone algorithm](https://mdn.io/Structured_clone_algorithm)\n     * and supports cloning arrays, array buffers, booleans, date objects, maps,\n     * numbers, `Object` objects, regexes, sets, strings, symbols, and typed\n     * arrays. The own enumerable properties of `arguments` objects are cloned\n     * as plain objects. An empty object is returned for uncloneable values such\n     * as error objects, functions, DOM nodes, and WeakMaps.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to clone.\n     * @returns {*} Returns the cloned value.\n     * @see _.cloneDeep\n     * @example\n     *\n     * var objects = [{ 'a': 1 }, { 'b': 2 }];\n     *\n     * var shallow = _.clone(objects);\n     * console.log(shallow[0] === objects[0]);\n     * // => true\n     */\n    function clone(value) {\n      return baseClone(value, CLONE_SYMBOLS_FLAG);\n    }\n\n    /**\n     * This method is like `_.clone` except that it accepts `customizer` which\n     * is invoked to produce the cloned value. If `customizer` returns `undefined`,\n     * cloning is handled by the method instead. The `customizer` is invoked with\n     * up to four arguments; (value [, index|key, object, stack]).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to clone.\n     * @param {Function} [customizer] The function to customize cloning.\n     * @returns {*} Returns the cloned value.\n     * @see _.cloneDeepWith\n     * @example\n     *\n     * function customizer(value) {\n     *   if (_.isElement(value)) {\n     *     return value.cloneNode(false);\n     *   }\n     * }\n     *\n     * var el = _.cloneWith(document.body, customizer);\n     *\n     * console.log(el === document.body);\n     * // => false\n     * console.log(el.nodeName);\n     * // => 'BODY'\n     * console.log(el.childNodes.length);\n     * // => 0\n     */\n    function cloneWith(value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseClone(value, CLONE_SYMBOLS_FLAG, customizer);\n    }\n\n    /**\n     * This method is like `_.clone` except that it recursively clones `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Lang\n     * @param {*} value The value to recursively clone.\n     * @returns {*} Returns the deep cloned value.\n     * @see _.clone\n     * @example\n     *\n     * var objects = [{ 'a': 1 }, { 'b': 2 }];\n     *\n     * var deep = _.cloneDeep(objects);\n     * console.log(deep[0] === objects[0]);\n     * // => false\n     */\n    function cloneDeep(value) {\n      return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n    }\n\n    /**\n     * This method is like `_.cloneWith` except that it recursively clones `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to recursively clone.\n     * @param {Function} [customizer] The function to customize cloning.\n     * @returns {*} Returns the deep cloned value.\n     * @see _.cloneWith\n     * @example\n     *\n     * function customizer(value) {\n     *   if (_.isElement(value)) {\n     *     return value.cloneNode(true);\n     *   }\n     * }\n     *\n     * var el = _.cloneDeepWith(document.body, customizer);\n     *\n     * console.log(el === document.body);\n     * // => false\n     * console.log(el.nodeName);\n     * // => 'BODY'\n     * console.log(el.childNodes.length);\n     * // => 20\n     */\n    function cloneDeepWith(value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG, customizer);\n    }\n\n    /**\n     * Checks if `object` conforms to `source` by invoking the predicate\n     * properties of `source` with the corresponding property values of `object`.\n     *\n     * **Note:** This method is equivalent to `_.conforms` when `source` is\n     * partially applied.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.14.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {boolean} Returns `true` if `object` conforms, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     *\n     * _.conformsTo(object, { 'b': function(n) { return n > 1; } });\n     * // => true\n     *\n     * _.conformsTo(object, { 'b': function(n) { return n > 2; } });\n     * // => false\n     */\n    function conformsTo(object, source) {\n      return source == null || baseConformsTo(object, source, keys(source));\n    }\n\n    /**\n     * Performs a\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * comparison between two values to determine if they are equivalent.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     * var other = { 'a': 1 };\n     *\n     * _.eq(object, object);\n     * // => true\n     *\n     * _.eq(object, other);\n     * // => false\n     *\n     * _.eq('a', 'a');\n     * // => true\n     *\n     * _.eq('a', Object('a'));\n     * // => false\n     *\n     * _.eq(NaN, NaN);\n     * // => true\n     */\n    function eq(value, other) {\n      return value === other || (value !== value && other !== other);\n    }\n\n    /**\n     * Checks if `value` is greater than `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than `other`,\n     *  else `false`.\n     * @see _.lt\n     * @example\n     *\n     * _.gt(3, 1);\n     * // => true\n     *\n     * _.gt(3, 3);\n     * // => false\n     *\n     * _.gt(1, 3);\n     * // => false\n     */\n    var gt = createRelationalOperation(baseGt);\n\n    /**\n     * Checks if `value` is greater than or equal to `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than or equal to\n     *  `other`, else `false`.\n     * @see _.lte\n     * @example\n     *\n     * _.gte(3, 1);\n     * // => true\n     *\n     * _.gte(3, 3);\n     * // => true\n     *\n     * _.gte(1, 3);\n     * // => false\n     */\n    var gte = createRelationalOperation(function(value, other) {\n      return value >= other;\n    });\n\n    /**\n     * Checks if `value` is likely an `arguments` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n     *  else `false`.\n     * @example\n     *\n     * _.isArguments(function() { return arguments; }());\n     * // => true\n     *\n     * _.isArguments([1, 2, 3]);\n     * // => false\n     */\n    var isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n      return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n        !propertyIsEnumerable.call(value, 'callee');\n    };\n\n    /**\n     * Checks if `value` is classified as an `Array` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n     * @example\n     *\n     * _.isArray([1, 2, 3]);\n     * // => true\n     *\n     * _.isArray(document.body.children);\n     * // => false\n     *\n     * _.isArray('abc');\n     * // => false\n     *\n     * _.isArray(_.noop);\n     * // => false\n     */\n    var isArray = Array.isArray;\n\n    /**\n     * Checks if `value` is classified as an `ArrayBuffer` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.\n     * @example\n     *\n     * _.isArrayBuffer(new ArrayBuffer(2));\n     * // => true\n     *\n     * _.isArrayBuffer(new Array(2));\n     * // => false\n     */\n    var isArrayBuffer = nodeIsArrayBuffer ? baseUnary(nodeIsArrayBuffer) : baseIsArrayBuffer;\n\n    /**\n     * Checks if `value` is array-like. A value is considered array-like if it's\n     * not a function and has a `value.length` that's an integer greater than or\n     * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n     * @example\n     *\n     * _.isArrayLike([1, 2, 3]);\n     * // => true\n     *\n     * _.isArrayLike(document.body.children);\n     * // => true\n     *\n     * _.isArrayLike('abc');\n     * // => true\n     *\n     * _.isArrayLike(_.noop);\n     * // => false\n     */\n    function isArrayLike(value) {\n      return value != null && isLength(value.length) && !isFunction(value);\n    }\n\n    /**\n     * This method is like `_.isArrayLike` except that it also checks if `value`\n     * is an object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array-like object,\n     *  else `false`.\n     * @example\n     *\n     * _.isArrayLikeObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isArrayLikeObject(document.body.children);\n     * // => true\n     *\n     * _.isArrayLikeObject('abc');\n     * // => false\n     *\n     * _.isArrayLikeObject(_.noop);\n     * // => false\n     */\n    function isArrayLikeObject(value) {\n      return isObjectLike(value) && isArrayLike(value);\n    }\n\n    /**\n     * Checks if `value` is classified as a boolean primitive or object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a boolean, else `false`.\n     * @example\n     *\n     * _.isBoolean(false);\n     * // => true\n     *\n     * _.isBoolean(null);\n     * // => false\n     */\n    function isBoolean(value) {\n      return value === true || value === false ||\n        (isObjectLike(value) && baseGetTag(value) == boolTag);\n    }\n\n    /**\n     * Checks if `value` is a buffer.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n     * @example\n     *\n     * _.isBuffer(new Buffer(2));\n     * // => true\n     *\n     * _.isBuffer(new Uint8Array(2));\n     * // => false\n     */\n    var isBuffer = nativeIsBuffer || stubFalse;\n\n    /**\n     * Checks if `value` is classified as a `Date` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a date object, else `false`.\n     * @example\n     *\n     * _.isDate(new Date);\n     * // => true\n     *\n     * _.isDate('Mon April 23 2012');\n     * // => false\n     */\n    var isDate = nodeIsDate ? baseUnary(nodeIsDate) : baseIsDate;\n\n    /**\n     * Checks if `value` is likely a DOM element.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a DOM element, else `false`.\n     * @example\n     *\n     * _.isElement(document.body);\n     * // => true\n     *\n     * _.isElement('<body>');\n     * // => false\n     */\n    function isElement(value) {\n      return isObjectLike(value) && value.nodeType === 1 && !isPlainObject(value);\n    }\n\n    /**\n     * Checks if `value` is an empty object, collection, map, or set.\n     *\n     * Objects are considered empty if they have no own enumerable string keyed\n     * properties.\n     *\n     * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n     * jQuery-like collections are considered empty if they have a `length` of `0`.\n     * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n     * @example\n     *\n     * _.isEmpty(null);\n     * // => true\n     *\n     * _.isEmpty(true);\n     * // => true\n     *\n     * _.isEmpty(1);\n     * // => true\n     *\n     * _.isEmpty([1, 2, 3]);\n     * // => false\n     *\n     * _.isEmpty({ 'a': 1 });\n     * // => false\n     */\n    function isEmpty(value) {\n      if (value == null) {\n        return true;\n      }\n      if (isArrayLike(value) &&\n          (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n            isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n        return !value.length;\n      }\n      var tag = getTag(value);\n      if (tag == mapTag || tag == setTag) {\n        return !value.size;\n      }\n      if (isPrototype(value)) {\n        return !baseKeys(value).length;\n      }\n      for (var key in value) {\n        if (hasOwnProperty.call(value, key)) {\n          return false;\n        }\n      }\n      return true;\n    }\n\n    /**\n     * Performs a deep comparison between two values to determine if they are\n     * equivalent.\n     *\n     * **Note:** This method supports comparing arrays, array buffers, booleans,\n     * date objects, error objects, maps, numbers, `Object` objects, regexes,\n     * sets, strings, symbols, and typed arrays. `Object` objects are compared\n     * by their own, not inherited, enumerable properties. Functions and DOM\n     * nodes are compared by strict equality, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     * var other = { 'a': 1 };\n     *\n     * _.isEqual(object, other);\n     * // => true\n     *\n     * object === other;\n     * // => false\n     */\n    function isEqual(value, other) {\n      return baseIsEqual(value, other);\n    }\n\n    /**\n     * This method is like `_.isEqual` except that it accepts `customizer` which\n     * is invoked to compare values. If `customizer` returns `undefined`, comparisons\n     * are handled by the method instead. The `customizer` is invoked with up to\n     * six arguments: (objValue, othValue [, index|key, object, other, stack]).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * function isGreeting(value) {\n     *   return /^h(?:i|ello)$/.test(value);\n     * }\n     *\n     * function customizer(objValue, othValue) {\n     *   if (isGreeting(objValue) && isGreeting(othValue)) {\n     *     return true;\n     *   }\n     * }\n     *\n     * var array = ['hello', 'goodbye'];\n     * var other = ['hi', 'goodbye'];\n     *\n     * _.isEqualWith(array, other, customizer);\n     * // => true\n     */\n    function isEqualWith(value, other, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      var result = customizer ? customizer(value, other) : undefined;\n      return result === undefined ? baseIsEqual(value, other, undefined, customizer) : !!result;\n    }\n\n    /**\n     * Checks if `value` is an `Error`, `EvalError`, `RangeError`, `ReferenceError`,\n     * `SyntaxError`, `TypeError`, or `URIError` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an error object, else `false`.\n     * @example\n     *\n     * _.isError(new Error);\n     * // => true\n     *\n     * _.isError(Error);\n     * // => false\n     */\n    function isError(value) {\n      if (!isObjectLike(value)) {\n        return false;\n      }\n      var tag = baseGetTag(value);\n      return tag == errorTag || tag == domExcTag ||\n        (typeof value.message == 'string' && typeof value.name == 'string' && !isPlainObject(value));\n    }\n\n    /**\n     * Checks if `value` is a finite primitive number.\n     *\n     * **Note:** This method is based on\n     * [`Number.isFinite`](https://mdn.io/Number/isFinite).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n     * @example\n     *\n     * _.isFinite(3);\n     * // => true\n     *\n     * _.isFinite(Number.MIN_VALUE);\n     * // => true\n     *\n     * _.isFinite(Infinity);\n     * // => false\n     *\n     * _.isFinite('3');\n     * // => false\n     */\n    function isFinite(value) {\n      return typeof value == 'number' && nativeIsFinite(value);\n    }\n\n    /**\n     * Checks if `value` is classified as a `Function` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n     * @example\n     *\n     * _.isFunction(_);\n     * // => true\n     *\n     * _.isFunction(/abc/);\n     * // => false\n     */\n    function isFunction(value) {\n      if (!isObject(value)) {\n        return false;\n      }\n      // The use of `Object#toString` avoids issues with the `typeof` operator\n      // in Safari 9 which returns 'object' for typed arrays and other constructors.\n      var tag = baseGetTag(value);\n      return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n    }\n\n    /**\n     * Checks if `value` is an integer.\n     *\n     * **Note:** This method is based on\n     * [`Number.isInteger`](https://mdn.io/Number/isInteger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an integer, else `false`.\n     * @example\n     *\n     * _.isInteger(3);\n     * // => true\n     *\n     * _.isInteger(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isInteger(Infinity);\n     * // => false\n     *\n     * _.isInteger('3');\n     * // => false\n     */\n    function isInteger(value) {\n      return typeof value == 'number' && value == toInteger(value);\n    }\n\n    /**\n     * Checks if `value` is a valid array-like length.\n     *\n     * **Note:** This method is loosely based on\n     * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n     * @example\n     *\n     * _.isLength(3);\n     * // => true\n     *\n     * _.isLength(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isLength(Infinity);\n     * // => false\n     *\n     * _.isLength('3');\n     * // => false\n     */\n    function isLength(value) {\n      return typeof value == 'number' &&\n        value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n    }\n\n    /**\n     * Checks if `value` is the\n     * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n     * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n     * @example\n     *\n     * _.isObject({});\n     * // => true\n     *\n     * _.isObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isObject(_.noop);\n     * // => true\n     *\n     * _.isObject(null);\n     * // => false\n     */\n    function isObject(value) {\n      var type = typeof value;\n      return value != null && (type == 'object' || type == 'function');\n    }\n\n    /**\n     * Checks if `value` is object-like. A value is object-like if it's not `null`\n     * and has a `typeof` result of \"object\".\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n     * @example\n     *\n     * _.isObjectLike({});\n     * // => true\n     *\n     * _.isObjectLike([1, 2, 3]);\n     * // => true\n     *\n     * _.isObjectLike(_.noop);\n     * // => false\n     *\n     * _.isObjectLike(null);\n     * // => false\n     */\n    function isObjectLike(value) {\n      return value != null && typeof value == 'object';\n    }\n\n    /**\n     * Checks if `value` is classified as a `Map` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n     * @example\n     *\n     * _.isMap(new Map);\n     * // => true\n     *\n     * _.isMap(new WeakMap);\n     * // => false\n     */\n    var isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\n    /**\n     * Performs a partial deep comparison between `object` and `source` to\n     * determine if `object` contains equivalent property values.\n     *\n     * **Note:** This method is equivalent to `_.matches` when `source` is\n     * partially applied.\n     *\n     * Partial comparisons will match empty array and empty object `source`\n     * values against any array or object value, respectively. See `_.isEqual`\n     * for a list of supported value comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     *\n     * _.isMatch(object, { 'b': 2 });\n     * // => true\n     *\n     * _.isMatch(object, { 'b': 1 });\n     * // => false\n     */\n    function isMatch(object, source) {\n      return object === source || baseIsMatch(object, source, getMatchData(source));\n    }\n\n    /**\n     * This method is like `_.isMatch` except that it accepts `customizer` which\n     * is invoked to compare values. If `customizer` returns `undefined`, comparisons\n     * are handled by the method instead. The `customizer` is invoked with five\n     * arguments: (objValue, srcValue, index|key, object, source).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     * @example\n     *\n     * function isGreeting(value) {\n     *   return /^h(?:i|ello)$/.test(value);\n     * }\n     *\n     * function customizer(objValue, srcValue) {\n     *   if (isGreeting(objValue) && isGreeting(srcValue)) {\n     *     return true;\n     *   }\n     * }\n     *\n     * var object = { 'greeting': 'hello' };\n     * var source = { 'greeting': 'hi' };\n     *\n     * _.isMatchWith(object, source, customizer);\n     * // => true\n     */\n    function isMatchWith(object, source, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseIsMatch(object, source, getMatchData(source), customizer);\n    }\n\n    /**\n     * Checks if `value` is `NaN`.\n     *\n     * **Note:** This method is based on\n     * [`Number.isNaN`](https://mdn.io/Number/isNaN) and is not the same as\n     * global [`isNaN`](https://mdn.io/isNaN) which returns `true` for\n     * `undefined` and other non-number values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n     * @example\n     *\n     * _.isNaN(NaN);\n     * // => true\n     *\n     * _.isNaN(new Number(NaN));\n     * // => true\n     *\n     * isNaN(undefined);\n     * // => true\n     *\n     * _.isNaN(undefined);\n     * // => false\n     */\n    function isNaN(value) {\n      // An `NaN` primitive is the only value that is not equal to itself.\n      // Perform the `toStringTag` check first to avoid errors with some\n      // ActiveX objects in IE.\n      return isNumber(value) && value != +value;\n    }\n\n    /**\n     * Checks if `value` is a pristine native function.\n     *\n     * **Note:** This method can't reliably detect native functions in the presence\n     * of the core-js package because core-js circumvents this kind of detection.\n     * Despite multiple requests, the core-js maintainer has made it clear: any\n     * attempt to fix the detection will be obstructed. As a result, we're left\n     * with little choice but to throw an error. Unfortunately, this also affects\n     * packages, like [babel-polyfill](https://www.npmjs.com/package/babel-polyfill),\n     * which rely on core-js.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a native function,\n     *  else `false`.\n     * @example\n     *\n     * _.isNative(Array.prototype.push);\n     * // => true\n     *\n     * _.isNative(_);\n     * // => false\n     */\n    function isNative(value) {\n      if (isMaskable(value)) {\n        throw new Error(CORE_ERROR_TEXT);\n      }\n      return baseIsNative(value);\n    }\n\n    /**\n     * Checks if `value` is `null`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `null`, else `false`.\n     * @example\n     *\n     * _.isNull(null);\n     * // => true\n     *\n     * _.isNull(void 0);\n     * // => false\n     */\n    function isNull(value) {\n      return value === null;\n    }\n\n    /**\n     * Checks if `value` is `null` or `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is nullish, else `false`.\n     * @example\n     *\n     * _.isNil(null);\n     * // => true\n     *\n     * _.isNil(void 0);\n     * // => true\n     *\n     * _.isNil(NaN);\n     * // => false\n     */\n    function isNil(value) {\n      return value == null;\n    }\n\n    /**\n     * Checks if `value` is classified as a `Number` primitive or object.\n     *\n     * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n     * classified as numbers, use the `_.isFinite` method.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n     * @example\n     *\n     * _.isNumber(3);\n     * // => true\n     *\n     * _.isNumber(Number.MIN_VALUE);\n     * // => true\n     *\n     * _.isNumber(Infinity);\n     * // => true\n     *\n     * _.isNumber('3');\n     * // => false\n     */\n    function isNumber(value) {\n      return typeof value == 'number' ||\n        (isObjectLike(value) && baseGetTag(value) == numberTag);\n    }\n\n    /**\n     * Checks if `value` is a plain object, that is, an object created by the\n     * `Object` constructor or one with a `[[Prototype]]` of `null`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.8.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * _.isPlainObject(new Foo);\n     * // => false\n     *\n     * _.isPlainObject([1, 2, 3]);\n     * // => false\n     *\n     * _.isPlainObject({ 'x': 0, 'y': 0 });\n     * // => true\n     *\n     * _.isPlainObject(Object.create(null));\n     * // => true\n     */\n    function isPlainObject(value) {\n      if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n        return false;\n      }\n      var proto = getPrototype(value);\n      if (proto === null) {\n        return true;\n      }\n      var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n      return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n        funcToString.call(Ctor) == objectCtorString;\n    }\n\n    /**\n     * Checks if `value` is classified as a `RegExp` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.\n     * @example\n     *\n     * _.isRegExp(/abc/);\n     * // => true\n     *\n     * _.isRegExp('/abc/');\n     * // => false\n     */\n    var isRegExp = nodeIsRegExp ? baseUnary(nodeIsRegExp) : baseIsRegExp;\n\n    /**\n     * Checks if `value` is a safe integer. An integer is safe if it's an IEEE-754\n     * double precision number which isn't the result of a rounded unsafe integer.\n     *\n     * **Note:** This method is based on\n     * [`Number.isSafeInteger`](https://mdn.io/Number/isSafeInteger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a safe integer, else `false`.\n     * @example\n     *\n     * _.isSafeInteger(3);\n     * // => true\n     *\n     * _.isSafeInteger(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isSafeInteger(Infinity);\n     * // => false\n     *\n     * _.isSafeInteger('3');\n     * // => false\n     */\n    function isSafeInteger(value) {\n      return isInteger(value) && value >= -MAX_SAFE_INTEGER && value <= MAX_SAFE_INTEGER;\n    }\n\n    /**\n     * Checks if `value` is classified as a `Set` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n     * @example\n     *\n     * _.isSet(new Set);\n     * // => true\n     *\n     * _.isSet(new WeakSet);\n     * // => false\n     */\n    var isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\n    /**\n     * Checks if `value` is classified as a `String` primitive or object.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n     * @example\n     *\n     * _.isString('abc');\n     * // => true\n     *\n     * _.isString(1);\n     * // => false\n     */\n    function isString(value) {\n      return typeof value == 'string' ||\n        (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n    }\n\n    /**\n     * Checks if `value` is classified as a `Symbol` primitive or object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n     * @example\n     *\n     * _.isSymbol(Symbol.iterator);\n     * // => true\n     *\n     * _.isSymbol('abc');\n     * // => false\n     */\n    function isSymbol(value) {\n      return typeof value == 'symbol' ||\n        (isObjectLike(value) && baseGetTag(value) == symbolTag);\n    }\n\n    /**\n     * Checks if `value` is classified as a typed array.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n     * @example\n     *\n     * _.isTypedArray(new Uint8Array);\n     * // => true\n     *\n     * _.isTypedArray([]);\n     * // => false\n     */\n    var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n    /**\n     * Checks if `value` is `undefined`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n     * @example\n     *\n     * _.isUndefined(void 0);\n     * // => true\n     *\n     * _.isUndefined(null);\n     * // => false\n     */\n    function isUndefined(value) {\n      return value === undefined;\n    }\n\n    /**\n     * Checks if `value` is classified as a `WeakMap` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a weak map, else `false`.\n     * @example\n     *\n     * _.isWeakMap(new WeakMap);\n     * // => true\n     *\n     * _.isWeakMap(new Map);\n     * // => false\n     */\n    function isWeakMap(value) {\n      return isObjectLike(value) && getTag(value) == weakMapTag;\n    }\n\n    /**\n     * Checks if `value` is classified as a `WeakSet` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a weak set, else `false`.\n     * @example\n     *\n     * _.isWeakSet(new WeakSet);\n     * // => true\n     *\n     * _.isWeakSet(new Set);\n     * // => false\n     */\n    function isWeakSet(value) {\n      return isObjectLike(value) && baseGetTag(value) == weakSetTag;\n    }\n\n    /**\n     * Checks if `value` is less than `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than `other`,\n     *  else `false`.\n     * @see _.gt\n     * @example\n     *\n     * _.lt(1, 3);\n     * // => true\n     *\n     * _.lt(3, 3);\n     * // => false\n     *\n     * _.lt(3, 1);\n     * // => false\n     */\n    var lt = createRelationalOperation(baseLt);\n\n    /**\n     * Checks if `value` is less than or equal to `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than or equal to\n     *  `other`, else `false`.\n     * @see _.gte\n     * @example\n     *\n     * _.lte(1, 3);\n     * // => true\n     *\n     * _.lte(3, 3);\n     * // => true\n     *\n     * _.lte(3, 1);\n     * // => false\n     */\n    var lte = createRelationalOperation(function(value, other) {\n      return value <= other;\n    });\n\n    /**\n     * Converts `value` to an array.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {Array} Returns the converted array.\n     * @example\n     *\n     * _.toArray({ 'a': 1, 'b': 2 });\n     * // => [1, 2]\n     *\n     * _.toArray('abc');\n     * // => ['a', 'b', 'c']\n     *\n     * _.toArray(1);\n     * // => []\n     *\n     * _.toArray(null);\n     * // => []\n     */\n    function toArray(value) {\n      if (!value) {\n        return [];\n      }\n      if (isArrayLike(value)) {\n        return isString(value) ? stringToArray(value) : copyArray(value);\n      }\n      if (symIterator && value[symIterator]) {\n        return iteratorToArray(value[symIterator]());\n      }\n      var tag = getTag(value),\n          func = tag == mapTag ? mapToArray : (tag == setTag ? setToArray : values);\n\n      return func(value);\n    }\n\n    /**\n     * Converts `value` to a finite number.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.12.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted number.\n     * @example\n     *\n     * _.toFinite(3.2);\n     * // => 3.2\n     *\n     * _.toFinite(Number.MIN_VALUE);\n     * // => 5e-324\n     *\n     * _.toFinite(Infinity);\n     * // => 1.7976931348623157e+308\n     *\n     * _.toFinite('3.2');\n     * // => 3.2\n     */\n    function toFinite(value) {\n      if (!value) {\n        return value === 0 ? value : 0;\n      }\n      value = toNumber(value);\n      if (value === INFINITY || value === -INFINITY) {\n        var sign = (value < 0 ? -1 : 1);\n        return sign * MAX_INTEGER;\n      }\n      return value === value ? value : 0;\n    }\n\n    /**\n     * Converts `value` to an integer.\n     *\n     * **Note:** This method is loosely based on\n     * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toInteger(3.2);\n     * // => 3\n     *\n     * _.toInteger(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toInteger(Infinity);\n     * // => 1.7976931348623157e+308\n     *\n     * _.toInteger('3.2');\n     * // => 3\n     */\n    function toInteger(value) {\n      var result = toFinite(value),\n          remainder = result % 1;\n\n      return result === result ? (remainder ? result - remainder : result) : 0;\n    }\n\n    /**\n     * Converts `value` to an integer suitable for use as the length of an\n     * array-like object.\n     *\n     * **Note:** This method is based on\n     * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toLength(3.2);\n     * // => 3\n     *\n     * _.toLength(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toLength(Infinity);\n     * // => 4294967295\n     *\n     * _.toLength('3.2');\n     * // => 3\n     */\n    function toLength(value) {\n      return value ? baseClamp(toInteger(value), 0, MAX_ARRAY_LENGTH) : 0;\n    }\n\n    /**\n     * Converts `value` to a number.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to process.\n     * @returns {number} Returns the number.\n     * @example\n     *\n     * _.toNumber(3.2);\n     * // => 3.2\n     *\n     * _.toNumber(Number.MIN_VALUE);\n     * // => 5e-324\n     *\n     * _.toNumber(Infinity);\n     * // => Infinity\n     *\n     * _.toNumber('3.2');\n     * // => 3.2\n     */\n    function toNumber(value) {\n      if (typeof value == 'number') {\n        return value;\n      }\n      if (isSymbol(value)) {\n        return NAN;\n      }\n      if (isObject(value)) {\n        var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n        value = isObject(other) ? (other + '') : other;\n      }\n      if (typeof value != 'string') {\n        return value === 0 ? value : +value;\n      }\n      value = baseTrim(value);\n      var isBinary = reIsBinary.test(value);\n      return (isBinary || reIsOctal.test(value))\n        ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n        : (reIsBadHex.test(value) ? NAN : +value);\n    }\n\n    /**\n     * Converts `value` to a plain object flattening inherited enumerable string\n     * keyed properties of `value` to own properties of the plain object.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {Object} Returns the converted plain object.\n     * @example\n     *\n     * function Foo() {\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.assign({ 'a': 1 }, new Foo);\n     * // => { 'a': 1, 'b': 2 }\n     *\n     * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n     * // => { 'a': 1, 'b': 2, 'c': 3 }\n     */\n    function toPlainObject(value) {\n      return copyObject(value, keysIn(value));\n    }\n\n    /**\n     * Converts `value` to a safe integer. A safe integer can be compared and\n     * represented correctly.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toSafeInteger(3.2);\n     * // => 3\n     *\n     * _.toSafeInteger(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toSafeInteger(Infinity);\n     * // => 9007199254740991\n     *\n     * _.toSafeInteger('3.2');\n     * // => 3\n     */\n    function toSafeInteger(value) {\n      return value\n        ? baseClamp(toInteger(value), -MAX_SAFE_INTEGER, MAX_SAFE_INTEGER)\n        : (value === 0 ? value : 0);\n    }\n\n    /**\n     * Converts `value` to a string. An empty string is returned for `null`\n     * and `undefined` values. The sign of `-0` is preserved.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.toString(null);\n     * // => ''\n     *\n     * _.toString(-0);\n     * // => '-0'\n     *\n     * _.toString([1, 2, 3]);\n     * // => '1,2,3'\n     */\n    function toString(value) {\n      return value == null ? '' : baseToString(value);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Assigns own enumerable string keyed properties of source objects to the\n     * destination object. Source objects are applied from left to right.\n     * Subsequent sources overwrite property assignments of previous sources.\n     *\n     * **Note:** This method mutates `object` and is loosely based on\n     * [`Object.assign`](https://mdn.io/Object/assign).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.10.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.assignIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * function Bar() {\n     *   this.c = 3;\n     * }\n     *\n     * Foo.prototype.b = 2;\n     * Bar.prototype.d = 4;\n     *\n     * _.assign({ 'a': 0 }, new Foo, new Bar);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    var assign = createAssigner(function(object, source) {\n      if (isPrototype(source) || isArrayLike(source)) {\n        copyObject(source, keys(source), object);\n        return;\n      }\n      for (var key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          assignValue(object, key, source[key]);\n        }\n      }\n    });\n\n    /**\n     * This method is like `_.assign` except that it iterates over own and\n     * inherited source properties.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias extend\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.assign\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * function Bar() {\n     *   this.c = 3;\n     * }\n     *\n     * Foo.prototype.b = 2;\n     * Bar.prototype.d = 4;\n     *\n     * _.assignIn({ 'a': 0 }, new Foo, new Bar);\n     * // => { 'a': 1, 'b': 2, 'c': 3, 'd': 4 }\n     */\n    var assignIn = createAssigner(function(object, source) {\n      copyObject(source, keysIn(source), object);\n    });\n\n    /**\n     * This method is like `_.assignIn` except that it accepts `customizer`\n     * which is invoked to produce the assigned values. If `customizer` returns\n     * `undefined`, assignment is handled by the method instead. The `customizer`\n     * is invoked with five arguments: (objValue, srcValue, key, object, source).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias extendWith\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @see _.assignWith\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   return _.isUndefined(objValue) ? srcValue : objValue;\n     * }\n     *\n     * var defaults = _.partialRight(_.assignInWith, customizer);\n     *\n     * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var assignInWith = createAssigner(function(object, source, srcIndex, customizer) {\n      copyObject(source, keysIn(source), object, customizer);\n    });\n\n    /**\n     * This method is like `_.assign` except that it accepts `customizer`\n     * which is invoked to produce the assigned values. If `customizer` returns\n     * `undefined`, assignment is handled by the method instead. The `customizer`\n     * is invoked with five arguments: (objValue, srcValue, key, object, source).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @see _.assignInWith\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   return _.isUndefined(objValue) ? srcValue : objValue;\n     * }\n     *\n     * var defaults = _.partialRight(_.assignWith, customizer);\n     *\n     * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var assignWith = createAssigner(function(object, source, srcIndex, customizer) {\n      copyObject(source, keys(source), object, customizer);\n    });\n\n    /**\n     * Creates an array of values corresponding to `paths` of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Array} Returns the picked values.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };\n     *\n     * _.at(object, ['a[0].b.c', 'a[1]']);\n     * // => [3, 4]\n     */\n    var at = flatRest(baseAt);\n\n    /**\n     * Creates an object that inherits from the `prototype` object. If a\n     * `properties` object is given, its own enumerable string keyed properties\n     * are assigned to the created object.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.3.0\n     * @category Object\n     * @param {Object} prototype The object to inherit from.\n     * @param {Object} [properties] The properties to assign to the object.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * function Circle() {\n     *   Shape.call(this);\n     * }\n     *\n     * Circle.prototype = _.create(Shape.prototype, {\n     *   'constructor': Circle\n     * });\n     *\n     * var circle = new Circle;\n     * circle instanceof Circle;\n     * // => true\n     *\n     * circle instanceof Shape;\n     * // => true\n     */\n    function create(prototype, properties) {\n      var result = baseCreate(prototype);\n      return properties == null ? result : baseAssign(result, properties);\n    }\n\n    /**\n     * Assigns own and inherited enumerable string keyed properties of source\n     * objects to the destination object for all destination properties that\n     * resolve to `undefined`. Source objects are applied from left to right.\n     * Once a property is set, additional values of the same property are ignored.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.defaultsDeep\n     * @example\n     *\n     * _.defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var defaults = baseRest(function(object, sources) {\n      object = Object(object);\n\n      var index = -1;\n      var length = sources.length;\n      var guard = length > 2 ? sources[2] : undefined;\n\n      if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n        length = 1;\n      }\n\n      while (++index < length) {\n        var source = sources[index];\n        var props = keysIn(source);\n        var propsIndex = -1;\n        var propsLength = props.length;\n\n        while (++propsIndex < propsLength) {\n          var key = props[propsIndex];\n          var value = object[key];\n\n          if (value === undefined ||\n              (eq(value, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n            object[key] = source[key];\n          }\n        }\n      }\n\n      return object;\n    });\n\n    /**\n     * This method is like `_.defaults` except that it recursively assigns\n     * default properties.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.defaults\n     * @example\n     *\n     * _.defaultsDeep({ 'a': { 'b': 2 } }, { 'a': { 'b': 1, 'c': 3 } });\n     * // => { 'a': { 'b': 2, 'c': 3 } }\n     */\n    var defaultsDeep = baseRest(function(args) {\n      args.push(undefined, customDefaultsMerge);\n      return apply(mergeWith, undefined, args);\n    });\n\n    /**\n     * This method is like `_.find` except that it returns the key of the first\n     * element `predicate` returns truthy for instead of the element itself.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {string|undefined} Returns the key of the matched element,\n     *  else `undefined`.\n     * @example\n     *\n     * var users = {\n     *   'barney':  { 'age': 36, 'active': true },\n     *   'fred':    { 'age': 40, 'active': false },\n     *   'pebbles': { 'age': 1,  'active': true }\n     * };\n     *\n     * _.findKey(users, function(o) { return o.age < 40; });\n     * // => 'barney' (iteration order is not guaranteed)\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findKey(users, { 'age': 1, 'active': true });\n     * // => 'pebbles'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findKey(users, ['active', false]);\n     * // => 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findKey(users, 'active');\n     * // => 'barney'\n     */\n    function findKey(object, predicate) {\n      return baseFindKey(object, getIteratee(predicate, 3), baseForOwn);\n    }\n\n    /**\n     * This method is like `_.findKey` except that it iterates over elements of\n     * a collection in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {string|undefined} Returns the key of the matched element,\n     *  else `undefined`.\n     * @example\n     *\n     * var users = {\n     *   'barney':  { 'age': 36, 'active': true },\n     *   'fred':    { 'age': 40, 'active': false },\n     *   'pebbles': { 'age': 1,  'active': true }\n     * };\n     *\n     * _.findLastKey(users, function(o) { return o.age < 40; });\n     * // => returns 'pebbles' assuming `_.findKey` returns 'barney'\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findLastKey(users, { 'age': 36, 'active': true });\n     * // => 'barney'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findLastKey(users, ['active', false]);\n     * // => 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findLastKey(users, 'active');\n     * // => 'pebbles'\n     */\n    function findLastKey(object, predicate) {\n      return baseFindKey(object, getIteratee(predicate, 3), baseForOwnRight);\n    }\n\n    /**\n     * Iterates over own and inherited enumerable string keyed properties of an\n     * object and invokes `iteratee` for each property. The iteratee is invoked\n     * with three arguments: (value, key, object). Iteratee functions may exit\n     * iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forInRight\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forIn(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a', 'b', then 'c' (iteration order is not guaranteed).\n     */\n    function forIn(object, iteratee) {\n      return object == null\n        ? object\n        : baseFor(object, getIteratee(iteratee, 3), keysIn);\n    }\n\n    /**\n     * This method is like `_.forIn` except that it iterates over properties of\n     * `object` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forInRight(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'c', 'b', then 'a' assuming `_.forIn` logs 'a', 'b', then 'c'.\n     */\n    function forInRight(object, iteratee) {\n      return object == null\n        ? object\n        : baseForRight(object, getIteratee(iteratee, 3), keysIn);\n    }\n\n    /**\n     * Iterates over own enumerable string keyed properties of an object and\n     * invokes `iteratee` for each property. The iteratee is invoked with three\n     * arguments: (value, key, object). Iteratee functions may exit iteration\n     * early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forOwnRight\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forOwn(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n     */\n    function forOwn(object, iteratee) {\n      return object && baseForOwn(object, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.forOwn` except that it iterates over properties of\n     * `object` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forOwn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forOwnRight(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'b' then 'a' assuming `_.forOwn` logs 'a' then 'b'.\n     */\n    function forOwnRight(object, iteratee) {\n      return object && baseForOwnRight(object, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * Creates an array of function property names from own enumerable properties\n     * of `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns the function names.\n     * @see _.functionsIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = _.constant('a');\n     *   this.b = _.constant('b');\n     * }\n     *\n     * Foo.prototype.c = _.constant('c');\n     *\n     * _.functions(new Foo);\n     * // => ['a', 'b']\n     */\n    function functions(object) {\n      return object == null ? [] : baseFunctions(object, keys(object));\n    }\n\n    /**\n     * Creates an array of function property names from own and inherited\n     * enumerable properties of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns the function names.\n     * @see _.functions\n     * @example\n     *\n     * function Foo() {\n     *   this.a = _.constant('a');\n     *   this.b = _.constant('b');\n     * }\n     *\n     * Foo.prototype.c = _.constant('c');\n     *\n     * _.functionsIn(new Foo);\n     * // => ['a', 'b', 'c']\n     */\n    function functionsIn(object) {\n      return object == null ? [] : baseFunctions(object, keysIn(object));\n    }\n\n    /**\n     * Gets the value at `path` of `object`. If the resolved value is\n     * `undefined`, the `defaultValue` is returned in its place.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to get.\n     * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.get(object, 'a[0].b.c');\n     * // => 3\n     *\n     * _.get(object, ['a', '0', 'b', 'c']);\n     * // => 3\n     *\n     * _.get(object, 'a.b.c', 'default');\n     * // => 'default'\n     */\n    function get(object, path, defaultValue) {\n      var result = object == null ? undefined : baseGet(object, path);\n      return result === undefined ? defaultValue : result;\n    }\n\n    /**\n     * Checks if `path` is a direct property of `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     * @example\n     *\n     * var object = { 'a': { 'b': 2 } };\n     * var other = _.create({ 'a': _.create({ 'b': 2 }) });\n     *\n     * _.has(object, 'a');\n     * // => true\n     *\n     * _.has(object, 'a.b');\n     * // => true\n     *\n     * _.has(object, ['a', 'b']);\n     * // => true\n     *\n     * _.has(other, 'a');\n     * // => false\n     */\n    function has(object, path) {\n      return object != null && hasPath(object, path, baseHas);\n    }\n\n    /**\n     * Checks if `path` is a direct or inherited property of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     * @example\n     *\n     * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n     *\n     * _.hasIn(object, 'a');\n     * // => true\n     *\n     * _.hasIn(object, 'a.b');\n     * // => true\n     *\n     * _.hasIn(object, ['a', 'b']);\n     * // => true\n     *\n     * _.hasIn(object, 'b');\n     * // => false\n     */\n    function hasIn(object, path) {\n      return object != null && hasPath(object, path, baseHasIn);\n    }\n\n    /**\n     * Creates an object composed of the inverted keys and values of `object`.\n     * If `object` contains duplicate values, subsequent values overwrite\n     * property assignments of previous values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.7.0\n     * @category Object\n     * @param {Object} object The object to invert.\n     * @returns {Object} Returns the new inverted object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2, 'c': 1 };\n     *\n     * _.invert(object);\n     * // => { '1': 'c', '2': 'b' }\n     */\n    var invert = createInverter(function(result, value, key) {\n      if (value != null &&\n          typeof value.toString != 'function') {\n        value = nativeObjectToString.call(value);\n      }\n\n      result[value] = key;\n    }, constant(identity));\n\n    /**\n     * This method is like `_.invert` except that the inverted object is generated\n     * from the results of running each element of `object` thru `iteratee`. The\n     * corresponding inverted value of each inverted key is an array of keys\n     * responsible for generating the inverted value. The iteratee is invoked\n     * with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.1.0\n     * @category Object\n     * @param {Object} object The object to invert.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Object} Returns the new inverted object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2, 'c': 1 };\n     *\n     * _.invertBy(object);\n     * // => { '1': ['a', 'c'], '2': ['b'] }\n     *\n     * _.invertBy(object, function(value) {\n     *   return 'group' + value;\n     * });\n     * // => { 'group1': ['a', 'c'], 'group2': ['b'] }\n     */\n    var invertBy = createInverter(function(result, value, key) {\n      if (value != null &&\n          typeof value.toString != 'function') {\n        value = nativeObjectToString.call(value);\n      }\n\n      if (hasOwnProperty.call(result, value)) {\n        result[value].push(key);\n      } else {\n        result[value] = [key];\n      }\n    }, getIteratee);\n\n    /**\n     * Invokes the method at `path` of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {*} Returns the result of the invoked method.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': [1, 2, 3, 4] } }] };\n     *\n     * _.invoke(object, 'a[0].b.c.slice', 1, 3);\n     * // => [2, 3]\n     */\n    var invoke = baseRest(baseInvoke);\n\n    /**\n     * Creates an array of the own enumerable property names of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects. See the\n     * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n     * for more details.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.keys(new Foo);\n     * // => ['a', 'b'] (iteration order is not guaranteed)\n     *\n     * _.keys('hi');\n     * // => ['0', '1']\n     */\n    function keys(object) {\n      return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n    }\n\n    /**\n     * Creates an array of the own and inherited enumerable property names of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.keysIn(new Foo);\n     * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n     */\n    function keysIn(object) {\n      return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n    }\n\n    /**\n     * The opposite of `_.mapValues`; this method creates an object with the\n     * same values as `object` and keys generated by running each own enumerable\n     * string keyed property of `object` thru `iteratee`. The iteratee is invoked\n     * with three arguments: (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns the new mapped object.\n     * @see _.mapValues\n     * @example\n     *\n     * _.mapKeys({ 'a': 1, 'b': 2 }, function(value, key) {\n     *   return key + value;\n     * });\n     * // => { 'a1': 1, 'b2': 2 }\n     */\n    function mapKeys(object, iteratee) {\n      var result = {};\n      iteratee = getIteratee(iteratee, 3);\n\n      baseForOwn(object, function(value, key, object) {\n        baseAssignValue(result, iteratee(value, key, object), value);\n      });\n      return result;\n    }\n\n    /**\n     * Creates an object with the same keys as `object` and values generated\n     * by running each own enumerable string keyed property of `object` thru\n     * `iteratee`. The iteratee is invoked with three arguments:\n     * (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns the new mapped object.\n     * @see _.mapKeys\n     * @example\n     *\n     * var users = {\n     *   'fred':    { 'user': 'fred',    'age': 40 },\n     *   'pebbles': { 'user': 'pebbles', 'age': 1 }\n     * };\n     *\n     * _.mapValues(users, function(o) { return o.age; });\n     * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.mapValues(users, 'age');\n     * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n     */\n    function mapValues(object, iteratee) {\n      var result = {};\n      iteratee = getIteratee(iteratee, 3);\n\n      baseForOwn(object, function(value, key, object) {\n        baseAssignValue(result, key, iteratee(value, key, object));\n      });\n      return result;\n    }\n\n    /**\n     * This method is like `_.assign` except that it recursively merges own and\n     * inherited enumerable string keyed properties of source objects into the\n     * destination object. Source properties that resolve to `undefined` are\n     * skipped if a destination value exists. Array and plain object properties\n     * are merged recursively. Other objects and value types are overridden by\n     * assignment. Source objects are applied from left to right. Subsequent\n     * sources overwrite property assignments of previous sources.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {\n     *   'a': [{ 'b': 2 }, { 'd': 4 }]\n     * };\n     *\n     * var other = {\n     *   'a': [{ 'c': 3 }, { 'e': 5 }]\n     * };\n     *\n     * _.merge(object, other);\n     * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n     */\n    var merge = createAssigner(function(object, source, srcIndex) {\n      baseMerge(object, source, srcIndex);\n    });\n\n    /**\n     * This method is like `_.merge` except that it accepts `customizer` which\n     * is invoked to produce the merged values of the destination and source\n     * properties. If `customizer` returns `undefined`, merging is handled by the\n     * method instead. The `customizer` is invoked with six arguments:\n     * (objValue, srcValue, key, object, source, stack).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} customizer The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   if (_.isArray(objValue)) {\n     *     return objValue.concat(srcValue);\n     *   }\n     * }\n     *\n     * var object = { 'a': [1], 'b': [2] };\n     * var other = { 'a': [3], 'b': [4] };\n     *\n     * _.mergeWith(object, other, customizer);\n     * // => { 'a': [1, 3], 'b': [2, 4] }\n     */\n    var mergeWith = createAssigner(function(object, source, srcIndex, customizer) {\n      baseMerge(object, source, srcIndex, customizer);\n    });\n\n    /**\n     * The opposite of `_.pick`; this method creates an object composed of the\n     * own and inherited enumerable property paths of `object` that are not omitted.\n     *\n     * **Note:** This method is considerably slower than `_.pick`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {...(string|string[])} [paths] The property paths to omit.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.omit(object, ['a', 'c']);\n     * // => { 'b': '2' }\n     */\n    var omit = flatRest(function(object, paths) {\n      var result = {};\n      if (object == null) {\n        return result;\n      }\n      var isDeep = false;\n      paths = arrayMap(paths, function(path) {\n        path = castPath(path, object);\n        isDeep || (isDeep = path.length > 1);\n        return path;\n      });\n      copyObject(object, getAllKeysIn(object), result);\n      if (isDeep) {\n        result = baseClone(result, CLONE_DEEP_FLAG | CLONE_FLAT_FLAG | CLONE_SYMBOLS_FLAG, customOmitClone);\n      }\n      var length = paths.length;\n      while (length--) {\n        baseUnset(result, paths[length]);\n      }\n      return result;\n    });\n\n    /**\n     * The opposite of `_.pickBy`; this method creates an object composed of\n     * the own and inherited enumerable string keyed properties of `object` that\n     * `predicate` doesn't return truthy for. The predicate is invoked with two\n     * arguments: (value, key).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {Function} [predicate=_.identity] The function invoked per property.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.omitBy(object, _.isNumber);\n     * // => { 'b': '2' }\n     */\n    function omitBy(object, predicate) {\n      return pickBy(object, negate(getIteratee(predicate)));\n    }\n\n    /**\n     * Creates an object composed of the picked `object` properties.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.pick(object, ['a', 'c']);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    var pick = flatRest(function(object, paths) {\n      return object == null ? {} : basePick(object, paths);\n    });\n\n    /**\n     * Creates an object composed of the `object` properties `predicate` returns\n     * truthy for. The predicate is invoked with two arguments: (value, key).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {Function} [predicate=_.identity] The function invoked per property.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.pickBy(object, _.isNumber);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    function pickBy(object, predicate) {\n      if (object == null) {\n        return {};\n      }\n      var props = arrayMap(getAllKeysIn(object), function(prop) {\n        return [prop];\n      });\n      predicate = getIteratee(predicate);\n      return basePickBy(object, props, function(value, path) {\n        return predicate(value, path[0]);\n      });\n    }\n\n    /**\n     * This method is like `_.get` except that if the resolved value is a\n     * function it's invoked with the `this` binding of its parent object and\n     * its result is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to resolve.\n     * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c1': 3, 'c2': _.constant(4) } }] };\n     *\n     * _.result(object, 'a[0].b.c1');\n     * // => 3\n     *\n     * _.result(object, 'a[0].b.c2');\n     * // => 4\n     *\n     * _.result(object, 'a[0].b.c3', 'default');\n     * // => 'default'\n     *\n     * _.result(object, 'a[0].b.c3', _.constant('default'));\n     * // => 'default'\n     */\n    function result(object, path, defaultValue) {\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length;\n\n      // Ensure the loop is entered when path is empty.\n      if (!length) {\n        length = 1;\n        object = undefined;\n      }\n      while (++index < length) {\n        var value = object == null ? undefined : object[toKey(path[index])];\n        if (value === undefined) {\n          index = length;\n          value = defaultValue;\n        }\n        object = isFunction(value) ? value.call(object) : value;\n      }\n      return object;\n    }\n\n    /**\n     * Sets the value at `path` of `object`. If a portion of `path` doesn't exist,\n     * it's created. Arrays are created for missing index properties while objects\n     * are created for all other missing properties. Use `_.setWith` to customize\n     * `path` creation.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.set(object, 'a[0].b.c', 4);\n     * console.log(object.a[0].b.c);\n     * // => 4\n     *\n     * _.set(object, ['x', '0', 'y', 'z'], 5);\n     * console.log(object.x[0].y.z);\n     * // => 5\n     */\n    function set(object, path, value) {\n      return object == null ? object : baseSet(object, path, value);\n    }\n\n    /**\n     * This method is like `_.set` except that it accepts `customizer` which is\n     * invoked to produce the objects of `path`.  If `customizer` returns `undefined`\n     * path creation is handled by the method instead. The `customizer` is invoked\n     * with three arguments: (nsValue, key, nsObject).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {};\n     *\n     * _.setWith(object, '[0][1]', 'a', Object);\n     * // => { '0': { '1': 'a' } }\n     */\n    function setWith(object, path, value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return object == null ? object : baseSet(object, path, value, customizer);\n    }\n\n    /**\n     * Creates an array of own enumerable string keyed-value pairs for `object`\n     * which can be consumed by `_.fromPairs`. If `object` is a map or set, its\n     * entries are returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias entries\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the key-value pairs.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.toPairs(new Foo);\n     * // => [['a', 1], ['b', 2]] (iteration order is not guaranteed)\n     */\n    var toPairs = createToPairs(keys);\n\n    /**\n     * Creates an array of own and inherited enumerable string keyed-value pairs\n     * for `object` which can be consumed by `_.fromPairs`. If `object` is a map\n     * or set, its entries are returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias entriesIn\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the key-value pairs.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.toPairsIn(new Foo);\n     * // => [['a', 1], ['b', 2], ['c', 3]] (iteration order is not guaranteed)\n     */\n    var toPairsIn = createToPairs(keysIn);\n\n    /**\n     * An alternative to `_.reduce`; this method transforms `object` to a new\n     * `accumulator` object which is the result of running each of its own\n     * enumerable string keyed properties thru `iteratee`, with each invocation\n     * potentially mutating the `accumulator` object. If `accumulator` is not\n     * provided, a new object with the same `[[Prototype]]` will be used. The\n     * iteratee is invoked with four arguments: (accumulator, value, key, object).\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The custom accumulator value.\n     * @returns {*} Returns the accumulated value.\n     * @example\n     *\n     * _.transform([2, 3, 4], function(result, n) {\n     *   result.push(n *= n);\n     *   return n % 2 == 0;\n     * }, []);\n     * // => [4, 9]\n     *\n     * _.transform({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n     *   (result[value] || (result[value] = [])).push(key);\n     * }, {});\n     * // => { '1': ['a', 'c'], '2': ['b'] }\n     */\n    function transform(object, iteratee, accumulator) {\n      var isArr = isArray(object),\n          isArrLike = isArr || isBuffer(object) || isTypedArray(object);\n\n      iteratee = getIteratee(iteratee, 4);\n      if (accumulator == null) {\n        var Ctor = object && object.constructor;\n        if (isArrLike) {\n          accumulator = isArr ? new Ctor : [];\n        }\n        else if (isObject(object)) {\n          accumulator = isFunction(Ctor) ? baseCreate(getPrototype(object)) : {};\n        }\n        else {\n          accumulator = {};\n        }\n      }\n      (isArrLike ? arrayEach : baseForOwn)(object, function(value, index, object) {\n        return iteratee(accumulator, value, index, object);\n      });\n      return accumulator;\n    }\n\n    /**\n     * Removes the property at `path` of `object`.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to unset.\n     * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 7 } }] };\n     * _.unset(object, 'a[0].b.c');\n     * // => true\n     *\n     * console.log(object);\n     * // => { 'a': [{ 'b': {} }] };\n     *\n     * _.unset(object, ['a', '0', 'b', 'c']);\n     * // => true\n     *\n     * console.log(object);\n     * // => { 'a': [{ 'b': {} }] };\n     */\n    function unset(object, path) {\n      return object == null ? true : baseUnset(object, path);\n    }\n\n    /**\n     * This method is like `_.set` except that accepts `updater` to produce the\n     * value to set. Use `_.updateWith` to customize `path` creation. The `updater`\n     * is invoked with one argument: (value).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {Function} updater The function to produce the updated value.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.update(object, 'a[0].b.c', function(n) { return n * n; });\n     * console.log(object.a[0].b.c);\n     * // => 9\n     *\n     * _.update(object, 'x[0].y.z', function(n) { return n ? n + 1 : 0; });\n     * console.log(object.x[0].y.z);\n     * // => 0\n     */\n    function update(object, path, updater) {\n      return object == null ? object : baseUpdate(object, path, castFunction(updater));\n    }\n\n    /**\n     * This method is like `_.update` except that it accepts `customizer` which is\n     * invoked to produce the objects of `path`.  If `customizer` returns `undefined`\n     * path creation is handled by the method instead. The `customizer` is invoked\n     * with three arguments: (nsValue, key, nsObject).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {Function} updater The function to produce the updated value.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {};\n     *\n     * _.updateWith(object, '[0][1]', _.constant('a'), Object);\n     * // => { '0': { '1': 'a' } }\n     */\n    function updateWith(object, path, updater, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return object == null ? object : baseUpdate(object, path, castFunction(updater), customizer);\n    }\n\n    /**\n     * Creates an array of the own enumerable string keyed property values of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property values.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.values(new Foo);\n     * // => [1, 2] (iteration order is not guaranteed)\n     *\n     * _.values('hi');\n     * // => ['h', 'i']\n     */\n    function values(object) {\n      return object == null ? [] : baseValues(object, keys(object));\n    }\n\n    /**\n     * Creates an array of the own and inherited enumerable string keyed property\n     * values of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property values.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.valuesIn(new Foo);\n     * // => [1, 2, 3] (iteration order is not guaranteed)\n     */\n    function valuesIn(object) {\n      return object == null ? [] : baseValues(object, keysIn(object));\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Clamps `number` within the inclusive `lower` and `upper` bounds.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Number\n     * @param {number} number The number to clamp.\n     * @param {number} [lower] The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the clamped number.\n     * @example\n     *\n     * _.clamp(-10, -5, 5);\n     * // => -5\n     *\n     * _.clamp(10, -5, 5);\n     * // => 5\n     */\n    function clamp(number, lower, upper) {\n      if (upper === undefined) {\n        upper = lower;\n        lower = undefined;\n      }\n      if (upper !== undefined) {\n        upper = toNumber(upper);\n        upper = upper === upper ? upper : 0;\n      }\n      if (lower !== undefined) {\n        lower = toNumber(lower);\n        lower = lower === lower ? lower : 0;\n      }\n      return baseClamp(toNumber(number), lower, upper);\n    }\n\n    /**\n     * Checks if `n` is between `start` and up to, but not including, `end`. If\n     * `end` is not specified, it's set to `start` with `start` then set to `0`.\n     * If `start` is greater than `end` the params are swapped to support\n     * negative ranges.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.3.0\n     * @category Number\n     * @param {number} number The number to check.\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n     * @see _.range, _.rangeRight\n     * @example\n     *\n     * _.inRange(3, 2, 4);\n     * // => true\n     *\n     * _.inRange(4, 8);\n     * // => true\n     *\n     * _.inRange(4, 2);\n     * // => false\n     *\n     * _.inRange(2, 2);\n     * // => false\n     *\n     * _.inRange(1.2, 2);\n     * // => true\n     *\n     * _.inRange(5.2, 4);\n     * // => false\n     *\n     * _.inRange(-3, -2, -6);\n     * // => true\n     */\n    function inRange(number, start, end) {\n      start = toFinite(start);\n      if (end === undefined) {\n        end = start;\n        start = 0;\n      } else {\n        end = toFinite(end);\n      }\n      number = toNumber(number);\n      return baseInRange(number, start, end);\n    }\n\n    /**\n     * Produces a random number between the inclusive `lower` and `upper` bounds.\n     * If only one argument is provided a number between `0` and the given number\n     * is returned. If `floating` is `true`, or either `lower` or `upper` are\n     * floats, a floating-point number is returned instead of an integer.\n     *\n     * **Note:** JavaScript follows the IEEE-754 standard for resolving\n     * floating-point values which can produce unexpected results.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.7.0\n     * @category Number\n     * @param {number} [lower=0] The lower bound.\n     * @param {number} [upper=1] The upper bound.\n     * @param {boolean} [floating] Specify returning a floating-point number.\n     * @returns {number} Returns the random number.\n     * @example\n     *\n     * _.random(0, 5);\n     * // => an integer between 0 and 5\n     *\n     * _.random(5);\n     * // => also an integer between 0 and 5\n     *\n     * _.random(5, true);\n     * // => a floating-point number between 0 and 5\n     *\n     * _.random(1.2, 5.2);\n     * // => a floating-point number between 1.2 and 5.2\n     */\n    function random(lower, upper, floating) {\n      if (floating && typeof floating != 'boolean' && isIterateeCall(lower, upper, floating)) {\n        upper = floating = undefined;\n      }\n      if (floating === undefined) {\n        if (typeof upper == 'boolean') {\n          floating = upper;\n          upper = undefined;\n        }\n        else if (typeof lower == 'boolean') {\n          floating = lower;\n          lower = undefined;\n        }\n      }\n      if (lower === undefined && upper === undefined) {\n        lower = 0;\n        upper = 1;\n      }\n      else {\n        lower = toFinite(lower);\n        if (upper === undefined) {\n          upper = lower;\n          lower = 0;\n        } else {\n          upper = toFinite(upper);\n        }\n      }\n      if (lower > upper) {\n        var temp = lower;\n        lower = upper;\n        upper = temp;\n      }\n      if (floating || lower % 1 || upper % 1) {\n        var rand = nativeRandom();\n        return nativeMin(lower + (rand * (upper - lower + freeParseFloat('1e-' + ((rand + '').length - 1)))), upper);\n      }\n      return baseRandom(lower, upper);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Converts `string` to [camel case](https://en.wikipedia.org/wiki/CamelCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the camel cased string.\n     * @example\n     *\n     * _.camelCase('Foo Bar');\n     * // => 'fooBar'\n     *\n     * _.camelCase('--foo-bar--');\n     * // => 'fooBar'\n     *\n     * _.camelCase('__FOO_BAR__');\n     * // => 'fooBar'\n     */\n    var camelCase = createCompounder(function(result, word, index) {\n      word = word.toLowerCase();\n      return result + (index ? capitalize(word) : word);\n    });\n\n    /**\n     * Converts the first character of `string` to upper case and the remaining\n     * to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to capitalize.\n     * @returns {string} Returns the capitalized string.\n     * @example\n     *\n     * _.capitalize('FRED');\n     * // => 'Fred'\n     */\n    function capitalize(string) {\n      return upperFirst(toString(string).toLowerCase());\n    }\n\n    /**\n     * Deburrs `string` by converting\n     * [Latin-1 Supplement](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)#Character_table)\n     * and [Latin Extended-A](https://en.wikipedia.org/wiki/Latin_Extended-A)\n     * letters to basic Latin letters and removing\n     * [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to deburr.\n     * @returns {string} Returns the deburred string.\n     * @example\n     *\n     * _.deburr('d\u00E9j\u00E0 vu');\n     * // => 'deja vu'\n     */\n    function deburr(string) {\n      string = toString(string);\n      return string && string.replace(reLatin, deburrLetter).replace(reComboMark, '');\n    }\n\n    /**\n     * Checks if `string` ends with the given target string.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {string} [target] The string to search for.\n     * @param {number} [position=string.length] The position to search up to.\n     * @returns {boolean} Returns `true` if `string` ends with `target`,\n     *  else `false`.\n     * @example\n     *\n     * _.endsWith('abc', 'c');\n     * // => true\n     *\n     * _.endsWith('abc', 'b');\n     * // => false\n     *\n     * _.endsWith('abc', 'b', 2);\n     * // => true\n     */\n    function endsWith(string, target, position) {\n      string = toString(string);\n      target = baseToString(target);\n\n      var length = string.length;\n      position = position === undefined\n        ? length\n        : baseClamp(toInteger(position), 0, length);\n\n      var end = position;\n      position -= target.length;\n      return position >= 0 && string.slice(position, end) == target;\n    }\n\n    /**\n     * Converts the characters \"&\", \"<\", \">\", '\"', and \"'\" in `string` to their\n     * corresponding HTML entities.\n     *\n     * **Note:** No other characters are escaped. To escape additional\n     * characters use a third-party library like [_he_](https://mths.be/he).\n     *\n     * Though the \">\" character is escaped for symmetry, characters like\n     * \">\" and \"/\" don't need escaping in HTML and have no special meaning\n     * unless they're part of a tag or unquoted attribute value. See\n     * [Mathias Bynens's article](https://mathiasbynens.be/notes/ambiguous-ampersands)\n     * (under \"semi-related fun fact\") for more details.\n     *\n     * When working with HTML you should always\n     * [quote attribute values](http://wonko.com/post/html-escaping) to reduce\n     * XSS vectors.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category String\n     * @param {string} [string=''] The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escape('fred, barney, & pebbles');\n     * // => 'fred, barney, &amp; pebbles'\n     */\n    function escape(string) {\n      string = toString(string);\n      return (string && reHasUnescapedHtml.test(string))\n        ? string.replace(reUnescapedHtml, escapeHtmlChar)\n        : string;\n    }\n\n    /**\n     * Escapes the `RegExp` special characters \"^\", \"$\", \"\\\", \".\", \"*\", \"+\",\n     * \"?\", \"(\", \")\", \"[\", \"]\", \"{\", \"}\", and \"|\" in `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escapeRegExp('[lodash](https://lodash.com/)');\n     * // => '\\[lodash\\]\\(https://lodash\\.com/\\)'\n     */\n    function escapeRegExp(string) {\n      string = toString(string);\n      return (string && reHasRegExpChar.test(string))\n        ? string.replace(reRegExpChar, '\\\\$&')\n        : string;\n    }\n\n    /**\n     * Converts `string` to\n     * [kebab case](https://en.wikipedia.org/wiki/Letter_case#Special_case_styles).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the kebab cased string.\n     * @example\n     *\n     * _.kebabCase('Foo Bar');\n     * // => 'foo-bar'\n     *\n     * _.kebabCase('fooBar');\n     * // => 'foo-bar'\n     *\n     * _.kebabCase('__FOO_BAR__');\n     * // => 'foo-bar'\n     */\n    var kebabCase = createCompounder(function(result, word, index) {\n      return result + (index ? '-' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Converts `string`, as space separated words, to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the lower cased string.\n     * @example\n     *\n     * _.lowerCase('--Foo-Bar--');\n     * // => 'foo bar'\n     *\n     * _.lowerCase('fooBar');\n     * // => 'foo bar'\n     *\n     * _.lowerCase('__FOO_BAR__');\n     * // => 'foo bar'\n     */\n    var lowerCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Converts the first character of `string` to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.lowerFirst('Fred');\n     * // => 'fred'\n     *\n     * _.lowerFirst('FRED');\n     * // => 'fRED'\n     */\n    var lowerFirst = createCaseFirst('toLowerCase');\n\n    /**\n     * Pads `string` on the left and right sides if it's shorter than `length`.\n     * Padding characters are truncated if they can't be evenly divided by `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.pad('abc', 8);\n     * // => '  abc   '\n     *\n     * _.pad('abc', 8, '_-');\n     * // => '_-abc_-_'\n     *\n     * _.pad('abc', 3);\n     * // => 'abc'\n     */\n    function pad(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      if (!length || strLength >= length) {\n        return string;\n      }\n      var mid = (length - strLength) / 2;\n      return (\n        createPadding(nativeFloor(mid), chars) +\n        string +\n        createPadding(nativeCeil(mid), chars)\n      );\n    }\n\n    /**\n     * Pads `string` on the right side if it's shorter than `length`. Padding\n     * characters are truncated if they exceed `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.padEnd('abc', 6);\n     * // => 'abc   '\n     *\n     * _.padEnd('abc', 6, '_-');\n     * // => 'abc_-_'\n     *\n     * _.padEnd('abc', 3);\n     * // => 'abc'\n     */\n    function padEnd(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      return (length && strLength < length)\n        ? (string + createPadding(length - strLength, chars))\n        : string;\n    }\n\n    /**\n     * Pads `string` on the left side if it's shorter than `length`. Padding\n     * characters are truncated if they exceed `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.padStart('abc', 6);\n     * // => '   abc'\n     *\n     * _.padStart('abc', 6, '_-');\n     * // => '_-_abc'\n     *\n     * _.padStart('abc', 3);\n     * // => 'abc'\n     */\n    function padStart(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      return (length && strLength < length)\n        ? (createPadding(length - strLength, chars) + string)\n        : string;\n    }\n\n    /**\n     * Converts `string` to an integer of the specified radix. If `radix` is\n     * `undefined` or `0`, a `radix` of `10` is used unless `value` is a\n     * hexadecimal, in which case a `radix` of `16` is used.\n     *\n     * **Note:** This method aligns with the\n     * [ES5 implementation](https://es5.github.io/#x15.1.2.2) of `parseInt`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category String\n     * @param {string} string The string to convert.\n     * @param {number} [radix=10] The radix to interpret `value` by.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.parseInt('08');\n     * // => 8\n     *\n     * _.map(['6', '08', '10'], _.parseInt);\n     * // => [6, 8, 10]\n     */\n    function parseInt(string, radix, guard) {\n      if (guard || radix == null) {\n        radix = 0;\n      } else if (radix) {\n        radix = +radix;\n      }\n      return nativeParseInt(toString(string).replace(reTrimStart, ''), radix || 0);\n    }\n\n    /**\n     * Repeats the given string `n` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to repeat.\n     * @param {number} [n=1] The number of times to repeat the string.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the repeated string.\n     * @example\n     *\n     * _.repeat('*', 3);\n     * // => '***'\n     *\n     * _.repeat('abc', 2);\n     * // => 'abcabc'\n     *\n     * _.repeat('abc', 0);\n     * // => ''\n     */\n    function repeat(string, n, guard) {\n      if ((guard ? isIterateeCall(string, n, guard) : n === undefined)) {\n        n = 1;\n      } else {\n        n = toInteger(n);\n      }\n      return baseRepeat(toString(string), n);\n    }\n\n    /**\n     * Replaces matches for `pattern` in `string` with `replacement`.\n     *\n     * **Note:** This method is based on\n     * [`String#replace`](https://mdn.io/String/replace).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to modify.\n     * @param {RegExp|string} pattern The pattern to replace.\n     * @param {Function|string} replacement The match replacement.\n     * @returns {string} Returns the modified string.\n     * @example\n     *\n     * _.replace('Hi Fred', 'Fred', 'Barney');\n     * // => 'Hi Barney'\n     */\n    function replace() {\n      var args = arguments,\n          string = toString(args[0]);\n\n      return args.length < 3 ? string : string.replace(args[1], args[2]);\n    }\n\n    /**\n     * Converts `string` to\n     * [snake case](https://en.wikipedia.org/wiki/Snake_case).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the snake cased string.\n     * @example\n     *\n     * _.snakeCase('Foo Bar');\n     * // => 'foo_bar'\n     *\n     * _.snakeCase('fooBar');\n     * // => 'foo_bar'\n     *\n     * _.snakeCase('--FOO-BAR--');\n     * // => 'foo_bar'\n     */\n    var snakeCase = createCompounder(function(result, word, index) {\n      return result + (index ? '_' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Splits `string` by `separator`.\n     *\n     * **Note:** This method is based on\n     * [`String#split`](https://mdn.io/String/split).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to split.\n     * @param {RegExp|string} separator The separator pattern to split by.\n     * @param {number} [limit] The length to truncate results to.\n     * @returns {Array} Returns the string segments.\n     * @example\n     *\n     * _.split('a-b-c', '-', 2);\n     * // => ['a', 'b']\n     */\n    function split(string, separator, limit) {\n      if (limit && typeof limit != 'number' && isIterateeCall(string, separator, limit)) {\n        separator = limit = undefined;\n      }\n      limit = limit === undefined ? MAX_ARRAY_LENGTH : limit >>> 0;\n      if (!limit) {\n        return [];\n      }\n      string = toString(string);\n      if (string && (\n            typeof separator == 'string' ||\n            (separator != null && !isRegExp(separator))\n          )) {\n        separator = baseToString(separator);\n        if (!separator && hasUnicode(string)) {\n          return castSlice(stringToArray(string), 0, limit);\n        }\n      }\n      return string.split(separator, limit);\n    }\n\n    /**\n     * Converts `string` to\n     * [start case](https://en.wikipedia.org/wiki/Letter_case#Stylistic_or_specialised_usage).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.1.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the start cased string.\n     * @example\n     *\n     * _.startCase('--foo-bar--');\n     * // => 'Foo Bar'\n     *\n     * _.startCase('fooBar');\n     * // => 'Foo Bar'\n     *\n     * _.startCase('__FOO_BAR__');\n     * // => 'FOO BAR'\n     */\n    var startCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + upperFirst(word);\n    });\n\n    /**\n     * Checks if `string` starts with the given target string.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {string} [target] The string to search for.\n     * @param {number} [position=0] The position to search from.\n     * @returns {boolean} Returns `true` if `string` starts with `target`,\n     *  else `false`.\n     * @example\n     *\n     * _.startsWith('abc', 'a');\n     * // => true\n     *\n     * _.startsWith('abc', 'b');\n     * // => false\n     *\n     * _.startsWith('abc', 'b', 1);\n     * // => true\n     */\n    function startsWith(string, target, position) {\n      string = toString(string);\n      position = position == null\n        ? 0\n        : baseClamp(toInteger(position), 0, string.length);\n\n      target = baseToString(target);\n      return string.slice(position, position + target.length) == target;\n    }\n\n    /**\n     * Creates a compiled template function that can interpolate data properties\n     * in \"interpolate\" delimiters, HTML-escape interpolated data properties in\n     * \"escape\" delimiters, and execute JavaScript in \"evaluate\" delimiters. Data\n     * properties may be accessed as free variables in the template. If a setting\n     * object is given, it takes precedence over `_.templateSettings` values.\n     *\n     * **Note:** In the development build `_.template` utilizes\n     * [sourceURLs](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl)\n     * for easier debugging.\n     *\n     * For more information on precompiling templates see\n     * [lodash's custom builds documentation](https://lodash.com/custom-builds).\n     *\n     * For more information on Chrome extension sandboxes see\n     * [Chrome's extensions documentation](https://developer.chrome.com/extensions/sandboxingEval).\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category String\n     * @param {string} [string=''] The template string.\n     * @param {Object} [options={}] The options object.\n     * @param {RegExp} [options.escape=_.templateSettings.escape]\n     *  The HTML \"escape\" delimiter.\n     * @param {RegExp} [options.evaluate=_.templateSettings.evaluate]\n     *  The \"evaluate\" delimiter.\n     * @param {Object} [options.imports=_.templateSettings.imports]\n     *  An object to import into the template as free variables.\n     * @param {RegExp} [options.interpolate=_.templateSettings.interpolate]\n     *  The \"interpolate\" delimiter.\n     * @param {string} [options.sourceURL='lodash.templateSources[n]']\n     *  The sourceURL of the compiled template.\n     * @param {string} [options.variable='obj']\n     *  The data object variable name.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the compiled template function.\n     * @example\n     *\n     * // Use the \"interpolate\" delimiter to create a compiled template.\n     * var compiled = _.template('hello <%= user %>!');\n     * compiled({ 'user': 'fred' });\n     * // => 'hello fred!'\n     *\n     * // Use the HTML \"escape\" delimiter to escape data property values.\n     * var compiled = _.template('<b><%- value %></b>');\n     * compiled({ 'value': '<script>' });\n     * // => '<b>&lt;script&gt;</b>'\n     *\n     * // Use the \"evaluate\" delimiter to execute JavaScript and generate HTML.\n     * var compiled = _.template('<% _.forEach(users, function(user) { %><li><%- user %></li><% }); %>');\n     * compiled({ 'users': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // Use the internal `print` function in \"evaluate\" delimiters.\n     * var compiled = _.template('<% print(\"hello \" + user); %>!');\n     * compiled({ 'user': 'barney' });\n     * // => 'hello barney!'\n     *\n     * // Use the ES template literal delimiter as an \"interpolate\" delimiter.\n     * // Disable support by replacing the \"interpolate\" delimiter.\n     * var compiled = _.template('hello ${ user }!');\n     * compiled({ 'user': 'pebbles' });\n     * // => 'hello pebbles!'\n     *\n     * // Use backslashes to treat delimiters as plain text.\n     * var compiled = _.template('<%= \"\\\\<%- value %\\\\>\" %>');\n     * compiled({ 'value': 'ignored' });\n     * // => '<%- value %>'\n     *\n     * // Use the `imports` option to import `jQuery` as `jq`.\n     * var text = '<% jq.each(users, function(user) { %><li><%- user %></li><% }); %>';\n     * var compiled = _.template(text, { 'imports': { 'jq': jQuery } });\n     * compiled({ 'users': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // Use the `sourceURL` option to specify a custom sourceURL for the template.\n     * var compiled = _.template('hello <%= user %>!', { 'sourceURL': '/basic/greeting.jst' });\n     * compiled(data);\n     * // => Find the source of \"greeting.jst\" under the Sources tab or Resources panel of the web inspector.\n     *\n     * // Use the `variable` option to ensure a with-statement isn't used in the compiled template.\n     * var compiled = _.template('hi <%= data.user %>!', { 'variable': 'data' });\n     * compiled.source;\n     * // => function(data) {\n     * //   var __t, __p = '';\n     * //   __p += 'hi ' + ((__t = ( data.user )) == null ? '' : __t) + '!';\n     * //   return __p;\n     * // }\n     *\n     * // Use custom template delimiters.\n     * _.templateSettings.interpolate = /{{([\\s\\S]+?)}}/g;\n     * var compiled = _.template('hello {{ user }}!');\n     * compiled({ 'user': 'mustache' });\n     * // => 'hello mustache!'\n     *\n     * // Use the `source` property to inline compiled templates for meaningful\n     * // line numbers in error messages and stack traces.\n     * fs.writeFileSync(path.join(process.cwd(), 'jst.js'), '\\\n     *   var JST = {\\\n     *     \"main\": ' + _.template(mainText).source + '\\\n     *   };\\\n     * ');\n     */\n    function template(string, options, guard) {\n      // Based on John Resig's `tmpl` implementation\n      // (http://ejohn.org/blog/javascript-micro-templating/)\n      // and Laura Doktorova's doT.js (https://github.com/olado/doT).\n      var settings = lodash.templateSettings;\n\n      if (guard && isIterateeCall(string, options, guard)) {\n        options = undefined;\n      }\n      string = toString(string);\n      options = assignInWith({}, options, settings, customDefaultsAssignIn);\n\n      var imports = assignInWith({}, options.imports, settings.imports, customDefaultsAssignIn),\n          importsKeys = keys(imports),\n          importsValues = baseValues(imports, importsKeys);\n\n      var isEscaping,\n          isEvaluating,\n          index = 0,\n          interpolate = options.interpolate || reNoMatch,\n          source = \"__p += '\";\n\n      // Compile the regexp to match each delimiter.\n      var reDelimiters = RegExp(\n        (options.escape || reNoMatch).source + '|' +\n        interpolate.source + '|' +\n        (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +\n        (options.evaluate || reNoMatch).source + '|$'\n      , 'g');\n\n      // Use a sourceURL for easier debugging.\n      // The sourceURL gets injected into the source that's eval-ed, so be careful\n      // to normalize all kinds of whitespace, so e.g. newlines (and unicode versions of it) can't sneak in\n      // and escape the comment, thus injecting code that gets evaled.\n      var sourceURL = '//# sourceURL=' +\n        (hasOwnProperty.call(options, 'sourceURL')\n          ? (options.sourceURL + '').replace(/\\s/g, ' ')\n          : ('lodash.templateSources[' + (++templateCounter) + ']')\n        ) + '\\n';\n\n      string.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {\n        interpolateValue || (interpolateValue = esTemplateValue);\n\n        // Escape characters that can't be included in string literals.\n        source += string.slice(index, offset).replace(reUnescapedString, escapeStringChar);\n\n        // Replace delimiters with snippets.\n        if (escapeValue) {\n          isEscaping = true;\n          source += \"' +\\n__e(\" + escapeValue + \") +\\n'\";\n        }\n        if (evaluateValue) {\n          isEvaluating = true;\n          source += \"';\\n\" + evaluateValue + \";\\n__p += '\";\n        }\n        if (interpolateValue) {\n          source += \"' +\\n((__t = (\" + interpolateValue + \")) == null ? '' : __t) +\\n'\";\n        }\n        index = offset + match.length;\n\n        // The JS engine embedded in Adobe products needs `match` returned in\n        // order to produce the correct `offset` value.\n        return match;\n      });\n\n      source += \"';\\n\";\n\n      // If `variable` is not specified wrap a with-statement around the generated\n      // code to add the data object to the top of the scope chain.\n      var variable = hasOwnProperty.call(options, 'variable') && options.variable;\n      if (!variable) {\n        source = 'with (obj) {\\n' + source + '\\n}\\n';\n      }\n      // Throw an error if a forbidden character was found in `variable`, to prevent\n      // potential command injection attacks.\n      else if (reForbiddenIdentifierChars.test(variable)) {\n        throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT);\n      }\n\n      // Cleanup code by stripping empty strings.\n      source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)\n        .replace(reEmptyStringMiddle, '$1')\n        .replace(reEmptyStringTrailing, '$1;');\n\n      // Frame code as the function body.\n      source = 'function(' + (variable || 'obj') + ') {\\n' +\n        (variable\n          ? ''\n          : 'obj || (obj = {});\\n'\n        ) +\n        \"var __t, __p = ''\" +\n        (isEscaping\n           ? ', __e = _.escape'\n           : ''\n        ) +\n        (isEvaluating\n          ? ', __j = Array.prototype.join;\\n' +\n            \"function print() { __p += __j.call(arguments, '') }\\n\"\n          : ';\\n'\n        ) +\n        source +\n        'return __p\\n}';\n\n      var result = attempt(function() {\n        return Function(importsKeys, sourceURL + 'return ' + source)\n          .apply(undefined, importsValues);\n      });\n\n      // Provide the compiled function's source by its `toString` method or\n      // the `source` property as a convenience for inlining compiled templates.\n      result.source = source;\n      if (isError(result)) {\n        throw result;\n      }\n      return result;\n    }\n\n    /**\n     * Converts `string`, as a whole, to lower case just like\n     * [String#toLowerCase](https://mdn.io/toLowerCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the lower cased string.\n     * @example\n     *\n     * _.toLower('--Foo-Bar--');\n     * // => '--foo-bar--'\n     *\n     * _.toLower('fooBar');\n     * // => 'foobar'\n     *\n     * _.toLower('__FOO_BAR__');\n     * // => '__foo_bar__'\n     */\n    function toLower(value) {\n      return toString(value).toLowerCase();\n    }\n\n    /**\n     * Converts `string`, as a whole, to upper case just like\n     * [String#toUpperCase](https://mdn.io/toUpperCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the upper cased string.\n     * @example\n     *\n     * _.toUpper('--foo-bar--');\n     * // => '--FOO-BAR--'\n     *\n     * _.toUpper('fooBar');\n     * // => 'FOOBAR'\n     *\n     * _.toUpper('__foo_bar__');\n     * // => '__FOO_BAR__'\n     */\n    function toUpper(value) {\n      return toString(value).toUpperCase();\n    }\n\n    /**\n     * Removes leading and trailing whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trim('  abc  ');\n     * // => 'abc'\n     *\n     * _.trim('-_-abc-_-', '_-');\n     * // => 'abc'\n     *\n     * _.map(['  foo  ', '  bar  '], _.trim);\n     * // => ['foo', 'bar']\n     */\n    function trim(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return baseTrim(string);\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          chrSymbols = stringToArray(chars),\n          start = charsStartIndex(strSymbols, chrSymbols),\n          end = charsEndIndex(strSymbols, chrSymbols) + 1;\n\n      return castSlice(strSymbols, start, end).join('');\n    }\n\n    /**\n     * Removes trailing whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trimEnd('  abc  ');\n     * // => '  abc'\n     *\n     * _.trimEnd('-_-abc-_-', '_-');\n     * // => '-_-abc'\n     */\n    function trimEnd(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return string.slice(0, trimmedEndIndex(string) + 1);\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          end = charsEndIndex(strSymbols, stringToArray(chars)) + 1;\n\n      return castSlice(strSymbols, 0, end).join('');\n    }\n\n    /**\n     * Removes leading whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trimStart('  abc  ');\n     * // => 'abc  '\n     *\n     * _.trimStart('-_-abc-_-', '_-');\n     * // => 'abc-_-'\n     */\n    function trimStart(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return string.replace(reTrimStart, '');\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          start = charsStartIndex(strSymbols, stringToArray(chars));\n\n      return castSlice(strSymbols, start).join('');\n    }\n\n    /**\n     * Truncates `string` if it's longer than the given maximum string length.\n     * The last characters of the truncated string are replaced with the omission\n     * string which defaults to \"...\".\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to truncate.\n     * @param {Object} [options={}] The options object.\n     * @param {number} [options.length=30] The maximum string length.\n     * @param {string} [options.omission='...'] The string to indicate text is omitted.\n     * @param {RegExp|string} [options.separator] The separator pattern to truncate to.\n     * @returns {string} Returns the truncated string.\n     * @example\n     *\n     * _.truncate('hi-diddly-ho there, neighborino');\n     * // => 'hi-diddly-ho there, neighbo...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'length': 24,\n     *   'separator': ' '\n     * });\n     * // => 'hi-diddly-ho there,...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'length': 24,\n     *   'separator': /,? +/\n     * });\n     * // => 'hi-diddly-ho there...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'omission': ' [...]'\n     * });\n     * // => 'hi-diddly-ho there, neig [...]'\n     */\n    function truncate(string, options) {\n      var length = DEFAULT_TRUNC_LENGTH,\n          omission = DEFAULT_TRUNC_OMISSION;\n\n      if (isObject(options)) {\n        var separator = 'separator' in options ? options.separator : separator;\n        length = 'length' in options ? toInteger(options.length) : length;\n        omission = 'omission' in options ? baseToString(options.omission) : omission;\n      }\n      string = toString(string);\n\n      var strLength = string.length;\n      if (hasUnicode(string)) {\n        var strSymbols = stringToArray(string);\n        strLength = strSymbols.length;\n      }\n      if (length >= strLength) {\n        return string;\n      }\n      var end = length - stringSize(omission);\n      if (end < 1) {\n        return omission;\n      }\n      var result = strSymbols\n        ? castSlice(strSymbols, 0, end).join('')\n        : string.slice(0, end);\n\n      if (separator === undefined) {\n        return result + omission;\n      }\n      if (strSymbols) {\n        end += (result.length - end);\n      }\n      if (isRegExp(separator)) {\n        if (string.slice(end).search(separator)) {\n          var match,\n              substring = result;\n\n          if (!separator.global) {\n            separator = RegExp(separator.source, toString(reFlags.exec(separator)) + 'g');\n          }\n          separator.lastIndex = 0;\n          while ((match = separator.exec(substring))) {\n            var newEnd = match.index;\n          }\n          result = result.slice(0, newEnd === undefined ? end : newEnd);\n        }\n      } else if (string.indexOf(baseToString(separator), end) != end) {\n        var index = result.lastIndexOf(separator);\n        if (index > -1) {\n          result = result.slice(0, index);\n        }\n      }\n      return result + omission;\n    }\n\n    /**\n     * The inverse of `_.escape`; this method converts the HTML entities\n     * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to\n     * their corresponding characters.\n     *\n     * **Note:** No other HTML entities are unescaped. To unescape additional\n     * HTML entities use a third-party library like [_he_](https://mths.be/he).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.6.0\n     * @category String\n     * @param {string} [string=''] The string to unescape.\n     * @returns {string} Returns the unescaped string.\n     * @example\n     *\n     * _.unescape('fred, barney, &amp; pebbles');\n     * // => 'fred, barney, & pebbles'\n     */\n    function unescape(string) {\n      string = toString(string);\n      return (string && reHasEscapedHtml.test(string))\n        ? string.replace(reEscapedHtml, unescapeHtmlChar)\n        : string;\n    }\n\n    /**\n     * Converts `string`, as space separated words, to upper case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the upper cased string.\n     * @example\n     *\n     * _.upperCase('--foo-bar');\n     * // => 'FOO BAR'\n     *\n     * _.upperCase('fooBar');\n     * // => 'FOO BAR'\n     *\n     * _.upperCase('__foo_bar__');\n     * // => 'FOO BAR'\n     */\n    var upperCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + word.toUpperCase();\n    });\n\n    /**\n     * Converts the first character of `string` to upper case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.upperFirst('fred');\n     * // => 'Fred'\n     *\n     * _.upperFirst('FRED');\n     * // => 'FRED'\n     */\n    var upperFirst = createCaseFirst('toUpperCase');\n\n    /**\n     * Splits `string` into an array of its words.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {RegExp|string} [pattern] The pattern to match words.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the words of `string`.\n     * @example\n     *\n     * _.words('fred, barney, & pebbles');\n     * // => ['fred', 'barney', 'pebbles']\n     *\n     * _.words('fred, barney, & pebbles', /[^, ]+/g);\n     * // => ['fred', 'barney', '&', 'pebbles']\n     */\n    function words(string, pattern, guard) {\n      string = toString(string);\n      pattern = guard ? undefined : pattern;\n\n      if (pattern === undefined) {\n        return hasUnicodeWord(string) ? unicodeWords(string) : asciiWords(string);\n      }\n      return string.match(pattern) || [];\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Attempts to invoke `func`, returning either the result or the caught error\n     * object. Any additional arguments are provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Function} func The function to attempt.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {*} Returns the `func` result or error object.\n     * @example\n     *\n     * // Avoid throwing errors for invalid selectors.\n     * var elements = _.attempt(function(selector) {\n     *   return document.querySelectorAll(selector);\n     * }, '>_>');\n     *\n     * if (_.isError(elements)) {\n     *   elements = [];\n     * }\n     */\n    var attempt = baseRest(function(func, args) {\n      try {\n        return apply(func, undefined, args);\n      } catch (e) {\n        return isError(e) ? e : new Error(e);\n      }\n    });\n\n    /**\n     * Binds methods of an object to the object itself, overwriting the existing\n     * method.\n     *\n     * **Note:** This method doesn't set the \"length\" property of bound functions.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {Object} object The object to bind and assign the bound methods to.\n     * @param {...(string|string[])} methodNames The object method names to bind.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var view = {\n     *   'label': 'docs',\n     *   'click': function() {\n     *     console.log('clicked ' + this.label);\n     *   }\n     * };\n     *\n     * _.bindAll(view, ['click']);\n     * jQuery(element).on('click', view.click);\n     * // => Logs 'clicked docs' when clicked.\n     */\n    var bindAll = flatRest(function(object, methodNames) {\n      arrayEach(methodNames, function(key) {\n        key = toKey(key);\n        baseAssignValue(object, key, bind(object[key], object));\n      });\n      return object;\n    });\n\n    /**\n     * Creates a function that iterates over `pairs` and invokes the corresponding\n     * function of the first predicate to return truthy. The predicate-function\n     * pairs are invoked with the `this` binding and arguments of the created\n     * function.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {Array} pairs The predicate-function pairs.\n     * @returns {Function} Returns the new composite function.\n     * @example\n     *\n     * var func = _.cond([\n     *   [_.matches({ 'a': 1 }),           _.constant('matches A')],\n     *   [_.conforms({ 'b': _.isNumber }), _.constant('matches B')],\n     *   [_.stubTrue,                      _.constant('no match')]\n     * ]);\n     *\n     * func({ 'a': 1, 'b': 2 });\n     * // => 'matches A'\n     *\n     * func({ 'a': 0, 'b': 1 });\n     * // => 'matches B'\n     *\n     * func({ 'a': '1', 'b': '2' });\n     * // => 'no match'\n     */\n    function cond(pairs) {\n      var length = pairs == null ? 0 : pairs.length,\n          toIteratee = getIteratee();\n\n      pairs = !length ? [] : arrayMap(pairs, function(pair) {\n        if (typeof pair[1] != 'function') {\n          throw new TypeError(FUNC_ERROR_TEXT);\n        }\n        return [toIteratee(pair[0]), pair[1]];\n      });\n\n      return baseRest(function(args) {\n        var index = -1;\n        while (++index < length) {\n          var pair = pairs[index];\n          if (apply(pair[0], this, args)) {\n            return apply(pair[1], this, args);\n          }\n        }\n      });\n    }\n\n    /**\n     * Creates a function that invokes the predicate properties of `source` with\n     * the corresponding property values of a given object, returning `true` if\n     * all predicates return truthy, else `false`.\n     *\n     * **Note:** The created function is equivalent to `_.conformsTo` with\n     * `source` partially applied.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 2, 'b': 1 },\n     *   { 'a': 1, 'b': 2 }\n     * ];\n     *\n     * _.filter(objects, _.conforms({ 'b': function(n) { return n > 1; } }));\n     * // => [{ 'a': 1, 'b': 2 }]\n     */\n    function conforms(source) {\n      return baseConforms(baseClone(source, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that returns `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Util\n     * @param {*} value The value to return from the new function.\n     * @returns {Function} Returns the new constant function.\n     * @example\n     *\n     * var objects = _.times(2, _.constant({ 'a': 1 }));\n     *\n     * console.log(objects);\n     * // => [{ 'a': 1 }, { 'a': 1 }]\n     *\n     * console.log(objects[0] === objects[1]);\n     * // => true\n     */\n    function constant(value) {\n      return function() {\n        return value;\n      };\n    }\n\n    /**\n     * Checks `value` to determine whether a default value should be returned in\n     * its place. The `defaultValue` is returned if `value` is `NaN`, `null`,\n     * or `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.14.0\n     * @category Util\n     * @param {*} value The value to check.\n     * @param {*} defaultValue The default value.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * _.defaultTo(1, 10);\n     * // => 1\n     *\n     * _.defaultTo(undefined, 10);\n     * // => 10\n     */\n    function defaultTo(value, defaultValue) {\n      return (value == null || value !== value) ? defaultValue : value;\n    }\n\n    /**\n     * Creates a function that returns the result of invoking the given functions\n     * with the `this` binding of the created function, where each successive\n     * invocation is supplied the return value of the previous.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [funcs] The functions to invoke.\n     * @returns {Function} Returns the new composite function.\n     * @see _.flowRight\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var addSquare = _.flow([_.add, square]);\n     * addSquare(1, 2);\n     * // => 9\n     */\n    var flow = createFlow();\n\n    /**\n     * This method is like `_.flow` except that it creates a function that\n     * invokes the given functions from right to left.\n     *\n     * @static\n     * @since 3.0.0\n     * @memberOf _\n     * @category Util\n     * @param {...(Function|Function[])} [funcs] The functions to invoke.\n     * @returns {Function} Returns the new composite function.\n     * @see _.flow\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var addSquare = _.flowRight([square, _.add]);\n     * addSquare(1, 2);\n     * // => 9\n     */\n    var flowRight = createFlow(true);\n\n    /**\n     * This method returns the first argument it receives.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {*} value Any value.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     *\n     * console.log(_.identity(object) === object);\n     * // => true\n     */\n    function identity(value) {\n      return value;\n    }\n\n    /**\n     * Creates a function that invokes `func` with the arguments of the created\n     * function. If `func` is a property name, the created function returns the\n     * property value for a given element. If `func` is an array or object, the\n     * created function returns `true` for elements that contain the equivalent\n     * source properties, otherwise it returns `false`.\n     *\n     * @static\n     * @since 4.0.0\n     * @memberOf _\n     * @category Util\n     * @param {*} [func=_.identity] The value to convert to a callback.\n     * @returns {Function} Returns the callback.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': true },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.filter(users, _.iteratee({ 'user': 'barney', 'active': true }));\n     * // => [{ 'user': 'barney', 'age': 36, 'active': true }]\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.filter(users, _.iteratee(['user', 'fred']));\n     * // => [{ 'user': 'fred', 'age': 40 }]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.map(users, _.iteratee('user'));\n     * // => ['barney', 'fred']\n     *\n     * // Create custom iteratee shorthands.\n     * _.iteratee = _.wrap(_.iteratee, function(iteratee, func) {\n     *   return !_.isRegExp(func) ? iteratee(func) : function(string) {\n     *     return func.test(string);\n     *   };\n     * });\n     *\n     * _.filter(['abc', 'def'], /ef/);\n     * // => ['def']\n     */\n    function iteratee(func) {\n      return baseIteratee(typeof func == 'function' ? func : baseClone(func, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that performs a partial deep comparison between a given\n     * object and `source`, returning `true` if the given object has equivalent\n     * property values, else `false`.\n     *\n     * **Note:** The created function is equivalent to `_.isMatch` with `source`\n     * partially applied.\n     *\n     * Partial comparisons will match empty array and empty object `source`\n     * values against any array or object value, respectively. See `_.isEqual`\n     * for a list of supported value comparisons.\n     *\n     * **Note:** Multiple values can be checked by combining several matchers\n     * using `_.overSome`\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Object} source The object of property values to match.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 1, 'b': 2, 'c': 3 },\n     *   { 'a': 4, 'b': 5, 'c': 6 }\n     * ];\n     *\n     * _.filter(objects, _.matches({ 'a': 4, 'c': 6 }));\n     * // => [{ 'a': 4, 'b': 5, 'c': 6 }]\n     *\n     * // Checking for several possible values\n     * _.filter(objects, _.overSome([_.matches({ 'a': 1 }), _.matches({ 'a': 4 })]));\n     * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]\n     */\n    function matches(source) {\n      return baseMatches(baseClone(source, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that performs a partial deep comparison between the\n     * value at `path` of a given object to `srcValue`, returning `true` if the\n     * object value is equivalent, else `false`.\n     *\n     * **Note:** Partial comparisons will match empty array and empty object\n     * `srcValue` values against any array or object value, respectively. See\n     * `_.isEqual` for a list of supported value comparisons.\n     *\n     * **Note:** Multiple values can be checked by combining several matchers\n     * using `_.overSome`\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Util\n     * @param {Array|string} path The path of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 1, 'b': 2, 'c': 3 },\n     *   { 'a': 4, 'b': 5, 'c': 6 }\n     * ];\n     *\n     * _.find(objects, _.matchesProperty('a', 4));\n     * // => { 'a': 4, 'b': 5, 'c': 6 }\n     *\n     * // Checking for several possible values\n     * _.filter(objects, _.overSome([_.matchesProperty('a', 1), _.matchesProperty('a', 4)]));\n     * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]\n     */\n    function matchesProperty(path, srcValue) {\n      return baseMatchesProperty(path, baseClone(srcValue, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that invokes the method at `path` of a given object.\n     * Any additional arguments are provided to the invoked method.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Util\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {Function} Returns the new invoker function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': { 'b': _.constant(2) } },\n     *   { 'a': { 'b': _.constant(1) } }\n     * ];\n     *\n     * _.map(objects, _.method('a.b'));\n     * // => [2, 1]\n     *\n     * _.map(objects, _.method(['a', 'b']));\n     * // => [2, 1]\n     */\n    var method = baseRest(function(path, args) {\n      return function(object) {\n        return baseInvoke(object, path, args);\n      };\n    });\n\n    /**\n     * The opposite of `_.method`; this method creates a function that invokes\n     * the method at a given path of `object`. Any additional arguments are\n     * provided to the invoked method.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Util\n     * @param {Object} object The object to query.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {Function} Returns the new invoker function.\n     * @example\n     *\n     * var array = _.times(3, _.constant),\n     *     object = { 'a': array, 'b': array, 'c': array };\n     *\n     * _.map(['a[2]', 'c[0]'], _.methodOf(object));\n     * // => [2, 0]\n     *\n     * _.map([['a', '2'], ['c', '0']], _.methodOf(object));\n     * // => [2, 0]\n     */\n    var methodOf = baseRest(function(object, args) {\n      return function(path) {\n        return baseInvoke(object, path, args);\n      };\n    });\n\n    /**\n     * Adds all own enumerable string keyed function properties of a source\n     * object to the destination object. If `object` is a function, then methods\n     * are added to its prototype as well.\n     *\n     * **Note:** Use `_.runInContext` to create a pristine `lodash` function to\n     * avoid conflicts caused by modifying the original.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {Function|Object} [object=lodash] The destination object.\n     * @param {Object} source The object of functions to add.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.chain=true] Specify whether mixins are chainable.\n     * @returns {Function|Object} Returns `object`.\n     * @example\n     *\n     * function vowels(string) {\n     *   return _.filter(string, function(v) {\n     *     return /[aeiou]/i.test(v);\n     *   });\n     * }\n     *\n     * _.mixin({ 'vowels': vowels });\n     * _.vowels('fred');\n     * // => ['e']\n     *\n     * _('fred').vowels().value();\n     * // => ['e']\n     *\n     * _.mixin({ 'vowels': vowels }, { 'chain': false });\n     * _('fred').vowels();\n     * // => ['e']\n     */\n    function mixin(object, source, options) {\n      var props = keys(source),\n          methodNames = baseFunctions(source, props);\n\n      if (options == null &&\n          !(isObject(source) && (methodNames.length || !props.length))) {\n        options = source;\n        source = object;\n        object = this;\n        methodNames = baseFunctions(source, keys(source));\n      }\n      var chain = !(isObject(options) && 'chain' in options) || !!options.chain,\n          isFunc = isFunction(object);\n\n      arrayEach(methodNames, function(methodName) {\n        var func = source[methodName];\n        object[methodName] = func;\n        if (isFunc) {\n          object.prototype[methodName] = function() {\n            var chainAll = this.__chain__;\n            if (chain || chainAll) {\n              var result = object(this.__wrapped__),\n                  actions = result.__actions__ = copyArray(this.__actions__);\n\n              actions.push({ 'func': func, 'args': arguments, 'thisArg': object });\n              result.__chain__ = chainAll;\n              return result;\n            }\n            return func.apply(object, arrayPush([this.value()], arguments));\n          };\n        }\n      });\n\n      return object;\n    }\n\n    /**\n     * Reverts the `_` variable to its previous value and returns a reference to\n     * the `lodash` function.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @returns {Function} Returns the `lodash` function.\n     * @example\n     *\n     * var lodash = _.noConflict();\n     */\n    function noConflict() {\n      if (root._ === this) {\n        root._ = oldDash;\n      }\n      return this;\n    }\n\n    /**\n     * This method returns `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.3.0\n     * @category Util\n     * @example\n     *\n     * _.times(2, _.noop);\n     * // => [undefined, undefined]\n     */\n    function noop() {\n      // No operation performed.\n    }\n\n    /**\n     * Creates a function that gets the argument at index `n`. If `n` is negative,\n     * the nth argument from the end is returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {number} [n=0] The index of the argument to return.\n     * @returns {Function} Returns the new pass-thru function.\n     * @example\n     *\n     * var func = _.nthArg(1);\n     * func('a', 'b', 'c', 'd');\n     * // => 'b'\n     *\n     * var func = _.nthArg(-2);\n     * func('a', 'b', 'c', 'd');\n     * // => 'c'\n     */\n    function nthArg(n) {\n      n = toInteger(n);\n      return baseRest(function(args) {\n        return baseNth(args, n);\n      });\n    }\n\n    /**\n     * Creates a function that invokes `iteratees` with the arguments it receives\n     * and returns their results.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [iteratees=[_.identity]]\n     *  The iteratees to invoke.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.over([Math.max, Math.min]);\n     *\n     * func(1, 2, 3, 4);\n     * // => [4, 1]\n     */\n    var over = createOver(arrayMap);\n\n    /**\n     * Creates a function that checks if **all** of the `predicates` return\n     * truthy when invoked with the arguments it receives.\n     *\n     * Following shorthands are possible for providing predicates.\n     * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.\n     * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [predicates=[_.identity]]\n     *  The predicates to check.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.overEvery([Boolean, isFinite]);\n     *\n     * func('1');\n     * // => true\n     *\n     * func(null);\n     * // => false\n     *\n     * func(NaN);\n     * // => false\n     */\n    var overEvery = createOver(arrayEvery);\n\n    /**\n     * Creates a function that checks if **any** of the `predicates` return\n     * truthy when invoked with the arguments it receives.\n     *\n     * Following shorthands are possible for providing predicates.\n     * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.\n     * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [predicates=[_.identity]]\n     *  The predicates to check.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.overSome([Boolean, isFinite]);\n     *\n     * func('1');\n     * // => true\n     *\n     * func(null);\n     * // => true\n     *\n     * func(NaN);\n     * // => false\n     *\n     * var matchesFunc = _.overSome([{ 'a': 1 }, { 'a': 2 }])\n     * var matchesPropertyFunc = _.overSome([['a', 1], ['a', 2]])\n     */\n    var overSome = createOver(arraySome);\n\n    /**\n     * Creates a function that returns the value at `path` of a given object.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Util\n     * @param {Array|string} path The path of the property to get.\n     * @returns {Function} Returns the new accessor function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': { 'b': 2 } },\n     *   { 'a': { 'b': 1 } }\n     * ];\n     *\n     * _.map(objects, _.property('a.b'));\n     * // => [2, 1]\n     *\n     * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n     * // => [1, 2]\n     */\n    function property(path) {\n      return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n    }\n\n    /**\n     * The opposite of `_.property`; this method creates a function that returns\n     * the value at a given path of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Object} object The object to query.\n     * @returns {Function} Returns the new accessor function.\n     * @example\n     *\n     * var array = [0, 1, 2],\n     *     object = { 'a': array, 'b': array, 'c': array };\n     *\n     * _.map(['a[2]', 'c[0]'], _.propertyOf(object));\n     * // => [2, 0]\n     *\n     * _.map([['a', '2'], ['c', '0']], _.propertyOf(object));\n     * // => [2, 0]\n     */\n    function propertyOf(object) {\n      return function(path) {\n        return object == null ? undefined : baseGet(object, path);\n      };\n    }\n\n    /**\n     * Creates an array of numbers (positive and/or negative) progressing from\n     * `start` up to, but not including, `end`. A step of `-1` is used if a negative\n     * `start` is specified without an `end` or `step`. If `end` is not specified,\n     * it's set to `start` with `start` then set to `0`.\n     *\n     * **Note:** JavaScript follows the IEEE-754 standard for resolving\n     * floating-point values which can produce unexpected results.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns the range of numbers.\n     * @see _.inRange, _.rangeRight\n     * @example\n     *\n     * _.range(4);\n     * // => [0, 1, 2, 3]\n     *\n     * _.range(-4);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 5);\n     * // => [1, 2, 3, 4]\n     *\n     * _.range(0, 20, 5);\n     * // => [0, 5, 10, 15]\n     *\n     * _.range(0, -4, -1);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.range(0);\n     * // => []\n     */\n    var range = createRange();\n\n    /**\n     * This method is like `_.range` except that it populates values in\n     * descending order.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns the range of numbers.\n     * @see _.inRange, _.range\n     * @example\n     *\n     * _.rangeRight(4);\n     * // => [3, 2, 1, 0]\n     *\n     * _.rangeRight(-4);\n     * // => [-3, -2, -1, 0]\n     *\n     * _.rangeRight(1, 5);\n     * // => [4, 3, 2, 1]\n     *\n     * _.rangeRight(0, 20, 5);\n     * // => [15, 10, 5, 0]\n     *\n     * _.rangeRight(0, -4, -1);\n     * // => [-3, -2, -1, 0]\n     *\n     * _.rangeRight(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.rangeRight(0);\n     * // => []\n     */\n    var rangeRight = createRange(true);\n\n    /**\n     * This method returns a new empty array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {Array} Returns the new empty array.\n     * @example\n     *\n     * var arrays = _.times(2, _.stubArray);\n     *\n     * console.log(arrays);\n     * // => [[], []]\n     *\n     * console.log(arrays[0] === arrays[1]);\n     * // => false\n     */\n    function stubArray() {\n      return [];\n    }\n\n    /**\n     * This method returns `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {boolean} Returns `false`.\n     * @example\n     *\n     * _.times(2, _.stubFalse);\n     * // => [false, false]\n     */\n    function stubFalse() {\n      return false;\n    }\n\n    /**\n     * This method returns a new empty object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {Object} Returns the new empty object.\n     * @example\n     *\n     * var objects = _.times(2, _.stubObject);\n     *\n     * console.log(objects);\n     * // => [{}, {}]\n     *\n     * console.log(objects[0] === objects[1]);\n     * // => false\n     */\n    function stubObject() {\n      return {};\n    }\n\n    /**\n     * This method returns an empty string.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {string} Returns the empty string.\n     * @example\n     *\n     * _.times(2, _.stubString);\n     * // => ['', '']\n     */\n    function stubString() {\n      return '';\n    }\n\n    /**\n     * This method returns `true`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {boolean} Returns `true`.\n     * @example\n     *\n     * _.times(2, _.stubTrue);\n     * // => [true, true]\n     */\n    function stubTrue() {\n      return true;\n    }\n\n    /**\n     * Invokes the iteratee `n` times, returning an array of the results of\n     * each invocation. The iteratee is invoked with one argument; (index).\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {number} n The number of times to invoke `iteratee`.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the array of results.\n     * @example\n     *\n     * _.times(3, String);\n     * // => ['0', '1', '2']\n     *\n     *  _.times(4, _.constant(0));\n     * // => [0, 0, 0, 0]\n     */\n    function times(n, iteratee) {\n      n = toInteger(n);\n      if (n < 1 || n > MAX_SAFE_INTEGER) {\n        return [];\n      }\n      var index = MAX_ARRAY_LENGTH,\n          length = nativeMin(n, MAX_ARRAY_LENGTH);\n\n      iteratee = getIteratee(iteratee);\n      n -= MAX_ARRAY_LENGTH;\n\n      var result = baseTimes(length, iteratee);\n      while (++index < n) {\n        iteratee(index);\n      }\n      return result;\n    }\n\n    /**\n     * Converts `value` to a property path array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {*} value The value to convert.\n     * @returns {Array} Returns the new property path array.\n     * @example\n     *\n     * _.toPath('a.b.c');\n     * // => ['a', 'b', 'c']\n     *\n     * _.toPath('a[0].b.c');\n     * // => ['a', '0', 'b', 'c']\n     */\n    function toPath(value) {\n      if (isArray(value)) {\n        return arrayMap(value, toKey);\n      }\n      return isSymbol(value) ? [value] : copyArray(stringToPath(toString(value)));\n    }\n\n    /**\n     * Generates a unique ID. If `prefix` is given, the ID is appended to it.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {string} [prefix=''] The value to prefix the ID with.\n     * @returns {string} Returns the unique ID.\n     * @example\n     *\n     * _.uniqueId('contact_');\n     * // => 'contact_104'\n     *\n     * _.uniqueId();\n     * // => '105'\n     */\n    function uniqueId(prefix) {\n      var id = ++idCounter;\n      return toString(prefix) + id;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Adds two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.4.0\n     * @category Math\n     * @param {number} augend The first number in an addition.\n     * @param {number} addend The second number in an addition.\n     * @returns {number} Returns the total.\n     * @example\n     *\n     * _.add(6, 4);\n     * // => 10\n     */\n    var add = createMathOperation(function(augend, addend) {\n      return augend + addend;\n    }, 0);\n\n    /**\n     * Computes `number` rounded up to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round up.\n     * @param {number} [precision=0] The precision to round up to.\n     * @returns {number} Returns the rounded up number.\n     * @example\n     *\n     * _.ceil(4.006);\n     * // => 5\n     *\n     * _.ceil(6.004, 2);\n     * // => 6.01\n     *\n     * _.ceil(6040, -2);\n     * // => 6100\n     */\n    var ceil = createRound('ceil');\n\n    /**\n     * Divide two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {number} dividend The first number in a division.\n     * @param {number} divisor The second number in a division.\n     * @returns {number} Returns the quotient.\n     * @example\n     *\n     * _.divide(6, 4);\n     * // => 1.5\n     */\n    var divide = createMathOperation(function(dividend, divisor) {\n      return dividend / divisor;\n    }, 1);\n\n    /**\n     * Computes `number` rounded down to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round down.\n     * @param {number} [precision=0] The precision to round down to.\n     * @returns {number} Returns the rounded down number.\n     * @example\n     *\n     * _.floor(4.006);\n     * // => 4\n     *\n     * _.floor(0.046, 2);\n     * // => 0.04\n     *\n     * _.floor(4060, -2);\n     * // => 4000\n     */\n    var floor = createRound('floor');\n\n    /**\n     * Computes the maximum value of `array`. If `array` is empty or falsey,\n     * `undefined` is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * _.max([4, 2, 8, 6]);\n     * // => 8\n     *\n     * _.max([]);\n     * // => undefined\n     */\n    function max(array) {\n      return (array && array.length)\n        ? baseExtremum(array, identity, baseGt)\n        : undefined;\n    }\n\n    /**\n     * This method is like `_.max` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * the value is ranked. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * var objects = [{ 'n': 1 }, { 'n': 2 }];\n     *\n     * _.maxBy(objects, function(o) { return o.n; });\n     * // => { 'n': 2 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.maxBy(objects, 'n');\n     * // => { 'n': 2 }\n     */\n    function maxBy(array, iteratee) {\n      return (array && array.length)\n        ? baseExtremum(array, getIteratee(iteratee, 2), baseGt)\n        : undefined;\n    }\n\n    /**\n     * Computes the mean of the values in `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {number} Returns the mean.\n     * @example\n     *\n     * _.mean([4, 2, 8, 6]);\n     * // => 5\n     */\n    function mean(array) {\n      return baseMean(array, identity);\n    }\n\n    /**\n     * This method is like `_.mean` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the value to be averaged.\n     * The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the mean.\n     * @example\n     *\n     * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];\n     *\n     * _.meanBy(objects, function(o) { return o.n; });\n     * // => 5\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.meanBy(objects, 'n');\n     * // => 5\n     */\n    function meanBy(array, iteratee) {\n      return baseMean(array, getIteratee(iteratee, 2));\n    }\n\n    /**\n     * Computes the minimum value of `array`. If `array` is empty or falsey,\n     * `undefined` is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * _.min([4, 2, 8, 6]);\n     * // => 2\n     *\n     * _.min([]);\n     * // => undefined\n     */\n    function min(array) {\n      return (array && array.length)\n        ? baseExtremum(array, identity, baseLt)\n        : undefined;\n    }\n\n    /**\n     * This method is like `_.min` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * the value is ranked. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * var objects = [{ 'n': 1 }, { 'n': 2 }];\n     *\n     * _.minBy(objects, function(o) { return o.n; });\n     * // => { 'n': 1 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.minBy(objects, 'n');\n     * // => { 'n': 1 }\n     */\n    function minBy(array, iteratee) {\n      return (array && array.length)\n        ? baseExtremum(array, getIteratee(iteratee, 2), baseLt)\n        : undefined;\n    }\n\n    /**\n     * Multiply two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {number} multiplier The first number in a multiplication.\n     * @param {number} multiplicand The second number in a multiplication.\n     * @returns {number} Returns the product.\n     * @example\n     *\n     * _.multiply(6, 4);\n     * // => 24\n     */\n    var multiply = createMathOperation(function(multiplier, multiplicand) {\n      return multiplier * multiplicand;\n    }, 1);\n\n    /**\n     * Computes `number` rounded to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round.\n     * @param {number} [precision=0] The precision to round to.\n     * @returns {number} Returns the rounded number.\n     * @example\n     *\n     * _.round(4.006);\n     * // => 4\n     *\n     * _.round(4.006, 2);\n     * // => 4.01\n     *\n     * _.round(4060, -2);\n     * // => 4100\n     */\n    var round = createRound('round');\n\n    /**\n     * Subtract two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {number} minuend The first number in a subtraction.\n     * @param {number} subtrahend The second number in a subtraction.\n     * @returns {number} Returns the difference.\n     * @example\n     *\n     * _.subtract(6, 4);\n     * // => 2\n     */\n    var subtract = createMathOperation(function(minuend, subtrahend) {\n      return minuend - subtrahend;\n    }, 0);\n\n    /**\n     * Computes the sum of the values in `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.4.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {number} Returns the sum.\n     * @example\n     *\n     * _.sum([4, 2, 8, 6]);\n     * // => 20\n     */\n    function sum(array) {\n      return (array && array.length)\n        ? baseSum(array, identity)\n        : 0;\n    }\n\n    /**\n     * This method is like `_.sum` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the value to be summed.\n     * The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the sum.\n     * @example\n     *\n     * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];\n     *\n     * _.sumBy(objects, function(o) { return o.n; });\n     * // => 20\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sumBy(objects, 'n');\n     * // => 20\n     */\n    function sumBy(array, iteratee) {\n      return (array && array.length)\n        ? baseSum(array, getIteratee(iteratee, 2))\n        : 0;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    // Add methods that return wrapped values in chain sequences.\n    lodash.after = after;\n    lodash.ary = ary;\n    lodash.assign = assign;\n    lodash.assignIn = assignIn;\n    lodash.assignInWith = assignInWith;\n    lodash.assignWith = assignWith;\n    lodash.at = at;\n    lodash.before = before;\n    lodash.bind = bind;\n    lodash.bindAll = bindAll;\n    lodash.bindKey = bindKey;\n    lodash.castArray = castArray;\n    lodash.chain = chain;\n    lodash.chunk = chunk;\n    lodash.compact = compact;\n    lodash.concat = concat;\n    lodash.cond = cond;\n    lodash.conforms = conforms;\n    lodash.constant = constant;\n    lodash.countBy = countBy;\n    lodash.create = create;\n    lodash.curry = curry;\n    lodash.curryRight = curryRight;\n    lodash.debounce = debounce;\n    lodash.defaults = defaults;\n    lodash.defaultsDeep = defaultsDeep;\n    lodash.defer = defer;\n    lodash.delay = delay;\n    lodash.difference = difference;\n    lodash.differenceBy = differenceBy;\n    lodash.differenceWith = differenceWith;\n    lodash.drop = drop;\n    lodash.dropRight = dropRight;\n    lodash.dropRightWhile = dropRightWhile;\n    lodash.dropWhile = dropWhile;\n    lodash.fill = fill;\n    lodash.filter = filter;\n    lodash.flatMap = flatMap;\n    lodash.flatMapDeep = flatMapDeep;\n    lodash.flatMapDepth = flatMapDepth;\n    lodash.flatten = flatten;\n    lodash.flattenDeep = flattenDeep;\n    lodash.flattenDepth = flattenDepth;\n    lodash.flip = flip;\n    lodash.flow = flow;\n    lodash.flowRight = flowRight;\n    lodash.fromPairs = fromPairs;\n    lodash.functions = functions;\n    lodash.functionsIn = functionsIn;\n    lodash.groupBy = groupBy;\n    lodash.initial = initial;\n    lodash.intersection = intersection;\n    lodash.intersectionBy = intersectionBy;\n    lodash.intersectionWith = intersectionWith;\n    lodash.invert = invert;\n    lodash.invertBy = invertBy;\n    lodash.invokeMap = invokeMap;\n    lodash.iteratee = iteratee;\n    lodash.keyBy = keyBy;\n    lodash.keys = keys;\n    lodash.keysIn = keysIn;\n    lodash.map = map;\n    lodash.mapKeys = mapKeys;\n    lodash.mapValues = mapValues;\n    lodash.matches = matches;\n    lodash.matchesProperty = matchesProperty;\n    lodash.memoize = memoize;\n    lodash.merge = merge;\n    lodash.mergeWith = mergeWith;\n    lodash.method = method;\n    lodash.methodOf = methodOf;\n    lodash.mixin = mixin;\n    lodash.negate = negate;\n    lodash.nthArg = nthArg;\n    lodash.omit = omit;\n    lodash.omitBy = omitBy;\n    lodash.once = once;\n    lodash.orderBy = orderBy;\n    lodash.over = over;\n    lodash.overArgs = overArgs;\n    lodash.overEvery = overEvery;\n    lodash.overSome = overSome;\n    lodash.partial = partial;\n    lodash.partialRight = partialRight;\n    lodash.partition = partition;\n    lodash.pick = pick;\n    lodash.pickBy = pickBy;\n    lodash.property = property;\n    lodash.propertyOf = propertyOf;\n    lodash.pull = pull;\n    lodash.pullAll = pullAll;\n    lodash.pullAllBy = pullAllBy;\n    lodash.pullAllWith = pullAllWith;\n    lodash.pullAt = pullAt;\n    lodash.range = range;\n    lodash.rangeRight = rangeRight;\n    lodash.rearg = rearg;\n    lodash.reject = reject;\n    lodash.remove = remove;\n    lodash.rest = rest;\n    lodash.reverse = reverse;\n    lodash.sampleSize = sampleSize;\n    lodash.set = set;\n    lodash.setWith = setWith;\n    lodash.shuffle = shuffle;\n    lodash.slice = slice;\n    lodash.sortBy = sortBy;\n    lodash.sortedUniq = sortedUniq;\n    lodash.sortedUniqBy = sortedUniqBy;\n    lodash.split = split;\n    lodash.spread = spread;\n    lodash.tail = tail;\n    lodash.take = take;\n    lodash.takeRight = takeRight;\n    lodash.takeRightWhile = takeRightWhile;\n    lodash.takeWhile = takeWhile;\n    lodash.tap = tap;\n    lodash.throttle = throttle;\n    lodash.thru = thru;\n    lodash.toArray = toArray;\n    lodash.toPairs = toPairs;\n    lodash.toPairsIn = toPairsIn;\n    lodash.toPath = toPath;\n    lodash.toPlainObject = toPlainObject;\n    lodash.transform = transform;\n    lodash.unary = unary;\n    lodash.union = union;\n    lodash.unionBy = unionBy;\n    lodash.unionWith = unionWith;\n    lodash.uniq = uniq;\n    lodash.uniqBy = uniqBy;\n    lodash.uniqWith = uniqWith;\n    lodash.unset = unset;\n    lodash.unzip = unzip;\n    lodash.unzipWith = unzipWith;\n    lodash.update = update;\n    lodash.updateWith = updateWith;\n    lodash.values = values;\n    lodash.valuesIn = valuesIn;\n    lodash.without = without;\n    lodash.words = words;\n    lodash.wrap = wrap;\n    lodash.xor = xor;\n    lodash.xorBy = xorBy;\n    lodash.xorWith = xorWith;\n    lodash.zip = zip;\n    lodash.zipObject = zipObject;\n    lodash.zipObjectDeep = zipObjectDeep;\n    lodash.zipWith = zipWith;\n\n    // Add aliases.\n    lodash.entries = toPairs;\n    lodash.entriesIn = toPairsIn;\n    lodash.extend = assignIn;\n    lodash.extendWith = assignInWith;\n\n    // Add methods to `lodash.prototype`.\n    mixin(lodash, lodash);\n\n    /*------------------------------------------------------------------------*/\n\n    // Add methods that return unwrapped values in chain sequences.\n    lodash.add = add;\n    lodash.attempt = attempt;\n    lodash.camelCase = camelCase;\n    lodash.capitalize = capitalize;\n    lodash.ceil = ceil;\n    lodash.clamp = clamp;\n    lodash.clone = clone;\n    lodash.cloneDeep = cloneDeep;\n    lodash.cloneDeepWith = cloneDeepWith;\n    lodash.cloneWith = cloneWith;\n    lodash.conformsTo = conformsTo;\n    lodash.deburr = deburr;\n    lodash.defaultTo = defaultTo;\n    lodash.divide = divide;\n    lodash.endsWith = endsWith;\n    lodash.eq = eq;\n    lodash.escape = escape;\n    lodash.escapeRegExp = escapeRegExp;\n    lodash.every = every;\n    lodash.find = find;\n    lodash.findIndex = findIndex;\n    lodash.findKey = findKey;\n    lodash.findLast = findLast;\n    lodash.findLastIndex = findLastIndex;\n    lodash.findLastKey = findLastKey;\n    lodash.floor = floor;\n    lodash.forEach = forEach;\n    lodash.forEachRight = forEachRight;\n    lodash.forIn = forIn;\n    lodash.forInRight = forInRight;\n    lodash.forOwn = forOwn;\n    lodash.forOwnRight = forOwnRight;\n    lodash.get = get;\n    lodash.gt = gt;\n    lodash.gte = gte;\n    lodash.has = has;\n    lodash.hasIn = hasIn;\n    lodash.head = head;\n    lodash.identity = identity;\n    lodash.includes = includes;\n    lodash.indexOf = indexOf;\n    lodash.inRange = inRange;\n    lodash.invoke = invoke;\n    lodash.isArguments = isArguments;\n    lodash.isArray = isArray;\n    lodash.isArrayBuffer = isArrayBuffer;\n    lodash.isArrayLike = isArrayLike;\n    lodash.isArrayLikeObject = isArrayLikeObject;\n    lodash.isBoolean = isBoolean;\n    lodash.isBuffer = isBuffer;\n    lodash.isDate = isDate;\n    lodash.isElement = isElement;\n    lodash.isEmpty = isEmpty;\n    lodash.isEqual = isEqual;\n    lodash.isEqualWith = isEqualWith;\n    lodash.isError = isError;\n    lodash.isFinite = isFinite;\n    lodash.isFunction = isFunction;\n    lodash.isInteger = isInteger;\n    lodash.isLength = isLength;\n    lodash.isMap = isMap;\n    lodash.isMatch = isMatch;\n    lodash.isMatchWith = isMatchWith;\n    lodash.isNaN = isNaN;\n    lodash.isNative = isNative;\n    lodash.isNil = isNil;\n    lodash.isNull = isNull;\n    lodash.isNumber = isNumber;\n    lodash.isObject = isObject;\n    lodash.isObjectLike = isObjectLike;\n    lodash.isPlainObject = isPlainObject;\n    lodash.isRegExp = isRegExp;\n    lodash.isSafeInteger = isSafeInteger;\n    lodash.isSet = isSet;\n    lodash.isString = isString;\n    lodash.isSymbol = isSymbol;\n    lodash.isTypedArray = isTypedArray;\n    lodash.isUndefined = isUndefined;\n    lodash.isWeakMap = isWeakMap;\n    lodash.isWeakSet = isWeakSet;\n    lodash.join = join;\n    lodash.kebabCase = kebabCase;\n    lodash.last = last;\n    lodash.lastIndexOf = lastIndexOf;\n    lodash.lowerCase = lowerCase;\n    lodash.lowerFirst = lowerFirst;\n    lodash.lt = lt;\n    lodash.lte = lte;\n    lodash.max = max;\n    lodash.maxBy = maxBy;\n    lodash.mean = mean;\n    lodash.meanBy = meanBy;\n    lodash.min = min;\n    lodash.minBy = minBy;\n    lodash.stubArray = stubArray;\n    lodash.stubFalse = stubFalse;\n    lodash.stubObject = stubObject;\n    lodash.stubString = stubString;\n    lodash.stubTrue = stubTrue;\n    lodash.multiply = multiply;\n    lodash.nth = nth;\n    lodash.noConflict = noConflict;\n    lodash.noop = noop;\n    lodash.now = now;\n    lodash.pad = pad;\n    lodash.padEnd = padEnd;\n    lodash.padStart = padStart;\n    lodash.parseInt = parseInt;\n    lodash.random = random;\n    lodash.reduce = reduce;\n    lodash.reduceRight = reduceRight;\n    lodash.repeat = repeat;\n    lodash.replace = replace;\n    lodash.result = result;\n    lodash.round = round;\n    lodash.runInContext = runInContext;\n    lodash.sample = sample;\n    lodash.size = size;\n    lodash.snakeCase = snakeCase;\n    lodash.some = some;\n    lodash.sortedIndex = sortedIndex;\n    lodash.sortedIndexBy = sortedIndexBy;\n    lodash.sortedIndexOf = sortedIndexOf;\n    lodash.sortedLastIndex = sortedLastIndex;\n    lodash.sortedLastIndexBy = sortedLastIndexBy;\n    lodash.sortedLastIndexOf = sortedLastIndexOf;\n    lodash.startCase = startCase;\n    lodash.startsWith = startsWith;\n    lodash.subtract = subtract;\n    lodash.sum = sum;\n    lodash.sumBy = sumBy;\n    lodash.template = template;\n    lodash.times = times;\n    lodash.toFinite = toFinite;\n    lodash.toInteger = toInteger;\n    lodash.toLength = toLength;\n    lodash.toLower = toLower;\n    lodash.toNumber = toNumber;\n    lodash.toSafeInteger = toSafeInteger;\n    lodash.toString = toString;\n    lodash.toUpper = toUpper;\n    lodash.trim = trim;\n    lodash.trimEnd = trimEnd;\n    lodash.trimStart = trimStart;\n    lodash.truncate = truncate;\n    lodash.unescape = unescape;\n    lodash.uniqueId = uniqueId;\n    lodash.upperCase = upperCase;\n    lodash.upperFirst = upperFirst;\n\n    // Add aliases.\n    lodash.each = forEach;\n    lodash.eachRight = forEachRight;\n    lodash.first = head;\n\n    mixin(lodash, (function() {\n      var source = {};\n      baseForOwn(lodash, function(func, methodName) {\n        if (!hasOwnProperty.call(lodash.prototype, methodName)) {\n          source[methodName] = func;\n        }\n      });\n      return source;\n    }()), { 'chain': false });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The semantic version number.\n     *\n     * @static\n     * @memberOf _\n     * @type {string}\n     */\n    lodash.VERSION = VERSION;\n\n    // Assign default placeholders.\n    arrayEach(['bind', 'bindKey', 'curry', 'curryRight', 'partial', 'partialRight'], function(methodName) {\n      lodash[methodName].placeholder = lodash;\n    });\n\n    // Add `LazyWrapper` methods for `_.drop` and `_.take` variants.\n    arrayEach(['drop', 'take'], function(methodName, index) {\n      LazyWrapper.prototype[methodName] = function(n) {\n        n = n === undefined ? 1 : nativeMax(toInteger(n), 0);\n\n        var result = (this.__filtered__ && !index)\n          ? new LazyWrapper(this)\n          : this.clone();\n\n        if (result.__filtered__) {\n          result.__takeCount__ = nativeMin(n, result.__takeCount__);\n        } else {\n          result.__views__.push({\n            'size': nativeMin(n, MAX_ARRAY_LENGTH),\n            'type': methodName + (result.__dir__ < 0 ? 'Right' : '')\n          });\n        }\n        return result;\n      };\n\n      LazyWrapper.prototype[methodName + 'Right'] = function(n) {\n        return this.reverse()[methodName](n).reverse();\n      };\n    });\n\n    // Add `LazyWrapper` methods that accept an `iteratee` value.\n    arrayEach(['filter', 'map', 'takeWhile'], function(methodName, index) {\n      var type = index + 1,\n          isFilter = type == LAZY_FILTER_FLAG || type == LAZY_WHILE_FLAG;\n\n      LazyWrapper.prototype[methodName] = function(iteratee) {\n        var result = this.clone();\n        result.__iteratees__.push({\n          'iteratee': getIteratee(iteratee, 3),\n          'type': type\n        });\n        result.__filtered__ = result.__filtered__ || isFilter;\n        return result;\n      };\n    });\n\n    // Add `LazyWrapper` methods for `_.head` and `_.last`.\n    arrayEach(['head', 'last'], function(methodName, index) {\n      var takeName = 'take' + (index ? 'Right' : '');\n\n      LazyWrapper.prototype[methodName] = function() {\n        return this[takeName](1).value()[0];\n      };\n    });\n\n    // Add `LazyWrapper` methods for `_.initial` and `_.tail`.\n    arrayEach(['initial', 'tail'], function(methodName, index) {\n      var dropName = 'drop' + (index ? '' : 'Right');\n\n      LazyWrapper.prototype[methodName] = function() {\n        return this.__filtered__ ? new LazyWrapper(this) : this[dropName](1);\n      };\n    });\n\n    LazyWrapper.prototype.compact = function() {\n      return this.filter(identity);\n    };\n\n    LazyWrapper.prototype.find = function(predicate) {\n      return this.filter(predicate).head();\n    };\n\n    LazyWrapper.prototype.findLast = function(predicate) {\n      return this.reverse().find(predicate);\n    };\n\n    LazyWrapper.prototype.invokeMap = baseRest(function(path, args) {\n      if (typeof path == 'function') {\n        return new LazyWrapper(this);\n      }\n      return this.map(function(value) {\n        return baseInvoke(value, path, args);\n      });\n    });\n\n    LazyWrapper.prototype.reject = function(predicate) {\n      return this.filter(negate(getIteratee(predicate)));\n    };\n\n    LazyWrapper.prototype.slice = function(start, end) {\n      start = toInteger(start);\n\n      var result = this;\n      if (result.__filtered__ && (start > 0 || end < 0)) {\n        return new LazyWrapper(result);\n      }\n      if (start < 0) {\n        result = result.takeRight(-start);\n      } else if (start) {\n        result = result.drop(start);\n      }\n      if (end !== undefined) {\n        end = toInteger(end);\n        result = end < 0 ? result.dropRight(-end) : result.take(end - start);\n      }\n      return result;\n    };\n\n    LazyWrapper.prototype.takeRightWhile = function(predicate) {\n      return this.reverse().takeWhile(predicate).reverse();\n    };\n\n    LazyWrapper.prototype.toArray = function() {\n      return this.take(MAX_ARRAY_LENGTH);\n    };\n\n    // Add `LazyWrapper` methods to `lodash.prototype`.\n    baseForOwn(LazyWrapper.prototype, function(func, methodName) {\n      var checkIteratee = /^(?:filter|find|map|reject)|While$/.test(methodName),\n          isTaker = /^(?:head|last)$/.test(methodName),\n          lodashFunc = lodash[isTaker ? ('take' + (methodName == 'last' ? 'Right' : '')) : methodName],\n          retUnwrapped = isTaker || /^find/.test(methodName);\n\n      if (!lodashFunc) {\n        return;\n      }\n      lodash.prototype[methodName] = function() {\n        var value = this.__wrapped__,\n            args = isTaker ? [1] : arguments,\n            isLazy = value instanceof LazyWrapper,\n            iteratee = args[0],\n            useLazy = isLazy || isArray(value);\n\n        var interceptor = function(value) {\n          var result = lodashFunc.apply(lodash, arrayPush([value], args));\n          return (isTaker && chainAll) ? result[0] : result;\n        };\n\n        if (useLazy && checkIteratee && typeof iteratee == 'function' && iteratee.length != 1) {\n          // Avoid lazy use if the iteratee has a \"length\" value other than `1`.\n          isLazy = useLazy = false;\n        }\n        var chainAll = this.__chain__,\n            isHybrid = !!this.__actions__.length,\n            isUnwrapped = retUnwrapped && !chainAll,\n            onlyLazy = isLazy && !isHybrid;\n\n        if (!retUnwrapped && useLazy) {\n          value = onlyLazy ? value : new LazyWrapper(this);\n          var result = func.apply(value, args);\n          result.__actions__.push({ 'func': thru, 'args': [interceptor], 'thisArg': undefined });\n          return new LodashWrapper(result, chainAll);\n        }\n        if (isUnwrapped && onlyLazy) {\n          return func.apply(this, args);\n        }\n        result = this.thru(interceptor);\n        return isUnwrapped ? (isTaker ? result.value()[0] : result.value()) : result;\n      };\n    });\n\n    // Add `Array` methods to `lodash.prototype`.\n    arrayEach(['pop', 'push', 'shift', 'sort', 'splice', 'unshift'], function(methodName) {\n      var func = arrayProto[methodName],\n          chainName = /^(?:push|sort|unshift)$/.test(methodName) ? 'tap' : 'thru',\n          retUnwrapped = /^(?:pop|shift)$/.test(methodName);\n\n      lodash.prototype[methodName] = function() {\n        var args = arguments;\n        if (retUnwrapped && !this.__chain__) {\n          var value = this.value();\n          return func.apply(isArray(value) ? value : [], args);\n        }\n        return this[chainName](function(value) {\n          return func.apply(isArray(value) ? value : [], args);\n        });\n      };\n    });\n\n    // Map minified method names to their real names.\n    baseForOwn(LazyWrapper.prototype, function(func, methodName) {\n      var lodashFunc = lodash[methodName];\n      if (lodashFunc) {\n        var key = lodashFunc.name + '';\n        if (!hasOwnProperty.call(realNames, key)) {\n          realNames[key] = [];\n        }\n        realNames[key].push({ 'name': methodName, 'func': lodashFunc });\n      }\n    });\n\n    realNames[createHybrid(undefined, WRAP_BIND_KEY_FLAG).name] = [{\n      'name': 'wrapper',\n      'func': undefined\n    }];\n\n    // Add methods to `LazyWrapper`.\n    LazyWrapper.prototype.clone = lazyClone;\n    LazyWrapper.prototype.reverse = lazyReverse;\n    LazyWrapper.prototype.value = lazyValue;\n\n    // Add chain sequence methods to the `lodash` wrapper.\n    lodash.prototype.at = wrapperAt;\n    lodash.prototype.chain = wrapperChain;\n    lodash.prototype.commit = wrapperCommit;\n    lodash.prototype.next = wrapperNext;\n    lodash.prototype.plant = wrapperPlant;\n    lodash.prototype.reverse = wrapperReverse;\n    lodash.prototype.toJSON = lodash.prototype.valueOf = lodash.prototype.value = wrapperValue;\n\n    // Add lazy aliases.\n    lodash.prototype.first = lodash.prototype.head;\n\n    if (symIterator) {\n      lodash.prototype[symIterator] = wrapperToIterator;\n    }\n    return lodash;\n  });\n\n  /*--------------------------------------------------------------------------*/\n\n  // Export lodash.\n  var _ = runInContext();\n\n  // Some AMD build optimizers, like r.js, check for condition patterns like:\n  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {\n    // Expose Lodash on the global object to prevent errors when Lodash is\n    // loaded by a script tag in the presence of an AMD loader.\n    // See http://requirejs.org/docs/errors.html#mismatch for more details.\n    // Use `_.noConflict` to remove Lodash from the global object.\n    root._ = _;\n\n    // Define as an anonymous module so, through path mapping, it can be\n    // referenced as the \"underscore\" module.\n    define(function() {\n      return _;\n    });\n  }\n  // Check for `exports` after `define` in case a build optimizer adds it.\n  else if (freeModule) {\n    // Export for Node.js.\n    (freeModule.exports = _)._ = _;\n    // Export for CommonJS support.\n    freeExports._ = _;\n  }\n  else {\n    // Export to the global object.\n    root._ = _;\n  }\n}.call(this));\n", "/////////////////////////////////////////////////////////////////////////////////\n/* UAParser.js v1.0.35\n   Copyright \u00A9 2012-2021 Faisal Salman <f@faisalman.com>\n   MIT License *//*\n   Detect Browser, Engine, OS, CPU, and Device type/model from User-Agent data.\n   Supports browser & node.js environment. \n   Demo   : https://faisalman.github.io/ua-parser-js\n   Source : https://github.com/faisalman/ua-parser-js */\n/////////////////////////////////////////////////////////////////////////////////\n\n(function (window, undefined) {\n\n    'use strict';\n\n    //////////////\n    // Constants\n    /////////////\n\n\n    var LIBVERSION  = '1.0.35',\n        EMPTY       = '',\n        UNKNOWN     = '?',\n        FUNC_TYPE   = 'function',\n        UNDEF_TYPE  = 'undefined',\n        OBJ_TYPE    = 'object',\n        STR_TYPE    = 'string',\n        MAJOR       = 'major',\n        MODEL       = 'model',\n        NAME        = 'name',\n        TYPE        = 'type',\n        VENDOR      = 'vendor',\n        VERSION     = 'version',\n        ARCHITECTURE= 'architecture',\n        CONSOLE     = 'console',\n        MOBILE      = 'mobile',\n        TABLET      = 'tablet',\n        SMARTTV     = 'smarttv',\n        WEARABLE    = 'wearable',\n        EMBEDDED    = 'embedded',\n        UA_MAX_LENGTH = 350;\n\n    var AMAZON  = 'Amazon',\n        APPLE   = 'Apple',\n        ASUS    = 'ASUS',\n        BLACKBERRY = 'BlackBerry',\n        BROWSER = 'Browser',\n        CHROME  = 'Chrome',\n        EDGE    = 'Edge',\n        FIREFOX = 'Firefox',\n        GOOGLE  = 'Google',\n        HUAWEI  = 'Huawei',\n        LG      = 'LG',\n        MICROSOFT = 'Microsoft',\n        MOTOROLA  = 'Motorola',\n        OPERA   = 'Opera',\n        SAMSUNG = 'Samsung',\n        SHARP   = 'Sharp',\n        SONY    = 'Sony',\n        VIERA   = 'Viera',\n        XIAOMI  = 'Xiaomi',\n        ZEBRA   = 'Zebra',\n        FACEBOOK    = 'Facebook',\n        CHROMIUM_OS = 'Chromium OS',\n        MAC_OS  = 'Mac OS';\n\n    ///////////\n    // Helper\n    //////////\n\n    var extend = function (regexes, extensions) {\n            var mergedRegexes = {};\n            for (var i in regexes) {\n                if (extensions[i] && extensions[i].length % 2 === 0) {\n                    mergedRegexes[i] = extensions[i].concat(regexes[i]);\n                } else {\n                    mergedRegexes[i] = regexes[i];\n                }\n            }\n            return mergedRegexes;\n        },\n        enumerize = function (arr) {\n            var enums = {};\n            for (var i=0; i<arr.length; i++) {\n                enums[arr[i].toUpperCase()] = arr[i];\n            }\n            return enums;\n        },\n        has = function (str1, str2) {\n            return typeof str1 === STR_TYPE ? lowerize(str2).indexOf(lowerize(str1)) !== -1 : false;\n        },\n        lowerize = function (str) {\n            return str.toLowerCase();\n        },\n        majorize = function (version) {\n            return typeof(version) === STR_TYPE ? version.replace(/[^\\d\\.]/g, EMPTY).split('.')[0] : undefined;\n        },\n        trim = function (str, len) {\n            if (typeof(str) === STR_TYPE) {\n                str = str.replace(/^\\s\\s*/, EMPTY);\n                return typeof(len) === UNDEF_TYPE ? str : str.substring(0, UA_MAX_LENGTH);\n            }\n    };\n\n    ///////////////\n    // Map helper\n    //////////////\n\n    var rgxMapper = function (ua, arrays) {\n\n            var i = 0, j, k, p, q, matches, match;\n\n            // loop through all regexes maps\n            while (i < arrays.length && !matches) {\n\n                var regex = arrays[i],       // even sequence (0,2,4,..)\n                    props = arrays[i + 1];   // odd sequence (1,3,5,..)\n                j = k = 0;\n\n                // try matching uastring with regexes\n                while (j < regex.length && !matches) {\n\n                    if (!regex[j]) { break; }\n                    matches = regex[j++].exec(ua);\n\n                    if (!!matches) {\n                        for (p = 0; p < props.length; p++) {\n                            match = matches[++k];\n                            q = props[p];\n                            // check if given property is actually array\n                            if (typeof q === OBJ_TYPE && q.length > 0) {\n                                if (q.length === 2) {\n                                    if (typeof q[1] == FUNC_TYPE) {\n                                        // assign modified match\n                                        this[q[0]] = q[1].call(this, match);\n                                    } else {\n                                        // assign given value, ignore regex match\n                                        this[q[0]] = q[1];\n                                    }\n                                } else if (q.length === 3) {\n                                    // check whether function or regex\n                                    if (typeof q[1] === FUNC_TYPE && !(q[1].exec && q[1].test)) {\n                                        // call function (usually string mapper)\n                                        this[q[0]] = match ? q[1].call(this, match, q[2]) : undefined;\n                                    } else {\n                                        // sanitize match using given regex\n                                        this[q[0]] = match ? match.replace(q[1], q[2]) : undefined;\n                                    }\n                                } else if (q.length === 4) {\n                                        this[q[0]] = match ? q[3].call(this, match.replace(q[1], q[2])) : undefined;\n                                }\n                            } else {\n                                this[q] = match ? match : undefined;\n                            }\n                        }\n                    }\n                }\n                i += 2;\n            }\n        },\n\n        strMapper = function (str, map) {\n\n            for (var i in map) {\n                // check if current value is array\n                if (typeof map[i] === OBJ_TYPE && map[i].length > 0) {\n                    for (var j = 0; j < map[i].length; j++) {\n                        if (has(map[i][j], str)) {\n                            return (i === UNKNOWN) ? undefined : i;\n                        }\n                    }\n                } else if (has(map[i], str)) {\n                    return (i === UNKNOWN) ? undefined : i;\n                }\n            }\n            return str;\n    };\n\n    ///////////////\n    // String map\n    //////////////\n\n    // Safari < 3.0\n    var oldSafariMap = {\n            '1.0'   : '/8',\n            '1.2'   : '/1',\n            '1.3'   : '/3',\n            '2.0'   : '/412',\n            '2.0.2' : '/416',\n            '2.0.3' : '/417',\n            '2.0.4' : '/419',\n            '?'     : '/'\n        },\n        windowsVersionMap = {\n            'ME'        : '4.90',\n            'NT 3.11'   : 'NT3.51',\n            'NT 4.0'    : 'NT4.0',\n            '2000'      : 'NT 5.0',\n            'XP'        : ['NT 5.1', 'NT 5.2'],\n            'Vista'     : 'NT 6.0',\n            '7'         : 'NT 6.1',\n            '8'         : 'NT 6.2',\n            '8.1'       : 'NT 6.3',\n            '10'        : ['NT 6.4', 'NT 10.0'],\n            'RT'        : 'ARM'\n    };\n\n    //////////////\n    // Regex map\n    /////////////\n\n    var regexes = {\n\n        browser : [[\n\n            /\\b(?:crmo|crios)\\/([\\w\\.]+)/i                                      // Chrome for Android/iOS\n            ], [VERSION, [NAME, 'Chrome']], [\n            /edg(?:e|ios|a)?\\/([\\w\\.]+)/i                                       // Microsoft Edge\n            ], [VERSION, [NAME, 'Edge']], [\n\n            // Presto based\n            /(opera mini)\\/([-\\w\\.]+)/i,                                        // Opera Mini\n            /(opera [mobiletab]{3,6})\\b.+version\\/([-\\w\\.]+)/i,                 // Opera Mobi/Tablet\n            /(opera)(?:.+version\\/|[\\/ ]+)([\\w\\.]+)/i                           // Opera\n            ], [NAME, VERSION], [\n            /opios[\\/ ]+([\\w\\.]+)/i                                             // Opera mini on iphone >= 8.0\n            ], [VERSION, [NAME, OPERA+' Mini']], [\n            /\\bopr\\/([\\w\\.]+)/i                                                 // Opera Webkit\n            ], [VERSION, [NAME, OPERA]], [\n\n            // Mixed\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /(lunascape|maxthon|netfront|jasmine|blazer)[\\/ ]?([\\w\\.]*)/i,      // Lunascape/Maxthon/Netfront/Jasmine/Blazer\n            // Trident based\n            /(avant |iemobile|slim)(?:browser)?[\\/ ]?([\\w\\.]*)/i,               // Avant/IEMobile/SlimBrowser\n            /(ba?idubrowser)[\\/ ]?([\\w\\.]+)/i,                                  // Baidu Browser\n            /(?:ms|\\()(ie) ([\\w\\.]+)/i,                                         // Internet Explorer\n\n            // Webkit/KHTML based                                               // Flock/RockMelt/Midori/Epiphany/Silk/Skyfire/Bolt/Iron/Iridium/PhantomJS/Bowser/QupZilla/Falkon\n            /(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\\/([-\\w\\.]+)/i,\n                                                                                // Rekonq/Puffin/Brave/Whale/QQBrowserLite/QQ, aka ShouQ\n            /(heytap|ovi)browser\\/([\\d\\.]+)/i,                                  // Heytap/Ovi\n            /(weibo)__([\\d\\.]+)/i                                               // Weibo\n            ], [NAME, VERSION], [\n            /(?:\\buc? ?browser|(?:juc.+)ucweb)[\\/ ]?([\\w\\.]+)/i                 // UCBrowser\n            ], [VERSION, [NAME, 'UC'+BROWSER]], [\n            /microm.+\\bqbcore\\/([\\w\\.]+)/i,                                     // WeChat Desktop for Windows Built-in Browser\n            /\\bqbcore\\/([\\w\\.]+).+microm/i\n            ], [VERSION, [NAME, 'WeChat(Win) Desktop']], [\n            /micromessenger\\/([\\w\\.]+)/i                                        // WeChat\n            ], [VERSION, [NAME, 'WeChat']], [\n            /konqueror\\/([\\w\\.]+)/i                                             // Konqueror\n            ], [VERSION, [NAME, 'Konqueror']], [\n            /trident.+rv[: ]([\\w\\.]{1,9})\\b.+like gecko/i                       // IE11\n            ], [VERSION, [NAME, 'IE']], [\n            /ya(?:search)?browser\\/([\\w\\.]+)/i                                  // Yandex\n            ], [VERSION, [NAME, 'Yandex']], [\n            /(avast|avg)\\/([\\w\\.]+)/i                                           // Avast/AVG Secure Browser\n            ], [[NAME, /(.+)/, '$1 Secure '+BROWSER], VERSION], [\n            /\\bfocus\\/([\\w\\.]+)/i                                               // Firefox Focus\n            ], [VERSION, [NAME, FIREFOX+' Focus']], [\n            /\\bopt\\/([\\w\\.]+)/i                                                 // Opera Touch\n            ], [VERSION, [NAME, OPERA+' Touch']], [\n            /coc_coc\\w+\\/([\\w\\.]+)/i                                            // Coc Coc Browser\n            ], [VERSION, [NAME, 'Coc Coc']], [\n            /dolfin\\/([\\w\\.]+)/i                                                // Dolphin\n            ], [VERSION, [NAME, 'Dolphin']], [\n            /coast\\/([\\w\\.]+)/i                                                 // Opera Coast\n            ], [VERSION, [NAME, OPERA+' Coast']], [\n            /miuibrowser\\/([\\w\\.]+)/i                                           // MIUI Browser\n            ], [VERSION, [NAME, 'MIUI '+BROWSER]], [\n            /fxios\\/([-\\w\\.]+)/i                                                // Firefox for iOS\n            ], [VERSION, [NAME, FIREFOX]], [\n            /\\bqihu|(qi?ho?o?|360)browser/i                                     // 360\n            ], [[NAME, '360 '+BROWSER]], [\n            /(oculus|samsung|sailfish|huawei)browser\\/([\\w\\.]+)/i\n            ], [[NAME, /(.+)/, '$1 '+BROWSER], VERSION], [                      // Oculus/Samsung/Sailfish/Huawei Browser\n            /(comodo_dragon)\\/([\\w\\.]+)/i                                       // Comodo Dragon\n            ], [[NAME, /_/g, ' '], VERSION], [\n            /(electron)\\/([\\w\\.]+) safari/i,                                    // Electron-based App\n            /(tesla)(?: qtcarbrowser|\\/(20\\d\\d\\.[-\\w\\.]+))/i,                   // Tesla\n            /m?(qqbrowser|baiduboxapp|2345Explorer)[\\/ ]?([\\w\\.]+)/i            // QQBrowser/Baidu App/2345 Browser\n            ], [NAME, VERSION], [\n            /(metasr)[\\/ ]?([\\w\\.]+)/i,                                         // SouGouBrowser\n            /(lbbrowser)/i,                                                     // LieBao Browser\n            /\\[(linkedin)app\\]/i                                                // LinkedIn App for iOS & Android\n            ], [NAME], [\n\n            // WebView\n            /((?:fban\\/fbios|fb_iab\\/fb4a)(?!.+fbav)|;fbav\\/([\\w\\.]+);)/i       // Facebook App for iOS & Android\n            ], [[NAME, FACEBOOK], VERSION], [\n            /(kakao(?:talk|story))[\\/ ]([\\w\\.]+)/i,                             // Kakao App\n            /(naver)\\(.*?(\\d+\\.[\\w\\.]+).*\\)/i,                                  // Naver InApp\n            /safari (line)\\/([\\w\\.]+)/i,                                        // Line App for iOS\n            /\\b(line)\\/([\\w\\.]+)\\/iab/i,                                        // Line App for Android\n            /(chromium|instagram)[\\/ ]([-\\w\\.]+)/i                              // Chromium/Instagram\n            ], [NAME, VERSION], [\n            /\\bgsa\\/([\\w\\.]+) .*safari\\//i                                      // Google Search Appliance on iOS\n            ], [VERSION, [NAME, 'GSA']], [\n            /musical_ly(?:.+app_?version\\/|_)([\\w\\.]+)/i                        // TikTok\n            ], [VERSION, [NAME, 'TikTok']], [\n\n            /headlesschrome(?:\\/([\\w\\.]+)| )/i                                  // Chrome Headless\n            ], [VERSION, [NAME, CHROME+' Headless']], [\n\n            / wv\\).+(chrome)\\/([\\w\\.]+)/i                                       // Chrome WebView\n            ], [[NAME, CHROME+' WebView'], VERSION], [\n\n            /droid.+ version\\/([\\w\\.]+)\\b.+(?:mobile safari|safari)/i           // Android Browser\n            ], [VERSION, [NAME, 'Android '+BROWSER]], [\n\n            /(chrome|omniweb|arora|[tizenoka]{5} ?browser)\\/v?([\\w\\.]+)/i       // Chrome/OmniWeb/Arora/Tizen/Nokia\n            ], [NAME, VERSION], [\n\n            /version\\/([\\w\\.\\,]+) .*mobile\\/\\w+ (safari)/i                      // Mobile Safari\n            ], [VERSION, [NAME, 'Mobile Safari']], [\n            /version\\/([\\w(\\.|\\,)]+) .*(mobile ?safari|safari)/i                // Safari & Safari Mobile\n            ], [VERSION, NAME], [\n            /webkit.+?(mobile ?safari|safari)(\\/[\\w\\.]+)/i                      // Safari < 3.0\n            ], [NAME, [VERSION, strMapper, oldSafariMap]], [\n\n            /(webkit|khtml)\\/([\\w\\.]+)/i\n            ], [NAME, VERSION], [\n\n            // Gecko based\n            /(navigator|netscape\\d?)\\/([-\\w\\.]+)/i                              // Netscape\n            ], [[NAME, 'Netscape'], VERSION], [\n            /mobile vr; rv:([\\w\\.]+)\\).+firefox/i                               // Firefox Reality\n            ], [VERSION, [NAME, FIREFOX+' Reality']], [\n            /ekiohf.+(flow)\\/([\\w\\.]+)/i,                                       // Flow\n            /(swiftfox)/i,                                                      // Swiftfox\n            /(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\\/ ]?([\\w\\.\\+]+)/i,\n                                                                                // IceDragon/Iceweasel/Camino/Chimera/Fennec/Maemo/Minimo/Conkeror/Klar\n            /(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\\/([-\\w\\.]+)$/i,\n                                                                                // Firefox/SeaMonkey/K-Meleon/IceCat/IceApe/Firebird/Phoenix\n            /(firefox)\\/([\\w\\.]+)/i,                                            // Other Firefox-based\n            /(mozilla)\\/([\\w\\.]+) .+rv\\:.+gecko\\/\\d+/i,                         // Mozilla\n\n            // Other\n            /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\\. ]?browser)[-\\/ ]?v?([\\w\\.]+)/i,\n                                                                                // Polaris/Lynx/Dillo/iCab/Doris/Amaya/w3m/NetSurf/Sleipnir/Obigo/Mosaic/Go/ICE/UP.Browser\n            /(links) \\(([\\w\\.]+)/i,                                             // Links\n            /panasonic;(viera)/i                                                // Panasonic Viera\n            ], [NAME, VERSION], [\n            \n            /(cobalt)\\/([\\w\\.]+)/i                                              // Cobalt\n            ], [NAME, [VERSION, /master.|lts./, \"\"]]\n        ],\n\n        cpu : [[\n\n            /(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\\)]/i                     // AMD64 (x64)\n            ], [[ARCHITECTURE, 'amd64']], [\n\n            /(ia32(?=;))/i                                                      // IA32 (quicktime)\n            ], [[ARCHITECTURE, lowerize]], [\n\n            /((?:i[346]|x)86)[;\\)]/i                                            // IA32 (x86)\n            ], [[ARCHITECTURE, 'ia32']], [\n\n            /\\b(aarch64|arm(v?8e?l?|_?64))\\b/i                                 // ARM64\n            ], [[ARCHITECTURE, 'arm64']], [\n\n            /\\b(arm(?:v[67])?ht?n?[fl]p?)\\b/i                                   // ARMHF\n            ], [[ARCHITECTURE, 'armhf']], [\n\n            // PocketPC mistakenly identified as PowerPC\n            /windows (ce|mobile); ppc;/i\n            ], [[ARCHITECTURE, 'arm']], [\n\n            /((?:ppc|powerpc)(?:64)?)(?: mac|;|\\))/i                            // PowerPC\n            ], [[ARCHITECTURE, /ower/, EMPTY, lowerize]], [\n\n            /(sun4\\w)[;\\)]/i                                                    // SPARC\n            ], [[ARCHITECTURE, 'sparc']], [\n\n            /((?:avr32|ia64(?=;))|68k(?=\\))|\\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\\b|pa-risc)/i\n                                                                                // IA64, 68K, ARM/64, AVR/32, IRIX/64, MIPS/64, SPARC/64, PA-RISC\n            ], [[ARCHITECTURE, lowerize]]\n        ],\n\n        device : [[\n\n            //////////////////////////\n            // MOBILES & TABLETS\n            /////////////////////////\n\n            // Samsung\n            /\\b(sch-i[89]0\\d|shw-m380s|sm-[ptx]\\w{2,4}|gt-[pn]\\d{2,4}|sgh-t8[56]9|nexus 10)/i\n            ], [MODEL, [VENDOR, SAMSUNG], [TYPE, TABLET]], [\n            /\\b((?:s[cgp]h|gt|sm)-\\w+|sc[g-]?[\\d]+a?|galaxy nexus)/i,\n            /samsung[- ]([-\\w]+)/i,\n            /sec-(sgh\\w+)/i\n            ], [MODEL, [VENDOR, SAMSUNG], [TYPE, MOBILE]], [\n\n            // Apple\n            /(?:\\/|\\()(ip(?:hone|od)[\\w, ]*)(?:\\/|;)/i                          // iPod/iPhone\n            ], [MODEL, [VENDOR, APPLE], [TYPE, MOBILE]], [\n            /\\((ipad);[-\\w\\),; ]+apple/i,                                       // iPad\n            /applecoremedia\\/[\\w\\.]+ \\((ipad)/i,\n            /\\b(ipad)\\d\\d?,\\d\\d?[;\\]].+ios/i\n            ], [MODEL, [VENDOR, APPLE], [TYPE, TABLET]], [\n            /(macintosh);/i\n            ], [MODEL, [VENDOR, APPLE]], [\n\n            // Sharp\n            /\\b(sh-?[altvz]?\\d\\d[a-ekm]?)/i\n            ], [MODEL, [VENDOR, SHARP], [TYPE, MOBILE]], [\n\n            // Huawei\n            /\\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\\d{2})\\b(?!.+d\\/s)/i\n            ], [MODEL, [VENDOR, HUAWEI], [TYPE, TABLET]], [\n            /(?:huawei|honor)([-\\w ]+)[;\\)]/i,\n            /\\b(nexus 6p|\\w{2,4}e?-[atu]?[ln][\\dx][012359c][adn]?)\\b(?!.+d\\/s)/i\n            ], [MODEL, [VENDOR, HUAWEI], [TYPE, MOBILE]], [\n\n            // Xiaomi\n            /\\b(poco[\\w ]+)(?: bui|\\))/i,                                       // Xiaomi POCO\n            /\\b; (\\w+) build\\/hm\\1/i,                                           // Xiaomi Hongmi 'numeric' models\n            /\\b(hm[-_ ]?note?[_ ]?(?:\\d\\w)?) bui/i,                             // Xiaomi Hongmi\n            /\\b(redmi[\\-_ ]?(?:note|k)?[\\w_ ]+)(?: bui|\\))/i,                   // Xiaomi Redmi\n            /\\b(mi[-_ ]?(?:a\\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\\d?\\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\\))/i // Xiaomi Mi\n            ], [[MODEL, /_/g, ' '], [VENDOR, XIAOMI], [TYPE, MOBILE]], [\n            /\\b(mi[-_ ]?(?:pad)(?:[\\w_ ]+))(?: bui|\\))/i                        // Mi Pad tablets\n            ],[[MODEL, /_/g, ' '], [VENDOR, XIAOMI], [TYPE, TABLET]], [\n\n            // OPPO\n            /; (\\w+) bui.+ oppo/i,\n            /\\b(cph[12]\\d{3}|p(?:af|c[al]|d\\w|e[ar])[mt]\\d0|x9007|a101op)\\b/i\n            ], [MODEL, [VENDOR, 'OPPO'], [TYPE, MOBILE]], [\n\n            // Vivo\n            /vivo (\\w+)(?: bui|\\))/i,\n            /\\b(v[12]\\d{3}\\w?[at])(?: bui|;)/i\n            ], [MODEL, [VENDOR, 'Vivo'], [TYPE, MOBILE]], [\n\n            // Realme\n            /\\b(rmx[12]\\d{3})(?: bui|;|\\))/i\n            ], [MODEL, [VENDOR, 'Realme'], [TYPE, MOBILE]], [\n\n            // Motorola\n            /\\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\\b[\\w ]+build\\//i,\n            /\\bmot(?:orola)?[- ](\\w*)/i,\n            /((?:moto[\\w\\(\\) ]+|xt\\d{3,4}|nexus 6)(?= bui|\\)))/i\n            ], [MODEL, [VENDOR, MOTOROLA], [TYPE, MOBILE]], [\n            /\\b(mz60\\d|xoom[2 ]{0,2}) build\\//i\n            ], [MODEL, [VENDOR, MOTOROLA], [TYPE, TABLET]], [\n\n            // LG\n            /((?=lg)?[vl]k\\-?\\d{3}) bui| 3\\.[-\\w; ]{10}lg?-([06cv9]{3,4})/i\n            ], [MODEL, [VENDOR, LG], [TYPE, TABLET]], [\n            /(lm(?:-?f100[nv]?|-[\\w\\.]+)(?= bui|\\))|nexus [45])/i,\n            /\\blg[-e;\\/ ]+((?!browser|netcast|android tv)\\w+)/i,\n            /\\blg-?([\\d\\w]+) bui/i\n            ], [MODEL, [VENDOR, LG], [TYPE, MOBILE]], [\n\n            // Lenovo\n            /(ideatab[-\\w ]+)/i,\n            /lenovo ?(s[56]000[-\\w]+|tab(?:[\\w ]+)|yt[-\\d\\w]{6}|tb[-\\d\\w]{6})/i\n            ], [MODEL, [VENDOR, 'Lenovo'], [TYPE, TABLET]], [\n\n            // Nokia\n            /(?:maemo|nokia).*(n900|lumia \\d+)/i,\n            /nokia[-_ ]?([-\\w\\.]*)/i\n            ], [[MODEL, /_/g, ' '], [VENDOR, 'Nokia'], [TYPE, MOBILE]], [\n\n            // Google\n            /(pixel c)\\b/i                                                      // Google Pixel C\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, TABLET]], [\n            /droid.+; (pixel[\\daxl ]{0,6})(?: bui|\\))/i                         // Google Pixel\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, MOBILE]], [\n\n            // Sony\n            /droid.+ (a?\\d[0-2]{2}so|[c-g]\\d{4}|so[-gl]\\w+|xq-a\\w[4-7][12])(?= bui|\\).+chrome\\/(?![1-6]{0,1}\\d\\.))/i\n            ], [MODEL, [VENDOR, SONY], [TYPE, MOBILE]], [\n            /sony tablet [ps]/i,\n            /\\b(?:sony)?sgp\\w+(?: bui|\\))/i\n            ], [[MODEL, 'Xperia Tablet'], [VENDOR, SONY], [TYPE, TABLET]], [\n\n            // OnePlus\n            / (kb2005|in20[12]5|be20[12][59])\\b/i,\n            /(?:one)?(?:plus)? (a\\d0\\d\\d)(?: b|\\))/i\n            ], [MODEL, [VENDOR, 'OnePlus'], [TYPE, MOBILE]], [\n\n            // Amazon\n            /(alexa)webm/i,\n            /(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\\))/i,                             // Kindle Fire without Silk / Echo Show\n            /(kf[a-z]+)( bui|\\)).+silk\\//i                                      // Kindle Fire HD\n            ], [MODEL, [VENDOR, AMAZON], [TYPE, TABLET]], [\n            /((?:sd|kf)[0349hijorstuw]+)( bui|\\)).+silk\\//i                     // Fire Phone\n            ], [[MODEL, /(.+)/g, 'Fire Phone $1'], [VENDOR, AMAZON], [TYPE, MOBILE]], [\n\n            // BlackBerry\n            /(playbook);[-\\w\\),; ]+(rim)/i                                      // BlackBerry PlayBook\n            ], [MODEL, VENDOR, [TYPE, TABLET]], [\n            /\\b((?:bb[a-f]|st[hv])100-\\d)/i,\n            /\\(bb10; (\\w+)/i                                                    // BlackBerry 10\n            ], [MODEL, [VENDOR, BLACKBERRY], [TYPE, MOBILE]], [\n\n            // Asus\n            /(?:\\b|asus_)(transfo[prime ]{4,10} \\w+|eeepc|slider \\w+|nexus 7|padfone|p00[cj])/i\n            ], [MODEL, [VENDOR, ASUS], [TYPE, TABLET]], [\n            / (z[bes]6[027][012][km][ls]|zenfone \\d\\w?)\\b/i\n            ], [MODEL, [VENDOR, ASUS], [TYPE, MOBILE]], [\n\n            // HTC\n            /(nexus 9)/i                                                        // HTC Nexus 9\n            ], [MODEL, [VENDOR, 'HTC'], [TYPE, TABLET]], [\n            /(htc)[-;_ ]{1,2}([\\w ]+(?=\\)| bui)|\\w+)/i,                         // HTC\n\n            // ZTE\n            /(zte)[- ]([\\w ]+?)(?: bui|\\/|\\))/i,\n            /(alcatel|geeksphone|nexian|panasonic(?!(?:;|\\.))|sony(?!-bra))[-_ ]?([-\\w]*)/i         // Alcatel/GeeksPhone/Nexian/Panasonic/Sony\n            ], [VENDOR, [MODEL, /_/g, ' '], [TYPE, MOBILE]], [\n\n            // Acer\n            /droid.+; ([ab][1-7]-?[0178a]\\d\\d?)/i\n            ], [MODEL, [VENDOR, 'Acer'], [TYPE, TABLET]], [\n\n            // Meizu\n            /droid.+; (m[1-5] note) bui/i,\n            /\\bmz-([-\\w]{2,})/i\n            ], [MODEL, [VENDOR, 'Meizu'], [TYPE, MOBILE]], [\n\n            // MIXED\n            /(blackberry|benq|palm(?=\\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\\w]*)/i,\n                                                                                // BlackBerry/BenQ/Palm/Sony-Ericsson/Acer/Asus/Dell/Meizu/Motorola/Polytron\n            /(hp) ([\\w ]+\\w)/i,                                                 // HP iPAQ\n            /(asus)-?(\\w+)/i,                                                   // Asus\n            /(microsoft); (lumia[\\w ]+)/i,                                      // Microsoft Lumia\n            /(lenovo)[-_ ]?([-\\w]+)/i,                                          // Lenovo\n            /(jolla)/i,                                                         // Jolla\n            /(oppo) ?([\\w ]+) bui/i                                             // OPPO\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n\n            /(kobo)\\s(ereader|touch)/i,                                         // Kobo\n            /(archos) (gamepad2?)/i,                                            // Archos\n            /(hp).+(touchpad(?!.+tablet)|tablet)/i,                             // HP TouchPad\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /(nook)[\\w ]+build\\/(\\w+)/i,                                        // Nook\n            /(dell) (strea[kpr\\d ]*[\\dko])/i,                                   // Dell Streak\n            /(le[- ]+pan)[- ]+(\\w{1,9}) bui/i,                                  // Le Pan Tablets\n            /(trinity)[- ]*(t\\d{3}) bui/i,                                      // Trinity Tablets\n            /(gigaset)[- ]+(q\\w{1,9}) bui/i,                                    // Gigaset Tablets\n            /(vodafone) ([\\w ]+)(?:\\)| bui)/i                                   // Vodafone\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n\n            /(surface duo)/i                                                    // Surface Duo\n            ], [MODEL, [VENDOR, MICROSOFT], [TYPE, TABLET]], [\n            /droid [\\d\\.]+; (fp\\du?)(?: b|\\))/i                                 // Fairphone\n            ], [MODEL, [VENDOR, 'Fairphone'], [TYPE, MOBILE]], [\n            /(u304aa)/i                                                         // AT&T\n            ], [MODEL, [VENDOR, 'AT&T'], [TYPE, MOBILE]], [\n            /\\bsie-(\\w*)/i                                                      // Siemens\n            ], [MODEL, [VENDOR, 'Siemens'], [TYPE, MOBILE]], [\n            /\\b(rct\\w+) b/i                                                     // RCA Tablets\n            ], [MODEL, [VENDOR, 'RCA'], [TYPE, TABLET]], [\n            /\\b(venue[\\d ]{2,7}) b/i                                            // Dell Venue Tablets\n            ], [MODEL, [VENDOR, 'Dell'], [TYPE, TABLET]], [\n            /\\b(q(?:mv|ta)\\w+) b/i                                              // Verizon Tablet\n            ], [MODEL, [VENDOR, 'Verizon'], [TYPE, TABLET]], [\n            /\\b(?:barnes[& ]+noble |bn[rt])([\\w\\+ ]*) b/i                       // Barnes & Noble Tablet\n            ], [MODEL, [VENDOR, 'Barnes & Noble'], [TYPE, TABLET]], [\n            /\\b(tm\\d{3}\\w+) b/i\n            ], [MODEL, [VENDOR, 'NuVision'], [TYPE, TABLET]], [\n            /\\b(k88) b/i                                                        // ZTE K Series Tablet\n            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, TABLET]], [\n            /\\b(nx\\d{3}j) b/i                                                   // ZTE Nubia\n            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, MOBILE]], [\n            /\\b(gen\\d{3}) b.+49h/i                                              // Swiss GEN Mobile\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, MOBILE]], [\n            /\\b(zur\\d{3}) b/i                                                   // Swiss ZUR Tablet\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, TABLET]], [\n            /\\b((zeki)?tb.*\\b) b/i                                              // Zeki Tablets\n            ], [MODEL, [VENDOR, 'Zeki'], [TYPE, TABLET]], [\n            /\\b([yr]\\d{2}) b/i,\n            /\\b(dragon[- ]+touch |dt)(\\w{5}) b/i                                // Dragon Touch Tablet\n            ], [[VENDOR, 'Dragon Touch'], MODEL, [TYPE, TABLET]], [\n            /\\b(ns-?\\w{0,9}) b/i                                                // Insignia Tablets\n            ], [MODEL, [VENDOR, 'Insignia'], [TYPE, TABLET]], [\n            /\\b((nxa|next)-?\\w{0,9}) b/i                                        // NextBook Tablets\n            ], [MODEL, [VENDOR, 'NextBook'], [TYPE, TABLET]], [\n            /\\b(xtreme\\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i                  // Voice Xtreme Phones\n            ], [[VENDOR, 'Voice'], MODEL, [TYPE, MOBILE]], [\n            /\\b(lvtel\\-)?(v1[12]) b/i                                           // LvTel Phones\n            ], [[VENDOR, 'LvTel'], MODEL, [TYPE, MOBILE]], [\n            /\\b(ph-1) /i                                                        // Essential PH-1\n            ], [MODEL, [VENDOR, 'Essential'], [TYPE, MOBILE]], [\n            /\\b(v(100md|700na|7011|917g).*\\b) b/i                               // Envizen Tablets\n            ], [MODEL, [VENDOR, 'Envizen'], [TYPE, TABLET]], [\n            /\\b(trio[-\\w\\. ]+) b/i                                              // MachSpeed Tablets\n            ], [MODEL, [VENDOR, 'MachSpeed'], [TYPE, TABLET]], [\n            /\\btu_(1491) b/i                                                    // Rotor Tablets\n            ], [MODEL, [VENDOR, 'Rotor'], [TYPE, TABLET]], [\n            /(shield[\\w ]+) b/i                                                 // Nvidia Shield Tablets\n            ], [MODEL, [VENDOR, 'Nvidia'], [TYPE, TABLET]], [\n            /(sprint) (\\w+)/i                                                   // Sprint Phones\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n            /(kin\\.[onetw]{3})/i                                                // Microsoft Kin\n            ], [[MODEL, /\\./g, ' '], [VENDOR, MICROSOFT], [TYPE, MOBILE]], [\n            /droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\\)/i             // Zebra\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, TABLET]], [\n            /droid.+; (ec30|ps20|tc[2-8]\\d[kx])\\)/i\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, MOBILE]], [\n\n            ///////////////////\n            // SMARTTVS\n            ///////////////////\n\n            /smart-tv.+(samsung)/i                                              // Samsung\n            ], [VENDOR, [TYPE, SMARTTV]], [\n            /hbbtv.+maple;(\\d+)/i\n            ], [[MODEL, /^/, 'SmartTV'], [VENDOR, SAMSUNG], [TYPE, SMARTTV]], [\n            /(nux; netcast.+smarttv|lg (netcast\\.tv-201\\d|android tv))/i        // LG SmartTV\n            ], [[VENDOR, LG], [TYPE, SMARTTV]], [\n            /(apple) ?tv/i                                                      // Apple TV\n            ], [VENDOR, [MODEL, APPLE+' TV'], [TYPE, SMARTTV]], [\n            /crkey/i                                                            // Google Chromecast\n            ], [[MODEL, CHROME+'cast'], [VENDOR, GOOGLE], [TYPE, SMARTTV]], [\n            /droid.+aft(\\w)( bui|\\))/i                                          // Fire TV\n            ], [MODEL, [VENDOR, AMAZON], [TYPE, SMARTTV]], [\n            /\\(dtv[\\);].+(aquos)/i,\n            /(aquos-tv[\\w ]+)\\)/i                                               // Sharp\n            ], [MODEL, [VENDOR, SHARP], [TYPE, SMARTTV]],[\n            /(bravia[\\w ]+)( bui|\\))/i                                              // Sony\n            ], [MODEL, [VENDOR, SONY], [TYPE, SMARTTV]], [\n            /(mitv-\\w{5}) bui/i                                                 // Xiaomi\n            ], [MODEL, [VENDOR, XIAOMI], [TYPE, SMARTTV]], [\n            /Hbbtv.*(technisat) (.*);/i                                         // TechniSAT\n            ], [VENDOR, MODEL, [TYPE, SMARTTV]], [\n            /\\b(roku)[\\dx]*[\\)\\/]((?:dvp-)?[\\d\\.]*)/i,                          // Roku\n            /hbbtv\\/\\d+\\.\\d+\\.\\d+ +\\([\\w\\+ ]*; *([\\w\\d][^;]*);([^;]*)/i         // HbbTV devices\n            ], [[VENDOR, trim], [MODEL, trim], [TYPE, SMARTTV]], [\n            /\\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\\b/i                   // SmartTV from Unidentified Vendors\n            ], [[TYPE, SMARTTV]], [\n\n            ///////////////////\n            // CONSOLES\n            ///////////////////\n\n            /(ouya)/i,                                                          // Ouya\n            /(nintendo) ([wids3utch]+)/i                                        // Nintendo\n            ], [VENDOR, MODEL, [TYPE, CONSOLE]], [\n            /droid.+; (shield) bui/i                                            // Nvidia\n            ], [MODEL, [VENDOR, 'Nvidia'], [TYPE, CONSOLE]], [\n            /(playstation [345portablevi]+)/i                                   // Playstation\n            ], [MODEL, [VENDOR, SONY], [TYPE, CONSOLE]], [\n            /\\b(xbox(?: one)?(?!; xbox))[\\); ]/i                                // Microsoft Xbox\n            ], [MODEL, [VENDOR, MICROSOFT], [TYPE, CONSOLE]], [\n\n            ///////////////////\n            // WEARABLES\n            ///////////////////\n\n            /((pebble))app/i                                                    // Pebble\n            ], [VENDOR, MODEL, [TYPE, WEARABLE]], [\n            /(watch)(?: ?os[,\\/]|\\d,\\d\\/)[\\d\\.]+/i                              // Apple Watch\n            ], [MODEL, [VENDOR, APPLE], [TYPE, WEARABLE]], [\n            /droid.+; (glass) \\d/i                                              // Google Glass\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, WEARABLE]], [\n            /droid.+; (wt63?0{2,3})\\)/i\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, WEARABLE]], [\n            /(quest( 2| pro)?)/i                                                // Oculus Quest\n            ], [MODEL, [VENDOR, FACEBOOK], [TYPE, WEARABLE]], [\n\n            ///////////////////\n            // EMBEDDED\n            ///////////////////\n\n            /(tesla)(?: qtcarbrowser|\\/[-\\w\\.]+)/i                              // Tesla\n            ], [VENDOR, [TYPE, EMBEDDED]], [\n            /(aeobc)\\b/i                                                        // Echo Dot\n            ], [MODEL, [VENDOR, AMAZON], [TYPE, EMBEDDED]], [\n\n            ////////////////////\n            // MIXED (GENERIC)\n            ///////////////////\n\n            /droid .+?; ([^;]+?)(?: bui|\\) applew).+? mobile safari/i           // Android Phones from Unidentified Vendors\n            ], [MODEL, [TYPE, MOBILE]], [\n            /droid .+?; ([^;]+?)(?: bui|\\) applew).+?(?! mobile) safari/i       // Android Tablets from Unidentified Vendors\n            ], [MODEL, [TYPE, TABLET]], [\n            /\\b((tablet|tab)[;\\/]|focus\\/\\d(?!.+mobile))/i                      // Unidentifiable Tablet\n            ], [[TYPE, TABLET]], [\n            /(phone|mobile(?:[;\\/]| [ \\w\\/\\.]*safari)|pda(?=.+windows ce))/i    // Unidentifiable Mobile\n            ], [[TYPE, MOBILE]], [\n            /(android[-\\w\\. ]{0,9});.+buil/i                                    // Generic Android Device\n            ], [MODEL, [VENDOR, 'Generic']]\n        ],\n\n        engine : [[\n\n            /windows.+ edge\\/([\\w\\.]+)/i                                       // EdgeHTML\n            ], [VERSION, [NAME, EDGE+'HTML']], [\n\n            /webkit\\/537\\.36.+chrome\\/(?!27)([\\w\\.]+)/i                         // Blink\n            ], [VERSION, [NAME, 'Blink']], [\n\n            /(presto)\\/([\\w\\.]+)/i,                                             // Presto\n            /(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\\/([\\w\\.]+)/i, // WebKit/Trident/NetFront/NetSurf/Amaya/Lynx/w3m/Goanna\n            /ekioh(flow)\\/([\\w\\.]+)/i,                                          // Flow\n            /(khtml|tasman|links)[\\/ ]\\(?([\\w\\.]+)/i,                           // KHTML/Tasman/Links\n            /(icab)[\\/ ]([23]\\.[\\d\\.]+)/i,                                      // iCab\n            /\\b(libweb)/i\n            ], [NAME, VERSION], [\n\n            /rv\\:([\\w\\.]{1,9})\\b.+(gecko)/i                                     // Gecko\n            ], [VERSION, NAME]\n        ],\n\n        os : [[\n\n            // Windows\n            /microsoft (windows) (vista|xp)/i                                   // Windows (iTunes)\n            ], [NAME, VERSION], [\n            /(windows) nt 6\\.2; (arm)/i,                                        // Windows RT\n            /(windows (?:phone(?: os)?|mobile))[\\/ ]?([\\d\\.\\w ]*)/i,            // Windows Phone\n            /(windows)[\\/ ]?([ntce\\d\\. ]+\\w)(?!.+xbox)/i\n            ], [NAME, [VERSION, strMapper, windowsVersionMap]], [\n            /(win(?=3|9|n)|win 9x )([nt\\d\\.]+)/i\n            ], [[NAME, 'Windows'], [VERSION, strMapper, windowsVersionMap]], [\n\n            // iOS/macOS\n            /ip[honead]{2,4}\\b(?:.*os ([\\w]+) like mac|; opera)/i,              // iOS\n            /ios;fbsv\\/([\\d\\.]+)/i,\n            /cfnetwork\\/.+darwin/i\n            ], [[VERSION, /_/g, '.'], [NAME, 'iOS']], [\n            /(mac os x) ?([\\w\\. ]*)/i,\n            /(macintosh|mac_powerpc\\b)(?!.+haiku)/i                             // Mac OS\n            ], [[NAME, MAC_OS], [VERSION, /_/g, '.']], [\n\n            // Mobile OSes\n            /droid ([\\w\\.]+)\\b.+(android[- ]x86|harmonyos)/i                    // Android-x86/HarmonyOS\n            ], [VERSION, NAME], [                                               // Android/WebOS/QNX/Bada/RIM/Maemo/MeeGo/Sailfish OS\n            /(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\\/ ]?([\\w\\.]*)/i,\n            /(blackberry)\\w*\\/([\\w\\.]*)/i,                                      // Blackberry\n            /(tizen|kaios)[\\/ ]([\\w\\.]+)/i,                                     // Tizen/KaiOS\n            /\\((series40);/i                                                    // Series 40\n            ], [NAME, VERSION], [\n            /\\(bb(10);/i                                                        // BlackBerry 10\n            ], [VERSION, [NAME, BLACKBERRY]], [\n            /(?:symbian ?os|symbos|s60(?=;)|series60)[-\\/ ]?([\\w\\.]*)/i         // Symbian\n            ], [VERSION, [NAME, 'Symbian']], [\n            /mozilla\\/[\\d\\.]+ \\((?:mobile|tablet|tv|mobile; [\\w ]+); rv:.+ gecko\\/([\\w\\.]+)/i // Firefox OS\n            ], [VERSION, [NAME, FIREFOX+' OS']], [\n            /web0s;.+rt(tv)/i,\n            /\\b(?:hp)?wos(?:browser)?\\/([\\w\\.]+)/i                              // WebOS\n            ], [VERSION, [NAME, 'webOS']], [\n            /watch(?: ?os[,\\/]|\\d,\\d\\/)([\\d\\.]+)/i                              // watchOS\n            ], [VERSION, [NAME, 'watchOS']], [\n\n            // Google Chromecast\n            /crkey\\/([\\d\\.]+)/i                                                 // Google Chromecast\n            ], [VERSION, [NAME, CHROME+'cast']], [\n            /(cros) [\\w]+(?:\\)| ([\\w\\.]+)\\b)/i                                  // Chromium OS\n            ], [[NAME, CHROMIUM_OS], VERSION],[\n\n            // Smart TVs\n            /panasonic;(viera)/i,                                               // Panasonic Viera\n            /(netrange)mmh/i,                                                   // Netrange\n            /(nettv)\\/(\\d+\\.[\\w\\.]+)/i,                                         // NetTV\n\n            // Console\n            /(nintendo|playstation) ([wids345portablevuch]+)/i,                 // Nintendo/Playstation\n            /(xbox); +xbox ([^\\);]+)/i,                                         // Microsoft Xbox (360, One, X, S, Series X, Series S)\n\n            // Other\n            /\\b(joli|palm)\\b ?(?:os)?\\/?([\\w\\.]*)/i,                            // Joli/Palm\n            /(mint)[\\/\\(\\) ]?(\\w*)/i,                                           // Mint\n            /(mageia|vectorlinux)[; ]/i,                                        // Mageia/VectorLinux\n            /([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\\/ ]?(?!chrom|package)([-\\w\\.]*)/i,\n                                                                                // Ubuntu/Debian/SUSE/Gentoo/Arch/Slackware/Fedora/Mandriva/CentOS/PCLinuxOS/RedHat/Zenwalk/Linpus/Raspbian/Plan9/Minix/RISCOS/Contiki/Deepin/Manjaro/elementary/Sabayon/Linspire\n            /(hurd|linux) ?([\\w\\.]*)/i,                                         // Hurd/Linux\n            /(gnu) ?([\\w\\.]*)/i,                                                // GNU\n            /\\b([-frentopcghs]{0,5}bsd|dragonfly)[\\/ ]?(?!amd|[ix346]{1,2}86)([\\w\\.]*)/i, // FreeBSD/NetBSD/OpenBSD/PC-BSD/GhostBSD/DragonFly\n            /(haiku) (\\w+)/i                                                    // Haiku\n            ], [NAME, VERSION], [\n            /(sunos) ?([\\w\\.\\d]*)/i                                             // Solaris\n            ], [[NAME, 'Solaris'], VERSION], [\n            /((?:open)?solaris)[-\\/ ]?([\\w\\.]*)/i,                              // Solaris\n            /(aix) ((\\d)(?=\\.|\\)| )[\\w\\.])*/i,                                  // AIX\n            /\\b(beos|os\\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i, // BeOS/OS2/AmigaOS/MorphOS/OpenVMS/Fuchsia/HP-UX/SerenityOS\n            /(unix) ?([\\w\\.]*)/i                                                // UNIX\n            ], [NAME, VERSION]\n        ]\n    };\n\n    /////////////////\n    // Constructor\n    ////////////////\n\n    var UAParser = function (ua, extensions) {\n\n        if (typeof ua === OBJ_TYPE) {\n            extensions = ua;\n            ua = undefined;\n        }\n\n        if (!(this instanceof UAParser)) {\n            return new UAParser(ua, extensions).getResult();\n        }\n\n        var _navigator = (typeof window !== UNDEF_TYPE && window.navigator) ? window.navigator : undefined;\n        var _ua = ua || ((_navigator && _navigator.userAgent) ? _navigator.userAgent : EMPTY);\n        var _uach = (_navigator && _navigator.userAgentData) ? _navigator.userAgentData : undefined;\n        var _rgxmap = extensions ? extend(regexes, extensions) : regexes;\n        var _isSelfNav = _navigator && _navigator.userAgent == _ua;\n\n        this.getBrowser = function () {\n            var _browser = {};\n            _browser[NAME] = undefined;\n            _browser[VERSION] = undefined;\n            rgxMapper.call(_browser, _ua, _rgxmap.browser);\n            _browser[MAJOR] = majorize(_browser[VERSION]);\n            // Brave-specific detection\n            if (_isSelfNav && _navigator && _navigator.brave && typeof _navigator.brave.isBrave == FUNC_TYPE) {\n                _browser[NAME] = 'Brave';\n            }\n            return _browser;\n        };\n        this.getCPU = function () {\n            var _cpu = {};\n            _cpu[ARCHITECTURE] = undefined;\n            rgxMapper.call(_cpu, _ua, _rgxmap.cpu);\n            return _cpu;\n        };\n        this.getDevice = function () {\n            var _device = {};\n            _device[VENDOR] = undefined;\n            _device[MODEL] = undefined;\n            _device[TYPE] = undefined;\n            rgxMapper.call(_device, _ua, _rgxmap.device);\n            if (_isSelfNav && !_device[TYPE] && _uach && _uach.mobile) {\n                _device[TYPE] = MOBILE;\n            }\n            // iPadOS-specific detection: identified as Mac, but has some iOS-only properties\n            if (_isSelfNav && _device[MODEL] == 'Macintosh' && _navigator && typeof _navigator.standalone !== UNDEF_TYPE && _navigator.maxTouchPoints && _navigator.maxTouchPoints > 2) {\n                _device[MODEL] = 'iPad';\n                _device[TYPE] = TABLET;\n            }\n            return _device;\n        };\n        this.getEngine = function () {\n            var _engine = {};\n            _engine[NAME] = undefined;\n            _engine[VERSION] = undefined;\n            rgxMapper.call(_engine, _ua, _rgxmap.engine);\n            return _engine;\n        };\n        this.getOS = function () {\n            var _os = {};\n            _os[NAME] = undefined;\n            _os[VERSION] = undefined;\n            rgxMapper.call(_os, _ua, _rgxmap.os);\n            if (_isSelfNav && !_os[NAME] && _uach && _uach.platform != 'Unknown') {\n                _os[NAME] = _uach.platform  \n                                    .replace(/chrome os/i, CHROMIUM_OS)\n                                    .replace(/macos/i, MAC_OS);           // backward compatibility\n            }\n            return _os;\n        };\n        this.getResult = function () {\n            return {\n                ua      : this.getUA(),\n                browser : this.getBrowser(),\n                engine  : this.getEngine(),\n                os      : this.getOS(),\n                device  : this.getDevice(),\n                cpu     : this.getCPU()\n            };\n        };\n        this.getUA = function () {\n            return _ua;\n        };\n        this.setUA = function (ua) {\n            _ua = (typeof ua === STR_TYPE && ua.length > UA_MAX_LENGTH) ? trim(ua, UA_MAX_LENGTH) : ua;\n            return this;\n        };\n        this.setUA(_ua);\n        return this;\n    };\n\n    UAParser.VERSION = LIBVERSION;\n    UAParser.BROWSER =  enumerize([NAME, VERSION, MAJOR]);\n    UAParser.CPU = enumerize([ARCHITECTURE]);\n    UAParser.DEVICE = enumerize([MODEL, VENDOR, TYPE, CONSOLE, MOBILE, SMARTTV, TABLET, WEARABLE, EMBEDDED]);\n    UAParser.ENGINE = UAParser.OS = enumerize([NAME, VERSION]);\n\n    ///////////\n    // Export\n    //////////\n\n    // check js environment\n    if (typeof(exports) !== UNDEF_TYPE) {\n        // nodejs env\n        if (typeof module !== UNDEF_TYPE && module.exports) {\n            exports = module.exports = UAParser;\n        }\n        exports.UAParser = UAParser;\n    } else {\n        // requirejs env (optional)\n        if (typeof(define) === FUNC_TYPE && define.amd) {\n            define(function () {\n                return UAParser;\n            });\n        } else if (typeof window !== UNDEF_TYPE) {\n            // browser env\n            window.UAParser = UAParser;\n        }\n    }\n\n    // jQuery/Zepto specific (optional)\n    // Note:\n    //   In AMD env the global scope should be kept clean, but jQuery is an exception.\n    //   jQuery always exports to global scope, unless jQuery.noConflict(true) is used,\n    //   and we should catch that.\n    var $ = typeof window !== UNDEF_TYPE && (window.jQuery || window.Zepto);\n    if ($ && !$.ua) {\n        var parser = new UAParser();\n        $.ua = parser.getResult();\n        $.ua.get = function () {\n            return parser.getUA();\n        };\n        $.ua.set = function (ua) {\n            parser.setUA(ua);\n            var result = parser.getResult();\n            for (var prop in result) {\n                $.ua[prop] = result[prop];\n            }\n        };\n    }\n\n})(typeof window === 'object' ? window : this);\n", "/**\n * Lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright JS Foundation and other contributors <https://js.foundation/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    asyncTag = '[object AsyncFunction]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    nullTag = '[object Null]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    proxyTag = '[object Proxy]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    undefinedTag = '[object Undefined]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\n/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\n/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\n/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    Symbol = root.Symbol,\n    Uint8Array = root.Uint8Array,\n    propertyIsEnumerable = objectProto.propertyIsEnumerable,\n    splice = arrayProto.splice,\n    symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols,\n    nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined,\n    nativeKeys = overArg(Object.keys, Object);\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView'),\n    Map = getNative(root, 'Map'),\n    Promise = getNative(root, 'Promise'),\n    Set = getNative(root, 'Set'),\n    WeakMap = getNative(root, 'WeakMap'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\n/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\n/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\n/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\n/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = isEqual;\n", "/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nconst SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substring(2, 12);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(line => line.trim());\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  const parts = blob.split('\\nm=');\n  return parts.map((part, index) => (index > 0 ?\n    'm=' + part : part).trim() + '\\r\\n');\n};\n\n// Returns the session description.\nSDPUtils.getDescription = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// Returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(line => line.indexOf(prefix) === 0);\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\n// Input can be prefixed with a=.\nSDPUtils.parseCandidate = function(line) {\n  let parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  const candidate = {\n    foundation: parts[0],\n    component: {1: 'rtp', 2: 'rtcp'}[parts[1]] || parts[1],\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7],\n  };\n\n  for (let i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compatibility.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag. Don't overwrite.\n        if (candidate[parts[i]] === undefined) {\n          candidate[parts[i]] = parts[i + 1];\n        }\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\n// This does not include the a= prefix!\nSDPUtils.writeCandidate = function(candidate) {\n  const sdp = [];\n  sdp.push(candidate.foundation);\n\n  const component = candidate.component;\n  if (component === 'rtp') {\n    sdp.push(1);\n  } else if (component === 'rtcp') {\n    sdp.push(2);\n  } else {\n    sdp.push(component);\n  }\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  const type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// Sample input:\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substring(14).split(' ');\n};\n\n// Parses a rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  let parts = line.substring(9).split(' ');\n  const parsed = {\n    payloadType: parseInt(parts.shift(), 10), // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generates a rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  const channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses a extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1],\n    attributes: parts.slice(2).join(' '),\n  };\n};\n\n// Generates an extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri +\n      (headerExtension.attributes ? ' ' + headerExtension.attributes : '') +\n      '\\r\\n';\n};\n\n// Parses a fmtp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  const parsed = {};\n  let kv;\n  const parts = line.substring(line.indexOf(' ') + 1).split(';');\n  for (let j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates a fmtp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  let line = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    const params = [];\n    Object.keys(codec.parameters).forEach(param => {\n      if (codec.parameters[param] !== undefined) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses a rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  const parts = line.substring(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' '),\n  };\n};\n\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  let lines = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(fb => {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses a RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  const sp = line.indexOf(' ');\n  const parts = {\n    ssrc: parseInt(line.substring(7, sp), 10),\n  };\n  const colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substring(sp + 1, colon);\n    parts.value = line.substring(colon + 1);\n  } else {\n    parts.attribute = line.substring(sp + 1);\n  }\n  return parts;\n};\n\n// Parse a ssrc-group line (see RFC 5576). Sample input:\n// a=ssrc-group:semantics 12 34\nSDPUtils.parseSsrcGroup = function(line) {\n  const parts = line.substring(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(ssrc => parseInt(ssrc, 10)),\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// Returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  const mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substring(6);\n  }\n};\n\n// Parses a fingerprint line for DTLS-SRTP.\nSDPUtils.parseFingerprint = function(line) {\n  const parts = line.substring(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1].toUpperCase(), // the definition is upper-case in RFC 4572.\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint),\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  let sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(fp => {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  const parts = keyParams.substring(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES parameters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  const ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  const pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substring(12),\n    password: pwd.substring(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  let sdp = 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n  if (params.iceLite) {\n    sdp += 'a=ice-lite\\r\\n';\n  }\n  return sdp;\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  const description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: [],\n  };\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  description.profile = mline[2];\n  for (let i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    const pt = mline[i];\n    const rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      const codec = SDPUtils.parseRtpMap(rtpmapline);\n      const fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(line => {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  const wildcardRtcpFb = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-fb:* ')\n    .map(SDPUtils.parseRtcpFb);\n  description.codecs.forEach(codec => {\n    wildcardRtcpFb.forEach(fb=> {\n      const duplicate = codec.rtcpFeedback.find(existingFeedback => {\n        return existingFeedback.type === fb.type &&\n          existingFeedback.parameter === fb.parameter;\n      });\n      if (!duplicate) {\n        codec.rtcpFeedback.push(fb);\n      }\n    });\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  let sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' ' + (caps.profile || 'UDP/TLS/RTP/SAVPF') + ' ';\n  sdp += caps.codecs.map(codec => {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(codec => {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  let maxptime = 0;\n  caps.codecs.forEach(codec => {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(extension => {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  const encodingParameters = [];\n  const description = SDPUtils.parseRtpParameters(mediaSection);\n  const hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  const hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  const ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(parts => parts.attribute === 'cname');\n  const primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  let secondarySsrc;\n\n  const flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(line => {\n      const parts = line.substring(17).split(' ');\n      return parts.map(part => parseInt(part, 10));\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(codec => {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      let encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10),\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red',\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc,\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  let bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substring(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substring(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(params => {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  const rtcpParameters = {};\n\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  const remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(obj => obj.attribute === 'cname')[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  const rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attr\u0456bute.\n  // Note that Edge does not support unmuxed RTCP.\n  const mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\nSDPUtils.writeRtcpParameters = function(rtcpParameters) {\n  let sdp = '';\n  if (rtcpParameters.reducedSize) {\n    sdp += 'a=rtcp-rsize\\r\\n';\n  }\n  if (rtcpParameters.mux) {\n    sdp += 'a=rtcp-mux\\r\\n';\n  }\n  if (rtcpParameters.ssrc !== undefined && rtcpParameters.cname) {\n    sdp += 'a=ssrc:' + rtcpParameters.ssrc +\n      ' cname:' + rtcpParameters.cname + '\\r\\n';\n  }\n  return sdp;\n};\n\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  let parts;\n  const spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substring(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  const planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(msidParts => msidParts.attribute === 'msid');\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  const mline = SDPUtils.parseMLine(mediaSection);\n  const maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  let maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substring(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  const sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substring(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize,\n    };\n  }\n  const sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    const parts = sctpMapLines[0]\n      .substring(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize,\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  let output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n',\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n',\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 22);\n};\n\n// Write boiler plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  let sessionId;\n  const version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  const user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  const lines = SDPUtils.splitLines(mediaSection);\n  for (let i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substring(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  return mline[0].substring(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const parts = lines[0].substring(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' '),\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  const line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  const parts = line.substring(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5],\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  const lines = SDPUtils.splitLines(blob);\n  for (let i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n", "var grammar = module.exports = {\n  v: [{\n    name: 'version',\n    reg: /^(\\d*)$/\n  }],\n  o: [{\n    // o=- 20518 0 IN IP4 203.0.113.1\n    // NB: sessionId will be a String in most cases because it is huge\n    name: 'origin',\n    reg: /^(\\S*) (\\d*) (\\d*) (\\S*) IP(\\d) (\\S*)/,\n    names: ['username', 'sessionId', 'sessionVersion', 'netType', 'ipVer', 'address'],\n    format: '%s %s %d %s IP%d %s'\n  }],\n  // default parsing of these only (though some of these feel outdated)\n  s: [{ name: 'name' }],\n  i: [{ name: 'description' }],\n  u: [{ name: 'uri' }],\n  e: [{ name: 'email' }],\n  p: [{ name: 'phone' }],\n  z: [{ name: 'timezones' }], // TODO: this one can actually be parsed properly...\n  r: [{ name: 'repeats' }],   // TODO: this one can also be parsed properly\n  // k: [{}], // outdated thing ignored\n  t: [{\n    // t=0 0\n    name: 'timing',\n    reg: /^(\\d*) (\\d*)/,\n    names: ['start', 'stop'],\n    format: '%d %d'\n  }],\n  c: [{\n    // c=IN IP4 10.47.197.26\n    name: 'connection',\n    reg: /^IN IP(\\d) (\\S*)/,\n    names: ['version', 'ip'],\n    format: 'IN IP%d %s'\n  }],\n  b: [{\n    // b=AS:4000\n    push: 'bandwidth',\n    reg: /^(TIAS|AS|CT|RR|RS):(\\d*)/,\n    names: ['type', 'limit'],\n    format: '%s:%s'\n  }],\n  m: [{\n    // m=video 51744 RTP/AVP 126 97 98 34 31\n    // NB: special - pushes to session\n    // TODO: rtp/fmtp should be filtered by the payloads found here?\n    reg: /^(\\w*) (\\d*) ([\\w/]*)(?: (.*))?/,\n    names: ['type', 'port', 'protocol', 'payloads'],\n    format: '%s %d %s %s'\n  }],\n  a: [\n    {\n      // a=rtpmap:110 opus/48000/2\n      push: 'rtp',\n      reg: /^rtpmap:(\\d*) ([\\w\\-.]*)(?:\\s*\\/(\\d*)(?:\\s*\\/(\\S*))?)?/,\n      names: ['payload', 'codec', 'rate', 'encoding'],\n      format: function (o) {\n        return (o.encoding)\n          ? 'rtpmap:%d %s/%s/%s'\n          : o.rate\n            ? 'rtpmap:%d %s/%s'\n            : 'rtpmap:%d %s';\n      }\n    },\n    {\n      // a=fmtp:108 profile-level-id=24;object=23;bitrate=64000\n      // a=fmtp:111 minptime=10; useinbandfec=1\n      push: 'fmtp',\n      reg: /^fmtp:(\\d*) ([\\S| ]*)/,\n      names: ['payload', 'config'],\n      format: 'fmtp:%d %s'\n    },\n    {\n      // a=control:streamid=0\n      name: 'control',\n      reg: /^control:(.*)/,\n      format: 'control:%s'\n    },\n    {\n      // a=rtcp:65179 IN IP4 193.84.77.194\n      name: 'rtcp',\n      reg: /^rtcp:(\\d*)(?: (\\S*) IP(\\d) (\\S*))?/,\n      names: ['port', 'netType', 'ipVer', 'address'],\n      format: function (o) {\n        return (o.address != null)\n          ? 'rtcp:%d %s IP%d %s'\n          : 'rtcp:%d';\n      }\n    },\n    {\n      // a=rtcp-fb:98 trr-int 100\n      push: 'rtcpFbTrrInt',\n      reg: /^rtcp-fb:(\\*|\\d*) trr-int (\\d*)/,\n      names: ['payload', 'value'],\n      format: 'rtcp-fb:%s trr-int %d'\n    },\n    {\n      // a=rtcp-fb:98 nack rpsi\n      push: 'rtcpFb',\n      reg: /^rtcp-fb:(\\*|\\d*) ([\\w-_]*)(?: ([\\w-_]*))?/,\n      names: ['payload', 'type', 'subtype'],\n      format: function (o) {\n        return (o.subtype != null)\n          ? 'rtcp-fb:%s %s %s'\n          : 'rtcp-fb:%s %s';\n      }\n    },\n    {\n      // a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n      // a=extmap:1/recvonly URI-gps-string\n      // a=extmap:3 urn:ietf:params:rtp-hdrext:encrypt urn:ietf:params:rtp-hdrext:smpte-tc 25@600/24\n      push: 'ext',\n      reg: /^extmap:(\\d+)(?:\\/(\\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\\S*)(?: (\\S*))?/,\n      names: ['value', 'direction', 'encrypt-uri', 'uri', 'config'],\n      format: function (o) {\n        return (\n          'extmap:%d' +\n          (o.direction ? '/%s' : '%v') +\n          (o['encrypt-uri'] ? ' %s' : '%v') +\n          ' %s' +\n          (o.config ? ' %s' : '')\n        );\n      }\n    },\n    {\n      // a=extmap-allow-mixed\n      name: 'extmapAllowMixed',\n      reg: /^(extmap-allow-mixed)/\n    },\n    {\n      // a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:PS1uQCVeeCFCanVmcjkpPywjNWhcYD0mXXtxaVBR|2^20|1:32\n      push: 'crypto',\n      reg: /^crypto:(\\d*) ([\\w_]*) (\\S*)(?: (\\S*))?/,\n      names: ['id', 'suite', 'config', 'sessionConfig'],\n      format: function (o) {\n        return (o.sessionConfig != null)\n          ? 'crypto:%d %s %s %s'\n          : 'crypto:%d %s %s';\n      }\n    },\n    {\n      // a=setup:actpass\n      name: 'setup',\n      reg: /^setup:(\\w*)/,\n      format: 'setup:%s'\n    },\n    {\n      // a=connection:new\n      name: 'connectionType',\n      reg: /^connection:(new|existing)/,\n      format: 'connection:%s'\n    },\n    {\n      // a=mid:1\n      name: 'mid',\n      reg: /^mid:([^\\s]*)/,\n      format: 'mid:%s'\n    },\n    {\n      // a=msid:0c8b064d-d807-43b4-b434-f92a889d8587 98178685-d409-46e0-8e16-7ef0db0db64a\n      name: 'msid',\n      reg: /^msid:(.*)/,\n      format: 'msid:%s'\n    },\n    {\n      // a=ptime:20\n      name: 'ptime',\n      reg: /^ptime:(\\d*(?:\\.\\d*)*)/,\n      format: 'ptime:%d'\n    },\n    {\n      // a=maxptime:60\n      name: 'maxptime',\n      reg: /^maxptime:(\\d*(?:\\.\\d*)*)/,\n      format: 'maxptime:%d'\n    },\n    {\n      // a=sendrecv\n      name: 'direction',\n      reg: /^(sendrecv|recvonly|sendonly|inactive)/\n    },\n    {\n      // a=ice-lite\n      name: 'icelite',\n      reg: /^(ice-lite)/\n    },\n    {\n      // a=ice-ufrag:F7gI\n      name: 'iceUfrag',\n      reg: /^ice-ufrag:(\\S*)/,\n      format: 'ice-ufrag:%s'\n    },\n    {\n      // a=ice-pwd:x9cml/YzichV2+XlhiMu8g\n      name: 'icePwd',\n      reg: /^ice-pwd:(\\S*)/,\n      format: 'ice-pwd:%s'\n    },\n    {\n      // a=fingerprint:SHA-1 00:11:22:33:44:55:66:77:88:99:AA:BB:CC:DD:EE:FF:00:11:22:33\n      name: 'fingerprint',\n      reg: /^fingerprint:(\\S*) (\\S*)/,\n      names: ['type', 'hash'],\n      format: 'fingerprint:%s %s'\n    },\n    {\n      // a=candidate:0 1 UDP 2113667327 203.0.113.1 54400 typ host\n      // a=candidate:1162875081 1 udp 2113937151 192.168.34.75 60017 typ host generation 0 network-id 3 network-cost 10\n      // a=candidate:3289912957 2 udp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 generation 0 network-id 3 network-cost 10\n      // a=candidate:229815620 1 tcp 1518280447 192.168.150.19 60017 typ host tcptype active generation 0 network-id 3 network-cost 10\n      // a=candidate:3289912957 2 tcp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 tcptype passive generation 0 network-id 3 network-cost 10\n      push:'candidates',\n      reg: /^candidate:(\\S*) (\\d*) (\\S*) (\\d*) (\\S*) (\\d*) typ (\\S*)(?: raddr (\\S*) rport (\\d*))?(?: tcptype (\\S*))?(?: generation (\\d*))?(?: network-id (\\d*))?(?: network-cost (\\d*))?/,\n      names: ['foundation', 'component', 'transport', 'priority', 'ip', 'port', 'type', 'raddr', 'rport', 'tcptype', 'generation', 'network-id', 'network-cost'],\n      format: function (o) {\n        var str = 'candidate:%s %d %s %d %s %d typ %s';\n\n        str += (o.raddr != null) ? ' raddr %s rport %d' : '%v%v';\n\n        // NB: candidate has three optional chunks, so %void middles one if it's missing\n        str += (o.tcptype != null) ? ' tcptype %s' : '%v';\n\n        if (o.generation != null) {\n          str += ' generation %d';\n        }\n\n        str += (o['network-id'] != null) ? ' network-id %d' : '%v';\n        str += (o['network-cost'] != null) ? ' network-cost %d' : '%v';\n        return str;\n      }\n    },\n    {\n      // a=end-of-candidates (keep after the candidates line for readability)\n      name: 'endOfCandidates',\n      reg: /^(end-of-candidates)/\n    },\n    {\n      // a=remote-candidates:1 203.0.113.1 54400 2 203.0.113.1 54401 ...\n      name: 'remoteCandidates',\n      reg: /^remote-candidates:(.*)/,\n      format: 'remote-candidates:%s'\n    },\n    {\n      // a=ice-options:google-ice\n      name: 'iceOptions',\n      reg: /^ice-options:(\\S*)/,\n      format: 'ice-options:%s'\n    },\n    {\n      // a=ssrc:2566107569 cname:t9YU8M1UxTF8Y1A1\n      push: 'ssrcs',\n      reg: /^ssrc:(\\d*) ([\\w_-]*)(?::(.*))?/,\n      names: ['id', 'attribute', 'value'],\n      format: function (o) {\n        var str = 'ssrc:%d';\n        if (o.attribute != null) {\n          str += ' %s';\n          if (o.value != null) {\n            str += ':%s';\n          }\n        }\n        return str;\n      }\n    },\n    {\n      // a=ssrc-group:FEC 1 2\n      // a=ssrc-group:FEC-FR 3004364195 1080772241\n      push: 'ssrcGroups',\n      // token-char = %x21 / %x23-27 / %x2A-2B / %x2D-2E / %x30-39 / %x41-5A / %x5E-7E\n      reg: /^ssrc-group:([\\x21\\x23\\x24\\x25\\x26\\x27\\x2A\\x2B\\x2D\\x2E\\w]*) (.*)/,\n      names: ['semantics', 'ssrcs'],\n      format: 'ssrc-group:%s %s'\n    },\n    {\n      // a=msid-semantic: WMS Jvlam5X3SX1OP6pn20zWogvaKJz5Hjf9OnlV\n      name: 'msidSemantic',\n      reg: /^msid-semantic:\\s?(\\w*) (\\S*)/,\n      names: ['semantic', 'token'],\n      format: 'msid-semantic: %s %s' // space after ':' is not accidental\n    },\n    {\n      // a=group:BUNDLE audio video\n      push: 'groups',\n      reg: /^group:(\\w*) (.*)/,\n      names: ['type', 'mids'],\n      format: 'group:%s %s'\n    },\n    {\n      // a=rtcp-mux\n      name: 'rtcpMux',\n      reg: /^(rtcp-mux)/\n    },\n    {\n      // a=rtcp-rsize\n      name: 'rtcpRsize',\n      reg: /^(rtcp-rsize)/\n    },\n    {\n      // a=sctpmap:5000 webrtc-datachannel 1024\n      name: 'sctpmap',\n      reg: /^sctpmap:([\\w_/]*) (\\S*)(?: (\\S*))?/,\n      names: ['sctpmapNumber', 'app', 'maxMessageSize'],\n      format: function (o) {\n        return (o.maxMessageSize != null)\n          ? 'sctpmap:%s %s %s'\n          : 'sctpmap:%s %s';\n      }\n    },\n    {\n      // a=x-google-flag:conference\n      name: 'xGoogleFlag',\n      reg: /^x-google-flag:([^\\s]*)/,\n      format: 'x-google-flag:%s'\n    },\n    {\n      // a=rid:1 send max-width=1280;max-height=720;max-fps=30;depend=0\n      push: 'rids',\n      reg: /^rid:([\\d\\w]+) (\\w+)(?: ([\\S| ]*))?/,\n      names: ['id', 'direction', 'params'],\n      format: function (o) {\n        return (o.params) ? 'rid:%s %s %s' : 'rid:%s %s';\n      }\n    },\n    {\n      // a=imageattr:97 send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320] recv [x=330,y=250]\n      // a=imageattr:* send [x=800,y=640] recv *\n      // a=imageattr:100 recv [x=320,y=240]\n      push: 'imageattrs',\n      reg: new RegExp(\n        // a=imageattr:97\n        '^imageattr:(\\\\d+|\\\\*)' +\n        // send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320]\n        '[\\\\s\\\\t]+(send|recv)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*)' +\n        // recv [x=330,y=250]\n        '(?:[\\\\s\\\\t]+(recv|send)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*))?'\n      ),\n      names: ['pt', 'dir1', 'attrs1', 'dir2', 'attrs2'],\n      format: function (o) {\n        return 'imageattr:%s %s %s' + (o.dir2 ? ' %s %s' : '');\n      }\n    },\n    {\n      // a=simulcast:send 1,2,3;~4,~5 recv 6;~7,~8\n      // a=simulcast:recv 1;4,5 send 6;7\n      name: 'simulcast',\n      reg: new RegExp(\n        // a=simulcast:\n        '^simulcast:' +\n        // send 1,2,3;~4,~5\n        '(send|recv) ([a-zA-Z0-9\\\\-_~;,]+)' +\n        // space + recv 6;~7,~8\n        '(?:\\\\s?(send|recv) ([a-zA-Z0-9\\\\-_~;,]+))?' +\n        // end\n        '$'\n      ),\n      names: ['dir1', 'list1', 'dir2', 'list2'],\n      format: function (o) {\n        return 'simulcast:%s %s' + (o.dir2 ? ' %s %s' : '');\n      }\n    },\n    {\n      // old simulcast draft 03 (implemented by Firefox)\n      //   https://tools.ietf.org/html/draft-ietf-mmusic-sdp-simulcast-03\n      // a=simulcast: recv pt=97;98 send pt=97\n      // a=simulcast: send rid=5;6;7 paused=6,7\n      name: 'simulcast_03',\n      reg: /^simulcast:[\\s\\t]+([\\S+\\s\\t]+)$/,\n      names: ['value'],\n      format: 'simulcast: %s'\n    },\n    {\n      // a=framerate:25\n      // a=framerate:29.97\n      name: 'framerate',\n      reg: /^framerate:(\\d+(?:$|\\.\\d+))/,\n      format: 'framerate:%s'\n    },\n    {\n      // RFC4570\n      // a=source-filter: incl IN IP4 239.5.2.31 10.1.15.5\n      name: 'sourceFilter',\n      reg: /^source-filter: *(excl|incl) (\\S*) (IP4|IP6|\\*) (\\S*) (.*)/,\n      names: ['filterMode', 'netType', 'addressTypes', 'destAddress', 'srcList'],\n      format: 'source-filter: %s %s %s %s %s'\n    },\n    {\n      // a=bundle-only\n      name: 'bundleOnly',\n      reg: /^(bundle-only)/\n    },\n    {\n      // a=label:1\n      name: 'label',\n      reg: /^label:(.+)/,\n      format: 'label:%s'\n    },\n    {\n      // RFC version 26 for SCTP over DTLS\n      // https://tools.ietf.org/html/draft-ietf-mmusic-sctp-sdp-26#section-5\n      name: 'sctpPort',\n      reg: /^sctp-port:(\\d+)$/,\n      format: 'sctp-port:%s'\n    },\n    {\n      // RFC version 26 for SCTP over DTLS\n      // https://tools.ietf.org/html/draft-ietf-mmusic-sctp-sdp-26#section-6\n      name: 'maxMessageSize',\n      reg: /^max-message-size:(\\d+)$/,\n      format: 'max-message-size:%s'\n    },\n    {\n      // RFC7273\n      // a=ts-refclk:ptp=IEEE1588-2008:39-A7-94-FF-FE-07-CB-D0:37\n      push:'tsRefClocks',\n      reg: /^ts-refclk:([^\\s=]*)(?:=(\\S*))?/,\n      names: ['clksrc', 'clksrcExt'],\n      format: function (o) {\n        return 'ts-refclk:%s' + (o.clksrcExt != null ? '=%s' : '');\n      }\n    },\n    {\n      // RFC7273\n      // a=mediaclk:direct=963214424\n      name:'mediaClk',\n      reg: /^mediaclk:(?:id=(\\S*))? *([^\\s=]*)(?:=(\\S*))?(?: *rate=(\\d+)\\/(\\d+))?/,\n      names: ['id', 'mediaClockName', 'mediaClockValue', 'rateNumerator', 'rateDenominator'],\n      format: function (o) {\n        var str = 'mediaclk:';\n        str += (o.id != null ? 'id=%s %s' : '%v%s');\n        str += (o.mediaClockValue != null ? '=%s' : '');\n        str += (o.rateNumerator != null ? ' rate=%s' : '');\n        str += (o.rateDenominator != null ? '/%s' : '');\n        return str;\n      }\n    },\n    {\n      // a=keywds:keywords\n      name: 'keywords',\n      reg: /^keywds:(.+)$/,\n      format: 'keywds:%s'\n    },\n    {\n      // a=content:main\n      name: 'content',\n      reg: /^content:(.+)/,\n      format: 'content:%s'\n    },\n    // BFCP https://tools.ietf.org/html/rfc4583\n    {\n      // a=floorctrl:c-s\n      name: 'bfcpFloorCtrl',\n      reg: /^floorctrl:(c-only|s-only|c-s)/,\n      format: 'floorctrl:%s'\n    },\n    {\n      // a=confid:1\n      name: 'bfcpConfId',\n      reg: /^confid:(\\d+)/,\n      format: 'confid:%s'\n    },\n    {\n      // a=userid:1\n      name: 'bfcpUserId',\n      reg: /^userid:(\\d+)/,\n      format: 'userid:%s'\n    },\n    {\n      // a=floorid:1\n      name: 'bfcpFloorId',\n      reg: /^floorid:(.+) (?:m-stream|mstrm):(.+)/,\n      names: ['id', 'mStream'],\n      format: 'floorid:%s mstrm:%s'\n    },\n    {\n      // any a= that we don't understand is kept verbatim on media.invalid\n      push: 'invalid',\n      names: ['value']\n    }\n  ]\n};\n\n// set sensible defaults to avoid polluting the grammar with boring details\nObject.keys(grammar).forEach(function (key) {\n  var objs = grammar[key];\n  objs.forEach(function (obj) {\n    if (!obj.reg) {\n      obj.reg = /(.*)/;\n    }\n    if (!obj.format) {\n      obj.format = '%s';\n    }\n  });\n});\n", "var toIntIfInt = function (v) {\n  return String(Number(v)) === v ? Number(v) : v;\n};\n\nvar attachProperties = function (match, location, names, rawName) {\n  if (rawName && !names) {\n    location[rawName] = toIntIfInt(match[1]);\n  }\n  else {\n    for (var i = 0; i < names.length; i += 1) {\n      if (match[i+1] != null) {\n        location[names[i]] = toIntIfInt(match[i+1]);\n      }\n    }\n  }\n};\n\nvar parseReg = function (obj, location, content) {\n  var needsBlank = obj.name && obj.names;\n  if (obj.push && !location[obj.push]) {\n    location[obj.push] = [];\n  }\n  else if (needsBlank && !location[obj.name]) {\n    location[obj.name] = {};\n  }\n  var keyLocation = obj.push ?\n    {} :  // blank object that will be pushed\n    needsBlank ? location[obj.name] : location; // otherwise, named location or root\n\n  attachProperties(content.match(obj.reg), keyLocation, obj.names, obj.name);\n\n  if (obj.push) {\n    location[obj.push].push(keyLocation);\n  }\n};\n\nvar grammar = require('./grammar');\nvar validLine = RegExp.prototype.test.bind(/^([a-z])=(.*)/);\n\nexports.parse = function (sdp) {\n  var session = {}\n    , media = []\n    , location = session; // points at where properties go under (one of the above)\n\n  // parse lines we understand\n  sdp.split(/(\\r\\n|\\r|\\n)/).filter(validLine).forEach(function (l) {\n    var type = l[0];\n    var content = l.slice(2);\n    if (type === 'm') {\n      media.push({rtp: [], fmtp: []});\n      location = media[media.length-1]; // point at latest media line\n    }\n\n    for (var j = 0; j < (grammar[type] || []).length; j += 1) {\n      var obj = grammar[type][j];\n      if (obj.reg.test(content)) {\n        return parseReg(obj, location, content);\n      }\n    }\n  });\n\n  session.media = media; // link it up\n  return session;\n};\n\nvar paramReducer = function (acc, expr) {\n  var s = expr.split(/=(.+)/, 2);\n  if (s.length === 2) {\n    acc[s[0]] = toIntIfInt(s[1]);\n  } else if (s.length === 1 && expr.length > 1) {\n    acc[s[0]] = undefined;\n  }\n  return acc;\n};\n\nexports.parseParams = function (str) {\n  return str.split(/;\\s?/).reduce(paramReducer, {});\n};\n\n// For backward compatibility - alias will be removed in 3.0.0\nexports.parseFmtpConfig = exports.parseParams;\n\nexports.parsePayloads = function (str) {\n  return str.toString().split(' ').map(Number);\n};\n\nexports.parseRemoteCandidates = function (str) {\n  var candidates = [];\n  var parts = str.split(' ').map(toIntIfInt);\n  for (var i = 0; i < parts.length; i += 3) {\n    candidates.push({\n      component: parts[i],\n      ip: parts[i + 1],\n      port: parts[i + 2]\n    });\n  }\n  return candidates;\n};\n\nexports.parseImageAttributes = function (str) {\n  return str.split(' ').map(function (item) {\n    return item.substring(1, item.length-1).split(',').reduce(paramReducer, {});\n  });\n};\n\nexports.parseSimulcastStreamList = function (str) {\n  return str.split(';').map(function (stream) {\n    return stream.split(',').map(function (format) {\n      var scid, paused = false;\n\n      if (format[0] !== '~') {\n        scid = toIntIfInt(format);\n      } else {\n        scid = toIntIfInt(format.substring(1, format.length));\n        paused = true;\n      }\n\n      return {\n        scid: scid,\n        paused: paused\n      };\n    });\n  });\n};\n", "var grammar = require('./grammar');\n\n// customized util.format - discards excess arguments and can void middle ones\nvar formatRegExp = /%[sdv%]/g;\nvar format = function (formatStr) {\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  return formatStr.replace(formatRegExp, function (x) {\n    if (i >= len) {\n      return x; // missing argument\n    }\n    var arg = args[i];\n    i += 1;\n    switch (x) {\n    case '%%':\n      return '%';\n    case '%s':\n      return String(arg);\n    case '%d':\n      return Number(arg);\n    case '%v':\n      return '';\n    }\n  });\n  // NB: we discard excess arguments - they are typically undefined from makeLine\n};\n\nvar makeLine = function (type, obj, location) {\n  var str = obj.format instanceof Function ?\n    (obj.format(obj.push ? location : location[obj.name])) :\n    obj.format;\n\n  var args = [type + '=' + str];\n  if (obj.names) {\n    for (var i = 0; i < obj.names.length; i += 1) {\n      var n = obj.names[i];\n      if (obj.name) {\n        args.push(location[obj.name][n]);\n      }\n      else { // for mLine and push attributes\n        args.push(location[obj.names[i]]);\n      }\n    }\n  }\n  else {\n    args.push(location[obj.name]);\n  }\n  return format.apply(null, args);\n};\n\n// RFC specified order\n// TODO: extend this with all the rest\nvar defaultOuterOrder = [\n  'v', 'o', 's', 'i',\n  'u', 'e', 'p', 'c',\n  'b', 't', 'r', 'z', 'a'\n];\nvar defaultInnerOrder = ['i', 'c', 'b', 'a'];\n\n\nmodule.exports = function (session, opts) {\n  opts = opts || {};\n  // ensure certain properties exist\n  if (session.version == null) {\n    session.version = 0; // 'v=0' must be there (only defined version atm)\n  }\n  if (session.name == null) {\n    session.name = ' '; // 's= ' must be there if no meaningful name set\n  }\n  session.media.forEach(function (mLine) {\n    if (mLine.payloads == null) {\n      mLine.payloads = '';\n    }\n  });\n\n  var outerOrder = opts.outerOrder || defaultOuterOrder;\n  var innerOrder = opts.innerOrder || defaultInnerOrder;\n  var sdp = [];\n\n  // loop through outerOrder for matching properties on session\n  outerOrder.forEach(function (type) {\n    grammar[type].forEach(function (obj) {\n      if (obj.name in session && session[obj.name] != null) {\n        sdp.push(makeLine(type, obj, session));\n      }\n      else if (obj.push in session && session[obj.push] != null) {\n        session[obj.push].forEach(function (el) {\n          sdp.push(makeLine(type, obj, el));\n        });\n      }\n    });\n  });\n\n  // then for each media line, follow the innerOrder\n  session.media.forEach(function (mLine) {\n    sdp.push(makeLine('m', grammar.m[0], mLine));\n\n    innerOrder.forEach(function (type) {\n      grammar[type].forEach(function (obj) {\n        if (obj.name in mLine && mLine[obj.name] != null) {\n          sdp.push(makeLine(type, obj, mLine));\n        }\n        else if (obj.push in mLine && mLine[obj.push] != null) {\n          mLine[obj.push].forEach(function (el) {\n            sdp.push(makeLine(type, obj, el));\n          });\n        }\n      });\n    });\n  });\n\n  return sdp.join('\\r\\n') + '\\r\\n';\n};\n", "var parser = require('./parser');\nvar writer = require('./writer');\n\nexports.write = writer;\nexports.parse = parser.parse;\nexports.parseParams = parser.parseParams;\nexports.parseFmtpConfig = parser.parseFmtpConfig; // Alias of parseParams().\nexports.parsePayloads = parser.parsePayloads;\nexports.parseRemoteCandidates = parser.parseRemoteCandidates;\nexports.parseImageAttributes = parser.parseImageAttributes;\nexports.parseSimulcastStreamList = parser.parseSimulcastStreamList;\n", "/** @license React v16.13.1\n * react-is.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';var b=\"function\"===typeof Symbol&&Symbol.for,c=b?Symbol.for(\"react.element\"):60103,d=b?Symbol.for(\"react.portal\"):60106,e=b?Symbol.for(\"react.fragment\"):60107,f=b?Symbol.for(\"react.strict_mode\"):60108,g=b?Symbol.for(\"react.profiler\"):60114,h=b?Symbol.for(\"react.provider\"):60109,k=b?Symbol.for(\"react.context\"):60110,l=b?Symbol.for(\"react.async_mode\"):60111,m=b?Symbol.for(\"react.concurrent_mode\"):60111,n=b?Symbol.for(\"react.forward_ref\"):60112,p=b?Symbol.for(\"react.suspense\"):60113,q=b?\nSymbol.for(\"react.suspense_list\"):60120,r=b?Symbol.for(\"react.memo\"):60115,t=b?Symbol.for(\"react.lazy\"):60116,v=b?Symbol.for(\"react.block\"):60121,w=b?Symbol.for(\"react.fundamental\"):60117,x=b?Symbol.for(\"react.responder\"):60118,y=b?Symbol.for(\"react.scope\"):60119;\nfunction z(a){if(\"object\"===typeof a&&null!==a){var u=a.$$typeof;switch(u){case c:switch(a=a.type,a){case l:case m:case e:case g:case f:case p:return a;default:switch(a=a&&a.$$typeof,a){case k:case n:case t:case r:case h:return a;default:return u}}case d:return u}}}function A(a){return z(a)===m}exports.AsyncMode=l;exports.ConcurrentMode=m;exports.ContextConsumer=k;exports.ContextProvider=h;exports.Element=c;exports.ForwardRef=n;exports.Fragment=e;exports.Lazy=t;exports.Memo=r;exports.Portal=d;\nexports.Profiler=g;exports.StrictMode=f;exports.Suspense=p;exports.isAsyncMode=function(a){return A(a)||z(a)===l};exports.isConcurrentMode=A;exports.isContextConsumer=function(a){return z(a)===k};exports.isContextProvider=function(a){return z(a)===h};exports.isElement=function(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===c};exports.isForwardRef=function(a){return z(a)===n};exports.isFragment=function(a){return z(a)===e};exports.isLazy=function(a){return z(a)===t};\nexports.isMemo=function(a){return z(a)===r};exports.isPortal=function(a){return z(a)===d};exports.isProfiler=function(a){return z(a)===g};exports.isStrictMode=function(a){return z(a)===f};exports.isSuspense=function(a){return z(a)===p};\nexports.isValidElementType=function(a){return\"string\"===typeof a||\"function\"===typeof a||a===e||a===m||a===g||a===f||a===p||a===q||\"object\"===typeof a&&null!==a&&(a.$$typeof===t||a.$$typeof===r||a.$$typeof===h||a.$$typeof===k||a.$$typeof===n||a.$$typeof===w||a.$$typeof===x||a.$$typeof===y||a.$$typeof===v)};exports.typeOf=z;\n", "/** @license React v16.13.1\n * react-is.development.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n\n\nif (process.env.NODE_ENV !== \"production\") {\n  (function() {\n'use strict';\n\n// The Symbol used to tag the ReactElement-like types. If there is no native Symbol\n// nor polyfill, then a plain number is used for performance.\nvar hasSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = hasSymbol ? Symbol.for('react.element') : 0xeac7;\nvar REACT_PORTAL_TYPE = hasSymbol ? Symbol.for('react.portal') : 0xeaca;\nvar REACT_FRAGMENT_TYPE = hasSymbol ? Symbol.for('react.fragment') : 0xeacb;\nvar REACT_STRICT_MODE_TYPE = hasSymbol ? Symbol.for('react.strict_mode') : 0xeacc;\nvar REACT_PROFILER_TYPE = hasSymbol ? Symbol.for('react.profiler') : 0xead2;\nvar REACT_PROVIDER_TYPE = hasSymbol ? Symbol.for('react.provider') : 0xeacd;\nvar REACT_CONTEXT_TYPE = hasSymbol ? Symbol.for('react.context') : 0xeace; // TODO: We don't use AsyncMode or ConcurrentMode anymore. They were temporary\n// (unstable) APIs that have been removed. Can we remove the symbols?\n\nvar REACT_ASYNC_MODE_TYPE = hasSymbol ? Symbol.for('react.async_mode') : 0xeacf;\nvar REACT_CONCURRENT_MODE_TYPE = hasSymbol ? Symbol.for('react.concurrent_mode') : 0xeacf;\nvar REACT_FORWARD_REF_TYPE = hasSymbol ? Symbol.for('react.forward_ref') : 0xead0;\nvar REACT_SUSPENSE_TYPE = hasSymbol ? Symbol.for('react.suspense') : 0xead1;\nvar REACT_SUSPENSE_LIST_TYPE = hasSymbol ? Symbol.for('react.suspense_list') : 0xead8;\nvar REACT_MEMO_TYPE = hasSymbol ? Symbol.for('react.memo') : 0xead3;\nvar REACT_LAZY_TYPE = hasSymbol ? Symbol.for('react.lazy') : 0xead4;\nvar REACT_BLOCK_TYPE = hasSymbol ? Symbol.for('react.block') : 0xead9;\nvar REACT_FUNDAMENTAL_TYPE = hasSymbol ? Symbol.for('react.fundamental') : 0xead5;\nvar REACT_RESPONDER_TYPE = hasSymbol ? Symbol.for('react.responder') : 0xead6;\nvar REACT_SCOPE_TYPE = hasSymbol ? Symbol.for('react.scope') : 0xead7;\n\nfunction isValidElementType(type) {\n  return typeof type === 'string' || typeof type === 'function' || // Note: its typeof might be other than 'symbol' or 'number' if it's a polyfill.\n  type === REACT_FRAGMENT_TYPE || type === REACT_CONCURRENT_MODE_TYPE || type === REACT_PROFILER_TYPE || type === REACT_STRICT_MODE_TYPE || type === REACT_SUSPENSE_TYPE || type === REACT_SUSPENSE_LIST_TYPE || typeof type === 'object' && type !== null && (type.$$typeof === REACT_LAZY_TYPE || type.$$typeof === REACT_MEMO_TYPE || type.$$typeof === REACT_PROVIDER_TYPE || type.$$typeof === REACT_CONTEXT_TYPE || type.$$typeof === REACT_FORWARD_REF_TYPE || type.$$typeof === REACT_FUNDAMENTAL_TYPE || type.$$typeof === REACT_RESPONDER_TYPE || type.$$typeof === REACT_SCOPE_TYPE || type.$$typeof === REACT_BLOCK_TYPE);\n}\n\nfunction typeOf(object) {\n  if (typeof object === 'object' && object !== null) {\n    var $$typeof = object.$$typeof;\n\n    switch ($$typeof) {\n      case REACT_ELEMENT_TYPE:\n        var type = object.type;\n\n        switch (type) {\n          case REACT_ASYNC_MODE_TYPE:\n          case REACT_CONCURRENT_MODE_TYPE:\n          case REACT_FRAGMENT_TYPE:\n          case REACT_PROFILER_TYPE:\n          case REACT_STRICT_MODE_TYPE:\n          case REACT_SUSPENSE_TYPE:\n            return type;\n\n          default:\n            var $$typeofType = type && type.$$typeof;\n\n            switch ($$typeofType) {\n              case REACT_CONTEXT_TYPE:\n              case REACT_FORWARD_REF_TYPE:\n              case REACT_LAZY_TYPE:\n              case REACT_MEMO_TYPE:\n              case REACT_PROVIDER_TYPE:\n                return $$typeofType;\n\n              default:\n                return $$typeof;\n            }\n\n        }\n\n      case REACT_PORTAL_TYPE:\n        return $$typeof;\n    }\n  }\n\n  return undefined;\n} // AsyncMode is deprecated along with isAsyncMode\n\nvar AsyncMode = REACT_ASYNC_MODE_TYPE;\nvar ConcurrentMode = REACT_CONCURRENT_MODE_TYPE;\nvar ContextConsumer = REACT_CONTEXT_TYPE;\nvar ContextProvider = REACT_PROVIDER_TYPE;\nvar Element = REACT_ELEMENT_TYPE;\nvar ForwardRef = REACT_FORWARD_REF_TYPE;\nvar Fragment = REACT_FRAGMENT_TYPE;\nvar Lazy = REACT_LAZY_TYPE;\nvar Memo = REACT_MEMO_TYPE;\nvar Portal = REACT_PORTAL_TYPE;\nvar Profiler = REACT_PROFILER_TYPE;\nvar StrictMode = REACT_STRICT_MODE_TYPE;\nvar Suspense = REACT_SUSPENSE_TYPE;\nvar hasWarnedAboutDeprecatedIsAsyncMode = false; // AsyncMode should be deprecated\n\nfunction isAsyncMode(object) {\n  {\n    if (!hasWarnedAboutDeprecatedIsAsyncMode) {\n      hasWarnedAboutDeprecatedIsAsyncMode = true; // Using console['warn'] to evade Babel and ESLint\n\n      console['warn']('The ReactIs.isAsyncMode() alias has been deprecated, ' + 'and will be removed in React 17+. Update your code to use ' + 'ReactIs.isConcurrentMode() instead. It has the exact same API.');\n    }\n  }\n\n  return isConcurrentMode(object) || typeOf(object) === REACT_ASYNC_MODE_TYPE;\n}\nfunction isConcurrentMode(object) {\n  return typeOf(object) === REACT_CONCURRENT_MODE_TYPE;\n}\nfunction isContextConsumer(object) {\n  return typeOf(object) === REACT_CONTEXT_TYPE;\n}\nfunction isContextProvider(object) {\n  return typeOf(object) === REACT_PROVIDER_TYPE;\n}\nfunction isElement(object) {\n  return typeof object === 'object' && object !== null && object.$$typeof === REACT_ELEMENT_TYPE;\n}\nfunction isForwardRef(object) {\n  return typeOf(object) === REACT_FORWARD_REF_TYPE;\n}\nfunction isFragment(object) {\n  return typeOf(object) === REACT_FRAGMENT_TYPE;\n}\nfunction isLazy(object) {\n  return typeOf(object) === REACT_LAZY_TYPE;\n}\nfunction isMemo(object) {\n  return typeOf(object) === REACT_MEMO_TYPE;\n}\nfunction isPortal(object) {\n  return typeOf(object) === REACT_PORTAL_TYPE;\n}\nfunction isProfiler(object) {\n  return typeOf(object) === REACT_PROFILER_TYPE;\n}\nfunction isStrictMode(object) {\n  return typeOf(object) === REACT_STRICT_MODE_TYPE;\n}\nfunction isSuspense(object) {\n  return typeOf(object) === REACT_SUSPENSE_TYPE;\n}\n\nexports.AsyncMode = AsyncMode;\nexports.ConcurrentMode = ConcurrentMode;\nexports.ContextConsumer = ContextConsumer;\nexports.ContextProvider = ContextProvider;\nexports.Element = Element;\nexports.ForwardRef = ForwardRef;\nexports.Fragment = Fragment;\nexports.Lazy = Lazy;\nexports.Memo = Memo;\nexports.Portal = Portal;\nexports.Profiler = Profiler;\nexports.StrictMode = StrictMode;\nexports.Suspense = Suspense;\nexports.isAsyncMode = isAsyncMode;\nexports.isConcurrentMode = isConcurrentMode;\nexports.isContextConsumer = isContextConsumer;\nexports.isContextProvider = isContextProvider;\nexports.isElement = isElement;\nexports.isForwardRef = isForwardRef;\nexports.isFragment = isFragment;\nexports.isLazy = isLazy;\nexports.isMemo = isMemo;\nexports.isPortal = isPortal;\nexports.isProfiler = isProfiler;\nexports.isStrictMode = isStrictMode;\nexports.isSuspense = isSuspense;\nexports.isValidElementType = isValidElementType;\nexports.typeOf = typeOf;\n  })();\n}\n", "'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-is.production.min.js');\n} else {\n  module.exports = require('./cjs/react-is.development.js');\n}\n", "/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n", "/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n", "module.exports = Function.call.bind(Object.prototype.hasOwnProperty);\n", "/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar printWarning = function() {};\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n  var loggedTypeFailures = {};\n  var has = require('./lib/has');\n\n  printWarning = function(text) {\n    var message = 'Warning: ' + text;\n    if (typeof console !== 'undefined') {\n      console.error(message);\n    }\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) { /**/ }\n  };\n}\n\n/**\n * Assert that the values match with the type specs.\n * Error messages are memorized and will only be shown once.\n *\n * @param {object} typeSpecs Map of name to a ReactPropType\n * @param {object} values Runtime values that need to be type-checked\n * @param {string} location e.g. \"prop\", \"context\", \"child context\"\n * @param {string} componentName Name of the component for error messages.\n * @param {?Function} getStack Returns the component stack.\n * @private\n */\nfunction checkPropTypes(typeSpecs, values, location, componentName, getStack) {\n  if (process.env.NODE_ENV !== 'production') {\n    for (var typeSpecName in typeSpecs) {\n      if (has(typeSpecs, typeSpecName)) {\n        var error;\n        // Prop type validation may throw. In case they do, we don't want to\n        // fail the render phase where it didn't fail before. So we log it.\n        // After these have been cleaned up, we'll let them throw.\n        try {\n          // This is intentionally an invariant that gets caught. It's the same\n          // behavior as without this statement except with a better message.\n          if (typeof typeSpecs[typeSpecName] !== 'function') {\n            var err = Error(\n              (componentName || 'React class') + ': ' + location + ' type `' + typeSpecName + '` is invalid; ' +\n              'it must be a function, usually from the `prop-types` package, but received `' + typeof typeSpecs[typeSpecName] + '`.' +\n              'This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.'\n            );\n            err.name = 'Invariant Violation';\n            throw err;\n          }\n          error = typeSpecs[typeSpecName](values, typeSpecName, componentName, location, null, ReactPropTypesSecret);\n        } catch (ex) {\n          error = ex;\n        }\n        if (error && !(error instanceof Error)) {\n          printWarning(\n            (componentName || 'React class') + ': type specification of ' +\n            location + ' `' + typeSpecName + '` is invalid; the type checker ' +\n            'function must return `null` or an `Error` but returned a ' + typeof error + '. ' +\n            'You may have forgotten to pass an argument to the type checker ' +\n            'creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and ' +\n            'shape all require an argument).'\n          );\n        }\n        if (error instanceof Error && !(error.message in loggedTypeFailures)) {\n          // Only monitor this failure once because there tends to be a lot of the\n          // same error.\n          loggedTypeFailures[error.message] = true;\n\n          var stack = getStack ? getStack() : '';\n\n          printWarning(\n            'Failed ' + location + ' type: ' + error.message + (stack != null ? stack : '')\n          );\n        }\n      }\n    }\n  }\n}\n\n/**\n * Resets warning cache when testing.\n *\n * @private\n */\ncheckPropTypes.resetWarningCache = function() {\n  if (process.env.NODE_ENV !== 'production') {\n    loggedTypeFailures = {};\n  }\n}\n\nmodule.exports = checkPropTypes;\n", "/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactIs = require('react-is');\nvar assign = require('object-assign');\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\nvar has = require('./lib/has');\nvar checkPropTypes = require('./checkPropTypes');\n\nvar printWarning = function() {};\n\nif (process.env.NODE_ENV !== 'production') {\n  printWarning = function(text) {\n    var message = 'Warning: ' + text;\n    if (typeof console !== 'undefined') {\n      console.error(message);\n    }\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) {}\n  };\n}\n\nfunction emptyFunctionThatReturnsNull() {\n  return null;\n}\n\nmodule.exports = function(isValidElement, throwOnDirectAccess) {\n  /* global Symbol */\n  var ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\n  var FAUX_ITERATOR_SYMBOL = '@@iterator'; // Before Symbol spec.\n\n  /**\n   * Returns the iterator method function contained on the iterable object.\n   *\n   * Be sure to invoke the function with the iterable as context:\n   *\n   *     var iteratorFn = getIteratorFn(myIterable);\n   *     if (iteratorFn) {\n   *       var iterator = iteratorFn.call(myIterable);\n   *       ...\n   *     }\n   *\n   * @param {?object} maybeIterable\n   * @return {?function}\n   */\n  function getIteratorFn(maybeIterable) {\n    var iteratorFn = maybeIterable && (ITERATOR_SYMBOL && maybeIterable[ITERATOR_SYMBOL] || maybeIterable[FAUX_ITERATOR_SYMBOL]);\n    if (typeof iteratorFn === 'function') {\n      return iteratorFn;\n    }\n  }\n\n  /**\n   * Collection of methods that allow declaration and validation of props that are\n   * supplied to React components. Example usage:\n   *\n   *   var Props = require('ReactPropTypes');\n   *   var MyArticle = React.createClass({\n   *     propTypes: {\n   *       // An optional string prop named \"description\".\n   *       description: Props.string,\n   *\n   *       // A required enum prop named \"category\".\n   *       category: Props.oneOf(['News','Photos']).isRequired,\n   *\n   *       // A prop named \"dialog\" that requires an instance of Dialog.\n   *       dialog: Props.instanceOf(Dialog).isRequired\n   *     },\n   *     render: function() { ... }\n   *   });\n   *\n   * A more formal specification of how these methods are used:\n   *\n   *   type := array|bool|func|object|number|string|oneOf([...])|instanceOf(...)\n   *   decl := ReactPropTypes.{type}(.isRequired)?\n   *\n   * Each and every declaration produces a function with the same signature. This\n   * allows the creation of custom validation functions. For example:\n   *\n   *  var MyLink = React.createClass({\n   *    propTypes: {\n   *      // An optional string or URI prop named \"href\".\n   *      href: function(props, propName, componentName) {\n   *        var propValue = props[propName];\n   *        if (propValue != null && typeof propValue !== 'string' &&\n   *            !(propValue instanceof URI)) {\n   *          return new Error(\n   *            'Expected a string or an URI for ' + propName + ' in ' +\n   *            componentName\n   *          );\n   *        }\n   *      }\n   *    },\n   *    render: function() {...}\n   *  });\n   *\n   * @internal\n   */\n\n  var ANONYMOUS = '<<anonymous>>';\n\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithThrowingShims.js`.\n  var ReactPropTypes = {\n    array: createPrimitiveTypeChecker('array'),\n    bigint: createPrimitiveTypeChecker('bigint'),\n    bool: createPrimitiveTypeChecker('boolean'),\n    func: createPrimitiveTypeChecker('function'),\n    number: createPrimitiveTypeChecker('number'),\n    object: createPrimitiveTypeChecker('object'),\n    string: createPrimitiveTypeChecker('string'),\n    symbol: createPrimitiveTypeChecker('symbol'),\n\n    any: createAnyTypeChecker(),\n    arrayOf: createArrayOfTypeChecker,\n    element: createElementTypeChecker(),\n    elementType: createElementTypeTypeChecker(),\n    instanceOf: createInstanceTypeChecker,\n    node: createNodeChecker(),\n    objectOf: createObjectOfTypeChecker,\n    oneOf: createEnumTypeChecker,\n    oneOfType: createUnionTypeChecker,\n    shape: createShapeTypeChecker,\n    exact: createStrictShapeTypeChecker,\n  };\n\n  /**\n   * inlined Object.is polyfill to avoid requiring consumers ship their own\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n   */\n  /*eslint-disable no-self-compare*/\n  function is(x, y) {\n    // SameValue algorithm\n    if (x === y) {\n      // Steps 1-5, 7-10\n      // Steps 6.b-6.e: +0 != -0\n      return x !== 0 || 1 / x === 1 / y;\n    } else {\n      // Step 6.a: NaN == NaN\n      return x !== x && y !== y;\n    }\n  }\n  /*eslint-enable no-self-compare*/\n\n  /**\n   * We use an Error-like object for backward compatibility as people may call\n   * PropTypes directly and inspect their output. However, we don't use real\n   * Errors anymore. We don't inspect their stack anyway, and creating them\n   * is prohibitively expensive if they are created too often, such as what\n   * happens in oneOfType() for any type before the one that matched.\n   */\n  function PropTypeError(message, data) {\n    this.message = message;\n    this.data = data && typeof data === 'object' ? data: {};\n    this.stack = '';\n  }\n  // Make `instanceof Error` still work for returned errors.\n  PropTypeError.prototype = Error.prototype;\n\n  function createChainableTypeChecker(validate) {\n    if (process.env.NODE_ENV !== 'production') {\n      var manualPropTypeCallCache = {};\n      var manualPropTypeWarningCount = 0;\n    }\n    function checkType(isRequired, props, propName, componentName, location, propFullName, secret) {\n      componentName = componentName || ANONYMOUS;\n      propFullName = propFullName || propName;\n\n      if (secret !== ReactPropTypesSecret) {\n        if (throwOnDirectAccess) {\n          // New behavior only for users of `prop-types` package\n          var err = new Error(\n            'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n            'Use `PropTypes.checkPropTypes()` to call them. ' +\n            'Read more at http://fb.me/use-check-prop-types'\n          );\n          err.name = 'Invariant Violation';\n          throw err;\n        } else if (process.env.NODE_ENV !== 'production' && typeof console !== 'undefined') {\n          // Old behavior for people using React.PropTypes\n          var cacheKey = componentName + ':' + propName;\n          if (\n            !manualPropTypeCallCache[cacheKey] &&\n            // Avoid spamming the console because they are often not actionable except for lib authors\n            manualPropTypeWarningCount < 3\n          ) {\n            printWarning(\n              'You are manually calling a React.PropTypes validation ' +\n              'function for the `' + propFullName + '` prop on `' + componentName + '`. This is deprecated ' +\n              'and will throw in the standalone `prop-types` package. ' +\n              'You may be seeing this warning due to a third-party PropTypes ' +\n              'library. See https://fb.me/react-warning-dont-call-proptypes ' + 'for details.'\n            );\n            manualPropTypeCallCache[cacheKey] = true;\n            manualPropTypeWarningCount++;\n          }\n        }\n      }\n      if (props[propName] == null) {\n        if (isRequired) {\n          if (props[propName] === null) {\n            return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required ' + ('in `' + componentName + '`, but its value is `null`.'));\n          }\n          return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required in ' + ('`' + componentName + '`, but its value is `undefined`.'));\n        }\n        return null;\n      } else {\n        return validate(props, propName, componentName, location, propFullName);\n      }\n    }\n\n    var chainedCheckType = checkType.bind(null, false);\n    chainedCheckType.isRequired = checkType.bind(null, true);\n\n    return chainedCheckType;\n  }\n\n  function createPrimitiveTypeChecker(expectedType) {\n    function validate(props, propName, componentName, location, propFullName, secret) {\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== expectedType) {\n        // `propValue` being instance of, say, date/regexp, pass the 'object'\n        // check, but we can offer a more precise error message here rather than\n        // 'of type `object`'.\n        var preciseType = getPreciseType(propValue);\n\n        return new PropTypeError(\n          'Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + preciseType + '` supplied to `' + componentName + '`, expected ') + ('`' + expectedType + '`.'),\n          {expectedType: expectedType}\n        );\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createAnyTypeChecker() {\n    return createChainableTypeChecker(emptyFunctionThatReturnsNull);\n  }\n\n  function createArrayOfTypeChecker(typeChecker) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (typeof typeChecker !== 'function') {\n        return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside arrayOf.');\n      }\n      var propValue = props[propName];\n      if (!Array.isArray(propValue)) {\n        var propType = getPropType(propValue);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an array.'));\n      }\n      for (var i = 0; i < propValue.length; i++) {\n        var error = typeChecker(propValue, i, componentName, location, propFullName + '[' + i + ']', ReactPropTypesSecret);\n        if (error instanceof Error) {\n          return error;\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createElementTypeChecker() {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      if (!isValidElement(propValue)) {\n        var propType = getPropType(propValue);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected a single ReactElement.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createElementTypeTypeChecker() {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      if (!ReactIs.isValidElementType(propValue)) {\n        var propType = getPropType(propValue);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected a single ReactElement type.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createInstanceTypeChecker(expectedClass) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (!(props[propName] instanceof expectedClass)) {\n        var expectedClassName = expectedClass.name || ANONYMOUS;\n        var actualClassName = getClassName(props[propName]);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + actualClassName + '` supplied to `' + componentName + '`, expected ') + ('instance of `' + expectedClassName + '`.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createEnumTypeChecker(expectedValues) {\n    if (!Array.isArray(expectedValues)) {\n      if (process.env.NODE_ENV !== 'production') {\n        if (arguments.length > 1) {\n          printWarning(\n            'Invalid arguments supplied to oneOf, expected an array, got ' + arguments.length + ' arguments. ' +\n            'A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).'\n          );\n        } else {\n          printWarning('Invalid argument supplied to oneOf, expected an array.');\n        }\n      }\n      return emptyFunctionThatReturnsNull;\n    }\n\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      for (var i = 0; i < expectedValues.length; i++) {\n        if (is(propValue, expectedValues[i])) {\n          return null;\n        }\n      }\n\n      var valuesString = JSON.stringify(expectedValues, function replacer(key, value) {\n        var type = getPreciseType(value);\n        if (type === 'symbol') {\n          return String(value);\n        }\n        return value;\n      });\n      return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of value `' + String(propValue) + '` ' + ('supplied to `' + componentName + '`, expected one of ' + valuesString + '.'));\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createObjectOfTypeChecker(typeChecker) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (typeof typeChecker !== 'function') {\n        return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside objectOf.');\n      }\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== 'object') {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an object.'));\n      }\n      for (var key in propValue) {\n        if (has(propValue, key)) {\n          var error = typeChecker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n          if (error instanceof Error) {\n            return error;\n          }\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createUnionTypeChecker(arrayOfTypeCheckers) {\n    if (!Array.isArray(arrayOfTypeCheckers)) {\n      process.env.NODE_ENV !== 'production' ? printWarning('Invalid argument supplied to oneOfType, expected an instance of array.') : void 0;\n      return emptyFunctionThatReturnsNull;\n    }\n\n    for (var i = 0; i < arrayOfTypeCheckers.length; i++) {\n      var checker = arrayOfTypeCheckers[i];\n      if (typeof checker !== 'function') {\n        printWarning(\n          'Invalid argument supplied to oneOfType. Expected an array of check functions, but ' +\n          'received ' + getPostfixForTypeWarning(checker) + ' at index ' + i + '.'\n        );\n        return emptyFunctionThatReturnsNull;\n      }\n    }\n\n    function validate(props, propName, componentName, location, propFullName) {\n      var expectedTypes = [];\n      for (var i = 0; i < arrayOfTypeCheckers.length; i++) {\n        var checker = arrayOfTypeCheckers[i];\n        var checkerResult = checker(props, propName, componentName, location, propFullName, ReactPropTypesSecret);\n        if (checkerResult == null) {\n          return null;\n        }\n        if (checkerResult.data && has(checkerResult.data, 'expectedType')) {\n          expectedTypes.push(checkerResult.data.expectedType);\n        }\n      }\n      var expectedTypesMessage = (expectedTypes.length > 0) ? ', expected one of type [' + expectedTypes.join(', ') + ']': '';\n      return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`' + expectedTypesMessage + '.'));\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createNodeChecker() {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (!isNode(props[propName])) {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`, expected a ReactNode.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function invalidValidatorError(componentName, location, propFullName, key, type) {\n    return new PropTypeError(\n      (componentName || 'React class') + ': ' + location + ' type `' + propFullName + '.' + key + '` is invalid; ' +\n      'it must be a function, usually from the `prop-types` package, but received `' + type + '`.'\n    );\n  }\n\n  function createShapeTypeChecker(shapeTypes) {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== 'object') {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type `' + propType + '` ' + ('supplied to `' + componentName + '`, expected `object`.'));\n      }\n      for (var key in shapeTypes) {\n        var checker = shapeTypes[key];\n        if (typeof checker !== 'function') {\n          return invalidValidatorError(componentName, location, propFullName, key, getPreciseType(checker));\n        }\n        var error = checker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n        if (error) {\n          return error;\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createStrictShapeTypeChecker(shapeTypes) {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== 'object') {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type `' + propType + '` ' + ('supplied to `' + componentName + '`, expected `object`.'));\n      }\n      // We need to check all keys in case some are required but missing from props.\n      var allKeys = assign({}, props[propName], shapeTypes);\n      for (var key in allKeys) {\n        var checker = shapeTypes[key];\n        if (has(shapeTypes, key) && typeof checker !== 'function') {\n          return invalidValidatorError(componentName, location, propFullName, key, getPreciseType(checker));\n        }\n        if (!checker) {\n          return new PropTypeError(\n            'Invalid ' + location + ' `' + propFullName + '` key `' + key + '` supplied to `' + componentName + '`.' +\n            '\\nBad object: ' + JSON.stringify(props[propName], null, '  ') +\n            '\\nValid keys: ' + JSON.stringify(Object.keys(shapeTypes), null, '  ')\n          );\n        }\n        var error = checker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n        if (error) {\n          return error;\n        }\n      }\n      return null;\n    }\n\n    return createChainableTypeChecker(validate);\n  }\n\n  function isNode(propValue) {\n    switch (typeof propValue) {\n      case 'number':\n      case 'string':\n      case 'undefined':\n        return true;\n      case 'boolean':\n        return !propValue;\n      case 'object':\n        if (Array.isArray(propValue)) {\n          return propValue.every(isNode);\n        }\n        if (propValue === null || isValidElement(propValue)) {\n          return true;\n        }\n\n        var iteratorFn = getIteratorFn(propValue);\n        if (iteratorFn) {\n          var iterator = iteratorFn.call(propValue);\n          var step;\n          if (iteratorFn !== propValue.entries) {\n            while (!(step = iterator.next()).done) {\n              if (!isNode(step.value)) {\n                return false;\n              }\n            }\n          } else {\n            // Iterator will provide entry [k,v] tuples rather than values.\n            while (!(step = iterator.next()).done) {\n              var entry = step.value;\n              if (entry) {\n                if (!isNode(entry[1])) {\n                  return false;\n                }\n              }\n            }\n          }\n        } else {\n          return false;\n        }\n\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  function isSymbol(propType, propValue) {\n    // Native Symbol.\n    if (propType === 'symbol') {\n      return true;\n    }\n\n    // falsy value can't be a Symbol\n    if (!propValue) {\n      return false;\n    }\n\n    // 19.4.3.5 Symbol.prototype[@@toStringTag] === 'Symbol'\n    if (propValue['@@toStringTag'] === 'Symbol') {\n      return true;\n    }\n\n    // Fallback for non-spec compliant Symbols which are polyfilled.\n    if (typeof Symbol === 'function' && propValue instanceof Symbol) {\n      return true;\n    }\n\n    return false;\n  }\n\n  // Equivalent of `typeof` but with special handling for array and regexp.\n  function getPropType(propValue) {\n    var propType = typeof propValue;\n    if (Array.isArray(propValue)) {\n      return 'array';\n    }\n    if (propValue instanceof RegExp) {\n      // Old webkits (at least until Android 4.0) return 'function' rather than\n      // 'object' for typeof a RegExp. We'll normalize this here so that /bla/\n      // passes PropTypes.object.\n      return 'object';\n    }\n    if (isSymbol(propType, propValue)) {\n      return 'symbol';\n    }\n    return propType;\n  }\n\n  // This handles more types than `getPropType`. Only used for error messages.\n  // See `createPrimitiveTypeChecker`.\n  function getPreciseType(propValue) {\n    if (typeof propValue === 'undefined' || propValue === null) {\n      return '' + propValue;\n    }\n    var propType = getPropType(propValue);\n    if (propType === 'object') {\n      if (propValue instanceof Date) {\n        return 'date';\n      } else if (propValue instanceof RegExp) {\n        return 'regexp';\n      }\n    }\n    return propType;\n  }\n\n  // Returns a string that is postfixed to a warning about an invalid type.\n  // For example, \"undefined\" or \"of type array\"\n  function getPostfixForTypeWarning(value) {\n    var type = getPreciseType(value);\n    switch (type) {\n      case 'array':\n      case 'object':\n        return 'an ' + type;\n      case 'boolean':\n      case 'date':\n      case 'regexp':\n        return 'a ' + type;\n      default:\n        return type;\n    }\n  }\n\n  // Returns class name of the object, if any.\n  function getClassName(propValue) {\n    if (!propValue.constructor || !propValue.constructor.name) {\n      return ANONYMOUS;\n    }\n    return propValue.constructor.name;\n  }\n\n  ReactPropTypes.checkPropTypes = checkPropTypes;\n  ReactPropTypes.resetWarningCache = checkPropTypes.resetWarningCache;\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n", "/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n", "/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n", "export * from './Button';\nexport * from './Text';\nexport * from './IconButton';\nexport * from './Layout';\nexport * from './Avatar';\nexport * from './Divider';\nexport * from './Switch';\nexport * from './Tooltip';\nexport * from './Select';\nexport * from './Slider';\nexport * from './Modal';\nexport * from './Loading';\nexport * from './Input';\nexport * from './VideoTile';\nexport * from './VideoList';\nexport * from './Pagination';\nexport * from './Dropdown';\nexport { textEllipsis, flexCenter, slideLeftAndFade } from './utils';\nexport * from './Video';\nexport * from './TileMenu';\nexport * from './AudioLevel';\nexport * from './Popover';\nexport * from './Stats';\nexport * from './Theme';\nexport * from './Checkbox';\nexport * from './Label';\nexport * from './RadioGroup';\nexport * from './Toast';\nexport * from './Accordion';\nexport * from './Fieldset';\nexport * from './Footer';\nexport * as HMSSelect from './ReactSelect';\nexport * from './Tabs';\nexport * from './QRCode';\nexport * from './Link';\nexport * from './Collapsible';\nexport * from './Prebuilt';\nexport * from './Progress';\nexport * from './context/DialogContext';\nexport * from './TextArea';\nexport * from './Diagnostics';\n", "export { Button } from './Button';\n", "import React, { ComponentPropsWithRef, PropsWithChildren } from 'react';\nimport { Flex } from '../Layout';\nimport { Loading } from '../Loading';\nimport { styled } from '../Theme';\nimport { flexCenter } from '../utils/styles';\n\n/**\n * @param base bg color\n * @param hover hover state bg color\n * @param active active state bg color\n * @returns CSS object based on the state\n */\n\nconst getOutlinedVariants = (\n  base: string,\n  hover: string,\n  active: string,\n  disabled: string,\n  text: string,\n  textDisabled: string,\n) => {\n  return {\n    bg: 'transparent',\n    border: `solid $space$px $colors${base}`,\n    c: text,\n    '&[disabled]': {\n      c: textDisabled,\n      bg: 'transparent',\n      border: `solid $space$px $colors${disabled}`,\n      cursor: 'not-allowed',\n    },\n    '&:not([disabled]):hover': {\n      border: `solid $space$px $colors${hover}`,\n      bg: 'transparent',\n    },\n    '&:not([disabled]):active': {\n      border: `solid $space$px $colors${active}`,\n      bg: 'transparent',\n    },\n    '&:not([disabled]):focus-visible': {\n      boxShadow: `0 0 0 3px $colors${base}`,\n    },\n  };\n};\n\nconst getButtonVariants = (\n  base: string,\n  hover: string,\n  active: string,\n  disabled: string,\n  text: string,\n  textDisabled: string,\n) => {\n  return {\n    bg: base,\n    border: `1px solid ${base}`,\n    c: text,\n    '&[disabled]': {\n      c: textDisabled,\n      cursor: 'not-allowed',\n      bg: disabled,\n      border: `1px solid ${disabled}`,\n    },\n    '&:not([disabled]):hover': {\n      bg: hover,\n      border: `1px solid ${hover}`,\n    },\n    '&:not([disabled]):active': {\n      bg: active,\n      border: `1px solid ${active}`,\n    },\n    '&:not([disabled]):focus-visible': {\n      boxShadow: `0 0 0 3px ${base}`,\n    },\n  };\n};\n\nconst StyledButton = styled('button', {\n  ...flexCenter,\n  cursor: 'pointer',\n  fontFamily: '$sans',\n  lineHeight: 'inherit',\n  textTransform: 'none',\n  position: 'relative',\n  outline: 'none',\n  border: 'none',\n  fs: '$md',\n  r: '$1',\n  backgroundColor: '$primary_default',\n  fontWeight: '500',\n  whiteSpace: 'nowrap',\n  p: '$4 $8',\n  '-webkit-appearance': 'button',\n  '&:focus': {\n    outline: 'none',\n  },\n  '&:not([disabled]):focus-visible': {\n    boxShadow: '0 0 0 3px $colors$primary_default',\n  },\n  transition: 'all 0.2s  ease',\n  compoundVariants: [\n    {\n      variant: 'standard',\n      outlined: true,\n      css: getOutlinedVariants(\n        '$secondary_default',\n        '$secondary_bright',\n        '$secondary_dim',\n        '$secondary_disabled',\n        '$on_surface_high',\n        '$on_surface_low',\n      ),\n    },\n    {\n      variant: 'danger',\n      outlined: true,\n      css: getOutlinedVariants(\n        '$alert_error_default',\n        '$alert_error_bright',\n        '$alert_error_dim',\n        '$alert_error_brighter',\n        '$on_surface_high',\n        '$on_surface_low',\n      ),\n    },\n    {\n      variant: 'primary',\n      outlined: true,\n      css: getOutlinedVariants(\n        '$primary_default',\n        '$primary_bright',\n        '$primary_dim',\n        '$primary_disabled',\n        '$on_surface_high',\n        '$on_surface_low',\n      ),\n    },\n  ],\n  variants: {\n    variant: {\n      standard: getButtonVariants(\n        '$secondary_default',\n        '$secondary_bright',\n        '$secondary_dim',\n        '$secondary_disabled',\n        '$on_secondary_high',\n        '$on_secondary_low',\n      ),\n      danger: getButtonVariants(\n        '$alert_error_default',\n        '$alert_error_bright',\n        '$alert_error_dim',\n        '$alert_error_dim',\n        '$alert_error_brighter',\n        '$on_primary_low',\n      ),\n      primary: getButtonVariants(\n        '$primary_default',\n        '$primary_bright',\n        '$primary_dim',\n        '$primary_disabled',\n        '$on_primary_high',\n        '$on_primary_low',\n      ),\n    },\n    outlined: {\n      true: {},\n    },\n    icon: {\n      true: {},\n    },\n  },\n  defaultVariants: {\n    variant: 'primary',\n  },\n});\n\nexport const Button = React.forwardRef<\n  HTMLButtonElement,\n  PropsWithChildren<{ loading?: boolean } & ComponentPropsWithRef<typeof StyledButton>>\n>(({ children, loading = false, icon, ...buttonProps }, ref) => {\n  return (\n    <StyledButton {...buttonProps} ref={ref}>\n      <>\n        {loading && (\n          <Flex\n            align=\"center\"\n            justify=\"center\"\n            css={{ w: '100%', position: 'absolute', left: '0', color: '$on_primary_low' }}\n          >\n            <Loading color=\"currentColor\" />\n          </Flex>\n        )}\n        <Flex\n          align=\"center\"\n          justify=\"center\"\n          css={{ visibility: loading ? 'hidden' : 'visible', gap: icon ? '$4' : '0' }}\n        >\n          {children}\n        </Flex>\n      </>\n    </StyledButton>\n  );\n});\n", "export { Flex } from './Flex';\nexport { Box } from './Box';\n", "import { styled } from '../Theme';\n\n/**\n * @see https://tailwindcss.com/docs/space\n */\nconst gapStyles = (value: number) => {\n  return {\n    '& > * + *': {\n      marginRight: '0',\n      marginLeft: `${0.25 * value}rem`,\n    },\n  };\n};\n\nexport const Flex = styled('div', {\n  display: 'flex',\n  variants: {\n    justify: {\n      start: {\n        justifyContent: 'flex-start',\n      },\n      end: {\n        justifyContent: 'flex-end',\n      },\n      center: {\n        justifyContent: 'center',\n      },\n      between: {\n        justifyContent: 'space-between',\n      },\n      around: {\n        justifyContent: 'space-around',\n      },\n      evenly: {\n        justifyContent: 'space-evenly',\n      },\n    },\n    align: {\n      start: {\n        alignItems: 'flex-start',\n      },\n      end: {\n        alignItems: 'flex-end',\n      },\n      center: {\n        alignItems: 'center',\n      },\n      baseline: {\n        alignItems: 'baseline',\n      },\n      strech: {\n        alignItems: 'stretch',\n      },\n    },\n    direction: {\n      row: {\n        flexDirection: 'row',\n      },\n      column: {\n        flexDirection: 'column',\n      },\n      rowReverse: {\n        flexDirection: 'row-reverse',\n      },\n      columnReverse: {\n        flexDirection: 'column-reverse',\n      },\n    },\n    gap: {\n      1: gapStyles(1),\n      2: gapStyles(2),\n      3: gapStyles(3),\n      4: gapStyles(4),\n    },\n  },\n});\n", "import type * as Stitches from '@stitches/react';\nimport { createStitches } from '@stitches/react';\nimport merge from 'lodash.merge';\nimport { baseConfig, defaultMedia, defaultThemeMap, defaultUtils } from './base.config';\nimport { DEFAULT_PORTAL_CONTAINER } from '../Prebuilt/common/constants';\n\nconst HmsStitches = createStitches({\n  prefix: 'hms-ui',\n  theme: {\n    ...baseConfig.theme,\n    colors: {\n      ...baseConfig.theme.colors,\n    },\n  },\n  media: defaultMedia,\n  utils: defaultUtils,\n  themeMap: defaultThemeMap,\n});\n\nexport const {\n  theme,\n  createTheme: createThemeBase,\n  styled,\n  globalCss,\n  keyframes,\n  css,\n  getCssText,\n  config,\n} = HmsStitches;\n\nexport const globalStyles = globalCss({\n  [`${DEFAULT_PORTAL_CONTAINER} *`]: {\n    fontFamily: '$sans',\n    boxSizing: 'border-box',\n  },\n  '::-webkit-scrollbar-track': {\n    WebkitBoxShadow: 'inset 0 0 6px rgba(0, 0, 0, 0.3)',\n    boxShadow: 'inset 0 0 6px rgba(0, 0, 0, 0.3)',\n    backgroundColor: 'transparent',\n  },\n  '::-webkit-scrollbar': {\n    width: '6px',\n    height: '6px',\n    backgroundColor: 'transparent',\n  },\n  '::-webkit-scrollbar-thumb': {\n    backgroundColor: '#657080',\n    borderRadius: '5px',\n  },\n  /**\n   * needed for safari. Safari\n   * adds background color on its own\n   * on hls-viewer on fullscreen\n   */\n  '#hls-viewer-dark:fullscreen': {\n    backgroundColor: 'black !important',\n  },\n\n  '#hls-viewer-light:fullscreen': {\n    backgroundColor: 'white !important',\n  },\n});\n\nexport type ThemeType = 'default';\nexport type Theme = typeof HmsStitches.theme;\n\n/**\n * This method will be used to create custom themes or update any theme values\n * @param { type: ThemeType; className: string; theme: Theme }\n * @returns\n */\nexport const createTheme = ({\n  themeType,\n  theme,\n  className,\n}: {\n  themeType: string;\n  className?: string;\n  theme?: Partial<Theme>;\n}) => {\n  if (!themeType) {\n    throw new Error('Theme type is required');\n  }\n  const mergedTheme = merge(baseConfig.theme, theme || {});\n  return createThemeBase(className || `${themeType}-theme`, mergedTheme);\n};\n\nexport type CSS = Stitches.CSS<typeof HmsStitches>;\n", "import type * as Stitches from '@stitches/react';\nimport { defaultThemeMap as defaultStitchesThemeMap } from '@stitches/react';\n\nexport const baseConfig = {\n  theme: {\n    colors: {\n      primary_default: '#2572ED',\n      primary_bright: '#538DFF',\n      primary_dim: '#002D6D',\n      primary_disabled: '#004299',\n      on_primary_high: 'rgba(245, 249, 255, 0.95)',\n      on_primary_medium: 'rgba(224, 236, 255, 0.8)',\n      on_primary_low: 'rgba(194, 208, 229, 0.5)',\n      secondary_default: '#444954',\n      secondary_bright: '#70778B',\n      secondary_dim: '#293042',\n      secondary_disabled: '#404759',\n      on_secondary_high: '#FFFFFF',\n      on_secondary_medium: '#D3D9F0',\n      on_secondary_low: '#A4ABC0',\n      background_default: '#0B0E15',\n      background_dim: '#000000',\n      surface_default: '#191B23',\n      surface_bright: '#272A31',\n      surface_brighter: '#2E3038',\n      surface_dim: '#11131A',\n      on_surface_high: '#EFF0FA',\n      on_surface_medium: '#C5C6D0',\n      on_surface_low: '#8F9099',\n      border_default: '#1D1F27',\n      border_bright: '#272A31',\n      alert_success: '#36B37E',\n      alert_warning: '#FFAB00',\n      alert_error_default: '#C74E5B',\n      alert_error_bright: '#FFB2B6',\n      alert_error_brighter: '#FFEDEC',\n      alert_error_dim: '#270005',\n    },\n    shadows: {\n      sm: '0 0 4px 0 #0000004D',\n      md: '0 0 8px 0 #0000004D',\n    },\n    fonts: {\n      sans: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen,Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif',\n    },\n    fontSizes: {\n      h1: '6rem',\n      h2: '3.75rem',\n      h3: '3rem',\n      h4: '2.125rem',\n      h5: '1.5rem',\n      h6: '1.25rem',\n      tiny: '0.625rem',\n      xs: '0.75rem',\n      sm: '0.875rem',\n      md: '1rem',\n      lg: '1.125rem',\n    },\n    fontWeights: {\n      semiBold: 600,\n      medium: 500,\n      regular: 400,\n    },\n    lineHeights: {\n      h1: '5.75rem',\n      h2: '3.5rem',\n      h3: '3.25rem',\n      h4: '2.5rem',\n      h5: '2rem',\n      h6: '1.5rem',\n      tiny: '1rem',\n      xs: '1rem',\n      sm: '1.25rem',\n      md: '1.5rem',\n    },\n    radii: {\n      '0': '0.25rem',\n      '1': '0.5rem',\n      '2': '0.75rem',\n      '3': '1rem',\n      '4': '1.5rem',\n      round: '100rem',\n    },\n    space: {\n      0: '0rem',\n      xs: '0.5rem',\n      sm: '0.75rem',\n      md: '1rem',\n      lg: '1.25rem',\n      xl: '2.25rem',\n      px: '1px',\n      1: '0.125rem',\n      2: '0.25rem',\n      3: '0.375rem',\n      4: '0.5rem',\n      5: '0.625rem',\n      6: '0.75rem',\n      7: '0.875rem',\n      8: '1rem',\n      9: '1.25rem',\n      10: '1.5rem',\n      11: '1.75rem',\n      12: '2rem',\n      13: '2.25rem',\n      14: '2.5rem',\n      15: '2.75rem',\n      16: '3rem',\n      17: '3.5rem',\n      18: '4rem',\n      19: '4.25rem',\n      20: '5rem',\n      24: '6rem',\n      28: '7rem',\n      32: '8rem',\n      36: '9rem',\n      40: '10rem',\n      44: '11rem',\n      48: '12rem',\n      52: '13rem',\n      56: '14rem',\n      60: '15rem',\n      64: '16rem',\n      72: '18rem',\n      80: '20rem',\n      96: '24rem',\n      100: '25rem',\n    },\n    borderWidths: {\n      light: '1px',\n      normal: '2px',\n      bold: '3px',\n      extrabold: '4px',\n      black: '5px',\n    },\n  },\n};\n\nexport const defaultUtils = {\n  bg: (value: Stitches.PropertyValue<'backgroundColor'>) => ({\n    backgroundColor: value,\n  }),\n  c: (value: Stitches.PropertyValue<'color'>) => ({\n    color: value,\n  }),\n  r: (value: Stitches.ScaleValue<'radii'>) => ({\n    borderRadius: value,\n  }),\n  fs: (value: Stitches.PropertyValue<'fontSize'> | number | string) => ({\n    fontSize: value,\n  }),\n  size: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    height: value,\n    width: value,\n  }),\n  w: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    width: value,\n  }),\n  h: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    height: value,\n  }),\n  p: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    padding: value,\n  }),\n  pt: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    paddingTop: value,\n  }),\n  pr: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    paddingRight: value,\n  }),\n  pb: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    paddingBottom: value,\n  }),\n  pl: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    paddingLeft: value,\n  }),\n  px: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    paddingLeft: value,\n    paddingRight: value,\n  }),\n  py: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    paddingTop: value,\n    paddingBottom: value,\n  }),\n  m: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    margin: value,\n  }),\n  mt: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    marginTop: value,\n  }),\n  mr: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    marginRight: value,\n  }),\n  mb: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    marginBottom: value,\n  }),\n  ml: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    marginLeft: value,\n  }),\n  mx: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    marginLeft: value,\n    marginRight: value,\n  }),\n  my: (value: Stitches.ScaleValue<'space'> | number | string) => ({\n    marginTop: value,\n    marginBottom: value,\n  }),\n};\n\nexport const defaultMedia = {\n  allowMotion: '(prefers-reduced-motion: no-preference)',\n  sm: '(max-width: 640px)',\n  md: '(max-width: 768px)',\n  lg: '(max-width: 1024px)',\n  xl: '(max-width: 1280px)',\n  '2xl': '(max-width: 1536px)',\n  ls: '(max-width: 1024px) and (orientation: landscape)',\n};\n\nexport const defaultThemeMap = {\n  ...defaultStitchesThemeMap,\n  width: 'space',\n  height: 'space',\n  minWidth: 'space',\n  maxWidth: 'space',\n  minHeight: 'space',\n  maxHeight: 'space',\n  flexBasis: 'space',\n  gridTemplateColumns: 'space',\n  gridTemplateRows: 'space',\n  blockSize: 'space',\n  minBlockSize: 'space',\n  maxBlockSize: 'space',\n  inlineSize: 'space',\n  minInlineSize: 'space',\n  maxInlineSize: 'space',\n};\n", "import { parsedUserAgent } from '@100mslive/react-sdk';\n\nexport const QUERY_PARAM_SKIP_PREVIEW = 'skip_preview';\nexport const QUERY_PARAM_SKIP_PREVIEW_HEADFUL = 'skip_preview_headful';\nexport const QUERY_PARAM_NAME = 'name';\nexport const QUERY_PARAM_VIEW_MODE = 'ui_mode';\nexport const QUERY_PARAM_PREVIEW_AS_ROLE = 'preview_as_role';\nexport const UI_MODE_GRID = 'grid';\nexport const MAX_TOASTS = 5;\nexport const RTMP_RECORD_RESOLUTION_MIN = 480;\nexport const RTMP_RECORD_RESOLUTION_MAX = 1280;\nexport const RTMP_RECORD_DEFAULT_RESOLUTION = {\n  width: 1280,\n  height: 720,\n};\nexport const EMOJI_REACTION_TYPE = 'EMOJI_REACTION';\n\nexport const CHAT_SELECTOR = {\n  PEER: 'peer',\n  ROLE: 'role',\n  EVERYONE: 'Everyone',\n};\n\nexport const APP_DATA = {\n  uiSettings: 'uiSettings',\n  chatOpen: 'chatOpen',\n  chatSelector: 'chatSelector',\n  chatDraft: 'chatDraft',\n  appConfig: 'appConfig',\n  sidePane: 'sidePane',\n  hlsStats: 'hlsStats',\n  subscribedNotifications: 'subscribedNotifications',\n  logo: 'logo',\n  hlsStarted: 'hlsStarted',\n  rtmpStarted: 'rtmpStarted',\n  recordingStarted: 'recordingStarted',\n  embedConfig: 'embedConfig',\n  pinnedTrackId: 'pinnedTrackId',\n  dropdownList: 'dropdownList',\n  authToken: 'authToken',\n  pdfConfig: 'pdfConfig',\n  minimiseInset: 'minimiseInset',\n  activeScreensharePeerId: 'activeScreensharePeerId',\n  disableNotifications: 'disableNotifications',\n  pollState: 'pollState',\n  background: 'background',\n  sheet: 'sheet',\n  caption: 'caption',\n  loadingEffects: 'loadingEffects',\n  noiseCancellation: 'noiseCancellation',\n};\n\nexport const UI_SETTINGS = {\n  isAudioOnly: 'isAudioOnly',\n  maxTileCount: 'maxTileCount',\n  uiViewMode: 'uiViewMode',\n  layoutMode: 'layoutMode',\n  showStatsOnTiles: 'showStatsOnTiles',\n  enableAmbientMusic: 'enableAmbientMusic',\n  mirrorLocalVideo: 'mirrorLocalVideo',\n};\n\nexport const SIDE_PANE_OPTIONS = {\n  PARTICIPANTS: 'Participants',\n  CHAT: 'Chat',\n  STREAMING: 'STREAMING',\n  POLLS: 'POLLS',\n  VB: 'VB',\n  ROOM_DETAILS: 'ROOM_DETAILS',\n};\n\nexport type SidePaneOption = (typeof SIDE_PANE_OPTIONS)[keyof typeof SIDE_PANE_OPTIONS];\n\nexport const SHEET_OPTIONS = {\n  ROOM_DETAILS: 'ROOM_DETAILS',\n};\n\nexport const POLL_STATE = {\n  pollInView: 'pollInView',\n  view: 'view',\n};\n\nexport const POLL_VIEWS = {\n  CREATE_POLL_QUIZ: 'CREATE_POLL_QUIZ',\n  CREATE_QUESTIONS: 'CREATE_QUESTIONS',\n  VOTE: 'VOTE',\n  RESULTS: 'RESULTS',\n};\n\nexport const CAPTION_TOAST = {\n  captionToast: 'captionToast',\n};\nexport const SUBSCRIBED_NOTIFICATIONS = {\n  PEER_JOINED: 'PEER_JOINED',\n  PEER_LEFT: 'PEER_LEFT',\n  METADATA_UPDATED: 'METADATA_UPDATED',\n  NEW_MESSAGE: 'NEW_MESSAGE',\n  ERROR: 'ERROR',\n};\n\nexport const CREATE_ROOM_DOC_URL = 'https://github.com/100mslive/100ms-web/wiki/Creating-and-joining-a-room';\nexport const HLS_TIMED_METADATA_DOC_URL =\n  'https://www.100ms.live/docs/javascript/v2/how--to-guides/record-and-live-stream/hls/hls-timed-metadata';\n\nexport const REMOTE_STOP_SCREENSHARE_TYPE = 'REMOTE_STOP_SCREENSHARE';\n\nexport const isChrome = parsedUserAgent.getBrowser()?.name?.toLowerCase() === 'chrome';\nexport const isFirefox = parsedUserAgent.getBrowser()?.name?.toLowerCase() === 'firefox';\nexport const isSafari = parsedUserAgent.getBrowser()?.name?.toLowerCase() === 'safari';\nexport const isIOS = parsedUserAgent.getOS()?.name?.toLowerCase() === 'ios';\nexport const isMacOS = parsedUserAgent.getOS()?.name?.toLowerCase() === 'mac os';\nexport const isAndroid = parsedUserAgent.getOS()?.name?.toLowerCase() === 'android';\nexport const isIPadOS = false;\n// typeof navigator !== \"undefined\" &&\n// navigator?.maxTouchPoints &&\n// navigator?.maxTouchPoints > 2 &&\n// navigator?.userAgent?.match(/Mac/);\n\nexport enum SESSION_STORE_KEY {\n  TRANSCRIPTION_STATE = 'transcriptionState',\n  PINNED_MESSAGES = 'pinnedMessages',\n  SPOTLIGHT = 'spotlight',\n  CHAT_PEER_BLACKLIST = 'chatPeerBlacklist',\n  CHAT_MESSAGE_BLACKLIST = 'chatMessageBlacklist',\n  CHAT_STATE = 'chatState',\n}\n\nexport enum INTERACTION_TYPE {\n  POLL = 'Poll',\n  QUIZ = 'Quiz',\n}\n\nexport enum QUESTION_TYPE_TITLE {\n  'single-choice' = 'Single Choice',\n  'multiple-choice' = 'Multiple Choice',\n  // 'short-answer' = 'Short Answer',\n  // 'long-answer' = 'Long Answer',\n}\n\nexport enum QUESTION_TYPE {\n  SINGLE_CHOICE = 'single-choice',\n  MULTIPLE_CHOICE = 'multiple-choice',\n  // SHORT_ANSWER = 'short-answer',\n  // LONG_ANSWER = 'long-answer',\n}\n\nexport const ROLE_CHANGE_DECLINED = 'role_change_declined';\n\nexport const DEFAULT_PORTAL_CONTAINER = '.prebuilt-container';\n\nexport const TEST_AUDIO_URL = 'https://100ms.live/test-audio.wav';\n", "import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport type { Theme } from './stitches.config';\nimport { createTheme, theme } from './stitches.config';\nimport useSSR from './useSSR';\n\nconst defaultAspectRatio = {\n  width: 1,\n  height: 1,\n};\n\nexport enum ThemeTypes {\n  // eslint-disable-next-line no-unused-vars\n  default = 'default',\n}\n\nexport type ThemeContextValue = {\n  themeType: string;\n  theme: Theme;\n  aspectRatio: { width: number; height: number };\n  /**\n   * @param {ThemeTypes} themeToUpdateTo - optional\n   * Use this to toggle or update the currentTheme.\n   * if a param is passed, it will set the theme to passed value, otherwise will toggle between light and dark\n   * depending on current applied theme\n   */\n  toggleTheme: (themeToUpdateTo?: ThemeTypes) => void;\n};\n\nexport type ThemeProviderProps = {\n  themeType?: string;\n  theme?: Theme;\n  aspectRatio?: { width: number; height: number };\n};\n\nconst defaultContext = {\n  themeType: ThemeTypes.default,\n  theme,\n  aspectRatio: { width: 1, height: 1 },\n  toggleTheme: (_themeToUpdateTo?: ThemeTypes) => {\n    return;\n  },\n};\nexport const ThemeContext = React.createContext<ThemeContextValue>(defaultContext);\n\n/**\n * Wrap this around your root component to get access to theme\n * eg:\n * <ThemeProvider type=\"dark\" appBuilder={{ aspectRatio: { width:1, height: 1} }}>\n *  <App />\n * </ThemeProvider>\n */\nexport const HMSThemeProvider: React.FC<React.PropsWithChildren<ThemeProviderProps>> = ({\n  themeType,\n  theme: userTheme,\n  aspectRatio = defaultAspectRatio,\n  children,\n}) => {\n  const systemTheme = ThemeTypes.default;\n  const [currentTheme, setCurrentTheme] = useState(themeType || systemTheme);\n  const previousClassName = useRef('');\n  const { isBrowser } = useSSR();\n  const updatedTheme = useMemo(() => {\n    const updatedTheme = createTheme({ themeType: currentTheme, theme: userTheme || {} });\n    if (!isBrowser) {\n      return updatedTheme;\n    }\n    if (previousClassName.current) {\n      document.documentElement.classList.remove(previousClassName.current);\n    }\n    previousClassName.current = updatedTheme.className;\n    document.documentElement.classList.add(updatedTheme);\n    return updatedTheme;\n  }, [userTheme, currentTheme, isBrowser]);\n\n  const toggleTheme = useCallback((themeToUpdateTo?: ThemeTypes) => {\n    if (themeToUpdateTo) {\n      setCurrentTheme(themeToUpdateTo);\n      return;\n    }\n    setCurrentTheme(ThemeTypes.default);\n  }, []);\n\n  useEffect(() => {\n    if (themeType) {\n      setCurrentTheme(themeType);\n    }\n  }, [themeType]);\n\n  return (\n    <ThemeContext.Provider\n      value={{ themeType: currentTheme, theme: updatedTheme as unknown as Theme, aspectRatio, toggleTheme }}\n    >\n      {children}\n    </ThemeContext.Provider>\n  );\n};\n\nexport const useTheme = () => React.useContext(ThemeContext);\n", "import { useEffect, useState } from 'react';\n\nconst isBrowser = (): boolean => {\n  return Boolean(typeof window !== 'undefined' && window.document && window.document.createElement);\n};\n\nexport type SSRState = {\n  isBrowser: boolean;\n  isServer: boolean;\n};\n\nconst useSSR = (): SSRState => {\n  const [browser, setBrowser] = useState<boolean>(false);\n  useEffect(() => {\n    setBrowser(isBrowser());\n  }, []);\n\n  return {\n    isBrowser: browser,\n    isServer: !browser,\n  };\n};\n\nexport default useSSR;\n", "import { styled } from '../Theme';\n\nexport const Box = styled('div', {});\n", "export { Loading } from './Loading';\n", "import React from 'react';\n\ntype Props = {\n  /**\n   * Adjusts width and height\n   */\n  size?: number | string;\n  /**\n   * Color of Loader\n   */\n  color?: string;\n};\n\ntype LoadingProps = Props & React.SVGProps<SVGSVGElement>;\n\nexport const Loading = ({ size = 24, color = 'white', ...props }: LoadingProps) => (\n  <svg width={size} height={size} viewBox=\"0 0 50 50\" fill={color} xmlns=\"http://www.w3.org/2000/svg\" {...props}>\n    <circle cx=\"25\" cy=\"25\" r=\"20\" stroke={color} strokeWidth=\"4\" strokeDasharray=\"70 30\" fill=\"none\">\n      <animateTransform\n        attributeName=\"transform\"\n        attributeType=\"XML\"\n        type=\"rotate\"\n        from=\"0 25 25\"\n        to=\"360 25 25\"\n        dur=\"1s\"\n        repeatCount=\"indefinite\"\n      />\n    </circle>\n  </svg>\n);\n", "/**\n * Flex based centering helper styles\n */\nexport const flexCenter = {\n  display: 'flex',\n  justifyContent: 'center',\n  alignItems: 'center',\n};\n\n/**\n * Gives styles for text ellipsis, with given width as maxWidth.\n * A number in pixels or css width string value can be passed\n * @param {number|string} width\n * @returns\n */\nexport const textEllipsis = (width: number | string) => ({\n  maxWidth: width,\n  overflow: 'hidden',\n  textOverflow: 'ellipsis',\n  whiteSpace: 'nowrap',\n  minWidth: 0,\n});\n", "export { Text } from './Text';\n", "import { styled } from '../Theme';\n\nexport const textVariants = {\n  h1: {\n    fontWeight: '$semiBold',\n    letterSpacing: '-1.5px',\n    fontSize: '$h1',\n    lineHeight: '$h1',\n    '@md': {\n      fontSize: '4.5rem',\n      lineHeight: '4.75rem',\n    },\n  },\n  h2: {\n    fontSize: '$h2',\n    lineHeight: '$h2',\n    fontWeight: '$semiBold',\n    letterSpacing: '-0.5px',\n    '@md': {\n      fontSize: '3rem',\n      lineHeight: '3.25rem',\n    },\n  },\n  h3: {\n    fontSize: '$h3',\n    lineHeight: '$h3',\n    fontWeight: '$semiBold',\n    '@md': {\n      fontSize: '2.5rem',\n      lineHeight: '2.75rem',\n    },\n  },\n  h4: {\n    fontSize: '$h4',\n    lineHeight: '$h4',\n    fontWeight: '$semiBold',\n    letterSpacing: '0.25px',\n    '@md': {\n      fontSize: '1.75rem',\n      lineHeight: '2rem',\n    },\n  },\n  h5: {\n    fontSize: '$h5',\n    lineHeight: '$h5',\n    fontWeight: '$semiBold',\n    '@md': {\n      fontSize: '1.5rem',\n      lineHeight: '1.75rem',\n    },\n  },\n  h6: {\n    fontSize: '$h6',\n    lineHeight: '$h6',\n    fontWeight: '$semiBold',\n    letterSpacing: '0.15px',\n    '@md': {\n      fontSize: '1.25rem',\n      lineHeight: '1.5rem',\n    },\n  },\n  sub1: {\n    fontSize: '$md',\n    lineHeight: '$h5',\n    fontWeight: '$medium',\n    letterSpacing: '0.15px',\n  },\n  sub2: {\n    fontSize: '$sm',\n    lineHeight: '$sm',\n    fontWeight: '$medium',\n    letterSpacing: '0.1px',\n  },\n  body1: {\n    fontSize: '$md',\n    lineHeight: '$h6',\n    fontWeight: '$medium',\n    letterSpacing: '0.1px',\n  },\n  body2: {\n    fontSize: '0.875rem',\n    lineHeight: '1.25rem',\n    fontWeight: '$medium',\n    letterSpacing: '0.25px',\n  },\n  button: {\n    fontSize: '1rem',\n    lineHeight: '1.5rem',\n    fontWeight: '$semiBold',\n    letterSpacing: '0.5px',\n  },\n  caption: {\n    fontSize: '0.75rem',\n    lineHeight: '1rem',\n    letterSpacing: '0.4px',\n    fontWeight: '$regular',\n  },\n  overline: {\n    fontSize: '0.625rem',\n    lineHeight: '1rem',\n    letterSpacing: '1.5px',\n    fontWeight: '$medium',\n  },\n  tiny: {\n    fontSize: '$tiny',\n    lineHeight: '$tiny',\n  },\n  xs: {\n    fontSize: '$xs',\n    lineHeight: '$xs',\n  },\n  sm: {\n    fontSize: '$sm',\n    lineHeight: '$sm',\n  },\n  md: {\n    fontSize: '$md',\n    lineHeight: '$md',\n  },\n  lg: {\n    fontSize: '$lg',\n    lineHeight: '$md',\n    fontWeight: '$semiBold',\n    letterSpacing: '0.15px',\n  },\n};\n\nexport const Text = styled('p', {\n  fontFamily: '$sans',\n  fontWeight: '$regular',\n  margin: 0,\n  color: '$on_surface_high',\n  variants: {\n    variant: textVariants,\n    color: {\n      white: {\n        color: '$on_surface_high',\n      },\n    },\n    inline: {\n      true: {\n        display: 'inline',\n      },\n    },\n  },\n  defaultVariants: {\n    variant: 'md',\n  },\n});\n", "export { IconButton } from './IconButton';\n", "import { styled } from '../Theme';\nimport { flexCenter } from '../utils/styles';\n\nexport const IconButton = styled('button', {\n  ...flexCenter,\n  alignItems: 'center',\n  outline: 'none',\n  border: 'none',\n  padding: '$2',\n  r: '$0',\n  cursor: 'pointer',\n  backgroundColor: 'transparent',\n  color: '$on_surface_high',\n  '&:not([disabled]):focus-visible': {\n    boxShadow: '0 0 0 3px $colors$primary_default',\n  },\n  '&:not([disabled]):focus': {\n    outline: 'none',\n  },\n  '@media (hover: hover)': {\n    '&:not([disabled]):hover': {\n      backgroundColor: '$on_surface_low',\n    },\n  },\n  '&[disabled]': {\n    opacity: 0.5,\n    cursor: 'not-allowed',\n    backgroundColor: '$secondary_dim',\n    color: '$on_primary_high',\n  },\n  '&:focus': {\n    outline: 'none',\n  },\n  variants: {\n    active: {\n      true: {\n        '&:not([disabled]):hover': {\n          backgroundColor: '$on_surface_low',\n        },\n      },\n    },\n  },\n});\n", "export { Avatar, StyledAvatar } from './Avatar';\n", "import React from 'react';\nimport { VariantProps } from '@stitches/react';\nimport { PersonIcon } from '@100mslive/react-icons';\nimport { styled } from '../Theme';\nimport { getAvatarBg } from './getAvatarBg';\nimport { flexCenter } from '../utils/styles';\n\nconst getAvatarShape = (radii: string) => ({\n  borderRadius: radii,\n});\n\nexport const StyledAvatar = styled('div', {\n  ...flexCenter,\n  color: '$colors$on_primary_high',\n  fontFamily: '$sans',\n  aspectRatio: 1,\n  fontWeight: 600,\n  fontSize: '$space$9',\n  variants: {\n    shape: {\n      circle: getAvatarShape('$round'),\n      square: getAvatarShape('$1'),\n    },\n    size: {\n      small: {\n        height: '$16 !important',\n        fontSize: '$space$6',\n      },\n      medium: {\n        height: '$18 !important',\n        fontSize: '$space$10',\n      },\n      large: {\n        height: '$20 !important',\n        fontSize: '$space$12',\n      },\n    },\n  },\n  defaultVariants: {\n    shape: 'circle',\n  },\n});\n\ntype Props = VariantProps<typeof StyledAvatar> &\n  React.ComponentProps<typeof StyledAvatar> & {\n    name: string;\n  };\n\nexport const Avatar: React.FC<Props> = ({ name, css, ...props }) => {\n  const info = getAvatarBg(name);\n  let { color } = info;\n  if (!name) {\n    color = '#7E47EB';\n  }\n  return (\n    <StyledAvatar css={{ bg: color, ...css }} {...props}>\n      {info.initials || <PersonIcon height={40} width={40} />}\n    </StyledAvatar>\n  );\n};\n", "const getInitials = (name: string | undefined) => {\n  if (!name) {\n    return undefined;\n  } else {\n    return (\n      name\n        .trim()\n        // remove non chars/digits\n        .replace(/[^a-zA-Z0-9]/g, '')\n        .match(/(^\\S\\S?|\\b\\S)?/g)\n        ?.join('')\n        ?.match(/(^\\S|\\S$)?/g)\n        ?.join('')\n        .toUpperCase()\n    );\n  }\n};\n\n/**\n  calculates the initials of the name and choose a background color based on the first later of the initials\n */\nexport const getAvatarBg = (name: string): { initials: string; color: string } => {\n  const initials = getInitials(name);\n  const indexFactor = 20;\n  const colorIndex = ((initials?.codePointAt(0) || 0) % indexFactor) + 1;\n  return { initials: initials || '', color: colorsList[colorIndex - 1] };\n};\n\nconst colorsList = [\n  '#616161',\n  '#F44336',\n  '#3F51B5',\n  '#4CAF50',\n  '#FFA000',\n  '#795548',\n  '#E91E63',\n  '#2F80FF',\n  '#8BC34A',\n  '#F57C00',\n  '#4E342E',\n  '#9C27B0',\n  '#00BCD4',\n  '#C0CA33',\n  '#F4511E',\n  '#673AB7',\n  '#009688',\n  '#FBC02D',\n  '#BF360C',\n  '#455A64',\n];\n", "export { HorizontalDivider, VerticalDivider } from './Divider';\n", "import { styled } from '../Theme';\n\nconst getVerticalSpace = (space: string) => ({\n  marginLeft: space,\n  marginRight: space,\n});\nconst getHorizontalSpace = (space: string) => ({\n  marginTop: space,\n  marginBottom: space,\n});\n\nexport const VerticalDivider = styled('span', {\n  height: '25px',\n  width: '1px',\n  backgroundColor: '$border_bright',\n  variants: {\n    space: {\n      1: getVerticalSpace('$1'),\n      2: getVerticalSpace('$2'),\n      3: getVerticalSpace('$3'),\n      4: getVerticalSpace('$4'),\n    },\n  },\n  defaultVariants: {\n    space: 1,\n  },\n});\n\nexport const HorizontalDivider = styled('span', {\n  height: '1px',\n  width: '100%',\n  display: 'block',\n  backgroundColor: '$border_bright',\n  variants: {\n    space: {\n      1: getHorizontalSpace('$1'),\n      2: getHorizontalSpace('$2'),\n      3: getHorizontalSpace('$3'),\n      4: getHorizontalSpace('$4'),\n    },\n  },\n  defaultVariants: {\n    space: 1,\n  },\n});\n", "export { Switch } from './Switch';\n", "import React from 'react';\nimport * as BaseSwitch from '@radix-ui/react-switch';\nimport { styled } from '../Theme';\n\nconst SwitchRoot = styled(BaseSwitch.Root, {\n  all: 'unset',\n  width: '30px',\n  height: '14px',\n  border: 'solid $space$px $secondary_default',\n  borderRadius: '$3',\n  p: '$2',\n  position: 'relative',\n  cursor: 'pointer',\n  '&[data-state=\"checked\"]': {\n    backgroundColor: '$primary_default',\n    border: 'solid $space$px $primary_default',\n  },\n  '&:focus': {\n    outline: 'none',\n  },\n  '&[disabled]': {\n    opacity: 0.5,\n    cursor: 'not-allowed',\n  },\n});\n\nconst SwitchThumb = styled(BaseSwitch.Thumb, {\n  display: 'block',\n  top: '3px',\n  position: 'absolute',\n  width: '$md',\n  height: '$md',\n  backgroundColor: '$secondary_default',\n  borderRadius: '$round',\n  transition: 'right 500ms ease-in',\n  left: '$2',\n  '&[data-state=\"checked\"]': {\n    left: 'unset',\n    right: '$2',\n    backgroundColor: '$on_primary_high',\n  },\n});\n\ntype SwitchProps = React.ComponentProps<typeof SwitchRoot>;\n\nexport const Switch: React.FC<SwitchProps> = props => (\n  <SwitchRoot {...props}>\n    <SwitchThumb />\n  </SwitchRoot>\n);\n\nSwitch.displayName = 'Switch';\n", "export { Tooltip } from './Tooltip';\n", "import React, { PropsWithChildren, useState } from 'react';\nimport * as BaseTooltip from '@radix-ui/react-tooltip';\nimport { CSS, styled } from '../Theme';\nimport { slideDownAndFade, slideLeftAndFade, slideRightAndFade, slideUpAndFade } from '../utils';\n\nconst TooltipBox = styled(BaseTooltip.Content, {\n  fontFamily: '$sans',\n  borderRadius: '$2',\n  padding: '$2 $4',\n  fontSize: '$xs',\n  zIndex: 11,\n  color: '$on_surface_high',\n  backgroundColor: '$surface_bright',\n  '@media (prefers-reduced-motion: no-preference)': {\n    animationDuration: '400ms',\n    animationTimingFunction: 'cubic-bezier(0.16, 1, 0.3, 1)',\n    willChange: 'transform, opacity',\n    '&[data-state=\"delayed-open\"]': {\n      '&[data-side=\"top\"]': { animationName: slideDownAndFade() },\n      '&[data-side=\"right\"]': { animationName: slideLeftAndFade() },\n      '&[data-side=\"bottom\"]': { animationName: slideUpAndFade() },\n      '&[data-side=\"left\"]': { animationName: slideRightAndFade() },\n    },\n  },\n  variants: {\n    outlined: {\n      true: {\n        backgroundColor: '$background_dim',\n        border: 'solid $space$px $border_bright',\n      },\n    },\n  },\n});\n\nconst TooltipTrigger = styled(BaseTooltip.Trigger, {\n  fontFamily: '$sans',\n});\n\nconst TooltipRoot = BaseTooltip.Root;\nexport type alignTooltip = 'end' | 'center' | 'start' | undefined;\nexport type sideTooltip = 'bottom' | 'left' | 'right' | 'top' | undefined;\n\nexport const Tooltip: React.FC<\n  PropsWithChildren<{\n    title: React.ReactNode | string;\n    outlined?: boolean;\n    side?: sideTooltip;\n    align?: alignTooltip;\n    disabled?: boolean;\n    triggerCss?: CSS;\n    boxCss?: CSS;\n    delayDuration?: number;\n  }>\n> = ({\n  children,\n  title,\n  triggerCss,\n  boxCss,\n  outlined = true,\n  side = 'bottom',\n  align = 'center',\n  disabled = false,\n  delayDuration = 200,\n}) => {\n  const [open, setOpen] = useState(false);\n\n  return (\n    <BaseTooltip.Provider>\n      <TooltipRoot delayDuration={delayDuration} open={open && !disabled} onOpenChange={setOpen}>\n        <TooltipTrigger css={{ ...triggerCss }} asChild>\n          {children}\n        </TooltipTrigger>\n        <TooltipBox sideOffset={10} side={side} align={align} outlined={outlined} css={{ ...boxCss }}>\n          {title}\n        </TooltipBox>\n      </TooltipRoot>\n    </BaseTooltip.Provider>\n  );\n};\n", "import { keyframes } from '../Theme';\n\nexport const slideDown = (controller: string) =>\n  keyframes({\n    from: { height: 0 },\n    to: { height: `var(${controller})` },\n  });\n\nexport const slideUp = (controller: string) =>\n  keyframes({\n    from: { height: `var(${controller})` },\n    to: { height: 0 },\n  });\n\nexport const translateAcross = ({ xFrom = '0', yFrom = '0', zFrom = '0', xTo = '0', yTo = '0', zTo = '0' }) =>\n  keyframes({\n    from: { transform: `translate3d(${xFrom}, ${yFrom}, ${zFrom})` },\n    to: { transform: `translate3d(${xTo}, ${yTo}, ${zTo}` },\n  });\n\nexport const dialogOpen = keyframes({\n  '0%': { opacity: 0, transform: 'translate(-50%, -48%) scale(.90)' },\n  '100%': { opacity: 1, transform: 'translate(-50%, -50%) scale(1)' },\n});\n\nexport const dialogClose = keyframes({\n  '0%': { opacity: 1, transform: 'translate(-50%, -50%) scale(1)' },\n  '100%': { opacity: 0, transform: 'translate(-50%, -48%) scale(.90)' },\n});\n\nexport const slideUpAndFade = (start = '2px') =>\n  keyframes({\n    '0%': { opacity: 0, transform: `translateY(${start})` },\n    '100%': { opacity: 1, transform: 'translateY(0)' },\n  });\n\nexport const slideRightAndFade = (start = '-2px') =>\n  keyframes({\n    '0%': { opacity: 0, transform: `translateX(${start})` },\n    '100%': { opacity: 1, transform: 'translateX(0)' },\n  });\n\nexport const sheetSlideIn = keyframes({\n  from: { transform: '$$transformValue' },\n  to: { transform: 'translate3d(0,0,0)' },\n});\n\nexport const sheetSlideOut = keyframes({\n  from: { transform: 'translate3d(0,0,0)' },\n  to: { transform: '$$transformValue' },\n});\nexport const sheetFadeIn = keyframes({\n  from: { opacity: '0' },\n  to: { opacity: '1' },\n});\n\nexport const sheetFadeOut = keyframes({\n  from: { opacity: '1' },\n  to: { opacity: '0' },\n});\nexport const slideDownAndFade = (start = '-2px') =>\n  keyframes({\n    '0%': { opacity: 0, transform: `translateY(${start})` },\n    '100%': { opacity: 1, transform: 'translateY(0)' },\n  });\n\nexport const slideLeftAndFade = (start = '2px') =>\n  keyframes({\n    '0%': { opacity: 0, transform: `translateX(${start})` },\n    '100%': { opacity: 1, transform: 'translateX(0)' },\n  });\n\nconst slideLeftAndFadeOut = (end = '-100%') =>\n  keyframes({\n    '0%': { opacity: 1, transform: `translateX(0)` },\n    '100%': { opacity: 0, transform: `translateX(${end})` },\n  });\n\nexport const popoverAnimation = {\n  '@media (prefers-reduced-motion: no-preference)': {\n    animationDuration: '400ms',\n    animationTimingFunction: 'cubic-bezier(0.16, 1, 0.3, 1)',\n    willChange: 'transform, opacity',\n    '&[data-state=\"open\"]': {\n      '&[data-side=\"top\"]': { animationName: slideDownAndFade() },\n      '&[data-side=\"right\"]': { animationName: slideLeftAndFade() },\n      '&[data-side=\"bottom\"]': { animationName: slideUpAndFade() },\n      '&[data-side=\"left\"]': { animationName: slideRightAndFade() },\n    },\n  },\n};\n\nexport const toastAnimation = {\n  '@media (prefers-reduced-motion: no-preference)': {\n    animationDuration: '500ms',\n    animationTimingFunction: 'cubic-bezier(0.16, 1, 0.3, 1)',\n    willChange: 'transform, opacity',\n    animationName: slideLeftAndFadeOut(),\n\n    '&[data-state=\"open\"]': {\n      animationName: slideRightAndFade('-100%'),\n    },\n    '&[data-swipe=\"move\"]': {\n      transform: 'translateX(var(--radix-toast-swipe-move-x))',\n    },\n    '&[data-swipe=\"cancel\"]': {\n      transform: 'translateX(0)',\n      transition: 'transform 200ms ease-out',\n    },\n    '&[data-swipe=\"end\"]': {\n      animation: `${slideLeftAndFadeOut()} 100ms ease-out forwards`,\n    },\n  },\n};\n", "export { Select } from './Select';\n", "import React from 'react';\nimport { ChevronDownIcon } from '@100mslive/react-icons';\nimport { styled } from '../Theme';\n\nconst Root = styled('div', {\n  color: '$on_primary_high',\n  display: 'inline-flex',\n  position: 'relative',\n  outline: 'none',\n  overflow: 'hidden',\n  borderRadius: '$1',\n  backgroundColor: '$surface_default',\n  maxWidth: '100%',\n});\n\n// TODO: replace these with tokens\nconst SelectRoot = styled('select', {\n  h: '$16',\n  fontSize: '$md',\n  fontWeight: '500',\n  lineHeight: 'inherit',\n  textTransform: 'none',\n  appearance: 'none',\n  color: '$on_secondary_high',\n  padding: '5px',\n  paddingLeft: '12px',\n  paddingRight: '30px',\n  border: 'none',\n  borderRadius: '8px',\n  backgroundColor: '$secondary_default',\n  '&:not([disabled]):focus-visible': {\n    boxShadow: '0 0 0 3px $colors$primary_default',\n  },\n  '&[disabled]': {\n    opacity: 0.5,\n    cursor: 'not-allowed',\n  },\n});\n\nconst Arrow = styled('span', {\n  color: '$on_secondary_high',\n  width: '30px',\n  height: '100%',\n  position: 'absolute',\n  right: 0,\n  pointerEvents: 'none',\n  display: 'flex',\n  alignItems: 'center',\n  transition: 'border .2s ease 0s',\n});\n\nconst DefaultDownIcon = ({ ...props }) => (\n  <Arrow {...props}>\n    <ChevronDownIcon />\n  </Arrow>\n);\n\nexport const Select = {\n  Root,\n  DownIcon: Arrow,\n  DefaultDownIcon,\n  Select: SelectRoot,\n};\n", "export { Slider } from './Slider';\n", "import React from 'react';\nimport * as BaseSlider from '@radix-ui/react-slider';\nimport { CSS } from '@stitches/react';\nimport { styled } from '../Theme';\nimport { Tooltip } from '../Tooltip';\n\nconst Root = styled(BaseSlider.Root, {\n  position: 'relative',\n  display: 'flex',\n  alignItems: 'center',\n  userSelect: 'none',\n  touchAction: 'none',\n  width: '100%',\n  '&[data-orientation=\"horizontal\"]': {\n    height: 20,\n  },\n});\n\nconst Track = styled(BaseSlider.Track, {\n  backgroundColor: '$surface_bright',\n  position: 'relative',\n  flexGrow: 1,\n  borderRadius: '$round',\n  cursor: 'pointer',\n  '&[data-orientation=\"horizontal\"]': { height: 3 },\n});\n\nconst Range = styled(BaseSlider.Range, {\n  position: 'absolute',\n  backgroundColor: '$primary_default',\n  borderRadius: '$round',\n  height: '100%',\n});\n\nconst Thumb = styled(BaseSlider.Thumb, {\n  all: 'unset',\n  display: 'block',\n  width: '$8',\n  height: '$8',\n  backgroundColor: '$primary_default',\n  cursor: 'pointer',\n  boxShadow: `0 2px 10px $colors$surface_default`,\n  borderRadius: 10,\n  '&:hover': { backgroundColor: '$primary_default' },\n  '&:focus': { boxShadow: 'none' },\n});\n\ntype SliderProps = React.ComponentProps<typeof Root> & {\n  thumbStyles?: CSS;\n  showTooltip?: boolean;\n};\n\nexport const Slider: React.FC<SliderProps & { showTooltip?: boolean }> = ({\n  showTooltip = true,\n  thumbStyles,\n  ...props\n}) => (\n  <Root {...props}>\n    <Track>\n      <Range />\n    </Track>\n    {showTooltip ? (\n      <Tooltip title={String(props.value?.[0])}>\n        <Thumb css={thumbStyles} />\n      </Tooltip>\n    ) : (\n      <Thumb css={thumbStyles} />\n    )}\n  </Root>\n);\n", "export { Dialog } from './Dialog';\n", "import React, { ReactNode, useEffect, useRef } from 'react';\nimport { Root } from '@radix-ui/react-dialog';\nimport { styled } from '@stitches/react';\nimport {\n  CustomDialogContent,\n  CustomDialogOverlay,\n  DialogClose,\n  DialogDefaultCloseIcon,\n  DialogDescription,\n  DialogTitle,\n  StyledDialogPortal,\n  StyledDialogTrigger,\n} from './DialogContent';\nimport { useDialogContainerSelector } from '../hooks/useDialogContainerSelector';\n\nconst StyledDialog = styled(Root, {});\n\n// Handles race conditions when multiple elements with dismissable layer are present\n// https://github.com/radix-ui/primitives/issues/2122\nconst DialogRoot = <T extends React.ComponentProps<typeof StyledDialog>>(props: T) => {\n  useEffect(() => {\n    return () => {\n      if (document) setTimeout(() => (document.body.style.pointerEvents = 'auto'), 0);\n    };\n  }, []);\n  return <StyledDialog {...(props as object)} />;\n};\n\nconst CustomDialogPortal = ({ children, container }: { children: ReactNode; container?: HTMLElement | null }) => {\n  const dialogContainerSelector = useDialogContainerSelector();\n  const containerRef = useRef<HTMLElement | null>(null);\n\n  if (container) {\n    containerRef.current = container;\n  } else if (dialogContainerSelector && !containerRef.current) {\n    containerRef.current = document.querySelector(dialogContainerSelector) as HTMLElement;\n  } else if (!containerRef.current) {\n    containerRef.current = document.body;\n  }\n  return (\n    <StyledDialogPortal container={containerRef.current}>\n      <>{children}</>\n    </StyledDialogPortal>\n  );\n};\n\nexport const Dialog = {\n  Root: DialogRoot,\n  Trigger: StyledDialogTrigger,\n  Overlay: CustomDialogOverlay,\n  Content: CustomDialogContent,\n  Title: DialogTitle,\n  Description: DialogDescription,\n  Close: DialogClose,\n  DefaultClose: DialogDefaultCloseIcon,\n  Portal: CustomDialogPortal,\n};\n", "import React, { ComponentProps } from 'react';\nimport * as DialogPrimitive from '@radix-ui/react-dialog';\nimport { CrossIcon } from '@100mslive/react-icons';\nimport { IconButton } from '../IconButton';\nimport { styled } from '../Theme';\nimport { dialogClose, dialogOpen } from '../utils/animations';\n\nexport const DialogClose = styled(DialogPrimitive.Close, {\n  backgroundColor: 'transparent',\n  padding: '0',\n  margin: '0',\n  border: 'none',\n  backgroundImage: 'none',\n});\n\nexport const StyledDialogTrigger = styled(DialogPrimitive.Trigger, {\n  appearance: 'none !important', // Needed for safari it shows white overlay\n});\n\nexport const CustomDialogOverlay = styled(DialogPrimitive.Overlay, {\n  backgroundColor: 'rgba(0, 0, 0, 0.5);',\n  position: 'absolute',\n  inset: 0,\n});\n\nexport const StyledDialogPortal = styled(DialogPrimitive.Portal, {});\n\nexport const CustomDialogContent = styled(DialogPrimitive.Content, {\n  color: '$on_surface_medium',\n  backgroundColor: '$surface_dim',\n  borderRadius: '8px',\n  position: 'absolute',\n  top: '50%',\n  left: '50%',\n  maxHeight: '95%',\n  overflowY: 'auto',\n  border: '$space$px solid $border_bright',\n  boxShadow: '0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)',\n  transform: 'translate(-50%, -50%)',\n  zIndex: 999,\n  padding: '$12',\n  '@allowMotion': {\n    '&[data-state=\"open\"]': {\n      animation: `${dialogOpen} 150ms cubic-bezier(0.16, 1, 0.3, 1)`,\n    },\n    '&[data-state=\"closed\"]': {\n      animation: `${dialogClose} 150ms cubic-bezier(0.16, 1, 0.3, 1)`,\n    },\n  },\n  '&:focus': { outline: 'none' },\n});\n\nexport const DialogTitle = styled(DialogPrimitive.Title, {\n  margin: 0,\n});\n\nexport const DialogDescription = styled(DialogPrimitive.Description, {});\n\nexport const DialogDefaultCloseIcon = (props: ComponentProps<typeof IconButton>) => (\n  <DialogClose asChild>\n    <IconButton {...props}>\n      <CrossIcon />\n    </IconButton>\n  </DialogClose>\n);\n", "import { useContext } from 'react';\nimport { DialogContainerContext } from '../context/DialogContext';\n\nexport function useDialogContainerSelector() {\n  const dialogContainerSelector = useContext(DialogContainerContext);\n  return dialogContainerSelector;\n}\n", "import React, { createContext, ReactNode } from 'react';\n\nexport const DialogContainerContext = createContext('');\n\nexport function DialogContainerProvider({\n  children,\n  dialogContainerSelector,\n}: {\n  children: ReactNode;\n  dialogContainerSelector: string;\n}) {\n  return <DialogContainerContext.Provider value={dialogContainerSelector}>{children}</DialogContainerContext.Provider>;\n}\n", "import React, { ComponentProps, PropsWithChildren, PropsWithRef } from 'react';\nimport { CSS } from '@stitches/react';\nimport { CopyIcon, EyeCloseIcon, EyeOpenIcon } from '@100mslive/react-icons';\nimport { Flex } from '../Layout';\nimport { styled } from '../Theme';\n\nexport const Input = styled('input', {\n  fontFamily: '$sans',\n  lineHeight: 'inherit',\n  backgroundColor: '$surface_default',\n  borderRadius: '8px',\n  outline: 'none',\n  border: '1px solid $border_default',\n  padding: '0.5rem 0.75rem',\n  minHeight: '30px',\n  color: '$on_surface_high',\n  fontSize: '$md',\n  '&:focus': {\n    boxShadow: '0 0 0 1px $colors$primary_default',\n    border: '1px solid transparent',\n  },\n  '&::placeholder': {\n    color: '$on_surface_medium',\n  },\n  variants: {\n    error: {\n      true: {\n        '&:focus': {\n          boxShadow: '0 0 0 3px $colors$alert_error_default',\n        },\n      },\n    },\n  },\n});\n\nconst PasswordRoot = styled('div', {\n  w: '100%',\n  position: 'relative',\n  display: 'flex',\n});\n\nconst PasswordShowIcon: React.FC<ComponentProps<typeof Flex> & { showPassword?: boolean; css?: CSS }> = ({\n  showPassword,\n  css,\n  ...props\n}) => {\n  return (\n    <Flex css={{ ...css }} {...props}>\n      {showPassword ? <EyeOpenIcon /> : <EyeCloseIcon />}\n    </Flex>\n  );\n};\n\nconst PasswordCopyIcon: React.FC<ComponentProps<typeof Flex & { css?: CSS }>> = ({ css, ...props }) => {\n  return (\n    <Flex css={{ ...css }} {...props}>\n      <CopyIcon />\n    </Flex>\n  );\n};\n\nconst PasswordIcons = React.forwardRef<HTMLDivElement, PropsWithChildren<ComponentProps<typeof Flex & { css?: CSS }>>>(\n  ({ css, ...props }, ref) => {\n    return (\n      <Flex\n        css={{\n          position: 'absolute',\n          top: 0,\n          height: '100%',\n          zIndex: 10,\n          right: '$4',\n          bg: '$surface_bright',\n          alignItems: 'center',\n          ...css,\n        }}\n        ref={ref}\n        {...props}\n      >\n        {props.children}\n      </Flex>\n    );\n  },\n);\n\nconst ReactInput: React.FC<PropsWithRef<ComponentProps<typeof Input> & { showPassword?: boolean; css?: CSS }>> =\n  React.forwardRef<\n    HTMLInputElement,\n    PropsWithRef<ComponentProps<typeof Input> & { showPassword?: boolean; css?: CSS }>\n  >(({ showPassword = false, css, ...props }, ref) => {\n    return (\n      <Input\n        css={{ flexGrow: 1, width: '100%', ...css }}\n        type={showPassword ? 'text' : 'password'}\n        {...props}\n        ref={ref}\n      />\n    );\n  });\n\nexport const PasswordInput = {\n  Root: PasswordRoot,\n  Icons: PasswordIcons,\n  Input: ReactInput,\n  ShowIcon: PasswordShowIcon,\n  CopyIcon: PasswordCopyIcon,\n};\n", "export { StyledVideoTile } from './StyledVideoTile';\n", "import { Box } from '../Layout';\nimport { styled } from '../Theme';\nimport { flexCenter } from '../utils';\n\nexport const Root = styled('div', {\n  padding: '0.75rem',\n  // show videotile context menu on hover\n  // [`&:hover .tile-menu`]: {\n  //   display: 'inline-block',\n  // },\n});\n\nconst Container = styled('div', {\n  width: '100%',\n  height: '100%',\n  position: 'relative',\n  overflow: 'hidden',\n  borderRadius: '$2',\n  display: 'flex',\n  justifyContent: 'center',\n  alignItems: 'center',\n  background: '$background_default',\n  variants: {\n    transparentBg: {\n      true: {\n        background: 'transparent',\n      },\n    },\n    noRadius: {\n      true: {\n        borderRadius: 0,\n      },\n    },\n  },\n});\n\nconst Overlay = styled('div', {\n  position: 'absolute',\n  width: '100%',\n  height: '100%',\n});\n\nconst Info = styled('div', {\n  color: '$on_primary_high',\n  position: 'absolute',\n  bottom: '5px',\n  left: '50%',\n  fontSize: '$sm',\n  transform: 'translateX(-50%)',\n  textAlign: 'center',\n  width: '80%',\n  overflow: 'hidden',\n  whiteSpace: 'nowrap',\n  textOverflow: 'ellipsis',\n  fontFamily: '$sans',\n});\n\nconst AttributeBox = styled('div', {\n  position: 'absolute',\n  top: '$4',\n  color: '$on_secondary_high',\n  bg: '$secondary_dim',\n  borderRadius: '$round',\n  width: '$14',\n  height: '$14',\n  mb: '5px',\n  ...flexCenter,\n  variants: {\n    size: {\n      small: {\n        width: '$10',\n        height: '$10',\n        '& > svg': {\n          width: '$8',\n          height: '$8',\n        },\n      },\n      medium: {\n        width: '$13',\n        height: '$13',\n      },\n    },\n    position: {\n      left: { left: '$4' },\n      right: { right: '$4' },\n    },\n  },\n  defaultVariants: {\n    size: 'medium',\n    position: 'left',\n  },\n});\n\nconst AudioIndicator = styled(AttributeBox, { defaultVariants: { position: 'right' } });\n\nconst FullScreenButton = styled('button', {\n  height: '$14',\n  p: '$2 $4',\n  color: '$on_surface_high',\n  borderRadius: '$1',\n  border: 'none',\n  display: 'flex',\n  justifyContent: 'center',\n  alignItems: 'center',\n  position: 'absolute',\n  top: '$2',\n  right: '$2',\n  zIndex: 5,\n  '&:not([disabled]):focus': {\n    outline: 'none',\n    boxShadow: '0 0 0 3px $colors$primary_bright',\n  },\n});\n\nconst AvatarContainer = styled(Box, {\n  ...flexCenter,\n  flexDirection: 'column',\n  position: 'absolute',\n  left: '50%',\n  top: '50%',\n  transform: 'translateX(-50%) translateY(-50%)',\n  width: '40%',\n  height: '40%',\n  '& > div': {\n    maxHeight: '$20',\n    height: '100%',\n  },\n});\n\ninterface VideoTileType {\n  Root: typeof Root;\n  Container: typeof Container;\n  Overlay: typeof Overlay;\n  Info: typeof Info;\n  AvatarContainer: typeof AvatarContainer;\n  AttributeBox: typeof AttributeBox;\n  AudioIndicator: typeof AudioIndicator;\n  FullScreenButton: typeof FullScreenButton;\n}\n\nexport const StyledVideoTile: VideoTileType = {\n  Root,\n  Container,\n  Overlay,\n  Info,\n  AvatarContainer,\n  AttributeBox,\n  AudioIndicator,\n  FullScreenButton,\n};\n", "export { getLeft } from './videoListUtils';\nexport { StyledVideoList } from './StyledVideoList';\n", "export const getLeft = (index: number, currentPageIndex: number) => {\n  //active slide\n  if (index === currentPageIndex) {\n    return 0;\n  }\n  //prev slide\n  if (index + 1 === currentPageIndex) {\n    return '-100%';\n  }\n  //next slide\n  if (index - 1 === currentPageIndex) {\n    return '100%';\n  }\n  //all slides before prev\n  if (index < currentPageIndex) {\n    return '-200%';\n  }\n  //all slides after next\n  return '200%';\n};\n", "import { styled } from '../Theme';\n\nconst Root = styled('div', {\n  height: '100%',\n  width: '100%',\n  display: 'flex',\n  flexDirection: 'column',\n});\n\nconst Container = styled('div', {\n  height: '100%',\n  width: '100%',\n  position: 'relative',\n  display: 'flex',\n  alignItems: 'center',\n  overflow: 'hidden',\n});\n\nconst View = styled('div', {\n  height: '100%',\n  width: '100%',\n  position: 'absolute',\n  display: 'flex',\n  placeContent: 'center',\n  flexWrap: 'wrap',\n  alignItems: 'center',\n});\n\ninterface VideoListType {\n  Root: typeof Root;\n  Container: typeof Container;\n  View: typeof View;\n}\n\nexport const StyledVideoList: VideoListType = {\n  Root,\n  Container,\n  View,\n};\n", "export { StyledPagination } from './StyledPagination';\n", "import { styled } from '../Theme';\n\nconst Root = styled('div', {\n  height: '2rem',\n  display: 'flex',\n  justifyContent: 'center',\n  alignItems: 'center',\n  width: '100%',\n  '& > * + *': {\n    marginRight: '0',\n    marginLeft: '0.5rem',\n  },\n});\n\nconst Chevron = styled('button', {\n  color: '$on_surface_high',\n  border: 'none',\n  '&:focus': {\n    outline: 'none',\n  },\n  '&[disabled]': {\n    color: '$on_surface_low',\n    cursor: 'not-allowed',\n  },\n  backgroundColor: 'transparent',\n  display: 'flex',\n});\n\nconst Dots = styled('div', {\n  display: 'flex',\n  alignItems: 'center',\n  '& > * + *': {\n    marginRight: '0',\n    marginLeft: '0.5rem',\n  },\n});\n\nconst Dot = styled('button', {\n  '&:focus': {\n    outline: 'none',\n  },\n  borderRadius: '9999px',\n  width: '0.5rem',\n  height: '0.5rem',\n  backgroundColor: '$on_surface_low',\n  padding: '0px',\n  border: 'none',\n  cursor: 'pointer',\n  variants: {\n    active: {\n      true: {\n        backgroundColor: '$on_surface_high',\n      },\n    },\n  },\n});\n\ninterface PaginationType {\n  Root: typeof Root;\n  Chevron: typeof Chevron;\n  Dots: typeof Dots;\n  Dot: typeof Dot;\n}\n\nexport const StyledPagination: PaginationType = {\n  Root,\n  Chevron,\n  Dots,\n  Dot,\n};\n", "import {\n  CheckboxItem,\n  Content,\n  Group,\n  Item,\n  ItemIndicator,\n  Label,\n  Portal,\n  Root,\n  Separator,\n  Sub,\n  SubContent,\n  SubTrigger,\n  Trigger,\n} from '@radix-ui/react-dropdown-menu';\nimport { styled } from '../Theme';\n\nconst DropdownRoot = styled(Root, {});\n\nconst DropdownTrigger = styled(Trigger, {\n  cursor: 'pointer',\n  appearance: 'none !important',\n  '&[data-state=\"open\"]': {\n    backgroundColor: '$surface_bright',\n  },\n  '&:focus': {\n    outline: 'none',\n  },\n  '&:focus-visible': {\n    boxShadow: '0 0 0 3px $colors$primary_default',\n  },\n});\n\nconst DropdownTriggerItem = styled(SubTrigger, {\n  w: '100%',\n  color: '$on_surface_high',\n  p: '$8',\n  display: 'flex',\n  alignItems: 'center',\n  '&:hover': {\n    cursor: 'pointer',\n    bg: '$surface_brighter',\n  },\n  '&:focus-visible': {\n    bg: '$surface_brighter',\n    outline: 'none',\n  },\n});\n\nconst DropdownItem = styled(Item, {\n  color: '$on_surface_high',\n  p: '$8',\n  display: 'flex',\n  alignItems: 'center',\n  outline: 'none',\n  backgroundColor: '$surface_dim',\n  '&:hover': {\n    cursor: 'pointer',\n    bg: '$surface_bright',\n  },\n  '&:focus-visible': {\n    bg: '$surface_bright',\n  },\n});\n\nconst DropdownItemSeparator = styled(Separator, {\n  h: 1,\n  backgroundColor: '$border_bright',\n  m: '$4 $8',\n});\n\nconst DropdownContent = styled(Content, {\n  w: '$80',\n  maxHeight: '$64',\n  r: '$1',\n  py: '$4',\n  backgroundColor: '$surface_dim',\n  overflowY: 'auto',\n  boxShadow: '0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)',\n  zIndex: 20,\n  fontFamily: '$sans',\n});\n\nconst DropdownLabel = styled(Label, {\n  display: 'flex',\n  alignItems: 'center',\n  h: '$12',\n  w: '100%',\n  p: '$8 $4',\n});\n\nconst DropdownGroup = styled(Group, {});\n\nconst DropdownSubMenu = styled(Sub, {});\n\nconst DropdownSubMenuContent = styled(SubContent, {\n  w: '$80',\n  maxHeight: '$64',\n  r: '$1',\n  py: '$4',\n  backgroundColor: '$surface_bright',\n  overflowY: 'auto',\n  boxShadow: '0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)',\n  zIndex: 20,\n});\n\nconst DropdownCheckboxItem = styled(CheckboxItem, {\n  color: '$on_surface_high',\n  p: '$8',\n  display: 'flex',\n  alignItems: 'center',\n  outline: 'none',\n  '&:hover': {\n    cursor: 'pointer',\n    bg: '$surface_brighter',\n  },\n  '&:focus-visible': {\n    bg: '$surface_brighter',\n  },\n  gap: '$2',\n});\n\nconst DropdownItemIndicator = styled(ItemIndicator, {\n  w: '$10',\n  display: 'inline-flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n});\n\nexport const Dropdown = {\n  Root: DropdownRoot,\n  Trigger: DropdownTrigger,\n  TriggerItem: DropdownTriggerItem,\n  Content: DropdownContent,\n  Portal: Portal,\n  SubMenu: DropdownSubMenu,\n  SubMenuContent: DropdownSubMenuContent,\n  Item: DropdownItem,\n  Label: DropdownLabel,\n  Group: DropdownGroup,\n  ItemSeparator: DropdownItemSeparator,\n  CheckboxItem: DropdownCheckboxItem,\n  ItemIndicator: DropdownItemIndicator,\n};\n", "export { StyledVideo, Video } from './Video';\n", "import React from 'react';\nimport type { VariantProps } from '@stitches/react';\nimport { HMSPeer, useVideo } from '@100mslive/react-sdk';\nimport { styled } from '../Theme';\n\nexport const StyledVideo = styled('video', {\n  width: '100%',\n  height: '100%',\n  display: 'flex',\n  justifyContent: 'center',\n  alignItems: 'center',\n  borderRadius: '$2',\n  objectFit: 'cover',\n  background: '$background_default',\n  variants: {\n    mirror: {\n      true: {\n        transform: 'scaleX(-1)',\n      },\n    },\n    screenShare: {\n      true: {\n        objectFit: 'contain',\n      },\n    },\n    degraded: {\n      // send the video behind when it's degraded so avatar can show on top of it. Video will be stuck frame in this case.\n      // not hiding by using display none, because it will lead it to be detached as it will no longer be in view.\n      true: {\n        zIndex: -100,\n      },\n    },\n    noRadius: {\n      true: {\n        borderRadius: 0,\n      },\n    },\n  },\n  defaultVariants: {\n    mirror: false,\n  },\n});\n\ntype StyledProps = VariantProps<typeof StyledVideo> & React.ComponentProps<typeof StyledVideo>;\n\ninterface Props {\n  /**\n   * trackID for peer (videoTrack)\n   */\n  trackId: HMSPeer['videoTrack'];\n  /**\n   * Boolean stating whether to override the internal behaviour.\n   * when attach is false, even if tile is inView or enabled, it won't be rendered\n   */\n  attach?: boolean;\n}\n\nexport const Video: React.FC<Props & StyledProps> = ({ trackId, attach, ...props }) => {\n  const { videoRef } = useVideo({ trackId, attach });\n  return <StyledVideo ref={videoRef} {...props} />;\n};\n", "export { StyledMenuTile } from './StyledMenuTile';\n", "import * as Popover from '@radix-ui/react-popover';\nimport { styled } from '../Theme';\nimport { popoverAnimation } from '../utils/animations';\nimport { flexCenter } from '../utils/styles';\n\nconst Root = Popover.Root;\n\nconst StyledTrigger = styled(Popover.Trigger, {\n  position: 'absolute',\n  bottom: '$2',\n  right: '$2',\n  zIndex: 10,\n  width: '$13',\n  height: '$13',\n  color: '$on_surface_high',\n  borderRadius: '$2',\n  backgroundColor: '$surface_bright',\n  cursor: 'pointer',\n  border: 'none',\n  ...flexCenter,\n  '&:not([disabled]):focus': {\n    outline: 'none',\n    boxShadow: '0 0 0 3px $colors$primary_bright',\n  },\n});\n\nconst StyledContent = styled(Popover.Content, {\n  fontFamily: '$sans',\n  backgroundColor: '$surface_dim',\n  padding: '$5 0',\n  display: 'flex',\n  flexDirection: 'column',\n  borderRadius: '$space$6',\n  zIndex: 11,\n  width: '$60',\n  ...popoverAnimation,\n});\n\nconst styledItem = {\n  fontSize: '$sm',\n  color: '$on_surface_high',\n  display: 'flex',\n  alignItems: 'center',\n  padding: '$4 $6',\n  width: '100%',\n  backgroundColor: '$menuBg',\n};\n\nconst StyledItemButton = styled('button', {\n  ...styledItem,\n  height: '$14',\n  border: 'none',\n  '&:hover': {\n    backgroundColor: '$surface_brighter',\n  },\n  cursor: 'pointer',\n  // TODO: default focus applied cause issues with this style\n  '&:focus': {\n    outline: 'none',\n    // backgroundColor: '$grey3',\n  },\n  '& > * + *': {\n    marginRight: '0',\n    marginLeft: '$4',\n  },\n});\n\nconst StyledVolumeItem = styled('div', {\n  // TODO: maybe keep this as base comp and extend button variant\n  ...styledItem,\n  alignItems: 'start',\n  flexDirection: 'column',\n  marginBottom: '0',\n});\n\nexport const Flex = styled('div', {\n  display: 'flex',\n  '& > * + *': {\n    marginRight: '0',\n    marginLeft: '$4',\n  },\n});\n\nconst RemoveMenuItem = styled(StyledItemButton, {\n  color: '$alert_error_default',\n  borderTop: '1px solid $border_bright',\n});\n\ninterface MenuTileType {\n  Root: typeof Root;\n  Trigger: typeof StyledTrigger;\n  Content: typeof StyledContent;\n  ItemButton: typeof StyledItemButton;\n  VolumeItem: typeof StyledVolumeItem;\n  RemoveItem: typeof RemoveMenuItem;\n}\n\nexport const StyledMenuTile: MenuTileType = {\n  Root,\n  Trigger: StyledTrigger,\n  Content: StyledContent,\n  ItemButton: StyledItemButton,\n  VolumeItem: StyledVolumeItem,\n  RemoveItem: RemoveMenuItem,\n};\n", "export { useBorderAudioLevel } from './useBorderAudioLevel';\nexport { AudioLevel } from './AudioLevel';\n", "import { useCallback, useRef } from 'react';\nimport { HMSTrackID } from '@100mslive/hms-video-store';\nimport { useAudioLevelStyles } from '@100mslive/react-sdk';\nimport { useTheme } from '../Theme';\n\n/**\n * pass in a track id and get a ref. That ref can be attached to an element which will have border\n * as per audio level post that.\n */\nexport function useBorderAudioLevel(audioTrackId?: HMSTrackID) {\n  const { theme } = useTheme();\n  const color = theme.colors.primary_default.value;\n  const getStyle = useCallback(\n    (level: number) => {\n      const style: Record<string, string> = {\n        transition: 'outline 0.4s ease-in-out',\n      };\n      style['outline'] = level ? `${sigmoid(level) * 4}px solid ${color}` : '0px solid transparent';\n      return style;\n    },\n    [color],\n  );\n  const ref = useRef(null);\n  useAudioLevelStyles({\n    trackId: audioTrackId,\n    getStyle,\n    ref,\n  });\n  return ref;\n}\n\nexport const sigmoid = (z: number) => {\n  return 1 / (1 + Math.exp(-z));\n};\n", "import React, { useEffect, useRef } from 'react';\nimport { selectTrackAudioByID, useHMSVanillaStore } from '@100mslive/react-sdk';\nimport { Box, Flex } from '../Layout';\nimport { keyframes } from '../Theme';\n//@ts-ignore\nimport bg from './audio-level.png';\n\n// keep the calculated values before hand to avoid recalcuation everytime\nconst positionValues = new Array(101).fill(0).reduce((acc, _, index) => {\n  acc[index] = Math.round((index / 100) * 4) / 4; // convert to 0.25 multiples\n  return acc;\n}, {});\n\nconst barAnimation = keyframes({\n  from: {\n    maskSize: '4em .8em',\n    '-webkit-mask-position-y': '.1em',\n    maskPosition: 'initial .1em',\n  },\n\n  '50%': {\n    maskSize: '4em 1em',\n    '-webkit-mask-position-y': 0,\n    maskPosition: 'initial 0',\n  },\n\n  to: {\n    maskSize: '4em .8em',\n    '-webkit-mask-position-y': '.1em',\n    maskPosition: 'initial 0.1em',\n  },\n});\n\nconst AudioBar = () => {\n  return (\n    <Box\n      css={{\n        width: '.25em',\n        height: '1em',\n        maskImage: `url(${bg})`,\n        '-webkit-mask-repeat': 'no-repeat',\n        backgroundColor: '$on_primary_high',\n        maskSize: '4em 1em',\n      }}\n    />\n  );\n};\n\nexport const AudioLevel = ({ trackId, size }: { trackId?: string; size?: 'small' | 'medium' }) => {\n  const ref = useRef<HTMLDivElement | null>(null);\n  const vanillaStore = useHMSVanillaStore();\n\n  useEffect(() => {\n    const unsubscribe = vanillaStore.subscribe(audioLevel => {\n      if (ref.current) {\n        let index = 0;\n        //@ts-ignore\n        for (const child of ref.current.children) {\n          const positionX = `-${positionValues[audioLevel] * (index === 1 ? 2.5 : 1.25)}em`;\n          child.style['-webkit-mask-position-x'] = positionX;\n          child.style['mask-position'] = `${positionX} 0`;\n          child.style['animation'] =\n            positionValues[audioLevel] > 0 ? `${barAnimation} 0.6s steps(3,jump-none) 0s infinite` : 'none';\n          index++;\n        }\n      }\n    }, selectTrackAudioByID(trackId));\n    return unsubscribe;\n  }, [vanillaStore, trackId]);\n  return (\n    <Flex\n      ref={ref}\n      css={{\n        fontSize: size === 'small' ? '0.75rem' : '1rem',\n        gap: size === 'small' ? '$1' : '$2',\n      }}\n    >\n      <AudioBar />\n      <AudioBar />\n      <AudioBar />\n    </Flex>\n  );\n};\n", "import { Arrow, Close, Content, Popover as Root, Portal, Trigger } from '@radix-ui/react-popover';\nimport { styled } from '../Theme';\nimport { popoverAnimation } from '../utils/animations';\n\nconst StyledContent = styled(Content, {\n  padding: '$6',\n  borderRadius: '$2',\n  backgroundColor: '$background_default',\n  boxShadow: '$sm',\n  zIndex: 12,\n  ...popoverAnimation,\n});\n\nconst StyledArrow = styled(Arrow, {\n  ...popoverAnimation,\n});\n\nconst StyledTrigger = styled(Trigger, {\n  '&:hover': {\n    cursor: 'pointer',\n  },\n  '&:focus-visible': {\n    boxShadow: '0 0 0 3px $colors$primary_default',\n  },\n});\n\nexport const Popover = {\n  Root,\n  Content: StyledContent,\n  Trigger: StyledTrigger,\n  Portal: Portal,\n  Arrow: StyledArrow,\n  Close: Close,\n};\n", "export { VideoTileStats } from './Stats';\nexport { formatBytes } from './formatBytes';\n", "import React, { Fragment } from 'react';\nimport {\n  HMSPeerID,\n  HMSTrackID,\n  HMSTrackStats,\n  RID,\n  selectConnectionQualityByPeerID,\n  selectHMSStats,\n  simulcastMapping,\n  useHMSStatsStore,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { Tooltip } from '../Tooltip';\nimport { formatBytes } from './formatBytes';\nimport { Stats } from './StyledStats';\nimport { useQoE } from './useQoE';\n\nexport interface VideoTileStatsProps {\n  videoTrackID?: HMSTrackID;\n  audioTrackID?: HMSTrackID;\n  peerID?: HMSPeerID;\n  isLocal: boolean;\n}\n\n/**\n * This component can be used to overlay webrtc stats over the Video Tile. For the local tracks it also includes\n * remote inbound stats as sent by the SFU in receiver report.\n */\nexport function VideoTileStats({ videoTrackID, audioTrackID, peerID, isLocal = false }: VideoTileStatsProps) {\n  const audioSelector = isLocal ? selectHMSStats.localAudioTrackStatsByID : selectHMSStats.trackStatsByID;\n  const audioTrackStats = useHMSStatsStore(audioSelector(audioTrackID));\n  const localVideoTrackStats = useHMSStatsStore(selectHMSStats.localVideoTrackStatsByID(videoTrackID));\n  const remoteVideoTrackStats = useHMSStatsStore(selectHMSStats.trackStatsByID(videoTrackID));\n  const videoTrackStats = isLocal ? localVideoTrackStats?.[0] : remoteVideoTrackStats;\n  const downlinkScore = useHMSStore(selectConnectionQualityByPeerID(peerID))?.downlinkQuality;\n  const availableOutgoingBitrate = useHMSStatsStore(selectHMSStats.availablePublishBitrate);\n  const qoe = useQoE({ videoTrackID, audioTrackID, isLocal });\n\n  // Viewer role - no stats to show\n  if (!(audioTrackStats || videoTrackStats)) {\n    return null;\n  }\n  return (\n    <Stats.Root>\n      <table>\n        <tbody>\n          {isLocal ? (\n            <Fragment>\n              <StatsRow\n                show={isNotNullishAndNot0(availableOutgoingBitrate)}\n                label=\"AOBR\"\n                tooltip=\"Available Outgoing Bitrate\"\n                value={formatBytes(availableOutgoingBitrate, 'b/s')}\n              />\n              {localVideoTrackStats?.map(stat => {\n                if (!stat) {\n                  return null;\n                }\n                const layer = stat.rid ? simulcastMapping[stat.rid as RID] : '';\n                return (\n                  <Fragment key={`${stat.id}${stat.rid}`}>\n                    {layer && <StatsRow label={layer.toUpperCase()} value=\"\" />}\n                    <StatsRow\n                      show={isNotNullishAndNot0(stat.frameWidth)}\n                      label=\"Width\"\n                      value={stat.frameWidth?.toString()}\n                    />\n                    <StatsRow\n                      show={isNotNullishAndNot0(stat.frameHeight)}\n                      label=\"Height\"\n                      value={stat.frameHeight?.toString()}\n                    />\n                    <StatsRow\n                      show={isNotNullishAndNot0(stat.framesPerSecond)}\n                      label=\"FPS\"\n                      value={`${stat.framesPerSecond} ${\n                        isNotNullishAndNot0(stat.framesDropped) ? `(${stat.framesDropped} dropped)` : ''\n                      }`}\n                    />\n                    <StatsRow\n                      show={isNotNullish(stat.bitrate)}\n                      label=\"Bitrate(V)\"\n                      value={formatBytes(stat.bitrate, 'b/s')}\n                    />\n                    <Stats.Gap />\n                  </Fragment>\n                );\n              })}\n            </Fragment>\n          ) : (\n            <Fragment>\n              <StatsRow show={isNotNullish(qoe)} label=\"QoE\" value={qoe} />\n              <StatsRow\n                show={isNotNullishAndNot0(videoTrackStats?.frameWidth)}\n                label=\"Width\"\n                value={videoTrackStats?.frameWidth?.toString()}\n              />\n              <StatsRow\n                show={isNotNullishAndNot0(videoTrackStats?.frameHeight)}\n                label=\"Height\"\n                value={videoTrackStats?.frameHeight?.toString()}\n              />\n              <StatsRow\n                show={isNotNullishAndNot0(videoTrackStats?.framesPerSecond)}\n                label=\"FPS\"\n                value={`${videoTrackStats?.framesPerSecond} ${\n                  isNotNullishAndNot0(videoTrackStats?.framesDropped)\n                    ? `(${videoTrackStats?.framesDropped} dropped)`\n                    : ''\n                }`}\n              />\n              <StatsRow\n                show={isNotNullish(videoTrackStats?.totalPausesDuration)}\n                label=\"Pauses Duration\"\n                value={videoTrackStats?.totalPausesDuration}\n              />\n              <StatsRow\n                show={isNotNullish(videoTrackStats?.totalFreezesDuration)}\n                label=\"Freezes Duration\"\n                value={videoTrackStats?.totalFreezesDuration}\n              />\n              <StatsRow\n                show={isNotNullish(videoTrackStats?.bitrate)}\n                label=\"Bitrate(V)\"\n                value={formatBytes(videoTrackStats?.bitrate, 'b/s')}\n              />\n            </Fragment>\n          )}\n\n          <StatsRow\n            show={isNotNullish(audioTrackStats?.bitrate)}\n            label=\"Bitrate(A)\"\n            value={formatBytes(audioTrackStats?.bitrate, 'b/s')}\n          />\n\n          <StatsRow show={isNotNullish(downlinkScore)} label=\"CQS\" value={downlinkScore} />\n\n          <StatsRow show={isNotNullish(videoTrackStats?.codec)} label=\"Codec(V)\" value={videoTrackStats?.codec} />\n\n          <StatsRow show={isNotNullish(audioTrackStats?.codec)} label=\"Codec(A)\" value={audioTrackStats?.codec} />\n\n          <PacketLostAndJitter audioTrackStats={audioTrackStats} videoTrackStats={videoTrackStats} />\n        </tbody>\n      </table>\n    </Stats.Root>\n  );\n}\n\nconst PacketLostAndJitter = ({\n  audioTrackStats,\n  videoTrackStats,\n}: {\n  audioTrackStats?: HMSTrackStats;\n  videoTrackStats?: HMSTrackStats;\n}) => {\n  // for local peer, we'll use the remote inbound stats to get packet loss and jitter, to know whether the track is\n  // local we check if the stats type has outbound in it as it's being published from local. Both audio and video\n  // tracks are checked in case the user has permission to publish only one of them.\n  const isLocalPeer = audioTrackStats?.type.includes('outbound') || videoTrackStats?.type.includes('outbound');\n  const audioStats = isLocalPeer ? audioTrackStats?.remote : audioTrackStats;\n  const videoStats = isLocalPeer ? videoTrackStats?.remote : videoTrackStats;\n  return (\n    <>\n      <TrackPacketsLostRow label=\"Packet Loss(V)\" stats={videoStats} />\n      <TrackPacketsLostRow label=\"Packet Loss(A)\" stats={audioStats} />\n      <StatsRow show={isNotNullish(videoStats?.jitter)} label=\"Jitter(V)\" value={videoStats?.jitter?.toFixed(4)} />\n      <StatsRow show={isNotNullish(audioStats?.jitter)} label=\"Jitter(A)\" value={audioStats?.jitter?.toFixed(4)} />\n    </>\n  );\n};\n\nconst TrackPacketsLostRow = ({\n  stats,\n  label,\n}: {\n  stats?: Pick<HMSTrackStats, 'packetsLost' | 'packetsLostRate'>;\n  label: string;\n}) => {\n  const packetsLostRate = `${stats?.packetsLostRate ? stats.packetsLostRate.toFixed(2) : 0}/s`;\n\n  return (\n    <StatsRow\n      show={isNotNullishAndNot0(stats?.packetsLost)}\n      label={label}\n      value={`${stats?.packetsLost}(${packetsLostRate})`}\n    />\n  );\n};\n\nconst RawStatsRow = ({\n  label = '',\n  value = '',\n  tooltip = '',\n  show = true,\n}: {\n  label: string;\n  value?: string | number;\n  show?: boolean;\n  tooltip?: string;\n}) => {\n  const statsLabel = <Stats.Label>{label}</Stats.Label>;\n\n  return (\n    <>\n      {show ? (\n        <Stats.Row>\n          {tooltip ? (\n            <Tooltip side=\"top\" title={tooltip}>\n              {statsLabel}\n            </Tooltip>\n          ) : (\n            statsLabel\n          )}\n          {value === '' ? <Stats.Value /> : <Stats.Value>{value}</Stats.Value>}\n        </Stats.Row>\n      ) : null}\n    </>\n  );\n};\n\n// memoize so only the rows which change rerender\nconst StatsRow = React.memo(RawStatsRow);\n\nexport function isNotNullishAndNot0(value: number | undefined | null) {\n  return isNotNullish(value) && value !== 0;\n}\n\n/**\n * Check only for presence(not truthy) of a value.\n * Use in places where 0, false need to be considered valid.\n */\nexport function isNotNullish(value: number | string | undefined | null) {\n  return value !== undefined && value !== null;\n}\n", "export const formatBytes = (bytes?: number, unit = 'B', decimals = 2) => {\n  if (bytes === 0) {\n    return `0 ${unit}`;\n  }\n  if (!bytes) {\n    return '-';\n  }\n\n  const k = 1024;\n  const dm = decimals < 0 ? 0 : decimals;\n  const sizes = ['', 'K', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y'].map(size => size + unit);\n\n  let i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  // B to KB\n  i === 0 && i++;\n\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(dm))} ${sizes[i]}`;\n};\n", "import { styled } from '../Theme';\n\nexport const Root = styled('div', {\n  backgroundColor: 'rgba(0,0,0,0.75)',\n  position: 'absolute',\n  top: '$3',\n  left: '$3',\n  zIndex: 7,\n  borderRadius: '$2',\n  padding: '$2',\n  fontSize: '$xs',\n  overflowY: 'auto',\n  maxHeight: '75%',\n  maxWidth: '85%',\n});\n\nexport const Table = styled('table', {});\n\nexport const Row = styled('tr', {\n  width: '100%',\n  '& > * + *': {\n    px: '$4',\n  },\n  whiteSpace: 'nowrap',\n  textAlign: 'left',\n});\n\nexport const Label = styled('td', {\n  color: '$on_primary_high',\n  fontWeight: '$regular',\n});\n\nexport const Value = styled('td', {\n  color: '$on_primary_high',\n});\n\nexport const Gap = styled('tr', {\n  height: '$4',\n});\n\ninterface StatsType {\n  Root: typeof Root;\n  Row: typeof Row;\n  Label: typeof Label;\n  Value: typeof Value;\n  Table: typeof Table;\n  Gap: typeof Gap;\n}\n\nexport const Stats: StatsType = {\n  Root,\n  Row,\n  Label,\n  Value,\n  Table,\n  Gap,\n};\n", "import { useRef } from 'react';\nimport { usePrevious } from 'react-use';\nimport { HMSTrackID, selectHMSStats, useHMSStatsStore } from '@100mslive/react-sdk';\n\ninterface UseQoEProps {\n  videoTrackID?: HMSTrackID;\n  audioTrackID?: HMSTrackID;\n  isLocal?: boolean;\n}\n\nconst EXPECTED_RESOLUTION = 1280 * 720;\n\nconst clip = (value: number, min_value: number, max_value: number) => {\n  return Math.max(Math.min(value, max_value), min_value);\n};\n\n/**\n * calculate QoE using 5 params:\n * p1:freeze_duration_norm\n * p2:resolution_norm\n * p3:fps_norm\n * p4:delay_norm\n * p5:audio_concealed_norm\n * the formula is 5*(p1)^3 * (p2)^0.3 * (p3)^0.5 * (p4)^1 * (p5)*2\n *\n * https://github.com/100mslive/webrtc-benchmark/blob/daily/sssd.py#L112\n */\nexport const useQoE = ({ videoTrackID, audioTrackID, isLocal = false }: UseQoEProps) => {\n  const audioTrackStats = useHMSStatsStore(selectHMSStats.trackStatsByID(audioTrackID));\n  const videoTrackStats = useHMSStatsStore(selectHMSStats.trackStatsByID(videoTrackID));\n  const prevVideoTrackStats = usePrevious(videoTrackStats);\n  const prevAudioTrackStats = usePrevious(audioTrackStats);\n\n  const prevJitterBufferDelayMs = useRef<number>(0);\n\n  if (isLocal || (videoTrackID && !videoTrackStats) || (audioTrackID && !audioTrackStats)) {\n    return;\n  }\n\n  const resolutionNorm =\n    ((videoTrackStats?.frameWidth || 0) * (videoTrackStats?.frameHeight || 0)) / EXPECTED_RESOLUTION;\n\n  const framesDecodedInLastSec =\n    videoTrackStats?.framesDecoded && prevVideoTrackStats?.framesDecoded\n      ? videoTrackStats.framesDecoded - prevVideoTrackStats.framesDecoded\n      : 0;\n  let freezeDurationNorm =\n    1 - ((videoTrackStats?.totalFreezesDuration || 0) - (prevVideoTrackStats?.totalFreezesDuration || 0));\n  freezeDurationNorm = freezeDurationNorm < 0 ? 0.5 : freezeDurationNorm;\n  freezeDurationNorm = framesDecodedInLastSec === 0 ? 0 : freezeDurationNorm;\n\n  const fpsNorm = framesDecodedInLastSec / 30;\n\n  const prevJBDelay = prevVideoTrackStats?.jitterBufferDelay || 0;\n  const prevJBEmittedCount = prevVideoTrackStats?.jitterBufferEmittedCount || 0;\n  const currentJBDelay = (videoTrackStats?.jitterBufferDelay || 0) - prevJBDelay;\n  const currentJBEmittedCount = (videoTrackStats?.jitterBufferEmittedCount || 0) - prevJBEmittedCount;\n\n  const jitterBufferDelayMs =\n    currentJBEmittedCount > 0 ? (currentJBDelay * 1000) / currentJBEmittedCount : prevJitterBufferDelayMs.current;\n  prevJitterBufferDelayMs.current = jitterBufferDelayMs;\n  const delayNorm = 1 - Math.min(1, jitterBufferDelayMs / 2000);\n\n  const prevConcealedSamples =\n    (prevAudioTrackStats?.concealedSamples || 0) - (prevAudioTrackStats?.silentConcealedSamples || 0);\n  const currentConcealedSamples =\n    (audioTrackStats?.concealedSamples || 0) - (audioTrackStats?.silentConcealedSamples || 0) - prevConcealedSamples;\n\n  const audioConcealedNorm = 1 - currentConcealedSamples / 48000;\n\n  return (\n    5 *\n    clip(freezeDurationNorm, 0, 1) ** 3 *\n    clip(resolutionNorm, 0, 1) ** 0.3 *\n    clip(fpsNorm, 0, 1) ** 0.2 *\n    clip(delayNorm, 0, 1) ** 0.5 *\n    clip(audioConcealedNorm, 0, 1) ** 2\n  ).toFixed(2);\n};\n", "import * as CheckboxPrimitive from '@radix-ui/react-checkbox';\nimport { styled } from '../Theme';\n\nconst CheckboxRoot = styled(CheckboxPrimitive.Root, {\n  all: 'unset',\n  border: '1px solid $primary_default',\n  backgroundColor: '$on_primary_high',\n  width: '$8',\n  height: '$8',\n  borderRadius: '$0',\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n  boxShadow: 'none',\n  outline: 'none',\n  cursor: 'pointer',\n  '&:focus': {\n    boxShadow: 'none',\n    outline: 'none',\n  },\n  '&[data-state=\"checked\"]': {\n    backgroundColor: '$primary_default',\n  },\n});\n\nconst CheckboxIndicator = styled(CheckboxPrimitive.Indicator, {\n  color: '$on_primary_high',\n});\n\nexport const Checkbox = {\n  Root: CheckboxRoot,\n  Indicator: CheckboxIndicator,\n};\n", "import * as LabelPrimitive from '@radix-ui/react-label';\nimport { styled } from '../Theme';\n\nexport const Label = styled(LabelPrimitive.Root, {\n  fontFamily: '$sans',\n  fontSize: '$md',\n  color: '$on_primary_high',\n});\n", "import * as RadioGroupPrimitive from '@radix-ui/react-radio-group';\nimport { styled } from '../Theme';\n\nconst RadioGroupRoot = styled(RadioGroupPrimitive.Root, {\n  display: 'flex',\n  alignItems: 'center',\n});\n\nconst RadioGroupItem = styled(RadioGroupPrimitive.Item, {\n  bg: '$on_primary_high',\n  width: '$8',\n  height: '$8',\n  border: '1px solid $primary_default',\n  cursor: 'pointer',\n  borderRadius: '$round',\n  '&:focus': {\n    boxShadow: 'none',\n    outline: 'none',\n  },\n  '&[data-state=\"checked\"]': {\n    borderWidth: '$space$2',\n    p: '$1',\n  },\n});\nconst RadioGroupIndicator = styled(RadioGroupPrimitive.Indicator, {\n  bg: '$primary_default',\n});\n\nexport const RadioGroup = {\n  Root: RadioGroupRoot,\n  Item: RadioGroupItem,\n  Indicator: RadioGroupIndicator,\n};\n", "import React, { ComponentProps } from 'react';\nimport type { ToastProps } from '@radix-ui/react-toast';\nimport * as ToastPrimitives from '@radix-ui/react-toast';\nimport { CrossIcon } from '@100mslive/react-icons';\nimport { IconButton } from '../IconButton';\nimport { Box, Flex } from '../Layout';\nimport { Text } from '../Text';\nimport { styled } from '../Theme';\nimport { toastAnimation } from '../utils';\n\nconst getToastVariant = (base: string) => {\n  return {\n    borderLeftColor: base,\n    borderLeft: 0,\n    '&:before': {\n      position: 'absolute',\n      top: '-1px',\n      left: '-$4',\n      width: '$8',\n      borderLeft: `solid $space$px ${base}`,\n      borderTop: `solid $space$px ${base}`,\n      borderBottom: `solid $space$px ${base}`,\n      borderTopLeftRadius: '$3',\n      borderBottomLeftRadius: '$3',\n      bg: base,\n      content: ' ',\n      height: '100%',\n      zIndex: 10,\n    },\n    '@sm': {\n      '&:before': {\n        content: 'none',\n      },\n      border: `solid $space$px ${base}`,\n    },\n  };\n};\n\nconst ToastRoot = styled(ToastPrimitives.Root, {\n  r: '$3',\n  bg: '$surface_default',\n  p: '$10',\n  display: 'flex',\n  flexDirection: 'column',\n  position: 'relative',\n  fontFamily: '$sans',\n  border: 'solid $space$px $border_bright',\n  overflow: 'hidden',\n  ...toastAnimation,\n  '@sm': {\n    p: '$8 $11',\n  },\n  variants: {\n    variant: {\n      standard: getToastVariant('$secondary_default'),\n      warning: getToastVariant('$alert_warning'),\n      error: getToastVariant('$alert_error_default'),\n      success: getToastVariant('$alert_success'),\n    },\n  },\n  defaultVariants: {\n    variant: 'standard',\n  },\n});\n\nconst ToastTitle = styled(ToastPrimitives.Title, {\n  fontSize: '$md',\n  color: '$on_surface_high',\n  fontWeight: '$semiBold',\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'space-between',\n});\nconst ToastDescription = styled(ToastPrimitives.Description, {\n  color: '$on_surface_medium',\n});\nconst ToastClose = styled(ToastPrimitives.Close, {});\nconst ToastAction = styled(ToastPrimitives.Action, {\n  cursor: 'pointer',\n  background: 'none',\n  border: 'none',\n});\nconst ToastViewport = styled(ToastPrimitives.Viewport, {\n  position: 'fixed',\n  bottom: 0,\n  left: 0,\n  display: 'flex',\n  flexDirection: 'column',\n  padding: '$8',\n  gap: 10,\n  width: 390,\n  '@sm': {\n    width: '100%',\n    padding: '$6',\n  },\n  maxWidth: '100vw',\n  margin: 0,\n  listStyle: 'none',\n  zIndex: 1000,\n});\n\nconst DefaultClose = ({ css }: Pick<ComponentProps<typeof ToastClose>, 'css'>) => {\n  return (\n    <ToastClose css={css} asChild>\n      <IconButton>\n        <CrossIcon />\n      </IconButton>\n    </ToastClose>\n  );\n};\n\ninterface HMSToastProps extends ToastProps {\n  title: string;\n  description?: string;\n  isClosable?: boolean;\n  icon?: React.ReactNode;\n  action?: React.ReactNode;\n  inlineAction?: boolean;\n}\n\nconst HMSToast: React.FC<HMSToastProps> = ({\n  title,\n  description,\n  isClosable = true,\n  icon,\n  action,\n  inlineAction = false,\n  ...props\n}) => {\n  return (\n    <>\n      <ToastRoot {...props}>\n        <ToastTitle>\n          <Flex align=\"center\" css={{ gap: '$4', flex: '1 1 0', minWidth: 0 }}>\n            {icon ? <Box css={{ w: '$10', h: '$10', alignSelf: 'start', mt: '$2' }}>{icon}</Box> : null}\n            <Text variant=\"sub1\" css={{ c: 'inherit', wordBreak: 'break-word' }}>\n              {title}\n            </Text>\n          </Flex>\n          {isClosable ? <DefaultClose /> : null}\n          {!isClosable && inlineAction && action ? (\n            <ToastAction altText={`${title}Action`}>{action}</ToastAction>\n          ) : null}\n        </ToastTitle>\n        {description ? (\n          <ToastDescription>\n            <Text variant=\"body1\" css={{ fontWeight: '$regular', c: '$on_surface_medium' }}>\n              {description}\n            </Text>\n          </ToastDescription>\n        ) : null}\n        {!inlineAction && action ? (\n          <ToastAction altText={`${title}Action`} css={{ mt: '$10' }}>\n            {action}\n          </ToastAction>\n        ) : null}\n      </ToastRoot>\n    </>\n  );\n};\nexport const Toast = {\n  Provider: ToastPrimitives.Provider,\n  Root: ToastRoot,\n  Title: ToastTitle,\n  Description: ToastDescription,\n  Close: DefaultClose,\n  Action: ToastAction,\n  Viewport: ToastViewport,\n  HMSToast: HMSToast,\n};\n", "import { AccordionContent, AccordionHeader, AccordionItem, AccordionRoot } from './Accordion';\n\nexport const Accordion = {\n  Root: AccordionRoot,\n  Item: AccordionItem,\n  Content: AccordionContent,\n  Header: AccordionHeader,\n};\n", "import React, { PropsWithChildren } from 'react';\nimport * as BaseAccordion from '@radix-ui/react-accordion';\nimport { CSS } from '@stitches/react';\nimport { ChevronUpIcon } from '@100mslive/react-icons';\nimport { Box } from '../Layout';\nimport { styled } from '../Theme';\nimport { slideDown, slideUp } from '../utils';\n\nconst StyledAccordion = styled(BaseAccordion.Root, {});\n\nconst StyledItem = styled(BaseAccordion.Item, {\n  marginTop: '$px',\n  display: 'block',\n  '&:first-child': {\n    marginTop: 0,\n    borderTopLeftRadius: '$0',\n    borderTopRightRadius: '$0',\n  },\n  '&:last-child': {\n    borderBottomLeftRadius: '$4',\n    borderBottomRightRadius: '$4',\n  },\n});\n\nconst StyledHeader = styled(BaseAccordion.Header, {\n  all: 'unset',\n  display: 'flex',\n  fontFamily: '$sans',\n});\n\nconst StyledTrigger = styled(BaseAccordion.Trigger, {\n  all: 'unset',\n  fontFamily: '$sans',\n  flex: 1,\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'space-between',\n  fontSize: '$md',\n  lineHeight: '$md',\n  color: '$on_surface_high',\n});\n\nconst StyledContent = styled(BaseAccordion.Content, {\n  display: 'contents',\n  fontSize: '$md',\n  fontFamily: '$sans',\n  color: '$on_surface_medium',\n  '&[data-state=\"open\"]': {\n    animation: `${slideDown('--radix-accordion-content-height')} 300ms cubic-bezier(0.87, 0, 0.13, 1) forwards`,\n  },\n  '&[data-state=\"closed\"]': {\n    animation: `${slideUp('--radix-accordion-content-height')} 300ms cubic-bezier(0.87, 0, 0.13, 1) forwards`,\n  },\n});\n\nconst StyledChevron = styled(ChevronUpIcon, {\n  color: '$on_primary_high',\n  transition: 'transform 300ms cubic-bezier(0.87, 0, 0.13, 1)',\n  '[data-state=closed] &': { transform: 'rotate(180deg)' },\n});\n\n// Exports\nexport const AccordionRoot = StyledAccordion;\nexport const AccordionItem = StyledItem;\n\nexport const AccordionHeader: React.FC<\n  PropsWithChildren<BaseAccordion.AccordionTriggerProps & { iconStyles?: CSS; css?: CSS; chevronID?: string }>\n> = React.forwardRef<\n  HTMLButtonElement,\n  PropsWithChildren<BaseAccordion.AccordionTriggerProps & { iconStyles?: CSS; css?: CSS; chevronID?: string }>\n>(({ children, iconStyles, css, chevronID, ...props }, forwardedRef) => (\n  <StyledHeader css={css}>\n    <StyledTrigger {...props} ref={forwardedRef}>\n      {children}\n      <StyledChevron data-testid={chevronID} aria-hidden css={iconStyles} />\n    </StyledTrigger>\n  </StyledHeader>\n));\n\nexport const AccordionContent: React.FC<\n  PropsWithChildren<BaseAccordion.AccordionContentProps & { contentStyles?: CSS }>\n> = React.forwardRef<HTMLDivElement, PropsWithChildren<BaseAccordion.AccordionContentProps & { contentStyles?: CSS }>>(\n  ({ children, contentStyles, ...props }, forwardedRef) => (\n    <StyledContent {...props} ref={forwardedRef}>\n      <Box css={contentStyles}>{children}</Box>\n    </StyledContent>\n  ),\n);\n", "import { styled } from '../Theme';\n\nconst StyledFieldset = styled('fieldset', {\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'space-between',\n  border: 'none',\n  backgroundColor: 'transparent',\n});\n\nexport const Fieldset = StyledFieldset;\n", "export { Footer } from './Footer';\n", "import { Flex } from '../Layout';\nimport { styled } from '../Theme';\n\nconst Root = styled(Flex, {\n  justifyContent: 'space-between',\n  alignItems: 'center',\n  py: '$4',\n  position: 'relative',\n  height: '100%',\n  '@md': { flexWrap: 'wrap', gap: '$4' },\n});\n\nconst Left = styled(Flex, {\n  alignItems: 'center',\n  position: 'absolute',\n  left: '$10',\n  gap: '$8',\n  '@md': {\n    position: 'unset',\n    justifyContent: 'center',\n    w: '100%',\n  },\n});\n\nconst Center = styled(Flex, {\n  w: '100%',\n  justifyContent: 'center',\n  alignItems: 'center',\n  gap: '$8',\n});\n\nconst Right = styled(Flex, {\n  alignItems: 'center',\n  position: 'absolute',\n  right: '$10',\n  gap: '$8',\n  '@md': {\n    display: 'none',\n  },\n});\n\nexport const Footer = {\n  Root,\n  Left,\n  Center,\n  Right,\n};\n", "export { Select } from './ReactSelect';\n", "import * as SelectPrimitive from '@radix-ui/react-select';\nimport { styled } from '../Theme';\n\nconst StyledRoot = styled(SelectPrimitive.Root, {});\n\nconst StyledTrigger = styled(SelectPrimitive.SelectTrigger, {\n  all: 'unset',\n  display: 'inline-flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n  borderRadius: '$2',\n  padding: '$8',\n  lineHeight: '$px',\n  gap: '$8',\n  backgroundColor: '$secondary_default',\n  color: '$on_primary_high',\n  fontSize: '$8',\n  cursor: 'pointer',\n  r: '$1',\n});\n\nconst StyledContent = styled(SelectPrimitive.Content, {\n  overflow: 'hidden',\n  backgroundColor: '$surface_bright',\n  r: '$1',\n  h: '$80',\n});\n\nconst StyledViewport = styled(SelectPrimitive.Viewport, {\n  padding: '$3',\n});\n\nconst StyledItem = styled(SelectPrimitive.Item, {\n  all: 'unset',\n  fontSize: '$7',\n  r: '$1',\n  display: 'flex',\n  p: '$4 $8',\n  w: '$52',\n  position: 'relative',\n  userSelect: 'none',\n  cursor: 'pointer',\n});\n\nconst StyledLabel = styled(SelectPrimitive.Label, {\n  p: '$4 $8',\n  lineHeight: '$10',\n  color: '$on_primary_high',\n});\n\nconst StyledSeparator = styled(SelectPrimitive.Separator, {\n  height: '$px',\n  backgroundColor: '$on_primary_high',\n  margin: '$4',\n  opacity: 0.4,\n});\n\nconst StyledItemIndicator = styled(SelectPrimitive.ItemIndicator, {\n  position: 'absolute',\n  right: '$8',\n  width: '$8',\n  display: 'inline-flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n  color: '$on_primary_high',\n});\n\nconst scrollButtonStyles = {\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n  p: '$4',\n  backgroundColor: '$surface_bright',\n  color: '$on_primary_high',\n  cursor: 'default',\n};\n\nconst StyledScrollUpButton = styled(SelectPrimitive.ScrollUpButton, scrollButtonStyles);\n\nconst StyledScrollDownButton = styled(SelectPrimitive.ScrollDownButton, scrollButtonStyles);\n\nexport const Select = {\n  Root: StyledRoot,\n  Trigger: StyledTrigger,\n  Content: StyledContent,\n  Viewport: StyledViewport,\n  Item: StyledItem,\n  Label: StyledLabel,\n  Separator: StyledSeparator,\n  ItemIndicator: StyledItemIndicator,\n  ScrollUpButton: StyledScrollUpButton,\n  ScrollDownButton: StyledScrollDownButton,\n  Value: SelectPrimitive.Value,\n  Icon: SelectPrimitive.Icon,\n  ItemText: SelectPrimitive.ItemText,\n  Group: SelectPrimitive.Group,\n};\n", "import * as TabsPrimitive from '@radix-ui/react-tabs';\nimport { styled } from '../Theme';\n\nconst StyledTabsRoot = styled(TabsPrimitive.Root, {\n  display: 'flex',\n});\n\nconst StyledList = styled(TabsPrimitive.List, {\n  flexShrink: 0,\n  display: 'flex',\n});\n\nconst StyledTrigger = styled(TabsPrimitive.Trigger, {\n  all: 'unset',\n  fontFamily: '$sans',\n  p: '$8',\n  display: 'flex',\n  alignItems: 'center',\n  fontSize: '$sm',\n  lineHeight: '$sm',\n  color: '$on_surface_high',\n  userSelect: 'none',\n  cursor: 'pointer',\n  '&[data-state=\"active\"]': {\n    bg: '$surface_brighter',\n    r: '$1',\n  },\n});\n\nconst StyledContent = styled(TabsPrimitive.Content, {\n  flex: '1 1 0',\n  padding: '$10',\n  outline: 'none',\n});\n\nexport const Tabs = {\n  Root: StyledTabsRoot,\n  List: StyledList,\n  Content: StyledContent,\n  Trigger: StyledTrigger,\n};\n", "import React, { ComponentProps } from 'react';\nimport { QRCodeSVG } from 'qrcode.react';\n\nexport const QRCode = (props: ComponentProps<typeof QRCodeSVG>) => {\n  return <QRCodeSVG style={{ width: '100%', height: '100%' }} {...props} />;\n};\n", "export { Link } from './Link';\nexport type { LinkProps } from './Link';\n", "import React from 'react';\nimport * as icons from '@100mslive/react-icons';\nimport { Flex } from '../Layout';\nimport { Text } from '../Text';\nimport { styled } from '../Theme';\n\nconst LinkComponent = styled('a', {\n  textDecoration: 'none',\n  display: 'flex',\n  alignItems: 'center',\n  gap: '$5',\n  variants: {\n    color: {\n      highEmp: {\n        color: '$on_surface_high',\n        '&:hover': {\n          color: '$on_surface_medium',\n        },\n      },\n      primary: {\n        color: '$primary_default',\n        '&:hover': {\n          color: '$primary_bright',\n        },\n      },\n    },\n  },\n});\n\nexport interface LinkProps extends React.ComponentProps<typeof LinkComponent> {\n  as?: React.ElementType;\n  iconSide?: 'left' | 'right' | 'none';\n  icon?: keyof typeof icons;\n  color?: 'highEmp' | 'primary';\n}\n\nexport const Link = ({ iconSide = 'left', icon, color = 'primary', children, ...rest }: LinkProps) => {\n  const Icon = icon ? icons[icon] : React.Fragment;\n  const renderedIcon = icon ? (\n    <Flex as=\"span\">\n      <Icon height={13.33} width={13.33} />{' '}\n    </Flex>\n  ) : null;\n\n  return (\n    <LinkComponent {...rest} color={color}>\n      {iconSide === 'left' && renderedIcon}\n      <Text as=\"span\" variant=\"body2\" css={{ color: 'inherit' }}>\n        {children}\n      </Text>\n      {iconSide === 'right' && renderedIcon}\n    </LinkComponent>\n  );\n};\n", "import { Content, Root, Trigger } from '@radix-ui/react-collapsible';\nimport { styled } from '../Theme';\nimport { slideDown, slideUp } from '../utils';\n\nconst CollapsibleRoot = styled(Root, {});\n\nconst CollapsibleTrigger = styled(Trigger, {\n  cursor: 'pointer',\n  appearance: 'none !important',\n  '&:focus': {\n    outline: 'none',\n  },\n  '&:focus-visible': {\n    boxShadow: '0 0 0 3px $colors$primary_default',\n  },\n});\n\nconst CollapsibleContent = styled(Content, {\n  w: '$80',\n  r: '$1',\n  overflowY: 'auto',\n  '&[data-state=\"open\"]': {\n    animation: `${slideDown('--radix-collapsible-content-height')} 300ms cubic-bezier(0.87, 0, 0.13, 1) forwards`,\n  },\n  '&[data-state=\"closed\"]': {\n    animation: `${slideUp('--radix-collapsible-content-height')} 300ms cubic-bezier(0.87, 0, 0.13, 1) forwards`,\n  },\n});\n\nexport const Collapsible = {\n  Root: CollapsibleRoot,\n  Trigger: CollapsibleTrigger,\n  Content: CollapsibleContent,\n};\n", "import React, { MutableRefObject, useEffect, useRef } from 'react';\nimport { HMSStatsStoreWrapper, HMSStoreWrapper, IHMSNotifications } from '@100mslive/hms-video-store';\nimport { Layout, Logo, Screens, Theme, Typography } from '@100mslive/types-prebuilt';\nimport { match } from 'ts-pattern';\nimport {\n  HMSActions,\n  HMSReactiveStore,\n  HMSRoomProvider,\n  selectIsConnectedToRoom,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { AppData } from './components/AppData/AppData';\n// @ts-ignore: No implicit Any\nimport AuthToken from './components/AuthToken';\nimport { ConferenceScreen } from './components/ConferenceScreen';\n// @ts-ignore: No implicit Any\nimport { ErrorBoundary } from './components/ErrorBoundary';\n// @ts-ignore: No implicit Any\nimport { Init } from './components/init/Init';\n// @ts-ignore: No implicit Any\nimport { KeyboardHandler } from './components/Input/KeyboardInputManager';\nimport { LeaveScreen } from './components/LeaveScreen';\nimport { MwebLandscapePrompt } from './components/MwebLandscapePrompt';\nimport { Notifications } from './components/Notifications';\nimport { PIPProvider } from './components/PIP/PIPProvider';\nimport { PreviewScreen } from './components/Preview/PreviewScreen';\n// @ts-ignore: No implicit Any\nimport { ToastContainer } from './components/Toast/ToastContainer';\nimport { VBHandler } from './components/VirtualBackground/VBHandler';\nimport { Sheet } from './layouts/Sheet';\nimport { RoomLayoutContext, RoomLayoutProvider, useRoomLayout } from './provider/roomLayoutProvider';\nimport { DialogContainerProvider } from '../context/DialogContext';\nimport { Box } from '../Layout';\nimport { globalStyles, HMSThemeProvider } from '../Theme';\nimport { HMSPrebuiltContext } from './AppContext';\nimport { AppStateContext, PrebuiltStates, useAppStateManager } from './AppStateContext';\n// @ts-ignore: No implicit Any\nimport { FlyingEmoji } from './plugins/FlyingEmoji';\n// @ts-ignore: No implicit Any\nimport { RemoteStopScreenshare } from './plugins/RemoteStopScreenshare';\n// @ts-ignore: No implicit Any\nimport { useIsNotificationDisabled } from './components/AppData/useUISettings';\nimport { useAutoStartStreaming } from './components/hooks/useAutoStartStreaming';\nimport {\n  useRoomLayoutLeaveScreen,\n  useRoomLayoutPreviewScreen,\n} from './provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { FeatureFlags } from './services/FeatureFlags';\n// @ts-ignore: No implicit Any\nimport { DEFAULT_PORTAL_CONTAINER } from './common/constants';\n\nexport type HMSPrebuiltOptions = {\n  userName?: string;\n  userId?: string;\n  endpoints?: object;\n  effectsSDKKey?: string;\n};\n\nexport type HMSPrebuiltProps = {\n  roomCode?: string;\n  logo?: Logo;\n  typography?: Typography;\n  themes?: Theme[];\n  options?: HMSPrebuiltOptions;\n  screens?: Screens;\n  authToken?: string;\n  leaveOnUnload?: boolean;\n  onLeave?: () => void;\n  onJoin?: () => void;\n  /**\n   * @remarks\n   * Specify css selectors for the HTML element to be used as container for dialogs. Affects the positioning and focus of dialogs.\n   */\n  containerSelector?: string;\n};\n\nexport type HMSPrebuiltRefType = {\n  hmsActions: HMSActions;\n  hmsStore: HMSStoreWrapper;\n  hmsStats: HMSStatsStoreWrapper;\n  hmsNotifications: IHMSNotifications;\n};\n\nexport const HMSPrebuilt = React.forwardRef<HMSPrebuiltRefType, HMSPrebuiltProps>(\n  (\n    {\n      roomCode = '',\n      authToken = '',\n      containerSelector = DEFAULT_PORTAL_CONTAINER,\n      logo,\n      typography,\n      themes,\n      options: { userName = '', userId = '', endpoints } = {},\n      screens,\n      leaveOnUnload = true,\n      onLeave,\n      onJoin,\n    },\n    ref,\n  ) => {\n    const reactiveStore = useRef<HMSPrebuiltRefType>();\n    const [hydrated, setHydrated] = React.useState(false);\n\n    useEffect(() => {\n      setHydrated(true);\n      const hms = new HMSReactiveStore();\n      const hmsStore = hms.getStore();\n      const hmsActions = hms.getActions();\n      const hmsNotifications = hms.getNotifications();\n      const hmsStats = hms.getStats();\n      hms.triggerOnSubscribe();\n\n      reactiveStore.current = {\n        hmsActions,\n        hmsStats,\n        hmsStore,\n        hmsNotifications,\n      };\n    }, []);\n\n    useEffect(() => {\n      if (!ref || !reactiveStore.current) {\n        return;\n      }\n      (ref as MutableRefObject<HMSPrebuiltRefType>).current = { ...reactiveStore.current };\n    }, [ref]);\n\n    useEffect(() => {\n      // leave room when component unmounts\n      return () => {\n        VBHandler.reset();\n        reactiveStore?.current?.hmsActions.leave();\n      };\n    }, []);\n\n    const endpointsObj = endpoints as\n      | {\n          init: string;\n          tokenByRoomCode: string;\n          roomLayout: string;\n          event: string;\n        }\n      | undefined;\n    const tokenByRoomCodeEndpoint: string = endpointsObj?.tokenByRoomCode || '';\n    const initEndpoint: string = endpointsObj?.init || '';\n    const eventEndpoint: string = endpointsObj?.event || '';\n    const roomLayoutEndpoint: string = endpointsObj?.roomLayout || '';\n\n    const overrideLayout: Partial<Layout> = {\n      logo,\n      themes,\n      typography,\n      screens,\n    };\n\n    if (!roomCode && !authToken) {\n      console.error(`\n          HMSPrebuilt can be initialised by providing: \n          either \"roomCode\" or \"authToken\".\n          Please check if you are providing the above values for initialising prebuilt.\n        `);\n      throw Error('Incorrect initializing params for HMSPrebuilt component');\n    }\n\n    if (!hydrated) {\n      return null;\n    }\n\n    globalStyles();\n\n    return (\n      <ErrorBoundary>\n        <HMSPrebuiltContext.Provider\n          value={{\n            roomCode,\n            containerSelector,\n            onLeave,\n            onJoin,\n            userName,\n            userId,\n            endpoints: {\n              tokenByRoomCode: tokenByRoomCodeEndpoint,\n              init: initEndpoint,\n              roomLayout: roomLayoutEndpoint,\n              event: eventEndpoint,\n            },\n          }}\n        >\n          <HMSRoomProvider\n            isHMSStatsOn={FeatureFlags.enableStatsForNerds}\n            actions={reactiveStore.current?.hmsActions}\n            store={reactiveStore.current?.hmsStore}\n            notifications={reactiveStore.current?.hmsNotifications}\n            stats={reactiveStore.current?.hmsStats}\n            leaveOnUnload={leaveOnUnload}\n          >\n            <RoomLayoutProvider roomLayoutEndpoint={roomLayoutEndpoint} overrideLayout={overrideLayout}>\n              <RoomLayoutContext.Consumer>\n                {data => {\n                  const layout = data?.layout;\n                  const theme: Theme = layout?.themes?.[0] || ({} as Theme);\n                  const { typography } = layout || {};\n                  let fontFamily = ['sans-serif'];\n                  if (typography?.font_family) {\n                    fontFamily = [`${typography?.font_family}`, ...fontFamily];\n                  }\n\n                  return (\n                    <HMSThemeProvider\n                      // issue is with stichtes caching the theme using the theme name / class\n                      // no updates to the themes are fired if the name is same.\n                      // TODO: cache the theme and do deep check to trigger name change in the theme\n                      themeType={`${theme.name}-${Date.now()}`}\n                      theme={{\n                        //@ts-ignore: Prebuilt theme to match stiches theme\n                        colors: theme.palette,\n                        fonts: {\n                          //@ts-ignore: font list to match token types of stiches\n                          sans: fontFamily,\n                        },\n                      }}\n                    >\n                      <PIPProvider>\n                        <Init />\n                        <DialogContainerProvider dialogContainerSelector={containerSelector}>\n                          <Box\n                            className={DEFAULT_PORTAL_CONTAINER.slice(1)} // Skips the '.' in the selector\n                            css={{\n                              bg: '$background_dim',\n                              size: '100%',\n                              lineHeight: '1.5',\n                              '-webkit-text-size-adjust': '100%',\n                              position: 'relative',\n                            }}\n                          >\n                            <AppRoutes\n                              authTokenByRoomCodeEndpoint={tokenByRoomCodeEndpoint}\n                              defaultAuthToken={authToken}\n                            />\n                          </Box>\n                        </DialogContainerProvider>\n                      </PIPProvider>\n                    </HMSThemeProvider>\n                  );\n                }}\n              </RoomLayoutContext.Consumer>\n            </RoomLayoutProvider>\n          </HMSRoomProvider>\n        </HMSPrebuiltContext.Provider>\n      </ErrorBoundary>\n    );\n  },\n);\n\nHMSPrebuilt.displayName = 'HMSPrebuilt';\n\nconst AppStates = ({ activeState }: { activeState: PrebuiltStates }) => {\n  const { isPreviewScreenEnabled } = useRoomLayoutPreviewScreen();\n  const { isLeaveScreenEnabled } = useRoomLayoutLeaveScreen();\n  useAutoStartStreaming();\n\n  return match({ activeState, isPreviewScreenEnabled, isLeaveScreenEnabled })\n    .with({ activeState: PrebuiltStates.PREVIEW, isPreviewScreenEnabled: true }, () => <PreviewScreen />)\n    .with({ activeState: PrebuiltStates.LEAVE, isLeaveScreenEnabled: true }, () => <LeaveScreen />)\n    .otherwise(() => <ConferenceScreen />);\n};\n\nconst BackSwipe = () => {\n  const isConnectedToRoom = useHMSStore(selectIsConnectedToRoom);\n  const hmsActions = useHMSActions();\n  useEffect(() => {\n    const onRouteLeave = async () => {\n      if (isConnectedToRoom) {\n        await hmsActions.leave();\n      }\n    };\n    window.addEventListener('popstate', onRouteLeave);\n    return () => {\n      window.removeEventListener('popstate', onRouteLeave);\n    };\n  }, [hmsActions, isConnectedToRoom]);\n  return null;\n};\n\nfunction AppRoutes({\n  authTokenByRoomCodeEndpoint,\n  defaultAuthToken,\n}: {\n  authTokenByRoomCodeEndpoint: string;\n  defaultAuthToken?: string;\n}) {\n  const roomLayout = useRoomLayout();\n  const isNotificationsDisabled = useIsNotificationDisabled();\n  const { activeState, rejoin } = useAppStateManager();\n  return (\n    <AppStateContext.Provider value={{ rejoin }}>\n      <>\n        {activeState !== PrebuiltStates.LEAVE && <AppData />}\n        <ToastContainer />\n        <Notifications />\n        <MwebLandscapePrompt />\n        <Sheet />\n        <BackSwipe />\n        {!isNotificationsDisabled && <FlyingEmoji />}\n        <RemoteStopScreenshare />\n        <KeyboardHandler />\n        <AuthToken\n          authTokenByRoomCodeEndpoint={authTokenByRoomCodeEndpoint}\n          defaultAuthToken={defaultAuthToken}\n          activeState={activeState}\n        />\n        {roomLayout && activeState && <AppStates activeState={activeState} />}\n      </>\n    </AppStateContext.Provider>\n  );\n}\n", "import React, { useEffect, useMemo, useRef } from 'react';\nimport { useMedia } from 'react-use';\nimport {\n  HMSRoomState,\n  selectFullAppData,\n  selectHLSState,\n  selectRoomState,\n  selectRTMPState,\n  useAVToggle,\n  useHMSActions,\n  useHMSStore,\n  useRecordingStreaming,\n} from '@100mslive/react-sdk';\nimport { config as cssConfig } from '../../../Theme';\nimport { LayoutMode } from '../Settings/LayoutSettings';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n//@ts-ignore\nimport { UserPreferencesKeys, useUserPreferences } from '../hooks/useUserPreferences';\n// @ts-ignore\nimport { useIsSidepaneTypeOpen, useSidepaneToggle } from './useSidepane';\n// @ts-ignore\nimport { useSetAppDataByKey, useSetNoiseCancellation } from './useUISettings';\nimport {\n  APP_DATA,\n  CHAT_SELECTOR,\n  POLL_STATE,\n  SIDE_PANE_OPTIONS,\n  UI_MODE_GRID,\n  UI_SETTINGS,\n} from '../../common/constants';\nimport { DEFAULT_TILES_IN_VIEW } from '../MoreSettings/constants';\n\nconst initialAppData = {\n  [APP_DATA.uiSettings]: {\n    [UI_SETTINGS.isAudioOnly]: false,\n    [UI_SETTINGS.maxTileCount]: 9,\n    [UI_SETTINGS.showStatsOnTiles]: false,\n    [UI_SETTINGS.enableAmbientMusic]: false,\n    [UI_SETTINGS.uiViewMode]: UI_MODE_GRID,\n    [UI_SETTINGS.mirrorLocalVideo]: true,\n    [UI_SETTINGS.layoutMode]: LayoutMode.GALLERY,\n  },\n  [APP_DATA.subscribedNotifications]: {\n    PEER_JOINED: false,\n    PEER_LEFT: false,\n    NEW_MESSAGE: true,\n    ERROR: true,\n    METADATA_UPDATED: true,\n  },\n  [APP_DATA.chatOpen]: false,\n  [APP_DATA.chatSelector]: {\n    [CHAT_SELECTOR.ROLE]: '',\n    [CHAT_SELECTOR.PEER]: {},\n  },\n  [APP_DATA.chatDraft]: '',\n  [APP_DATA.sidePane]: '',\n  [APP_DATA.sheet]: '',\n  [APP_DATA.hlsStarted]: false,\n  [APP_DATA.rtmpStarted]: false,\n  [APP_DATA.recordingStarted]: false,\n  [APP_DATA.dropdownList]: [],\n  [APP_DATA.authToken]: '',\n  [APP_DATA.minimiseInset]: false,\n  [APP_DATA.activeScreensharePeerId]: '',\n  [APP_DATA.disableNotifications]: false,\n  [APP_DATA.loadingEffects]: false,\n  [APP_DATA.background]: 'none',\n  [APP_DATA.pollState]: {\n    [POLL_STATE.pollInView]: '',\n    [POLL_STATE.view]: '',\n  },\n  // by default on because of on demand now, for beam disabled\n  [APP_DATA.caption]: false,\n  [APP_DATA.noiseCancellation]: false,\n};\n\nexport const AppData = React.memo(() => {\n  const hmsActions = useHMSActions();\n  const [preferences = {}] = useUserPreferences(UserPreferencesKeys.UI_SETTINGS);\n  const appData = useHMSStore(selectFullAppData);\n  const { elements } = useRoomLayoutConferencingScreen();\n  const toggleVB = useSidepaneToggle(SIDE_PANE_OPTIONS.VB);\n  const { isLocalVideoEnabled } = useAVToggle();\n  const sidepaneOpenedRef = useRef(false);\n  const [, setNoiseCancellationEnabled] = useSetNoiseCancellation();\n  const isMobile = useMedia(cssConfig.media.md);\n\n  useEffect(() => {\n    if (elements?.noise_cancellation?.enabled_by_default) {\n      setNoiseCancellationEnabled(true);\n    }\n  }, [elements?.noise_cancellation?.enabled_by_default, setNoiseCancellationEnabled]);\n\n  const defaultMediaURL = useMemo(() => {\n    const media = elements?.virtual_background?.background_media || [];\n    for (let i = 0; i < media.length; i++) {\n      if (media[i].default && media[i].url) {\n        return media[i].url;\n      }\n    }\n    return '';\n  }, [elements?.virtual_background?.background_media]);\n\n  useEffect(() => {\n    hmsActions.initAppData({\n      ...initialAppData,\n      ...appData,\n    });\n    // @ts-ignore\n    hmsActions.setFrameworkInfo({\n      type: 'react-web',\n      isPrebuilt: true,\n      version: React.version,\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [hmsActions]);\n\n  useEffect(() => {\n    const uiSettings = preferences || {};\n    const updatedSettings = {\n      ...uiSettings,\n      [UI_SETTINGS.isAudioOnly]: undefined,\n      [UI_SETTINGS.uiViewMode]: uiSettings.uiViewMode || UI_MODE_GRID,\n    };\n    hmsActions.setAppData(APP_DATA.uiSettings, updatedSettings, true);\n  }, [hmsActions, preferences]);\n\n  useEffect(() => {\n    hmsActions.setAppData(\n      APP_DATA.uiSettings,\n      {\n        [UI_SETTINGS.maxTileCount]: isMobile\n          ? DEFAULT_TILES_IN_VIEW.MWEB\n          : Number(elements?.video_tile_layout?.grid?.tiles_in_view) || DEFAULT_TILES_IN_VIEW.DESKTOP,\n      },\n      true,\n    );\n  }, [hmsActions, isMobile, elements?.video_tile_layout?.grid?.tiles_in_view]);\n\n  useEffect(() => {\n    if (!preferences.subscribedNotifications) {\n      return;\n    }\n    hmsActions.setAppData(APP_DATA.subscribedNotifications, preferences.subscribedNotifications, true);\n  }, [preferences.subscribedNotifications, hmsActions]);\n\n  useEffect(() => {\n    if (defaultMediaURL && !sidepaneOpenedRef.current && isLocalVideoEnabled) {\n      hmsActions.setAppData(APP_DATA.background, defaultMediaURL);\n      sidepaneOpenedRef.current = true;\n      toggleVB();\n    }\n  }, [hmsActions, toggleVB, isLocalVideoEnabled, defaultMediaURL]);\n\n  return <ResetStreamingStart />;\n});\n\n/**\n * reset hlsStarted, rtmpStarted values when streaming starts\n */\nconst ResetStreamingStart = () => {\n  const { isHLSRunning, isRTMPRunning, isBrowserRecordingOn } = useRecordingStreaming();\n  const hlsError = useHMSStore(selectHLSState).error;\n  const rtmpError = useHMSStore(selectRTMPState).error;\n  const roomState = useHMSStore(selectRoomState);\n  const [hlsStarted, setHLSStarted] = useSetAppDataByKey(APP_DATA.hlsStarted);\n  const [recordingStarted, setRecordingStarted] = useSetAppDataByKey(APP_DATA.recordingStarted);\n  const [rtmpStarted, setRTMPStarted] = useSetAppDataByKey(APP_DATA.rtmpStarted);\n  const toggleStreaming = useSidepaneToggle(SIDE_PANE_OPTIONS.STREAMING);\n  const isStreamingOpen = useIsSidepaneTypeOpen(SIDE_PANE_OPTIONS.STREAMING);\n\n  useEffect(() => {\n    if (isBrowserRecordingOn && recordingStarted) {\n      setRecordingStarted(false);\n    }\n  }, [isBrowserRecordingOn, recordingStarted, setRecordingStarted]);\n  /**\n   * Reset on leave\n   */\n  useEffect(() => {\n    if (roomState === HMSRoomState.Disconnected) {\n      setHLSStarted(false);\n      setRecordingStarted(false);\n      setRTMPStarted(false);\n    }\n  }, [roomState, setHLSStarted, setRTMPStarted, setRecordingStarted]);\n  useEffect(() => {\n    if (isHLSRunning || hlsError) {\n      if (hlsStarted) {\n        setHLSStarted(false);\n        if (isStreamingOpen) {\n          toggleStreaming();\n        }\n      }\n    }\n  }, [isHLSRunning, hlsStarted, setHLSStarted, hlsError, isStreamingOpen, toggleStreaming]);\n  useEffect(() => {\n    if (isRTMPRunning || rtmpError || isBrowserRecordingOn) {\n      if (rtmpStarted) {\n        setRTMPStarted(false);\n        if (isStreamingOpen) {\n          toggleStreaming();\n        }\n      }\n    }\n  }, [isRTMPRunning, setRTMPStarted, rtmpStarted, rtmpError, isBrowserRecordingOn, isStreamingOpen, toggleStreaming]);\n  return null;\n};\n", "import React, { useCallback } from 'react';\nimport { selectIsLocalScreenShared, selectIsLocalVideoEnabled, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { GalleryIcon, PersonRectangleIcon, SidebarIcon } from '@100mslive/react-icons';\nimport { Box, Flex, Slider, Text } from '../../..';\nimport SwitchWithLabel from './SwitchWithLabel';\n// @ts-ignore: No implicit Any\nimport { useSetUiSettings } from '../AppData/useUISettings';\nimport { settingOverflow } from './common';\nimport { UI_SETTINGS } from '../../common/constants';\n\nexport const LayoutMode = {\n  SIDEBAR: 'Sidebar',\n  GALLERY: 'Gallery',\n  SPOTLIGHT: 'Spotlight',\n};\n\nexport type LayoutModeKeys = keyof typeof LayoutMode;\n\nexport const LayoutModeIconMapping = {\n  [LayoutMode.GALLERY]: <GalleryIcon />,\n  [LayoutMode.SIDEBAR]: <SidebarIcon />,\n  [LayoutMode.SPOTLIGHT]: <PersonRectangleIcon />,\n};\n\nexport const LayoutSettings = () => {\n  const hmsActions = useHMSActions();\n  const isLocalVideoEnabled = useHMSStore(selectIsLocalVideoEnabled);\n  const isLocalScreenShared = useHMSStore(selectIsLocalScreenShared);\n  const [{ isAudioOnly, maxTileCount, mirrorLocalVideo }, setUISettings] = useSetUiSettings();\n  const toggleIsAudioOnly = useCallback(\n    async (isAudioOnlyModeOn?: boolean) => {\n      if (isAudioOnlyModeOn) {\n        // turn off video and screen share if user switches to audio only mode\n        isLocalVideoEnabled && (await hmsActions.setLocalVideoEnabled(false));\n        isLocalScreenShared && (await hmsActions.setScreenShareEnabled(false));\n      }\n      setUISettings({ [UI_SETTINGS.isAudioOnly]: isAudioOnlyModeOn });\n    },\n    [hmsActions, isLocalVideoEnabled, isLocalScreenShared, setUISettings],\n  );\n\n  return (\n    <Box className={settingOverflow()}>\n      <Flex align=\"center\" css={{ w: '100%', my: '$2', py: '$8', '@md': { display: 'none' } }}>\n        <Text variant=\"md\" css={{ fontWeight: '$semiBold' }}>\n          Tiles In View({maxTileCount})\n        </Text>\n        <Flex justify=\"end\" css={{ flex: '1 1 0' }}>\n          <Slider\n            step={1}\n            value={[maxTileCount]}\n            min={1}\n            max={49}\n            onValueChange={e => {\n              setUISettings({ [UI_SETTINGS.maxTileCount]: e[0] });\n            }}\n            css={{ w: '70%' }}\n          />\n        </Flex>\n      </Flex>\n      <SwitchWithLabel label=\"Audio Only Mode\" id=\"audioOnlyMode\" checked={isAudioOnly} onChange={toggleIsAudioOnly} />\n      <SwitchWithLabel\n        label=\"Mirror Local Video\"\n        id=\"mirrorMode\"\n        checked={mirrorLocalVideo}\n        onChange={value => {\n          setUISettings({\n            [UI_SETTINGS.mirrorLocalVideo]: value,\n          });\n        }}\n      />\n    </Box>\n  );\n};\n", "import React from 'react';\nimport { Label } from '../../../Label';\nimport { Flex } from '../../../Layout';\nimport { Switch } from '../../../Switch';\n\nconst SwitchWithLabel = ({\n  label,\n  icon,\n  id,\n  onChange,\n  checked,\n  hide = false,\n}: {\n  label: string;\n  icon?: React.ReactNode;\n  id: string;\n  onChange: (value: boolean) => void;\n  checked: boolean;\n  hide?: boolean;\n}) => {\n  return (\n    <Flex\n      align=\"center\"\n      css={{\n        my: '$2',\n        py: '$8',\n        w: '100%',\n        borderBottom: '1px solid $border_default',\n        display: hide ? 'none' : 'flex',\n      }}\n    >\n      <Label\n        htmlFor={id}\n        css={{\n          fontSize: '$md',\n          fontWeight: '$semiBold',\n          color: checked ? '$on_surface_high' : '$on_surface_low',\n          cursor: 'pointer',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '$8',\n          flex: '1 1 0',\n        }}\n      >\n        {icon}\n        {label}\n      </Label>\n      <Switch id={id} checked={checked} onCheckedChange={onChange} />\n    </Flex>\n  );\n};\n\nexport default SwitchWithLabel;\n", "import { useCallback, useMemo } from 'react';\nimport {\n  selectAppData,\n  selectAppDataByPath,\n  selectAudioTrackByPeerID,\n  selectPermissions,\n  selectPolls,\n  selectSessionStore,\n  selectTrackByID,\n  selectVideoTrackByPeerID,\n  useHMSActions,\n  useHMSStore,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\nimport { UserPreferencesKeys, useUserPreferences } from '../hooks/useUserPreferences';\nimport { APP_DATA, POLL_STATE, SESSION_STORE_KEY, UI_SETTINGS } from '../../common/constants';\n\n/**\n * fields saved related to UI settings in store's app data can be\n * accessed using this hook. key is optional if not passed\n * the whole UI settings object is returned. Usage -\n * 1. val = useUiSettings(\"isAudioOnly\");\n *    console.log(val); // false\n * 2. val = useUISettings();\n *    console.log(val); // {isAudioOnly: false}\n * @param {string | undefined} uiSettingKey\n */\nexport const useUISettings = uiSettingKey => {\n  const uiSettings = useHMSStore(selectAppDataByPath(APP_DATA.uiSettings, uiSettingKey));\n  return uiSettings;\n};\n\n/**\n * fields saved related to UI settings in store's app data can be\n * accessed using this hook. key is optional if not passed\n * the whole UI settings object is returned. Usage -\n * [val, setVal] = useUiSettings(\"isAudioOnly\");\n * console.log(val); // false\n * setVal(true);\n * @param {string} uiSettingKey\n */\nexport const useSetUiSettings = uiSettingKey => {\n  const value = useUISettings(uiSettingKey);\n  const setValue = useSetAppData({\n    key1: APP_DATA.uiSettings,\n    key2: uiSettingKey,\n  });\n  return [value, setValue];\n};\n\nexport const useIsHLSStartedFromUI = () => {\n  return useHMSStore(selectAppData(APP_DATA.hlsStarted));\n};\n\nexport const useIsRTMPStartedFromUI = () => {\n  return useHMSStore(selectAppData(APP_DATA.rtmpStarted));\n};\n\nexport const useAuthToken = () => {\n  return useHMSStore(selectAppData(APP_DATA.authToken));\n};\n\nexport const useUrlToEmbed = () => {\n  return useHMSStore(selectAppData(APP_DATA.embedConfig))?.url;\n};\n\nexport const usePDFConfig = () => {\n  return useHMSStore(selectAppData(APP_DATA.pdfConfig));\n};\n\nexport const useResetPDFConfig = () => {\n  const [, setPDFConfig] = useSetAppDataByKey(APP_DATA.pdfConfig);\n  return useCallback(() => setPDFConfig(), [setPDFConfig]);\n};\n\nexport const useResetEmbedConfig = () => {\n  const [, setEmbedConfig] = useSetAppDataByKey(APP_DATA.embedConfig);\n  return () => setEmbedConfig();\n};\nexport const usePinnedTrack = () => {\n  const pinnedTrackId = useHMSStore(selectAppData(APP_DATA.pinnedTrackId));\n  const spotlightPeerId = useHMSStore(selectSessionStore(SESSION_STORE_KEY.SPOTLIGHT));\n  const spotlightVideoTrackId = useHMSStore(selectVideoTrackByPeerID(spotlightPeerId))?.id;\n  const spotlightAudioTrackId = useHMSStore(selectAudioTrackByPeerID(spotlightPeerId))?.id;\n  return useHMSStore(selectTrackByID(pinnedTrackId || spotlightVideoTrackId || spotlightAudioTrackId));\n};\n\nexport const useSubscribedNotifications = notificationKey => {\n  const notificationPreference = useHMSStore(selectAppDataByPath(APP_DATA.subscribedNotifications, notificationKey));\n  return notificationPreference;\n};\n\nexport const useIsNotificationDisabled = () => {\n  const notificationPreference = useHMSStore(selectAppDataByPath(APP_DATA.disableNotifications));\n  return notificationPreference;\n};\n\nexport const useSetSubscribedNotifications = notificationKey => {\n  const value = useSubscribedNotifications(notificationKey);\n  const setValue = useSetAppData({\n    key1: APP_DATA.subscribedNotifications,\n    key2: notificationKey,\n  });\n  return [value, setValue];\n};\n\nexport const useIsCaptionEnabled = () => {\n  const isCaptionEnabled = useHMSStore(selectAppDataByPath(APP_DATA.caption));\n  return isCaptionEnabled;\n};\n\nexport const useSetIsCaptionEnabled = () => {\n  const [value, setValue] = useSetAppDataByKey(APP_DATA.caption);\n  return [value, setValue];\n};\n\nexport const useSubscribeChatSelector = chatSelectorKey => {\n  const chatSelectorPreference = useHMSStore(selectAppDataByPath(APP_DATA.chatSelector, chatSelectorKey));\n  return chatSelectorPreference;\n};\n\nexport const useSetSubscribedChatSelector = chatSelectorKey => {\n  const value = useSubscribeChatSelector(chatSelectorKey);\n  const setValue = useSetAppData({\n    key1: APP_DATA.chatSelector,\n    key2: chatSelectorKey,\n  });\n  return [value, setValue];\n};\n\nexport const useSetAppDataByKey = appDataKey => {\n  const value = useHMSStore(selectAppData(appDataKey));\n  const actions = useHMSActions();\n  const setValue = useCallback(\n    value => {\n      actions.setAppData(appDataKey, value);\n    },\n    [actions, appDataKey],\n  );\n  return [value, setValue];\n};\n\nconst useSetAppData = ({ key1, key2 }) => {\n  const actions = useHMSActions();\n  const store = useHMSVanillaStore();\n  const [, setPreferences] = useUserPreferences(UserPreferencesKeys.UI_SETTINGS);\n  const setValue = useCallback(\n    value => {\n      if (!key1) {\n        return;\n      }\n      actions.setAppData(\n        key1,\n        key2\n          ? {\n              [key2]: value,\n            }\n          : value,\n        true,\n      );\n      const appData = store.getState(selectAppData());\n      setPreferences({\n        ...appData.uiSettings,\n        [UI_SETTINGS.isAudioOnly]: undefined,\n        subscribedNotifications: appData.subscribedNotifications,\n      });\n    },\n    [actions, key1, key2, store, setPreferences],\n  );\n  return setValue;\n};\n\nexport const useShowPolls = () => {\n  const permissions = useHMSStore(selectPermissions);\n  const polls = useHMSStore(selectPolls);\n\n  const showPolls = useMemo(() => {\n    return permissions?.pollWrite || (permissions?.pollRead && polls?.length > 0);\n  }, [permissions?.pollRead, permissions?.pollWrite, polls?.length]);\n\n  return { showPolls };\n};\n\nexport const usePollViewState = () => {\n  const [pollState, setPollState] = useSetAppDataByKey(APP_DATA.pollState);\n\n  const setPollView = useCallback(\n    view => {\n      setPollState({\n        [POLL_STATE.pollInView]: pollState?.pollInView,\n        [POLL_STATE.view]: view,\n      });\n    },\n    [pollState?.pollInView, setPollState],\n  );\n\n  return {\n    setPollState,\n    setPollView,\n    pollInView: pollState?.pollInView,\n    view: pollState?.view,\n  };\n};\n\nexport const useIsNoiseCancellationEnabled = () => {\n  const isNoiseCancellationEnabled = useHMSStore(selectAppDataByPath(APP_DATA.noiseCancellation));\n  return isNoiseCancellationEnabled;\n};\nexport const useSetNoiseCancellation = () => {\n  const [isNoiseCancellationEnabled, setNoiseCancellationEnabled] = useSetAppDataByKey(APP_DATA.noiseCancellation);\n  return [isNoiseCancellationEnabled, setNoiseCancellationEnabled];\n};\n", "import { useState } from 'react';\nimport { useLocalStorage } from 'react-use';\n\nexport const UserPreferencesKeys = {\n  PREVIEW: 'preview',\n  NOTIFICATIONS: 'notifications',\n  UI_SETTINGS: 'uiSettings',\n  RTMP_URLS: 'rtmpUrls',\n  USER_ID: 'userId',\n};\n\nexport const defaultPreviewPreference = {\n  name: '',\n  isAudioMuted: false,\n  isVideoMuted: false,\n};\n\nexport const useUserPreferences = (key, defaultPreference) => {\n  const [localStorageValue, setStorageValue] = useLocalStorage(key, defaultPreference);\n  const [preference, setPreference] = useState(localStorageValue || defaultPreference);\n  const changePreference = value => {\n    setPreference(value);\n    setStorageValue(value);\n  };\n  return [preference, changePreference];\n};\n", "import { css } from '../../..';\n\nexport const settingOverflow = css({\n  flex: '1 1 0',\n  pr: '$12',\n  mr: '-$12',\n  overflowY: 'auto',\n});\n\nexport const settingContent = css({\n  display: 'flex',\n  flexDirection: 'column',\n  '&[hidden]': {\n    display: 'none',\n  },\n});\n", "import { useMemo } from 'react';\nimport {\n  ConferencingScreen,\n  DefaultConferencingScreen_Elements,\n  DefaultPreviewScreen_Elements,\n  HLSLiveStreamingScreen_Elements,\n  LeaveScreen,\n  PreviewScreen,\n  Screens,\n} from '@100mslive/types-prebuilt';\nimport {\n  selectHLSState,\n  selectPeerCount,\n  selectRoomStartTime,\n  useHMSStore,\n  useRecordingStreaming,\n} from '@100mslive/react-sdk';\nimport { useRoomLayout } from '..';\n// @ts-ignore\nimport { getFormattedCount } from '../../../common/utils';\n\nexport type useRoomLayoutScreenProps = {\n  screen: keyof Screens;\n};\n\ntype useRoomLayoutScreenReturnType<T extends useRoomLayoutScreenProps> = T['screen'] extends 'conferencing'\n  ? ConferencingScreen\n  : T['screen'] extends 'leave'\n  ? LeaveScreen\n  : T['screen'] extends 'preview'\n  ? PreviewScreen\n  : undefined;\n\nfunction useRoomLayoutScreen<T extends useRoomLayoutScreenProps>({\n  screen,\n}: T): useRoomLayoutScreenReturnType<T> | undefined {\n  const roomLayout = useRoomLayout();\n  const screenProps = roomLayout?.screens?.[screen] as useRoomLayoutScreenReturnType<T> | undefined;\n  return screenProps;\n}\n\ntype PreviewKeys = Omit<PreviewScreen, 'skip_preview_screen'>;\n\nexport function useRoomLayoutPreviewScreen() {\n  const screenProps = useRoomLayoutScreen({ screen: 'preview' });\n  const isPreviewScreenEnabled = !!screenProps && !screenProps?.skip_preview_screen;\n  let elements: DefaultPreviewScreen_Elements | undefined;\n  let screenType: keyof PreviewKeys | undefined;\n  if (isPreviewScreenEnabled) {\n    screenType = Object.keys(screenProps).filter(key => key !== 'skip_preview_screen')[0] as keyof PreviewKeys;\n    elements = screenProps[screenType]?.elements;\n  }\n  return {\n    isPreviewScreenEnabled,\n    elements,\n    screenType,\n  };\n}\n\nexport type ConferencingScreenElements = DefaultConferencingScreen_Elements & HLSLiveStreamingScreen_Elements;\n\nexport function useRoomLayoutConferencingScreen() {\n  const screenProps = useRoomLayoutScreen({ screen: 'conferencing' }) || {};\n  const screenType = Object.keys(screenProps)[0] as keyof ConferencingScreen;\n  const elements = screenProps[screenType]?.elements as ConferencingScreenElements;\n  // @ts-ignore\n  const hideSections: string[] = screenProps[screenType]?.hideSections || [];\n  return {\n    hideSections,\n    elements,\n    screenType,\n  };\n}\n\nexport function useRoomLayoutLeaveScreen() {\n  const screenProps = useRoomLayoutScreen({ screen: 'leave' });\n  const isLeaveScreenEnabled = !!screenProps;\n  return {\n    isLeaveScreenEnabled,\n    feedback: screenProps?.default?.elements?.feedback,\n  };\n}\n\nexport function useRoomLayoutHeader() {\n  const { elements } = useRoomLayoutConferencingScreen();\n  // return elements.header;\n  const { isRecordingOn } = useRecordingStreaming();\n  const peerCount = useHMSStore(selectPeerCount);\n  const sessionStartedAt = useHMSStore(selectRoomStartTime);\n  const hlsState = useHMSStore(selectHLSState);\n\n  // People watching, start timestamp, recording status\n  const details = useMemo(() => {\n    const details = [];\n    if (hlsState?.variants[0]?.['startedAt']) {\n      details.push(`${getFormattedCount(peerCount)} watching`);\n      details.push(hlsState.variants[0]['startedAt']);\n    } else if (sessionStartedAt) {\n      details.push(sessionStartedAt);\n    }\n    if (isRecordingOn) {\n      details.push('Recording');\n    }\n    return details;\n  }, [hlsState?.variants, isRecordingOn, peerCount, sessionStartedAt]);\n\n  return {\n    title: elements.header?.title || '',\n    description: elements.header?.description || '',\n    details,\n  };\n}\n", "import React from 'react';\nimport type { Layout } from '@100mslive/types-prebuilt';\nimport { isArray, mergeWith } from 'lodash';\n// @ts-ignore: fix types\nimport { useAuthToken } from '../../components/AppData/useUISettings';\nimport { useFetchRoomLayout, useFetchRoomLayoutResponse } from './hooks/useFetchRoomLayout';\n\nexport type RoomLayoutProviderProps = {\n  roomLayoutEndpoint?: string;\n  overrideLayout?: Partial<Layout>;\n};\n\nexport const RoomLayoutContext = React.createContext<\n  | {\n      layout: Layout | undefined;\n      updateRoomLayoutForRole: useFetchRoomLayoutResponse['updateRoomLayoutForRole'] | undefined;\n      setOriginalLayout: useFetchRoomLayoutResponse['setOriginalLayout'] | undefined;\n    }\n  | undefined\n>(undefined);\n\n// The default merge in lodash merges the values of current layout and the changes.\n// This behaviour makes changes in array based values inconsistent since a union happens.\n// The customizer uses the new value provided if one of the values is an array\nfunction customizer(objValue: unknown, srcValue: unknown) {\n  if (isArray(objValue) || isArray(srcValue)) {\n    return srcValue;\n  }\n  // default merge behaviour is followed\n  return undefined;\n}\n\nexport const RoomLayoutProvider: React.FC<React.PropsWithChildren<RoomLayoutProviderProps>> = ({\n  children,\n  roomLayoutEndpoint,\n  overrideLayout,\n}) => {\n  const authToken: string = useAuthToken();\n  const { layout, updateRoomLayoutForRole, setOriginalLayout } = useFetchRoomLayout({\n    authToken,\n    endpoint: roomLayoutEndpoint,\n  });\n  const mergedLayout = authToken && layout ? mergeWith(layout, overrideLayout, customizer) : layout;\n  return (\n    <RoomLayoutContext.Provider value={{ layout: mergedLayout, updateRoomLayoutForRole, setOriginalLayout }}>\n      {children}\n    </RoomLayoutContext.Provider>\n  );\n};\n\nexport const useRoomLayout = () => React.useContext(RoomLayoutContext)?.layout;\nexport const useUpdateRoomLayout = () => React.useContext(RoomLayoutContext)?.updateRoomLayoutForRole;\nexport const useSetOriginalLayout = () => React.useContext(RoomLayoutContext)?.setOriginalLayout;\n", "import { useCallback, useEffect, useRef, useState } from 'react';\nimport type { GetResponse, Layout } from '@100mslive/types-prebuilt';\nimport { defaultLayout } from '../constants';\n\n// TODO: remove this usage\nconst fetchWithRetry = async (url = '', options = {}) => {\n  const MAX_RETRIES = 4;\n  let error = Error('something went wrong');\n  for (let i = 0; i < MAX_RETRIES; i++) {\n    try {\n      return await fetch(url, options);\n    } catch (err) {\n      error = err as Error;\n    }\n  }\n  console.error('Fetch failed after max retries', { url, options });\n  throw error;\n};\n\n// this should take endpoint and return\nexport type useFetchRoomLayoutProps = {\n  endpoint?: string;\n  authToken: string;\n};\n\nexport type useFetchRoomLayoutResponse = {\n  layout: Layout | undefined;\n  updateRoomLayoutForRole: (role: string) => void;\n  setOriginalLayout: () => void;\n};\n\nexport const useFetchRoomLayout = ({\n  endpoint = '',\n  authToken = '',\n}: useFetchRoomLayoutProps): useFetchRoomLayoutResponse => {\n  const [layout, setLayout] = useState<Layout | undefined>(undefined);\n  const layoutResp = useRef<GetResponse>();\n  const originalLayout = useRef<Layout>();\n  const isFetchInProgress = useRef(false);\n\n  const setOriginalLayout = useCallback(() => setLayout(originalLayout.current), []);\n\n  const updateRoomLayoutForRole = useCallback((role: string) => {\n    if (!layoutResp.current) {\n      return;\n    }\n    const [layout] = (layoutResp.current?.data || []).filter(layout => layout.role === role);\n    if (layout) {\n      setLayout(layout);\n    }\n  }, []);\n  useEffect(() => {\n    (async () => {\n      if (isFetchInProgress.current || !authToken) {\n        return;\n      }\n      isFetchInProgress.current = true;\n      try {\n        const resp = await fetchWithRetry(endpoint || 'https://api.100ms.live/v2/layouts/ui', {\n          headers: {\n            Authorization: `Bearer ${authToken}`,\n          },\n        });\n        layoutResp.current = await resp.json();\n      } catch (e) {\n        console.error('[Room Layout API]: Failed to fetch / process room layout. Resorting to default layout.', e);\n        layoutResp.current = {\n          data: [defaultLayout],\n        };\n      }\n      let layoutForRole = layoutResp.current?.data?.[0];\n      if (!layoutForRole) {\n        console.error(\n          '[Room Layout API]: Unable to figure out room layout from API response. Resorting to default layout.',\n        );\n        layoutForRole = defaultLayout;\n      }\n      const layout = layoutForRole;\n      if (!originalLayout.current) {\n        originalLayout.current = layout;\n      }\n      setLayout(layout);\n      isFetchInProgress.current = false;\n    })();\n  }, [authToken, endpoint]);\n\n  return { layout, updateRoomLayoutForRole, setOriginalLayout };\n};\n", "import type { Layout } from '@100mslive/types-prebuilt';\nimport { JoinForm_JoinBtnType } from '@100mslive/types-prebuilt/elements/join_form';\n\nexport const defaultLayout: Layout = {\n  id: '',\n  role_id: '',\n  template_id: '',\n  app_id: '',\n  typography: {\n    font_family: 'Inter',\n  },\n  themes: [],\n  options: {},\n  screens: {\n    preview: {\n      default: {\n        elements: {\n          preview_header: {\n            title: 'Get Started',\n            sub_title: 'Setup your audio and video before joining',\n          },\n          join_form: {\n            join_btn_type: JoinForm_JoinBtnType.JOIN_BTN_TYPE_JOIN_ONLY,\n            join_btn_label: 'Join Now',\n            go_live_btn_label: 'Go Live',\n          },\n        },\n      },\n    },\n    conferencing: {\n      default: {\n        elements: {\n          chat: {\n            public_chat_enabled: true,\n            private_chat_enabled: true,\n            chat_title: 'Chat',\n            allow_pinning_messages: true,\n            message_placeholder: 'Send a message...',\n            roles_whitelist: [],\n            real_time_controls: {\n              can_disable_chat: true,\n              can_block_user: true,\n              can_hide_message: true,\n            },\n          },\n          participant_list: {},\n          video_tile_layout: {\n            grid: {\n              enable_local_tile_inset: true,\n              prominent_roles: [],\n              enable_spotlighting_peer: true,\n            },\n          },\n          emoji_reactions: {},\n        },\n      },\n    },\n    leave: {},\n  },\n};\n", "import { QUESTION_TYPE } from './constants';\n\n// eslint-disable-next-line complexity\nexport function shadeColor(color, percent) {\n  let R = parseInt(color.substring(1, 3), 16);\n  let G = parseInt(color.substring(3, 5), 16);\n  let B = parseInt(color.substring(5, 7), 16);\n\n  R = Math.floor((R * (100 + percent)) / 100);\n  G = Math.floor((G * (100 + percent)) / 100);\n  B = Math.floor((B * (100 + percent)) / 100);\n\n  R = R < 255 ? R : 255;\n  G = G < 255 ? G : 255;\n  B = B < 255 ? B : 255;\n\n  const RR = R.toString(16).length === 1 ? `0${R.toString(16)}` : R.toString(16);\n  const GG = G.toString(16).length === 1 ? `0${G.toString(16)}` : G.toString(16);\n  const BB = B.toString(16).length === 1 ? `0${B.toString(16)}` : B.toString(16);\n\n  return `#${RR}${GG}${BB}`;\n}\n\n/**\n * TODO: this is currently an O(N**2) function, don't use with peer lists, it's currently\n * being used to find intersection between list of role names where the complexity shouldn't matter much.\n */\nexport const arrayIntersection = (a, b) => {\n  if (a === undefined || b === undefined) {\n    return [];\n  }\n  // ensure \"a\" is the bigger array\n  if (b.length > a.length) {\n    let t = b;\n    b = a;\n    a = t;\n  }\n  return a.filter(function (e) {\n    return b.indexOf(e) > -1;\n  });\n};\n\nexport const getMetadata = metadataString => {\n  try {\n    return !metadataString ? {} : JSON.parse(metadataString);\n  } catch (error) {\n    return {};\n  }\n};\n\nexport const metadataProps = function (peer) {\n  return {\n    isHandRaised: getMetadata(peer.metadata)?.isHandRaised,\n  };\n};\n\nexport const isScreenshareSupported = () => {\n  return typeof navigator.mediaDevices.getDisplayMedia !== 'undefined';\n};\n\nexport const metadataPayloadParser = payload => {\n  try {\n    const data = window.atob(payload);\n    const parsedData = JSON.parse(data);\n    return parsedData;\n  } catch (e) {\n    return { payload };\n  }\n};\n\n// For bottom action sheet, returns updated height based on drag\nexport const getUpdatedHeight = (e, MINIMUM_HEIGHT) => {\n  const heightToPercentage = 100 - ((e?.touches?.[0] || e).pageY / window.innerHeight) * 100;\n  // Snap to top if height > 80%, should be at least 40vh\n  const sheetHeightInVH = Math.max(MINIMUM_HEIGHT, heightToPercentage > 80 ? 100 : heightToPercentage);\n  return `${sheetHeightInVH}vh`;\n};\n\nexport const getFormattedCount = num => {\n  const formatter = new Intl.NumberFormat('en', { notation: 'compact', maximumFractionDigits: 2 });\n  const formattedNum = formatter.format(num);\n  return formattedNum;\n};\n\nexport const formatTime = timeInSeconds => {\n  timeInSeconds = Math.floor(timeInSeconds / 1000);\n  const hours = Math.floor(timeInSeconds / 3600);\n  const minutes = Math.floor((timeInSeconds % 3600) / 60);\n  const seconds = timeInSeconds % 60;\n  const hour = hours !== 0 ? `${hours < 10 ? '0' : ''}${hours}:` : '';\n  return `${hour}${minutes < 10 ? '0' : ''}${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;\n};\n\nconst compareArrays = (a, b) => {\n  if (a.length !== b.length) return false;\n  else {\n    // Comparing each element of your array\n    for (var i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n};\n\nexport const checkCorrectAnswer = (answer, localPeerResponse, type) => {\n  if (type === QUESTION_TYPE.SINGLE_CHOICE) {\n    return answer?.option === localPeerResponse?.option;\n  } else if (type === QUESTION_TYPE.MULTIPLE_CHOICE) {\n    return answer?.options && localPeerResponse?.options && compareArrays(answer?.options, localPeerResponse?.options);\n  }\n};\n\nexport const isValidTextInput = (text, minLength = 1, maxLength = 1024) => {\n  return text && text.length >= minLength && text.length <= maxLength;\n};\n\nexport const calculateAvatarAndAttribBoxSize = (calculatedWidth, calculatedHeight) => {\n  if (!calculatedWidth || !calculatedHeight) {\n    return [undefined, undefined];\n  }\n\n  let avatarSize = 'large';\n  if (calculatedWidth <= 150 || calculatedHeight <= 150) {\n    avatarSize = 'small';\n  } else if (calculatedWidth <= 300 || calculatedHeight <= 300) {\n    avatarSize = 'medium';\n  }\n\n  let attribBoxSize = 'medium';\n  if (calculatedWidth <= 180 || calculatedHeight <= 180) {\n    attribBoxSize = 'small';\n  }\n\n  return [avatarSize, attribBoxSize];\n};\n\nexport const isMobileUserAgent = /Mobi|Android|iPhone/i.test(navigator.userAgent);\n\nexport const getPeerResponses = (questions, peerid, userid) => {\n  return questions.map(question =>\n    question.responses?.filter(\n      response =>\n        response && (response.peer?.peerid === peerid || response.peer?.userid === userid) && !response.skipped,\n    ),\n  );\n};\n\nexport const getIndexToShow = responses => {\n  let lastAttemptedIndex = 0;\n\n  Object.keys(responses).forEach(key => {\n    const keyNum = parseInt(key);\n    if (keyNum > lastAttemptedIndex && responses[key]) {\n      lastAttemptedIndex = keyNum;\n    }\n  });\n\n  return lastAttemptedIndex + 1;\n};\n\nexport const getPeerParticipationSummary = (poll, localPeerID, localCustomerUserID) => {\n  let correctResponses = 0;\n  let score = 0;\n  const questions = poll.questions || [];\n  const peerResponses = getPeerResponses(questions, localPeerID, localCustomerUserID);\n  let totalResponses = peerResponses.length || 0;\n\n  peerResponses.forEach(peerResponse => {\n    if (!peerResponse?.[0]) {\n      return;\n    }\n    const isCorrect = checkCorrectAnswer(\n      questions[peerResponse[0].questionIndex - 1].answer,\n      peerResponse[0],\n      questions[peerResponse[0].questionIndex - 1].type,\n    );\n    if (isCorrect) {\n      score += questions[peerResponse[0].questionIndex - 1]?.weight || 0;\n      correctResponses++;\n    }\n  });\n  return { totalResponses, correctResponses, score };\n};\n", "import { useCallback } from 'react';\nimport { match, P } from 'ts-pattern';\nimport { selectAppData, useHMSActions, useHMSStore, useHMSVanillaStore } from '@100mslive/react-sdk';\nimport { usePollViewState } from './useUISettings';\nimport { APP_DATA, POLL_STATE, POLL_VIEWS, SIDE_PANE_OPTIONS } from '../../common/constants';\n\n/**\n * Gives a boolean value if the sidepaneType matches current sidepane value in store\n * @param {string} sidepaneType\n * @returns {boolean} - if the sidepaneType is passed returns boolean else the current value\n */\nexport const useIsSidepaneTypeOpen = sidepaneType => {\n  if (!sidepaneType) {\n    throw Error('Pass one of the side pane options');\n  }\n  return useHMSStore(selectAppData(APP_DATA.sidePane)) === sidepaneType;\n};\n\n/**\n * Gives the current value of sidepane in store\n * @returns {string} - if the sidepaneType is passed returns boolean else the current value\n */\nexport const useSidepaneState = () => {\n  const sidePane = useHMSStore(selectAppData(APP_DATA.sidePane));\n  return sidePane;\n};\n\n/**\n * Toggle the sidepane value between passed sidePaneType and '';\n * @param {string} sidepaneType\n */\nexport const useSidepaneToggle = sidepaneType => {\n  const hmsActions = useHMSActions();\n  const vanillaStore = useHMSVanillaStore();\n  const toggleSidepane = useCallback(() => {\n    const isOpen = vanillaStore.getState(selectAppData(APP_DATA.sidePane)) === sidepaneType;\n    hmsActions.setAppData(APP_DATA.sidePane, !isOpen ? sidepaneType : '');\n  }, [vanillaStore, hmsActions, sidepaneType]);\n  return toggleSidepane;\n};\n\nexport const usePollViewToggle = () => {\n  const hmsActions = useHMSActions();\n  const { view, setPollState } = usePollViewState();\n  const isOpen = useSidepaneState() === SIDE_PANE_OPTIONS.POLLS;\n\n  const togglePollView = useCallback(\n    id => {\n      match({ id, isOpen, view })\n        .with(\n          {\n            id: P.string,\n          },\n          () => {\n            setPollState({\n              [POLL_STATE.pollInView]: id,\n              [POLL_STATE.view]: POLL_VIEWS.VOTE,\n            });\n            hmsActions.setAppData(APP_DATA.sidePane, SIDE_PANE_OPTIONS.POLLS);\n          },\n        )\n        .with(\n          {\n            isOpen: true,\n            view: P.when(view => !!view),\n          },\n          () => {\n            setPollState({\n              [POLL_STATE.pollInView]: undefined,\n              [POLL_STATE.view]: null,\n            });\n            hmsActions.setAppData(APP_DATA.sidePane, '');\n          },\n        )\n        .otherwise(() => {\n          setPollState({\n            [POLL_STATE.pollInView]: undefined,\n            [POLL_STATE.view]: POLL_VIEWS.CREATE_POLL_QUIZ,\n          });\n          hmsActions.setAppData(APP_DATA.sidePane, SIDE_PANE_OPTIONS.POLLS);\n        });\n    },\n    [hmsActions, view, setPollState, isOpen],\n  );\n\n  return togglePollView;\n};\n\n/**\n * resets the sidepane value\n */\nexport const useSidepaneReset = () => {\n  const hmsActions = useHMSActions();\n  const resetSidepane = useCallback(() => {\n    hmsActions.setAppData(APP_DATA.sidePane, '');\n    hmsActions.setAppData(APP_DATA.pollInView, '');\n  }, [hmsActions]);\n  return resetSidepane;\n};\n", "export const trackSourceOptions = [\n  { label: 'All Track Sources', value: '' },\n  { label: 'regular', value: 'regular' },\n  { label: 'screen', value: 'screen' },\n  { label: 'audioplaylist', value: 'audioplaylist' },\n  { label: 'videoplaylist', value: 'videoplaylist' },\n];\nexport const trackTypeOptions = [\n  { label: 'All Track Types', value: '' },\n  { label: 'audio', value: 'audio' },\n  { label: 'video', value: 'video' },\n];\n\nexport const DEFAULT_TILES_IN_VIEW = { MWEB: 4, DESKTOP: 9 };\n", "import React, { useEffect, useRef, useState } from 'react';\nimport { useSessionStorage } from 'react-use';\nimport { match } from 'ts-pattern';\nimport { v4 as uuid } from 'uuid';\nimport { HMSException, useHMSActions } from '@100mslive/react-sdk';\nimport { Dialog } from '../../Modal';\nimport { Text } from '../../Text';\nimport { useHMSPrebuiltContext } from '../AppContext';\nimport { PrebuiltStates } from '../AppStateContext';\n// @ts-ignore: No implicit Any\nimport errorImage from '../images/transaction_error.svg';\n// @ts-ignore: No implicit Any\nimport { useSetAppDataByKey } from './AppData/useUISettings';\n// @ts-ignore: No implicit Any\nimport { UserPreferencesKeys } from './hooks/useUserPreferences';\nimport { APP_DATA } from '../common/constants';\n\n/**\n * query params exposed -\n * skip_preview=true => used by recording and streaming service, skips preview and directly joins\n *                      header and footer don't show up in this case\n * skip_preview_headful=true => used by automation testing to skip preview without impacting the UI\n * name=abc => gives the initial name for the peer joining\n * auth_token=123 => uses the passed in token to join instead of fetching from token endpoint\n * ui_mode=activespeaker => lands in active speaker mode after joining the room\n */\nconst AuthToken = React.memo<{\n  authTokenByRoomCodeEndpoint: string;\n  defaultAuthToken?: string;\n  activeState?: PrebuiltStates;\n}>(({ authTokenByRoomCodeEndpoint, defaultAuthToken, activeState }) => {\n  const hmsActions = useHMSActions();\n  const { roomCode, userId } = useHMSPrebuiltContext();\n  const [error, setError] = useState({ title: '', body: '' });\n  const authToken = defaultAuthToken;\n  const [tokenInAppData, setAuthTokenInAppData] = useSetAppDataByKey(APP_DATA.authToken);\n  const [savedUserId, setSavedUserId] = useSessionStorage<string>(UserPreferencesKeys.USER_ID);\n  const progressRef = useRef<boolean | null>(null);\n\n  useEffect(() => {\n    if (authToken) {\n      setAuthTokenInAppData(authToken);\n      return;\n    }\n\n    if (tokenInAppData || progressRef.current || activeState === PrebuiltStates.LEAVE) {\n      return;\n    }\n\n    if (!roomCode) {\n      console.error('room code not provided');\n      return;\n    }\n\n    let userIdForAuthToken = userId || savedUserId;\n    if (!userIdForAuthToken) {\n      userIdForAuthToken = uuid();\n      setSavedUserId(userIdForAuthToken);\n    }\n\n    progressRef.current = true;\n    hmsActions\n      .getAuthTokenByRoomCode({ roomCode, userId: userIdForAuthToken }, { endpoint: authTokenByRoomCodeEndpoint })\n      .then(token => setAuthTokenInAppData(token))\n      .catch(error => setError(convertError(error)))\n      .finally(() => {\n        progressRef.current = false;\n      });\n  }, [\n    hmsActions,\n    authToken,\n    authTokenByRoomCodeEndpoint,\n    setAuthTokenInAppData,\n    roomCode,\n    userId,\n    savedUserId,\n    tokenInAppData,\n    setSavedUserId,\n    activeState,\n  ]);\n\n  if (error.title) {\n    return (\n      <Dialog.Root open={true}>\n        <Dialog.Content\n          css={{\n            maxWidth: '$100',\n            boxSizing: 'border-box',\n            p: '$10 $12',\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n          }}\n        >\n          <img src={errorImage} height={80} width={80} alt=\"Token Error\" />\n          <Text variant=\"h4\" css={{ textAlign: 'center', mb: '$4', mt: '$10' }}>\n            {error.title}\n          </Text>\n          <Text css={{ c: '$on_surface_medium', textAlign: 'center' }}>{error.body}</Text>\n        </Dialog.Content>\n      </Dialog.Root>\n    );\n  }\n  return null;\n});\n\nconst convertError = (error: HMSException) => {\n  console.error('[error]', { error });\n  console.warn(\n    'If you think this is a mistake on our side, please reach out to us over Discord:',\n    'https://discord.com/invite/kGdmszyzq2',\n  );\n  return match([error.action, error.code])\n    .with(['GET_TOKEN', 403], () => ({\n      title: 'Psst! This room is currently inactive.',\n      body: 'Please feel free to join another open room for more conversations. Thanks for stopping by!',\n    }))\n\n    .with(['GET_TOKEN', 404], () => ({\n      title: 'Room code does not exist',\n      body: 'We could not find a room code corresponding to this link.',\n    }))\n    .with(['GET_TOKEN', 2003], () => ({\n      title: 'Endpoint is not reachable',\n      body: `Endpoint is not reachable. ${error.description}.`,\n    }))\n    .otherwise(() =>\n      // @ts-ignore\n      match(error.response?.status)\n        .with(404, () => ({\n          title: 'Room does not exist',\n          body: 'We could not find a room corresponding to this link.',\n        }))\n        .with(403, () => ({\n          title: 'Accessing room using this link format is disabled',\n          body: 'You can re-enable this from the developer section in Dashboard.',\n        }))\n        .otherwise(() => {\n          console.error('Token API Error', error);\n          return {\n            title: 'Error fetching token',\n            body: 'An error occurred while fetching the app token. Please look into logs for more details.',\n          };\n        }),\n    );\n};\n\nexport default AuthToken;\n", "import React, { useContext } from 'react';\n// @ts-ignore\nimport { DEFAULT_PORTAL_CONTAINER } from './common/constants';\n\ntype HMSPrebuiltContextType = {\n  roomCode: string;\n  userName?: string;\n  userId?: string;\n  containerSelector: string;\n  endpoints?: Record<string, string>;\n  onLeave?: () => void;\n  onJoin?: () => void;\n};\n\nexport const HMSPrebuiltContext = React.createContext<HMSPrebuiltContextType>({\n  roomCode: '',\n  userName: '',\n  userId: '',\n  containerSelector: DEFAULT_PORTAL_CONTAINER,\n  endpoints: {},\n  onLeave: undefined,\n  onJoin: undefined,\n});\n\nHMSPrebuiltContext.displayName = 'HMSPrebuiltContext';\n\nexport const useHMSPrebuiltContext = () => {\n  const context = useContext(HMSPrebuiltContext);\n  if (!context) {\n    throw Error('Make sure HMSPrebuiltContext.Provider is present at the top level of your application');\n  }\n  return context;\n};\n", "import React, { useContext, useEffect } from 'react';\nimport { usePreviousDistinct } from 'react-use';\nimport { match, P } from 'ts-pattern';\nimport { HMSRoomState, selectRoomState, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { VBHandler } from './components/VirtualBackground/VBHandler';\nimport { useRoomLayout, useSetOriginalLayout } from './provider/roomLayoutProvider';\nimport { useRedirectToLeave } from './components/hooks/useRedirectToLeave';\nimport {\n  useRoomLayoutLeaveScreen,\n  useRoomLayoutPreviewScreen,\n} from './provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { APP_DATA } from './common/constants';\n\nexport enum PrebuiltStates {\n  MEETING = 'meeting',\n  PREVIEW = 'preview',\n  LEAVE = 'leave',\n}\n\ntype AppStateContextType = {\n  rejoin: () => void;\n};\n\nexport const AppStateContext = React.createContext<AppStateContextType>({\n  rejoin: () => {\n    console.log('Rejoin');\n  },\n});\n\nAppStateContext.displayName = 'AppStateContext';\n\nexport const useHMSAppStateContext = () => {\n  const context = useContext(AppStateContext);\n  if (!context) {\n    throw Error('Make sure AppStateContext.Provider is present at the top level of your application');\n  }\n  return context;\n};\n\nexport const useAppStateManager = () => {\n  const roomLayout = useRoomLayout();\n  const setOriginalLayout = useSetOriginalLayout();\n  const [activeState, setActiveState] = React.useState<PrebuiltStates | undefined>();\n  const roomState = useHMSStore(selectRoomState);\n  const prevRoomState = usePreviousDistinct(roomState);\n  const hmsActions = useHMSActions();\n  const { isLeaveScreenEnabled } = useRoomLayoutLeaveScreen();\n  const { isPreviewScreenEnabled } = useRoomLayoutPreviewScreen();\n  const { redirectToLeave } = useRedirectToLeave();\n\n  const rejoin = () => {\n    setOriginalLayout?.();\n    hmsActions.setAppData(APP_DATA.authToken, '');\n    setActiveState(isPreviewScreenEnabled ? PrebuiltStates.PREVIEW : PrebuiltStates.MEETING);\n  };\n\n  useEffect(() => {\n    if (!roomLayout) {\n      return;\n    }\n    match([roomState, prevRoomState])\n      .with([HMSRoomState.Connected, P.any], () => setActiveState(PrebuiltStates.MEETING))\n      .with(\n        [HMSRoomState.Disconnecting, HMSRoomState.Connected],\n        [HMSRoomState.Disconnecting, HMSRoomState.Connecting],\n        [HMSRoomState.Disconnecting, HMSRoomState.Reconnecting],\n        [HMSRoomState.Disconnected, HMSRoomState.Connected],\n        [HMSRoomState.Disconnected, HMSRoomState.Connecting],\n        [HMSRoomState.Disconnected, HMSRoomState.Reconnecting],\n        () => {\n          setActiveState(prevState => {\n            return match({ isLeaveScreenEnabled, isPreviewScreenEnabled, prevState })\n              .when(\n                ({ isLeaveScreenEnabled, prevState }) => isLeaveScreenEnabled && prevState !== PrebuiltStates.LEAVE,\n                () => PrebuiltStates.LEAVE,\n              )\n              .with({ isPreviewScreenEnabled: true }, () => PrebuiltStates.PREVIEW)\n              .otherwise(() => PrebuiltStates.MEETING);\n          });\n          VBHandler.reset();\n          redirectToLeave(1000); // to clear toasts after 1 second\n        },\n      )\n      .with([HMSRoomState.Disconnected, P.nullish], () => {\n        setActiveState(isPreviewScreenEnabled ? PrebuiltStates.PREVIEW : PrebuiltStates.MEETING);\n      })\n      .otherwise(() => {\n        // do nothing\n      });\n  }, [roomLayout, roomState, isLeaveScreenEnabled, isPreviewScreenEnabled, prevRoomState, redirectToLeave]);\n  return { activeState, rejoin };\n};\n", "// Open issue with eslint-plugin-import https://github.com/import-js/eslint-plugin-import/issues/1810\n// eslint-disable-next-line\nimport { HMSVBPlugin, HMSVirtualBackgroundTypes } from '@100mslive/hms-virtual-background/hmsvbplugin';\nimport { parsedUserAgent } from '@100mslive/react-sdk';\nimport { isSafari } from '../../common/constants';\nexport class VBPlugin {\n  private hmsPlugin?: HMSVBPlugin;\n  private effectsPlugin?: any;\n\n  initialisePlugin = async (effectsSDKKey?: string, onInit?: () => void) => {\n    if (this.getVBObject()) {\n      return;\n    }\n    if (effectsSDKKey) {\n      try {\n        // eslint-disable-next-line\n        const effects = await import('@100mslive/hms-virtual-background/hmseffectsplugin');\n        this.effectsPlugin = new effects.HMSEffectsPlugin(effectsSDKKey, onInit);\n      } catch (error) {\n        console.error('Failed to initialise HMSEffectsPlugin:', error, 'Using HMSVBPlugin');\n        this.hmsPlugin = new HMSVBPlugin(HMSVirtualBackgroundTypes.NONE, HMSVirtualBackgroundTypes.NONE);\n      }\n    } else {\n      this.hmsPlugin = new HMSVBPlugin(HMSVirtualBackgroundTypes.NONE, HMSVirtualBackgroundTypes.NONE);\n    }\n  };\n\n  getBackground = () => {\n    if (this.effectsPlugin) {\n      return this.effectsPlugin?.getBackground();\n    } else {\n      const background = this.hmsPlugin?.getBackground();\n      // @ts-ignore\n      return background?.src || background;\n    }\n  };\n\n  getBlurAmount = () => {\n    if (this.effectsPlugin) {\n      return this.effectsPlugin.getBlurAmount();\n    } else {\n      // Treating HMS VB intensity as a fixed value\n      return this.hmsPlugin?.getBackground() === HMSVirtualBackgroundTypes.BLUR ? 1 : 0;\n    }\n  };\n\n  getVBObject = () => {\n    return this.effectsPlugin || this.hmsPlugin;\n  };\n\n  getName = () => {\n    return this.effectsPlugin ? this.effectsPlugin?.getName() : this.hmsPlugin?.getName();\n  };\n\n  setBlur = async (blurPower: number) => {\n    if (this.effectsPlugin) {\n      this.effectsPlugin?.setBlur(blurPower);\n    } else {\n      await this.hmsPlugin?.setBackground(HMSVirtualBackgroundTypes.BLUR, HMSVirtualBackgroundTypes.BLUR);\n    }\n  };\n\n  setBackground = async (mediaURL: string) => {\n    if (this.effectsPlugin) {\n      this.effectsPlugin?.setBackground(mediaURL);\n    } else {\n      const img = document.createElement('img');\n      let retries = 0;\n      const MAX_RETRIES = 3;\n      img.alt = 'VB';\n      img.src = mediaURL;\n      try {\n        await this.hmsPlugin?.setBackground(img, HMSVirtualBackgroundTypes.IMAGE);\n      } catch (e) {\n        console.error(e);\n        if (retries++ < MAX_RETRIES) {\n          await this.hmsPlugin?.setBackground(img, HMSVirtualBackgroundTypes.IMAGE);\n        }\n      }\n    }\n  };\n\n  setPreset = async (preset: 'quality' | 'balanced') => {\n    if (this.effectsPlugin) {\n      await this.effectsPlugin.setPreset(preset);\n    }\n  };\n\n  getPreset = () => {\n    return this.effectsPlugin?.getPreset() || '';\n  };\n\n  removeEffects = async () => {\n    if (this.effectsPlugin) {\n      this.effectsPlugin?.removeEffects();\n    } else {\n      await this.hmsPlugin?.setBackground(HMSVirtualBackgroundTypes.NONE, HMSVirtualBackgroundTypes.NONE);\n    }\n  };\n\n  reset = () => {\n    this.effectsPlugin = undefined;\n    this.hmsPlugin = undefined;\n  };\n\n  isEffectsSupported = () => {\n    if (!isSafari) {\n      return true;\n    }\n    const browserVersion = parsedUserAgent?.getBrowser()?.version || '16';\n    if (browserVersion && parseInt(browserVersion.split('.')[0]) < 17) {\n      return false;\n    }\n    return true;\n  };\n}\n\nexport const VBHandler = new VBPlugin();\n", "import { useCallback } from 'react';\nimport { useHMSPrebuiltContext } from '../../AppContext';\n// @ts-ignore: No implicit Any\nimport { PictureInPicture } from '../PIP/PIPManager';\n// @ts-ignore: No implicit Any\nimport { ToastManager } from '../Toast/ToastManager';\n\nexport const useRedirectToLeave = () => {\n  const { onLeave } = useHMSPrebuiltContext();\n\n  const redirect = useCallback(\n    (timeout = 0) => {\n      setTimeout(() => {\n        PictureInPicture.stop().catch(() => console.error('stopping pip'));\n        ToastManager.clearAllToast();\n        onLeave?.();\n      }, timeout);\n    },\n    [onLeave],\n  );\n\n  return { redirectToLeave: redirect };\n};\n", "import * as workerTimers from 'worker-timers';\nimport { HMSActions, HMSPeer, HMSTrack, HMSVideoTrack } from '@100mslive/react-sdk';\n// @ts-ignore: No implicit any\nimport { drawVideoElementsOnCanvas, dummyChangeInCanvas, resetPIPCanvasColors } from './pipUtils';\nimport { isIOS, isMacOS, isSafari } from '../../common/constants';\nconst MAX_NUMBER_OF_TILES_IN_PIP = 4;\nconst DEFAULT_FPS = 30;\nconst DEFAULT_CANVAS_WIDTH = 480;\nconst DEFAULT_CANVAS_HEIGHT = 320;\nconst LEAVE_EVENT_NAME = 'leavepictureinpicture';\n\nenum PIPStates {\n  starting = 'starting',\n  started = 'started',\n  stopping = 'stopping',\n  stopped = 'stopped',\n}\n\n/**\n * video elements are stitched together as a canvas which is converted to\n * another video element converted to PIP.\n * The task is split into two parts -\n * 1. a function which gets hit when the input changes and updates the tracks\n * to show\n * 2. an independent loop which updates the canvas periodically based on the current\n * tracks which should be shown.\n */\nclass PipManager {\n  private listeners = new Set<(value: boolean) => void>();\n  private canvas: HTMLCanvasElement | null = null;\n  private pipVideo: HTMLVideoElement | null = null;\n  private hmsActions: HMSActions | null = null;\n  private timeoutRef = 0;\n  private videoElements: HTMLVideoElement[] = [];\n  private onStateChange: ((value: boolean) => void) | null = null;\n  private tracksToShow: Array<string> = [];\n  private state: PIPStates = PIPStates.stopped;\n\n  constructor() {\n    this.reset();\n  }\n\n  listenToStateChange(cb: (value: boolean) => void) {\n    this.listeners.add(cb);\n  }\n\n  /**\n   * @private\n   */\n  reset() {\n    console.debug('resetting PIP state');\n    resetPIPCanvasColors();\n    this.canvas = null; // where stitching will take place\n    this.pipVideo = null; // the element which will be sent in PIP\n    this.timeoutRef = 0; // setTimeout reference so it can be cancelled\n    this.hmsActions = null; // for attaching detaching\n    this.videoElements = []; // for attaching tracks\n    this.tracksToShow = [];\n    this.onStateChange = null; // for user of this class to listen to changes\n    this.state = PIPStates.stopped;\n  }\n\n  /**\n   * check if PIP is supported in this browser env\n   */\n  isSupported() {\n    return !!document.pictureInPictureEnabled && !isIOS && !(isMacOS && isSafari);\n  }\n\n  /**\n   * check if pip is currently turned on\n   */\n  isOn() {\n    return !!document.pictureInPictureElement;\n  }\n\n  /**\n   * request browser to start pip and start the render loop updating the pip\n   * video element with peer tracks.\n   * @param hmsActions\n   * @param onStateChangeFn {function(bool):void} callback called to notify change in pip state\n   */\n  async start(hmsActions: HMSActions, onStateChangeFn: (value: boolean) => void): Promise<void> {\n    if (!this.isSupported()) {\n      throw new Error('pip is not supported on this browser');\n    }\n    console.debug('starting PIP, current state', this.state);\n    if (this.state === PIPStates.started) {\n      await this.stop(); // if anything is already running\n    } else if (this.state === PIPStates.starting) {\n      return; // ignore double clicks\n    }\n    this.state = PIPStates.starting;\n    try {\n      await this.init(hmsActions, onStateChangeFn);\n      // when user closes pip, call internal stop\n      this.pipVideo?.addEventListener(LEAVE_EVENT_NAME, this.stop);\n      this.renderLoop();\n      if (!this.isOn()) {\n        await this.requestPIP();\n      }\n      console.debug('pip started');\n      this.state = PIPStates.started;\n      this.onStateChange?.(true);\n      this.callListeners(true);\n    } catch (err) {\n      console.error('error in request pip', err);\n      this.state = PIPStates.stopped;\n    }\n  }\n\n  stop = async () => {\n    if (this.state === PIPStates.stopped) {\n      return;\n    }\n    this.state = PIPStates.stopping;\n    this.pipVideo?.removeEventListener(LEAVE_EVENT_NAME, this.stop);\n    if (this.timeoutRef) {\n      workerTimers.clearTimeout(this.timeoutRef);\n      this.timeoutRef = 0;\n    }\n    if (this.isOn()) {\n      this.exitPIP();\n    }\n    // detach all to avoid bandwidth consumption\n    await this.detachOldAttachNewTracks(this.tracksToShow, []);\n    this.onStateChange?.(false); // notify parent about this\n    this.callListeners(false);\n    this.reset(); // cleanup\n    this.state = PIPStates.stopped;\n  };\n\n  /**\n   * @param peers {Array} All Remote Peers present in call.\n   * @param tracksMap {Object} map of track id to track\n   * */\n  async updatePeersAndTracks(peers: HMSPeer[], tracksMap: Record<string, HMSTrack>) {\n    if (!this.canvas) {\n      console.log('no canvas to render video to');\n      return;\n    }\n    const newTracksToShowUnordered = this.pickTracksToShow(peers, tracksMap);\n    const currentTracksShowing = this.tracksToShow;\n    this.tracksToShow = this.orderNewTracksToShow(newTracksToShowUnordered, currentTracksShowing);\n    try {\n      await this.detachOldAttachNewTracks(currentTracksShowing, this.tracksToShow, tracksMap);\n    } catch (error) {\n      console.error('error in detaching/attaching tracks', error);\n    }\n  }\n\n  // ------- Private function --------------\n  /**\n   * @private {boolean} on - whether pip is on/off\n   */\n  callListeners = (on: boolean) => {\n    this.listeners.forEach(listener => listener?.(on));\n  };\n\n  /**\n   * @private\n   */\n  async init(hmsActions: HMSActions, onStateChangeFn: (value: boolean) => void) {\n    await this.initMediaElements();\n    this.hmsActions = hmsActions;\n    this.onStateChange = onStateChangeFn;\n  }\n\n  async initMediaElements() {\n    if (!this.canvas) {\n      const { canvas, pipVideo } = this.initializeCanvasAndVideoElement();\n      this.canvas = canvas; // where stitching will take place\n      this.pipVideo = pipVideo; // the element which will be sent in PIP\n      this.videoElements = this.initializeVideoElements(); // for attaching tracks\n      const videoPlayPromise = this.pipVideo.play();\n      dummyChangeInCanvas(this.canvas);\n      await videoPlayPromise;\n    }\n  }\n\n  initializeCanvasAndVideoElement() {\n    const canvas = document.createElement('canvas');\n    canvas.width = DEFAULT_CANVAS_WIDTH;\n    canvas.height = DEFAULT_CANVAS_HEIGHT;\n    const pipVideo = document.createElement('video');\n    pipVideo.width = DEFAULT_CANVAS_WIDTH;\n    pipVideo.height = DEFAULT_CANVAS_HEIGHT;\n    pipVideo.muted = true;\n    pipVideo.srcObject = canvas.captureStream();\n    return { canvas, pipVideo };\n  }\n\n  initializeVideoElements() {\n    const videoElements = [];\n    for (let i = 0; i < MAX_NUMBER_OF_TILES_IN_PIP; i++) {\n      const videoElement = document.createElement('video');\n      videoElement.autoplay = true;\n      videoElement.playsInline = true;\n      videoElements.push(videoElement);\n    }\n    return videoElements;\n  }\n\n  /**\n   * render loop is responsible for rendering the video elements on canvas/pip.\n   * in each loop current video elements are stitched and painted on canvas\n   */\n  renderLoop() {\n    const delay = 1000 / DEFAULT_FPS;\n    this.timeoutRef = workerTimers.setTimeout(() => {\n      if (this.state === PIPStates.stopping || this.state === PIPStates.stopped) {\n        return;\n      }\n      if (this.state === PIPStates.started) {\n        drawVideoElementsOnCanvas(this.videoElements, this.canvas);\n      }\n      this.renderLoop();\n    }, delay);\n  }\n\n  async requestPIP() {\n    try {\n      if (this.isOn()) {\n        this.exitPIP(); // is this really needed?\n      }\n      if (!this.pipVideo) {\n        return;\n      }\n      await this.pipVideo.requestPictureInPicture();\n    } catch (error) {\n      console.error('error in requestpip', error, 'state', this.state);\n      throw error;\n    }\n  }\n\n  exitPIP() {\n    document.exitPictureInPicture();\n  }\n\n  /**\n   * Logic - pick only enabled video tracks\n   * @param peers {Array<any>}\n   * @param tracksMap {Record<string, any>}\n   */\n  pickTracksToShow(peers: HMSPeer[], tracksMap: Record<string, HMSTrack>) {\n    const tracksToShow = new Set<string>();\n    for (const peer of peers) {\n      if (tracksToShow.size === MAX_NUMBER_OF_TILES_IN_PIP) {\n        break;\n      } else if (peer.videoTrack && this.showTrack(tracksMap[peer.videoTrack] as HMSVideoTrack)) {\n        tracksToShow.add(peer.videoTrack);\n      }\n    }\n    return Array.from(tracksToShow);\n  }\n\n  /**\n   * there has to be a smart reordering of new tracks based on currently showing\n   * ones to reduce unnecessary displacement. If someone was showing up both\n   * earlier and now, it's a better UX to keep their position same instead\n   * of letting it change.\n   * The returned array is a shuffled version of newTracks with position of\n   * tracks present in the old tracks intact.\n   * eg. old = [1,5,9,3], new = [3,8,2,9], result = [8,2,9,3]\n   * @param oldTracks {Array}\n   * @param newTracks {Array}\n   * @return {Array}\n   */\n  orderNewTracksToShow(newTracks: string[], oldTracks: string[]) {\n    const betterNewTracks: Array<string> = new Array(newTracks.length);\n    const leftOvers: Array<string> = [];\n    // put the common ones in right position\n    newTracks.forEach(track => {\n      const oldPosition = oldTracks.indexOf(track);\n      if (oldPosition !== -1 && oldPosition < newTracks.length) {\n        // if track is there currently and we can put it on the same position\n        betterNewTracks[oldPosition] = track;\n      } else {\n        leftOvers.push(track);\n      }\n    });\n    // put the left overs in remaining empty positions\n    for (let i = 0; i < newTracks.length; i++) {\n      if (!betterNewTracks[i]) {\n        const newEntry = leftOvers.shift();\n        if (newEntry) {\n          betterNewTracks[i] = newEntry;\n        }\n      }\n    }\n    return Array.from(new Set(betterNewTracks));\n  }\n\n  private showTrack(track: HMSVideoTrack | undefined) {\n    return track && track.enabled && !track.degraded;\n  }\n\n  /**\n   * call detach for tracks which no longer need to be shown and attach for\n   * new ones which are to be shown now.\n   * Note: oldTracks and newTracks are not necessarily of same length\n   * @param oldTracks {Array<String>}\n   * @param newTracks {Array<String>}\n   * @param tracksMap {Record<String, any>}\n   */\n  // eslint-disable-next-line complexity\n  async detachOldAttachNewTracks(\n    oldTracks: Array<string>,\n    newTracks: Array<string>,\n    tracksMap: Record<string, HMSTrack> | null = null,\n  ) {\n    const numTracks = Math.max(oldTracks.length, newTracks.length);\n    for (let i = 0; i < numTracks; i++) {\n      if (oldTracks[i] === newTracks[i]) {\n        continue; // it would already have been attached previously\n      } else if (oldTracks[i]) {\n        // old track is there but not equal to new track, detach\n        // no need to call detach if we know for sure track is no longer in store\n        if (!tracksMap || tracksMap[oldTracks[i]]) {\n          await this.hmsActions?.detachVideo(oldTracks[i], this.videoElements[i]);\n        }\n        if (this.videoElements[i]) {\n          // even if old track got removed from the room, element needs to be cleaned up\n          this.videoElements[i].srcObject = null;\n        }\n      }\n      if (newTracks[i]) {\n        await this.hmsActions?.attachVideo(newTracks[i], this.videoElements[i]);\n      }\n    }\n  }\n}\n\nexport const PictureInPicture = new PipManager();\n// PictureInPicture.initMediaElements().catch(console.error);  // for safari, init early\n", "let CANVAS_FILL_COLOR;\nlet CANVAS_STROKE_COLOR;\n\nfunction setPIPCanvasColors() {\n  if (!CANVAS_FILL_COLOR) {\n    CANVAS_FILL_COLOR = window\n      .getComputedStyle(document.documentElement)\n      .getPropertyValue('--hms-ui-colors-surface_bright');\n  }\n  if (!CANVAS_STROKE_COLOR) {\n    CANVAS_STROKE_COLOR = window\n      .getComputedStyle(document.documentElement)\n      .getPropertyValue('--hms-ui-colors-border_bright');\n  }\n}\n\nexport function resetPIPCanvasColors() {\n  CANVAS_FILL_COLOR = '';\n  CANVAS_STROKE_COLOR = '';\n}\n/**\n * no tile - blank canvas, black image\n * 1 tile - takes full space on canvas\n * 2 tile - stack two video adjacent to each other\n * 3 tile - two rows first row has two tile second row has one tile centered.\n * 4 tiles - two rows two columns - all equal size\n * All videos will respect their aspect ratios.\n */\nexport function drawVideoElementsOnCanvas(videoElements, canvas) {\n  let videoTiles = videoElements.filter(videoElement => videoElement.srcObject !== null);\n\n  const ctx = canvas.getContext('2d');\n  setPIPCanvasColors();\n  ctx.fillStyle = CANVAS_FILL_COLOR;\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n  if (videoTiles.length === 0) {\n    // no tile to render, render black image\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    return;\n  }\n\n  fillGridTiles(videoTiles.slice(0, 4), ctx, canvas);\n}\n\n// this is to send some data for stream and resolve video element's play for a\n// video element rendering this canvas' capture stream\nexport function dummyChangeInCanvas(canvas) {\n  const ctx = canvas.getContext('2d');\n  setPIPCanvasColors();\n  ctx.fillStyle = CANVAS_FILL_COLOR;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n}\n\n/**\n * Imagine the canvas as a grid with passed in number of rows and columns. Go\n * over the tiles in the grid in order while drawing the videoElements upon them.\n */\nfunction fillGridTiles(videoElements, ctx, canvas) {\n  const offset = 8;\n  canvas.width = 480;\n  canvas.height = 320;\n\n  ctx.fillStyle = CANVAS_FILL_COLOR;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  // Show borders only when there is atleast one video\n  if (videoElements.length > 0) {\n    ctx.strokeStyle = CANVAS_STROKE_COLOR;\n    ctx.lineWidth = offset / 2;\n    ctx.strokeRect(0, 0, canvas.width, canvas.height);\n  }\n\n  if (videoElements.length === 1) {\n    const video = videoElements[0];\n    const { width, height } = getRenderDimensions(video, canvas.width - offset, canvas.height - offset);\n    /**\n     * The x and y offset are to center the video tile horizontally and vertically\n     * width and height are the aspect ratio constrained video tile dimensions\n     */\n    const xOffset = (canvas.width - width) / 2;\n    const yOffset = (canvas.height - height) / 2;\n    ctx.drawImage(video, xOffset, yOffset, width, height);\n  }\n\n  if (videoElements.length === 2) {\n    videoElements.forEach((video, index) => {\n      const { width, height } = getRenderDimensions(\n        video,\n        canvas.width / 2 - offset, // This will be the max available width for each tile\n        canvas.height - offset,\n      );\n      /**\n       * (canvas.width / 2 - width) / 2 This is to center width wise within in the box\n       * (canvas.width / 2) * index This is the start offset\n       * for 1st element it is 0, for second it will be canvas.width/2 which starts from the center\n       */\n      const xOffset = (canvas.width / 2 - width) / 2 + (canvas.width / 2) * index;\n      /**\n       * (canvas.height - height) / 2 This is to center height wise\n       */\n      const yOffset = (canvas.height - height) / 2;\n\n      ctx.drawImage(video, xOffset, yOffset, width, height);\n    });\n    /**\n     * Draw a border between tiles\n     */\n    const path = new Path2D();\n    path.moveTo(canvas.width / 2, 0);\n    path.lineTo(canvas.width / 2, canvas.height);\n    ctx.stroke(path);\n  }\n\n  if (videoElements.length === 3) {\n    videoElements.forEach((video, index) => {\n      const { width, height } = getRenderDimensions(video, canvas.width / 2 - offset, canvas.height / 2 - offset);\n      /**\n       * for first two tiles, xOffset is similar to the 2 tiles calculation with only difference being the height. it is half now.\n       */\n      const xOffset =\n        index < 2 ? (canvas.width / 2 - width) / 2 + (canvas.width / 2) * index : canvas.width / 2 - width / 2;\n      const yOffset = (index < 2 ? 0 : canvas.height / 2) + (canvas.height / 2 - height) / 2;\n\n      ctx.drawImage(video, xOffset, yOffset, width, height);\n    });\n    /**\n     * Draw borders between tiles\n     */\n    const path = new Path2D();\n    path.moveTo(canvas.width / 2, 0);\n    path.lineTo(canvas.width / 2, canvas.height / 2);\n    ctx.stroke(path);\n    path.moveTo(0, canvas.height / 2);\n    path.lineTo(canvas.width, canvas.height / 2);\n    ctx.stroke(path);\n  }\n  if (videoElements.length === 4) {\n    videoElements.forEach((video, index) => {\n      const { width, height } = getRenderDimensions(video, canvas.width / 2 - offset, canvas.height / 2 - offset);\n      /**\n       * Similar to two tiles repeat after 2 tiles\n       * (canvas.width / 2 - width) / 2 is to center horizontally\n       */\n      const xOffset = (canvas.width / 2 - width) / 2 + (canvas.width / 2) * (index % 2);\n      /**\n       * Similar to two tiles with the yOffset being height/2 for the 3rd and 4th tiles\n       * (canvas.height / 2 - height) / 2 is to center vertically\n       */\n      const yOffset = (index < 2 ? 0 : canvas.height / 2) + (canvas.height / 2 - height) / 2;\n\n      ctx.drawImage(video, xOffset, yOffset, width, height);\n    });\n    /**\n     * Draw borders between tiles\n     */\n    const path = new Path2D();\n    path.moveTo(canvas.width / 2, 0);\n    path.lineTo(canvas.width / 2, canvas.height);\n    ctx.stroke(path);\n    path.moveTo(0, canvas.height / 2);\n    path.lineTo(canvas.width, canvas.height / 2);\n    ctx.stroke(path);\n  }\n}\n\n/**\n * Restrict the dimensions within the available dimension with aspect ratio\n * constraint applied\n * @param {HTMLVideoElement} video\n * @param {number} width\n * @param {number} height\n * @returns { width: number, height: number }\n */\nfunction getRenderDimensions(video, width, height) {\n  let finalWidth = (video.videoWidth / video.videoHeight) * height;\n  let finalHeight = height;\n\n  if (finalWidth > width) {\n    finalWidth = width;\n    finalHeight = (video.videoHeight / video.videoWidth) * width;\n  }\n  return { width: finalWidth, height: finalHeight };\n}\n", "import { v4 } from 'uuid';\n\nexport const ToastManager = {\n  toasts: new Map(),\n  listeners: new Map(),\n  addToast(toast) {\n    const id = toast.id ? toast.id : v4();\n    this.toasts.set(id, { ...toast, id });\n    this.onChange();\n    return id;\n  },\n\n  clearAllToast() {\n    this.toasts.clear();\n    this.onChange();\n  },\n\n  removeToast(id) {\n    this.toasts.delete(id);\n    this.onChange();\n  },\n  replaceToast(id, toast) {\n    if (this.isActive(id)) {\n      this.toasts.set(id, { ...this.toasts.get(id), ...toast });\n      this.onChange();\n      return id;\n    } else {\n      return this.addToast(toast);\n    }\n  },\n  addListener(cb) {\n    this.listeners.set(cb, cb);\n  },\n  removeListener(cb) {\n    this.listeners.delete(cb);\n  },\n  isActive(id) {\n    return this.toasts.has(id);\n  },\n  onChange() {\n    const toasts = Array.from(this.toasts.values());\n    this.listeners.forEach(listener => listener(toasts));\n  },\n};\n", "import React, { useEffect, useRef, useState } from 'react';\nimport { DefaultConferencingScreen_Elements } from '@100mslive/types-prebuilt';\nimport { v4 as uuid } from 'uuid';\nimport {\n  HMSRoomState,\n  selectAppData,\n  selectIsConnectedToRoom,\n  selectRoomState,\n  useAwayNotifications,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { Footer } from './Footer/Footer';\nimport { MoreSettings } from './MoreSettings/MoreSettings';\nimport { HLSFailureModal } from './Notifications/HLSFailureModal';\n// @ts-ignore: No implicit Any\nimport { ActivatedPIP } from './PIP/PIPComponent';\n// @ts-ignore: No implicit Any\nimport { PictureInPicture } from './PIP/PIPManager';\nimport { RoleChangeRequestModal } from './RoleChangeRequest/RoleChangeRequestModal';\nimport { Box, Flex } from '../../Layout';\nimport { useHMSPrebuiltContext } from '../AppContext';\nimport { VideoStreamingSection } from '../layouts/VideoStreamingSection';\n// @ts-ignore: No implicit Any\nimport { EmojiReaction } from './EmojiReaction';\nimport FullPageProgress from './FullPageProgress';\nimport { Header } from './Header';\nimport { PreviousRoleInMetadata } from './PreviousRoleInMetadata';\nimport { RaiseHand } from './RaiseHand';\nimport {\n  useRoomLayoutConferencingScreen,\n  useRoomLayoutPreviewScreen,\n} from '../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { useAuthToken, useSetAppDataByKey } from './AppData/useUISettings';\nimport { useLandscapeHLSStream, useMobileHLSStream } from '../common/hooks';\nimport { APP_DATA, isAndroid, isIOS, isIPadOS } from '../common/constants';\n\nexport const ConferenceScreen = () => {\n  const { userName, endpoints, onJoin: onJoinFunc } = useHMSPrebuiltContext();\n  const screenProps = useRoomLayoutConferencingScreen();\n  const { isPreviewScreenEnabled } = useRoomLayoutPreviewScreen();\n  const roomState = useHMSStore(selectRoomState);\n  const isConnectedToRoom = useHMSStore(selectIsConnectedToRoom);\n  const hmsActions = useHMSActions();\n  const [hideControls, setHideControls] = useState(false);\n  const dropdownList = useHMSStore(selectAppData(APP_DATA.dropdownList));\n  const authTokenInAppData = useAuthToken();\n  const headerRef = useRef<HTMLDivElement | null>(null);\n  const footerRef = useRef<HTMLDivElement | null>(null);\n  const isMobileDevice = isAndroid || isIOS || isIPadOS;\n  const dropdownListRef = useRef<string[]>();\n  const [isHLSStarted] = useSetAppDataByKey(APP_DATA.hlsStarted);\n  const { requestPermission } = useAwayNotifications();\n\n  // using it in hls stream to show action button when chat is disabled\n  const showChat = !!screenProps.elements?.chat;\n  const autoRoomJoined = useRef(isPreviewScreenEnabled);\n  const isMobileHLSStream = useMobileHLSStream();\n  const isLandscapeHLSStream = useLandscapeHLSStream();\n  const isMwebHLSStream = isMobileHLSStream || isLandscapeHLSStream;\n\n  const toggleControls = () => {\n    if (dropdownListRef.current?.length === 0 && isMobileDevice && !isMwebHLSStream) {\n      setHideControls(value => !value);\n    }\n  };\n\n  useEffect(() => {\n    let timeout: undefined | ReturnType<typeof setTimeout>;\n    dropdownListRef.current = dropdownList || [];\n    if (dropdownListRef.current && dropdownListRef.current.length === 0) {\n      clearTimeout(timeout);\n      timeout = setTimeout(() => {\n        if (dropdownListRef.current && dropdownListRef.current.length === 0) {\n          setHideControls(isMobileDevice);\n        }\n      }, 5000);\n    }\n    return () => {\n      clearTimeout(timeout);\n    };\n  }, [dropdownList, hideControls, isMobileDevice]);\n\n  useEffect(() => {\n    if (\n      authTokenInAppData &&\n      !isConnectedToRoom &&\n      !isPreviewScreenEnabled &&\n      roomState !== HMSRoomState.Connecting &&\n      !autoRoomJoined.current\n    ) {\n      hmsActions\n        .join({\n          userName: userName || uuid(),\n          authToken: authTokenInAppData,\n          initEndpoint: endpoints?.init,\n          settings: {\n            isAudioMuted: !isPreviewScreenEnabled,\n            isVideoMuted: !isPreviewScreenEnabled,\n            speakerAutoSelectionBlacklist: ['Yeti Stereo Microphone'],\n          },\n        })\n        .then(() => requestPermission())\n        .catch(console.error);\n      autoRoomJoined.current = true;\n    }\n  }, [\n    authTokenInAppData,\n    endpoints?.init,\n    hmsActions,\n    isConnectedToRoom,\n    isPreviewScreenEnabled,\n    roomState,\n    userName,\n    requestPermission,\n  ]);\n\n  useEffect(() => {\n    onJoinFunc?.();\n    return () => {\n      PictureInPicture.stop().catch((error: unknown) => console.error('stopping pip', (error as Error).message));\n    };\n  }, [onJoinFunc]);\n\n  if (!isConnectedToRoom && ![HMSRoomState.Reconnecting, HMSRoomState.Disconnected].includes(roomState)) {\n    return <FullPageProgress text={roomState === HMSRoomState.Connecting ? 'Joining...' : ''} />;\n  }\n\n  const hideControlsForStreaming = isMwebHLSStream ? true : hideControls;\n\n  return (\n    <>\n      {isHLSStarted ? (\n        <Box css={{ position: 'fixed', zIndex: 100, w: '100%', h: '100%', left: 0, top: 0 }}>\n          <FullPageProgress text=\"Starting live stream...\" css={{ opacity: 0.8, bg: '$background_dim' }} />\n        </Box>\n      ) : null}\n      <Flex css={{ size: '100%', overflow: 'hidden' }} direction=\"column\">\n        {!(screenProps.hideSections.includes('header') || isMwebHLSStream) && (\n          <Box\n            ref={headerRef}\n            css={{\n              h: '$18',\n              transition: 'margin 0.3s ease-in-out',\n              marginTop: hideControlsForStreaming ? `-${headerRef.current?.clientHeight}px` : 'none',\n              '@md': {\n                h: '$17',\n              },\n            }}\n            data-testid=\"header\"\n          >\n            <Header />\n          </Box>\n        )}\n        <Box\n          css={{\n            w: '100%',\n            flex: '1 1 0',\n            minHeight: 0,\n            // @ts-ignore\n            px: (screenProps?.elements as DefaultConferencingScreen_Elements)?.video_tile_layout?.grid?.edge_to_edge\n              ? 0\n              : '$10', // TODO: padding to be controlled by section/element\n            paddingBottom: 'env(safe-area-inset-bottom)',\n            '@lg': {\n              px: 0,\n            },\n          }}\n          id=\"conferencing\"\n          data-testid=\"conferencing\"\n          onClick={toggleControls}\n        >\n          {screenProps.elements ? (\n            <VideoStreamingSection\n              screenType={screenProps.screenType}\n              elements={screenProps.elements}\n              hideControls={hideControlsForStreaming}\n            />\n          ) : null}\n        </Box>\n        {!screenProps.hideSections.includes('footer') && screenProps.elements && !isMwebHLSStream && (\n          <Box\n            ref={footerRef}\n            css={{\n              flexShrink: 0,\n              maxHeight: '$24',\n              transition: 'margin 0.3s ease-in-out',\n              bg: '$background_dim',\n              marginBottom: hideControlsForStreaming ? `-${footerRef.current?.clientHeight}px` : undefined,\n              '@md': {\n                maxHeight: 'unset',\n                bg: screenProps.screenType === 'hls_live_streaming' ? 'transparent' : '$background_dim',\n              },\n            }}\n            data-testid=\"footer\"\n          >\n            <Footer elements={screenProps.elements} screenType={screenProps.screenType} />\n          </Box>\n        )}\n        {isMwebHLSStream && !showChat && (\n          <Flex\n            css={{\n              alignItems: 'center',\n              pr: '$4',\n              pb: '$4',\n              position: 'relative',\n            }}\n            justify=\"end\"\n            gap=\"2\"\n          >\n            <RaiseHand />\n            <MoreSettings elements={screenProps.elements} screenType={screenProps.screenType} />\n            <Box\n              css={{\n                position: 'absolute',\n                bottom: '100%',\n                mb: '$4',\n              }}\n            >\n              <EmojiReaction />\n            </Box>\n          </Flex>\n        )}\n        <RoleChangeRequestModal />\n        <HLSFailureModal />\n        <ActivatedPIP />\n        <PreviousRoleInMetadata />\n      </Flex>\n    </>\n  );\n};\n", "import React, { useEffect } from 'react';\nimport { useMedia } from 'react-use';\nimport { ConferencingScreen } from '@100mslive/types-prebuilt';\nimport { Chat_ChatState } from '@100mslive/types-prebuilt/elements/chat';\nimport { config as cssConfig, Footer as AppFooter } from '../../..';\n// @ts-ignore: No implicit Any\nimport { AudioVideoToggle } from '../AudioVideoToggle';\nimport { CaptionIcon } from '../CaptionIcon';\n// @ts-ignore: No implicit Any\nimport { EmojiReaction } from '../EmojiReaction';\n// @ts-ignore: No implicit Any\nimport { LeaveRoom } from '../Leave/LeaveRoom';\n// @ts-ignore: No implicit Any\nimport { MoreSettings } from '../MoreSettings/MoreSettings';\nimport { RaiseHand } from '../RaiseHand';\n// @ts-ignore: No implicit Any\nimport { ScreenshareToggle } from '../ScreenShareToggle';\n// @ts-ignore: No implicit Any\nimport { VBToggle } from '../VirtualBackground/VBToggle';\n// @ts-ignore: No implicit Any\nimport { ChatToggle } from './ChatToggle';\nimport { ParticipantCount } from './ParticipantList';\nimport { PollsToggle } from './PollsToggle';\nimport { WhiteboardToggle } from './WhiteboardToggle';\nimport { ConferencingScreenElements } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { useIsSidepaneTypeOpen, useSidepaneToggle } from '../AppData/useSidepane';\n// @ts-ignore: No implicit Any\nimport { useShowPolls } from '../AppData/useUISettings';\n// @ts-ignore: No implicit Any\nimport { SIDE_PANE_OPTIONS } from '../../common/constants';\n\nexport const Footer = ({\n  screenType,\n  elements,\n}: {\n  screenType: keyof ConferencingScreen;\n  elements: ConferencingScreenElements;\n}) => {\n  const isMobile = useMedia(cssConfig.media.md);\n  const isOverlayChat = !!elements?.chat?.is_overlay;\n  const openByDefault = elements?.chat?.initial_state === Chat_ChatState.CHAT_STATE_OPEN;\n\n  const isChatOpen = useIsSidepaneTypeOpen(SIDE_PANE_OPTIONS.CHAT);\n  const toggleChat = useSidepaneToggle(SIDE_PANE_OPTIONS.CHAT);\n  const { showPolls } = useShowPolls();\n\n  useEffect(() => {\n    if (!isChatOpen && openByDefault) {\n      toggleChat();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [toggleChat, openByDefault]);\n\n  return (\n    <AppFooter.Root\n      css={{\n        flexWrap: 'nowrap',\n        '@md': {\n          justifyContent: 'center',\n          gap: '$10',\n          position: 'relative',\n          // To prevent it from showing over the sidepane if chat type is not overlay\n          zIndex: isOverlayChat && isChatOpen ? 20 : 1,\n        },\n      }}\n    >\n      <AppFooter.Left\n        css={{\n          '@md': {\n            w: 'unset',\n            p: '0',\n            gap: '$10',\n          },\n        }}\n      >\n        {isMobile ? <LeaveRoom screenType={screenType} /> : null}\n        <AudioVideoToggle />\n        {!isMobile && elements.virtual_background ? <VBToggle /> : null}\n      </AppFooter.Left>\n      <AppFooter.Center\n        css={{\n          '@md': {\n            w: 'unset',\n            gap: '$10',\n          },\n        }}\n      >\n        {isMobile ? (\n          <>\n            <ScreenshareToggle />\n            <RaiseHand />\n            {elements?.chat && <ChatToggle />}\n            <MoreSettings elements={elements} screenType={screenType} />\n          </>\n        ) : (\n          <>\n            <ScreenshareToggle />\n            <RaiseHand />\n            {screenType !== 'hls_live_streaming' && <CaptionIcon />}\n            {elements?.emoji_reactions && <EmojiReaction />}\n            <LeaveRoom screenType={screenType} />\n          </>\n        )}\n      </AppFooter.Center>\n      <AppFooter.Right>\n        <WhiteboardToggle />\n        {showPolls && <PollsToggle />}\n        {!isMobile && elements?.chat && <ChatToggle />}\n        {elements?.participant_list && <ParticipantCount />}\n        <MoreSettings elements={elements} screenType={screenType} />\n      </AppFooter.Right>\n    </AppFooter.Root>\n  );\n};\n", "import React, { Fragment, useCallback, useEffect, useState } from 'react';\nimport { HMSKrispPlugin } from '@100mslive/hms-noise-cancellation';\nimport {\n  DeviceType,\n  HMSRoomState,\n  selectIsLocalAudioPluginPresent,\n  selectLocalAudioTrackID,\n  selectLocalPeer,\n  selectLocalVideoTrackID,\n  selectRoom,\n  selectRoomState,\n  selectVideoTrackByID,\n  useAVToggle,\n  useDevices,\n  useHMSActions,\n  useHMSStore,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\nimport {\n  AudioLevelIcon,\n  CameraFlipIcon,\n  CheckIcon,\n  MicOffIcon,\n  MicOnIcon,\n  SettingsIcon,\n  SpeakerIcon,\n  VideoOffIcon,\n  VideoOnIcon,\n} from '@100mslive/react-icons';\nimport { IconButtonWithOptions } from './IconButtonWithOptions/IconButtonWithOptions';\n// @ts-ignore: No implicit Any\nimport { ActionTile } from './MoreSettings/ActionTile';\n// @ts-ignore: No implicit Any\nimport SettingsModal from './Settings/SettingsModal';\n// @ts-ignore: No implicit Any\nimport { ToastManager } from './Toast/ToastManager';\nimport { AudioLevel } from '../../AudioLevel';\nimport { Dropdown } from '../../Dropdown';\nimport { Box, Flex } from '../../Layout';\nimport { Switch } from '../../Switch';\nimport { Text } from '../../Text';\nimport { Tooltip } from '../../Tooltip';\nimport IconButton from '../IconButton';\nimport { useRoomLayoutConferencingScreen } from '../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { useIsNoiseCancellationEnabled, useSetNoiseCancellation } from './AppData/useUISettings';\nimport { useAudioOutputTest } from './hooks/useAudioOutputTest';\nimport { isAndroid, isIOS, isMacOS, TEST_AUDIO_URL } from '../common/constants';\n\nconst krispPlugin = new HMSKrispPlugin();\n// const optionsCSS = { fontWeight: '$semiBold', color: '$on_surface_high', w: '100%' };\n\nexport const Options = ({\n  options,\n  selectedDeviceId,\n  onClick,\n}: {\n  options?: Array<MediaDeviceInfo | InputDeviceInfo>;\n  selectedDeviceId?: string;\n  onClick: (deviceId: string) => Promise<void>;\n}) => {\n  return (\n    <>\n      {options?.map(option => (\n        <Dropdown.Item\n          key={option.label}\n          css={{\n            backgroundColor: '$surface_dim',\n            p: '$4 $8',\n            h: '$15',\n            fontSize: '$xs',\n            justifyContent: 'space-between',\n            color: selectedDeviceId === option.deviceId ? '$primary_bright' : '',\n          }}\n          onClick={() => {\n            onClick(option.deviceId);\n          }}\n        >\n          {option.label}\n          {selectedDeviceId === option.deviceId ? <CheckIcon width={16} height={16} /> : null}\n        </Dropdown.Item>\n      ))}\n    </>\n  );\n};\n\nconst OptionLabel = ({ children, icon }: { children: React.ReactNode; icon: React.ReactNode }) => {\n  return (\n    <Dropdown.Label\n      css={{\n        h: '$16',\n        p: '$4 $8',\n        color: '$on_surface_medium',\n        bg: 'transparent',\n        fontSize: '$xs',\n        gap: '$4',\n        alignItems: 'center',\n      }}\n    >\n      <Flex css={{ alignItems: 'center', justifyContent: 'center', '& svg': { size: '$8' } }}>{icon}</Flex> {children}\n    </Dropdown.Label>\n  );\n};\n\nconst useNoiseCancellationWithPlugin = () => {\n  const actions = useHMSActions();\n  const [inProgress, setInProgress] = useState(false);\n  const [, setNoiseCancellationEnabled] = useSetNoiseCancellation();\n  const isEnabledForRoom = useHMSStore(selectRoom)?.isNoiseCancellationEnabled;\n  const setNoiseCancellationWithPlugin = useCallback(\n    async (enabled: boolean) => {\n      if (!isEnabledForRoom || inProgress) {\n        return;\n      }\n      if (!krispPlugin.checkSupport().isSupported) {\n        throw Error('Krisp plugin is not supported');\n      }\n      setInProgress(true);\n      if (enabled) {\n        await actions.addPluginToAudioTrack(krispPlugin);\n      } else {\n        await actions.removePluginFromAudioTrack(krispPlugin);\n      }\n      setNoiseCancellationEnabled(enabled);\n      setInProgress(false);\n    },\n    [actions, inProgress, isEnabledForRoom, setNoiseCancellationEnabled],\n  );\n  return {\n    setNoiseCancellationWithPlugin,\n    inProgress,\n  };\n};\n\nexport const NoiseCancellation = ({\n  actionTile,\n  iconOnly,\n  setOpenOptionsSheet,\n}: {\n  setOpenOptionsSheet?: (value: boolean) => void;\n  iconOnly?: boolean;\n  actionTile?: boolean;\n}) => {\n  const localPeerAudioTrackID = useHMSStore(selectLocalAudioTrackID);\n  const isNoiseCancellationEnabled = useIsNoiseCancellationEnabled();\n  const { setNoiseCancellationWithPlugin, inProgress } = useNoiseCancellationWithPlugin();\n  const room = useHMSStore(selectRoom);\n  const isKrispPluginAdded = useHMSStore(selectIsLocalAudioPluginPresent(krispPlugin.getName()));\n\n  if (!krispPlugin.isSupported() || !room.isNoiseCancellationEnabled || !localPeerAudioTrackID) {\n    return null;\n  }\n\n  if (actionTile) {\n    return (\n      <ActionTile.Root\n        active={isNoiseCancellationEnabled && isKrispPluginAdded}\n        disable={inProgress}\n        onClick={async () => {\n          await setNoiseCancellationWithPlugin(!isNoiseCancellationEnabled);\n          setOpenOptionsSheet?.(false);\n        }}\n      >\n        <AudioLevelIcon />\n        <ActionTile.Title>{isNoiseCancellationEnabled ? 'Noise Reduced' : 'Reduce Noise'}</ActionTile.Title>\n      </ActionTile.Root>\n    );\n  }\n\n  if (iconOnly) {\n    return (\n      <Tooltip title={isNoiseCancellationEnabled ? 'Noise Reduced' : 'Reduce Noise'}>\n        <IconButton\n          onClick={async () => {\n            await setNoiseCancellationWithPlugin(!isNoiseCancellationEnabled);\n          }}\n          disabled={inProgress}\n          css={{\n            bg: isNoiseCancellationEnabled && isKrispPluginAdded ? '$surface_brighter' : '$background_dim',\n            borderColor: isNoiseCancellationEnabled && isKrispPluginAdded ? '$border_brighter' : '$border_bright',\n          }}\n        >\n          <AudioLevelIcon />\n        </IconButton>\n      </Tooltip>\n    );\n  }\n  return (\n    <>\n      <Dropdown.ItemSeparator css={{ mx: 0 }} />\n      <Dropdown.Item\n        css={{\n          p: '$4 $8',\n          h: '$15',\n          fontSize: '$xs',\n          justifyContent: 'space-between',\n        }}\n        onClick={async e => {\n          e.preventDefault();\n          await setNoiseCancellationWithPlugin(!isNoiseCancellationEnabled);\n        }}\n      >\n        <Text css={{ display: 'flex', alignItems: 'center', gap: '$2', fontSize: '$xs', '& svg': { size: '$8' } }}>\n          <AudioLevelIcon />\n          Reduce Noise\n        </Text>\n        <Switch\n          id=\"noise_cancellation\"\n          checked={isNoiseCancellationEnabled && isKrispPluginAdded}\n          disabled={inProgress}\n          onClick={e => e.stopPropagation()}\n          onCheckedChange={async value => {\n            await setNoiseCancellationWithPlugin(value);\n          }}\n        />\n      </Dropdown.Item>\n      <Dropdown.ItemSeparator css={{ mx: 0 }} />\n    </>\n  );\n};\n\nconst AudioOutputLabel = ({ deviceId }: { deviceId: string }) => {\n  const { playing, setPlaying, audioRef } = useAudioOutputTest({ deviceId });\n  return (\n    <OptionLabel icon={<SpeakerIcon />}>\n      <Box css={{ flex: '1 1 0' }}>Speakers</Box>\n      <Text\n        variant=\"xs\"\n        css={{ color: '$primary_bright', '&:hover': { cursor: 'pointer' } }}\n        onClick={async () => {\n          if (playing) {\n            return;\n          }\n          await audioRef.current?.play();\n        }}\n      >\n        <audio\n          ref={audioRef}\n          src={TEST_AUDIO_URL}\n          onEnded={() => setPlaying(false)}\n          onPlay={() => setPlaying(true)}\n          style={{ display: 'none' }}\n        />\n        {playing ? 'Playing Sound...' : 'Play Test Sound'}\n      </Text>\n    </OptionLabel>\n  );\n};\n\nconst AudioSettings = ({ onClick }: { onClick: () => void }) => {\n  return (\n    <>\n      <Dropdown.Item\n        css={{\n          backgroundColor: '$surface_dim',\n          p: '$4 $8',\n          h: '$15',\n          alignItems: 'center',\n          gap: '$2',\n          fontSize: '$xs',\n          '& svg': { size: '$8' },\n        }}\n        onClick={onClick}\n      >\n        <SettingsIcon /> Audio Settings\n      </Dropdown.Item>\n    </>\n  );\n};\nexport const AudioVideoToggle = ({ hideOptions = false }: { hideOptions?: boolean }) => {\n  const { allDevices, selectedDeviceIDs, updateDevice } = useDevices(error => {\n    ToastManager.addToast({\n      title: error.message,\n      variant: 'error',\n      duration: 2000,\n    });\n  });\n  const { videoInput, audioInput, audioOutput } = allDevices;\n  const localPeer = useHMSStore(selectLocalPeer);\n  const { isLocalVideoEnabled, isLocalAudioEnabled, toggleAudio, toggleVideo } = useAVToggle();\n  const actions = useHMSActions();\n  const vanillaStore = useHMSVanillaStore();\n  const videoTrackId = useHMSStore(selectLocalVideoTrackID);\n  const localVideoTrack = useHMSStore(selectVideoTrackByID(videoTrackId));\n  const roomState = useHMSStore(selectRoomState);\n  const hasAudioDevices = Number(audioInput?.length) > 0;\n  const hasVideoDevices = Number(videoInput?.length) > 0;\n  const shouldShowAudioOutput = 'setSinkId' in HTMLMediaElement.prototype && Number(audioOutput?.length) > 0;\n  const { screenType } = useRoomLayoutConferencingScreen();\n  const [showSettings, setShowSettings] = useState(false);\n  const isKrispPluginAdded = useHMSStore(selectIsLocalAudioPluginPresent(krispPlugin.getName()));\n  const isNoiseCancellationEnabled = useIsNoiseCancellationEnabled();\n  const { setNoiseCancellationWithPlugin, inProgress } = useNoiseCancellationWithPlugin();\n  const showMuteIcon = !isLocalAudioEnabled || !toggleAudio;\n\n  useEffect(() => {\n    (async () => {\n      const isEnabledForRoom = vanillaStore.getState(selectRoom)?.isNoiseCancellationEnabled;\n      if (\n        isEnabledForRoom &&\n        isNoiseCancellationEnabled &&\n        !isKrispPluginAdded &&\n        !inProgress &&\n        localPeer?.audioTrack\n      ) {\n        try {\n          await setNoiseCancellationWithPlugin(true);\n          ToastManager.addToast({\n            title: `Noise Reduction Enabled`,\n            variant: 'standard',\n            duration: 2000,\n            icon: <AudioLevelIcon />,\n          });\n        } catch (error) {\n          console.error(error);\n        }\n      }\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isNoiseCancellationEnabled, localPeer?.audioTrack, inProgress]);\n\n  if (!toggleAudio && !toggleVideo) {\n    return null;\n  }\n  return (\n    <Fragment>\n      {toggleAudio ? (\n        <IconButtonWithOptions\n          disabled={!toggleAudio}\n          hideOptions={hideOptions || !hasAudioDevices}\n          onDisabledClick={toggleAudio}\n          testid=\"audio_toggle_btn\"\n          tooltipMessage={`Turn ${isLocalAudioEnabled ? 'off' : 'on'} audio (${isMacOS ? '\u2318' : 'ctrl'} + d)`}\n          icon={!isLocalAudioEnabled ? <MicOffIcon /> : <MicOnIcon />}\n          active={isLocalAudioEnabled}\n          onClick={toggleAudio}\n          key=\"toggleAudio\"\n        >\n          <Dropdown.Group>\n            <OptionLabel icon={<MicOnIcon />}>\n              <Box css={{ flex: '1 1 0' }}>{!shouldShowAudioOutput ? 'Audio' : 'Microphone'}</Box>\n              {!showMuteIcon && <AudioLevel trackId={localPeer?.audioTrack} />}\n            </OptionLabel>\n            <Options\n              options={audioInput}\n              selectedDeviceId={selectedDeviceIDs.audioInput}\n              onClick={deviceId => updateDevice({ deviceId, deviceType: DeviceType.audioInput })}\n            />\n          </Dropdown.Group>\n          <Dropdown.ItemSeparator css={{ mx: 0 }} />\n          {shouldShowAudioOutput && (\n            <>\n              <AudioOutputLabel deviceId={selectedDeviceIDs.audioOutput || ''} />\n              <Dropdown.Group>\n                <Options\n                  options={audioOutput}\n                  selectedDeviceId={selectedDeviceIDs.audioOutput}\n                  onClick={deviceId => updateDevice({ deviceId, deviceType: DeviceType.audioOutput })}\n                />\n              </Dropdown.Group>\n            </>\n          )}\n          <NoiseCancellation />\n          <AudioSettings onClick={() => setShowSettings(true)} />\n        </IconButtonWithOptions>\n      ) : null}\n\n      {toggleVideo ? (\n        <IconButtonWithOptions\n          disabled={!toggleVideo}\n          hideOptions={hideOptions || !hasVideoDevices}\n          onDisabledClick={toggleVideo}\n          tooltipMessage={`Turn ${isLocalVideoEnabled ? 'off' : 'on'} video (${isMacOS ? '\u2318' : 'ctrl'} + e)`}\n          testid=\"video_toggle_btn\"\n          icon={!isLocalVideoEnabled ? <VideoOffIcon /> : <VideoOnIcon />}\n          key=\"toggleVideo\"\n          active={isLocalVideoEnabled}\n          onClick={toggleVideo}\n        >\n          <Options\n            options={videoInput}\n            selectedDeviceId={selectedDeviceIDs.videoInput}\n            onClick={deviceId => updateDevice({ deviceId, deviceType: DeviceType.videoInput })}\n          />\n        </IconButtonWithOptions>\n      ) : null}\n\n      {localVideoTrack?.facingMode && roomState === HMSRoomState.Preview && (isIOS || isAndroid) ? (\n        <Tooltip title=\"Switch Camera\" key=\"switchCamera\">\n          <IconButton\n            onClick={async () => {\n              try {\n                await actions.switchCamera();\n              } catch (e) {\n                ToastManager.addToast({\n                  title: `Error while flipping camera ${(e as Error).message || ''}`,\n                  variant: 'error',\n                });\n              }\n            }}\n          >\n            <CameraFlipIcon />\n          </IconButton>\n        </Tooltip>\n      ) : null}\n      {showSettings && (\n        <SettingsModal open={showSettings} onOpenChange={() => setShowSettings(false)} screenType={screenType} />\n      )}\n    </Fragment>\n  );\n};\n", "import React from 'react';\nimport { VerticalMenuIcon } from '@100mslive/react-icons';\nimport { Dropdown } from '../../../Dropdown';\nimport { Flex } from '../../../Layout';\nimport { styled } from '../../../Theme';\nimport { Tooltip } from '../../../Tooltip';\nimport IconButton from '../../IconButton';\n\nconst variants = {\n  disabled: {\n    true: {\n      bg: '$surface_brighter',\n    },\n  },\n  active: {\n    false: {\n      bg: '$secondary_dim',\n    },\n  },\n};\n\nconst IconSection = styled(IconButton, {\n  w: 'unset',\n  h: '$14',\n  p: '$4',\n  r: '$1',\n  bg: 'transparent',\n  borderTopRightRadius: '0 !important',\n  borderColor: '$border_bright',\n  borderBottomRightRadius: '0 !important',\n  position: 'relative',\n  '&:not([disabled]):focus-visible': {\n    zIndex: 1,\n  },\n  '@md': {\n    mx: 0,\n    borderTopRightRadius: '$1 !important',\n    borderBottomRightRadius: '$1 !important',\n  },\n  variants: {\n    ...variants,\n    hideOptions: {\n      true: {\n        borderTopRightRadius: '$1 !important',\n        borderBottomRightRadius: '$1 !important',\n      },\n    },\n  },\n});\n\nconst OptionsSection = styled(IconButton, {\n  w: 'unset',\n  h: '$14',\n  p: '$4 $2',\n  r: '$1',\n  borderTopLeftRadius: '0 !important',\n  borderColor: '$border_bright',\n  borderBottomLeftRadius: '0 !important',\n  borderLeftWidth: '0 !important',\n  position: 'relative',\n  '&:not([disabled]):focus-visible': {\n    zIndex: 1,\n  },\n  '@md': {\n    display: 'none',\n  },\n  variants,\n});\n\nconst Icon = styled(Flex, {\n  alignItems: 'center',\n  justifyContent: 'center',\n  color: '$on_primary_high',\n  variants: {\n    disabled: {\n      true: {\n        color: '$on_surface_low',\n      },\n    },\n    active: {\n      true: {\n        color: '$on_surface_high',\n      },\n    },\n  },\n});\n\nexport const IconButtonWithOptions = ({\n  disabled = false,\n  onDisabledClick = () => {\n    return;\n  },\n  testid = '',\n  tooltipMessage = '',\n  icon,\n  children,\n  active,\n  hideOptions = false,\n  onClick = () => {\n    return;\n  },\n}: {\n  onClick: () => void;\n  onDisabledClick: () => void;\n  icon: React.ReactNode;\n  children: React.ReactNode;\n  testid?: string;\n  hideOptions?: boolean;\n  active: boolean;\n  disabled?: boolean;\n  tooltipMessage?: string;\n}) => {\n  const commonProps = { disabled, active };\n  return (\n    <Flex>\n      <IconSection\n        data-testid={testid}\n        {...commonProps}\n        onClick={onClick}\n        hideOptions={hideOptions}\n        className=\"__cancel-drag-event\"\n      >\n        <Tooltip disabled={!tooltipMessage} title={tooltipMessage}>\n          <Icon {...commonProps}>{icon}</Icon>\n        </Tooltip>\n      </IconSection>\n      {!hideOptions && children ? (\n        <Dropdown.Root>\n          <Dropdown.Trigger\n            asChild\n            // onClick does not work\n            onPointerDown={e => {\n              if (disabled) {\n                e.preventDefault();\n                onDisabledClick();\n              }\n            }}\n          >\n            <OptionsSection {...commonProps}>\n              <Tooltip title=\"View Options\">\n                <Icon {...commonProps}>\n                  <VerticalMenuIcon />\n                </Icon>\n              </Tooltip>\n            </OptionsSection>\n          </Dropdown.Trigger>\n          <Dropdown.Content\n            sideOffset={5}\n            alignOffset={-44}\n            align=\"start\"\n            side=\"top\"\n            css={{\n              w: 344,\n              maxWidth: '100%',\n              maxHeight: 'unset',\n              p: 0,\n              border: 'none',\n              bg: '$surface_dim',\n            }}\n          >\n            {children}\n          </Dropdown.Content>\n        </Dropdown.Root>\n      ) : null}\n    </Flex>\n  );\n};\n", "import { IconButton as BaseIconButton } from '../IconButton';\nimport { styled } from '../Theme';\n\nconst IconButton = styled(BaseIconButton, {\n  width: '$14',\n  height: '$14',\n  border: '1px solid $border_bright',\n  bg: '$background_dim',\n  r: '$1',\n  '&[disabled]': {\n    opacity: 0.5,\n    cursor: 'not-allowed',\n    backgroundColor: '$secondary_dim',\n    color: '$on_primary_high',\n  },\n  variants: {\n    active: {\n      true: {\n        color: '$on_surface_high',\n        backgroundColor: 'transparent',\n      },\n    },\n  },\n});\n\nexport default IconButton;\n", "import React from 'react';\nimport { Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { styled } from '../../../Theme';\n\nconst ActionTileRoot = ({ active, disabled = false, children, onClick, ...props }) => (\n  <Flex\n    {...props}\n    css={{\n      flexDirection: 'column',\n      alignItems: 'center',\n      p: '$4 $2',\n      position: 'relative',\n      bg: active ? '$surface_bright' : '',\n      color: disabled ? '$on_surface_low' : '$on_surface_high',\n      gap: '$4',\n      r: '$1',\n      '&:hover': {\n        bg: '$surface_bright',\n      },\n    }}\n    onClick={() => {\n      if (!disabled) {\n        onClick();\n      }\n    }}\n  >\n    {children}\n  </Flex>\n);\n\nconst ActionTileCount = styled(Text, {\n  position: 'absolute',\n  top: 0,\n  right: 0,\n  fontWeight: '$semiBold',\n  color: '$on_surface_high',\n  p: '$1 $2',\n  minWidth: '$9',\n  textAlign: 'center',\n  boxSizing: 'border-box',\n  bg: '$surface_bright',\n  r: '$round',\n  letterSpacing: '1.5px',\n  fontSize: '$tiny !important',\n  lineHeight: '$tiny !important',\n});\n\nconst ActionTileTitle = styled(Text, {\n  fontWeight: '$semiBold',\n  color: 'inherit',\n  textAlign: 'center',\n  fontSize: '$xs !important',\n});\n\nexport const ActionTile = {\n  Root: ActionTileRoot,\n  Title: ActionTileTitle,\n  Count: ActionTileCount,\n};\n", "import React, { useCallback, useEffect, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { ChevronLeftIcon, CrossIcon, GridFourIcon, NotificationsIcon, SettingsIcon } from '@100mslive/react-icons';\nimport { HorizontalDivider } from '../../../Divider';\nimport { IconButton } from '../../../IconButton';\nimport { Box, Flex } from '../../../Layout';\nimport { Dialog } from '../../../Modal';\nimport { Sheet } from '../../../Sheet';\nimport { Tabs } from '../../../Tabs';\nimport { Text } from '../../../Text';\nimport { config as cssConfig } from '../../../Theme';\nimport DeviceSettings from './DeviceSettings';\nimport { LayoutSettings } from './LayoutSettings';\nimport { NotificationSettings } from './NotificationSettings';\nimport { settingContent } from './common';\n\nconst settingsList = [\n  {\n    tabName: 'devices',\n    title: 'Device Settings',\n    icon: SettingsIcon,\n    content: DeviceSettings,\n  },\n  {\n    tabName: 'notifications',\n    title: 'Notifications',\n    icon: NotificationsIcon,\n    content: NotificationSettings,\n  },\n  {\n    tabName: 'layout',\n    title: 'Layout',\n    icon: GridFourIcon,\n    content: LayoutSettings,\n  },\n];\n\nconst SettingsModal = ({ open, onOpenChange, screenType, children = <></> }) => {\n  const mediaQueryLg = cssConfig.media.md;\n  const isMobile = useMedia(mediaQueryLg);\n\n  const [showSetting, setShowSetting] = useState(() =>\n    settingsList.reduce((obj, { tabName }) => ({ ...obj, [tabName]: true }), {}),\n  );\n\n  const hideSettingByTabName = useCallback(\n    key => hide => setShowSetting(prev => ({ ...prev, [key]: !hide })),\n    [setShowSetting],\n  );\n\n  useEffect(() => {\n    if (screenType === 'hls_live_streaming') {\n      hideSettingByTabName('layout')(true);\n    }\n  }, [screenType, hideSettingByTabName]);\n\n  const [selection, setSelection] = useState(() => Object.keys(showSetting).find(key => showSetting[key]) ?? '');\n  const resetSelection = useCallback(() => {\n    setSelection('');\n  }, []);\n\n  useEffect(() => {\n    if (isMobile) {\n      setSelection('');\n    } else {\n      const firstNotHiddenTabName = Object.keys(showSetting).find(key => showSetting[key]) ?? '';\n      setSelection(firstNotHiddenTabName);\n    }\n  }, [isMobile, showSetting]);\n\n  return isMobile ? (\n    <MobileSettingModal\n      open={open}\n      onOpenChange={onOpenChange}\n      selection={selection}\n      setSelection={setSelection}\n      showSetting={showSetting}\n      hideSettingByTabName={hideSettingByTabName}\n      resetSelection={resetSelection}\n    >\n      {children}\n    </MobileSettingModal>\n  ) : (\n    <DesktopSettingModal\n      open={open}\n      onOpenChange={onOpenChange}\n      selection={selection}\n      setSelection={setSelection}\n      showSetting={showSetting}\n      hideSettingByTabName={hideSettingByTabName}\n      resetSelection={resetSelection}\n    >\n      {children}\n    </DesktopSettingModal>\n  );\n};\n\nconst MobileSettingModal = ({\n  open,\n  onOpenChange,\n  selection,\n  setSelection,\n  showSetting,\n  hideSettingByTabName,\n  resetSelection,\n  children = <></>,\n}) => {\n  return (\n    <Sheet.Root open={open} onOpenChange={onOpenChange}>\n      <Sheet.Trigger asChild>{children}</Sheet.Trigger>\n      <Sheet.Content\n        css={{\n          bg: '$surface_dim',\n          overflowY: 'auto',\n        }}\n      >\n        <Sheet.Title css={{ py: '$10', px: '$8', alignItems: 'center' }}>\n          <Flex direction=\"row\" justify=\"between\" css={{ w: '100%' }}>\n            {!selection ? (\n              <Text variant=\"h6\" css={{ display: 'flex' }}>\n                Settings\n              </Text>\n            ) : (\n              <Text variant=\"h6\" css={{ display: 'flex' }}>\n                <Box as=\"span\" css={{ r: '$round', mr: '$2' }} onClick={resetSelection}>\n                  <ChevronLeftIcon />\n                </Box>\n                {selection?.charAt(0).toUpperCase() + selection.slice(1)}\n              </Text>\n            )}\n            <Sheet.Close>\n              <IconButton as=\"div\" data-testid=\"dialog_cross_icon\">\n                <CrossIcon />\n              </IconButton>\n            </Sheet.Close>\n          </Flex>\n        </Sheet.Title>\n        <HorizontalDivider />\n        {!selection ? (\n          <Flex\n            direction=\"column\"\n            css={{\n              px: '$8',\n              pb: '$8',\n              overflowY: 'auto',\n            }}\n          >\n            {settingsList\n              .filter(({ tabName }) => showSetting[tabName])\n              .map(({ icon: Icon, tabName, title }) => {\n                return (\n                  <Box\n                    key={tabName}\n                    value={tabName}\n                    onClick={() => {\n                      setSelection(tabName);\n                    }}\n                    as=\"div\"\n                    css={{\n                      all: 'unset',\n                      fontFamily: '$sans',\n                      py: '$10',\n                      display: 'flex',\n                      alignItems: 'center',\n                      fontSize: '$sm',\n                      lineHeight: '$sm',\n                      color: '$on_surface_high',\n                      userSelect: 'none',\n                      gap: '$8',\n                      cursor: 'pointer',\n                      '&:hover': {\n                        bg: '$surface_brighter',\n                        r: '$1',\n                        gap: '$8',\n                        border: 'none',\n                      },\n                      borderBottom: '1px solid $border_default',\n                    }}\n                  >\n                    <Icon />\n                    {title}\n                  </Box>\n                );\n              })}\n          </Flex>\n        ) : (\n          <Box\n            direction=\"column\"\n            css={{ overflowY: 'scroll', px: '$8', py: '$10', maxHeight: '70vh', overflowX: 'hidden' }}\n          >\n            {settingsList\n              .filter(({ tabName }) => showSetting[tabName] && selection === tabName)\n              .map(({ content: Content, title, tabName }) => {\n                return <Content key={title} setHide={hideSettingByTabName(tabName)} />;\n              })}\n          </Box>\n        )}\n      </Sheet.Content>\n    </Sheet.Root>\n  );\n};\nconst DesktopSettingModal = ({\n  open,\n  onOpenChange,\n  selection,\n  setSelection,\n  showSetting,\n  hideSettingByTabName,\n  resetSelection,\n  children = <></>,\n}) => {\n  return (\n    <Dialog.Root open={open} onOpenChange={onOpenChange}>\n      <Dialog.Trigger asChild>{children}</Dialog.Trigger>\n      <Dialog.Portal>\n        <Dialog.Overlay />\n        <Dialog.Content\n          css={{\n            w: 'min(800px, 90%)',\n            height: 'min(656px, 90%)',\n            p: 0,\n            r: '$4',\n          }}\n        >\n          <Tabs.Root\n            value={selection}\n            activationMode=\"automatic\"\n            onValueChange={setSelection}\n            css={{ size: '100%', position: 'relative' }}\n          >\n            <Tabs.List\n              css={{\n                w: '18.625rem',\n                flexDirection: 'column',\n                bg: '$background_default',\n                p: '$14 $10',\n                borderTopLeftRadius: '$4',\n                borderBottomLeftRadius: '$4',\n              }}\n            >\n              <Text variant=\"h5\">Settings </Text>\n              <Flex direction=\"column\" css={{ mx: 0, overflowY: 'auto', pt: '$10' }}>\n                {settingsList\n                  .filter(({ tabName }) => showSetting[tabName])\n                  .map(({ icon: Icon, tabName, title }) => {\n                    return (\n                      <Tabs.Trigger key={tabName} value={tabName} css={{ gap: '$8' }}>\n                        <Icon />\n                        {title}\n                      </Tabs.Trigger>\n                    );\n                  })}\n              </Flex>\n            </Tabs.List>\n            {selection && (\n              <Flex\n                direction=\"column\"\n                css={{\n                  flex: '1 1 0',\n                  minWidth: 0,\n                  mr: '$4',\n                }}\n              >\n                {settingsList\n                  .filter(({ tabName }) => showSetting[tabName])\n                  .map(({ content: Content, title, tabName }) => {\n                    return (\n                      <Tabs.Content key={tabName} value={tabName} className={settingContent()}>\n                        <SettingsContentHeader onBack={resetSelection} isMobile={false}>\n                          {title}\n                        </SettingsContentHeader>\n                        <Content setHide={hideSettingByTabName(tabName)} />\n                      </Tabs.Content>\n                    );\n                  })}\n              </Flex>\n            )}\n          </Tabs.Root>\n          <Dialog.Close css={{ position: 'absolute', right: '$10', top: '$10' }}>\n            <IconButton as=\"div\" data-testid=\"dialog_cross_icon\">\n              <CrossIcon />\n            </IconButton>\n          </Dialog.Close>\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n};\nconst SettingsContentHeader = ({ children, isMobile, onBack }) => {\n  return (\n    <Text variant=\"h6\" css={{ mb: '$12', display: 'flex', alignItems: 'center' }}>\n      {isMobile && (\n        <Box as=\"span\" css={{ bg: '$surface_bright', mr: '$4', r: '$round', p: '$2' }} onClick={onBack}>\n          <ChevronLeftIcon />\n        </Box>\n      )}\n      {children}\n    </Text>\n  );\n};\n\nexport default SettingsModal;\n", "export { Sheet } from './Sheet';\n", "import React from 'react';\nimport * as DialogPrimitive from '@radix-ui/react-dialog';\nimport { CSS, VariantProps } from '@stitches/react';\nimport { Dialog } from '../Modal';\nimport { styled } from '../Theme';\nimport { sheetFadeIn, sheetFadeOut, sheetSlideIn, sheetSlideOut } from '../utils';\n\nconst SheetRoot = styled(DialogPrimitive.Root, {\n  minHeight: '240px',\n  maxWidth: '100%',\n});\nconst SheetTrigger = styled(DialogPrimitive.Trigger, {\n  appearance: 'none !important', // Needed for safari it shows white overlay\n});\n\nconst StyledOverlay = styled(Dialog.Overlay, {\n  top: 0,\n  right: 0,\n  bottom: 0,\n  left: 0,\n\n  '&[data-state=\"open\"]': {\n    animation: `${sheetFadeIn} 150ms cubic-bezier(0.22, 1, 0.36, 1)`,\n  },\n\n  '&[data-state=\"closed\"]': {\n    animation: `${sheetFadeOut} 150ms cubic-bezier(0.22, 1, 0.36, 1)`,\n  },\n});\n\nconst StyledContent = styled(DialogPrimitive.Content, {\n  color: '$on_surface_medium',\n  backgroundColor: '$surface_default',\n  borderTopLeftRadius: '$3',\n  borderTopRightRadius: '$3',\n  boxShadow: '0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)',\n  position: 'fixed',\n  zIndex: 22,\n  top: 0,\n  right: 0,\n  left: 0,\n  bottom: 0,\n  maxHeight: '96%',\n\n  // Among other things, prevents text alignment inconsistencies when dialog can't be centered in the viewport evenly.\n  // Affects animated and non-animated dialogs alike.\n  willChange: 'transform',\n\n  '&:focus': {\n    outline: 'none',\n  },\n  '@allowMotion': {\n    '&[data-state=\"open\"]': {\n      animation: `${sheetSlideIn} 150ms cubic-bezier(0.22, 1, 0.36, 1)`,\n    },\n\n    '&[data-state=\"closed\"]': {\n      animation: `${sheetSlideOut} 150ms cubic-bezier(0.22, 1, 0.36, 1)`,\n    },\n  },\n  '@ls': {\n    maxWidth: '50%',\n    margin: '0 auto',\n  },\n\n  variants: {\n    side: {\n      top: {\n        $$transformValue: 'translate3d(0,-100%,0)',\n        bottom: 'auto',\n      },\n      right: {\n        $$transformValue: 'translate3d(100%,0,0)',\n        right: 0,\n      },\n      bottom: {\n        $$transformValue: 'translate3d(0,100%,0)',\n        bottom: 0,\n        top: 'auto',\n      },\n      left: {\n        $$transformValue: 'translate3d(-100%,0,0)',\n        left: 0,\n      },\n    },\n  },\n\n  defaultVariants: {\n    side: 'bottom',\n  },\n});\n\ntype SheetContentVariants = VariantProps<typeof StyledContent>;\ntype DialogContentPrimitiveProps = React.ComponentProps<typeof DialogPrimitive.Content>;\ntype SheetContentProps = DialogContentPrimitiveProps & SheetContentVariants & { css?: CSS; container?: HTMLElement };\n\nconst SheetContent = React.forwardRef<React.ElementRef<typeof StyledContent>, SheetContentProps>(\n  ({ children, container, ...props }, forwardedRef) => (\n    <Dialog.Portal container={container}>\n      <StyledOverlay />\n      <StyledContent {...props} ref={forwardedRef}>\n        {children}\n      </StyledContent>\n    </Dialog.Portal>\n  ),\n);\nconst SheetClose = Dialog.Close;\nconst SheetTitle = styled(DialogPrimitive.Title, {\n  margin: 0,\n});\nconst SheetDescription = Dialog.Description;\nconst SheetDefaultCloseIcon = Dialog.DefaultClose;\n\nexport const Sheet = {\n  Root: SheetRoot,\n  Trigger: SheetTrigger,\n  Content: SheetContent,\n  Description: SheetDescription,\n  Title: SheetTitle,\n  Close: SheetClose,\n  DefaultClose: SheetDefaultCloseIcon,\n};\n", "import React, { Fragment, useEffect, useRef, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport {\n  DeviceType,\n  selectIsLocalVideoEnabled,\n  selectLocalVideoTrackID,\n  selectVideoTrackByID,\n  useDevices,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { MicOnIcon, SpeakerIcon, VideoOnIcon } from '@100mslive/react-icons';\nimport { Box, Button, Dropdown, Flex, StyledVideoTile, Text, Video } from '../../../';\nimport { config as cssConfig } from '../../../Theme';\nimport { DialogDropdownTrigger } from '../../primitives/DropdownTrigger';\nimport { useUISettings } from '../AppData/useUISettings';\nimport { useAudioOutputTest } from '../hooks/useAudioOutputTest';\nimport { useDropdownSelection } from '../hooks/useDropdownSelection';\nimport { settingOverflow } from './common';\nimport { TEST_AUDIO_URL, UI_SETTINGS } from '../../common/constants';\n\n/**\n * wrap the button on click of whom settings should open, this component will take care of the rest,\n * it'll give the user options to change input/output device as well as check speaker.\n * There is also another controlled way of using this by passing in open and onOpenChange.\n */\nconst Settings = ({ setHide }) => {\n  const { allDevices, selectedDeviceIDs, updateDevice } = useDevices();\n  const { videoInput, audioInput, audioOutput } = allDevices;\n  const videoTrackId = useHMSStore(selectLocalVideoTrackID);\n  const isVideoOn = useHMSStore(selectIsLocalVideoEnabled);\n  // don't show speaker selector where the API is not supported, and use\n  // a generic word(\"Audio\") for Mic. In some cases(Chrome Android for example) this changes both mic and speaker keeping them in sync.\n  const shouldShowAudioOutput = 'setSinkId' in HTMLMediaElement.prototype;\n  const mirrorLocalVideo = useUISettings(UI_SETTINGS.mirrorLocalVideo);\n  const trackSelector = selectVideoTrackByID(videoTrackId);\n  const hmsActions = useHMSActions();\n  const track = useHMSStore(trackSelector);\n  const isMobile = useMedia(cssConfig.media.md);\n\n  useEffect(() => {\n    if (isMobile) {\n      hmsActions.refreshDevices();\n    }\n  }, [hmsActions, isMobile]);\n\n  /**\n   * Chromium browsers return an audioOutput with empty label when no permissions are given\n   */\n  const audioOutputFiltered = audioOutput?.filter(item => !!item.label) ?? [];\n\n  if (!videoInput?.length && !audioInput?.length && !audioOutputFiltered?.length) {\n    setHide(true);\n  }\n\n  return (\n    <Box className={settingOverflow()}>\n      {videoInput?.length ? (\n        <Fragment>\n          {isVideoOn && (\n            <StyledVideoTile.Container\n              css={{\n                w: '90%',\n                px: '$10',\n                height: '$48',\n                bg: 'transparent',\n                m: '$10 auto',\n              }}\n            >\n              <Video trackId={videoTrackId} mirror={track?.facingMode !== 'environment' && mirrorLocalVideo} />\n            </StyledVideoTile.Container>\n          )}\n          <DeviceSelector\n            title=\"Video\"\n            devices={videoInput}\n            icon={<VideoOnIcon />}\n            selection={selectedDeviceIDs.videoInput}\n            onChange={deviceId =>\n              updateDevice({\n                deviceId,\n                deviceType: DeviceType.videoInput,\n              })\n            }\n          />\n        </Fragment>\n      ) : null}\n\n      {audioInput?.length ? (\n        <DeviceSelector\n          title={shouldShowAudioOutput ? 'Microphone' : 'Audio'}\n          icon={<MicOnIcon />}\n          devices={audioInput}\n          selection={selectedDeviceIDs.audioInput}\n          onChange={deviceId =>\n            updateDevice({\n              deviceId,\n              deviceType: DeviceType.audioInput,\n            })\n          }\n        />\n      ) : null}\n\n      {audioOutputFiltered?.length && shouldShowAudioOutput ? (\n        <DeviceSelector\n          title=\"Speaker\"\n          icon={<SpeakerIcon />}\n          devices={audioOutput}\n          selection={selectedDeviceIDs.audioOutput}\n          onChange={deviceId =>\n            updateDevice({\n              deviceId,\n              deviceType: DeviceType.audioOutput,\n            })\n          }\n        >\n          <TestAudio id={selectedDeviceIDs.audioOutput} />\n        </DeviceSelector>\n      ) : null}\n    </Box>\n  );\n};\n\nconst DeviceSelector = ({ title, devices, selection, onChange, icon, children = null }) => {\n  const [open, setOpen] = useState(false);\n  const selectionBg = useDropdownSelection();\n  const ref = useRef(null);\n\n  return (\n    <Box css={{ mb: '$10' }}>\n      <Text css={{ mb: '$4' }}>{title}</Text>\n      <Flex\n        align=\"center\"\n        css={{\n          gap: '$4',\n          '@md': {\n            flexDirection: children ? 'column' : 'row',\n            alignItems: children ? 'start' : 'center',\n          },\n        }}\n      >\n        <Box\n          css={{\n            position: 'relative',\n            flex: '1 1 0',\n            minWidth: 0,\n            w: '100%',\n            maxWidth: '100%',\n            '@md': {\n              mb: children ? '$8' : 0,\n            },\n          }}\n        >\n          <Dropdown.Root open={open} onOpenChange={setOpen}>\n            <DialogDropdownTrigger\n              ref={ref}\n              icon={icon}\n              title={devices.find(({ deviceId }) => deviceId === selection)?.label || 'Select device from list'}\n              open={open}\n            />\n            <Dropdown.Portal>\n              <Dropdown.Content align=\"start\" sideOffset={8} css={{ w: ref.current?.clientWidth, zIndex: 1001 }}>\n                {devices.map(device => {\n                  return (\n                    <Dropdown.Item\n                      key={device.label}\n                      onSelect={() => onChange(device.deviceId)}\n                      css={{\n                        px: '$9',\n                        bg: device.deviceId === selection ? selectionBg : undefined,\n                      }}\n                    >\n                      {device.label}\n                    </Dropdown.Item>\n                  );\n                })}\n              </Dropdown.Content>\n            </Dropdown.Portal>\n          </Dropdown.Root>\n        </Box>\n        {children}\n      </Flex>\n    </Box>\n  );\n};\n\nconst TestAudio = ({ id }) => {\n  const { playing, setPlaying, audioRef } = useAudioOutputTest({ deviceId: id });\n  return (\n    <>\n      <Button\n        variant=\"standard\"\n        css={{\n          flexShrink: 0,\n          p: '$6 $9',\n          '@md': {\n            w: '100%',\n          },\n        }}\n        onClick={() => audioRef.current?.play()}\n        disabled={playing}\n      >\n        <SpeakerIcon />\n        &nbsp;Test{' '}\n        <Text as=\"span\" css={{ display: 'none', '@md': { display: 'inline' } }}>\n          &nbsp; speaker\n        </Text>\n      </Button>\n      <audio\n        ref={audioRef}\n        src={TEST_AUDIO_URL}\n        onEnded={() => setPlaying(false)}\n        onPlay={() => setPlaying(true)}\n        css={{ display: 'none' }}\n      />\n    </>\n  );\n};\n\nexport default Settings;\n", "import React from 'react';\nimport { ChevronDownIcon, ChevronUpIcon } from '@100mslive/react-icons';\nimport { Dropdown, Flex, Text, textEllipsis } from '../../index';\n\nconst DialogDropdownTrigger = React.forwardRef(({ title, css, open, icon, titleCSS = {} }, ref) => {\n  return (\n    <Dropdown.Trigger\n      asChild\n      data-testid={`${title}_selector`}\n      css={{\n        border: '1px solid $border_bright',\n        bg: '$surface_bright',\n        r: '$1',\n        p: '$6 $9',\n        zIndex: 10,\n        ...css,\n      }}\n      ref={ref}\n    >\n      <Flex\n        css={{\n          display: 'flex',\n          justifyContent: 'space-between',\n          color: '$on_surface_high',\n          w: '100%',\n        }}\n      >\n        {icon}\n        <Text\n          css={{\n            color: 'inherit',\n            ...textEllipsis('90%'),\n            flex: '1 1 0',\n            mx: icon ? '$6' : '0',\n            ...titleCSS,\n          }}\n        >\n          {title}\n        </Text>\n        {open ? <ChevronUpIcon /> : <ChevronDownIcon />}\n      </Flex>\n    </Dropdown.Trigger>\n  );\n});\n\nexport { DialogDropdownTrigger };\n", "import { useEffect, useRef, useState } from 'react';\n\nexport const useAudioOutputTest = ({ deviceId }: { deviceId: string }) => {\n  const audioRef = useRef<HTMLAudioElement | null>(null);\n  const [playing, setPlaying] = useState(false);\n  useEffect(() => {\n    if (audioRef.current && deviceId) {\n      try {\n        // @ts-ignore\n        if (typeof audioRef.current.setSinkId !== 'undefined') {\n          // @ts-ignore\n          audioRef.current.setSinkId(deviceId);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  }, [deviceId]);\n  return { playing, setPlaying, audioRef };\n};\n", "export const useDropdownSelection = () => {\n  return '$surface_bright';\n};\n", "import React from 'react';\nimport { AlertOctagonIcon, HandIcon, PeopleAddIcon, PeopleRemoveIcon } from '@100mslive/react-icons';\nimport { Box } from '../../..';\nimport SwitchWithLabel from './SwitchWithLabel';\n// @ts-ignore: No implicit Any\nimport { useSetSubscribedNotifications, useSubscribedNotifications } from '../AppData/useUISettings';\nimport { settingOverflow } from './common';\nimport { SUBSCRIBED_NOTIFICATIONS } from '../../common/constants';\n\nconst NotificationItem = ({\n  type,\n  label,\n  icon,\n  checked,\n}: {\n  type: string;\n  label: string;\n  icon: React.ReactNode;\n  checked: boolean;\n}) => {\n  const [, setSubscribedNotifications] = useSetSubscribedNotifications(type);\n  return (\n    <SwitchWithLabel\n      label={label}\n      id={type}\n      icon={icon}\n      checked={checked}\n      onChange={value => {\n        setSubscribedNotifications(value);\n      }}\n    />\n  );\n};\n\nexport const NotificationSettings = () => {\n  const subscribedNotifications = useSubscribedNotifications();\n\n  return (\n    <Box className={settingOverflow()}>\n      <NotificationItem\n        label=\"Peer Joined\"\n        type={SUBSCRIBED_NOTIFICATIONS.PEER_JOINED}\n        icon={<PeopleAddIcon />}\n        checked={subscribedNotifications.PEER_JOINED}\n      />\n      <NotificationItem\n        label=\"Peer Leave\"\n        type={SUBSCRIBED_NOTIFICATIONS.PEER_LEFT}\n        icon={<PeopleRemoveIcon />}\n        checked={subscribedNotifications.PEER_LEFT}\n      />\n      <NotificationItem\n        label=\"Hand Raised\"\n        type={SUBSCRIBED_NOTIFICATIONS.METADATA_UPDATED}\n        icon={<HandIcon />}\n        checked={subscribedNotifications.METADATA_UPDATED}\n      />\n      <NotificationItem\n        label=\"Error\"\n        type={SUBSCRIBED_NOTIFICATIONS.ERROR}\n        icon={<AlertOctagonIcon />}\n        checked={subscribedNotifications.ERROR}\n      />\n    </Box>\n  );\n};\n", "import React from 'react';\nimport { selectIsTranscriptionEnabled, useHMSStore } from '@100mslive/react-sdk';\nimport { ClosedCaptionIcon, OpenCaptionIcon } from '@100mslive/react-icons';\nimport { Tooltip } from '../../Tooltip';\n// @ts-ignore: No implicit Any\nimport IconButton from '../IconButton';\n// @ts-ignore: No implicit Any\nimport { useSetIsCaptionEnabled } from './AppData/useUISettings.js';\n\nexport const CaptionIcon = () => {\n  const isCaptionPresent = useHMSStore(selectIsTranscriptionEnabled);\n  const [isCaption, setIsCaption] = useSetIsCaptionEnabled();\n\n  const onClick = () => {\n    setIsCaption(!isCaption);\n  };\n  if (!isCaptionPresent) {\n    return null;\n  }\n  return (\n    <Tooltip title={isCaption ? 'Hide closed captions' : 'Show closed captions'}>\n      <IconButton data-testid=\"caption_btn\" onClick={onClick}>\n        {isCaption ? <ClosedCaptionIcon width=\"20\" height=\"20px\" /> : <OpenCaptionIcon width=\"20\" height=\"20px\" />}\n      </IconButton>\n    </Tooltip>\n  );\n};\n", "import React, { useState } from 'react';\nimport { useMedia } from 'react-use';\nimport data from '@emoji-mart/data/sets/14/apple.json';\nimport { init } from 'emoji-mart';\nimport {\n  selectAvailableRoleNames,\n  selectIsConnectedToRoom,\n  selectLocalPeerID,\n  useCustomEvent,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { EmojiIcon } from '@100mslive/react-icons';\nimport { EmojiCard } from './Footer/EmojiCard';\n// import { ToastManager } from './Toast/ToastManager';\nimport { Dropdown } from '../../Dropdown';\nimport { Box } from '../../Layout';\nimport { config as cssConfig } from '../../Theme';\nimport { Tooltip } from '../../Tooltip';\nimport IconButton from '../IconButton';\nimport { useRoomLayoutConferencingScreen } from '../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useDropdownList } from './hooks/useDropdownList';\nimport { useLandscapeHLSStream, useMobileHLSStream } from '../common/hooks';\nimport { EMOJI_REACTION_TYPE } from '../common/constants';\n\ninit({ data });\n\nexport const EmojiReaction = ({ showCard = false }) => {\n  const [open, setOpen] = useState(false);\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const { elements } = useRoomLayoutConferencingScreen();\n  useDropdownList({ open: open, name: 'EmojiReaction' });\n  // const hmsActions = useHMSActions();\n  const roles = useHMSStore(selectAvailableRoleNames);\n  const localPeerId = useHMSStore(selectLocalPeerID);\n  // const { isStreamingOn } = useRecordingStreaming();\n  const isMobile = useMedia(cssConfig.media.md);\n  const isLandscape = useMedia(cssConfig.media.ls);\n  const isMobileHLSStream = useMobileHLSStream();\n  const isLandscapeStream = useLandscapeHLSStream();\n\n  const { sendEvent } = useCustomEvent({\n    type: EMOJI_REACTION_TYPE,\n  });\n\n  const sendReaction = async emojiId => {\n    const data = {\n      type: EMOJI_REACTION_TYPE,\n      emojiId: emojiId,\n      senderId: localPeerId,\n    };\n    // TODO: RT find a way to figure out hls-viewer roles\n    sendEvent(data, { roleNames: roles });\n    window.showFlyingEmoji?.({ emojiId, senderId: localPeerId });\n    /* if (isStreamingOn) {\n      try {\n        await hmsActions.sendHLSTimedMetadata([\n          {\n            payload: JSON.stringify(data),\n            duration: 2,\n          },\n        ]);\n      } catch (error) {\n        console.log(error);\n        ToastManager.addToast({ title: error.message });\n      }\n    } */\n  };\n\n  if (!isConnected || !elements.emoji_reactions) {\n    return null;\n  }\n\n  if (showCard) {\n    return <EmojiCard sendReaction={sendReaction} />;\n  }\n  return (\n    <Dropdown.Root open={open} onOpenChange={setOpen}>\n      <Dropdown.Trigger asChild data-testid=\"emoji_reaction_btn\">\n        <IconButton\n          css={\n            isMobile || isLandscape ? { bg: '$surface_default', r: '$round', border: '1px solid $border_bright' } : {}\n          }\n        >\n          <Tooltip title=\"Emoji reaction\">\n            <Box>\n              <EmojiIcon />\n            </Box>\n          </Tooltip>\n        </IconButton>\n      </Dropdown.Trigger>\n      <Dropdown.Content\n        sideOffset={5}\n        align={isMobileHLSStream || isLandscapeStream ? 'end' : 'center'}\n        css={{ p: '$8', bg: '$surface_default' }}\n      >\n        <EmojiCard sendReaction={sendReaction} />\n      </Dropdown.Content>\n    </Dropdown.Root>\n  );\n};\n", "import React from 'react';\nimport { Flex } from '../../../Layout';\nimport { styled } from '../../../Theme';\n\n// When changing emojis in the grid, keep in mind that the payload used in sendHLSTimedMetadata has a limit of 100 characters. Using bigger emoji Ids can cause the limit to be exceeded.\nconst emojiReactionList = [\n  [{ emojiId: '+1' }, { emojiId: '-1' }, { emojiId: 'wave' }, { emojiId: 'clap' }, { emojiId: 'fire' }],\n  [{ emojiId: 'tada' }, { emojiId: 'heart_eyes' }, { emojiId: 'joy' }, { emojiId: 'open_mouth' }, { emojiId: 'sob' }],\n];\n\nexport const EmojiCard = ({ sendReaction }) => {\n  return emojiReactionList.map((emojiLine, index) => (\n    <Flex key={index} justify=\"between\" css={{ mb: '$8' }}>\n      {emojiLine.map(emoji => (\n        <EmojiContainer key={emoji.emojiId} onClick={() => sendReaction(emoji.emojiId)}>\n          <em-emoji id={emoji.emojiId} size=\"100%\" set=\"apple\"></em-emoji>\n        </EmojiContainer>\n      ))}\n    </Flex>\n  ));\n};\n\nconst EmojiContainer = styled('span', {\n  position: 'relative',\n  cursor: 'pointer',\n  width: '$16',\n  height: '$16',\n  p: '$4',\n  '&:hover': {\n    p: '7px',\n    bg: '$surface_brighter',\n    borderRadius: '$1',\n  },\n});\n", "import { useEffect } from 'react';\n// @ts-ignore: No implicit Any\nimport { useSetAppDataByKey } from '../AppData/useUISettings';\nimport { APP_DATA } from '../../common/constants';\n\nexport const useDropdownList = ({ name, open }: { name: string; open: boolean }) => {\n  const [dropdownList = [], setDropdownList] = useSetAppDataByKey(APP_DATA.dropdownList);\n\n  useEffect(() => {\n    if (open) {\n      if (!dropdownList.includes(name)) {\n        setDropdownList([...dropdownList, name]);\n      }\n    } else {\n      const index = dropdownList.indexOf(name);\n      if (index >= 0) {\n        const newDropdownList = [...dropdownList];\n        newDropdownList.splice(index, 1);\n        setDropdownList(newDropdownList);\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [open, name]);\n};\n", "import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { HMSHLSPlayer } from '@100mslive/hls-player';\nimport { JoinForm_JoinBtnType } from '@100mslive/types-prebuilt/elements/join_form';\nimport {\n  HMSPeer,\n  HMSRecording,\n  parsedUserAgent,\n  selectAvailableRoleNames,\n  selectIsAllowedToPublish,\n  selectIsConnectedToRoom,\n  selectLocalPeerRole,\n  selectPeerCount,\n  selectPeerMetadata,\n  selectPeers,\n  selectPeersByRoles,\n  selectRecordingState,\n  selectRemotePeers,\n  selectRolesMap,\n  useHMSActions,\n  useHMSStore,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\n// @ts-ignore: No implicit any\nimport { ToastManager } from '../components/Toast/ToastManager';\nimport { config } from '../../Theme';\nimport { useRoomLayout } from '../provider/roomLayoutProvider';\n// @ts-ignore\nimport { useSetAppDataByKey } from '../components/AppData/useUISettings';\nimport { useRoomLayoutConferencingScreen } from '../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit any\nimport { isScreenshareSupported } from '../common/utils';\nimport { APP_DATA, CHAT_SELECTOR, RTMP_RECORD_DEFAULT_RESOLUTION } from './constants';\n/**\n * Hook to execute a callback when alone in room(after a certain 5d of time)\n * @param {number} thresholdMs The threshold(in ms) after which the callback is executed,\n * starting from the instant when alone in room.\n * note: the cb is not called when another peer joins during this period.\n */\nexport const useWhenAloneInRoom = (thresholdMs = 5 * 60 * 1000) => {\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const peerCount = useHMSStore(selectPeerCount);\n  const [aloneForLong, setAloneForLong] = useState(false);\n  const cbTimeout = useRef(null);\n  const alone = isConnected && peerCount === 1;\n\n  useEffect(() => {\n    if (alone && !cbTimeout.current) {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      cbTimeout.current = setTimeout(() => {\n        setAloneForLong(true);\n      }, thresholdMs);\n    } else if (!alone) {\n      cbTimeout.current && clearTimeout(cbTimeout.current);\n      cbTimeout.current = null;\n      setAloneForLong(false);\n    }\n  }, [alone, thresholdMs]);\n\n  useEffect(() => {\n    return () => {\n      if (cbTimeout.current) {\n        clearTimeout(cbTimeout.current);\n      }\n    };\n  }, []);\n\n  return { alone, aloneForLong };\n};\n\nexport const useFilteredRoles = () => {\n  const { elements } = useRoomLayoutConferencingScreen();\n  return elements?.chat?.roles_whitelist || [];\n};\n\nexport const useDefaultChatSelection = () => {\n  const { elements } = useRoomLayoutConferencingScreen();\n  const roles = useFilteredRoles();\n  // default is everyone for public chat\n  if (elements?.chat?.public_chat_enabled) {\n    return CHAT_SELECTOR.EVERYONE;\n  }\n  // sending first role as default\n  if (roles.length > 0) {\n    return roles[0];\n  }\n  // sending empty\n  return '';\n};\n\nexport const useShowStreamingUI = () => {\n  const layout = useRoomLayout();\n  const { join_form } = layout?.screens?.preview?.default?.elements || {};\n  return join_form?.join_btn_type === JoinForm_JoinBtnType.JOIN_BTN_TYPE_JOIN_AND_GO_LIVE;\n};\n\n// The search results should not have role name matches\nexport const useParticipants = (params?: { metadata?: { isHandRaised?: boolean }; role?: string; search?: string }) => {\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const peerCount = useHMSStore(selectPeerCount);\n  const availableRoles = useHMSStore(selectAvailableRoleNames);\n  let participantList = useHMSStore(isConnected ? selectPeers : selectRemotePeers);\n  const rolesWithParticipants = Array.from(new Set(participantList.map(peer => peer.roleName)));\n  const vanillaStore = useHMSVanillaStore();\n  if (params?.metadata?.isHandRaised) {\n    participantList = participantList.filter(peer => {\n      return vanillaStore.getState(selectPeerMetadata(peer.id)).isHandRaised;\n    });\n  }\n  if (params?.role && availableRoles.includes(params.role)) {\n    participantList = participantList.filter(peer => peer.roleName === params.role);\n  }\n  if (params?.search) {\n    const search = params.search;\n    // Removed peer.roleName?.toLowerCase().includes(search)\n    participantList = participantList.filter(peer => peer.name.toLowerCase().includes(search));\n  }\n  return { participants: participantList, isConnected, peerCount, rolesWithParticipants };\n};\n\nexport const useIsLandscape = () => {\n  const isMobile = parsedUserAgent.getDevice().type === 'mobile';\n  const isLandscape = useMedia(config.media.ls);\n  return isMobile && isLandscape;\n};\n\nexport const useLandscapeHLSStream = () => {\n  const isLandscape = useIsLandscape();\n  const { screenType } = useRoomLayoutConferencingScreen();\n  return isLandscape && screenType === 'hls_live_streaming';\n};\n\nexport const useMobileHLSStream = () => {\n  const isMobile = useMedia(config.media.md);\n  const { screenType } = useRoomLayoutConferencingScreen();\n  return isMobile && screenType === 'hls_live_streaming';\n};\n\nexport const useKeyboardHandler = (isPaused: boolean, hlsPlayer: HMSHLSPlayer) => {\n  const handleKeyEvent = useCallback(\n    async (event: KeyboardEvent) => {\n      switch (event.key) {\n        case ' ':\n          if (isPaused) {\n            await hlsPlayer?.play();\n          } else {\n            hlsPlayer?.pause();\n          }\n          break;\n        case 'ArrowRight':\n          hlsPlayer?.seekTo(hlsPlayer?.getVideoElement().currentTime + 10);\n          break;\n        case 'ArrowLeft':\n          hlsPlayer?.seekTo(hlsPlayer?.getVideoElement().currentTime - 10);\n          break;\n      }\n    },\n    [hlsPlayer, isPaused],\n  );\n\n  return handleKeyEvent;\n};\nexport interface RTMPRecordingResolution {\n  width: number;\n  height: number;\n}\nexport const useRecordingHandler = () => {\n  const hmsActions = useHMSActions();\n  const recordingState: HMSRecording = useHMSStore(selectRecordingState);\n  const [isRecordingLoading, setIsRecordingLoading] = useState(false);\n  const [recordingStarted, setRecordingState] = useSetAppDataByKey(APP_DATA.recordingStarted);\n  useEffect(() => {\n    if (recordingState.browser.error && recordingStarted) {\n      setRecordingState(false);\n    }\n  }, [recordingStarted, recordingState.browser.error, setRecordingState]);\n  const startRecording = useCallback(\n    async (resolution: RTMPRecordingResolution | null = null) => {\n      try {\n        setRecordingState(true);\n        setIsRecordingLoading(true);\n        await hmsActions.startRTMPOrRecording({\n          resolution: getResolution(resolution),\n          record: true,\n        });\n      } catch (error) {\n        const err = error as Error;\n        if (err.message.includes('stream already running')) {\n          ToastManager.addToast({\n            title: 'Recording already running',\n            variant: 'error',\n          });\n        } else {\n          ToastManager.addToast({\n            title: err.message,\n            variant: 'error',\n          });\n        }\n        setRecordingState(false);\n      }\n      setIsRecordingLoading(false);\n    },\n    [hmsActions, setRecordingState],\n  );\n  return {\n    recordingStarted,\n    startRecording,\n    isRecordingLoading,\n  };\n};\n\nexport function getResolution(\n  recordingResolution: RTMPRecordingResolution | null,\n): RTMPRecordingResolution | undefined {\n  if (!recordingResolution) {\n    return undefined;\n  }\n  const resolution: RTMPRecordingResolution = RTMP_RECORD_DEFAULT_RESOLUTION;\n  if (recordingResolution.width) {\n    resolution.width = recordingResolution.width;\n  }\n  if (recordingResolution.height) {\n    resolution.height = recordingResolution.height;\n  }\n  return resolution;\n}\n\nexport interface WaitingRoomInfo {\n  isNotAllowedToPublish: boolean;\n  isScreenOnlyPublishParams: boolean;\n  hasSubscribedRolePublishing: boolean;\n}\nexport function useWaitingRoomInfo(): WaitingRoomInfo {\n  const localPeerRole = useHMSStore(selectLocalPeerRole);\n  const { video, audio, screen } = useHMSStore(selectIsAllowedToPublish);\n  const isScreenShareAllowed = isScreenshareSupported();\n  const roles = useHMSStore(selectRolesMap);\n  const peersByRoles = useHMSStore(selectPeersByRoles(localPeerRole?.subscribeParams.subscribeToRoles || []));\n  // show no publish as screenshare in mweb is not possible\n  const isNotAllowedToPublish = !(video || audio || (screen && isScreenShareAllowed));\n  const isScreenOnlyPublishParams: boolean = screen && !(video || audio);\n  const hasSubscribedRolePublishing: boolean = useMemo(() => {\n    return peersByRoles.some((peer: HMSPeer) => {\n      if (peer.roleName && roles[peer.roleName] && !peer.isLocal) {\n        return !!roles[peer.roleName].publishParams?.allowed.length;\n      }\n      return false;\n    });\n  }, [peersByRoles, roles]);\n\n  return {\n    isNotAllowedToPublish,\n    isScreenOnlyPublishParams,\n    hasSubscribedRolePublishing,\n  };\n}\n", "import React from 'react';\nimport { useMedia } from 'react-use';\nimport { ConferencingScreen } from '@100mslive/types-prebuilt';\nimport {\n  HMSPeer,\n  HMSRole,\n  selectHLSState,\n  selectIsConnectedToRoom,\n  selectPeersByCondition,\n  selectPermissions,\n  selectRolesMap,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { config as cssConfig } from '../../../Theme';\n// @ts-ignore: No implicit Any\nimport { ToastManager } from '../Toast/ToastManager';\nimport { DesktopLeaveRoom } from './DesktopLeaveRoom';\nimport { MwebLeaveRoom } from './MwebLeaveRoom';\nimport { useLandscapeHLSStream, useMobileHLSStream } from '../../common/hooks';\n\nexport const LeaveRoom = ({\n  screenType,\n  container,\n}: {\n  screenType: keyof ConferencingScreen;\n  container?: HTMLElement;\n}) => {\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const permissions = useHMSStore(selectPermissions);\n  const isMobile = useMedia(cssConfig.media.md);\n  const rolesMap: Record<string, HMSRole> = useHMSStore(selectRolesMap);\n  const streamingPermissionRoles = Object.keys(rolesMap).filter(roleName => {\n    const roleObj = rolesMap[roleName];\n    return roleObj.permissions.hlsStreaming;\n  });\n  const peersWithStreamingRights = useHMSStore(\n    selectPeersByCondition((peer: HMSPeer) => streamingPermissionRoles.includes(peer.roleName || '')),\n  );\n  const hlsState = useHMSStore(selectHLSState);\n  const hmsActions = useHMSActions();\n  const isMobileHLSStream = useMobileHLSStream();\n  const isLandscapeHLSStream = useLandscapeHLSStream();\n\n  const stopStream = async () => {\n    try {\n      if (permissions?.hlsStreaming) {\n        console.log('Stopping HLS stream');\n        await hmsActions.stopHLSStreaming();\n        ToastManager.addToast({ title: 'Stopping the stream' });\n      }\n    } catch (e) {\n      console.error('Error stopping stream', e);\n      ToastManager.addToast({ title: 'Error in stopping the stream', type: 'error' });\n    }\n  };\n\n  const endRoom = async () => {\n    await hmsActions.endRoom(false, 'End Room');\n  };\n\n  const leaveRoom = async (options: { endStream?: boolean } = { endStream: false }) => {\n    if (options.endStream || (hlsState.running && peersWithStreamingRights.length === 1)) {\n      await stopStream();\n    }\n    await hmsActions.leave();\n  };\n\n  if (!permissions || !isConnected) {\n    return null;\n  }\n  if (isMobileHLSStream || isLandscapeHLSStream) {\n    return <MwebLeaveRoom leaveRoom={leaveRoom} endRoom={endRoom} container={container} />;\n  }\n  return isMobile ? (\n    <MwebLeaveRoom leaveRoom={leaveRoom} endRoom={endRoom} container={container} />\n  ) : (\n    <DesktopLeaveRoom leaveRoom={leaveRoom} screenType={screenType} endRoom={endRoom} container={container} />\n  );\n};\n", "import React, { Fragment, useState } from 'react';\nimport { ConferencingScreen } from '@100mslive/types-prebuilt';\nimport { selectIsConnectedToRoom, selectPermissions, useHMSStore, useRecordingStreaming } from '@100mslive/react-sdk';\nimport { ExitIcon, StopIcon, VerticalMenuIcon } from '@100mslive/react-icons';\nimport { Dropdown } from '../../../Dropdown';\nimport { Box, Flex } from '../../../Layout';\nimport { Dialog } from '../../../Modal';\nimport { Tooltip } from '../../../Tooltip';\nimport { EndSessionContent } from './EndSessionContent';\nimport { LeaveIconButton, MenuTriggerButton } from './LeaveAtoms';\nimport { LeaveCard } from './LeaveCard';\nimport { LeaveSessionContent } from './LeaveSessionContent';\n// @ts-ignore: No implicit Any\nimport { useDropdownList } from '../hooks/useDropdownList';\n\nexport const DesktopLeaveRoom = ({\n  leaveRoom,\n  screenType,\n  endRoom,\n  container,\n}: {\n  leaveRoom: (options?: { endStream?: boolean }) => Promise<void>;\n  screenType: keyof ConferencingScreen;\n  endRoom: () => Promise<void>;\n  container?: HTMLElement;\n}) => {\n  const [open, setOpen] = useState(false);\n  const [showLeaveRoomAlert, setShowLeaveRoomAlert] = useState(false);\n  const [showEndStreamAlert, setShowEndStreamAlert] = useState(false);\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const permissions = useHMSStore(selectPermissions);\n  const { isStreamingOn } = useRecordingStreaming();\n  const showStream = screenType !== 'hls_live_streaming' && isStreamingOn && permissions?.hlsStreaming;\n  const showLeaveOptions = (permissions?.hlsStreaming && isStreamingOn) || permissions?.endRoom;\n\n  useDropdownList({ open: open || showEndStreamAlert || showLeaveRoomAlert, name: 'LeaveRoom' });\n\n  if (!permissions || !isConnected) {\n    return null;\n  }\n\n  return (\n    <Fragment>\n      {showLeaveOptions ? (\n        <Flex>\n          <LeaveIconButton\n            key=\"LeaveRoom\"\n            data-testid=\"leave_room_btn\"\n            css={{\n              borderTopRightRadius: 0,\n              borderBottomRightRadius: 0,\n            }}\n            onClick={() => setShowLeaveRoomAlert(true)}\n          >\n            <Tooltip title=\"Leave Room\">\n              <Box>\n                <ExitIcon style={{ transform: 'rotate(180deg)' }} />\n              </Box>\n            </Tooltip>\n          </LeaveIconButton>\n          <Dropdown.Root open={open} onOpenChange={setOpen} modal={false}>\n            <Dropdown.Trigger\n              asChild\n              css={{\n                '&[data-state=\"open\"]': {\n                  bg: '$alert_error_dim',\n                },\n              }}\n            >\n              <MenuTriggerButton data-testid=\"leave_end_dropdown_trigger\">\n                <VerticalMenuIcon />\n              </MenuTriggerButton>\n            </Dropdown.Trigger>\n            <Dropdown.Portal container={container}>\n              <Dropdown.Content css={{ p: 0, w: '$100' }} alignOffset={-50} sideOffset={10}>\n                <Dropdown.Item\n                  css={{\n                    bg: '$surface_dim',\n                    color: '$on_surface_medium',\n                    '&:hover': { bg: '$surface_default', color: '$on_surface_high' },\n                    p: '0',\n                  }}\n                  data-testid=\"just_leave_btn\"\n                >\n                  <LeaveCard\n                    title={showStream ? 'Leave Stream' : 'Leave Session'}\n                    subtitle={`Others will continue after you leave. You can join the ${\n                      showStream ? 'stream' : 'session'\n                    } again.`}\n                    bg=\"\"\n                    titleColor=\"$on_surface_high\"\n                    icon={<ExitIcon height={24} width={24} style={{ transform: 'rotate(180deg)' }} />}\n                    onClick={async () => await leaveRoom()}\n                    css={{ p: '$8 $4' }}\n                  />\n                </Dropdown.Item>\n\n                <Dropdown.Item\n                  css={{\n                    bg: '$alert_error_dim',\n                    color: '$alert_error_bright',\n                    '&:hover': { bg: '$alert_error_dim', color: '$alert_error_brighter' },\n                    p: '0',\n                  }}\n                  data-testid=\"end_room_btn\"\n                >\n                  <LeaveCard\n                    title={showStream ? 'End Stream' : 'End Session'}\n                    subtitle={`The ${\n                      showStream ? 'stream' : 'session'\n                    } will end for everyone. You can't undo this action.`}\n                    bg=\"\"\n                    titleColor=\"$alert_error_brighter\"\n                    icon={<StopIcon height={24} width={24} />}\n                    onClick={() => {\n                      setOpen(false);\n                      setShowEndStreamAlert(true);\n                    }}\n                    css={{ p: '$8 $4' }}\n                  />\n                </Dropdown.Item>\n              </Dropdown.Content>\n            </Dropdown.Portal>\n          </Dropdown.Root>\n        </Flex>\n      ) : (\n        <LeaveIconButton\n          onClick={() => {\n            setShowLeaveRoomAlert(true);\n          }}\n          key=\"LeaveRoom\"\n          data-testid=\"leave_room_btn\"\n        >\n          <Tooltip title=\"Leave Room\">\n            <Box>\n              <ExitIcon style={{ transform: 'rotate(180deg)' }} />\n            </Box>\n          </Tooltip>\n        </LeaveIconButton>\n      )}\n\n      <Dialog.Root open={showEndStreamAlert} modal={false}>\n        <Dialog.Portal>\n          <Dialog.Overlay />\n          <Dialog.Content css={{ w: 'min(420px, 90%)', p: '$8', bg: '$surface_dim' }}>\n            <EndSessionContent\n              setShowEndStreamAlert={setShowEndStreamAlert}\n              leaveRoom={isStreamingOn ? () => leaveRoom({ endStream: true }) : endRoom}\n              isStreamingOn={isStreamingOn}\n              isModal\n            />\n          </Dialog.Content>\n        </Dialog.Portal>\n      </Dialog.Root>\n\n      <Dialog.Root open={showLeaveRoomAlert} modal={false}>\n        <Dialog.Portal>\n          <Dialog.Overlay />\n          <Dialog.Content css={{ w: 'min(420px, 90%)', p: '$8', bg: '$surface_dim' }}>\n            <LeaveSessionContent setShowLeaveRoomAlert={setShowLeaveRoomAlert} leaveRoom={leaveRoom} isModal />\n          </Dialog.Content>\n        </Dialog.Portal>\n      </Dialog.Root>\n    </Fragment>\n  );\n};\n", "import React from 'react';\nimport { AlertTriangleIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Button } from '../../../Button';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\n\nexport const EndSessionContent = ({\n  setShowEndStreamAlert,\n  leaveRoom,\n  isModal = false,\n  isStreamingOn = false,\n}: {\n  setShowEndStreamAlert: (value: boolean) => void;\n  leaveRoom: (options?: { endStream?: boolean }) => Promise<void>;\n  isModal?: boolean;\n  isStreamingOn: boolean;\n}) => {\n  return (\n    <Box>\n      <Flex\n        css={{\n          color: '$alert_error_default',\n          display: 'flex',\n          alignItems: 'center',\n        }}\n      >\n        <AlertTriangleIcon style={{ marginRight: '0.5rem' }} />\n        <Text variant=\"lg\" css={{ color: 'inherit', fontWeight: '$semiBold' }}>\n          End {isStreamingOn ? 'Stream' : 'Session'}\n        </Text>\n        {isModal ? null : (\n          <Box css={{ color: '$on_surface_high', ml: 'auto' }} onClick={() => setShowEndStreamAlert(false)}>\n            <CrossIcon />\n          </Box>\n        )}\n      </Flex>\n      <Text variant=\"sm\" css={{ color: '$on_surface_medium', mb: '$8', mt: '$4' }}>\n        The {isStreamingOn ? 'stream' : 'session'} will end for everyone. You can't undo this action.\n      </Text>\n      <Flex align=\"center\" justify=\"between\" css={{ w: '100%', gap: '$8' }}>\n        <Button\n          outlined\n          variant=\"standard\"\n          css={{ w: '100%', '@md': { display: 'none' } }}\n          onClick={() => setShowEndStreamAlert(false)}\n        >\n          Cancel\n        </Button>\n        <Button\n          variant=\"danger\"\n          css={{ w: '100%' }}\n          onClick={async () => {\n            await leaveRoom({ endStream: true });\n            setShowEndStreamAlert(false);\n          }}\n          id=\"stopStream\"\n          data-testid=\"stop_stream_btn\"\n        >\n          End {isStreamingOn ? 'Stream' : 'Session'}\n        </Button>\n      </Flex>\n    </Box>\n  );\n};\n", "import { IconButton } from '../../../IconButton';\nimport { styled } from '../../../Theme';\n\nexport const LeaveIconButton = styled(IconButton, {\n  color: '$on_primary_high',\n  h: '$14',\n  px: '$4',\n  r: '$1',\n  bg: '$alert_error_default',\n  '&:not([disabled]):hover': {\n    bg: '$alert_error_bright',\n  },\n  '&:not([disabled]):active': {\n    bg: '$alert_error_default',\n  },\n  '@md': {\n    mx: 0,\n  },\n});\n\nexport const MenuTriggerButton = styled(LeaveIconButton, {\n  borderLeft: '1px solid $alert_error_dim',\n  borderTopLeftRadius: 0,\n  borderBottomLeftRadius: 0,\n  px: '$2',\n});\n", "import React from 'react';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { CSS } from '../../../Theme';\n\nexport const LeaveCard = ({\n  icon,\n  title,\n  subtitle,\n  onClick,\n  bg,\n  titleColor,\n  css = {},\n}: {\n  icon: React.JSX.Element;\n  title: string;\n  subtitle: string;\n  onClick: () => void;\n  titleColor: string;\n  bg: string;\n  css?: CSS;\n}) => {\n  return (\n    <Flex css={{ p: '$10', flexGrow: 1, gap: '$8', bg, ...css }} onClick={onClick}>\n      <Box css={{ color: titleColor }}>{icon}</Box>\n      <Box css={{ gap: '$2' }}>\n        <Text variant=\"lg\" css={{ color: titleColor }}>\n          {title}\n        </Text>\n        <Text variant=\"sm\" css={{ c: 'inherit' }}>\n          {subtitle}\n        </Text>\n      </Box>\n    </Flex>\n  );\n};\n", "import React from 'react';\nimport { AlertTriangleIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Button } from '../../../Button';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\n\nexport const LeaveSessionContent = ({\n  setShowLeaveRoomAlert,\n  leaveRoom,\n  isModal = false,\n}: {\n  setShowLeaveRoomAlert: (value: boolean) => void;\n  leaveRoom: (options?: { endStream?: boolean }) => Promise<void>;\n  isModal?: boolean;\n}) => {\n  return (\n    <Box>\n      <Flex\n        css={{\n          color: '$alert_error_default',\n          display: 'flex',\n          alignItems: 'center',\n        }}\n      >\n        <AlertTriangleIcon style={{ marginRight: '0.5rem' }} />\n        <Text variant=\"lg\" css={{ color: 'inherit', fontWeight: '$semiBold' }}>\n          Leave\n        </Text>\n        {isModal ? null : (\n          <Box css={{ color: '$on_surface_high', ml: 'auto' }} onClick={() => setShowLeaveRoomAlert(false)}>\n            <CrossIcon />\n          </Box>\n        )}\n      </Flex>\n      <Text variant=\"sm\" css={{ color: '$on_surface_low', mb: '$8', mt: '$4' }}>\n        Others will continue after you leave. You can join the session again.\n      </Text>\n      <Flex align=\"center\" justify=\"between\" css={{ w: '100%', gap: '$8' }}>\n        <Button\n          outlined\n          variant=\"standard\"\n          css={{ w: '100%', '@md': { display: 'none' } }}\n          onClick={() => setShowLeaveRoomAlert(false)}\n        >\n          Cancel\n        </Button>\n        <Button\n          variant=\"danger\"\n          css={{ w: '100%' }}\n          onClick={async () => {\n            await leaveRoom();\n          }}\n          id=\"leaveRoom\"\n          data-testid=\"leave_room\"\n        >\n          Leave Session\n        </Button>\n      </Flex>\n    </Box>\n  );\n};\n", "import React, { Fragment, useState } from 'react';\n// @ts-ignore: No implicit Any\nimport { selectIsConnectedToRoom, selectPermissions, useHMSStore, useRecordingStreaming } from '@100mslive/react-sdk';\n// @ts-ignore: No implicit Any\nimport { CrossIcon, ExitIcon, StopIcon } from '@100mslive/react-icons';\nimport { IconButton } from '../../../IconButton';\nimport { Box } from '../../../Layout';\nimport { Sheet } from '../../../Sheet';\nimport { Tooltip } from '../../../Tooltip';\nimport { EndSessionContent } from './EndSessionContent';\nimport { LeaveIconButton } from './LeaveAtoms';\nimport { LeaveCard } from './LeaveCard';\nimport { LeaveSessionContent } from './LeaveSessionContent';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { useDropdownList } from '../hooks/useDropdownList';\nimport { useLandscapeHLSStream, useMobileHLSStream } from '../../common/hooks';\n\nexport const MwebLeaveRoom = ({\n  leaveRoom,\n  endRoom,\n  container,\n}: {\n  leaveRoom: (options?: { endStream?: boolean }) => Promise<void>;\n  endRoom: () => Promise<void>;\n  container?: HTMLElement;\n}) => {\n  const [open, setOpen] = useState(false);\n  const { screenType } = useRoomLayoutConferencingScreen();\n  const [showLeaveRoomAlert, setShowLeaveRoomAlert] = useState(false);\n  const [showEndStreamAlert, setShowEndStreamAlert] = useState(false);\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const permissions = useHMSStore(selectPermissions);\n  const { isStreamingOn } = useRecordingStreaming();\n  const showStream = screenType !== 'hls_live_streaming' && isStreamingOn && permissions?.hlsStreaming;\n  const showLeaveOptions = (permissions?.hlsStreaming && isStreamingOn) || permissions?.endRoom;\n\n  useDropdownList({ open, name: 'LeaveRoom' });\n\n  if (!permissions || !isConnected) {\n    return null;\n  }\n\n  return (\n    <Fragment>\n      {showLeaveOptions ? (\n        <Sheet.Root open={open} onOpenChange={setOpen}>\n          <Sheet.Trigger asChild>\n            <LeaveButton\n              onClick={() => {\n                setOpen(open => !open);\n              }}\n            />\n          </Sheet.Trigger>\n          <Sheet.Content container={container}>\n            <LeaveCard\n              title={showStream ? 'Leave Stream' : 'Leave Session'}\n              subtitle={`Others will continue after you leave. You can join the ${\n                showStream ? 'stream' : 'session'\n              } again.`}\n              bg=\"$surface_default\"\n              titleColor=\"$on_surface_high\"\n              icon={<ExitIcon height={24} width={24} style={{ transform: 'rotate(180deg)' }} />}\n              onClick={async () => await leaveRoom()}\n              css={{ pt: 0, mt: '$10', color: '$on_surface_low', '&:hover': { color: '$on_surface_high' } }}\n            />\n\n            <LeaveCard\n              title={showStream ? 'End Stream' : 'End Session'}\n              subtitle={`The will end the ${\n                showStream ? 'stream' : 'session'\n              } for everyone. You can't undo this action.`}\n              bg=\"$alert_error_dim\"\n              titleColor=\"$alert_error_brighter\"\n              css={{ color: '$alert_error_bright', '&:hover': { color: '$alert_error_brighter' } }}\n              icon={<StopIcon height={24} width={24} />}\n              onClick={() => {\n                setOpen(false);\n                setShowEndStreamAlert(true);\n              }}\n            />\n          </Sheet.Content>\n        </Sheet.Root>\n      ) : (\n        <LeaveButton onClick={() => setShowLeaveRoomAlert(true)} />\n      )}\n      <Sheet.Root open={showEndStreamAlert} onOpenChange={setShowEndStreamAlert}>\n        <Sheet.Content css={{ bg: '$surface_dim', p: '$10', pb: '$12' }} container={container}>\n          <EndSessionContent\n            setShowEndStreamAlert={setShowEndStreamAlert}\n            leaveRoom={isStreamingOn ? leaveRoom : endRoom}\n            isStreamingOn={isStreamingOn}\n          />\n        </Sheet.Content>\n      </Sheet.Root>\n\n      <Sheet.Root open={showLeaveRoomAlert} onOpenChange={setShowLeaveRoomAlert}>\n        <Sheet.Content css={{ bg: '$surface_dim', p: '$10', pb: '$12' }} container={container}>\n          <LeaveSessionContent setShowLeaveRoomAlert={setShowLeaveRoomAlert} leaveRoom={leaveRoom} />\n        </Sheet.Content>\n      </Sheet.Root>\n    </Fragment>\n  );\n};\n\nconst LeaveButton = ({ onClick }: { onClick: () => void }) => {\n  const isMobileHLSStream = useMobileHLSStream();\n  const isLandscapeHLSStream = useLandscapeHLSStream();\n\n  return isMobileHLSStream || isLandscapeHLSStream ? (\n    <IconButton key=\"LeaveRoom\" data-testid=\"leave_room_btn\" onClick={onClick}>\n      <Tooltip title=\"Leave Room\">\n        <Box>\n          <CrossIcon />\n        </Box>\n      </Tooltip>\n    </IconButton>\n  ) : (\n    <LeaveIconButton\n      key=\"LeaveRoom\"\n      data-testid=\"leave_room_btn\"\n      css={{\n        borderTopRightRadius: '$1',\n        borderBottomRightRadius: '$1',\n      }}\n      onClick={onClick}\n    >\n      <Tooltip title=\"Leave Room\">\n        <Box>\n          <ExitIcon style={{ transform: 'rotate(180deg)' }} />\n        </Box>\n      </Tooltip>\n    </LeaveIconButton>\n  );\n};\n", "import React from 'react';\nimport { useMedia } from 'react-use';\nimport {\n  ConferencingScreen,\n  DefaultConferencingScreen_Elements,\n  HLSLiveStreamingScreen_Elements,\n} from '@100mslive/types-prebuilt';\n// @ts-ignore: No implicit Any\nimport { DesktopOptions } from './SplitComponents/DesktopOptions';\n// @ts-ignore: No implicit Any\nimport { MwebOptions } from './SplitComponents/MwebOptions';\nimport { config as cssConfig } from '../../..';\nimport { useLandscapeHLSStream } from '../../common/hooks';\n\nexport const MoreSettings = ({\n  elements,\n  screenType,\n}: {\n  elements: DefaultConferencingScreen_Elements | HLSLiveStreamingScreen_Elements;\n  screenType: keyof ConferencingScreen;\n}) => {\n  const isMobile = useMedia(cssConfig.media.md);\n  const isLandscapeHLSStream = useLandscapeHLSStream();\n  return isMobile || isLandscapeHLSStream ? (\n    <MwebOptions elements={elements} screenType={screenType} />\n  ) : (\n    <DesktopOptions elements={elements} screenType={screenType} />\n  );\n};\n", "import React, { Fragment, useState } from 'react';\nimport { HMSHLSPlayer } from '@100mslive/hls-player';\nimport {\n  ConferencingScreen,\n  DefaultConferencingScreen_Elements,\n  HLSLiveStreamingScreen_Elements,\n} from '@100mslive/types-prebuilt';\nimport { match } from 'ts-pattern';\nimport {\n  HMSTranscriptionMode,\n  selectAppData,\n  selectIsTranscriptionAllowedByMode,\n  selectIsTranscriptionEnabled,\n  selectLocalPeerID,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport {\n  BrbIcon,\n  CheckIcon,\n  HamburgerMenuIcon,\n  InfoIcon,\n  OpenCaptionIcon,\n  PipIcon,\n  SettingsIcon,\n} from '@100mslive/react-icons';\nimport { Checkbox, Dropdown, Flex, Switch, Text, Tooltip } from '../../../..';\nimport IconButton from '../../../IconButton';\n// @ts-ignore: No implicit any\nimport { PIP } from '../../PIP';\nimport { PIPChat } from '../../PIP/PIPChat';\n// @ts-ignore: No implicit any\nimport { PIPChatOption } from '../../PIP/PIPChatOption';\nimport { PictureInPicture } from '../../PIP/PIPManager';\nimport { PIPWindow } from '../../PIP/PIPWindow';\n// @ts-ignore: No implicit any\nimport { RoleChangeModal } from '../../RoleChangeModal';\n// @ts-ignore: No implicit any\nimport SettingsModal from '../../Settings/SettingsModal';\n// @ts-ignore: No implicit any\nimport StartRecording from '../../Settings/StartRecording';\n// @ts-ignore: No implicit any\nimport { StatsForNerds } from '../../StatsForNerds';\n// @ts-ignore: No implicit any\nimport { BulkRoleChangeModal } from '../BulkRoleChangeModal';\nimport { CaptionModal } from '../CaptionModal';\n// @ts-ignore: No implicit any\nimport { FullScreenItem } from '../FullScreenItem';\nimport { MuteAllModal } from '../MuteAllModal';\n// @ts-ignore: No implicit any\nimport { useIsSidepaneTypeOpen, useSidepaneToggle } from '../../AppData/useSidepane';\n// @ts-ignore: No implicit any\nimport { useDropdownList } from '../../hooks/useDropdownList';\nimport { useMyMetadata } from '../../hooks/useMetadata';\n// @ts-ignore: No implicit any\nimport { usePIPChat } from '../../PIP/usePIPChat';\n// @ts-ignore: No implicit any\nimport { APP_DATA, isMacOS, SIDE_PANE_OPTIONS } from '../../../common/constants';\n\nconst MODALS = {\n  CHANGE_NAME: 'changeName',\n  SELF_ROLE_CHANGE: 'selfRoleChange',\n  MORE_SETTINGS: 'moreSettings',\n  START_RECORDING: 'startRecording',\n  DEVICE_SETTINGS: 'deviceSettings',\n  STATS_FOR_NERDS: 'statsForNerds',\n  BULK_ROLE_CHANGE: 'bulkRoleChange',\n  MUTE_ALL: 'muteAll',\n  EMBED_URL: 'embedUrl',\n  CAPTION: 'caption',\n};\n\nexport const DesktopOptions = ({\n  elements,\n  screenType,\n}: {\n  elements: DefaultConferencingScreen_Elements & HLSLiveStreamingScreen_Elements;\n  screenType: keyof ConferencingScreen;\n}) => {\n  const localPeerId = useHMSStore(selectLocalPeerID);\n  const hmsActions = useHMSActions();\n  const enablHlsStats = useHMSStore(selectAppData(APP_DATA.hlsStats));\n  const [openModals, setOpenModals] = useState(new Set());\n  const { isBRBOn, toggleBRB } = useMyMetadata();\n  const isPipOn = PictureInPicture.isOn();\n  const isBRBEnabled = !!elements?.brb;\n  const isTranscriptionAllowed = useHMSStore(selectIsTranscriptionAllowedByMode(HMSTranscriptionMode.CAPTION));\n  const isTranscriptionEnabled = useHMSStore(selectIsTranscriptionEnabled);\n  const { isSupported, pipWindow, requestPipWindow } = usePIPChat();\n  const isChatOpen = useIsSidepaneTypeOpen(SIDE_PANE_OPTIONS.CHAT);\n  const toggleChat = useSidepaneToggle(SIDE_PANE_OPTIONS.CHAT);\n  // Hide if pip chat is already open\n  const showPipChatOption = !!elements?.chat && isSupported && !pipWindow;\n\n  useDropdownList({ open: openModals.size > 0, name: 'MoreSettings' });\n\n  const updateState = (modalName: string, value: boolean) => {\n    setOpenModals(modals => {\n      const copy = new Set(modals);\n      if (value) {\n        // avoiding extra set state trigger which removes currently open dialog by clearing set.\n        copy.clear();\n        copy.add(modalName);\n      } else {\n        copy.delete(modalName);\n      }\n      return copy;\n    });\n  };\n\n  return (\n    <Fragment>\n      {isSupported && pipWindow ? (\n        <PIPWindow pipWindow={pipWindow}>\n          <PIPChat />\n        </PIPWindow>\n      ) : null}\n      <Dropdown.Root\n        open={openModals.has(MODALS.MORE_SETTINGS)}\n        onOpenChange={value => updateState(MODALS.MORE_SETTINGS, value)}\n        modal={false}\n      >\n        <Tooltip title=\"More options\">\n          <Dropdown.Trigger asChild data-testid=\"more_settings_btn\">\n            <IconButton>\n              <HamburgerMenuIcon />\n            </IconButton>\n          </Dropdown.Trigger>\n        </Tooltip>\n\n        <Dropdown.Content\n          sideOffset={5}\n          align=\"end\"\n          css={{\n            py: '$0',\n            maxHeight: 'unset',\n            '@md': { w: '$64' },\n            \"div[role='separator']:first-child\": {\n              display: 'none',\n            },\n          }}\n        >\n          {isBRBEnabled && screenType !== 'hls_live_streaming' ? (\n            <Dropdown.Item onClick={toggleBRB} data-testid=\"brb_btn\">\n              <BrbIcon />\n              <Text variant=\"sm\" css={{ ml: '$4', color: '$on_surface_high' }}>\n                Be Right Back\n              </Text>\n              <Flex justify=\"end\" css={{ color: '$on_surface_high', flexGrow: '1' }}>\n                {isBRBOn ? <CheckIcon /> : null}\n              </Flex>\n            </Dropdown.Item>\n          ) : null}\n          {isTranscriptionAllowed ? (\n            <Dropdown.Item\n              data-testid=\"closed_caption_admin\"\n              onClick={() => {\n                updateState(MODALS.CAPTION, true);\n              }}\n            >\n              <OpenCaptionIcon />\n              <Flex direction=\"column\" css={{ flexGrow: '1' }}>\n                <Text variant=\"sm\" css={{ ml: '$4', color: '$on_surface_high' }}>\n                  Closed Captions\n                </Text>\n                <Text variant=\"caption\" css={{ ml: '$4', color: '$on_surface_medium' }}>\n                  {isTranscriptionEnabled ? 'Enabled' : 'Disabled'}\n                </Text>\n              </Flex>\n              <Switch id=\"closed_caption_start_stop\" checked={isTranscriptionEnabled} disabled={false} />\n            </Dropdown.Item>\n          ) : null}\n          {screenType !== 'hls_live_streaming' ? (\n            <Dropdown.Item css={{ p: 0, '&:empty': { display: 'none' } }}>\n              <PIP\n                content={\n                  <Flex css={{ w: '100%', h: '100%', p: '$8' }}>\n                    <PipIcon />\n                    <Text variant=\"sm\" css={{ ml: '$4' }}>\n                      {isPipOn ? 'Disable' : 'Enable'} Picture-in-Picture\n                    </Text>\n                  </Flex>\n                }\n              />\n            </Dropdown.Item>\n          ) : null}\n\n          <PIPChatOption\n            showPIPChat={showPipChatOption}\n            openChat={async () => {\n              isChatOpen && toggleChat();\n              await requestPipWindow(350, 500);\n            }}\n          />\n          <FullScreenItem />\n          <Dropdown.ItemSeparator css={{ mx: 0 }} />\n          <Dropdown.Item onClick={() => updateState(MODALS.DEVICE_SETTINGS, true)} data-testid=\"device_settings_btn\">\n            <SettingsIcon />\n            <Text variant=\"sm\" css={{ ml: '$4' }}>\n              Settings\n            </Text>\n          </Dropdown.Item>\n          {match({ screenType, isSupported: HMSHLSPlayer.isSupported() })\n            .with({ screenType: 'hls_live_streaming', isSupported: false }, () => null)\n            .with({ screenType: 'hls_live_streaming', isSupported: true }, () => {\n              return (\n                <Dropdown.Item\n                  onClick={() => hmsActions.setAppData(APP_DATA.hlsStats, !enablHlsStats)}\n                  data-testid=\"hls_stats\"\n                >\n                  <Checkbox.Root\n                    css={{ margin: '$2' }}\n                    checked={enablHlsStats}\n                    onCheckedChange={() => hmsActions.setAppData(APP_DATA.hlsStats, !enablHlsStats)}\n                  >\n                    <Checkbox.Indicator>\n                      <CheckIcon width={16} height={16} />\n                    </Checkbox.Indicator>\n                  </Checkbox.Root>\n                  <Flex justify=\"between\" css={{ width: '100%' }}>\n                    <Text variant=\"sm\" css={{ ml: '$4' }}>\n                      Show HLS Stats\n                    </Text>\n\n                    <Text variant=\"sm\" css={{ ml: '$4' }}>\n                      {`${isMacOS ? '\u2318' : 'ctrl'} + ]`}\n                    </Text>\n                  </Flex>\n                </Dropdown.Item>\n              );\n            })\n            .otherwise(() => (\n              <Dropdown.Item\n                onClick={() => updateState(MODALS.STATS_FOR_NERDS, true)}\n                data-testid=\"stats_for_nerds_btn\"\n              >\n                <InfoIcon />\n                <Text variant=\"sm\" css={{ ml: '$4' }}>\n                  Stats for Nerds\n                </Text>\n              </Dropdown.Item>\n            ))}\n        </Dropdown.Content>\n      </Dropdown.Root>\n      {openModals.has(MODALS.BULK_ROLE_CHANGE) && (\n        <BulkRoleChangeModal onOpenChange={(value: boolean) => updateState(MODALS.BULK_ROLE_CHANGE, value)} />\n      )}\n      {openModals.has(MODALS.MUTE_ALL) && (\n        <MuteAllModal onOpenChange={(value: boolean) => updateState(MODALS.MUTE_ALL, value)} />\n      )}\n\n      {openModals.has(MODALS.START_RECORDING) && (\n        <StartRecording open onOpenChange={(value: boolean) => updateState(MODALS.START_RECORDING, value)} />\n      )}\n      {openModals.has(MODALS.DEVICE_SETTINGS) && (\n        <SettingsModal\n          open\n          onOpenChange={(value: boolean) => updateState(MODALS.DEVICE_SETTINGS, value)}\n          screenType={screenType}\n        />\n      )}\n      {openModals.has(MODALS.STATS_FOR_NERDS) && (\n        <StatsForNerds open onOpenChange={(value: boolean) => updateState(MODALS.STATS_FOR_NERDS, value)} />\n      )}\n      {openModals.has(MODALS.SELF_ROLE_CHANGE) && (\n        <RoleChangeModal\n          peerId={localPeerId}\n          onOpenChange={(value: boolean) => updateState(MODALS.SELF_ROLE_CHANGE, value)}\n        />\n      )}\n      {openModals.has(MODALS.CAPTION) && (\n        <CaptionModal onOpenChange={(value: boolean) => updateState(MODALS.CAPTION, value)} />\n      )}\n      {/* {openModals.has(MODALS.EMBED_URL) && (\n        <EmbedUrlModal onOpenChange={value => updateState(MODALS.EMBED_URL, value)} />\n      )} */}\n    </Fragment>\n  );\n};\n", "import React from 'react';\nimport PIPComponent from './PIPComponent';\n\nexport const PIP = ({ content = null }) => {\n  return <PIPComponent content={content} />;\n};\n", "import React, { useCallback, useEffect, useState } from 'react';\nimport { selectPeers, selectTracksMap, useHMSActions, useHMSVanillaStore } from '@100mslive/react-sdk';\nimport { PipIcon } from '@100mslive/react-icons';\nimport { Flex, Tooltip } from '../../..';\nimport IconButton from '../../IconButton';\nimport { PictureInPicture } from './PIPManager';\n// @ts-ignore: No implicit Any\nimport { MediaSession } from './SetupMediaSession';\n// @ts-ignore: No implicit Any\nimport { usePinnedTrack } from '../AppData/useUISettings';\n\n/**\n * shows a button which when clicked shows some videos in PIP, clicking\n * again turns it off.\n */\nconst PIPComponent = ({ content = null }) => {\n  const [isPipOn, setIsPipOn] = useState(PictureInPicture.isOn());\n  const hmsActions = useHMSActions();\n  const store = useHMSVanillaStore();\n\n  const onPipToggle = useCallback(() => {\n    if (!isPipOn) {\n      PictureInPicture.start(hmsActions, setIsPipOn).catch(err => console.error('error in starting pip', err));\n      MediaSession.setup(hmsActions, store);\n    } else {\n      PictureInPicture.stop().catch(err => console.error('error in stopping pip', err));\n    }\n  }, [hmsActions, isPipOn, store]);\n\n  if (!PictureInPicture.isSupported()) {\n    return null;\n  }\n  return (\n    <>\n      {content ? (\n        <Flex css={{ w: '100%' }} onClick={() => onPipToggle()} data-testid=\"pip_btn\">\n          {content}\n        </Flex>\n      ) : (\n        <Tooltip title={`${isPipOn ? 'Deactivate' : 'Activate'} picture in picture view`}>\n          <IconButton active={!isPipOn} key=\"pip\" onClick={() => onPipToggle()} data-testid=\"pip_btn\">\n            <PipIcon />\n          </IconButton>\n        </Tooltip>\n      )}\n    </>\n  );\n};\n\n/**\n * this is a separate component so it can be conditionally rendered and\n * the subscriptions to store are done only if required.\n */\nexport const ActivatedPIP = () => {\n  const store = useHMSVanillaStore();\n  const pinnedTrack = usePinnedTrack();\n\n  useEffect(() => {\n    function subscribeToStore() {\n      return store.subscribe(tracksMap => {\n        let pipPeers = store.getState(selectPeers);\n        if (pinnedTrack) {\n          pipPeers = pipPeers.filter(peer => pinnedTrack.peerId === peer.id);\n        }\n        PictureInPicture.updatePeersAndTracks(pipPeers, tracksMap).catch(err => {\n          console.error('error in updating pip', err);\n        });\n      }, selectTracksMap);\n    }\n    let unsubscribe: (() => void) | undefined = PictureInPicture.isOn() ? subscribeToStore() : undefined;\n    PictureInPicture.listenToStateChange(isOn => {\n      if (isOn) {\n        if (!unsubscribe) {\n          unsubscribe = subscribeToStore();\n        }\n      } else {\n        unsubscribe?.();\n        unsubscribe = undefined;\n      }\n    });\n    return () => {\n      unsubscribe?.();\n      unsubscribe = undefined;\n    };\n  }, [pinnedTrack, store]);\n\n  return <></>;\n};\n\nexport default PIPComponent;\n", "import { selectIsLocalAudioEnabled, selectIsLocalVideoEnabled } from '@100mslive/react-sdk';\n\n/**\n * Media Session API allows for handling control actions on top of pip\n * https://web.dev/media-session/#video-conferencing-actions\n */\nclass SetupMediaSession {\n  setup = (actions, store) => {\n    this.actions = actions;\n    this.store = store;\n    this.initState();\n    this.setUpHandlers();\n  };\n\n  initState = () => {\n    const isMicActive = this.store.getState(selectIsLocalAudioEnabled);\n    const isCamActive = this.store.getState(selectIsLocalVideoEnabled);\n    navigator.mediaSession?.setMicrophoneActive?.(isMicActive);\n    navigator.mediaSession?.setCameraActive?.(isCamActive);\n\n    this.store.subscribe(isMicActive => {\n      navigator.mediaSession?.setMicrophoneActive?.(isMicActive);\n    }, selectIsLocalAudioEnabled);\n\n    this.store.subscribe(isCamActive => {\n      navigator.mediaSession?.setCameraActive?.(isCamActive);\n    }, selectIsLocalVideoEnabled);\n  };\n\n  toggleMic = async () => {\n    console.log('toggle mic clicked in pip');\n    const current = this.store.getState(selectIsLocalAudioEnabled);\n    await this.actions.setLocalAudioEnabled(!current);\n  };\n\n  toggleCam = async () => {\n    console.log('toggle cam clicked in pip');\n    const current = this.store.getState(selectIsLocalVideoEnabled);\n    await this.actions.setLocalVideoEnabled(!current);\n  };\n\n  leave = () => {\n    console.log('leave called from pip');\n    this.actions.leave();\n  };\n\n  setUpHandlers = () => {\n    if (navigator.mediaSession) {\n      try {\n        navigator.mediaSession.setActionHandler('togglemicrophone', this.toggleMic);\n        navigator.mediaSession.setActionHandler('togglecamera', this.toggleCam);\n        navigator.mediaSession.setActionHandler('hangup', this.leave);\n      } catch (err) {\n        console.error('error in setting media session handlers', err);\n      }\n    }\n  };\n}\n\nexport const MediaSession = new SetupMediaSession();\n", "import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport {\n  selectHMSMessages,\n  selectLocalPeerID,\n  selectPeerNameByID,\n  selectSessionStore,\n  selectUnreadHMSMessagesCount,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { SendIcon } from '@100mslive/react-icons';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { TextArea } from '../../../TextArea';\nimport { Tooltip } from '../../../Tooltip';\nimport IconButton from '../../IconButton';\nimport { AnnotisedMessage } from '../Chat/ChatBody';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useIsPeerBlacklisted } from '../hooks/useChatBlacklist';\nimport { CHAT_MESSAGE_LIMIT, formatTime } from '../Chat/utils';\nimport { SESSION_STORE_KEY } from '../../common/constants';\n\nexport const PIPChat = () => {\n  const messages = useHMSStore(selectHMSMessages);\n  const localPeerID = useHMSStore(selectLocalPeerID);\n  const count = useHMSStore(selectUnreadHMSMessagesCount);\n  const [unreadMessageCount, setUnreadMessageCount] = useState(0);\n\n  const getSenderName = useCallback(\n    (senderName: string, senderID?: string) => {\n      const slicedName = senderName.length > 10 ? senderName.slice(0, 10) + '...' : senderName;\n      return slicedName + (senderID === localPeerID ? ' (You)' : '');\n    },\n    [localPeerID],\n  );\n\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      setUnreadMessageCount(count);\n    }, 100);\n    return () => clearTimeout(timeoutId);\n  }, [count]);\n\n  const blacklistedMessageIDs = useHMSStore(selectSessionStore(SESSION_STORE_KEY.CHAT_MESSAGE_BLACKLIST));\n  const filteredMessages = useMemo(() => {\n    const blacklistedMessageIDSet = new Set(blacklistedMessageIDs || []);\n    return messages?.filter(message => message.type === 'chat' && !blacklistedMessageIDSet.has(message.id)) || [];\n  }, [blacklistedMessageIDs, messages]);\n  const { enabled: isChatEnabled = true, updatedBy: chatStateUpdatedBy = '' } =\n    useHMSStore(selectSessionStore(SESSION_STORE_KEY.CHAT_STATE)) || {};\n  const isLocalPeerBlacklisted = useIsPeerBlacklisted({ local: true });\n  const { elements } = useRoomLayoutConferencingScreen();\n  const message_placeholder = elements?.chat?.message_placeholder || 'Send a message';\n  const canSendChatMessages =\n    !!elements?.chat?.public_chat_enabled ||\n    !!elements?.chat?.roles_whitelist?.length ||\n    !!elements?.chat?.private_chat_enabled;\n\n  const getChatStatus = useCallback(() => {\n    if (isLocalPeerBlacklisted) return \"You've been blocked from sending messages\";\n    if (!isChatEnabled)\n      return `Chat has been paused by ${\n        chatStateUpdatedBy.peerId === localPeerID ? 'you' : chatStateUpdatedBy?.userName\n      }`;\n    return message_placeholder;\n  }, [\n    chatStateUpdatedBy.peerId,\n    chatStateUpdatedBy?.userName,\n    isChatEnabled,\n    isLocalPeerBlacklisted,\n    localPeerID,\n    message_placeholder,\n  ]);\n\n  return (\n    <div style={{ height: '100%' }}>\n      <Box\n        id=\"chat-container\"\n        css={{\n          bg: '$surface_dim',\n          overflowY: 'auto',\n          // Subtracting height of footer\n          h: canSendChatMessages ? 'calc(100% - 87px)' : '100%',\n          position: 'relative',\n        }}\n      >\n        {unreadMessageCount ? (\n          <Box\n            id=\"new-message-notif\"\n            style={{\n              position: 'fixed',\n              bottom: '76px',\n              right: '4px',\n            }}\n          >\n            <Text\n              variant=\"xs\"\n              css={{ cursor: 'pointer' }}\n              style={{ color: 'white', background: 'gray', padding: '4px', borderRadius: '4px' }}\n            >\n              {unreadMessageCount === 1 ? 'New message' : `${unreadMessageCount} new messages`}\n            </Text>\n          </Box>\n        ) : (\n          ''\n        )}\n        {filteredMessages.length === 0 ? (\n          <div\n            style={{\n              display: 'flex',\n              flexDirection: 'column',\n              height: '100%',\n              width: '100%',\n              alignItems: 'center',\n              justifyContent: 'center',\n            }}\n          >\n            <Text variant=\"h5\" css={{ mt: '$8', c: '$on_surface_high' }}>\n              {canSendChatMessages ? 'Start a conversation' : 'No messages yet'}\n            </Text>\n            {canSendChatMessages ? (\n              <Text variant=\"sm\" style={{ maxWidth: '80%', textAlign: 'center', marginTop: '4px' }}>\n                There are no messages here yet. Start a conversation by sending a message.\n              </Text>\n            ) : (\n              ''\n            )}\n          </div>\n        ) : (\n          filteredMessages.map(message => (\n            <Box className=\"pip-message\" key={message.id} id={message.id} style={{ padding: '8px 0.75rem' }}>\n              <Flex style={{ width: '100%', alignItems: 'center', justifyContent: 'between' }}>\n                <Text\n                  style={{ display: 'flex', justifyContent: 'between', width: '100%', alignItems: 'center' }}\n                  css={{\n                    color: '$on_surface_high',\n                    fontWeight: '$semiBold',\n                  }}\n                >\n                  <Flex style={{ flexGrow: 1, gap: '2px', alignItems: 'center' }}>\n                    {message.senderName === 'You' || !message.senderName ? (\n                      <Text as=\"span\" variant=\"sub2\" css={{ color: '$on_surface_high', fontWeight: '$semiBold' }}>\n                        {message.senderName || 'Anonymous'}\n                      </Text>\n                    ) : (\n                      <Tooltip title={message.senderName} side=\"top\" align=\"start\">\n                        <Text as=\"span\" variant=\"sub2\" css={{ color: '$on_surface_high', fontWeight: '$semiBold' }}>\n                          {getSenderName(message.senderName, message?.sender)}\n                        </Text>\n                      </Tooltip>\n                    )}\n                    <MessageTitle\n                      localPeerID={localPeerID}\n                      recipientPeer={message.recipientPeer}\n                      recipientRoles={message.recipientRoles}\n                    />\n                  </Flex>\n\n                  <Text\n                    variant=\"xs\"\n                    css={{\n                      color: '$on_surface_medium',\n                      flexShrink: 0,\n                      p: '$2',\n                      whitespace: 'nowrap',\n                    }}\n                  >\n                    {formatTime(message.time)}\n                  </Text>\n                </Text>\n              </Flex>\n              <Text\n                variant=\"sm\"\n                css={{\n                  w: '100%',\n                  mt: '$2',\n                  wordBreak: 'break-word',\n                  whiteSpace: 'pre-wrap',\n                  userSelect: 'all',\n                  color: '$on_surface_high',\n                }}\n              >\n                <AnnotisedMessage message={message.message} />\n              </Text>\n            </Box>\n          ))\n        )}\n        <div id=\"marker\" style={{ height: filteredMessages.length ? '1px' : 0 }} />\n      </Box>\n      {canSendChatMessages && (\n        <Box css={{ bg: '$surface_dim' }}>\n          <Flex css={{ px: '$4', pb: '3px', gap: '$2', alignItems: 'center' }}>\n            <Text variant=\"caption\">To:</Text>\n            <Flex css={{ bg: '$primary_bright', color: '$on_primary_high', r: '$2' }}>\n              <select\n                id=\"selector\"\n                style={{\n                  background: 'inherit',\n                  color: 'inherit',\n                  border: 'none',\n                  outline: 'none',\n                  borderRadius: '4px',\n                  padding: '0 2px',\n                }}\n                defaultValue={elements.chat?.public_chat_enabled ? 'Everyone' : elements.chat?.roles_whitelist?.[0]}\n              >\n                {elements.chat?.roles_whitelist?.map(role => (\n                  <option key={role} value={role}>\n                    {role}\n                  </option>\n                ))}\n                {elements.chat?.public_chat_enabled ? <option value=\"Everyone\">Everyone</option> : ''}\n              </select>\n            </Flex>\n          </Flex>\n          <Flex\n            align=\"center\"\n            css={{\n              bg: '$surface_default',\n              minHeight: '$16',\n              width: '100%',\n              py: '$6',\n              pl: '$4',\n              boxSizing: 'border-box',\n              gap: '$2',\n              r: '$2',\n            }}\n          >\n            <TextArea\n              id=\"chat-input\"\n              maxLength={CHAT_MESSAGE_LIMIT}\n              disabled={!isChatEnabled || isLocalPeerBlacklisted}\n              rows={1}\n              css={{\n                w: '100%',\n                c: '$on_surface_high',\n                p: '0.75rem 0.75rem !important',\n                border: 'none',\n                resize: 'none',\n              }}\n              placeholder={getChatStatus()}\n              required\n              autoComplete=\"off\"\n              aria-autocomplete=\"none\"\n            />\n\n            <IconButton\n              id=\"send-btn\"\n              disabled={!isChatEnabled || isLocalPeerBlacklisted}\n              title={getChatStatus()}\n              css={{\n                ml: 'auto',\n                height: 'max-content',\n                mr: '$4',\n                '&:hover': { c: '$on_surface_medium' },\n              }}\n              data-testid=\"send_msg_btn\"\n            >\n              <SendIcon />\n            </IconButton>\n          </Flex>\n        </Box>\n      )}\n    </div>\n  );\n};\n\nconst MessageTitle = ({\n  recipientPeer,\n  recipientRoles,\n  localPeerID,\n}: {\n  recipientPeer?: string;\n  recipientRoles?: string[];\n  localPeerID: string;\n}) => {\n  const peerName = useHMSStore(selectPeerNameByID(recipientPeer));\n\n  return (\n    <>\n      {recipientRoles ? (\n        <Text as=\"span\" variant=\"sub2\" css={{ color: '$on_surface_high', fontWeight: '$semiBold' }}>\n          to {recipientRoles} (Group)\n        </Text>\n      ) : null}\n      {recipientPeer ? (\n        <Text as=\"span\" variant=\"sub2\" css={{ color: '$on_surface_high', fontWeight: '$semiBold' }}>\n          to {recipientPeer === localPeerID ? 'You' : peerName} (DM)\n        </Text>\n      ) : null}\n    </>\n  );\n};\n", "export { TextArea } from './TextArea';\n", "import { styled } from '../Theme';\n\nexport const TextArea = styled('textarea', {\n  fontFamily: '$sans',\n  lineHeight: 'inherit',\n  backgroundColor: '$surface_default',\n  borderRadius: '8px',\n  outline: 'none',\n  border: '1px solid $border_default',\n  padding: '0.5rem 0.75rem',\n  minHeight: '30px',\n  color: '$on_surface_high',\n  fontSize: '$md',\n  '&:focus': {\n    boxShadow: '0 0 0 1px $colors$primary_default',\n    border: '1px solid transparent',\n  },\n  '&::placeholder': {\n    color: '$on_surface_medium',\n  },\n  variants: {\n    error: {\n      true: {\n        '&:focus': {\n          boxShadow: '0 0 0 3px $colors$alert_error_default',\n        },\n      },\n    },\n  },\n});\n", "import React, { Fragment, useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport AutoSizer from 'react-virtualized-auto-sizer';\nimport { VariableSizeList } from 'react-window';\nimport {\n  HMSMessage,\n  HMSPeerID,\n  HMSRoleName,\n  selectHMSMessages,\n  selectLocalPeerID,\n  selectLocalPeerName,\n  selectLocalPeerRoleName,\n  selectPeerNameByID,\n  selectSessionStore,\n  selectUnreadHMSMessagesCount,\n  useHMSActions,\n  useHMSStore,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\nimport { SolidPinIcon } from '@100mslive/react-icons';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { config as cssConfig, styled } from '../../../Theme';\nimport { Tooltip } from '../../../Tooltip';\nimport { ChatActions } from './ChatActions';\nimport { EmptyChat } from './EmptyChat';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { useSetSubscribedChatSelector } from '../AppData/useUISettings';\nimport { usePinnedBy } from '../hooks/usePinnedBy';\nimport { formatTime } from './utils';\nimport { CHAT_SELECTOR, SESSION_STORE_KEY } from '../../common/constants';\n\nconst rowHeights: Record<number, { size: number; id: string }> = {};\nlet listInstance: VariableSizeList | null = null; //eslint-disable-line\nfunction getRowHeight(index: number) {\n  // 72 will be default row height for any message length\n  return rowHeights[index]?.size || 72;\n}\n\nconst setRowHeight = (index: number, id: string, size: number) => {\n  if (rowHeights[index]?.id === id && rowHeights[index]?.size === size) {\n    return;\n  }\n  listInstance?.resetAfterIndex(Math.max(index - 1, 0));\n  Object.assign(rowHeights, { [index]: { size, id } });\n};\n\nconst getMessageBackgroundColor = (\n  messageType: string,\n  selectedPeerID: string,\n  selectedRole: string,\n  isOverlay: boolean,\n) => {\n  if (messageType && !(selectedPeerID || selectedRole)) {\n    return isOverlay ? 'rgba(0, 0, 0, 0.64)' : '$surface_default';\n  }\n  return '';\n};\n\nconst MessageTypeContainer = ({ left, right }: { left?: string; right?: string }) => {\n  return (\n    <Flex\n      align=\"center\"\n      css={{\n        ml: '$2',\n        mr: '$4',\n        gap: '$space$2',\n        flexWrap: 'nowrap',\n      }}\n    >\n      {left && (\n        <Text\n          variant=\"xs\"\n          as=\"span\"\n          css={{\n            color: '$on_surface_medium',\n            textTransform: 'capitalize',\n            fontWeight: '$regular',\n            whiteSpace: 'nowrap',\n          }}\n        >\n          {left}\n        </Text>\n      )}\n      {right && (\n        <Text\n          as=\"span\"\n          variant=\"overline\"\n          css={{\n            color: '$on_surface_medium',\n            fontWeight: '$regular',\n            whiteSpace: 'nowrap',\n          }}\n        >\n          {right}\n        </Text>\n      )}\n    </Flex>\n  );\n};\n\nexport const MessageType = ({\n  roles,\n  hasCurrentUserSent,\n  receiver,\n}: {\n  roles?: HMSRoleName[];\n  hasCurrentUserSent: boolean;\n  receiver?: HMSPeerID;\n}) => {\n  const peerName = useHMSStore(selectPeerNameByID(receiver));\n  const localPeerRoleName = useHMSStore(selectLocalPeerRoleName);\n  if (receiver) {\n    return (\n      <MessageTypeContainer left={hasCurrentUserSent ? `${peerName ? `to ${peerName}` : ''}` : 'to You'} right=\"(DM)\" />\n    );\n  }\n\n  if (roles && roles.length) {\n    return <MessageTypeContainer left={`to ${hasCurrentUserSent ? roles[0] : localPeerRoleName}`} right=\"(Group)\" />;\n  }\n  return null;\n};\n\nconst URL_REGEX =\n  /^https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/;\n\nconst Link = styled('a', {\n  color: '$primary_default',\n  wordBreak: 'break-word',\n  '&:hover': {\n    textDecoration: 'underline',\n  },\n});\n\nexport const AnnotisedMessage = ({ message, length }: { message: string; length?: number }) => {\n  if (!message) {\n    return <Fragment />;\n  }\n\n  return (\n    <Fragment>\n      {message\n        .trim()\n        .split(/(\\s)/)\n        .map(part =>\n          URL_REGEX.test(part) ? (\n            <Link href={part} key={part} target=\"_blank\" rel=\"noopener noreferrer\">\n              {part.slice(0, length)}\n            </Link>\n          ) : (\n            part.slice(0, length)\n          ),\n        )}\n    </Fragment>\n  );\n};\n\nconst getMessageType = ({ roles, receiver }: { roles?: HMSRoleName[]; receiver?: HMSPeerID }) => {\n  if (roles && roles.length > 0) {\n    return 'role';\n  }\n  return receiver ? 'private' : '';\n};\n\nexport const SenderName = styled(Text, {\n  overflow: 'hidden',\n  textOverflow: 'ellipsis',\n  whiteSpace: 'nowrap',\n  width: '100%',\n  minWidth: 0,\n  color: '$on_surface_high',\n  fontWeight: '$semiBold',\n});\n\nconst ChatMessage = React.memo(\n  ({ index, style = {}, message }: { message: HMSMessage; index: number; style: React.CSSProperties }) => {\n    const { elements } = useRoomLayoutConferencingScreen();\n    const rowRef = useRef<HTMLDivElement | null>(null);\n    const isMobile = useMedia(cssConfig.media.md);\n    const isPrivateChatEnabled = !!elements?.chat?.private_chat_enabled;\n    const isOverlay = elements?.chat?.is_overlay && isMobile;\n    const localPeerId = useHMSStore(selectLocalPeerID);\n    const [selectedRole, setRoleSelector] = useSetSubscribedChatSelector(CHAT_SELECTOR.ROLE);\n    const [selectedPeer, setPeerSelector] = useSetSubscribedChatSelector(CHAT_SELECTOR.PEER);\n    const messageType = getMessageType({\n      roles: message.recipientRoles,\n      receiver: message.recipientPeer,\n    });\n    const [openSheet, setOpenSheetBare] = useState(false);\n    const showPinAction = !!elements?.chat?.allow_pinning_messages;\n    const showReply = message.sender !== selectedPeer.id && message.sender !== localPeerId && isPrivateChatEnabled;\n    useLayoutEffect(() => {\n      if (rowRef.current) {\n        setRowHeight(index, message.id, rowRef.current.clientHeight);\n      }\n    }, [index, message.id]);\n\n    const setOpenSheet = (value: boolean, e?: React.MouseEvent<HTMLElement, MouseEvent>) => {\n      e?.stopPropagation();\n      setOpenSheetBare(value);\n    };\n\n    return (\n      <Box\n        css={{\n          mb: '$5',\n          pr: '$10',\n          mt: '$4',\n          '&:not(:hover} .chat_actions': { display: 'none' },\n          '&:hover .chat_actions': { display: 'flex', opacity: 1 },\n        }}\n        style={style}\n      >\n        <Flex\n          ref={rowRef}\n          align=\"center\"\n          css={{\n            flexWrap: 'wrap',\n            position: 'relative',\n            // Theme independent color, token should not be used for transparent chat\n            background: getMessageBackgroundColor(messageType, selectedPeer.id, selectedRole, !!isOverlay),\n            r: '$1',\n            p: '$4',\n            userSelect: 'none',\n            '@md': {\n              cursor: 'pointer',\n            },\n            '&:hover': {\n              background: 'linear-gradient(277deg, $surface_default 0%, $surface_dim 60.87%)',\n            },\n          }}\n          data-testid=\"chat_msg\"\n          onClick={e => {\n            if (isMobile) {\n              setOpenSheet(true, e);\n            }\n          }}\n        >\n          <PinnedBy messageId={message.id} index={index} rowRef={rowRef} />\n          <Text\n            css={{\n              color: isOverlay ? '#FFF' : '$on_surface_high',\n              fontWeight: '$semiBold',\n              display: 'flex',\n              alignItems: 'center',\n              alignSelf: 'stretch',\n              width: '100%',\n            }}\n            as=\"div\"\n          >\n            <Flex\n              align=\"baseline\"\n              css={{\n                flexWrap: 'nowrap',\n                maxWidth: 'calc(100% - 10ch)',\n                textOverflow: 'ellipsis',\n                whiteSpace: 'nowrap',\n              }}\n            >\n              {message.senderName === 'You' || !message.senderName ? (\n                <SenderName\n                  as=\"span\"\n                  variant=\"sub2\"\n                  css={{ color: isOverlay ? '#FFF' : '$on_surface_high', fontWeight: '$semiBold' }}\n                >\n                  {message.senderName || 'Anonymous'}\n                </SenderName>\n              ) : (\n                <Tooltip title={message.senderName} side=\"top\" align=\"start\" boxCss={{ zIndex: 50 }}>\n                  <SenderName\n                    as=\"span\"\n                    variant=\"sub2\"\n                    css={{ color: isOverlay ? '#FFF' : '$on_surface_high', fontWeight: '$semiBold' }}\n                  >\n                    {message.sender === localPeerId ? `${message.senderName} (You)` : message.senderName}\n                  </SenderName>\n                </Tooltip>\n              )}\n              <MessageType\n                hasCurrentUserSent={message.sender === localPeerId}\n                receiver={message.recipientPeer}\n                roles={message.recipientRoles}\n              />\n            </Flex>\n\n            {!isOverlay ? (\n              <Text\n                as=\"span\"\n                variant=\"caption\"\n                css={{\n                  color: '$on_surface_medium',\n                  flexShrink: 0,\n                  position: 'absolute',\n                  right: 0,\n                  zIndex: 1,\n                  mr: '$4',\n                  p: '$2',\n                }}\n              >\n                {formatTime(message.time)}\n              </Text>\n            ) : null}\n            <ChatActions\n              showPinAction={showPinAction}\n              message={message}\n              sentByLocalPeer={message.sender === localPeerId}\n              onReply={() => {\n                setRoleSelector('');\n                setPeerSelector({ id: message.sender, name: message.senderName });\n              }}\n              onReplyGroup={() => {\n                if (message.senderRole) {\n                  setRoleSelector(message.senderRole);\n                  setPeerSelector({});\n                }\n              }}\n              showReply={showReply}\n              isMobile={isMobile}\n              openSheet={openSheet}\n              setOpenSheet={setOpenSheet}\n            />\n          </Text>\n          <Text\n            variant=\"sm\"\n            css={{\n              w: '100%',\n              mt: '$2',\n              wordBreak: 'break-word',\n              whiteSpace: 'pre-wrap',\n              userSelect: 'all',\n              color: isOverlay ? '#FFF' : '$on_surface_high',\n            }}\n            onClick={e => {\n              setOpenSheet(true, e);\n            }}\n          >\n            <AnnotisedMessage message={message.message} />\n          </Text>\n        </Flex>\n      </Box>\n    );\n  },\n);\n\nconst MessageWrapper = React.memo(\n  ({ index, style, data }: { index: number; style: React.CSSProperties; data: HMSMessage[] }) => {\n    return <ChatMessage style={style} index={index} key={data[index].id} message={data[index]} />;\n  },\n);\n\nconst VirtualizedChatMessages = React.forwardRef<\n  VariableSizeList,\n  { messages: HMSMessage[]; scrollToBottom: (count: number) => void }\n>(({ messages, scrollToBottom }, listRef) => {\n  const hmsActions = useHMSActions();\n  const itemKey = useCallback((index: number, data: HMSMessage[]) => {\n    return data[index].id;\n  }, []);\n  useEffect(() => {\n    requestAnimationFrame(() => scrollToBottom(1));\n  }, [scrollToBottom]);\n  return (\n    <Box\n      css={{\n        mr: '-$10',\n        h: '100%',\n      }}\n    >\n      <AutoSizer\n        style={{\n          width: '90%',\n        }}\n      >\n        {({ height, width }: { height: number; width: number }) => (\n          <VariableSizeList\n            ref={node => {\n              if (node) {\n                // @ts-ignore\n                listRef.current = node;\n                listInstance = node;\n              }\n            }}\n            itemCount={messages.length}\n            itemSize={getRowHeight}\n            itemData={messages}\n            width={width}\n            height={height}\n            style={{\n              overflowX: 'hidden',\n            }}\n            itemKey={itemKey}\n            onItemsRendered={({ visibleStartIndex, visibleStopIndex }) => {\n              for (let i = visibleStartIndex; i <= visibleStopIndex; i++) {\n                if (!messages[i].read) {\n                  hmsActions.setMessageRead(true, messages[i].id);\n                }\n              }\n            }}\n          >\n            {MessageWrapper}\n          </VariableSizeList>\n        )}\n      </AutoSizer>\n    </Box>\n  );\n});\n\nexport const ChatBody = React.forwardRef<VariableSizeList, { scrollToBottom: (count: number) => void }>(\n  ({ scrollToBottom }: { scrollToBottom: (count: number) => void }, listRef) => {\n    const messages = useHMSStore(selectHMSMessages);\n    const blacklistedMessageIDs = useHMSStore(selectSessionStore(SESSION_STORE_KEY.CHAT_MESSAGE_BLACKLIST));\n    const filteredMessages = useMemo(() => {\n      const blacklistedMessageIDSet = new Set(blacklistedMessageIDs || []);\n      return messages?.filter(message => message.type === 'chat' && !blacklistedMessageIDSet.has(message.id)) || [];\n    }, [blacklistedMessageIDs, messages]);\n\n    const vanillaStore = useHMSVanillaStore();\n    const rerenderOnFirstMount = useRef(false);\n\n    useEffect(() => {\n      const unsubscribe = vanillaStore.subscribe(() => {\n        // @ts-ignore\n        if (!listRef.current) {\n          return;\n        }\n        // @ts-ignore\n        const outerElement = listRef.current._outerRef;\n        if (\n          outerElement &&\n          outerElement.clientHeight + outerElement.scrollTop + outerElement.offsetTop >= outerElement.scrollHeight\n        ) {\n          requestAnimationFrame(() => scrollToBottom(1));\n        }\n      }, selectUnreadHMSMessagesCount);\n      return unsubscribe;\n    }, [vanillaStore, listRef, scrollToBottom]);\n\n    useEffect(() => {\n      // @ts-ignore\n      if (filteredMessages.length > 0 && listRef?.current && !rerenderOnFirstMount.current) {\n        rerenderOnFirstMount.current = true;\n        // @ts-ignore\n        listRef.current.resetAfterIndex(0);\n      }\n    }, [listRef, filteredMessages]);\n\n    return filteredMessages.length === 0 ? (\n      <EmptyChat />\n    ) : (\n      <VirtualizedChatMessages messages={filteredMessages} ref={listRef} scrollToBottom={scrollToBottom} />\n    );\n  },\n);\n\nconst PinnedBy = ({\n  messageId,\n  index,\n  rowRef,\n}: {\n  messageId: string;\n  index: number;\n  rowRef?: React.MutableRefObject<HTMLDivElement | null>;\n}) => {\n  const pinnedBy = usePinnedBy(messageId);\n  const localPeerName = useHMSStore(selectLocalPeerName);\n\n  useLayoutEffect(() => {\n    if (rowRef?.current) {\n      if (pinnedBy) {\n        rowRef.current.style.background =\n          'linear-gradient(277deg, var(--hms-ui-colors-surface_default) 0%, var(--hms-ui-colors-surface_dim) 60.87%)';\n      } else {\n        rowRef.current.style.background = '';\n      }\n      setRowHeight(index, messageId, rowRef?.current.clientHeight);\n    }\n  }, [index, messageId, pinnedBy, rowRef]);\n\n  if (!pinnedBy) {\n    return null;\n  }\n\n  return (\n    <Flex align=\"center\" css={{ gap: '$2', mb: '$2', color: '$on_surface_low' }}>\n      <SolidPinIcon height={12} width={12} />\n      <Text variant=\"xs\" css={{ color: 'inherit' }}>\n        Pinned by {localPeerName === pinnedBy ? 'you' : pinnedBy}\n      </Text>\n    </Flex>\n  );\n};\n", "import React, { useCallback, useState } from 'react';\nimport { HMSMessage, selectLocalPeerName, selectPermissions, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport {\n  CopyIcon,\n  CrossCircleIcon,\n  CrossIcon,\n  EyeCloseIcon,\n  PeopleRemoveIcon,\n  PinIcon,\n  ReplyGroupIcon,\n  ReplyIcon,\n  VerticalMenuIcon,\n} from '@100mslive/react-icons';\nimport { Dropdown } from '../../../Dropdown';\nimport { IconButton } from '../../../IconButton';\nimport { Flex } from '../../../Layout';\nimport { Sheet } from '../../../Sheet';\nimport { Text } from '../../../Text';\nimport { Tooltip } from '../../../Tooltip';\n// @ts-ignore\nimport { ToastManager } from '../Toast/ToastManager';\nimport { MwebChatOption } from './MwebChatOption';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useChatBlacklist, useIsPeerBlacklisted } from '../hooks/useChatBlacklist';\nimport { usePinnedMessages } from '../hooks/usePinnedMessages';\nimport { SESSION_STORE_KEY } from '../../common/constants';\n\nconst iconStyle = { height: '1.125rem', width: '1.125rem' };\nconst tooltipBoxCSS = {\n  fontSize: '$xs',\n  backgroundColor: '$surface_default',\n  p: '$1 $5',\n  fontWeight: '$regular',\n  borderRadius: '$3',\n};\n\nexport const ChatActions = ({\n  showPinAction,\n  onReply,\n  onReplyGroup,\n  showReply,\n  message,\n  sentByLocalPeer,\n  isMobile,\n  openSheet,\n  setOpenSheet,\n}: {\n  showPinAction: boolean;\n  onReply: () => void;\n  onReplyGroup: () => void;\n  showReply: boolean;\n  message: HMSMessage;\n  sentByLocalPeer: boolean;\n  isMobile: boolean;\n  openSheet: boolean;\n  setOpenSheet: (value: boolean, e?: React.MouseEvent<HTMLElement, MouseEvent>) => void;\n}) => {\n  const { elements } = useRoomLayoutConferencingScreen();\n  const { can_hide_message = false, can_block_user = false } = elements?.chat?.real_time_controls || {};\n  const { roles_whitelist = [] } = elements?.chat || {};\n\n  const [open, setOpen] = useState(false);\n  const actions = useHMSActions();\n  const canRemoveOthers = useHMSStore(selectPermissions)?.removeOthers;\n  const { blacklistItem: blacklistPeer } = useChatBlacklist(SESSION_STORE_KEY.CHAT_PEER_BLACKLIST);\n  const localPeerName = useHMSStore(selectLocalPeerName);\n  const { setPinnedMessages, unpinBlacklistedMessages } = usePinnedMessages();\n\n  const { blacklistItem: blacklistMessage, blacklistedIDs: blacklistedMessageIDs } = useChatBlacklist(\n    SESSION_STORE_KEY.CHAT_MESSAGE_BLACKLIST,\n  );\n\n  const isSenderBlocked = useIsPeerBlacklisted({ peerCustomerUserId: message.senderUserId });\n\n  const updatePinnedMessages = useCallback(\n    (messageID = '') => {\n      const blacklistedMessageIDSet = new Set([...(blacklistedMessageIDs || []), messageID]);\n      unpinBlacklistedMessages(blacklistedMessageIDSet);\n    },\n    [blacklistedMessageIDs, unpinBlacklistedMessages],\n  );\n\n  const copyMessageContent = useCallback(() => {\n    try {\n      navigator?.clipboard.writeText(message.message);\n      ToastManager.addToast({\n        title: 'Message copied successfully',\n      });\n    } catch (e) {\n      console.log(e);\n      ToastManager.addToast({\n        title: 'Could not copy message',\n      });\n    }\n  }, [message]);\n\n  const options: Record<\n    string,\n    {\n      text: string;\n      tooltipText?: string;\n      icon: React.ReactNode;\n      onClick: () => void | Promise<void>;\n      show: boolean;\n      color?: string;\n    }\n  > = {\n    reply: {\n      text: 'Reply privately',\n      tooltipText: 'Reply privately',\n      icon: <ReplyIcon style={iconStyle} />,\n      onClick: onReply,\n      show: showReply,\n    },\n    replyGroup: {\n      text: 'Reply to group',\n      tooltipText: 'Reply to group',\n      icon: <ReplyGroupIcon style={iconStyle} />,\n      onClick: onReplyGroup,\n      show: !!message.senderRole && roles_whitelist.includes(message.senderRole),\n    },\n    pin: {\n      text: 'Pin message',\n      tooltipText: 'Pin',\n      icon: <PinIcon style={iconStyle} />,\n      onClick: () => setPinnedMessages(message, localPeerName || ''),\n      show: showPinAction,\n    },\n    copy: {\n      text: 'Copy text',\n      tooltipText: 'Copy',\n      icon: <CopyIcon style={iconStyle} />,\n      onClick: copyMessageContent,\n      show: true,\n    },\n    hide: {\n      text: message.recipientPeer ? 'Hide for both' : 'Hide for everyone',\n      icon: <EyeCloseIcon style={iconStyle} />,\n      onClick: async () => {\n        blacklistMessage(message.id);\n        updatePinnedMessages(message.id);\n      },\n      show: !!can_hide_message,\n    },\n    block: {\n      text: 'Block from chat',\n      icon: <CrossCircleIcon style={iconStyle} />,\n      onClick: async () => {\n        if (message.senderUserId) {\n          blacklistPeer(message.senderUserId);\n        }\n      },\n      color: '$alert_error_default',\n      show: !!can_block_user && !sentByLocalPeer && !isSenderBlocked,\n    },\n    remove: {\n      text: 'Remove participant',\n      icon: <PeopleRemoveIcon style={iconStyle} />,\n      color: '$alert_error_default',\n      show: !!canRemoveOthers && !sentByLocalPeer,\n      onClick: async () => {\n        if (!message.sender) {\n          return;\n        }\n        try {\n          await actions.removePeer(message.sender, '');\n        } catch (error) {\n          ToastManager.addToast({ title: (error as Error).message, variant: 'error' });\n        }\n      },\n    },\n  };\n\n  if (isMobile) {\n    return (\n      <Sheet.Root open={openSheet} onOpenChange={setOpenSheet}>\n        <Sheet.Content css={{ bg: '$surface_default', pb: '$14' }} onClick={e => setOpenSheet(false, e)}>\n          <Sheet.Title\n            css={{\n              display: 'flex',\n              color: '$on_surface_high',\n              w: '100%',\n              justifyContent: 'space-between',\n              mt: '$8',\n              fontSize: '$md',\n              px: '$10',\n              pb: '$8',\n              borderBottom: '1px solid $border_bright',\n              alignItems: 'center',\n            }}\n          >\n            Message options\n            <Sheet.Close css={{ color: '$on_surface_high' }} onClick={e => setOpenSheet(false, e)}>\n              <CrossIcon />\n            </Sheet.Close>\n          </Sheet.Title>\n\n          {Object.keys(options).map(optionKey => {\n            const option = options[optionKey];\n            return option.show ? (\n              <MwebChatOption\n                key={optionKey}\n                text={option.text}\n                icon={option.icon}\n                onClick={option.onClick}\n                color={option?.color}\n              />\n            ) : null;\n          })}\n        </Sheet.Content>\n      </Sheet.Root>\n    );\n  }\n\n  return (\n    <Dropdown.Root open={open} onOpenChange={setOpen} css={{ '@md': { display: 'none' } }}>\n      <Flex\n        className=\"chat_actions\"\n        css={{\n          background: '$surface_bright',\n          borderRadius: '$1',\n          p: '$2',\n          opacity: open ? 1 : 0,\n          position: 'absolute',\n          top: 0,\n          right: 0,\n          zIndex: 1,\n          '@md': { opacity: 1 },\n        }}\n      >\n        {options.reply.show ? (\n          <Tooltip boxCss={tooltipBoxCSS} title={options.reply.tooltipText}>\n            <IconButton data-testid=\"reply_message_btn\" onClick={options.reply.onClick}>\n              {options.reply.icon}\n            </IconButton>\n          </Tooltip>\n        ) : null}\n        {options.replyGroup.show ? (\n          <Tooltip boxCss={tooltipBoxCSS} title={options.replyGroup.tooltipText}>\n            <IconButton data-testid=\"reply_group_message_btn\" onClick={options.replyGroup.onClick}>\n              {options.replyGroup.icon}\n            </IconButton>\n          </Tooltip>\n        ) : null}\n        {options.pin.show ? (\n          <Tooltip boxCss={tooltipBoxCSS} title={options.pin.tooltipText}>\n            <IconButton data-testid=\"pin_message_btn\" onClick={options.pin.onClick}>\n              {options.pin.icon}\n            </IconButton>\n          </Tooltip>\n        ) : null}\n\n        {options.copy.show ? (\n          <Tooltip boxCss={tooltipBoxCSS} title={options.copy.tooltipText}>\n            <IconButton onClick={options.copy.onClick} data-testid=\"copy_message_btn\">\n              <CopyIcon style={iconStyle} />\n            </IconButton>\n          </Tooltip>\n        ) : null}\n\n        {options.block.show || options.hide.show || options.remove.show ? (\n          <Tooltip boxCss={tooltipBoxCSS} title=\"More actions\">\n            <Dropdown.Trigger asChild>\n              <IconButton>\n                <VerticalMenuIcon style={iconStyle} />\n              </IconButton>\n            </Dropdown.Trigger>\n          </Tooltip>\n        ) : null}\n      </Flex>\n      <Dropdown.Portal>\n        <Dropdown.Content\n          sideOffset={5}\n          align=\"end\"\n          css={{ width: '$48', backgroundColor: '$surface_bright', py: '$0', border: '1px solid $border_bright' }}\n        >\n          {options.hide.show ? (\n            <Dropdown.Item data-testid=\"hide_message_btn\" onClick={options.hide.onClick}>\n              {options.hide.icon}\n              <Text variant=\"sm\" css={{ ml: '$4', fontWeight: '$semiBold' }}>\n                {options.hide.text}\n              </Text>\n            </Dropdown.Item>\n          ) : null}\n\n          {options.block.show ? (\n            <Dropdown.Item\n              data-testid=\"block_peer_btn\"\n              onClick={options.block.onClick}\n              css={{ color: options.block.color }}\n            >\n              {options.block.icon}\n              <Text variant=\"sm\" css={{ ml: '$4', color: 'inherit', fontWeight: '$semiBold' }}>\n                {options.block.text}\n              </Text>\n            </Dropdown.Item>\n          ) : null}\n          {options.remove.show ? (\n            <Dropdown.Item\n              data-testid=\"remove_peer_btn\"\n              onClick={options.remove.onClick}\n              css={{ color: options.remove.color }}\n            >\n              {options.remove.icon}\n              <Text variant=\"sm\" css={{ ml: '$4', color: 'inherit', fontWeight: '$semiBold' }}>\n                {options.remove.text}\n              </Text>\n            </Dropdown.Item>\n          ) : null}\n        </Dropdown.Content>\n      </Dropdown.Portal>\n    </Dropdown.Root>\n  );\n};\n", "import React from 'react';\nimport { Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\n\nexport const MwebChatOption = ({\n  icon,\n  text,\n  onClick,\n  color = '$on_surface_high',\n}: {\n  icon: React.ReactNode;\n  text: string;\n  onClick: () => void | Promise<void>;\n  color?: string;\n}) => {\n  return (\n    <Flex align=\"center\" css={{ w: '100%', color, cursor: 'pointer', gap: '$4', p: '$8' }} onClick={onClick}>\n      {icon}\n      <Text variant=\"sm\" css={{ color, fontWeight: '$semiBold' }}>\n        {text}\n      </Text>\n    </Flex>\n  );\n};\n", "import { useCallback } from 'react';\nimport { selectLocalPeer, selectSessionStore, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\n// @ts-ignore\nimport { ToastManager } from '../Toast/ToastManager';\nimport { SESSION_STORE_KEY } from '../../common/constants';\n\nexport const useChatBlacklist = (\n  sessionStoreKey: SESSION_STORE_KEY.CHAT_MESSAGE_BLACKLIST | SESSION_STORE_KEY.CHAT_PEER_BLACKLIST,\n) => {\n  const hmsActions = useHMSActions();\n  const blacklistedIDs = useHMSStore(selectSessionStore(sessionStoreKey));\n\n  const blacklistItem = useCallback(\n    async (blacklistID: string) => {\n      await hmsActions.sessionStore\n        .set(sessionStoreKey, [...(blacklistedIDs || []), blacklistID])\n        .catch(err => ToastManager.addToast({ title: err.description }));\n    },\n    [hmsActions, sessionStoreKey, blacklistedIDs],\n  );\n\n  return { blacklistItem, blacklistedIDs };\n};\n\nexport const useIsPeerBlacklisted = ({ local = false, peerCustomerUserId = '' }) => {\n  const localPeer = useHMSStore(selectLocalPeer);\n  const blacklistedPeerIDs = useHMSStore(selectSessionStore(SESSION_STORE_KEY.CHAT_PEER_BLACKLIST)) || [];\n  return blacklistedPeerIDs?.includes(local ? localPeer?.customerUserId : peerCustomerUserId);\n};\n", "import { useCallback } from 'react';\nimport {\n  HMSMessage,\n  selectPeerNameByID,\n  selectSessionStore,\n  useHMSActions,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\n// @ts-ignore\nimport { ToastManager } from '../Toast/ToastManager';\n// @ts-ignore\nimport { SESSION_STORE_KEY } from '../../common/constants';\n\nexport type PinnedMessage = {\n  text: string;\n  id: string;\n  pinnedBy: string;\n};\n\n/**\n * set pinned chat message by updating the session store\n */\nexport const usePinnedMessages = () => {\n  const hmsActions = useHMSActions();\n  const vanillaStore = useHMSVanillaStore();\n\n  const setPinnedMessages = useCallback(\n    async (message: HMSMessage, pinnedBy: string) => {\n      const peerName = vanillaStore.getState(selectPeerNameByID(message?.sender)) || message?.senderName;\n      const newPinnedMessage = { text: '', id: message.id, pinnedBy };\n\n      if (message && peerName) {\n        newPinnedMessage['text'] = `${peerName}: ${message.message}`;\n      } else if (message) {\n        newPinnedMessage['text'] = message.message;\n      }\n\n      const pinnedMessages = vanillaStore.getState(selectSessionStore(SESSION_STORE_KEY.PINNED_MESSAGES)) || [];\n      if (!pinnedMessages?.find((pinnedMessage: PinnedMessage) => pinnedMessage.id === newPinnedMessage.id)) {\n        await hmsActions.sessionStore\n          .set(SESSION_STORE_KEY.PINNED_MESSAGES, [...pinnedMessages, newPinnedMessage].slice(-3)) // Limiting to maximum of 3 messages - FIFO\n          .catch(err => ToastManager.addToast({ title: err.description }));\n      }\n    },\n    [hmsActions, vanillaStore],\n  );\n\n  const removePinnedMessage = useCallback(\n    async (indexToRemove: number) => {\n      const pinnedMessages = vanillaStore.getState(selectSessionStore(SESSION_STORE_KEY.PINNED_MESSAGES)) || [];\n      if (pinnedMessages[indexToRemove]) {\n        await hmsActions.sessionStore\n          .set(\n            SESSION_STORE_KEY.PINNED_MESSAGES,\n            pinnedMessages.filter((_: PinnedMessage, index: number) => index !== indexToRemove),\n          )\n          .catch(err => ToastManager.addToast({ title: err.description }));\n      }\n    },\n    [hmsActions, vanillaStore],\n  );\n\n  const unpinBlacklistedMessages = useCallback(\n    async (blacklistedMessageIDSet: Set<string>) => {\n      const pinnedMessages = vanillaStore.getState(selectSessionStore(SESSION_STORE_KEY.PINNED_MESSAGES)) || [];\n      const filteredPinnedMessages = pinnedMessages?.filter(\n        (pinnedMessage: PinnedMessage) => !blacklistedMessageIDSet?.has(pinnedMessage.id),\n      );\n\n      await hmsActions.sessionStore\n        .set(SESSION_STORE_KEY.PINNED_MESSAGES, filteredPinnedMessages)\n        .catch(err => ToastManager.addToast({ title: err.description }));\n    },\n    [hmsActions, vanillaStore],\n  );\n\n  return { setPinnedMessages, removePinnedMessage, unpinBlacklistedMessages };\n};\n", "import React from 'react';\nimport { useMedia } from 'react-use';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { config as cssConfig } from '../../../Theme';\n// @ts-ignore\nimport emptyChat from '../../images/empty-chat.svg';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useIsPeerBlacklisted } from '../hooks/useChatBlacklist';\nimport { useLandscapeHLSStream, useMobileHLSStream } from '../../common/hooks';\n\nexport const EmptyChat = () => {\n  const { elements } = useRoomLayoutConferencingScreen();\n  const isLocalPeerBlacklisted = useIsPeerBlacklisted({ local: true });\n  const isMobile = useMedia(cssConfig.media.md);\n  const canSendMessages =\n    elements.chat &&\n    (elements.chat.public_chat_enabled ||\n      elements.chat.private_chat_enabled ||\n      (elements.chat.roles_whitelist && elements.chat.roles_whitelist.length)) &&\n    !isLocalPeerBlacklisted;\n  const isMobileHLSStream = useMobileHLSStream();\n  const isLandscapeStream = useLandscapeHLSStream();\n  const streaming = isMobileHLSStream || isLandscapeStream;\n\n  if (isMobile && elements?.chat?.is_overlay && !streaming) return <></>;\n\n  return (\n    <Flex\n      css={{\n        width: '100%',\n        flex: '1 1 0',\n        textAlign: 'center',\n        px: '$4',\n      }}\n      align=\"center\"\n      justify=\"center\"\n    >\n      <Box>\n        <Box css={{ m: '0 auto', mt: '$4', '@media (max-height: 575px)': { display: 'none' } }}>\n          <img src={emptyChat} style={{ display: 'inline' }} alt=\"Empty Chat\" height={132} width={185} />\n        </Box>\n\n        <Text variant=\"h5\" css={{ mt: '$8', c: '$on_surface_high' }}>\n          {canSendMessages ? 'Start a conversation' : 'No messages yet'}\n        </Text>\n        {canSendMessages ? (\n          <Text\n            variant=\"sm\"\n            css={{ mt: '$4', maxWidth: '80%', textAlign: 'center', mx: 'auto', c: '$on_surface_medium' }}\n          >\n            There are no messages here yet. Start a conversation by sending a message.\n          </Text>\n        ) : null}\n      </Box>\n    </Flex>\n  );\n};\n", "import { useEffect, useState } from 'react';\nimport { selectSessionStore, useHMSStore } from '@100mslive/react-sdk';\nimport { PinnedMessage } from './usePinnedMessages';\nimport { SESSION_STORE_KEY } from '../../common/constants';\n\nexport const usePinnedBy = (messageId: string) => {\n  const pinnedMessages = useHMSStore(selectSessionStore(SESSION_STORE_KEY.PINNED_MESSAGES));\n  const [pinnedBy, setPinnedBy] = useState('');\n\n  useEffect(() => {\n    let match = '';\n    pinnedMessages?.forEach((pinnedMessage: PinnedMessage) => {\n      if (pinnedMessage.id === messageId) {\n        match = pinnedMessage.pinnedBy;\n      }\n    });\n\n    setPinnedBy(match);\n  }, [messageId, pinnedMessages]);\n\n  return pinnedBy;\n};\n", "export const formatTime = (date: Date) => {\n  if (!(date instanceof Date)) {\n    return '';\n  }\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n  const suffix = hours > 11 ? 'PM' : 'AM';\n  return `${hours < 10 ? '0' : ''}${hours}:${minutes < 10 ? '0' : ''}${minutes} ${suffix}`;\n};\n\nexport const CHAT_MESSAGE_LIMIT = 2000;\n", "import React from 'react';\nimport { ExternalLinkIcon } from '@100mslive/react-icons';\nimport { Dropdown } from '../../../Dropdown';\nimport { Text } from '../../../Text';\n\nexport const PIPChatOption = ({ openChat, showPIPChat }: { openChat: () => void; showPIPChat: boolean }) => {\n  if (!showPIPChat) {\n    return <></>;\n  }\n  return (\n    <Dropdown.Item onClick={openChat} data-testid=\"pip_chat_btn\">\n      <ExternalLinkIcon />\n      <Text variant=\"sm\" css={{ ml: '$4', color: '$on_surface_high' }}>\n        Pop out Chat\n      </Text>\n    </Dropdown.Item>\n  );\n};\n", "import React from 'react';\nimport { createPortal } from 'react-dom';\n\ntype PIPWindowProps = {\n  pipWindow: Window;\n  children: React.ReactNode;\n};\n\nexport const PIPWindow = ({ pipWindow, children }: PIPWindowProps) => {\n  pipWindow.document.body.style.margin = '0';\n  pipWindow.document.body.style.overflow = 'clip';\n  return createPortal(children, pipWindow.document.body);\n};\n", "import React, { useRef, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { HMSPeer, selectAvailableRoleNames, selectPeerByID, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { ChevronDownIcon, ChevronUpIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Button } from '../../Button';\nimport { Dropdown } from '../../Dropdown';\nimport { Box, Flex } from '../../Layout';\nimport { Dialog } from '../../Modal';\nimport { Sheet } from '../../Sheet';\nimport { Text } from '../../Text';\nimport { config as cssConfig } from '../../Theme';\nimport { Tooltip } from '../../Tooltip';\n\nconst HighlightTerm = ({ value }: { value: string | undefined }) => {\n  return value ? (\n    <Tooltip side=\"top\" title={value}>\n      <Text\n        variant=\"body2\"\n        css={{\n          color: '$on_surface_medium',\n          fontWeight: '$semiBold',\n        }}\n      >\n        '{value.slice(0, 100)}\n        {value.length > 100 ? '...' : ''}'\n      </Text>\n    </Tooltip>\n  ) : (\n    <></>\n  );\n};\n\nconst RoleChangeContent = ({\n  peer,\n  onOpenChange,\n  isMobile = false,\n}: {\n  peer: HMSPeer;\n  onOpenChange: (open: boolean) => void;\n  isMobile?: boolean;\n}) => {\n  const roles = useHMSStore(selectAvailableRoleNames).filter(\n    role => role !== peer?.roleName && role !== '__internal_recorder',\n  );\n  const [selectedRole, setRole] = useState(roles.filter(role => role !== peer?.roleName)?.[0] || peer?.roleName);\n  const hmsActions = useHMSActions();\n  const [open, setOpen] = useState(false);\n  const triggerRef = useRef<HTMLButtonElement | undefined>();\n\n  return (\n    <>\n      <Flex align=\"center\" justify=\"between\" css={{ w: '100%' }}>\n        <Text as=\"h6\" variant=\"h6\">\n          Switch Role\n        </Text>\n        {isMobile && <CrossIcon onClick={() => onOpenChange(false)} />}\n      </Flex>\n\n      <Box>\n        <Text\n          variant=\"sm\"\n          css={{\n            mt: '$4',\n            mb: '$8',\n            c: '$on_surface_medium',\n            display: 'flex',\n            flexWrap: 'wrap',\n            columnGap: '4px',\n          }}\n        >\n          Switch the role of\n          <HighlightTerm value={peer.name} />\n          from <HighlightTerm value={peer.roleName} /> to\n        </Text>\n      </Box>\n      <Flex\n        align=\"center\"\n        css={{\n          w: '100%',\n          mb: '$10',\n        }}\n      >\n        <Box\n          css={{\n            position: 'relative',\n            flex: '1 1 0',\n            minWidth: 0,\n          }}\n        >\n          <Dropdown.Root open={open} onOpenChange={setOpen} css={{ width: '100%' }}>\n            <Dropdown.Trigger\n              // @ts-ignore\n              ref={triggerRef}\n              data-testid=\"open_role_selection_dropdown\"\n              asChild\n              css={{\n                bg: '$surface_default',\n                r: '$1',\n                p: '$6 $9',\n              }}\n            >\n              <Flex align=\"center\" justify=\"between\" css={{ width: '100%' }}>\n                <Text>{selectedRole}</Text>\n                {open ? <ChevronUpIcon /> : <ChevronDownIcon />}\n              </Flex>\n            </Dropdown.Trigger>\n\n            <Dropdown.Content align=\"start\" sideOffset={8} css={{ zIndex: 1000, w: '100%' }}>\n              {roles.map(role => (\n                <Dropdown.Item\n                  data-testid={role}\n                  key={role}\n                  onSelect={() => setRole(role)}\n                  css={{ w: `${triggerRef.current?.clientWidth}px` }}\n                >\n                  {role}\n                </Dropdown.Item>\n              ))}\n            </Dropdown.Content>\n          </Dropdown.Root>\n        </Box>\n      </Flex>\n      <Flex justify=\"center\" align=\"center\" css={{ width: '100%', gap: '$md' }}>\n        {!isMobile && (\n          <Button\n            variant=\"standard\"\n            outlined\n            css={{ width: '100%' }}\n            onClick={() => onOpenChange(false)}\n            data-testid=\"cancel_button\"\n          >\n            Cancel\n          </Button>\n        )}\n\n        <Button\n          data-testid=\"change_button\"\n          variant=\"primary\"\n          css={{ width: '100%' }}\n          onClick={async () => {\n            if (selectedRole) {\n              await hmsActions.changeRoleOfPeer(peer.id, selectedRole, true);\n              onOpenChange(false);\n            }\n          }}\n        >\n          Switch Role\n        </Button>\n      </Flex>\n    </>\n  );\n};\n\nexport const RoleChangeModal = ({\n  peerId,\n  onOpenChange,\n}: {\n  peerId: string;\n  onOpenChange: (open: boolean) => void;\n}) => {\n  const peer = useHMSStore(selectPeerByID(peerId));\n  const isMobile = useMedia(cssConfig.media.md);\n\n  if (!peer) {\n    return null;\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet.Root open={true} onOpenChange={onOpenChange} css={{ borderRadius: '$0 $0 0 0' }}>\n        <Sheet.Content css={{ p: '$10 $8', background: '$surface_dim', border: '1px solid $border_default' }}>\n          <RoleChangeContent peer={peer} onOpenChange={onOpenChange} isMobile />\n        </Sheet.Content>\n      </Sheet.Root>\n    );\n  }\n\n  return (\n    <Dialog.Root defaultOpen onOpenChange={onOpenChange}>\n      <Dialog.Portal>\n        <Dialog.Overlay />\n        <Dialog.Content css={{ width: 'min(400px,80%)', p: '$10', overflow: 'visible' }}>\n          <RoleChangeContent peer={peer} onOpenChange={onOpenChange} />\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n};\n", "import React, { useState } from 'react';\nimport { selectPermissions, useHMSActions, useHMSStore, useRecordingStreaming } from '@100mslive/react-sdk';\nimport { AlertTriangleIcon } from '@100mslive/react-icons';\nimport { Button, Dialog, Flex, Text } from '../../../';\nimport { ResolutionInput } from '../Streaming/ResolutionInput';\nimport { ToastManager } from '../Toast/ToastManager';\nimport { useRecordingHandler } from '../../common/hooks';\nimport { RTMP_RECORD_DEFAULT_RESOLUTION } from '../../common/constants';\n\nconst StartRecording = ({ open, onOpenChange }) => {\n  const permissions = useHMSStore(selectPermissions);\n  const [resolution, setResolution] = useState(RTMP_RECORD_DEFAULT_RESOLUTION);\n  const { startRecording, recordingStarted } = useRecordingHandler();\n  const { isBrowserRecordingOn, isStreamingOn, isHLSRunning } = useRecordingStreaming();\n  const hmsActions = useHMSActions();\n  if (!permissions?.browserRecording || isHLSRunning) {\n    return null;\n  }\n  if (isBrowserRecordingOn) {\n    return (\n      <Dialog.Root open={open} onOpenChange={onOpenChange}>\n        <Dialog.Portal>\n          <Dialog.Content\n            css={{\n              width: 'min(400px,80%)',\n              p: '$10',\n              bg: '#201617',\n            }}\n          >\n            <Dialog.Title>\n              <Flex gap={2} css={{ c: '$alert_error_default' }}>\n                <AlertTriangleIcon />\n                <Text css={{ c: 'inherit' }} variant=\"h6\">\n                  End Recording\n                </Text>\n              </Flex>\n            </Dialog.Title>\n            <Text variant=\"sm\" css={{ c: '$on_surface_medium', my: '$8' }}>\n              Are you sure you want to end recording? You can\u2019t undo this action.\n            </Text>\n            <Flex justify=\"end\" css={{ mt: '$12' }}>\n              <Dialog.Close asChild>\n                <Button outlined css={{ borderColor: '$secondary_bright', mr: '$4' }}>\n                  Don't end\n                </Button>\n              </Dialog.Close>\n              <Button\n                data-testid=\"stop_recording_confirm_mobile\"\n                variant=\"danger\"\n                icon\n                onClick={async () => {\n                  try {\n                    await hmsActions.stopRTMPAndRecording();\n                  } catch (error) {\n                    ToastManager.addToast({\n                      title: error.message,\n                      variant: 'error',\n                    });\n                  }\n                  onOpenChange(false);\n                }}\n              >\n                End recording\n              </Button>\n            </Flex>\n          </Dialog.Content>\n        </Dialog.Portal>\n      </Dialog.Root>\n    );\n  }\n  return (\n    <Dialog.Root open={open} onOpenChange={onOpenChange}>\n      <Dialog.Content css={{ width: 'min(400px,80%)', p: '$10' }}>\n        <Dialog.Title>\n          <Text variant=\"h6\">Start Recording</Text>\n        </Dialog.Title>\n        <ResolutionInput\n          testId=\"recording_resolution_mobile\"\n          css={{ flexDirection: 'column', alignItems: 'start' }}\n          onResolutionChange={setResolution}\n        />\n        <Button\n          data-testid=\"start_recording_confirm_mobile\"\n          variant=\"primary\"\n          icon\n          css={{ ml: 'auto' }}\n          type=\"submit\"\n          disabled={recordingStarted || isStreamingOn}\n          onClick={async () => {\n            await startRecording(resolution);\n            onOpenChange(false);\n          }}\n        >\n          Start\n        </Button>\n      </Dialog.Content>\n    </Dialog.Root>\n  );\n};\n\nexport default StartRecording;\n", "import React, { useCallback, useState } from 'react';\nimport { InfoIcon } from '@100mslive/react-icons';\nimport { Flex, Input, Label, Text, Tooltip } from '../../../';\nimport { DialogRow } from '../../primitives/DialogContent';\nimport {\n  RTMP_RECORD_DEFAULT_RESOLUTION,\n  RTMP_RECORD_RESOLUTION_MAX,\n  RTMP_RECORD_RESOLUTION_MIN,\n} from '../../common/constants';\n\nexport const ResolutionInput = ({ onResolutionChange, disabled, tooltipText, css, testId }) => {\n  const [resolution, setResolution] = useState(RTMP_RECORD_DEFAULT_RESOLUTION);\n\n  const resolutionChangeHandler = useCallback(\n    event => {\n      const { name, value } = event.target;\n      let width = name === 'resWidth' ? Number(value) : resolution.width;\n      let height = name === 'resHeight' ? Number(value) : resolution.height;\n\n      if (width === 0) {\n        width = null;\n      }\n      if (height === 0) {\n        height = null;\n      }\n      const newResolution = {\n        width: !isNaN(width) ? width : RTMP_RECORD_DEFAULT_RESOLUTION.width,\n        height: !isNaN(height) ? height : RTMP_RECORD_DEFAULT_RESOLUTION.height,\n      };\n      setResolution(newResolution);\n    },\n    [resolution],\n  );\n\n  return (\n    <DialogRow breakSm css={css}>\n      <Flex gap={1}>\n        <Label css={{ mb: '$8' }}>Resolution</Label>\n        {tooltipText && (\n          <Tooltip title={tooltipText}>\n            <div>\n              <InfoIcon color=\"#B0C3DB\" />\n            </div>\n          </Tooltip>\n        )}\n      </Flex>\n      <Flex\n        justify=\"between\"\n        css={{ width: !tooltipText ? '100%' : '70%', '@sm': { width: '100%' } }}\n        gap={2}\n        direction=\"column\"\n      >\n        <Flex justify=\"between\" gap={2}>\n          <Flex direction=\"column\" css={{ width: '50%' }}>\n            <Text variant=\"xs\">Width</Text>\n            <Input\n              data-testid={`${testId}_width`}\n              css={{ width: '100%', mt: '$4' }}\n              name=\"resWidth\"\n              value={resolution.width}\n              onChange={resolutionChangeHandler}\n              readOnly={disabled}\n              min={RTMP_RECORD_RESOLUTION_MIN}\n              max={RTMP_RECORD_RESOLUTION_MAX}\n              onBlur={() => onResolutionChange(resolution)}\n              type=\"number\"\n            />\n          </Flex>\n          <Flex direction=\"column\" css={{ width: '50%' }}>\n            <Text variant=\"xs\">Height</Text>\n            <Input\n              data-testid={`${testId}_height`}\n              css={{ width: '100%', mt: '$4' }}\n              name=\"resHeight\"\n              value={resolution.height}\n              onChange={resolutionChangeHandler}\n              onBlur={() => onResolutionChange(resolution)}\n              readOnly={disabled}\n              min={RTMP_RECORD_RESOLUTION_MIN}\n              max={RTMP_RECORD_RESOLUTION_MAX}\n              type=\"number\"\n            />\n          </Flex>\n        </Flex>\n      </Flex>\n    </DialogRow>\n  );\n};\n", "import React, { useRef } from 'react';\nimport { CheckIcon, CloudUploadIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Button } from '../../Button';\nimport { Checkbox } from '../../Checkbox';\nimport { HorizontalDivider } from '../../Divider';\nimport { IconButton } from '../../IconButton';\nimport { Input } from '../../Input';\nimport { Label } from '../../Label';\nimport { Box, Flex } from '../../Layout';\nimport { Dialog } from '../../Modal';\nimport { Select } from '../../Select';\nimport { Switch } from '../../Switch';\nimport { Text } from '../../Text';\nimport { flexCenter } from '../../utils';\n\nexport const DialogContent = ({ Icon, title, closeable = true, children, css, iconCSS = {}, ...props }) => {\n  return (\n    <Dialog.Portal>\n      <Dialog.Overlay />\n      <Dialog.Content css={{ width: 'min(600px, 100%)', ...css }} {...props}>\n        <Dialog.Title>\n          <Flex justify=\"between\">\n            <Flex align=\"center\" css={{ mb: '$1' }}>\n              {Icon ? (\n                <Flex css={{ mr: '$2', color: '$on_primary_high', ...flexCenter, ...iconCSS }}>\n                  <Icon />\n                </Flex>\n              ) : null}\n              <Text variant=\"h6\" inline>\n                {title}\n              </Text>\n            </Flex>\n            {closeable && <Dialog.DefaultClose data-testid=\"dialoge_cross_icon\" />}\n          </Flex>\n        </Dialog.Title>\n        <HorizontalDivider css={{ mt: '0.8rem' }} />\n        <Box>{children}</Box>\n      </Dialog.Content>\n    </Dialog.Portal>\n  );\n};\n\nexport const ErrorDialog = ({ open = true, onOpenChange, title, children, ...props }) => {\n  return (\n    <Dialog.Root open={open} onOpenChange={onOpenChange}>\n      <DialogContent\n        Icon={CrossIcon}\n        title={title}\n        onInteractOutside={e => e.preventDefault()}\n        onEscapeKeyDown={e => e.preventDefault()}\n        onPointerDownOutside={e => e.preventDefault()}\n        closeable={false}\n        iconCSS={{ color: '$alert_error_default' }}\n        {...props}\n      >\n        <Box css={{ mt: '$lg' }}>{children}</Box>\n      </DialogContent>\n    </Dialog.Root>\n  );\n};\n\nexport const RequestDialog = ({ open = true, onOpenChange, title, body, actionText = 'Accept', onAction, Icon }) => (\n  <Dialog.Root open={open} onOpenChange={onOpenChange}>\n    <Dialog.Portal>\n      <Dialog.Overlay />\n      <Dialog.Content css={{ width: 'min(400px,80%)', p: '$10' }}>\n        <Dialog.Title css={{ p: 0, display: 'flex', flexDirection: 'row', gap: '$md' }}>\n          {Icon ? Icon : null}\n          <Text variant=\"h6\">{title}</Text>\n        </Dialog.Title>\n        {typeof body === 'string' ? (\n          <Text\n            variant=\"md\"\n            css={{\n              fontWeight: 400,\n              mt: '$4',\n              mb: '$10',\n              c: '$on_surface_medium',\n            }}\n          >\n            {body}\n          </Text>\n        ) : (\n          <Box css={{ mt: '$4', mb: '$10' }}>{body}</Box>\n        )}\n        <Flex justify=\"center\" align=\"center\" css={{ width: '100%', gap: '$md' }}>\n          <Box css={{ width: '50%' }}>\n            <Dialog.Close css={{ width: '100%' }}>\n              <Button variant=\"standard\" outlined css={{ width: '100%' }}>\n                Cancel\n              </Button>\n            </Dialog.Close>\n          </Box>\n          <Box css={{ width: '50%' }}>\n            <Button variant=\"primary\" css={{ width: '100%' }} onClick={onAction}>\n              {actionText}\n            </Button>\n          </Box>\n        </Flex>\n      </Dialog.Content>\n    </Dialog.Portal>\n  </Dialog.Root>\n);\n\n/**\n * a row of items which breaks into column on small screen. For example title on left and options to select\n * from on right for select component.\n */\nexport const DialogRow = ({ children, breakSm = false, css, justify = 'between' }) => {\n  let finalCSS = {\n    margin: '$10 0',\n    w: '100%',\n  };\n  if (breakSm) {\n    finalCSS['@sm'] = {\n      flexDirection: 'column',\n      alignItems: 'flex-start',\n    };\n  }\n  if (css) {\n    finalCSS = Object.assign(finalCSS, css);\n  }\n  return (\n    <Flex align=\"center\" justify={justify} css={finalCSS}>\n      {children}\n    </Flex>\n  );\n};\n\nexport const DialogCol = ({ children, breakSm = false, css, align = 'center', justify = 'between', ...props }) => {\n  let finalCSS = {\n    margin: '$10 0',\n    w: '100%',\n  };\n  if (breakSm) {\n    finalCSS['@sm'] = {\n      alignItems: 'flex-start',\n    };\n  }\n  if (css) {\n    finalCSS = Object.assign(finalCSS, css);\n  }\n  return (\n    <Flex direction=\"column\" align={align} justify={justify} css={finalCSS} {...props}>\n      {children}\n    </Flex>\n  );\n};\n\n/**\n * key field and label field are optional, option is directly used if not passed\n */\nexport const DialogSelect = ({ title, options, keyField, labelField, selected, onChange, ...props }) => {\n  return (\n    <DialogRow breakSm>\n      <Label>{title}</Label>\n      <Select.Root data-testid={`dialog_select_${title}`} css={{ width: '70%', '@sm': { width: '100%' } }} {...props}>\n        <Select.DefaultDownIcon />\n        <Select.Select onChange={e => onChange(e.target.value)} value={selected} css={{ width: '100%' }}>\n          {options.map(option => {\n            const id = keyField ? option[keyField] : option;\n            const label = labelField ? option[labelField] : option;\n            return (\n              <option value={id} key={id}>\n                {label}\n              </option>\n            );\n          })}\n        </Select.Select>\n      </Select.Root>\n    </DialogRow>\n  );\n};\n\nexport const DialogInput = ({ title, value, onChange, placeholder, disabled, type, ...props }) => {\n  return (\n    <DialogRow breakSm>\n      <Label>{title}</Label>\n      <Input\n        css={{ width: '70%', '@sm': { width: '100%' }, bg: '$surface_bright' }}\n        value={value}\n        onChange={e => onChange(e.target.value)}\n        placeholder={placeholder}\n        disabled={disabled}\n        type={type}\n        {...props}\n      />\n    </DialogRow>\n  );\n};\n\nexport const DialogInputFile = ({ value, onChange, placeholder, disabled, type, ...props }) => {\n  const inputRef = useRef();\n  return (\n    <DialogCol\n      breakSm\n      onClick={() => inputRef.current?.click()}\n      css={{\n        justifyContent: 'center',\n        position: 'relative',\n        cursor: 'pointer',\n        py: '$12',\n        border: '1px dashed $border_bright',\n        r: '$1',\n        height: 'max(140px, 30%)',\n        alignItems: 'center',\n        m: '$6 0',\n      }}\n      gap=\"8\"\n    >\n      <IconButton\n        variant=\"standard\"\n        css={{\n          border: 'none',\n          background: 'none',\n          '&:hover': {\n            border: 'none',\n            background: 'none',\n            bg: 'transparent !important',\n          },\n        }}\n      >\n        <CloudUploadIcon\n          style={{\n            width: '3rem',\n            height: '3rem',\n          }}\n        />\n      </IconButton>\n      <Flex direction=\"row\">\n        <Input\n          ref={inputRef}\n          css={{ width: '70%', '@sm': { width: '100%' } }}\n          value={value}\n          onChange={e => onChange(e.target)}\n          placeholder={placeholder}\n          disabled={disabled}\n          type={type}\n          hidden={true}\n          {...props}\n        />\n        <IconButton\n          variant=\"standard\"\n          css={{\n            background: 'none',\n            border: 'none',\n            textDecoration: 'underline',\n            '&:hover': {\n              background: 'none !important',\n              border: 'none !important',\n            },\n          }}\n        >\n          <Text variant=\"md\">{placeholder}</Text>\n        </IconButton>\n      </Flex>\n    </DialogCol>\n  );\n};\n\nexport const DialogSwitch = ({ title, value, onChange, disabled }) => {\n  return (\n    <DialogRow>\n      <Text>{title}</Text>\n      <Flex justify=\"end\" css={{ width: '70%' }}>\n        <Switch checked={value} disabled={disabled} onCheckedChange={onChange} />\n      </Flex>\n    </DialogRow>\n  );\n};\n\nexport const DialogCheckbox = ({ title, value, onChange, disabled, css, id }) => {\n  return (\n    <DialogRow css={css}>\n      <Label htmlFor={id} css={{ cursor: 'pointer' }}>\n        {title}\n      </Label>\n      <Checkbox.Root checked={value} onCheckedChange={value => onChange(value)} disabled={disabled} id={id}>\n        <Checkbox.Indicator>\n          <CheckIcon width={16} height={16} />\n        </Checkbox.Indicator>\n      </Checkbox.Root>\n    </DialogRow>\n  );\n};\n", "import React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { match, P } from 'ts-pattern';\nimport {\n  selectHMSStats,\n  selectLocalPeerID,\n  selectPeersMap,\n  selectTracksMap,\n  useHMSStatsStore,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { HorizontalDivider } from '../../Divider';\nimport { Dropdown } from '../../Dropdown';\nimport { Label } from '../../Label';\nimport { Box, Flex } from '../../Layout';\nimport { Dialog } from '../../Modal';\nimport { formatBytes } from '../../Stats';\nimport { Switch } from '../../Switch';\nimport { Text } from '../../Text';\nimport { DialogDropdownTrigger } from '../primitives/DropdownTrigger';\nimport { useSetUiSettings } from './AppData/useUISettings';\nimport { useDropdownSelection } from './hooks/useDropdownSelection';\nimport { UI_SETTINGS } from '../common/constants';\n\nexport const StatsForNerds = ({ onOpenChange }) => {\n  const tracksWithLabels = useTracksWithLabel();\n  const statsOptions = useMemo(\n    () => [{ id: 'local-peer', label: 'Local Peer Stats' }, ...tracksWithLabels],\n    [tracksWithLabels],\n  );\n  const [selectedStat, setSelectedStat] = useState(statsOptions[0]);\n  const [showStatsOnTiles, setShowStatsOnTiles] = useSetUiSettings(UI_SETTINGS.showStatsOnTiles);\n  const [open, setOpen] = useState(false);\n  const ref = useRef();\n  const selectionBg = useDropdownSelection();\n\n  useEffect(() => {\n    if (selectedStat.id !== 'local-peer' && !tracksWithLabels.find(track => track.id === selectedStat.id)) {\n      setSelectedStat('local-peer');\n    }\n  }, [tracksWithLabels, selectedStat]);\n\n  return (\n    <Dialog.Root defaultOpen onOpenChange={onOpenChange}>\n      <Dialog.Portal>\n        <Dialog.Overlay />\n        <Dialog.Content\n          css={{\n            width: 'min(500px, 95%)',\n            maxHeight: '100%',\n            overflowY: 'auto',\n          }}\n        >\n          {/* Title */}\n          <Dialog.Title css={{ p: '$4 0' }}>\n            <Flex justify=\"between\">\n              <Flex align=\"center\" css={{ mb: '$1' }}>\n                <Text variant=\"h6\" inline>\n                  Stats For Nerds\n                </Text>\n              </Flex>\n              <Dialog.DefaultClose data-testid=\"stats_dialog_close_icon\" />\n            </Flex>\n          </Dialog.Title>\n          <HorizontalDivider css={{ mt: '0.8rem' }} />\n          {/* Switch */}\n          <Flex justify=\"start\" gap={4} css={{ m: '$10 0' }}>\n            <Switch checked={showStatsOnTiles} onCheckedChange={setShowStatsOnTiles} />\n            <Text variant=\"body2\" css={{ fontWeight: '$semiBold' }}>\n              Show Stats on Tiles\n            </Text>\n          </Flex>\n          {/* Select */}\n          <Flex\n            direction=\"column\"\n            css={{\n              mb: '$12',\n              position: 'relative',\n              minWidth: 0,\n            }}\n          >\n            <Label variant=\"body2\" css={{ c: '$on_surface_high' }}>\n              Stats For\n            </Label>\n            <Dropdown.Root data-testid=\"dialog_select_Stats For\" open={open} onOpenChange={setOpen}>\n              <DialogDropdownTrigger\n                title={selectedStat.label || 'Select Stats'}\n                css={{ mt: '$4' }}\n                titleCSS={{ mx: 0 }}\n                open={open}\n                ref={ref}\n              />\n              <Dropdown.Portal>\n                <Dropdown.Content align=\"start\" sideOffset={8} css={{ w: ref.current?.clientWidth, zIndex: 1000 }}>\n                  {statsOptions.map(option => {\n                    const isSelected = option.id === selectedStat.id && option.layer === selectedStat.layer;\n                    return (\n                      <Dropdown.Item\n                        key={`${option.id}-${option.layer || ''}`}\n                        onClick={() => {\n                          setSelectedStat(option);\n                        }}\n                        css={{\n                          px: '$9',\n                          bg: isSelected ? selectionBg : undefined,\n                          c: isSelected ? '$on_primary_high' : '$on_primary_high',\n                        }}\n                      >\n                        {option.label}\n                      </Dropdown.Item>\n                    );\n                  })}\n                </Dropdown.Content>\n              </Dropdown.Portal>\n            </Dropdown.Root>\n          </Flex>\n          {/* Stats */}\n          {selectedStat.id === 'local-peer' ? (\n            <LocalPeerStats />\n          ) : (\n            <TrackStats trackID={selectedStat.id} layer={selectedStat.layer} local={selectedStat.local} />\n          )}\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n};\n\nconst useTracksWithLabel = () => {\n  const tracksMap = useHMSStore(selectTracksMap);\n  const peersMap = useHMSStore(selectPeersMap);\n  const localPeerID = useHMSStore(selectLocalPeerID);\n  const tracksWithLabels = useMemo(\n    () =>\n      Object.values(tracksMap).reduce((res, track) => {\n        const peerName = peersMap[track.peerId]?.name;\n        const isLocalTrack = track.peerId === localPeerID;\n        if (isLocalTrack && track.layerDefinitions?.length) {\n          res = res.concat(\n            track.layerDefinitions.map(({ layer }) => {\n              return {\n                id: track.id,\n                layer,\n                local: true,\n                label: `${peerName} ${track.source} ${track.type} - ${layer}`,\n              };\n            }),\n          );\n          return res;\n        }\n        res.push({\n          id: track.id,\n          local: isLocalTrack,\n          label: `${peerName} ${track.source} ${track.type}`,\n        });\n        return res;\n      }, []),\n    [tracksMap, peersMap, localPeerID],\n  );\n  return tracksWithLabels;\n};\n\nconst LocalPeerStats = () => {\n  const stats = useHMSStatsStore(selectHMSStats.localPeerStats);\n\n  if (!stats) {\n    return null;\n  }\n\n  return (\n    <Flex css={{ flexWrap: 'wrap', gap: '$10' }}>\n      <StatsRow label=\"Packets Lost\" value={stats.subscribe?.packetsLost} />\n      <StatsRow label=\"Jitter\" value={stats.subscribe?.jitter} />\n      <StatsRow label=\"Publish Bitrate\" value={formatBytes(stats.publish?.bitrate, 'b/s')} />\n      <StatsRow label=\"Subscribe Bitrate\" value={formatBytes(stats.subscribe?.bitrate, 'b/s')} />\n      <StatsRow\n        label=\"Available Outgoing Bitrate\"\n        value={formatBytes(stats.publish?.availableOutgoingBitrate, 'b/s')}\n      />\n      <StatsRow label=\"Total Bytes Sent\" value={formatBytes(stats.publish?.bytesSent)} />\n      <StatsRow label=\"Total Bytes Received\" value={formatBytes(stats.subscribe?.bytesReceived)} />\n      <StatsRow\n        label=\"Round Trip Time\"\n        value={`${\n          (((stats.publish?.currentRoundTripTime || 0) + (stats.subscribe?.currentRoundTripTime || 0)) / 2).toFixed(3) *\n          1000\n        } ms`}\n      />\n    </Flex>\n  );\n};\n\nconst TrackStats = ({ trackID, layer, local }) => {\n  const selector = match({ trackID, layer, local })\n    .with(\n      {\n        layer: P.when(layer => !!layer),\n      },\n      () => selectHMSStats.localVideoTrackStatsByLayer(layer)(trackID),\n    )\n    .with({ local: P.when(local => !!local) }, () => selectHMSStats.localAudioTrackStatsByID(trackID))\n    .otherwise(() => selectHMSStats.trackStatsByID(trackID));\n  const stats = useHMSStatsStore(selector);\n  if (!stats) {\n    return null;\n  }\n  const inbound = stats.type.includes('inbound');\n\n  return (\n    <Flex css={{ flexWrap: 'wrap', gap: '$10' }}>\n      <StatsRow label=\"Type\" value={stats.type + ' ' + stats.kind} />\n      <StatsRow label=\"Bitrate\" value={formatBytes(stats.bitrate, 'b/s')} />\n      <StatsRow label=\"Packets Lost\" value={stats.packetsLost} />\n      <StatsRow label=\"Jitter\" value={stats.jitter?.toFixed(3)} />\n      <StatsRow\n        label={inbound ? 'Bytes Received' : 'Bytes Sent'}\n        value={formatBytes(inbound ? stats.bytesReceived : stats.bytesSent)}\n      />\n      {stats.kind === 'video' && (\n        <>\n          <StatsRow label=\"Framerate\" value={stats.framesPerSecond} />\n          {!inbound && <StatsRow label=\"Quality Limitation Reason\" value={stats.qualityLimitationReason} />}\n        </>\n      )}\n      <StatsRow\n        label=\"Round Trip Time\"\n        value={stats.roundTripTime ? `${(stats.roundTripTime * 1000).toFixed(3)} ms` : '-'}\n      />\n    </Flex>\n  );\n};\n\nconst StatsRow = React.memo(({ label, value }) => (\n  <Box css={{ bg: '$surface_bright', w: 'calc(50% - $6)', p: '$8', r: '$3' }}>\n    <Text\n      variant=\"overline\"\n      css={{\n        fontWeight: '$semiBold',\n        color: '$on_surface_medium',\n        textTransform: 'uppercase',\n      }}\n    >\n      {label}\n    </Text>\n    <Text variant=\"sub1\" css={{ fontWeight: '$semiBold', color: '$on_surface_high' }}>\n      {value || '-'}\n    </Text>\n  </Box>\n));\n", "import React, { useCallback, useRef, useState } from 'react';\nimport { useHMSActions } from '@100mslive/react-sdk';\nimport { AlertTriangleIcon, ChangeRoleIcon, CheckIcon } from '@100mslive/react-icons';\nimport { Button, Checkbox, Dialog, Dropdown, Flex, Loading, Text } from '../../../';\nimport { DialogContent, DialogRow } from '../../primitives/DialogContent';\nimport { DialogDropdownTrigger } from '../../primitives/DropdownTrigger';\nimport { useFilteredRoles } from '../../common/hooks';\n\nexport const BulkRoleChangeModal = ({ onOpenChange }) => {\n  const roles = useFilteredRoles();\n  const hmsActions = useHMSActions();\n  const ref = useRef(null);\n  const roleRef = useRef(null);\n  const [selectedBulkRole, setBulkRole] = useState([]);\n  const [selectedRole, setRole] = useState('');\n  const [bulkRoleDialog, setBulkRoleDialog] = useState(false);\n  const [roleDialog, setRoleDialog] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [isSubmiting, setIsSubmiting] = useState(false);\n\n  const changeBulkRole = useCallback(async () => {\n    if (selectedBulkRole.length > 0 && selectedRole) {\n      try {\n        setIsSubmiting(true);\n        await hmsActions.changeRoleOfPeersWithRoles(selectedBulkRole, selectedRole);\n        setIsSubmiting(false);\n        setErrorMessage('');\n        onOpenChange(false);\n      } catch (err) {\n        setErrorMessage(err?.message ? err?.message : 'Unknown error');\n        setIsSubmiting(false);\n      }\n    }\n  }, [selectedBulkRole, selectedRole, hmsActions, onOpenChange]);\n\n  return (\n    <Dialog.Root defaultOpen onOpenChange={onOpenChange}>\n      <DialogContent title=\"Bulk Role Change\" Icon={ChangeRoleIcon}>\n        <DialogRow>\n          <Text>For Roles: </Text>\n          <Dropdown.Root\n            open={bulkRoleDialog}\n            onOpenChange={value => {\n              if (value) {\n                setBulkRoleDialog(value);\n              }\n            }}\n            modal={false}\n          >\n            <DialogDropdownTrigger\n              ref={ref}\n              title={selectedBulkRole.length === 0 ? 'Select Multiple Roles' : selectedBulkRole.toString()}\n              css={{\n                w: '70%',\n                p: '$8',\n              }}\n              open={bulkRoleDialog}\n            />\n            <Dropdown.Content\n              css={{ w: ref.current?.clientWidth, zIndex: 1000 }}\n              onInteractOutside={() => {\n                if (bulkRoleDialog) {\n                  setBulkRoleDialog(false);\n                }\n              }}\n            >\n              {roles &&\n                roles.map(role => {\n                  return (\n                    <Dropdown.CheckboxItem\n                      key={role}\n                      checked={selectedBulkRole.includes(role)}\n                      onCheckedChange={value => {\n                        setBulkRole(selection => {\n                          return value ? [...selection, role] : selection.filter(selectedRole => selectedRole !== role);\n                        });\n                        setErrorMessage('');\n                      }}\n                    >\n                      <Checkbox.Root css={{ margin: '$2' }} checked={selectedBulkRole.includes(role)}>\n                        <Checkbox.Indicator>\n                          <CheckIcon width={16} height={16} />\n                        </Checkbox.Indicator>\n                      </Checkbox.Root>\n                      {role}\n                    </Dropdown.CheckboxItem>\n                  );\n                })}\n            </Dropdown.Content>\n          </Dropdown.Root>\n        </DialogRow>\n        <DialogRow>\n          <Text>To Role: </Text>\n          <Dropdown.Root open={roleDialog} onOpenChange={value => setRoleDialog(value)}>\n            <DialogDropdownTrigger\n              ref={roleRef}\n              title={selectedRole || 'Select Role'}\n              css={{\n                w: '70%',\n                p: '$8',\n              }}\n              open={roleDialog}\n            />\n            <Dropdown.Content css={{ w: roleRef.current?.clientWidth, zIndex: 1000 }}>\n              {roles &&\n                roles.map(role => {\n                  return (\n                    <Dropdown.Item\n                      key={role}\n                      onSelect={() => {\n                        setRole(role);\n                        setErrorMessage('');\n                      }}\n                    >\n                      {role}\n                    </Dropdown.Item>\n                  );\n                })}\n            </Dropdown.Content>\n          </Dropdown.Root>\n        </DialogRow>\n        <DialogRow>\n          {errorMessage && (\n            <Flex gap={2} css={{ c: '$alert_error_default', w: '70%', ml: 'auto' }}>\n              <AlertTriangleIcon />\n              <Text css={{ c: 'inherit' }}>{errorMessage}</Text>\n            </Flex>\n          )}\n        </DialogRow>\n        <DialogRow justify=\"end\">\n          <Button variant=\"primary\" onClick={changeBulkRole} disabled={!(selectedRole && selectedBulkRole.length > 0)}>\n            {isSubmiting && <Loading css={{ color: '$on_primary_medium' }} />}\n            Apply\n          </Button>\n        </DialogRow>\n      </DialogContent>\n    </Dialog.Root>\n  );\n};\n", "import React from 'react';\nimport { useMedia } from 'react-use';\nimport { config as cssConfig, Dialog } from '../../..';\nimport { Sheet } from '../../../Sheet';\nimport { CaptionContent } from './CaptionContent';\n\nexport const CaptionModal = ({ onOpenChange }: { onOpenChange: (value: boolean) => void }) => {\n  const isMobile = useMedia(cssConfig.media.md);\n\n  const props = {\n    isMobile,\n    onExit: () => {\n      onOpenChange(false);\n    },\n  };\n\n  if (isMobile) {\n    return (\n      <Sheet.Root defaultOpen onOpenChange={onOpenChange}>\n        <Sheet.Content css={{ bg: '$surface_dim', p: '$8 0' }}>\n          <CaptionContent {...props} />\n        </Sheet.Content>\n      </Sheet.Root>\n    );\n  }\n\n  return (\n    <Dialog.Root defaultOpen onOpenChange={onOpenChange}>\n      <Dialog.Portal>\n        <Dialog.Overlay />\n        <Dialog.Content css={{ bg: '$surface_dim', width: 'min(400px,80%)', p: '$10' }}>\n          <CaptionContent {...props} />\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n};\n", "import React from 'react';\nimport { HMSTranscriptionMode, selectIsTranscriptionEnabled, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { AlertTriangleIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Button } from '../../../Button';\nimport { Box, Flex } from '../../../Layout';\nimport { Loading } from '../../../Loading';\nimport { Text } from '../../../Text';\n// @ts-ignore: No implicit Any\nimport { ToastManager } from '../Toast/ToastManager';\n// @ts-ignore: No implicit Any\nimport { useSetAppDataByKey, useSetIsCaptionEnabled } from '../AppData/useUISettings';\nimport { CAPTION_TOAST } from '../../common/constants';\n\nexport const CaptionContent = ({ isMobile, onExit }: { isMobile: boolean; onExit: () => void }) => {\n  const DURATION = 2000;\n  const actions = useHMSActions();\n  const isTranscriptionEnabled = useHMSStore(selectIsTranscriptionEnabled);\n  const [toastId, setToastId] = useSetAppDataByKey(CAPTION_TOAST.captionToast);\n\n  const [isCaptionEnabled, setIsCaptionEnabled] = useSetIsCaptionEnabled();\n\n  return (\n    <>\n      <Text\n        variant={isMobile ? 'md' : 'lg'}\n        css={{\n          color: '$on_surface_high',\n          fontWeight: '$semiBold',\n          display: 'flex',\n          '@md': { px: '$8' },\n        }}\n      >\n        {isTranscriptionEnabled ? 'Disable' : 'Enable'} Closed Caption (CC) for this session?\n        <Box\n          css={{ color: 'inherit', ml: 'auto', '&:hover': { color: '$on_surface_medium', cursor: 'pointer' } }}\n          onClick={onExit}\n        >\n          <CrossIcon />\n        </Box>\n      </Text>\n      {!isMobile ? (\n        <Text variant=\"sm\" css={{ color: '$on_surface_medium', mt: '$4', '@md': { px: '$8' } }}>\n          This will {isTranscriptionEnabled ? 'disable' : 'enable'} Closed Captions for everyone in this room. You\n          can&nbsp;\n          {isTranscriptionEnabled ? 'enable' : 'disable'} it later.\n        </Text>\n      ) : null}\n\n      <Flex\n        justify=\"between\"\n        align=\"center\"\n        css={{\n          width: '100%',\n          gap: '$md',\n          mt: '$10',\n          '@md': { px: '$4' },\n        }}\n      >\n        {isMobile ? null : (\n          <Button variant=\"standard\" css={{ w: '100%' }} outlined onClick={onExit}>\n            Cancel\n          </Button>\n        )}\n        <Flex\n          direction=\"column\"\n          justify=\"between\"\n          align=\"center\"\n          css={{\n            width: '100%',\n            '@md': { px: '$4' },\n          }}\n        >\n          {isMobile && isTranscriptionEnabled ? (\n            <Button\n              variant=\"standard\"\n              css={{ w: '100%', mb: '$4' }}\n              outlined\n              onClick={() => {\n                setIsCaptionEnabled(!isCaptionEnabled);\n                onExit();\n              }}\n            >\n              {isCaptionEnabled ? 'Hide For Me' : 'Show For Me'}\n            </Button>\n          ) : null}\n          <Button\n            variant={isTranscriptionEnabled ? 'danger' : 'primary'}\n            css={{ width: '100%' }}\n            data-testid=\"popup_change_btn\"\n            onClick={async () => {\n              try {\n                if (isTranscriptionEnabled) {\n                  await actions.stopTranscription({\n                    mode: HMSTranscriptionMode.CAPTION,\n                  });\n                  setIsCaptionEnabled(false);\n                  const id = ToastManager.replaceToast(toastId, {\n                    title: `Disabling Closed Caption for everyone.`,\n                    variant: 'standard',\n                    duration: DURATION,\n                    icon: <Loading color=\"currentColor\" />,\n                  });\n                  setToastId(id);\n                  onExit();\n                  return;\n                }\n                await actions.startTranscription({\n                  mode: HMSTranscriptionMode.CAPTION,\n                });\n                const id = ToastManager.replaceToast(toastId, {\n                  title: `Enabling Closed Caption for everyone.`,\n                  variant: 'standard',\n                  duration: DURATION,\n                  icon: <Loading color=\"currentColor\" />,\n                });\n                setToastId(id);\n              } catch (err) {\n                const id = ToastManager.replaceToast(toastId, {\n                  title: `Failed to ${isTranscriptionEnabled ? 'disable' : 'enable'} closed caption`,\n                  variant: 'error',\n                  icon: <AlertTriangleIcon style={{ marginRight: '0.5rem' }} />,\n                });\n                setToastId(id);\n              } finally {\n                setIsCaptionEnabled(true);\n              }\n              onExit();\n            }}\n          >\n            {isTranscriptionEnabled ? 'Disable' : 'Enable'} for Everyone\n          </Button>\n        </Flex>\n      </Flex>\n      {isMobile && (\n        <Text variant=\"sm\" css={{ color: '$on_surface_medium', pb: '$4', mb: '$8', '@md': { px: '$8', mt: '$4' } }}>\n          This will {isTranscriptionEnabled ? 'disable' : 'enable'} Closed Captions for everyone in this room. You\n          can&nbsp;\n          {isTranscriptionEnabled ? 'enable' : 'disable'} it later.\n        </Text>\n      )}\n    </>\n  );\n};\n", "import React from 'react';\nimport { ExpandIcon } from '@100mslive/react-icons';\nimport { Dropdown, Text } from '../../..';\nimport { useFullscreen } from '../hooks/useFullscreen';\n\nexport const FullScreenItem = () => {\n  const { allowed, isFullscreen, toggleFullscreen } = useFullscreen();\n\n  if (!allowed) {\n    return null;\n  }\n\n  return (\n    <Dropdown.Item\n      onClick={() => {\n        toggleFullscreen();\n      }}\n      data-testid=\"full_screen_btn\"\n    >\n      <ExpandIcon />\n      <Text variant=\"sm\" css={{ ml: '$4' }}>\n        {isFullscreen ? 'Exit ' : 'Go '}Fullscreen\n      </Text>\n    </Dropdown.Item>\n  );\n};\n", "import { useCallback, useEffect, useState } from 'react';\nimport screenfull from 'screenfull';\n// @ts-ignore: No implicit any\nimport { ToastManager } from '../Toast/ToastManager';\nimport { DEFAULT_PORTAL_CONTAINER } from '../../common/constants';\n\nexport const useFullscreen = () => {\n  const [isFullScreenEnabled, setIsFullScreenEnabled] = useState(screenfull.isFullscreen);\n\n  const toggle = useCallback(async () => {\n    if (!screenfull.isEnabled) {\n      ToastManager.addToast({ title: 'Fullscreen feature not supported' });\n      return;\n    }\n    try {\n      const container = document.querySelector(DEFAULT_PORTAL_CONTAINER);\n      if (isFullScreenEnabled) {\n        await screenfull.exit();\n      } else if (container) {\n        await screenfull.request(container);\n      }\n    } catch (err) {\n      ToastManager.addToast({ title: (err as Error).message });\n    }\n  }, [isFullScreenEnabled]);\n\n  useEffect(() => {\n    const onChange = () => {\n      setIsFullScreenEnabled(screenfull.isFullscreen);\n    };\n    if (screenfull.isEnabled) {\n      screenfull.on('change', onChange);\n    }\n    return () => {\n      if (screenfull.isEnabled) {\n        screenfull.off('change', onChange);\n      }\n    };\n  }, []);\n\n  return {\n    allowed: screenfull.isEnabled,\n    isFullscreen: isFullScreenEnabled,\n    toggleFullscreen: toggle,\n  };\n};\n", "import React, { useCallback, useState } from 'react';\nimport {\n  HMSRoleName,\n  HMSTrackSource,\n  HMSTrackType,\n  selectAvailableRoleNames,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { MicOffIcon } from '@100mslive/react-icons';\nimport { Dialog } from '../../..';\nimport { Sheet } from '../../../Sheet';\n// @ts-ignore: No implicit any\nimport { DialogContent } from '../../primitives/DialogContent';\nimport { MuteAllContent } from './MuteAllContent';\n\nexport const MuteAllModal = ({\n  onOpenChange,\n  isMobile = false,\n}: {\n  onOpenChange: (value: boolean) => void;\n  isMobile?: boolean;\n}) => {\n  const roles = useHMSStore(selectAvailableRoleNames);\n  const hmsActions = useHMSActions();\n  const [enabled, setEnabled] = useState(false);\n  const [trackType, setTrackType] = useState<HMSTrackType>();\n  const [selectedRole, setRole] = useState<HMSRoleName>();\n  const [selectedSource, setSource] = useState<HMSTrackSource>();\n\n  const muteAll = useCallback(async () => {\n    await hmsActions.setRemoteTracksEnabled({\n      enabled: enabled,\n      type: trackType,\n      source: selectedSource,\n      roles: selectedRole ? [selectedRole] : undefined,\n    });\n    onOpenChange(false);\n  }, [selectedRole, enabled, trackType, selectedSource, hmsActions, onOpenChange]);\n\n  const props = {\n    muteAll,\n    roles,\n    enabled,\n    setEnabled,\n    trackType,\n    setTrackType,\n    selectedRole,\n    setRole,\n    selectedSource,\n    setSource,\n    isMobile,\n  };\n\n  if (isMobile) {\n    return (\n      <Sheet.Root defaultOpen onOpenChange={onOpenChange}>\n        <Sheet.Content css={{ px: '$10' }}>\n          <MuteAllContent {...props} />\n        </Sheet.Content>\n      </Sheet.Root>\n    );\n  }\n\n  return (\n    <Dialog.Root defaultOpen onOpenChange={onOpenChange}>\n      <DialogContent title=\"Mute/Unmute Remote Tracks\" Icon={MicOffIcon}>\n        <MuteAllContent {...props} />\n      </DialogContent>\n    </Dialog.Root>\n  );\n};\n", "import React from 'react';\nimport { HMSRoleName, HMSTrackSource, HMSTrackType, selectPermissions, useHMSStore } from '@100mslive/react-sdk';\nimport { Button } from '../../../Button';\nimport { Label } from '../../../Label';\nimport { Flex } from '../../../Layout';\nimport { RadioGroup } from '../../../RadioGroup';\nimport { Text } from '../../../Text';\n// @ts-ignore: No implicit any\nimport { DialogRow, DialogSelect } from '../../primitives/DialogContent';\nimport { trackSourceOptions, trackTypeOptions } from './constants';\n\nexport const MuteAllContent = (props: {\n  muteAll: () => Promise<void>;\n  roles?: HMSRoleName[];\n  enabled: boolean;\n  setEnabled: (value: boolean) => void;\n  trackType?: HMSTrackType;\n  setTrackType: (value: HMSTrackType) => void;\n  selectedRole?: HMSRoleName;\n  setRole: (value: HMSRoleName) => void;\n  selectedSource?: HMSTrackSource;\n  setSource: (value: HMSTrackSource) => void;\n  isMobile: boolean;\n}) => {\n  const roles = props.roles || [];\n  const permissions = useHMSStore(selectPermissions);\n  return (\n    <>\n      <DialogSelect\n        title=\"Role\"\n        options={[{ label: 'All Roles', value: '' }, ...roles.map(role => ({ label: role, value: role }))]}\n        selected={props.selectedRole}\n        keyField=\"value\"\n        labelField=\"label\"\n        onChange={props.setRole}\n      />\n      <DialogSelect\n        title=\"Track type\"\n        options={trackTypeOptions}\n        selected={props.trackType}\n        onChange={props.setTrackType}\n        keyField=\"value\"\n        labelField=\"label\"\n      />\n      <DialogSelect\n        title=\"Track source\"\n        options={trackSourceOptions}\n        selected={props.selectedSource}\n        onChange={props.setSource}\n        keyField=\"value\"\n        labelField=\"label\"\n      />\n      <DialogRow>\n        <Text variant=\"md\">Track status</Text>\n        <RadioGroup.Root value={String(props.enabled)} onValueChange={value => props.setEnabled(value === 'true')}>\n          {permissions?.mute && (\n            <Flex align=\"center\" css={{ mr: '$8' }}>\n              <RadioGroup.Item value=\"false\" id=\"trackDisableRadio\" css={{ mr: '$4' }}>\n                <RadioGroup.Indicator />\n              </RadioGroup.Item>\n              <Label htmlFor=\"trackDisableRadio\">Mute</Label>\n            </Flex>\n          )}\n          {permissions?.unmute && (\n            <Flex align=\"center\" css={{ cursor: 'pointer' }}>\n              <RadioGroup.Item value=\"true\" id=\"trackEnableRadio\" css={{ mr: '$4' }}>\n                <RadioGroup.Indicator />\n              </RadioGroup.Item>\n              <Label htmlFor=\"trackEnableRadio\">Request Unmute</Label>\n            </Flex>\n          )}\n        </RadioGroup.Root>\n      </DialogRow>\n      <DialogRow justify=\"end\">\n        <Button variant=\"primary\" onClick={props.muteAll} css={{ w: props?.isMobile ? '100%' : '' }}>\n          Apply\n        </Button>\n      </DialogRow>\n    </>\n  );\n};\n", "import { useCallback } from 'react';\nimport {\n  selectHasPeerHandRaised,\n  selectLocalPeerID,\n  selectPeerMetadata,\n  useHMSActions,\n  useHMSStore,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\n\nexport const useMyMetadata = () => {\n  const hmsActions = useHMSActions();\n  const localPeerId = useHMSStore(selectLocalPeerID);\n  const vanillaStore = useHMSVanillaStore();\n  const metaData = useHMSStore(selectPeerMetadata(localPeerId));\n  const isHandRaised = useHMSStore(selectHasPeerHandRaised(localPeerId));\n\n  const update = async (updatedFields: Record<string, any>) => {\n    try {\n      // get current state from store and merge updated fields\n      const currentMetadata = vanillaStore.getState(selectPeerMetadata(localPeerId));\n      await hmsActions.changeMetadata(Object.assign(currentMetadata, updatedFields));\n      return true;\n    } catch (error) {\n      console.error('failed to update metadata ', updatedFields);\n    }\n    return false;\n  };\n\n  const toggleHandRaise = useCallback(async () => {\n    if (isHandRaised) {\n      await hmsActions.lowerLocalPeerHand();\n      await update({ handRaisedAt: undefined });\n    } else {\n      await hmsActions.raiseLocalPeerHand();\n      await update({ isBRBOn: false, handRaisedAt: Date.now() });\n    }\n  }, [isHandRaised]); //eslint-disable-line\n\n  const toggleBRB = useCallback(async () => {\n    const newValue = !metaData?.isBRBOn;\n    await update({ isBRBOn: newValue });\n    if (newValue) {\n      await hmsActions.lowerLocalPeerHand();\n    }\n  }, [metaData?.isBRBOn]); //eslint-disable-line\n\n  return {\n    isHandRaised,\n    isBRBOn: !!metaData?.isBRBOn,\n    metaData,\n    updateMetaData: update,\n    toggleHandRaise,\n    toggleBRB,\n  };\n};\n", "import { useEffect } from 'react';\nimport { useHMSActions } from '@100mslive/react-sdk';\nimport { getCssText } from '../../../Theme';\nimport { usePIPWindow } from './usePIPWindow';\n\nexport const usePIPChat = () => {\n  const hmsActions = useHMSActions();\n  const { isSupported, requestPipWindow, pipWindow, closePipWindow } = usePIPWindow();\n\n  useEffect(() => {\n    if (document && pipWindow) {\n      const style = document.createElement('style');\n      style.id = 'stitches';\n      style.textContent = getCssText();\n      pipWindow.document.head.appendChild(style);\n    }\n  }, [pipWindow]);\n\n  // @ts-ignore\n  useEffect(() => {\n    if (pipWindow) {\n      const chatContainer = pipWindow.document.getElementById('chat-container');\n      const selector = pipWindow.document.getElementById('selector') as HTMLSelectElement;\n      const sendBtn = pipWindow.document.getElementById('send-btn');\n      const pipChatInput = pipWindow.document.getElementById('chat-input') as HTMLTextAreaElement;\n      const marker = pipWindow.document.getElementById('marker');\n\n      marker?.scrollIntoView({ block: 'end' });\n\n      const observer = new IntersectionObserver(\n        entries => {\n          entries.forEach(entry => {\n            if (entry.isIntersecting && entry.target.id) {\n              hmsActions.setMessageRead(true, entry.target.id);\n            }\n          });\n        },\n        {\n          root: chatContainer,\n          threshold: 0.8,\n        },\n      );\n\n      const mutationObserver = new MutationObserver(mutations => {\n        mutations.forEach(mutation => {\n          if (mutation.addedNodes.length > 0) {\n            const newMessages = mutation.addedNodes;\n            newMessages.forEach(message => {\n              const messageId = (message as Element)?.id;\n              if (messageId === 'new-message-notif') {\n                message.addEventListener('click', () =>\n                  setTimeout(() => marker?.scrollIntoView({ block: 'end', behavior: 'smooth' }), 0),\n                );\n              } else if (messageId) observer.observe(message as Element);\n            });\n          }\n        });\n      });\n      mutationObserver.observe(chatContainer as Node, {\n        childList: true,\n      });\n\n      const sendMessage = async () => {\n        const selection = selector?.value || 'Everyone';\n        if (selection === 'Everyone') {\n          await hmsActions.sendBroadcastMessage(pipChatInput.value.trim());\n        } else {\n          await hmsActions.sendGroupMessage(pipChatInput.value.trim(), [selection]);\n        }\n        pipChatInput.value = '';\n        setTimeout(() => marker?.scrollIntoView({ block: 'end', behavior: 'smooth' }), 0);\n      };\n\n      if (sendBtn && hmsActions && pipChatInput) {\n        const pipMessages = pipWindow.document.getElementsByClassName('pip-message');\n        // @ts-ignore\n        [...pipMessages].forEach(message => {\n          if (message.id) {\n            hmsActions.setMessageRead(true, message.id);\n          }\n        });\n        // @ts-ignore\n        const sendOnEnter = e => {\n          if (e.key === 'Enter') sendMessage();\n        };\n        sendBtn.addEventListener('click', sendMessage);\n        pipChatInput.addEventListener('keypress', sendOnEnter);\n        return () => {\n          sendBtn.removeEventListener('click', sendMessage);\n          pipChatInput.removeEventListener('keypress', sendOnEnter);\n          mutationObserver.disconnect();\n          observer.disconnect();\n        };\n      }\n    }\n  }, [pipWindow, hmsActions]);\n\n  useEffect(() => {\n    return () => {\n      pipWindow && closePipWindow();\n    };\n  }, [closePipWindow, pipWindow]);\n\n  return { isSupported, requestPipWindow, pipWindow };\n};\n", "import { useContext } from 'react';\nimport { PIPContext, PIPContextType } from './context';\n\nexport const usePIPWindow = (): PIPContextType => {\n  const context = useContext(PIPContext);\n\n  if (context === undefined) {\n    throw new Error('usePIPWindow must be used within a PIPContext');\n  }\n\n  return context;\n};\n", "import { createContext } from 'react';\n\nexport type PIPContextType = {\n  isSupported: boolean;\n  pipWindow: Window | null;\n  requestPipWindow: (width: number, height: number) => Promise<void>;\n  closePipWindow: () => void;\n};\n\nexport const PIPContext = createContext<PIPContextType | undefined>(undefined);\n", "import React, { useRef, useState } from 'react';\nimport { useClickAway } from 'react-use';\nimport { ConferencingScreen, DefaultConferencingScreen_Elements } from '@100mslive/types-prebuilt';\nimport { match } from 'ts-pattern';\nimport {\n  HMSTranscriptionMode,\n  selectIsConnectedToRoom,\n  selectIsLocalVideoEnabled,\n  selectIsTranscriptionAllowedByMode,\n  selectIsTranscriptionEnabled,\n  selectPeerCount,\n  selectPermissions,\n  useHMSActions,\n  useHMSStore,\n  useRecordingStreaming,\n} from '@100mslive/react-sdk';\nimport {\n  BrbIcon,\n  ClosedCaptionIcon,\n  CrossIcon,\n  EmojiIcon,\n  HamburgerMenuIcon,\n  HandIcon,\n  HandRaiseSlashedIcon,\n  InfoIcon,\n  OpenCaptionIcon,\n  PeopleIcon,\n  QuizActiveIcon,\n  QuizIcon,\n  RecordIcon,\n  SettingsIcon,\n  VirtualBackgroundIcon,\n} from '@100mslive/react-icons';\nimport { Box, Loading, Tooltip } from '../../../..';\nimport { Sheet } from '../../../../Sheet';\n// @ts-ignore: No implicit any\nimport IconButton from '../../../IconButton';\nimport { NoiseCancellation } from '../../AudioVideoToggle';\n// @ts-ignore: No implicit any\nimport { EmojiReaction } from '../../EmojiReaction';\n// @ts-ignore: No implicit any\nimport { StopRecordingInSheet } from '../../Header/StreamActions';\n// @ts-ignore: No implicit any\nimport SettingsModal from '../../Settings/SettingsModal';\n// @ts-ignore: No implicit any\nimport { ToastManager } from '../../Toast/ToastManager';\n// @ts-ignore: No implicit any\nimport { ActionTile } from '../ActionTile';\nimport { CaptionModal } from '../CaptionModal';\n// @ts-ignore: No implicit any\nimport { ChangeNameModal } from '../ChangeNameModal';\n// @ts-ignore: No implicit any\nimport { MuteAllModal } from '../MuteAllModal';\nimport { useRoomLayoutHeader } from '../../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useSheetToggle } from '../../AppData/useSheet';\n// @ts-ignore: No implicit any\nimport { usePollViewToggle, useSidepaneToggle } from '../../AppData/useSidepane';\n// @ts-ignore: No implicit Any\nimport { useSetIsCaptionEnabled, useShowPolls } from '../../AppData/useUISettings';\n// @ts-ignore: No implicit any\nimport { useDropdownList } from '../../hooks/useDropdownList';\nimport { useMyMetadata } from '../../hooks/useMetadata';\nimport { useUnreadPollQuizPresent } from '../../hooks/useUnreadPollQuizPresent';\nimport { useLandscapeHLSStream, useMobileHLSStream, useRecordingHandler } from '../../../common/hooks';\n// @ts-ignore: No implicit any\nimport { getFormattedCount } from '../../../common/utils';\n// @ts-ignore: No implicit any\nimport { SHEET_OPTIONS, SIDE_PANE_OPTIONS } from '../../../common/constants';\n\nconst MODALS = {\n  CHANGE_NAME: 'changeName',\n  SELF_ROLE_CHANGE: 'selfRoleChange',\n  MORE_SETTINGS: 'moreSettings',\n  START_RECORDING: 'startRecording',\n  DEVICE_SETTINGS: 'deviceSettings',\n  STATS_FOR_NERDS: 'statsForNerds',\n  BULK_ROLE_CHANGE: 'bulkRoleChange',\n  MUTE_ALL: 'muteAll',\n  EMBED_URL: 'embedUrl',\n  CAPTION: 'caption',\n};\n\nexport const MwebOptions = ({\n  elements,\n  screenType,\n}: {\n  elements: DefaultConferencingScreen_Elements;\n  screenType: keyof ConferencingScreen;\n}) => {\n  const hmsActions = useHMSActions();\n  const permissions = useHMSStore(selectPermissions);\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const { isBrowserRecordingOn, isStreamingOn, isHLSRunning } = useRecordingStreaming();\n  const [openModals, setOpenModals] = useState(new Set());\n  const [openOptionsSheet, setOpenOptionsSheet] = useState(false);\n  const [openSettingsSheet, setOpenSettingsSheet] = useState(false);\n  const [showEmojiCard, setShowEmojiCard] = useState(false);\n  const [showRecordingOn, setShowRecordingOn] = useState(false);\n  const toggleParticipants = useSidepaneToggle(SIDE_PANE_OPTIONS.PARTICIPANTS);\n  const { showPolls } = useShowPolls();\n  const togglePollView = usePollViewToggle();\n  const peerCount = useHMSStore(selectPeerCount);\n  const emojiCardRef = useRef(null);\n  const { isBRBOn, toggleBRB, isHandRaised, toggleHandRaise } = useMyMetadata();\n  const { unreadPollQuiz, setUnreadPollQuiz } = useUnreadPollQuizPresent();\n  const { title, description } = useRoomLayoutHeader();\n  const toggleDetailsSheet = useSheetToggle(SHEET_OPTIONS.ROOM_DETAILS);\n  const isMobileHLSStream = useMobileHLSStream();\n  const isLandscapeHLSStream = useLandscapeHLSStream();\n  const toggleVB = useSidepaneToggle(SIDE_PANE_OPTIONS.VB);\n  const isLocalVideoEnabled = useHMSStore(selectIsLocalVideoEnabled);\n  const { startRecording, isRecordingLoading } = useRecordingHandler();\n  const isTranscriptionAllowed = useHMSStore(selectIsTranscriptionAllowedByMode(HMSTranscriptionMode.CAPTION));\n  const isTranscriptionEnabled = useHMSStore(selectIsTranscriptionEnabled);\n\n  const [isCaptionEnabled] = useSetIsCaptionEnabled();\n  useDropdownList({ open: openModals.size > 0 || openOptionsSheet || openSettingsSheet, name: 'MoreSettings' });\n\n  const updateState = (modalName: string, value: boolean) => {\n    setOpenModals(modals => {\n      const copy = new Set(modals);\n      if (value) {\n        copy.add(modalName);\n      } else {\n        copy.delete(modalName);\n      }\n      return copy;\n    });\n  };\n\n  useClickAway(emojiCardRef, () => setShowEmojiCard(false));\n\n  return (\n    <>\n      <Sheet.Root open={openOptionsSheet} onOpenChange={setOpenOptionsSheet}>\n        <Tooltip title=\"More options\">\n          <Sheet.Trigger asChild data-testid=\"more_settings_btn\">\n            <IconButton css={{ bg: isMobileHLSStream || isLandscapeHLSStream ? '$surface_default' : '' }}>\n              <HamburgerMenuIcon />\n            </IconButton>\n          </Sheet.Trigger>\n        </Tooltip>\n        <Sheet.Content css={{ bg: '$surface_dim', pb: '$14' }}>\n          <Sheet.Title\n            css={{\n              display: 'flex',\n              color: '$on_surface_high',\n              w: '100%',\n              justifyContent: 'space-between',\n              fontSize: '$md',\n              mt: '$8',\n              px: '$10',\n              pb: '$8',\n              borderBottom: '1px solid $border_default',\n              mb: '$8',\n              alignItems: 'center',\n            }}\n          >\n            Options\n            <Sheet.Close>\n              <Box css={{ color: '$on_surface_high' }}>\n                <CrossIcon />\n              </Box>\n            </Sheet.Close>\n          </Sheet.Title>\n          <Box\n            css={{\n              display: 'grid',\n              gridTemplateColumns: '1fr 1fr 1fr',\n              gridTemplateRows: 'auto',\n              gridColumnGap: '$6',\n              gridRowGap: '$8',\n              px: '$9',\n            }}\n          >\n            {elements?.participant_list && (\n              <ActionTile.Root\n                onClick={() => {\n                  toggleParticipants();\n                  setOpenOptionsSheet(false);\n                }}\n              >\n                <ActionTile.Count>{getFormattedCount(peerCount)}</ActionTile.Count>\n                <PeopleIcon />\n                <ActionTile.Title>Participants</ActionTile.Title>\n              </ActionTile.Root>\n            )}\n\n            {elements.hand_raise ? (\n              <ActionTile.Root\n                active={isHandRaised}\n                onClick={() => {\n                  toggleHandRaise();\n                  setOpenOptionsSheet(false);\n                }}\n              >\n                {isHandRaised ? <HandRaiseSlashedIcon /> : <HandIcon />}\n                <ActionTile.Title>{isHandRaised ? 'Lower' : 'Raise'} Hand</ActionTile.Title>\n              </ActionTile.Root>\n            ) : null}\n            <NoiseCancellation setOpenOptionsSheet={setOpenOptionsSheet} actionTile />\n            {isTranscriptionAllowed ? (\n              <ActionTile.Root\n                onClick={() => {\n                  setOpenOptionsSheet(false);\n                  updateState(MODALS.CAPTION, true);\n                }}\n              >\n                {isTranscriptionEnabled && isCaptionEnabled ? <ClosedCaptionIcon /> : <OpenCaptionIcon />}\n                <ActionTile.Title>Closed Caption</ActionTile.Title>\n              </ActionTile.Root>\n            ) : null}\n            {isLocalVideoEnabled && !!elements?.virtual_background ? (\n              <ActionTile.Root\n                onClick={() => {\n                  toggleVB();\n                  setOpenOptionsSheet(false);\n                }}\n              >\n                <VirtualBackgroundIcon />\n                <ActionTile.Title>Virtual Background</ActionTile.Title>\n              </ActionTile.Root>\n            ) : null}\n\n            {elements?.emoji_reactions && !(isLandscapeHLSStream || isMobileHLSStream) && (\n              <ActionTile.Root\n                onClick={() => {\n                  setShowEmojiCard(true);\n                  setOpenOptionsSheet(false);\n                }}\n              >\n                <EmojiIcon />\n                <ActionTile.Title>Emoji Reactions</ActionTile.Title>\n              </ActionTile.Root>\n            )}\n\n            {showPolls && (\n              <ActionTile.Root\n                onClick={() => {\n                  togglePollView();\n                  setOpenOptionsSheet(false);\n                  setUnreadPollQuiz(false);\n                }}\n              >\n                {unreadPollQuiz ? <QuizActiveIcon /> : <QuizIcon />}\n                <ActionTile.Title>Polls and Quizzes</ActionTile.Title>\n              </ActionTile.Root>\n            )}\n\n            {elements?.brb && (\n              <ActionTile.Root\n                active={isBRBOn}\n                onClick={() => {\n                  toggleBRB();\n                  setOpenOptionsSheet(false);\n                }}\n              >\n                <BrbIcon />\n                <ActionTile.Title>Be Right Back</ActionTile.Title>\n              </ActionTile.Root>\n            )}\n\n            <ActionTile.Root\n              onClick={() => {\n                setOpenSettingsSheet(true);\n                setOpenOptionsSheet(false);\n              }}\n            >\n              <SettingsIcon />\n              <ActionTile.Title>Settings</ActionTile.Title>\n            </ActionTile.Root>\n\n            {isConnected && permissions?.browserRecording ? (\n              <ActionTile.Root\n                disabled={isHLSRunning}\n                onClick={async () => {\n                  if (isRecordingLoading) {\n                    return;\n                  }\n                  if (isBrowserRecordingOn || isStreamingOn) {\n                    setOpenOptionsSheet(false);\n                    setShowRecordingOn(true);\n                  } else {\n                    // start recording\n                    await startRecording();\n                    setOpenOptionsSheet(false);\n                  }\n                  if (isHLSRunning) {\n                    setOpenOptionsSheet(false);\n                  }\n                }}\n              >\n                {isRecordingLoading ? <Loading /> : <RecordIcon />}\n                <ActionTile.Title>\n                  {match({ isBrowserRecordingOn, isRecordingLoading })\n                    .with({ isBrowserRecordingOn: true, isRecordingLoading: false }, () => 'Recording On')\n                    .with({ isRecordingLoading: true }, () => 'Starting Recording')\n                    .with({ isRecordingLoading: false }, () => 'Start Recording')\n                    .otherwise(() => null)}\n                </ActionTile.Title>\n              </ActionTile.Root>\n            ) : null}\n\n            {title || description ? (\n              <ActionTile.Root\n                onClick={() => {\n                  setOpenOptionsSheet(false);\n                  toggleDetailsSheet();\n                }}\n              >\n                <InfoIcon />\n                <ActionTile.Title>About Session</ActionTile.Title>\n              </ActionTile.Root>\n            ) : null}\n          </Box>\n        </Sheet.Content>\n      </Sheet.Root>\n      <SettingsModal open={openSettingsSheet} onOpenChange={setOpenSettingsSheet} screenType={screenType} />\n      {openModals.has(MODALS.MUTE_ALL) && (\n        <MuteAllModal onOpenChange={(value: boolean) => updateState(MODALS.MUTE_ALL, value)} isMobile />\n      )}\n      {openModals.has(MODALS.CHANGE_NAME) && (\n        <ChangeNameModal\n          onOpenChange={(value: boolean) => updateState(MODALS.CHANGE_NAME, value)}\n          openParentSheet={() => setOpenOptionsSheet(true)}\n        />\n      )}\n      {openModals.has(MODALS.CAPTION) && (\n        <CaptionModal onOpenChange={(value: boolean) => updateState(MODALS.CAPTION, value)} />\n      )}\n      {showEmojiCard && (\n        <Box\n          ref={emojiCardRef}\n          css={{\n            maxWidth: '100%',\n            w: '100%',\n            position: 'absolute',\n            left: 0,\n            right: 0,\n            bottom: '$18',\n            bg: '$surface_default',\n            zIndex: '10',\n            p: '$8',\n            pb: 0,\n            r: '$1',\n            mx: '$4',\n          }}\n        >\n          <EmojiReaction showCard />\n        </Box>\n      )}\n      {showRecordingOn && (\n        <StopRecordingInSheet\n          onClose={() => setShowRecordingOn(false)}\n          onStopRecording={async () => {\n            try {\n              await hmsActions.stopRTMPAndRecording();\n              setShowRecordingOn(false);\n            } catch (error) {\n              ToastManager.addToast({\n                // @ts-ignore\n                title: error.message,\n                variant: 'error',\n              });\n            }\n          }}\n        />\n      )}\n    </>\n  );\n};\n", "import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { HMSRecordingState } from '@100mslive/hms-video-store';\nimport {\n  HMSRoomState,\n  selectHLSState,\n  selectIsConnectedToRoom,\n  selectPermissions,\n  selectRecordingState,\n  selectRoomState,\n  useHMSActions,\n  useHMSStore,\n  useRecordingStreaming,\n} from '@100mslive/react-sdk';\nimport { AlertTriangleIcon, CrossIcon, PauseCircleIcon, RecordIcon } from '@100mslive/react-icons';\nimport { Box, Button, config as cssConfig, Flex, HorizontalDivider, Loading, Popover, Text, Tooltip } from '../../..';\nimport { Sheet } from '../../../Sheet';\n// @ts-ignore\nimport { ToastManager } from '../Toast/ToastManager';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useRecordingHandler } from '../../common/hooks';\n// @ts-ignore\nimport { formatTime } from '../../common/utils';\n\nexport const getRecordingText = (\n  {\n    isBrowserRecordingOn,\n    isServerRecordingOn,\n    isHLSRecordingOn,\n  }: { isBrowserRecordingOn: boolean; isServerRecordingOn: boolean; isHLSRecordingOn: boolean },\n  delimiter = ', ',\n) => {\n  if (!isBrowserRecordingOn && !isServerRecordingOn && !isHLSRecordingOn) {\n    return '';\n  }\n  const title: string[] = [];\n  if (isBrowserRecordingOn) {\n    title.push('Browser');\n  }\n  if (isServerRecordingOn) {\n    title.push('Server');\n  }\n  if (isHLSRecordingOn) {\n    title.push('HLS');\n  }\n  return title.join(delimiter);\n};\n\nexport const LiveStatus = () => {\n  const { isHLSRunning, isRTMPRunning } = useRecordingStreaming();\n  const hlsState = useHMSStore(selectHLSState);\n  const isMobile = useMedia(cssConfig.media.md);\n  const intervalRef = useRef<NodeJS.Timeout | null>(null);\n  const { screenType } = useRoomLayoutConferencingScreen();\n  const [liveTime, setLiveTime] = useState(0);\n\n  const startTimer = useCallback(() => {\n    intervalRef.current = setInterval(() => {\n      const timeStamp = hlsState?.variants[0]?.[screenType === 'hls_live_streaming' ? 'startedAt' : 'initialisedAt'];\n      if (hlsState?.running && timeStamp) {\n        setLiveTime(Date.now() - timeStamp.getTime());\n      }\n    }, 1000);\n  }, [hlsState?.running, hlsState?.variants, screenType]);\n\n  useEffect(() => {\n    if (hlsState?.running) {\n      startTimer();\n    }\n    if (!hlsState?.running && intervalRef.current) {\n      clearInterval(intervalRef.current);\n    }\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, [hlsState.running, isMobile, startTimer]);\n\n  if (!isHLSRunning && !isRTMPRunning) {\n    return null;\n  }\n  return (\n    <Flex\n      align=\"center\"\n      gap=\"1\"\n      css={{\n        border: '1px solid $border_default',\n        padding: '$4 $6 $4 $6',\n        borderRadius: '$1',\n      }}\n    >\n      <Box css={{ w: '$4', h: '$4', r: '$round', bg: '$alert_error_default', mr: '$2' }} />\n      <Flex align=\"center\" gap=\"2\">\n        <Text variant={!isMobile ? 'button' : 'body2'}>LIVE</Text>\n        <Text variant=\"caption\">{hlsState?.variants?.length > 0 && isHLSRunning ? formatTime(liveTime) : ''}</Text>\n      </Flex>\n    </Flex>\n  );\n};\n\nexport const RecordingStatus = () => {\n  const { isBrowserRecordingOn, isServerRecordingOn, isHLSRecordingOn, isRecordingOn } = useRecordingStreaming();\n  const permissions = useHMSStore(selectPermissions);\n  const isMobile = useMedia(cssConfig.media.md);\n\n  if (\n    !isRecordingOn ||\n    // if only browser recording is enabled, stop recording is shown\n    // so no need to show this as it duplicates\n    [permissions?.browserRecording, !isServerRecordingOn, !isHLSRecordingOn, isBrowserRecordingOn].every(\n      value => !!value,\n    )\n  ) {\n    // show recording icon in mobile without popover\n    if (!(isMobile && isRecordingOn)) return null;\n  }\n\n  return (\n    <Tooltip\n      boxCss={{ zIndex: 1 }}\n      title={getRecordingText({\n        isBrowserRecordingOn,\n        isServerRecordingOn,\n        isHLSRecordingOn,\n      })}\n    >\n      <Flex\n        css={{\n          color: '$alert_error_default',\n          alignItems: 'center',\n        }}\n      >\n        <RecordIcon width={24} height={24} />\n      </Flex>\n    </Tooltip>\n  );\n};\n\nexport const RecordingPauseStatus = () => {\n  const recording = useHMSStore(selectRecordingState);\n  if (recording.hls && recording.hls.state === HMSRecordingState.PAUSED) {\n    return (\n      <Tooltip\n        boxCss={{ zIndex: 1 }}\n        title={getRecordingText({\n          isBrowserRecordingOn: false,\n          isServerRecordingOn: false,\n          isHLSRecordingOn: true,\n        })}\n      >\n        <Flex\n          css={{\n            color: '$on_surface_high',\n            alignItems: 'center',\n          }}\n        >\n          <PauseCircleIcon width={24} height={24} />\n        </Flex>\n      </Tooltip>\n    );\n  }\n  return null;\n};\n\nconst StartRecording = () => {\n  const permissions = useHMSStore(selectPermissions);\n  const [open, setOpen] = useState(false);\n  const { startRecording, recordingStarted } = useRecordingHandler();\n  const { isBrowserRecordingOn, isStreamingOn, isHLSRunning } = useRecordingStreaming();\n  const hmsActions = useHMSActions();\n  if (!permissions?.browserRecording || isHLSRunning) {\n    return null;\n  }\n  if (isBrowserRecordingOn) {\n    return (\n      <Popover.Root open={open} onOpenChange={setOpen}>\n        <Popover.Trigger asChild>\n          <Button variant=\"danger\" data-testid=\"stop_recording\" icon outlined onClick={() => setOpen(true)}>\n            <RecordIcon />\n            <Text as=\"span\" css={{ '@md': { display: 'none' }, color: 'currentColor' }}>\n              Stop Recording\n            </Text>\n          </Button>\n        </Popover.Trigger>\n        <Popover.Portal>\n          <Popover.Content align=\"end\" sideOffset={8} css={{ w: '$64' }}>\n            <Text variant=\"body1\" css={{ color: '$on_surface_medium' }}>\n              Are you sure you want to end the recording?\n            </Text>\n            <Button\n              data-testid=\"stop_recording_confirm\"\n              variant=\"danger\"\n              icon\n              css={{ ml: 'auto' }}\n              onClick={async () => {\n                try {\n                  await hmsActions.stopRTMPAndRecording();\n                } catch (error) {\n                  const err = error as Error;\n                  ToastManager.addToast({\n                    title: err.message,\n                    variant: 'error',\n                  });\n                }\n                setOpen(false);\n              }}\n            >\n              Stop\n            </Button>\n          </Popover.Content>\n        </Popover.Portal>\n      </Popover.Root>\n    );\n  }\n  return (\n    <Button\n      data-testid=\"start_recording\"\n      variant=\"standard\"\n      icon\n      disabled={recordingStarted || isStreamingOn}\n      onClick={async () => {\n        await startRecording();\n      }}\n    >\n      {recordingStarted ? <Loading size={24} color=\"currentColor\" /> : <RecordIcon />}\n      <Text as=\"span\" css={{ '@md': { display: 'none' }, color: 'currentColor' }}>\n        {recordingStarted ? 'Starting' : 'Start'} Recording\n      </Text>\n    </Button>\n  );\n};\n\n/**\n * @description only start recording button will be shown.\n */\nexport const StreamActions = () => {\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const isMobile = useMedia(cssConfig.media.md);\n  const roomState = useHMSStore(selectRoomState);\n\n  return (\n    <Flex align=\"center\" css={{ gap: '$4' }}>\n      {!isMobile && (\n        <Flex align=\"center\" css={{ gap: '$4' }}>\n          <RecordingPauseStatus />\n          <RecordingStatus />\n          {roomState !== HMSRoomState.Preview ? <LiveStatus /> : null}\n        </Flex>\n      )}\n      {isConnected && !isMobile ? <StartRecording /> : null}\n    </Flex>\n  );\n};\n\nexport const StopRecordingInSheet = ({\n  onStopRecording,\n  onClose,\n}: {\n  onStopRecording: () => void;\n  onClose: () => void;\n}) => {\n  return (\n    <Sheet.Root open={true}>\n      <Sheet.Content>\n        <Sheet.Title css={{ p: '$10' }}>\n          <Flex direction=\"row\" justify=\"between\" css={{ w: '100%', c: '$alert_error_default' }}>\n            <Flex justify=\"start\" align=\"center\" gap=\"3\">\n              <AlertTriangleIcon />\n              <Text variant=\"h5\" css={{ c: '$alert_error_default' }}>\n                Stop Recording\n              </Text>\n            </Flex>\n            <Sheet.Close css={{ color: 'white' }} onClick={onClose}>\n              <CrossIcon />\n            </Sheet.Close>\n          </Flex>\n        </Sheet.Title>\n        <HorizontalDivider />\n        <Box as=\"div\" css={{ p: '$10', overflowY: 'scroll', maxHeight: '70vh' }}>\n          <Text variant=\"caption\" css={{ c: '$on_surface_medium', pb: '$8' }}>\n            Are you sure you want to stop recording? You can\u2019t undo this action.\n          </Text>\n          <Button\n            variant=\"danger\"\n            css={{ width: '100%' }}\n            type=\"submit\"\n            data-testid=\"popup_change_btn\"\n            onClick={onStopRecording}\n          >\n            Stop\n          </Button>\n        </Box>\n      </Sheet.Content>\n    </Sheet.Root>\n  );\n};\n", "function defaultEqualityCheck(a, b) {\n  return a === b;\n}\n\nfunction areArgumentsShallowlyEqual(equalityCheck, prev, next) {\n  if (prev === null || next === null || prev.length !== next.length) {\n    return false;\n  }\n\n  // Do this in a for loop (and not a `forEach` or an `every`) so we can determine equality as fast as possible.\n  var length = prev.length;\n  for (var i = 0; i < length; i++) {\n    if (!equalityCheck(prev[i], next[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function defaultMemoize(func) {\n  var equalityCheck = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultEqualityCheck;\n\n  var lastArgs = null;\n  var lastResult = null;\n  // we reference arguments instead of spreading them for performance reasons\n  return function () {\n    if (!areArgumentsShallowlyEqual(equalityCheck, lastArgs, arguments)) {\n      // apply arguments instead of spreading for performance.\n      lastResult = func.apply(null, arguments);\n    }\n\n    lastArgs = arguments;\n    return lastResult;\n  };\n}\n\nfunction getDependencies(funcs) {\n  var dependencies = Array.isArray(funcs[0]) ? funcs[0] : funcs;\n\n  if (!dependencies.every(function (dep) {\n    return typeof dep === 'function';\n  })) {\n    var dependencyTypes = dependencies.map(function (dep) {\n      return typeof dep;\n    }).join(', ');\n    throw new Error('Selector creators expect all input-selectors to be functions, ' + ('instead received the following types: [' + dependencyTypes + ']'));\n  }\n\n  return dependencies;\n}\n\nexport function createSelectorCreator(memoize) {\n  for (var _len = arguments.length, memoizeOptions = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    memoizeOptions[_key - 1] = arguments[_key];\n  }\n\n  return function () {\n    for (var _len2 = arguments.length, funcs = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      funcs[_key2] = arguments[_key2];\n    }\n\n    var recomputations = 0;\n    var resultFunc = funcs.pop();\n    var dependencies = getDependencies(funcs);\n\n    var memoizedResultFunc = memoize.apply(undefined, [function () {\n      recomputations++;\n      // apply arguments instead of spreading for performance.\n      return resultFunc.apply(null, arguments);\n    }].concat(memoizeOptions));\n\n    // If a selector is called with the exact same arguments we don't need to traverse our dependencies again.\n    var selector = memoize(function () {\n      var params = [];\n      var length = dependencies.length;\n\n      for (var i = 0; i < length; i++) {\n        // apply arguments instead of spreading and mutate a local list of params for performance.\n        params.push(dependencies[i].apply(null, arguments));\n      }\n\n      // apply arguments instead of spreading for performance.\n      return memoizedResultFunc.apply(null, params);\n    });\n\n    selector.resultFunc = resultFunc;\n    selector.dependencies = dependencies;\n    selector.recomputations = function () {\n      return recomputations;\n    };\n    selector.resetRecomputations = function () {\n      return recomputations = 0;\n    };\n    return selector;\n  };\n}\n\nexport var createSelector = createSelectorCreator(defaultMemoize);\n\nexport function createStructuredSelector(selectors) {\n  var selectorCreator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : createSelector;\n\n  if (typeof selectors !== 'object') {\n    throw new Error('createStructuredSelector expects first argument to be an object ' + ('where each property is a selector, instead received a ' + typeof selectors));\n  }\n  var objectKeys = Object.keys(selectors);\n  return selectorCreator(objectKeys.map(function (key) {\n    return selectors[key];\n  }), function () {\n    for (var _len3 = arguments.length, values = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      values[_key3] = arguments[_key3];\n    }\n\n    return values.reduce(function (composition, value, index) {\n      composition[objectKeys[index]] = value;\n      return composition;\n    }, {});\n  });\n}", "{\n  \"version\": \"0.12.20\",\n  \"license\": \"MIT\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/100mslive/web-sdks.git\",\n    \"directory\": \"packages/hms-video-store\"\n  },\n  \"main\": \"dist/index.cjs.js\",\n  \"module\": \"dist/index.js\",\n  \"typings\": \"dist/index.d.ts\",\n  \"files\": [\n    \"dist\",\n    \"src\"\n  ],\n  \"engines\": {\n    \"node\": \">=12\"\n  },\n  \"exports\": {\n    \".\": {\n      \"require\": \"./dist/index.cjs.js\",\n      \"import\": \"./dist/index.js\",\n      \"default\": \"./dist/index.js\"\n    }\n  },\n  \"sideEffects\": false,\n  \"scripts\": {\n    \"prestart\": \"rm -rf dist && yarn types:build\",\n    \"start\": \"concurrently \\\"yarn dev\\\" \\\"yarn types\\\"\",\n    \"dev\": \"node ../../scripts/dev\",\n    \"build:only\": \"node ../../scripts/build\",\n    \"build\": \"yarn build:only && yarn types:build\",\n    \"types\": \"tsc -w\",\n    \"types:build\": \"tsc -p tsconfig.json\",\n    \"format\": \"prettier --write src/**/*.ts\",\n    \"test\": \"jest --maxWorkers=1\",\n    \"test:watch\": \"jest --watch\",\n    \"test:coverage\": \"jest --coverage\",\n    \"lint\": \"eslint -c ../../.eslintrc .\",\n    \"lint:fix\": \"yarn lint --fix\",\n    \"prepare\": \"yarn build\",\n    \"size\": \"size-limit\",\n    \"analyze\": \"size-limit --why\",\n    \"docs\": \"rm -rf ./docs && typedoc && rm -f ./docs/README.md && mkdir ./docs/home &&mv ./docs/modules.md ./docs/home/content.md && node ../../scripts/docs-store && npx prettier --write './docs/**/*'\"\n  },\n  \"name\": \"@100mslive/hms-video-store\",\n  \"author\": \"100ms\",\n  \"dependencies\": {\n    \"eventemitter2\": \"^6.4.9\",\n    \"immer\": \"^9.0.6\",\n    \"lodash.isequal\": \"^4.5.0\",\n    \"reselect\": \"4.0.0\",\n    \"sdp-transform\": \"^2.14.1\",\n    \"ua-parser-js\": \"^1.0.1\",\n    \"uuid\": \"^8.3.2\",\n    \"webrtc-adapter\": \"^8.0.0\",\n    \"zustand\": \"3.5.7\"\n  },\n  \"devDependencies\": {\n    \"@types/dom-screen-wake-lock\": \"^1.0.1\",\n    \"@types/lodash.isequal\": \"^4.5.8\",\n    \"@types/sdp-transform\": \"^2.4.4\",\n    \"@types/ua-parser-js\": \"^0.7.36\",\n    \"@types/uuid\": \"^8.3.0\",\n    \"jest-canvas-mock\": \"^2.3.1\",\n    \"jsdom-worker\": \"^0.3.0\",\n    \"tslib\": \"^2.2.0\"\n  },\n  \"description\": \"@100mslive Core SDK which abstracts the complexities of webRTC while providing a reactive store for data management with a unidirectional data flow\",\n  \"keywords\": [\n    \"video\",\n    \"webrtc\",\n    \"conferencing\",\n    \"100ms\"\n  ]\n}\n", "import { HMSPeerID } from './peer';\nimport { HLSVariant, HMSHLS, HMSRecording, HMSRTMP, HMSTranscriptionInfo } from '../interfaces';\n\nexport type { HMSRecording, HMSRTMP, HMSHLS, HLSVariant };\nexport type HMSRoomID = string;\n\n/**\n * Check out internal-docs/RoomStateFlow.tldr for flow of room state\n * View it by\n * - Installing tldraw for VSCode(https://marketplace.visualstudio.com/items?itemName=tldraw-org.tldraw-vscode), or\n * - Open the file in https://www.tldraw.com/\n */\nexport enum HMSRoomState {\n  Disconnected = 'Disconnected',\n  Preview = 'Preview',\n  Connecting = 'Connecting',\n  Connected = 'Connected',\n  Reconnecting = 'Reconnecting',\n  Disconnecting = 'Disconnecting',\n  Failed = 'Failed',\n}\n\nexport interface HMSRoom {\n  id: HMSRoomID;\n  name: string;\n  isConnected?: boolean;\n  peers: HMSPeerID[];\n  localPeer: HMSPeerID;\n  roomState: HMSRoomState;\n  recording: HMSRecording;\n  rtmp: HMSRTMP;\n  hls: HMSHLS;\n  sessionId: string;\n  startedAt?: Date;\n  joinedAt?: Date;\n  transcriptions?: HMSTranscriptionInfo[];\n  /**\n   * if this number is available room.peers is not guaranteed to have all the peers.\n   */\n  peerCount?: number;\n  isLargeRoom?: boolean;\n  isEffectsEnabled?: boolean;\n  isVBEnabled?: boolean;\n  effectsKey?: string;\n  isHipaaEnabled?: boolean;\n  isNoiseCancellationEnabled?: boolean;\n}\n", "import { HMSException } from './error';\nimport { HMSMessage, HMSMessageID } from './message';\nimport { HMSPeer, HMSPeerID, HMSSpeaker, HMSTrack, HMSTrackID } from './peer';\nimport { HMSPlaylist } from './playlist';\nimport { HMSRoleChangeStoreRequest } from './requests';\nimport { HMSRole } from './role';\nimport { HMSRoom, HMSRoomState } from './room';\nimport { HMSMediaSettings } from './settings';\nimport { DeviceMap, HMSConnectionQuality, HMSPeerStats, HMSPoll, HMSTrackStats, HMSWhiteboard } from '../interfaces';\n\nexport interface HMSGenericTypes {\n  sessionStore: Record<string, any>;\n}\n\n/*\n * Defines the schema of the central store. UI Components are aware of the presence\n * of this central store. This is the global state - the single source of immutable truth.\n */\nexport interface HMSStore<T extends HMSGenericTypes = { sessionStore: Record<string, any> }> {\n  room: HMSRoom;\n  peers: Record<HMSPeerID, HMSPeer>;\n  speakers: Record<HMSTrackID, HMSSpeaker>;\n  connectionQualities: Record<HMSPeerID, HMSConnectionQuality>;\n  tracks: Record<HMSTrackID, HMSTrack>;\n  playlist: HMSPlaylist<any>;\n  messages: {\n    byID: Record<HMSMessageID, HMSMessage>;\n    allIDs: HMSMessageID[];\n  };\n  settings: HMSMediaSettings;\n  devices: DeviceMap;\n  roles: Record<string, HMSRole>;\n  templateAppData: Record<string, string>;\n  appData?: Record<string, any>;\n  roleChangeRequests: HMSRoleChangeStoreRequest[];\n  /** @deprecated use `sessionStore` instead */\n  sessionMetadata?: any;\n  preview?: {\n    localPeer?: HMSPeerID;\n    asRole?: string;\n    videoTrack?: HMSTrackID;\n    audioTrack?: HMSTrackID;\n  };\n  errors: HMSException[]; // for the convenience of debugging and seeing any error in devtools\n  sessionStore: T['sessionStore'];\n  polls: Record<string, HMSPoll>;\n  /** @internal */\n  hideLocalPeer: boolean;\n  /** @alpha */\n  whiteboards: Record<string, HMSWhiteboard>;\n}\n\nexport interface HMSStatsStore {\n  remoteTrackStats: Record<HMSTrackID, HMSTrackStats | undefined>;\n  localTrackStats: Record<HMSTrackID, HMSTrackStats[] | undefined>;\n  peerStats: Record<HMSPeerID, HMSPeerStats | undefined>;\n  localPeer: {\n    id: HMSPeerID;\n    videoTrack?: HMSTrackID;\n    audioTrack?: HMSTrackID;\n  };\n}\n\n/**\n * @internal\n */\nexport const createDefaultStoreState = <T extends HMSGenericTypes>(): HMSStore<T> => {\n  return {\n    room: {\n      id: '',\n      isConnected: false,\n      name: '',\n      peers: [],\n      localPeer: '',\n      roomState: HMSRoomState.Disconnected,\n      recording: {\n        browser: {\n          running: false,\n        },\n        server: {\n          running: false,\n        },\n        hls: { running: false },\n      },\n      rtmp: {\n        running: false,\n      },\n      hls: {\n        running: false,\n        variants: [],\n      },\n      sessionId: '',\n    },\n    peers: {},\n    tracks: {},\n    playlist: {\n      audio: {\n        list: {},\n        selection: { id: '', hasPrevious: false, hasNext: false },\n        progress: 0,\n        volume: 0,\n        currentTime: 0,\n        playbackRate: 1.0,\n      },\n      video: {\n        list: {},\n        selection: { id: '', hasPrevious: false, hasNext: false },\n        progress: 0,\n        volume: 0,\n        currentTime: 0,\n        playbackRate: 1.0,\n      },\n    },\n    messages: { byID: {}, allIDs: [] },\n    speakers: {},\n    connectionQualities: {},\n    settings: {\n      audioInputDeviceId: '',\n      audioOutputDeviceId: '',\n      videoInputDeviceId: '',\n    },\n    devices: {\n      audioInput: [],\n      audioOutput: [],\n      videoInput: [],\n    },\n    roles: {},\n    roleChangeRequests: [],\n    errors: [],\n    sessionStore: {},\n    templateAppData: {},\n    polls: {},\n    whiteboards: {},\n    hideLocalPeer: false,\n  };\n};\n\nexport const createDefaultStatsStore = (): HMSStatsStore => {\n  return {\n    peerStats: {},\n    remoteTrackStats: {},\n    localTrackStats: {},\n    localPeer: { id: '' },\n  };\n};\n", "import { HMSPeerID } from './peer';\nimport { HMSRoleName } from './role';\n\nexport type HMSMessageID = string;\n\n/**\n * @internal\n */\nexport enum HMSMessageType {\n  CHAT = 'chat',\n}\n\nexport interface HMSMessage {\n  id: HMSMessageID;\n  sender?: HMSPeerID;\n  senderName?: string;\n  senderUserId?: string;\n  senderRole?: string;\n  recipientPeer?: HMSPeerID;\n  recipientRoles?: HMSRoleName[];\n  time: Date;\n  read: boolean;\n  type: string;\n  message: any;\n  /**\n   * true if message will not be put it in store because it has been ignored\n   */\n  ignored: boolean;\n}\n\n/**\n * @internal\n */\nexport interface HMSMessageInput {\n  recipientPeer?: HMSPeerID;\n  recipientRoles?: HMSRoleName[];\n  type?: string;\n  message: any;\n  id: string;\n  time: number;\n}\n", "import { HMSDeviceChangeEvent } from './device-change';\nimport { HMSException } from './error';\nimport { HMSMessage } from './message';\nimport { HMSPeer, HMSTrack } from './peer';\nimport { HMSPlaylistItem } from './playlist';\nimport { HMSChangeMultiTrackStateRequest, HMSChangeTrackStateRequest, HMSLeaveRoomRequest } from './requests';\nimport { HMSPoll, HMSTranscriptionInfo } from '../internal';\n\ninterface BaseNotification {\n  id: number;\n  type: string;\n  message: string;\n  severity?: HMSNotificationSeverity;\n}\nexport interface HMSPeerNotification extends BaseNotification {\n  type:\n    | HMSNotificationTypes.PEER_JOINED\n    | HMSNotificationTypes.PEER_LEFT\n    | HMSNotificationTypes.NAME_UPDATED\n    | HMSNotificationTypes.METADATA_UPDATED\n    | HMSNotificationTypes.ROLE_UPDATED\n    | HMSNotificationTypes.HAND_RAISE_CHANGED;\n  data: HMSPeer;\n}\n\nexport interface HMSPeerListNotification extends BaseNotification {\n  type: HMSNotificationTypes.PEER_LIST;\n  data: HMSPeer[];\n}\nexport interface HMSTrackNotification extends BaseNotification {\n  type:\n    | HMSNotificationTypes.TRACK_ADDED\n    | HMSNotificationTypes.TRACK_DEGRADED\n    | HMSNotificationTypes.TRACK_UNMUTED\n    | HMSNotificationTypes.TRACK_DESCRIPTION_CHANGED\n    | HMSNotificationTypes.TRACK_MUTED\n    | HMSNotificationTypes.TRACK_REMOVED\n    | HMSNotificationTypes.TRACK_RESTORED;\n  data: HMSTrack;\n}\nexport interface HMSMessageNotification extends BaseNotification {\n  type: HMSNotificationTypes.NEW_MESSAGE;\n  data: HMSMessage;\n}\nexport interface HMSExceptionNotification extends BaseNotification {\n  type: HMSNotificationTypes.ERROR;\n  data: HMSException;\n}\nexport interface HMSChangeTrackStateRequestNotification extends BaseNotification {\n  type: HMSNotificationTypes.CHANGE_TRACK_STATE_REQUEST;\n  data: HMSChangeTrackStateRequest;\n}\nexport interface HMSChangeMultiTrackStateRequestNotification extends BaseNotification {\n  type: HMSNotificationTypes.CHANGE_MULTI_TRACK_STATE_REQUEST;\n  data: HMSChangeMultiTrackStateRequest;\n}\n\nexport interface HMSLeaveRoomRequestNotification extends BaseNotification {\n  type: HMSNotificationTypes.ROOM_ENDED | HMSNotificationTypes.REMOVED_FROM_ROOM;\n  data: HMSLeaveRoomRequest;\n}\nexport interface HMSDeviceChangeEventNotification extends BaseNotification {\n  type: HMSNotificationTypes.DEVICE_CHANGE_UPDATE;\n  data?: HMSDeviceChangeEvent;\n}\nexport interface HMSPlaylistItemNotification<T> extends BaseNotification {\n  type: HMSNotificationTypes.PLAYLIST_TRACK_ENDED;\n  data: HMSPlaylistItem<T>;\n}\n\nexport interface HMSReconnectionNotification extends BaseNotification {\n  type: HMSNotificationTypes.RECONNECTED | HMSNotificationTypes.RECONNECTING;\n  data: HMSException | null;\n}\n\nexport interface HMSPollNotification extends BaseNotification {\n  type: HMSNotificationTypes.POLL_STARTED | HMSNotificationTypes.POLL_STOPPED | HMSNotificationTypes.POLL_VOTES_UPDATED;\n  data: HMSPoll;\n}\n\nexport interface HMSTranscriptionNotification extends BaseNotification {\n  type: HMSNotificationTypes.TRANSCRIPTION_STATE_UPDATED;\n  data: HMSTranscriptionInfo[];\n}\nexport type HMSNotification =\n  | HMSPeerNotification\n  | HMSPeerListNotification\n  | HMSTrackNotification\n  | HMSMessageNotification\n  | HMSExceptionNotification\n  | HMSChangeTrackStateRequestNotification\n  | HMSChangeMultiTrackStateRequestNotification\n  | HMSLeaveRoomRequestNotification\n  | HMSDeviceChangeEventNotification\n  | HMSReconnectionNotification\n  | HMSTranscriptionNotification\n  | HMSPlaylistItemNotification<any>;\n\nexport enum HMSNotificationSeverity {\n  INFO = 'info',\n  ERROR = 'error',\n}\n\nexport enum HMSNotificationTypes {\n  PEER_JOINED = 'PEER_JOINED',\n  PEER_LEFT = 'PEER_LEFT',\n  PEER_LIST = 'PEER_LIST',\n  NEW_MESSAGE = 'NEW_MESSAGE',\n  ERROR = 'ERROR',\n  RECONNECTING = 'RECONNECTING',\n  RECONNECTED = 'RECONNECTED',\n  TRACK_ADDED = 'TRACK_ADDED',\n  TRACK_REMOVED = 'TRACK_REMOVED',\n  TRACK_MUTED = 'TRACK_MUTED',\n  TRACK_UNMUTED = 'TRACK_UNMUTED',\n  TRACK_DEGRADED = 'TRACK_DEGRADED',\n  TRACK_RESTORED = 'TRACK_RESTORED',\n  TRACK_DESCRIPTION_CHANGED = 'TRACK_DESCRIPTION_CHANGED',\n  ROLE_UPDATED = 'ROLE_UPDATED',\n  CHANGE_TRACK_STATE_REQUEST = 'CHANGE_TRACK_STATE_REQUEST',\n  CHANGE_MULTI_TRACK_STATE_REQUEST = 'CHANGE_MULTI_TRACK_STATE_REQUEST',\n  ROOM_ENDED = 'ROOM_ENDED',\n  REMOVED_FROM_ROOM = 'REMOVED_FROM_ROOM',\n  DEVICE_CHANGE_UPDATE = 'DEVICE_CHANGE_UPDATE',\n  PLAYLIST_TRACK_ENDED = 'PLAYLIST_TRACK_ENDED',\n  NAME_UPDATED = 'NAME_UPDATED',\n  METADATA_UPDATED = 'METADATA_UPDATED',\n  POLL_CREATED = 'POLL_CREATED',\n  POLL_STARTED = 'POLL_STARTED',\n  POLL_STOPPED = 'POLL_STOPPED',\n  POLL_VOTES_UPDATED = 'POLL_VOTES_UPDATED',\n  POLLS_LIST = 'POLLS_LIST',\n  HAND_RAISE_CHANGED = 'HAND_RAISE_CHANGED',\n  TRANSCRIPTION_STATE_UPDATED = 'TRANSCRIPTION_STATE_UPDATED',\n}\n\nexport type HMSNotificationMapping<T extends HMSNotificationTypes, C = any> = {\n  [HMSNotificationTypes.PEER_JOINED]: HMSPeerNotification;\n  [HMSNotificationTypes.PEER_LEFT]: HMSPeerNotification;\n  [HMSNotificationTypes.PEER_LIST]: HMSPeerListNotification;\n  [HMSNotificationTypes.NAME_UPDATED]: HMSPeerNotification;\n  [HMSNotificationTypes.METADATA_UPDATED]: HMSPeerNotification;\n  [HMSNotificationTypes.ROLE_UPDATED]: HMSPeerNotification;\n  [HMSNotificationTypes.TRACK_ADDED]: HMSTrackNotification;\n  [HMSNotificationTypes.TRACK_REMOVED]: HMSTrackNotification;\n  [HMSNotificationTypes.TRACK_MUTED]: HMSTrackNotification;\n  [HMSNotificationTypes.TRACK_UNMUTED]: HMSTrackNotification;\n  [HMSNotificationTypes.TRACK_DEGRADED]: HMSTrackNotification;\n  [HMSNotificationTypes.TRACK_RESTORED]: HMSTrackNotification;\n  [HMSNotificationTypes.TRACK_DESCRIPTION_CHANGED]: HMSTrackNotification;\n  [HMSNotificationTypes.TRACK_UNMUTED]: HMSTrackNotification;\n  [HMSNotificationTypes.NEW_MESSAGE]: HMSMessageNotification;\n  [HMSNotificationTypes.ROOM_ENDED]: HMSLeaveRoomRequestNotification;\n  [HMSNotificationTypes.REMOVED_FROM_ROOM]: HMSLeaveRoomRequestNotification;\n  [HMSNotificationTypes.DEVICE_CHANGE_UPDATE]: HMSDeviceChangeEventNotification;\n  [HMSNotificationTypes.PLAYLIST_TRACK_ENDED]: HMSPlaylistItemNotification<C>;\n  [HMSNotificationTypes.ERROR]: HMSExceptionNotification;\n  [HMSNotificationTypes.CHANGE_TRACK_STATE_REQUEST]: HMSChangeTrackStateRequestNotification;\n  [HMSNotificationTypes.CHANGE_MULTI_TRACK_STATE_REQUEST]: HMSChangeMultiTrackStateRequestNotification;\n  [HMSNotificationTypes.RECONNECTED]: HMSReconnectionNotification;\n  [HMSNotificationTypes.RECONNECTING]: HMSReconnectionNotification;\n  [HMSNotificationTypes.POLL_STARTED]: HMSPollNotification;\n  [HMSNotificationTypes.POLL_STOPPED]: HMSPollNotification;\n  [HMSNotificationTypes.POLL_VOTES_UPDATED]: HMSPollNotification;\n  [HMSNotificationTypes.POLLS_LIST]: HMSPollNotification;\n  [HMSNotificationTypes.POLL_CREATED]: HMSPollNotification;\n  [HMSNotificationTypes.HAND_RAISE_CHANGED]: HMSPeerNotification;\n  [HMSNotificationTypes.TRANSCRIPTION_STATE_UPDATED]: HMSTranscriptionNotification;\n}[T];\n\nexport type MappedNotifications<Type extends HMSNotificationTypes[]> = {\n  [index in keyof Type]: HMSNotificationMapping<Type[index]>;\n};\n\nexport type HMSNotificationTypeParam = HMSNotificationTypes | HMSNotificationTypes[] | undefined;\n\nexport type HMSNotificationInCallback<T extends HMSNotificationTypeParam> = T extends HMSNotificationTypes[]\n  ? MappedNotifications<T>[number]\n  : T extends HMSNotificationTypes\n  ? HMSNotificationMapping<T>\n  : HMSNotification;\n\nexport type HMSNotificationCallback<T extends HMSNotificationTypeParam> = (\n  notification: HMSNotificationInCallback<T>,\n) => void;\n\n/**\n * @category Core\n */\nexport interface IHMSNotifications {\n  /**\n   * you can subscribe to notifications for new message, peer add etc. using this function.\n   * note that this is not meant to maintain any state on your side, as the reactive store already\n   * does that. The intent of this function is mainly to display toast notifications or send analytics.\n   * We'll provide a display message which can be displayed as it is for common cases.\n   */\n  onNotification<T extends HMSNotificationTypeParam>(cb: HMSNotificationCallback<T>, types?: T): () => void;\n}\n", "export enum HMSPlaylistType {\n  audio = 'audio',\n  video = 'video',\n}\nexport interface HMSPlaylistItem<T> {\n  name: string;\n  id: string;\n  metadata?: T;\n  url: string;\n  type: HMSPlaylistType;\n  duration?: number;\n  playing: boolean;\n  selected: boolean;\n}\n\nexport interface HMSPlaylistSelection {\n  id: string;\n  hasPrevious: boolean;\n  hasNext: boolean;\n}\n\nexport interface HMSPlaylist<T> {\n  audio: {\n    list: Record<string, HMSPlaylistItem<T>>;\n    selection: HMSPlaylistSelection;\n    progress: number;\n    volume: number;\n    currentTime: number;\n    playbackRate: number;\n  };\n  video: {\n    list: Record<string, HMSPlaylistItem<T>>;\n    selection: HMSPlaylistSelection;\n    progress: number;\n    volume: number;\n    currentTime: number;\n    playbackRate: number;\n  };\n}\n\nexport interface IHMSPlaylistActions {\n  /**\n   * Pass the id of the item to be played\n   * @param {string} id - id of playlist item\n   */\n  play(id: string): Promise<void>;\n  /**\n   * Pauses current playing item\n   */\n  pause(): Promise<void>;\n  /**\n   * PlayNext\n   */\n  playNext(): Promise<void>;\n  /**\n   * PlayPrevious\n   */\n  playPrevious(): Promise<void>;\n  /**\n   * seek passing seekValue - this is relative to current position\n   * @param {number} seekValue - number in seconds to move forwards(pass negative values to move backwards)\n   */\n  seek(seekValue: number): void;\n  /**\n   * seek passing seekValue  - seekValue will be absolute\n   * @param {number} seekValue - value in seconds of absolute position in the playlist item duration\n   */\n  seekTo(seekValue: number): void;\n  /**\n   * set volume passing volume\n   * @param {number} volume - number between 0-100\n   */\n  setVolume(volume: number): void;\n  /**\n   * pass list to set playlist\n   * @param {HMSPlaylistItem[]} list of playlist items\n   */\n  setList<T>(list: HMSPlaylistItem<T>[]): void;\n  /**\n   * Stop the current playback and remove the tracks\n   */\n  stop(): Promise<void>;\n  /**\n   * set whether to autoplay next item in playlist after the current one ends\n   * @param {boolean} autoplay\n   */\n  setIsAutoplayOn(autoplay: boolean): void;\n  /**\n   * Control the playback speed - 1.0 being normal, less than 1.0 will play it slowly\n   * and more than 1.0 will play it faster.\n   * @param playbackRate - value from 0.25 and 2.0\n   */\n  setPlaybackRate(playbackRate: number): void;\n  removeItem(id: string): Promise<boolean>;\n  clearList(): Promise<void>;\n}\n", "import { createSelector } from 'reselect';\nimport {\n  getScreenSharesByPeer,\n  isAudioPlaylist,\n  isDegraded,\n  isTrackDisplayEnabled,\n  isTrackEnabled,\n  isVideo,\n  isVideoPlaylist,\n} from './selectorUtils';\n// noinspection ES6PreferShortImport\nimport { HMSRole, HMSTranscriptionMode, HMSTranscriptionState, HMSWhiteboard } from '../internal';\nimport {\n  HMSException,\n  HMSMessage,\n  HMSPeer,\n  HMSPeerID,\n  HMSRoom,\n  HMSRoomState,\n  HMSStore,\n  HMSVideoTrack,\n} from '../schema';\n\n/**\n * Select the current {@link HMSRoom} object to which you are connected.\n * @param store\n */\nexport const selectRoom = (store: HMSStore): HMSRoom => store.room;\n/**\n * Select the current {@link HMSException[]} object to monitor the error logs\n * @param store\n */\nexport const selectErrors = (store: HMSStore): HMSException[] => store.errors;\n\n/**\n * It will help to get the all the error\n */\nexport const selectRecentError = createSelector(selectErrors, errors => (errors.length === 0 ? null : errors.at(-1)));\n/**\n * Select the ID of the current room to which you are connected.\n */\nexport const selectRoomID = createSelector(selectRoom, room => room.id);\n\n/**\n * @internal\n */\nexport const selectPeersMap = (store: HMSStore): Record<HMSPeerID, HMSPeer> => store.peers;\n\n/**\n * @internal\n */\nexport const selectMessagesMap = (store: HMSStore) => store.messages.byID;\n\n/**\n * Select IDs of messages you've sent or received sorted chronologically.\n */\nexport const selectMessageIDsInOrder = (store: HMSStore) => store.messages.allIDs;\n\n/**\n * @internal\n */\nexport const selectTracksMap = (store: HMSStore) => store.tracks;\n\n/**\n * Select your media settings\n * i.e., choosen audio input device, audio output device and video input device, audio mode\n * @param store\n */\nexport const selectLocalMediaSettings = (store: HMSStore) => store.settings;\n\n/**\n * select appData.\n * @internal\n */\nexport const selectFullAppData = (store: HMSStore) => store.appData;\n\n/**\n * Select the available audio input, audio output and video input devices on your machine.\n * @param store\n * @returns An object of array of available audio input, audio output and video input devices.\n * ```\n * type DeviceMap = {\n *   audioInput: InputDeviceInfo[];\n *   audioOutput: MediaDeviceInfo[];\n *   videoInput: InputDeviceInfo[];\n * }\n * ```\n */\nexport const selectDevices = (store: HMSStore) => {\n  return store.devices;\n};\n\nexport const selectSpeakers = (store: HMSStore) => {\n  return store.speakers;\n};\n\nexport const selectConnectionQualities = (store: HMSStore) => {\n  return store.connectionQualities;\n};\n\n/**\n * Select a boolean flag denoting whether you've joined a room.\n * NOTE: Returns true only after join, returns false during preview.\n */\nexport const selectIsConnectedToRoom = createSelector([selectRoom], room => room && room.isConnected);\n\n/**\n * selectPeerCount gives the number of peers Inside the room. This doesn't count the local peer if\n * they're still in preview and haven't yet joined the room. Note that this will not necessarily equal the\n * number of peers received through selectPeers, it's possible to know total number of people in the room\n * without having details of everyone depending on dashboard settings.\n */\nexport const selectPeerCount = createSelector([selectIsConnectedToRoom, selectRoom], (isConnected, room) => {\n  if (isConnected) {\n    // if we have peer count from server return that else return number of peers in the store.\n    // In case the strongly consistent peer list is disabled and only eventual consistent count and peer\n    // details is sent, room.peerCount may be 0 for a few second even though local peer is connected, send 1 in that case.\n    // TODO: Fix this at populating room.peerCount level than in selector.\n    return room.peerCount !== undefined ? room.peerCount || 1 : room.peers.length;\n  } else {\n    // if we have peer count from server return that, else return number of peers except the local one because local is\n    // not joined yet.\n    // Math.max to ensure we're not returning -1, if the selector is called before local peer is put in the store\n    return Math.max(room.peerCount !== undefined ? room.peerCount : room.peers.length - 1, 0);\n  }\n});\n\n/**\n * @internal\n * Select a boolean flag denoting whether to hide local peer.\n * When this is true, `selectPeers` skips local peer.\n */\nconst selectHideLocalPeer = (store: HMSStore): boolean => store.hideLocalPeer;\n\n/**\n * Select an array of peers(remote peers and your local peer) present in the room.\n */\nexport const selectPeers = createSelector(\n  [selectRoom, selectPeersMap, selectHideLocalPeer],\n  (room, storePeers, hideLocalPeer) => {\n    if (hideLocalPeer) {\n      return room.peers.filter(peerID => room.localPeer !== peerID).map(peerID => storePeers[peerID]);\n    }\n    return room.peers.map(peerID => storePeers[peerID]);\n  },\n);\n\n/**\n * Select an array of tracks(remote peer tracks and your local tracks) present in the room.\n */\nconst selectTracks = createSelector(selectTracksMap, storeTracks => {\n  return Object.values(storeTracks);\n});\n\n/**\n * Select the local peer object object assigned to you.\n */\nexport const selectLocalPeer = createSelector(selectRoom, selectPeersMap, (room, peers): HMSPeer | undefined => {\n  return peers[room.localPeer];\n});\n\n/**\n * Select the peer ID of your local peer.\n */\nexport const selectLocalPeerID = createSelector(selectRoom, room => {\n  return room.localPeer;\n});\n\n/**\n * Select the peer name of your local peer.\n */\nexport const selectLocalPeerName = createSelector(selectLocalPeer, peer => peer?.name);\n\n/**\n * Select the role name of your local peer.\n */\nexport const selectLocalPeerRoleName = createSelector(selectLocalPeer, peer => peer?.roleName);\n\n/**\n * Select the track ID of your local peer's primary audio track\n */\nexport const selectLocalAudioTrackID = createSelector(selectLocalPeer, peer => peer?.audioTrack);\n\n/**\n * Select the track ID of your local peer's primary video track\n */\nexport const selectLocalVideoTrackID = createSelector(selectLocalPeer, peer => peer?.videoTrack);\n\n/**\n * Select an array of track IDs of your local peer's auxiliary tracks\n */\nconst selectLocalAuxiliaryTrackIDs = createSelector(selectLocalPeer, peer => peer?.auxiliaryTracks);\n\n/**\n * Select an array of track IDs of all your local peer's tracks\n */\nexport const selectLocalTrackIDs = createSelector(\n  [selectLocalAudioTrackID, selectLocalVideoTrackID, selectLocalAuxiliaryTrackIDs],\n  (audioTrackID, videoTrackID, auxiliaryTrackIDs) => {\n    const trackIDs: string[] = auxiliaryTrackIDs ? [...auxiliaryTrackIDs] : [];\n    audioTrackID && trackIDs.unshift(audioTrackID);\n    videoTrackID && trackIDs.unshift(videoTrackID);\n    return trackIDs;\n  },\n);\n\n/**\n * Select remote peers(other users you're connected with via the internet) present in the room.\n */\nexport const selectRemotePeers = createSelector(selectPeers, peers => {\n  return peers.filter(p => !p.isLocal);\n});\n\n/**\n * Select the peer who's speaking the loudest at the moment\n */\nexport const selectDominantSpeaker = createSelector(selectPeersMap, selectSpeakers, (peersMap, speakers) => {\n  // sort in descending order by audio level\n  const speakersInOrder = Object.entries(speakers).sort((s1, s2) => {\n    const s1Level = s1[1]?.audioLevel || 0;\n    const s2Level = s2[1]?.audioLevel || 0;\n    return s2Level > s1Level ? 1 : -1;\n  });\n  if (speakersInOrder.length > 0 && speakersInOrder[0][1].audioLevel && speakersInOrder[0][1].audioLevel > 0) {\n    const peerID = speakersInOrder[0][1].peerID;\n    if (peerID in peersMap) {\n      return peersMap[peerID];\n    }\n  }\n  return null;\n});\n\n/**\n * Select a boolean denoting whether your local audio is unmuted\n * and the audio from your microphone is shared to remote peers\n */\nexport const selectIsLocalAudioEnabled = (store: HMSStore) => {\n  const localPeer = selectLocalPeer(store);\n  return isTrackEnabled(store, localPeer?.audioTrack);\n};\n\n/**\n * Select a boolean denoting whether your local video is unmuted\n * and the video from your camera is shared to remote peers\n */\nexport const selectIsLocalVideoEnabled = (store: HMSStore) => {\n  const localPeer = selectLocalPeer(store);\n  return isTrackEnabled(store, localPeer?.videoTrack);\n};\n\n/**\n * Select a boolean denoting whether you've chosen to unmute and share your local video.\n *\n * NOTE: Once you call `hmsActions.setLocalVideoEnabled(true)`to unmute your local video,\n * it takes some time to fetch your video from your video source.\n * This displayEnabled property gives immediate feedback for a more interactive UI,\n * without waiting for the video source\n */\nexport const selectIsLocalVideoDisplayEnabled = (store: HMSStore) => {\n  const localPeer = selectLocalPeer(store);\n  return isTrackDisplayEnabled(store, localPeer?.videoTrack);\n};\n\n/**\n * Select a boolean denoting whether your screen is shared to remote peers in the room.\n */\nexport const selectIsLocalScreenShared = createSelector(selectLocalPeer, selectTracksMap, (localPeer, tracksMap) => {\n  const { video, audio } = getScreenSharesByPeer(tracksMap, localPeer);\n  return !!(video || audio);\n});\n\n/**\n * Select the first peer who is currently sharing their screen.\n */\nexport const selectPeerScreenSharing = createSelector(selectPeersMap, selectTracksMap, (peersMap, tracksMap) => {\n  let screensharePeer = undefined;\n  for (const peerID in peersMap) {\n    const peer = peersMap[peerID];\n    const { video, audio } = getScreenSharesByPeer(tracksMap, peer);\n    if (video) {\n      return peer;\n    } else if (audio && !screensharePeer) {\n      screensharePeer = peer;\n    }\n  }\n  return screensharePeer;\n});\n\n/**\n * Select a boolean denoting whether someone is sharing screen in the room.\n */\nexport const selectIsSomeoneScreenSharing = createSelector(selectPeerScreenSharing, peer => {\n  return !!peer;\n});\n\n/**\n * Select the first peer who is currently sharing their audio only screen\n */\nexport const selectPeerSharingAudio = createSelector(selectPeersMap, selectTracksMap, (peersMap, tracksMap) => {\n  for (const peerID in peersMap) {\n    const peer = peersMap[peerID];\n    const { audio, video } = getScreenSharesByPeer(tracksMap, peer);\n    if (!video && !!audio) {\n      return peer;\n    }\n  }\n  return undefined;\n});\n\n/**\n * Select an array of peers who are currently sharing their screen.\n */\nexport const selectPeersScreenSharing = createSelector(selectPeersMap, selectTracksMap, (peersMap, tracksMap) => {\n  const videoPeers = [];\n  const audioPeers = [];\n  for (const peerID in peersMap) {\n    const peer = peersMap[peerID];\n    const { video, audio } = getScreenSharesByPeer(tracksMap, peer);\n    if (video) {\n      videoPeers.push(peer);\n    } else if (audio) {\n      audioPeers.push(peer);\n    }\n  }\n  return videoPeers.concat(audioPeers);\n});\n\nexport const selectPeerSharingVideoPlaylist = createSelector(selectPeersMap, selectTracksMap, (peersMap, tracksMap) => {\n  for (const trackId in tracksMap) {\n    const track = tracksMap[trackId];\n    if (isVideoPlaylist(track) && isVideo(track) && track.peerId) {\n      return peersMap[track.peerId];\n    }\n  }\n  return undefined;\n});\n\nexport const selectPeerSharingAudioPlaylist = createSelector(selectPeersMap, selectTracksMap, (peersMap, tracksMap) => {\n  for (const trackId in tracksMap) {\n    const track = tracksMap[trackId];\n    if (isAudioPlaylist(track) && track.peerId) {\n      return peersMap[track.peerId];\n    }\n  }\n  return undefined;\n});\n\n/**\n * Select an array of tracks that have been degraded(receiving lower video quality/no video) due to bad network locally.\n */\nexport const selectDegradedTracks = createSelector(selectTracks, tracks =>\n  (tracks as HMSVideoTrack[]).filter(isDegraded),\n);\n\n/**\n * Select the number of messages(sent and received).\n */\nexport const selectHMSMessagesCount = createSelector(selectMessageIDsInOrder, messageIDs => messageIDs.length);\n\n/**\n * Select the number of unread messages.\n */\nexport const selectUnreadHMSMessagesCount = createSelector(selectMessagesMap, messages => {\n  return Object.values(messages).filter(m => !m.read).length;\n});\n\n/**\n * Select an array of messages in the room(sent and received).\n */\nexport const selectHMSMessages = createSelector(selectMessageIDsInOrder, selectMessagesMap, (msgIDs, msgMap) => {\n  const messages: HMSMessage[] = [];\n  msgIDs.forEach(msgId => {\n    messages.push(msgMap[msgId]);\n  });\n  return messages;\n});\n\nexport const selectHMSBroadcastMessages = createSelector(selectHMSMessages, messages => {\n  return messages.filter(m => !m.recipientPeer && !(m.recipientRoles && m.recipientRoles?.length > 0));\n});\n/**\n * Select the number of unread broadcast messages\n */\nexport const selectUnreadHMSBroadcastMessagesCount = createSelector(selectHMSBroadcastMessages, messages => {\n  return messages.filter(m => !m.read).length;\n});\n/**\n * Select the current state of the room.\n */\nexport const selectRoomState = createSelector([selectRoom], room => room && room.roomState);\n\n/**\n * Select a boolean denoting whether the room is in Preview state.\n */\nexport const selectIsInPreview = createSelector(selectRoomState, roomState => roomState === HMSRoomState.Preview);\n\nexport const selectRoomStarted = createSelector(selectRoom, room => room.roomState !== HMSRoomState.Disconnected);\n\nexport const selectIsTranscriptionEnabled = createSelector(selectRoom, room => {\n  if (!room.transcriptions || room.transcriptions.length <= 0) {\n    return false;\n  }\n  return room.transcriptions.some(\n    transcription =>\n      transcription.mode === HMSTranscriptionMode.CAPTION && transcription.state === HMSTranscriptionState.STARTED,\n  );\n});\n\n/**\n * Select available roles in the room as a map between the role name and {@link HMSRole} object.\n */\nexport const selectRolesMap = (store: HMSStore): Record<string, HMSRole> => {\n  return store.roles;\n};\n\n/**\n * Select an array of names of available roles in the room.\n */\nexport const selectAvailableRoleNames = createSelector([selectRolesMap], rolesMap => Object.keys(rolesMap));\n\n/**\n * Select the {@link HMSRole} object of your local peer.\n */\nexport const selectLocalPeerRole = createSelector([selectLocalPeer, selectRolesMap], (localPeer, rolesMap) =>\n  localPeer?.roleName ? rolesMap[localPeer.roleName] : null,\n);\n\nexport const selectPreviewRoleName = (store: HMSStore) => store.preview?.asRole;\n\n/**\n * Select the {@link HMSRole} used for preview.\n *\n */\nexport const selectPreviewRole = createSelector([selectPreviewRoleName, selectRolesMap], (roleName, rolesMap) =>\n  roleName ? rolesMap[roleName] : null,\n);\n\n/**\n * Select a boolean denoting whether if your local peer is allowed to subscribe to any other role.\n */\nexport const selectIsAllowedToSubscribe = createSelector([selectLocalPeerRole], (role): boolean => {\n  if (!role?.subscribeParams?.subscribeToRoles) {\n    return false;\n  }\n  return role.subscribeParams.subscribeToRoles.length > 0;\n});\n\n/**\n * Select the permissions which determine what actions the local peer can do.\n */\nexport const selectPermissions = createSelector(selectLocalPeerRole, role => role?.permissions);\nexport const selectRecordingState = createSelector(selectRoom, room => room.recording);\nexport const selectRTMPState = createSelector(selectRoom, room => room.rtmp);\nexport const selectHLSState = createSelector(selectRoom, room => room.hls);\nexport const selectTranscriptionsState = createSelector(selectRoom, room => room.transcriptions);\nexport const selectSessionId = createSelector(selectRoom, room => room.sessionId);\nexport const selectRoomStartTime = createSelector(selectRoom, room => room.startedAt);\nexport const selectIsLargeRoom = createSelector(selectRoom, room => !!room.isLargeRoom);\nexport const selectIsEffectsEnabled = createSelector(selectRoom, room => !!room.isEffectsEnabled);\nexport const selectIsVBEnabled = createSelector(selectRoom, room => !!room.isVBEnabled);\nexport const selectEffectsKey = createSelector(selectRoom, room => room.effectsKey);\n\nexport const selectTemplateAppData = (store: HMSStore) => store.templateAppData;\n/** @deprecated - use `selectSessionStore` instead */\nexport const selectSessionMetadata = (store: HMSStore) => store.sessionMetadata;\nexport const selectPollsMap = (store: HMSStore) => store.polls;\nexport const selectPolls = (store: HMSStore) => {\n  return Object.values(store.polls);\n};\n\nexport const selectHandRaisedPeers = createSelector(selectPeers, peers => {\n  return peers.filter(peer => peer.isHandRaised);\n});\n\n/** select a map of all the whiteboards in the session */\nexport const selectWhiteboards = (store: HMSStore) => store.whiteboards;\n/** select the primary/first whiteboard of a session */\nexport const selectWhiteboard = createSelector(\n  selectWhiteboards,\n  whiteboards => Object.values(whiteboards)[0] as HMSWhiteboard | undefined,\n);\n", "import {\n  HMSPeer,\n  HMSPublishAllowed,\n  HMSRole,\n  HMSScreenAudioTrack,\n  HMSScreenVideoTrack,\n  HMSStore,\n  HMSTrack,\n  HMSTrackID,\n  HMSVideoTrack,\n} from '../schema';\n\nexport function getScreenSharesByPeer(tracks: Record<HMSTrackID, HMSTrack>, peer?: HMSPeer | null) {\n  let videoTrack = undefined;\n  let audioTrack = undefined;\n  if (peer) {\n    for (const trackID of peer.auxiliaryTracks) {\n      const track = tracks[trackID];\n      if (isScreenShare(track)) {\n        audioTrack = isAudio(track) ? track : audioTrack;\n        videoTrack = isVideo(track) ? track : videoTrack;\n      }\n    }\n  }\n  // to use the proper type, right now it is only used for screenshare.\n  return { video: videoTrack as HMSScreenVideoTrack, audio: audioTrack as HMSScreenAudioTrack };\n}\n\nexport function isAudio(track: HMSTrack | undefined) {\n  return track && track.type === 'audio';\n}\n\nexport function isVideo(track: HMSTrack | undefined) {\n  return track && track.type === 'video';\n}\n\nexport function isScreenShare(track: HMSTrack | undefined) {\n  return track && track.source === 'screen';\n}\n\nexport function isAudioPlaylist(track: HMSTrack | undefined) {\n  return track && track.source === 'audioplaylist';\n}\n\nexport function isVideoPlaylist(track: HMSTrack | undefined) {\n  return track && track.source === 'videoplaylist';\n}\n\nexport function isDegraded(track: HMSVideoTrack) {\n  if (track) {\n    return Boolean(track?.degraded);\n  }\n  return false;\n}\n\nexport function isTrackEnabled(store: HMSStore, trackID?: string) {\n  if (trackID && store.tracks[trackID]) {\n    return store.tracks[trackID].enabled;\n  }\n  return false;\n}\n\n/**\n * Should UI show the video track as enabled\n */\nexport function isTrackDisplayEnabled(store: HMSStore, trackID?: string) {\n  if (trackID && store.tracks[trackID]) {\n    return store.tracks[trackID].displayEnabled;\n  }\n  return false;\n}\n\nexport function isRoleAllowedToPublish(role?: HMSRole | null): HMSPublishAllowed {\n  let video = false,\n    audio = false,\n    screen = false;\n  if (role?.publishParams?.allowed) {\n    video = role.publishParams.allowed.includes('video');\n    audio = role.publishParams.allowed.includes('audio');\n    screen = role.publishParams.allowed.includes('screen');\n  }\n  return {\n    video,\n    audio,\n    screen,\n  };\n}\n", "export enum HMSLogLevel {\n  VERBOSE,\n  DEBUG,\n  INFO,\n  WARN,\n  TIME,\n  TIMEEND,\n  ERROR,\n  NONE,\n}\n\n// @ts-ignore - window.expect is available only when in test environment\nconst isTestEnv = typeof window !== 'undefined' && typeof window.expect !== 'undefined';\n/**\n * TODO: fix this so logs show the real file and line numbers where they originated from instead of this class\n * https://stackoverflow.com/questions/13815640/a-proper-wrapper-for-console-log-with-correct-line-number\n */\nexport default class HMSLogger {\n  static level: HMSLogLevel = isTestEnv ? HMSLogLevel.NONE : HMSLogLevel.VERBOSE;\n\n  static v(tag: string, ...data: any[]) {\n    this.log(HMSLogLevel.VERBOSE, tag, ...data);\n  }\n\n  static d(tag: string, ...data: any[]) {\n    this.log(HMSLogLevel.DEBUG, tag, ...data);\n  }\n\n  static i(tag: string, ...data: any[]) {\n    this.log(HMSLogLevel.INFO, tag, ...data);\n  }\n\n  static w(tag: string, ...data: any[]) {\n    this.log(HMSLogLevel.WARN, tag, ...data);\n  }\n\n  static e(tag: string, ...data: any[]) {\n    this.log(HMSLogLevel.ERROR, tag, ...data);\n  }\n\n  static time(mark: string) {\n    this.log(HMSLogLevel.TIME, '[HMSPerformanceTiming]', mark);\n  }\n\n  static timeEnd(mark: string) {\n    this.log(HMSLogLevel.TIMEEND, '[HMSPerformanceTiming]', mark, mark);\n  }\n\n  static cleanup() {\n    performance.clearMarks();\n    performance.clearMeasures();\n  }\n\n  // eslint-disable-next-line complexity\n  private static log(level: HMSLogLevel, tag: string, ...data: any[]) {\n    if (this.level.valueOf() > level.valueOf()) {\n      return;\n    }\n\n    switch (level) {\n      case HMSLogLevel.VERBOSE: {\n        console.log(tag, ...data);\n        break;\n      }\n      case HMSLogLevel.DEBUG: {\n        console.debug(tag, ...data);\n        break;\n      }\n      case HMSLogLevel.INFO: {\n        console.info(tag, ...data);\n        break;\n      }\n      case HMSLogLevel.WARN: {\n        console.warn(tag, ...data);\n        break;\n      }\n      case HMSLogLevel.ERROR: {\n        console.error(tag, ...data);\n        break;\n      }\n      case HMSLogLevel.TIME: {\n        performance.mark(data[0]);\n        break;\n      }\n      case HMSLogLevel.TIMEEND: {\n        const mark = data[0];\n        try {\n          const entry = performance.measure(mark, mark);\n          // @ts-ignore\n          this.log(HMSLogLevel.DEBUG, tag, mark, entry?.duration);\n          performance.clearMarks(mark);\n          performance.clearMeasures(mark);\n        } catch (error) {\n          this.log(HMSLogLevel.DEBUG, tag, mark, error);\n        }\n        break;\n      }\n    }\n  }\n}\n", "import { HMSTrack } from '../tracks';\n\nexport class HMSMediaStream {\n  readonly nativeStream: MediaStream;\n  id: string;\n\n  readonly tracks = new Array<HMSTrack>();\n\n  constructor(nativeStream: MediaStream) {\n    this.nativeStream = nativeStream;\n    this.id = nativeStream.id;\n  }\n\n  /**\n   * This is only used when onDemandTracks flag is enabled in Init\n   * @param id\n   */\n  updateId(id: string) {\n    this.id = id;\n  }\n}\n", "import { UAParser } from 'ua-parser-js';\n\nexport const parsedUserAgent = new UAParser();\n\nexport const isBrowser = typeof window !== 'undefined';\n\nexport const isNode =\n  typeof window === 'undefined' && !parsedUserAgent.getBrowser().name?.toLowerCase().includes('electron');\n\nexport enum ENV {\n  PROD = 'prod',\n  QA = 'qa',\n  DEV = 'dev',\n}\n\nconst checkIsSupported = () => {\n  if (isNode) {\n    return false;\n  }\n  // @TODO: Get this from preview/init API from server\n  return true;\n};\n\nexport const isSupported = checkIsSupported();\n\nexport const isMobile = () => parsedUserAgent.getDevice().type === 'mobile';\n\nexport const isPageHidden = () => typeof document !== 'undefined' && document.hidden;\n\nexport const isIOS = () => parsedUserAgent.getOS().name?.toLowerCase() === 'ios';\n\n// safari for mac and mobile safari for iOS\nexport const isSafari = parsedUserAgent.getBrowser()?.name?.toLowerCase().includes('safari');\n\nexport const isFirefox = parsedUserAgent.getBrowser()?.name?.toLowerCase() === 'firefox';\n", "import { v4 as uuid } from 'uuid';\nimport { AnalyticsEventLevel } from './AnalyticsEventLevel';\nimport { domainCategory } from './domain-analytics';\nimport { ISignalParamsProvider } from '../signal/ISignalSendParamsProvider';\nimport { getAnalyticsDeviceId } from '../utils/analytics-deviceId';\nimport { createUserAgent } from '../utils/user-agent';\n\ninterface AnalyticsEventInit {\n  name: string;\n  level: AnalyticsEventLevel;\n  includesPII?: boolean;\n  properties?: Record<string, any>;\n  timestamp?: number;\n}\n\ninterface SignalEventParams {\n  name: string;\n  info: any;\n  timestamp: number;\n}\n\nexport default class AnalyticsEvent implements ISignalParamsProvider<SignalEventParams> {\n  name: string;\n  level: AnalyticsEventLevel;\n  includesPII: boolean;\n  properties: Record<string, any>;\n  metadata: {\n    token?: string;\n    peer: {\n      peer_id?: string;\n      session_id?: string;\n      room_id?: string;\n      role?: string;\n      room_name?: string;\n      joined_at?: number;\n      template_id?: string;\n      session_started_at?: number;\n      user_name?: string;\n      user_data?: string;\n    };\n    userAgent: string;\n  } = {\n    peer: {},\n    userAgent: createUserAgent(),\n  };\n  timestamp: number;\n  event_id: string;\n  device_id: string;\n\n  constructor({ name, level, properties, includesPII, timestamp }: AnalyticsEventInit) {\n    this.name = name;\n    this.level = level;\n    this.includesPII = includesPII || false;\n    this.properties = properties || {};\n    this.timestamp = timestamp || new Date().getTime(); // Timestamp of generating the event\n    this.event_id = uuid();\n    this.device_id = getAnalyticsDeviceId();\n  }\n\n  toSignalParams() {\n    return {\n      name: this.name,\n      info: { ...this.properties, timestamp: this.timestamp, domain: domainCategory },\n      timestamp: new Date().getTime(), // Timestamp of sending the event\n    };\n  }\n}\n", "export enum DomainCategory {\n  CUSTOM = 'CUSTOM',\n  LOCAL = 'LOCAL',\n  HMS = 'HMS',\n}\n", "import { DomainCategory } from './AnalyticsEventDomains';\nimport { isBrowser } from '../utils/support';\n\nfunction getDomainCategory() {\n  // this function gives us the domain category(sutom, hms , local) of the base url.\n  // below if statement checks if it's running in a browser ; or if we can use 'window' safely\n\n  if (isBrowser && window) {\n    const baseurl = window.location.hostname;\n\n    if (baseurl === 'localhost' || baseurl === '127.0.0.1') {\n      return DomainCategory.LOCAL;\n    }\n\n    if (baseurl.includes('app.100ms.live')) {\n      return DomainCategory.HMS;\n    } else {\n      return DomainCategory.CUSTOM;\n    }\n  }\n\n  return DomainCategory.CUSTOM;\n}\n\nexport const domainCategory = getDomainCategory();\n", "import { v4 as uuid } from 'uuid';\nimport { LocalStorage } from './local-storage';\n\nexport const getAnalyticsDeviceId = () => {\n  let id;\n  const storage = new LocalStorage<string>('hms-analytics-deviceId');\n  const storageId = storage.get();\n  if (storageId) {\n    id = storageId;\n  } else {\n    id = uuid();\n    storage.set(id);\n  }\n  return id;\n};\n", "/*\n * ErrorCodes.ts\n *\n * Created by codegen\n * Copyright \u00A9 2021 100ms. All rights reserved.\n */\n\nexport const ErrorCodes = {\n  // https://www.rfc-editor.org/rfc/rfc6455#section-7.4.1\n  WebSocketConnectionErrors: {\n    // Error connecting to ws or init config not available\n    FAILED_TO_CONNECT: 1000,\n\n    // Network connection lost\n    WEBSOCKET_CONNECTION_LOST: 1003,\n\n    // Abnormal close without receiving a Close control frame\n    ABNORMAL_CLOSE: 1006,\n  },\n\n  APIErrors: {\n    // [INIT]: Server error\n    SERVER_ERRORS: 2000,\n    //init config not available\n    INIT_CONFIG_NOT_AVAILABLE: 2002,\n\n    // Endpoint is not reachable.\n    ENDPOINT_UNREACHABLE: 2003,\n\n    // Token is not in proper JWT format\n    INVALID_TOKEN_FORMAT: 2004,\n  },\n\n  TracksErrors: {\n    // [PUBLISH]: Error with getusermedia request\n    GENERIC_TRACK: 3000,\n\n    // [PUBLISH]: No permission to access capture device - {device_type}\n    CANT_ACCESS_CAPTURE_DEVICE: 3001,\n\n    // [PUBLISH]: Capture device is no longer available - {device_type}\n    DEVICE_NOT_AVAILABLE: 3002,\n\n    // [PUBLISH]: Capture device is in use by another application - {device_type}\n    DEVICE_IN_USE: 3003,\n\n    // Lost access to capture device midway - {device_type}\n    DEVICE_LOST_MIDWAY: 3004,\n\n    // There is no media to return. Please select either video or audio or both.\n    NOTHING_TO_RETURN: 3005,\n\n    // Cannot enable simulcast when no video settings are provided\n    INVALID_VIDEO_SETTINGS: 3006,\n\n    // Codec can't be changed mid call.\n    CODEC_CHANGE_NOT_PERMITTED: 3007,\n\n    // When the browser throws autoplay exception if something is played before interacting\n    AUTOPLAY_ERROR: 3008,\n\n    // Over constrained error - device hardware unable to satisfy requested constraints\n    OVER_CONSTRAINED: 3009,\n\n    // No audio detected from track, indicates problem with device hardware\n    NO_AUDIO_DETECTED: 3010,\n\n    // Operating System denied permission\n    SYSTEM_DENIED_PERMISSION: 3011,\n\n    // Current tab is not shared when forceCurrentTab was set to true for screenshare\n    CURRENT_TAB_NOT_SHARED: 3012,\n\n    // any error that occurs while playing audio of remote audio tracks\n    AUDIO_PLAYBACK_ERROR: 3013,\n\n    // Selected device not detected on change\n    SELECTED_DEVICE_MISSING: 3014,\n  },\n\n  WebrtcErrors: {\n    // [{action}]: Failed to create offer.\n    CREATE_OFFER_FAILED: 4001,\n\n    // [{action}]: Failed to create answer.\n    CREATE_ANSWER_FAILED: 4002,\n\n    // [{action}]: Failed to set offer.\n    SET_LOCAL_DESCRIPTION_FAILED: 4003,\n\n    // [{action}]: Failed to set answer.\n    SET_REMOTE_DESCRIPTION_FAILED: 4004,\n\n    // [{action}]: Ice connection state FAILED\n    ICE_FAILURE: 4005,\n\n    // [{action}]: Ice connection state FAILED\n    ICE_DISCONNECTED: 4006,\n\n    STATS_FAILED: 4007,\n  },\n\n  WebsocketMethodErrors: {\n    // [JOIN]: {server_error}\n    SERVER_ERRORS: 5000,\n\n    // [JOIN]: You have already joined this room.\n    ALREADY_JOINED: 5001,\n\n    // [JOIN]: Cannot join if preview is in progress\n    CANNOT_JOIN_PREVIEW_IN_PROGRESS: 5002,\n  },\n\n  GenericErrors: {\n    // Client is not connected\n    NOT_CONNECTED: 6000,\n\n    // Unknown signalling error: {action} {error_info}\n    SIGNALLING: 6001,\n\n    // Unknown exception: {error_info}\n    UNKNOWN: 6002,\n\n    // WebRTC engine is not ready yet\n    NOT_READY: 6003,\n\n    // Failed to parse JSON message - {json_message}\n    JSON_PARSING_FAILED: 6004,\n\n    // Track Metadata Missing\n    TRACK_METADATA_MISSING: 6005,\n\n    // RTC Track missing\n    RTC_TRACK_MISSING: 6006,\n\n    // Peer Metadata Missing\n    PEER_METADATA_MISSING: 6007,\n\n    // Joined with invalid role\n    INVALID_ROLE: 6008,\n\n    PREVIEW_IN_PROGRESS: 6009,\n\n    MISSING_MEDIADEVICES: 6010,\n\n    MISSING_RTCPEERCONNECTION: 6011,\n    LOCAL_STORAGE_ACCESS_DENIED: 6012,\n    // peer not present or role not present or any general validation\n    VALIDATION_FAILED: 6013,\n  },\n\n  PlaylistErrors: {\n    NO_ENTRY_TO_PLAY: 8001,\n    NO_ENTRY_IS_PLAYING: 8002,\n  },\n};\n", "import { HMSAction } from './HMSAction';\nimport { IAnalyticsPropertiesProvider } from '../analytics/IAnalyticsPropertiesProvider';\nimport { HMSSignalMethod } from '../signal/jsonrpc/models';\n\nexport class HMSException extends Error implements IAnalyticsPropertiesProvider {\n  action: string;\n  nativeError?: Error;\n\n  constructor(\n    public readonly code: number,\n    public name: string,\n    action: HMSAction | HMSSignalMethod,\n    public message: string,\n    public description: string,\n    public isTerminal: boolean = false,\n  ) {\n    super(message);\n\n    // Ref: https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work\n    Object.setPrototypeOf(this, HMSException.prototype);\n    this.action = action.toString();\n  }\n\n  toAnalyticsProperties() {\n    return {\n      error_name: this.name,\n      error_code: this.code,\n      error_message: this.message,\n      error_description: this.description,\n      action: this.action,\n      is_terminal: this.isTerminal,\n    };\n  }\n\n  addNativeError(error: Error) {\n    this.nativeError = error;\n  }\n\n  toString() {\n    return `{\n      code: ${this.code};\n      name: ${this.name};\n      action: ${this.action};\n      message: ${this.message};\n      description: ${this.description};\n      isTerminal: ${this.isTerminal};\n      nativeError: ${this.nativeError?.message};\n    }`;\n  }\n}\n", "import { HMSAction } from '../../error/HMSAction';\n\nexport interface JsonRpcRequest {\n  id: string;\n  method: string;\n  params: Map<string, any>;\n}\n\nexport interface JsonRpcResponse {\n  id: string;\n  result: any;\n  error: {\n    code: number;\n    message: string;\n  };\n}\n\nexport enum HMSSignalMethod {\n  JOIN = 'join',\n  OFFER = 'offer',\n  ANSWER = 'answer',\n  TRICKLE = 'trickle',\n  TRACK_UPDATE = 'track-update',\n  BROADCAST = 'broadcast',\n  ANALYTICS = 'analytics',\n  SERVER_ERROR = 'on-error',\n  SERVER_WARNING = 'on-warning',\n  SDK_NOTIFICATION = 'sdk-notification',\n  LEAVE = 'leave',\n  END_ROOM = 'end-room',\n  PING = 'ping',\n  ROLE_CHANGE_REQUEST = 'role-change-request',\n  ROLE_CHANGE = 'role-change',\n  TRACK_UPDATE_REQUEST = 'track-update-request',\n  PEER_LEAVE_REQUEST = 'peer-leave-request',\n  CHANGE_TRACK_MUTE_STATE_REQUEST = 'change-track-mute-state-request',\n  START_RTMP_OR_RECORDING_REQUEST = 'rtmp-start',\n  STOP_RTMP_AND_RECORDING_REQUEST = 'rtmp-stop',\n  UPDATE_PEER_METADATA = 'peer-update',\n  START_HLS_STREAMING = 'hls-start',\n  STOP_HLS_STREAMING = 'hls-stop',\n  START_TRANSCRIPTION = 'transcription-start',\n  STOP_TRANSCRIPTION = 'transcription-stop',\n  HLS_TIMED_METADATA = 'hls-timed-metadata',\n  SET_METADATA = 'set-metadata',\n  GET_METADATA = 'get-metadata',\n  LISTEN_METADATA_CHANGE = 'listen-metadata-change',\n  POLL_INFO_SET = 'poll-info-set',\n  POLL_INFO_GET = 'poll-info-get',\n  POLL_QUESTIONS_SET = 'poll-questions-set',\n  POLL_QUESTIONS_GET = 'poll-questions-get',\n  POLL_START = 'poll-start',\n  POLL_STOP = 'poll-stop',\n  POLL_RESPONSE_SET = 'poll-response',\n  POLL_LIST = 'poll-list',\n  POLL_RESPONSES = 'poll-responses',\n  POLL_RESULT = 'poll-result',\n  POLL_LEADERBOARD = 'poll-leaderboard',\n  GET_PEER = 'get-peer',\n  FIND_PEER = 'find-peer',\n  SEARCH_BY_NAME = 'peer-name-search',\n  PEER_ITER_NEXT = 'peer-iter-next',\n  GROUP_JOIN = 'group-join',\n  GROUP_LEAVE = 'group-leave',\n  GROUP_ADD = 'group-add',\n  GROUP_REMOVE = 'group-remove',\n  WHITEBOARD_CREATE = 'whiteboard-create',\n  WHITEBOARD_GET = 'whiteboard-get',\n}\n\nexport function convertSignalMethodtoErrorAction(method: HMSSignalMethod): HMSAction {\n  switch (method) {\n    case HMSSignalMethod.JOIN:\n      return HMSAction.JOIN;\n    case HMSSignalMethod.OFFER:\n      return HMSAction.PUBLISH;\n    case HMSSignalMethod.ANSWER:\n      return HMSAction.SUBSCRIBE;\n    case HMSSignalMethod.TRACK_UPDATE:\n      return HMSAction.TRACK;\n    default:\n      return HMSAction.NONE;\n  }\n}\n", "/*\n * ErrorFactory.ts\n *\n * Created by codegen\n * Copyright \u00A9 2021 100ms. All rights reserved.\n */\n\nimport { ErrorCodes } from './ErrorCodes';\nimport { HMSAction } from './HMSAction';\nimport { HMSException } from './HMSException';\nimport { HMSSignalMethod } from '../signal/jsonrpc/models';\n\nconst terminalActions: (HMSSignalMethod | HMSAction)[] = [\n  HMSSignalMethod.JOIN,\n  HMSSignalMethod.OFFER,\n  HMSSignalMethod.ANSWER,\n  HMSSignalMethod.TRICKLE,\n  HMSSignalMethod.SERVER_ERROR,\n  HMSAction.JOIN,\n];\n\nexport const ErrorFactory = {\n  WebSocketConnectionErrors: {\n    FailedToConnect(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.WebSocketConnectionErrors.FAILED_TO_CONNECT,\n        'WebsocketFailedToConnect',\n        action,\n        `[WS]: ${description}`,\n        `[WS]: ${description}`,\n      );\n    },\n\n    WebSocketConnectionLost(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.WebSocketConnectionErrors.WEBSOCKET_CONNECTION_LOST,\n        'WebSocketConnectionLost',\n        action,\n        `Network connection lost`,\n        description,\n      );\n    },\n\n    AbnormalClose(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.WebSocketConnectionErrors.ABNORMAL_CLOSE,\n        'WebSocketAbnormalClose',\n        action,\n        `Websocket closed abnormally`,\n        description,\n      );\n    },\n  },\n\n  APIErrors: {\n    ServerErrors(code: number, action: HMSAction, description = '', isTerminal = true) {\n      return new HMSException(\n        code,\n        'ServerErrors',\n        action,\n        `[${action}]: Server error ${description}`,\n        description,\n        isTerminal,\n      );\n    },\n\n    EndpointUnreachable(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.APIErrors.ENDPOINT_UNREACHABLE,\n        'EndpointUnreachable',\n        action,\n        `Endpoint is not reachable - ${description}`,\n        description,\n      );\n    },\n\n    InvalidTokenFormat(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.APIErrors.INVALID_TOKEN_FORMAT,\n        'InvalidTokenFormat',\n        action,\n        `Token is not in proper JWT format - ${description}`,\n        description,\n        true,\n      );\n    },\n\n    InitConfigNotAvailable(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.APIErrors.INIT_CONFIG_NOT_AVAILABLE,\n        'InitError',\n        action,\n        `[INIT]: ${description}`,\n        `[INIT]: ${description}`,\n      );\n    },\n  },\n\n  TracksErrors: {\n    GenericTrack(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.TracksErrors.GENERIC_TRACK,\n        'GenericTrack',\n        action,\n        `[TRACK]: ${description}`,\n        `[TRACK]: ${description}`,\n      );\n    },\n\n    CantAccessCaptureDevice(action: HMSAction, deviceInfo: string, description = '') {\n      return new HMSException(\n        ErrorCodes.TracksErrors.CANT_ACCESS_CAPTURE_DEVICE,\n        'CantAccessCaptureDevice',\n        action,\n        `User denied permission to access capture device - ${deviceInfo}`,\n        description,\n      );\n    },\n\n    DeviceNotAvailable(action: HMSAction, deviceInfo: string, description = '') {\n      return new HMSException(\n        ErrorCodes.TracksErrors.DEVICE_NOT_AVAILABLE,\n        'DeviceNotAvailable',\n        action,\n        `[TRACK]: Capture device is no longer available - ${deviceInfo}`,\n        description,\n      );\n    },\n\n    DeviceInUse(action: HMSAction, deviceInfo: string, description = '') {\n      return new HMSException(\n        ErrorCodes.TracksErrors.DEVICE_IN_USE,\n        'DeviceInUse',\n        action,\n        `[TRACK]: Capture device is in use by another application - ${deviceInfo}`,\n        description,\n      );\n    },\n\n    DeviceLostMidway(action: HMSAction, deviceInfo: string, description = '') {\n      return new HMSException(\n        ErrorCodes.TracksErrors.DEVICE_LOST_MIDWAY,\n        'DeviceLostMidway',\n        action,\n        `Lost access to capture device midway - ${deviceInfo}`,\n        description,\n      );\n    },\n\n    NothingToReturn(\n      action: HMSAction,\n      description = '',\n      message = `There is no media to return. Please select either video or audio or both.`,\n    ) {\n      return new HMSException(\n        ErrorCodes.TracksErrors.NOTHING_TO_RETURN,\n        'NothingToReturn',\n        action,\n        message,\n        description,\n      );\n    },\n\n    InvalidVideoSettings(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.TracksErrors.INVALID_VIDEO_SETTINGS,\n        'InvalidVideoSettings',\n        action,\n        `Cannot enable simulcast when no video settings are provided`,\n        description,\n      );\n    },\n\n    AutoplayBlocked(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.TracksErrors.AUTOPLAY_ERROR,\n        'AutoplayBlocked',\n        action,\n        \"Autoplay blocked because the user didn't interact with the document first\",\n        description,\n      );\n    },\n\n    CodecChangeNotPermitted(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.TracksErrors.CODEC_CHANGE_NOT_PERMITTED,\n        'CodecChangeNotPermitted',\n        action,\n        `Codec can't be changed mid call.`,\n        description,\n      );\n    },\n\n    OverConstrained(action: HMSAction, deviceInfo: string, description = '') {\n      return new HMSException(\n        ErrorCodes.TracksErrors.OVER_CONSTRAINED,\n        'OverConstrained',\n        action,\n        `[TRACK]: Requested constraints cannot be satisfied with the device hardware - ${deviceInfo}`,\n        description,\n      );\n    },\n\n    NoAudioDetected(action: HMSAction, description = 'Please check the mic or use another audio input') {\n      return new HMSException(\n        ErrorCodes.TracksErrors.NO_AUDIO_DETECTED,\n        'NoAudioDetected',\n        action,\n        'No audio input detected from microphone',\n        description,\n      );\n    },\n\n    SystemDeniedPermission(action: HMSAction, deviceInfo: string, description = '') {\n      return new HMSException(\n        ErrorCodes.TracksErrors.SYSTEM_DENIED_PERMISSION,\n        'SystemDeniedPermission',\n        action,\n        `Operating System denied permission to access capture device - ${deviceInfo}`,\n        description,\n      );\n    },\n\n    CurrentTabNotShared() {\n      return new HMSException(\n        ErrorCodes.TracksErrors.CURRENT_TAB_NOT_SHARED,\n        'CurrentTabNotShared',\n        HMSAction.TRACK,\n        'The app requires you to share the current tab',\n        'You must screen share the current tab in order to proceed',\n      );\n    },\n\n    AudioPlaybackError(description: string) {\n      return new HMSException(\n        ErrorCodes.TracksErrors.AUDIO_PLAYBACK_ERROR,\n        'Audio playback error',\n        HMSAction.TRACK,\n        description,\n        description,\n      );\n    },\n\n    SelectedDeviceMissing(deviceType: string) {\n      return new HMSException(\n        ErrorCodes.TracksErrors.SELECTED_DEVICE_MISSING,\n        'SelectedDeviceMissing',\n        HMSAction.TRACK,\n        `Could not detect selected ${deviceType} device`,\n        `Please check connection to the ${deviceType} device`,\n        false,\n      );\n    },\n  },\n\n  WebrtcErrors: {\n    CreateOfferFailed(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.WebrtcErrors.CREATE_OFFER_FAILED,\n        'CreateOfferFailed',\n        action,\n        `[${action.toString()}]: Failed to create offer. `,\n        description,\n      );\n    },\n\n    CreateAnswerFailed(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.WebrtcErrors.CREATE_ANSWER_FAILED,\n        'CreateAnswerFailed',\n        action,\n        `[${action.toString()}]: Failed to create answer. `,\n        description,\n      );\n    },\n\n    SetLocalDescriptionFailed(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.WebrtcErrors.SET_LOCAL_DESCRIPTION_FAILED,\n        'SetLocalDescriptionFailed',\n        action,\n        `[${action.toString()}]: Failed to set offer. `,\n        description,\n      );\n    },\n\n    SetRemoteDescriptionFailed(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.WebrtcErrors.SET_REMOTE_DESCRIPTION_FAILED,\n        'SetRemoteDescriptionFailed',\n        action,\n        `[${action.toString()}]: Failed to set answer. `,\n        description,\n        true,\n      );\n    },\n\n    ICEFailure(action: HMSAction, description = '', isTerminal = false) {\n      return new HMSException(\n        ErrorCodes.WebrtcErrors.ICE_FAILURE,\n        'ICEFailure',\n        action,\n        `[${action.toString()}]: Ice connection state FAILED`,\n        description,\n        isTerminal,\n      );\n    },\n\n    ICEDisconnected(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.WebrtcErrors.ICE_DISCONNECTED,\n        'ICEDisconnected',\n        action,\n        `[${action.toString()}]: Ice connection state DISCONNECTED`,\n        description,\n      );\n    },\n\n    StatsFailed(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.WebrtcErrors.STATS_FAILED,\n        'StatsFailed',\n        action,\n        `Failed to WebRTC get stats - ${description}`,\n        description,\n      );\n    },\n  },\n\n  WebsocketMethodErrors: {\n    ServerErrors(code: number, action: HMSAction | HMSSignalMethod, description: string) {\n      return new HMSException(code, 'ServerErrors', action, description, description, terminalActions.includes(action));\n    },\n\n    AlreadyJoined(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.WebsocketMethodErrors.ALREADY_JOINED,\n        'AlreadyJoined',\n        action,\n        `[JOIN]: You have already joined this room.`,\n        description,\n      );\n    },\n\n    CannotJoinPreviewInProgress(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.WebsocketMethodErrors.CANNOT_JOIN_PREVIEW_IN_PROGRESS,\n        'CannotJoinPreviewInProgress',\n        action,\n        `[JOIN]: Cannot join if preview is in progress`,\n        description,\n      );\n    },\n  },\n\n  GenericErrors: {\n    NotConnected(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.GenericErrors.NOT_CONNECTED,\n        'NotConnected',\n        action,\n        `Client is not connected`,\n        description,\n      );\n    },\n\n    Signalling(action: HMSAction, description: string) {\n      return new HMSException(\n        ErrorCodes.GenericErrors.SIGNALLING,\n        'Signalling',\n        action,\n        `Unknown signalling error: ${action.toString()} ${description} `,\n        description,\n      );\n    },\n\n    Unknown(action: HMSAction, description: string) {\n      return new HMSException(\n        ErrorCodes.GenericErrors.UNKNOWN,\n        'Unknown',\n        action,\n        `Unknown exception: ${description}`,\n        description,\n      );\n    },\n\n    NotReady(action: HMSAction, description = '') {\n      return new HMSException(ErrorCodes.GenericErrors.NOT_READY, 'NotReady', action, description, description);\n    },\n\n    JsonParsingFailed(action: HMSAction, jsonMessage: string, description = '') {\n      return new HMSException(\n        ErrorCodes.GenericErrors.JSON_PARSING_FAILED,\n        'JsonParsingFailed',\n        action,\n        `Failed to parse JSON message - ${jsonMessage}`,\n        description,\n      );\n    },\n\n    TrackMetadataMissing(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.GenericErrors.TRACK_METADATA_MISSING,\n        'TrackMetadataMissing',\n        action,\n        `Track Metadata Missing`,\n        description,\n      );\n    },\n\n    RTCTrackMissing(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.GenericErrors.RTC_TRACK_MISSING,\n        'RTCTrackMissing',\n        action,\n        `RTC Track missing`,\n        description,\n      );\n    },\n\n    PeerMetadataMissing(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.GenericErrors.PEER_METADATA_MISSING,\n        'PeerMetadataMissing',\n        action,\n        `Peer Metadata Missing`,\n        description,\n      );\n    },\n\n    ValidationFailed(message: string, entity?: any) {\n      return new HMSException(\n        ErrorCodes.GenericErrors.VALIDATION_FAILED,\n        'ValidationFailed',\n        HMSAction.VALIDATION,\n        message,\n        entity ? JSON.stringify(entity) : '',\n      );\n    },\n\n    InvalidRole(action: HMSAction, description: string) {\n      return new HMSException(\n        ErrorCodes.GenericErrors.INVALID_ROLE,\n        'InvalidRole',\n        action,\n        `Invalid role. Join with valid role`,\n        description,\n        true,\n      );\n    },\n\n    PreviewAlreadyInProgress(action: HMSAction, description = '') {\n      return new HMSException(\n        ErrorCodes.GenericErrors.PREVIEW_IN_PROGRESS,\n        'PreviewAlreadyInProgress',\n        action,\n        `[Preview]: Cannot join if preview is in progress`,\n        description,\n      );\n    },\n\n    LocalStorageAccessDenied(description = 'Access to localStorage has been denied') {\n      return new HMSException(\n        ErrorCodes.GenericErrors.LOCAL_STORAGE_ACCESS_DENIED,\n        'LocalStorageAccessDenied',\n        HMSAction.NONE,\n        `LocalStorageAccessDenied`,\n        description,\n      );\n    },\n\n    MissingMediaDevices() {\n      return new HMSException(\n        ErrorCodes.GenericErrors.MISSING_MEDIADEVICES,\n        'MissingMediaDevices',\n        HMSAction.JOIN,\n        `navigator.mediaDevices is undefined. 100ms SDK won't work on this website as WebRTC is not supported on HTTP endpoints(missing navigator.mediaDevices). Please ensure you're using the SDK either on localhost or a valid HTTPS endpoint.`,\n        '',\n        true,\n      );\n    },\n\n    MissingRTCPeerConnection() {\n      return new HMSException(\n        ErrorCodes.GenericErrors.MISSING_RTCPEERCONNECTION,\n        'MissingRTCPeerConnection',\n        HMSAction.JOIN,\n        `RTCPeerConnection which is a core requirement for WebRTC call was not found, this could be due to an unsupported browser or browser extensions blocking WebRTC`,\n        '',\n        true,\n      );\n    },\n  },\n\n  MediaPluginErrors: {\n    PlatformNotSupported(action: HMSAction, description = '') {\n      return new HMSException(\n        7001,\n        'PlatformNotSupported',\n        action,\n        'Check HMS Docs to see the list of supported platforms',\n        description,\n      );\n    },\n\n    InitFailed(action: HMSAction, description = '') {\n      return new HMSException(7002, 'InitFailed', action, 'Plugin init failed', description);\n    },\n\n    ProcessingFailed(action: HMSAction, description = '') {\n      return new HMSException(7003, 'ProcessingFailed', action, 'Plugin processing failed', description);\n    },\n\n    AddAlreadyInProgress(action: HMSAction, description = '') {\n      return new HMSException(7004, 'AddAlreadyInProgress', action, 'Plugin add already in progress', description);\n    },\n\n    DeviceNotSupported(action: HMSAction, description = '') {\n      return new HMSException(\n        7005,\n        'DeviceNotSupported',\n        action,\n        'Check HMS Docs to see the list of supported devices',\n        description,\n      );\n    },\n  },\n\n  PlaylistErrors: {\n    NoEntryToPlay(action: HMSAction, description: string) {\n      return new HMSException(\n        ErrorCodes.PlaylistErrors.NO_ENTRY_TO_PLAY,\n        'NoEntryToPlay',\n        action,\n        'Reached end of playlist',\n        description,\n      );\n    },\n    NoEntryPlaying(action: HMSAction, description: string) {\n      return new HMSException(\n        ErrorCodes.PlaylistErrors.NO_ENTRY_IS_PLAYING,\n        'NoEntryIsPlaying',\n        action,\n        'No entry is playing at this time',\n        description,\n      );\n    },\n  },\n};\n", "import HMSLogger from './logger';\nimport { isBrowser } from './support';\nimport { ErrorFactory } from '../error/ErrorFactory';\n\nclass LocalStorage {\n  valuesMap = new Map();\n  getItem(key: string) {\n    if (this.valuesMap.has(key)) {\n      return String(this.valuesMap.get(key));\n    }\n    return null;\n  }\n\n  setItem(key: string, val: string) {\n    this.valuesMap.set(key, val);\n  }\n\n  removeItem(key: string) {\n    this.valuesMap.delete(key);\n  }\n\n  clear() {\n    this.valuesMap.clear();\n  }\n\n  key(i: number) {\n    if (arguments.length === 0) {\n      throw new TypeError(\"Failed to execute 'key' on 'Storage': 1 argument required, but only 0 present.\"); // this is a TypeError implemented on Chrome, Firefox throws Not enough arguments to Storage.key.\n    }\n    const arr = Array.from(this.valuesMap.keys());\n    return arr[i];\n  }\n\n  get length() {\n    return this.valuesMap.size;\n  }\n}\n\nexport const initializeLocalstoragePolyfill = () => {\n  try {\n    if (isBrowser && !localStorage) {\n      window.localStorage = new LocalStorage();\n    }\n  } catch (e) {\n    HMSLogger.e('Error initialising localStorage', ErrorFactory.GenericErrors.LocalStorageAccessDenied());\n  }\n};\n", "import { initializeLocalstoragePolyfill } from './local-storage-polyfill';\nimport HMSLogger from './logger';\nimport { isBrowser } from './support';\nimport { ErrorFactory } from '../error/ErrorFactory';\n\nexport class LocalStorage<T> {\n  private storage: Storage | null = null;\n\n  constructor(public readonly key: string) {}\n\n  /**\n   * localstorage is not available in SSR, so get it only at time of use\n   */\n  getStorage() {\n    try {\n      if (isBrowser && !this.storage) {\n        initializeLocalstoragePolyfill();\n        this.storage = window.localStorage;\n      }\n      return this.storage;\n    } catch (e) {\n      HMSLogger.e('Error initialising localStorage', ErrorFactory.GenericErrors.LocalStorageAccessDenied());\n      return null;\n    }\n  }\n\n  get(): T | undefined {\n    const stringItem = this.getStorage()?.getItem(this.key);\n    if (!stringItem) {\n      return;\n    }\n    const item = JSON.parse(stringItem) as T;\n    return item;\n  }\n\n  set(value: T) {\n    const stringValue = JSON.stringify(value);\n    this.getStorage()?.setItem(this.key, stringValue);\n  }\n\n  clear() {\n    this.getStorage()?.removeItem(this.key);\n  }\n}\n", "import HMSLogger from './logger';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { Store } from '../sdk/store';\n\nconst TAG = `[VALIDATIONS]`;\n\n/**\n * Check only for presence(not truthy) of a value.\n * Use in places where 0, false need to be considered valid.\n */\nexport function isPresent(value: any) {\n  return value !== undefined && value !== null;\n}\n\n/**\n * checks if RTCPeerConnection constructor is available\n */\nexport const validateRTCPeerConnection = () => {\n  if (!isPresent(RTCPeerConnection)) {\n    const error = ErrorFactory.GenericErrors.MissingRTCPeerConnection();\n    HMSLogger.e(TAG, error);\n    throw error;\n  }\n};\n\n/**\n * navigator.mediaDevices is undefined in insecure contexts served over HTTP protocol\n */\nexport const validateMediaDevicesExistence = () => {\n  if (!isPresent(navigator.mediaDevices)) {\n    const error = ErrorFactory.GenericErrors.MissingMediaDevices();\n    HMSLogger.e(TAG, error);\n    throw error;\n  }\n};\n\nexport const validatePublishParams = (store: Store) => {\n  const publishParams = store.getPublishParams();\n  if (!publishParams) {\n    throw ErrorFactory.GenericErrors.NotConnected(\n      HMSAction.VALIDATION,\n      'call addTrack after preview or join is successful',\n    );\n  }\n};\n", "import { ENV, isNode, parsedUserAgent } from './support';\nimport { isPresent } from './validations';\nimport { DomainCategory } from '../analytics/AnalyticsEventDomains';\nimport { domainCategory } from '../analytics/domain-analytics';\nimport { HMSFrameworkInfo } from '../interfaces';\n\nconst sdk_version = require('../../package.json').version;\n\ntype UserAgent = {\n  os: string;\n  os_version: string;\n  sdk: 'web';\n  sdk_version: string;\n  env: 'debug' | 'prod';\n  domain: DomainCategory;\n  is_prebuilt: boolean;\n  device_model?: string;\n  framework?: HMSFrameworkInfo['type'] | 'node';\n  framework_version?: HMSFrameworkInfo['version'];\n  framework_sdk_version?: HMSFrameworkInfo['sdkVersion'];\n};\n\nexport function createUserAgent(sdkEnv: ENV = ENV.PROD, frameworkInfo?: HMSFrameworkInfo): string {\n  const sdk = 'web';\n  const env = domainCategory !== DomainCategory.LOCAL && sdkEnv === ENV.PROD ? 'prod' : 'debug';\n\n  if (isNode) {\n    return convertObjectToString({\n      os: 'web_nodejs',\n      os_version: process.version,\n      sdk,\n      sdk_version,\n      env,\n      domain: domainCategory,\n      is_prebuilt: !!frameworkInfo?.isPrebuilt,\n      framework: 'node',\n      framework_version: process.version,\n      framework_sdk_version: frameworkInfo?.sdkVersion,\n    });\n  }\n\n  const parsedOs = parsedUserAgent.getOS();\n  const parsedDevice = parsedUserAgent.getDevice();\n  const parsedBrowser = parsedUserAgent.getBrowser();\n\n  const os = replaceSpaces(`web_${parsedOs.name}`);\n  const os_version = parsedOs.version || '';\n\n  const browser = replaceSpaces(`${parsedBrowser.name}_${parsedBrowser.version}`);\n  let device_model = browser;\n  if (parsedDevice.type) {\n    const deviceVendor = replaceSpaces(`${parsedDevice.vendor}_${parsedDevice.type}`);\n    device_model = `${deviceVendor}/${browser}`;\n  }\n\n  return convertObjectToString({\n    os,\n    os_version,\n    sdk,\n    sdk_version,\n    device_model,\n    env,\n    domain: domainCategory,\n    is_prebuilt: !!frameworkInfo?.isPrebuilt,\n    framework: frameworkInfo?.type,\n    framework_version: frameworkInfo?.version,\n    framework_sdk_version: frameworkInfo?.sdkVersion,\n  });\n}\n\nfunction replaceSpaces(s: string) {\n  return s.replace(/ /g, '_');\n}\n\nconst convertObjectToString = (object: UserAgent, delimiter = ',') =>\n  Object.keys(object)\n    .filter(key => isPresent(object[key as keyof UserAgent]))\n    .map(key => `${key}:${object[key as keyof UserAgent]}`)\n    .join(delimiter);\n", "import { PublishAnalyticPayload, SubscribeAnalyticPayload } from './stats/interfaces';\nimport { AdditionalAnalyticsProperties } from './AdditionalAnalyticsProperties';\nimport AnalyticsEvent from './AnalyticsEvent';\nimport { AnalyticsEventLevel } from './AnalyticsEventLevel';\nimport { IAnalyticsPropertiesProvider } from './IAnalyticsPropertiesProvider';\nimport { HMSException } from '../error/HMSException';\nimport { DeviceMap, SelectedDevices } from '../interfaces';\nimport { HMSTrackSettings } from '../media/settings/HMSTrackSettings';\nimport { HMSRemoteVideoTrack } from '../media/tracks/HMSRemoteVideoTrack';\n\nexport default class AnalyticsEventFactory {\n  private static KEY_REQUESTED_AT = 'requested_at';\n  private static KEY_RESPONDED_AT = 'responded_at';\n\n  static connect(\n    error?: Error,\n    additionalProperties?: AdditionalAnalyticsProperties,\n    requestedAt: Date = new Date(),\n    respondedAt: Date = new Date(),\n    endpoint?: string,\n  ) {\n    const name = this.eventNameFor('connect', error === undefined);\n    const level = error ? AnalyticsEventLevel.ERROR : AnalyticsEventLevel.INFO;\n\n    const properties = this.getPropertiesWithError(\n      {\n        ...additionalProperties,\n        [this.KEY_REQUESTED_AT]: requestedAt?.getTime(),\n        [this.KEY_RESPONDED_AT]: respondedAt?.getTime(),\n        endpoint,\n      },\n      error,\n    );\n\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static disconnect(error?: Error, additionalProperties?: AdditionalAnalyticsProperties) {\n    const name = 'disconnected';\n    const level = error ? AnalyticsEventLevel.ERROR : AnalyticsEventLevel.INFO;\n    const properties = this.getPropertiesWithError(additionalProperties, error);\n\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static preview({\n    error,\n    ...props\n  }: {\n    error?: Error;\n    time?: number;\n    init_response_time?: number;\n    ws_connect_time?: number;\n    on_policy_change_time?: number;\n    local_audio_track_time?: number;\n    local_video_track_time?: number;\n  }) {\n    const name = this.eventNameFor('preview', error === undefined);\n    const level = error ? AnalyticsEventLevel.ERROR : AnalyticsEventLevel.INFO;\n    const properties = this.getPropertiesWithError(props, error);\n\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static join({\n    error,\n    ...props\n  }: {\n    error?: Error;\n    is_preview_called?: boolean;\n    start?: Date;\n    end?: Date;\n    time?: number;\n    init_response_time?: number;\n    ws_connect_time?: number;\n    on_policy_change_time?: number;\n    local_audio_track_time?: number;\n    local_video_track_time?: number;\n    retries_join?: number;\n  }) {\n    const name = this.eventNameFor('join', error === undefined);\n    const level = error ? AnalyticsEventLevel.ERROR : AnalyticsEventLevel.INFO;\n\n    const properties = this.getPropertiesWithError({ ...props, is_preview_called: !!props.is_preview_called }, error);\n\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static publish({ devices, settings, error }: { devices?: DeviceMap; settings?: HMSTrackSettings; error?: Error }) {\n    const name = this.eventNameFor('publish', error === undefined);\n    const level = error ? AnalyticsEventLevel.ERROR : AnalyticsEventLevel.INFO;\n    const properties = this.getPropertiesWithError(\n      {\n        devices,\n        audio: settings?.audio,\n        video: settings?.video,\n      },\n      error,\n    );\n    return new AnalyticsEvent({\n      name,\n      level,\n      properties,\n    });\n  }\n\n  static hlsPlayerError(error: HMSException) {\n    return new AnalyticsEvent({\n      name: 'hlsPlayerError',\n      level: AnalyticsEventLevel.ERROR,\n      properties: this.getErrorProperties(error),\n    });\n  }\n  static subscribeFail(error: Error) {\n    const name = this.eventNameFor('subscribe', false);\n    const level = AnalyticsEventLevel.ERROR;\n    const properties = this.getErrorProperties(error);\n\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static leave() {\n    return new AnalyticsEvent({ name: 'leave', level: AnalyticsEventLevel.INFO });\n  }\n\n  static autoplayError() {\n    return new AnalyticsEvent({ name: 'autoplayError', level: AnalyticsEventLevel.ERROR });\n  }\n\n  static audioPlaybackError(error: HMSException) {\n    return new AnalyticsEvent({\n      name: 'audioPlaybackError',\n      level: AnalyticsEventLevel.ERROR,\n      properties: this.getErrorProperties(error),\n    });\n  }\n\n  static deviceChange({\n    isUserSelection,\n    selection,\n    type,\n    devices,\n    error,\n  }: {\n    isUserSelection?: boolean;\n    selection: Partial<SelectedDevices>;\n    type?: 'change' | 'list' | 'audioInput' | 'audioOutput' | 'video';\n    devices: DeviceMap;\n    error?: Error;\n  }) {\n    const name = this.eventNameFor(error ? 'publish' : `device.${type}`, error === undefined);\n    const level = error ? AnalyticsEventLevel.ERROR : AnalyticsEventLevel.INFO;\n    const properties = this.getPropertiesWithError({ selection, devices, isUserSelection }, error);\n    return new AnalyticsEvent({\n      name,\n      level,\n      properties,\n    });\n  }\n\n  static performance(stats: IAnalyticsPropertiesProvider) {\n    const name = 'perf.stats';\n    const level = AnalyticsEventLevel.INFO;\n    const properties = stats.toAnalyticsProperties();\n\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static rtcStats(stats: IAnalyticsPropertiesProvider) {\n    const name = 'rtc.stats';\n    const level = AnalyticsEventLevel.INFO;\n    const properties = stats.toAnalyticsProperties();\n\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static rtcStatsFailed(error: HMSException) {\n    const name = 'rtc.stats.failed';\n    const level = AnalyticsEventLevel.ERROR;\n\n    return new AnalyticsEvent({ name, level, properties: this.getErrorProperties(error) });\n  }\n\n  /**\n   * TODO: remove once everything is switched to server side degradation, this\n   * event can be handled on server side as well.\n   */\n  static degradationStats(track: HMSRemoteVideoTrack, isDegraded: boolean) {\n    const name = 'video.degradation.stats';\n    const level = AnalyticsEventLevel.INFO;\n    let properties: any = {\n      degradedAt: track.degradedAt,\n      trackId: track.trackId,\n    };\n\n    if (!isDegraded && track.degradedAt instanceof Date) {\n      // not degraded => restored\n      const restoredAt = new Date();\n      const duration = restoredAt.valueOf() - track.degradedAt.valueOf();\n      properties = { ...properties, duration, restoredAt };\n    }\n\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static audioDetectionFail(error: Error, device?: MediaDeviceInfo): AnalyticsEvent {\n    const properties = this.getPropertiesWithError({ device }, error);\n    const level = AnalyticsEventLevel.ERROR;\n    const name = 'audiopresence.failed';\n\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static previewNetworkQuality(properties: { downLink?: string; score?: number; error?: string }) {\n    return new AnalyticsEvent({\n      name: 'perf.networkquality.preview',\n      level: properties.error ? AnalyticsEventLevel.ERROR : AnalyticsEventLevel.INFO,\n      properties,\n    });\n  }\n\n  static publishStats(properties: PublishAnalyticPayload) {\n    return new AnalyticsEvent({\n      name: 'publisher.stats',\n      level: AnalyticsEventLevel.INFO,\n      properties,\n    });\n  }\n\n  static subscribeStats(properties: SubscribeAnalyticPayload) {\n    return new AnalyticsEvent({\n      name: 'subscriber.stats',\n      level: AnalyticsEventLevel.INFO,\n      properties,\n    });\n  }\n\n  static getKrispUsage(duration: number) {\n    return new AnalyticsEvent({\n      name: 'krisp.usage',\n      level: AnalyticsEventLevel.INFO,\n      properties: { duration },\n    });\n  }\n\n  static krispStart() {\n    return new AnalyticsEvent({\n      name: 'krisp.start',\n      level: AnalyticsEventLevel.INFO,\n    });\n  }\n\n  static krispStop() {\n    return new AnalyticsEvent({\n      name: 'krisp.stop',\n      level: AnalyticsEventLevel.INFO,\n    });\n  }\n\n  static interruption({\n    started,\n    type,\n    reason,\n    deviceInfo,\n  }: {\n    started: boolean;\n    type: string;\n    reason: string;\n    deviceInfo: Partial<MediaDeviceInfo>;\n  }) {\n    return new AnalyticsEvent({\n      name: `${started ? 'interruption.start' : 'interruption.stop'}`,\n      level: AnalyticsEventLevel.INFO,\n      properties: {\n        reason,\n        type,\n        ...deviceInfo,\n      },\n    });\n  }\n\n  private static eventNameFor(name: string, ok: boolean) {\n    const suffix = ok ? 'success' : 'failed';\n    return `${name}.${suffix}`;\n  }\n\n  private static getPropertiesWithError(initialProperties: any, error?: Error) {\n    const errorProperties = this.getErrorProperties(error);\n    initialProperties = { ...errorProperties, ...initialProperties };\n    return initialProperties;\n  }\n\n  private static getErrorProperties(error?: Error): Record<string, any> {\n    if (error) {\n      return error instanceof HMSException\n        ? error.toAnalyticsProperties()\n        : {\n            error_name: error.name,\n            error_message: error.message,\n            error_description: error.cause,\n          };\n    } else {\n      return {};\n    }\n  }\n}\n", "export const stringifyMediaStreamTrack = (track: MediaStreamTrack) => {\n  if (!track) {\n    return '';\n  }\n  return `{\n    trackId: ${track.id};\n    kind: ${track.kind};\n    enabled: ${track.enabled};\n    muted: ${track.muted};\n    readyState: ${track.readyState};\n  }`;\n};\n", "import { HMSTrackType } from './HMSTrackType';\nimport AnalyticsEventFactory from '../../analytics/AnalyticsEventFactory';\nimport { stringifyMediaStreamTrack } from '../../utils/json';\nimport HMSLogger from '../../utils/logger';\nimport { HMSMediaStream } from '../streams';\n\nexport type HMSTrackSource = 'regular' | 'screen' | 'plugin' | 'audioplaylist' | 'videoplaylist' | string;\n\nexport abstract class HMSTrack {\n  /**\n   * @internal\n   */\n  readonly stream: HMSMediaStream;\n  source?: HMSTrackSource;\n  peerId?: string;\n  transceiver?: RTCRtpTransceiver;\n\n  /**\n   * @internal to print as a helpful identifier alongside logs\n   */\n  logIdentifier = '';\n\n  /** The native mediastream track, for local, this changes on mute/unmute(for video),\n   * and on device change.\n   * @internal */\n  nativeTrack: MediaStreamTrack;\n\n  /**\n   * Firefox doesn't respect the track id as sent from the backend when calling peerconnection.ontrack callback. This\n   * breaks correlation of future track updates from backend. So we're storing the sdp track id as present in the\n   * original offer along with the track as well and will let this override the native track id for any correlation\n   * purpose.\n   * This applies for remote tracks only.\n   * @internal */\n  private sdpTrackId?: string;\n\n  /**\n   * @internal\n   * The local track id is changed on mute/unmute or when device id changes, this is abstracted as an internal\n   * detail of HMSTrack and the variable is used for this enacapsulation where the first track id is remembered\n   * and treated as the fixed track id for this HMSTrack. This simplifies things for the user of the sdk who\n   * do not have to worry about changing track IDs.\n   * This applies for local tracks only.\n   */\n  private firstTrackId?: string;\n\n  abstract readonly type: HMSTrackType;\n\n  public get enabled(): boolean {\n    return this.nativeTrack.enabled;\n  }\n\n  /**\n   * firstTrackId => encapsulates change in local track ids\n   * sdpTrackId => fixes remote track updates correlation on firefox\n   */\n  public get trackId(): string {\n    return this.firstTrackId || this.sdpTrackId || this.nativeTrack.id;\n  }\n\n  getMediaTrackSettings(): MediaTrackSettings {\n    return this.nativeTrack.getSettings();\n  }\n\n  async setEnabled(value: boolean): Promise<void> {\n    this.nativeTrack.enabled = value;\n  }\n\n  protected constructor(stream: HMSMediaStream, track: MediaStreamTrack, source?: HMSTrackSource) {\n    this.stream = stream;\n    this.nativeTrack = track;\n    this.source = source;\n  }\n\n  /**\n   * @internal\n   */\n  setSdpTrackId(sdpTrackId: string) {\n    this.sdpTrackId = sdpTrackId;\n  }\n\n  /**\n   * @internal\n   */\n  protected setFirstTrackId(trackId: string) {\n    this.firstTrackId = trackId;\n  }\n  /**\n   * @internal\n   * It will send event to analytics when interruption start/stop\n   */\n  sendInterruptionEvent({ started, reason }: { started: boolean; reason: string }) {\n    return AnalyticsEventFactory.interruption({\n      started,\n      type: this.type,\n      reason,\n      deviceInfo: {\n        deviceId: this.nativeTrack.getSettings().deviceId,\n        groupId: this.nativeTrack.getSettings().groupId,\n      },\n    });\n  }\n  /**\n   * @internal\n   * take care of -\n   * 1. https://bugs.chromium.org/p/chromium/issues/detail?id=1232649\n   * 2. stopping any tracks\n   * 3. plugins related cleanups and stopping\n   */\n  cleanup() {\n    HMSLogger.d('[HMSTrack]', 'Stopping track', this.toString());\n    this.nativeTrack?.stop();\n  }\n\n  toString() {\n    return `{\n      streamId: ${this.stream.id};\n      peerId: ${this.peerId};\n      trackId: ${this.trackId};\n      mid: ${this.transceiver?.mid || '-'};\n      logIdentifier: ${this.logIdentifier};\n      source: ${this.source};\n      enabled: ${this.enabled};\n      nativeTrack: ${stringifyMediaStreamTrack(this.nativeTrack)};\n    }`;\n  }\n}\n", "import { HMSTrack, HMSTrackSource } from './HMSTrack';\nimport { HMSTrackType } from './HMSTrackType';\nimport HMSLogger from '../../utils/logger';\nimport { isFirefox } from '../../utils/support';\nimport { HMSMediaStream, HMSRemoteStream } from '../streams';\n\nexport class HMSAudioTrack extends HMSTrack {\n  readonly type: HMSTrackType = HMSTrackType.AUDIO;\n  private audioElement: HTMLAudioElement | null = null;\n  private outputDevice?: MediaDeviceInfo;\n\n  constructor(stream: HMSMediaStream, track: MediaStreamTrack, source?: string) {\n    super(stream, track, source as HMSTrackSource);\n    if (track.kind !== 'audio') {\n      throw new Error(\"Expected 'track' kind = 'audio'\");\n    }\n  }\n\n  getVolume() {\n    // floor is required because of floating-point precision. e.g 0.55*100 gives 55.00000000000001\n    return this.audioElement ? Math.floor(this.audioElement.volume * 100) : null;\n  }\n\n  async setVolume(value: number) {\n    if (value < 0 || value > 100) {\n      throw Error('Please pass a valid number between 0-100');\n    }\n    // Don't subscribe to audio when volume is 0\n    await this.subscribeToAudio(value === 0 ? false : this.enabled);\n    if (this.audioElement) {\n      this.audioElement.volume = value / 100;\n    }\n  }\n\n  setAudioElement(element: HTMLAudioElement | null) {\n    HMSLogger.d('[HMSAudioTrack]', this.logIdentifier, 'adding audio element', `${this}`, element);\n    this.audioElement = element;\n  }\n\n  /**\n   * @internal\n   * @returns {HTMLAudioElement | null}\n   */\n  getAudioElement(): HTMLAudioElement | null {\n    return this.audioElement;\n  }\n\n  getOutputDevice() {\n    return this.outputDevice;\n  }\n\n  cleanup() {\n    super.cleanup();\n    if (this.audioElement) {\n      this.audioElement.srcObject = null;\n      this.audioElement.remove();\n      this.audioElement = null;\n    }\n  }\n\n  async setOutputDevice(device?: MediaDeviceInfo) {\n    if (!device) {\n      HMSLogger.d('[HMSAudioTrack]', this.logIdentifier, 'device is null', `${this}`);\n      return;\n    }\n    if (!this.audioElement) {\n      HMSLogger.d('[HMSAudioTrack]', this.logIdentifier, 'no audio element to set output', `${this}`);\n      this.outputDevice = device;\n      return;\n    }\n    try {\n      // @ts-ignore\n      if (typeof this.audioElement.setSinkId === 'function') {\n        if (isFirefox) {\n          // using setSinkId in firefox disables echo cancellation (introduced in Firefox 116)\n          // todo: GoogleMeet doesn't set sinkId for all 3 audio elements, how do they redirect audio then?\n          //\n          // refer: https://100ms.atlassian.net/browse/LIVE-1992\n          // refer: https://bugzilla.mozilla.org/show_bug.cgi?id=1849108\n          // refer: https://bugzilla.mozilla.org/show_bug.cgi?id=1848283\n          // refer: https://github.com/aws/amazon-chime-sdk-js/issues/2742\n        } else {\n          // @ts-ignore\n          await this.audioElement?.setSinkId(device.deviceId);\n        }\n\n        this.outputDevice = device;\n      }\n    } catch (error) {\n      HMSLogger.d('[HMSAudioTrack]', 'error in setSinkId', error);\n    }\n  }\n\n  protected async subscribeToAudio(value: boolean) {\n    if (this.stream instanceof HMSRemoteStream) {\n      await this.stream.setAudio(value, this.trackId, this.logIdentifier);\n    }\n  }\n}\n", "import isEqual from 'lodash.isequal';\nimport { HMSAudioTrack } from './HMSAudioTrack';\nimport AnalyticsEventFactory from '../../analytics/AnalyticsEventFactory';\nimport { DeviceStorageManager } from '../../device-manager/DeviceStorage';\nimport { HMSException } from '../../error/HMSException';\nimport { EventBus } from '../../events/EventBus';\nimport { HMSAudioTrackSettings as IHMSAudioTrackSettings } from '../../interfaces';\nimport { HMSAudioPlugin, HMSPluginSupportResult } from '../../plugins';\nimport { HMSAudioPluginsManager } from '../../plugins/audio';\nimport Room from '../../sdk/models/HMSRoom';\nimport HMSLogger from '../../utils/logger';\nimport { getAudioTrack, isEmptyTrack } from '../../utils/track';\nimport { TrackAudioLevelMonitor } from '../../utils/track-audio-level-monitor';\nimport { HMSAudioTrackSettings, HMSAudioTrackSettingsBuilder } from '../settings';\nimport { HMSLocalStream } from '../streams';\n\nfunction generateHasPropertyChanged(newSettings: Partial<HMSAudioTrackSettings>, oldSettings: HMSAudioTrackSettings) {\n  return function hasChanged(prop: 'codec' | 'volume' | 'maxBitrate' | 'deviceId' | 'advanced' | 'audioMode') {\n    return !isEqual(newSettings[prop], oldSettings[prop]);\n  };\n}\n\nexport class HMSLocalAudioTrack extends HMSAudioTrack {\n  private readonly TAG = '[HMSLocalAudioTrack]';\n  settings: HMSAudioTrackSettings;\n  private pluginsManager: HMSAudioPluginsManager;\n  private processedTrack?: MediaStreamTrack;\n  private manuallySelectedDeviceId?: string;\n  /**\n   * This is to keep track of all the tracks created so far and stop and clear them when creating new tracks to release microphone\n   * This is needed because when replaceTrackWith is called before updating native track, there is no way that track is available\n   * for you to stop, which leads to the microphone not released even after leave is called.\n   */\n  private tracksCreated = new Set<MediaStreamTrack>();\n\n  audioLevelMonitor?: TrackAudioLevelMonitor;\n\n  /**\n   * see the doc in HMSLocalVideoTrack\n   * @internal\n   */\n  publishedTrackId?: string;\n\n  /**\n   * will be false for preview tracks\n   */\n  isPublished = false;\n\n  constructor(\n    stream: HMSLocalStream,\n    track: MediaStreamTrack,\n    source: string,\n    private eventBus: EventBus,\n    settings: HMSAudioTrackSettings = new HMSAudioTrackSettingsBuilder().build(),\n    private room?: Room,\n  ) {\n    super(stream, track, source);\n    stream.tracks.push(this);\n\n    this.settings = settings;\n    // Replace the 'default' or invalid deviceId with the actual deviceId\n    // This is to maintain consistency with selected devices as in some cases there will be no 'default' device\n    if (settings.deviceId !== track.getSettings().deviceId && !isEmptyTrack(track)) {\n      this.settings = this.buildNewSettings({ deviceId: track.getSettings().deviceId });\n    }\n    this.pluginsManager = new HMSAudioPluginsManager(this, eventBus, room);\n    this.setFirstTrackId(track.id);\n    if (source === 'regular') {\n      document.addEventListener('visibilitychange', this.handleVisibilityChange);\n    }\n  }\n\n  clone(stream: HMSLocalStream) {\n    const track = new HMSLocalAudioTrack(\n      stream,\n      this.nativeTrack.clone(),\n      this.source!,\n      this.eventBus,\n      this.settings,\n      this.room,\n    );\n    track.peerId = this.peerId;\n\n    if (this.pluginsManager.pluginsMap.size > 0) {\n      this.pluginsManager.pluginsMap.forEach(value => {\n        track\n          .addPlugin(value)\n          .catch((e: Error) => HMSLogger.e(this.TAG, 'Plugin add failed while migrating', value, e));\n      });\n    }\n    return track;\n  }\n\n  getManuallySelectedDeviceId() {\n    return this.manuallySelectedDeviceId;\n  }\n\n  resetManuallySelectedDeviceId() {\n    this.manuallySelectedDeviceId = undefined;\n  }\n\n  private isTrackNotPublishing = () => {\n    return this.nativeTrack.readyState === 'ended' || this.nativeTrack.muted;\n  };\n\n  private handleVisibilityChange = async () => {\n    // track state is fine do nothing\n    if (!this.isTrackNotPublishing()) {\n      HMSLogger.d(this.TAG, `visibiltiy: ${document.visibilityState}`, `${this}`);\n      return;\n    }\n    if (document.visibilityState === 'hidden') {\n      this.eventBus.analytics.publish(\n        this.sendInterruptionEvent({\n          started: true,\n          reason: 'visibility-change',\n        }),\n      );\n    } else {\n      HMSLogger.d(this.TAG, 'On visibile replacing track as it is not publishing');\n      await this.replaceTrackWith(this.settings);\n      this.eventBus.analytics.publish(\n        this.sendInterruptionEvent({\n          started: false,\n          reason: 'visibility-change',\n        }),\n      );\n    }\n  };\n\n  /**\n   * Replace the new track in stream and update native track\n   * @param track\n   */\n  private async updateTrack(track: MediaStreamTrack) {\n    track.enabled = this.enabled;\n    const localStream = this.stream as HMSLocalStream;\n    await localStream.replaceStreamTrack(this.nativeTrack, track);\n    // change nativeTrack so plugin can start its work\n    this.nativeTrack = track;\n    await this.replaceSenderTrack();\n    const isLevelMonitored = Boolean(this.audioLevelMonitor);\n    isLevelMonitored && this.initAudioLevelMonitor();\n  }\n\n  private async replaceTrackWith(settings: HMSAudioTrackSettings) {\n    const prevTrack = this.nativeTrack;\n    /*\n     * Note: Do not change the order of this.\n     * stop the previous before acquiring the new track otherwise this can lead to\n     * no audio when the above getAudioTrack throws an error. ex: DeviceInUse error\n     */\n    prevTrack?.stop();\n    this.tracksCreated.forEach(track => track.stop());\n    this.tracksCreated.clear();\n    try {\n      const newTrack = await getAudioTrack(settings);\n      this.tracksCreated.add(newTrack);\n      HMSLogger.d(this.TAG, 'replaceTrack, Previous track stopped', prevTrack, 'newTrack', newTrack);\n      await this.updateTrack(newTrack);\n    } catch (e) {\n      // Generate a new track from previous settings so there will be audio because previous track is stopped\n      const newTrack = await getAudioTrack(this.settings);\n      this.tracksCreated.add(newTrack);\n      await this.updateTrack(newTrack);\n      if (this.isPublished) {\n        this.eventBus.analytics.publish(\n          AnalyticsEventFactory.publish({\n            error: e as Error,\n          }),\n        );\n      }\n      throw e;\n    }\n    try {\n      await this.pluginsManager.reprocessPlugins();\n    } catch (e) {\n      this.eventBus.audioPluginFailed.publish(e as HMSException);\n    }\n  }\n\n  async setEnabled(value: boolean) {\n    if (value === this.enabled) {\n      return;\n    }\n\n    // Replace silent empty track with an actual audio track, if enabled.\n    if (value && isEmptyTrack(this.nativeTrack)) {\n      await this.replaceTrackWith(this.settings);\n    }\n    await super.setEnabled(value);\n    if (value) {\n      this.settings = this.buildNewSettings({ deviceId: this.nativeTrack.getSettings().deviceId });\n    }\n    this.eventBus.localAudioEnabled.publish({ enabled: value, track: this });\n  }\n\n  /**\n   * verify if the track id being passed is of this track for correlating server messages like audio level\n   */\n  isPublishedTrackId(trackId: string) {\n    return this.publishedTrackId === trackId;\n  }\n\n  async setSettings(settings: Partial<IHMSAudioTrackSettings>, internal = false) {\n    const newSettings = this.buildNewSettings(settings);\n\n    if (isEmptyTrack(this.nativeTrack)) {\n      // if it is an empty track, cache the settings for when it is unmuted\n      this.settings = newSettings;\n      return;\n    }\n    await this.handleDeviceChange(newSettings, internal);\n    await this.handleSettingsChange(newSettings);\n    this.settings = newSettings;\n  }\n\n  /**\n   * @see HMSAudioPlugin\n   */\n  getPlugins(): string[] {\n    return this.pluginsManager.getPlugins();\n  }\n\n  /**\n   * @see HMSAudioPlugin\n   */\n  async addPlugin(plugin: HMSAudioPlugin): Promise<void> {\n    return this.pluginsManager.addPlugin(plugin);\n  }\n\n  /**\n   * @see HMSAudioPlugin\n   */\n  async removePlugin(plugin: HMSAudioPlugin): Promise<void> {\n    return this.pluginsManager.removePlugin(plugin);\n  }\n\n  /**\n   * @see HMSAudioPlugin\n   */\n  validatePlugin(plugin: HMSAudioPlugin): HMSPluginSupportResult {\n    return this.pluginsManager.validatePlugin(plugin);\n  }\n\n  /**\n   * @internal\n   */\n  async setProcessedTrack(processedTrack?: MediaStreamTrack) {\n    // if all plugins are removed reset everything back to native track\n    if (!processedTrack) {\n      this.processedTrack = undefined;\n    } else if (processedTrack !== this.processedTrack) {\n      this.processedTrack = processedTrack;\n    }\n    await this.replaceSenderTrack();\n  }\n\n  initAudioLevelMonitor() {\n    if (this.audioLevelMonitor) {\n      this.destroyAudioLevelMonitor();\n    }\n    HMSLogger.d(this.TAG, 'Monitor Audio Level for', this, this.getMediaTrackSettings().deviceId);\n    this.audioLevelMonitor = new TrackAudioLevelMonitor(\n      this,\n      this.eventBus.trackAudioLevelUpdate,\n      this.eventBus.localAudioSilence,\n    );\n    this.audioLevelMonitor.start();\n    this.audioLevelMonitor.detectSilence();\n  }\n\n  destroyAudioLevelMonitor() {\n    this.audioLevelMonitor?.stop();\n    this.audioLevelMonitor = undefined;\n  }\n\n  async cleanup() {\n    super.cleanup();\n    await this.pluginsManager.cleanup();\n    await this.pluginsManager.closeContext();\n    this.transceiver = undefined;\n    this.processedTrack?.stop();\n    this.tracksCreated.forEach(track => track.stop());\n    this.tracksCreated.clear();\n    this.isPublished = false;\n    this.destroyAudioLevelMonitor();\n    document.removeEventListener('visibilitychange', this.handleVisibilityChange);\n  }\n\n  /**\n   * @internal\n   * published track id will be different in case there was some processing done using plugins.\n   */\n  getTrackIDBeingSent() {\n    return this.processedTrack ? this.processedTrack.id : this.nativeTrack.id;\n  }\n\n  /**\n   * @internal\n   */\n  getTrackBeingSent() {\n    return this.processedTrack || this.nativeTrack;\n  }\n\n  private replaceSenderTrack = async () => {\n    if (!this.transceiver || this.transceiver.direction !== 'sendonly') {\n      HMSLogger.d(this.TAG, `transceiver for ${this.trackId} not available or not connected yet`);\n      return;\n    }\n    await this.transceiver.sender.replaceTrack(this.processedTrack || this.nativeTrack);\n  };\n\n  private buildNewSettings(settings: Partial<HMSAudioTrackSettings>) {\n    const { volume, codec, maxBitrate, deviceId, advanced, audioMode } = { ...this.settings, ...settings };\n    const newSettings = new HMSAudioTrackSettings(volume, codec, maxBitrate, deviceId, advanced, audioMode);\n    return newSettings;\n  }\n\n  private handleSettingsChange = async (settings: HMSAudioTrackSettings) => {\n    const stream = this.stream as HMSLocalStream;\n    const hasPropertyChanged = generateHasPropertyChanged(settings, this.settings);\n    if ((hasPropertyChanged('maxBitrate') || hasPropertyChanged('audioMode')) && settings.maxBitrate) {\n      await stream.setMaxBitrateAndFramerate(this, settings);\n    }\n\n    if (hasPropertyChanged('advanced') || hasPropertyChanged('audioMode')) {\n      await this.replaceTrackWith(settings);\n    }\n  };\n\n  /**\n   * Replace audio track with new track on device change if enabled\n   * @param settings - AudioSettings Object constructed with new settings\n   * @param internal - whether the change was because of internal sdk call or external client call\n   */\n  private handleDeviceChange = async (settings: HMSAudioTrackSettings, internal = false) => {\n    const hasPropertyChanged = generateHasPropertyChanged(settings, this.settings);\n    if (hasPropertyChanged('deviceId')) {\n      this.manuallySelectedDeviceId = !internal ? settings.deviceId : this.manuallySelectedDeviceId;\n      HMSLogger.d(\n        this.TAG,\n        'device change',\n        'manual selection:',\n        this.manuallySelectedDeviceId,\n        'new device:',\n        settings.deviceId,\n      );\n      await this.replaceTrackWith(settings);\n      const groupId = this.nativeTrack.getSettings().groupId;\n      if (!internal && settings.deviceId) {\n        DeviceStorageManager.updateSelection('audioInput', {\n          deviceId: settings.deviceId,\n          groupId,\n        });\n        this.eventBus.deviceChange.publish({\n          isUserSelection: true,\n          type: 'audioInput',\n          selection: {\n            deviceId: settings.deviceId,\n            groupId: groupId,\n          },\n        });\n      }\n    }\n  };\n}\n", "import { DeviceMap, SelectedDevices } from '../interfaces';\nimport { LocalStorage } from '../utils/local-storage';\nimport HMSLogger from '../utils/logger';\n\ntype DeviceInfo = { deviceId?: string; groupId?: string };\n/**\n * This class is to manage storing and retrieving selected devices\n * from localstorage\n * @internal\n */\nclass DeviceStorage {\n  private storage = new LocalStorage<SelectedDevices>('hms-device-selection');\n  private remember = false;\n  private devices?: DeviceMap;\n  private readonly TAG = '[HMSDeviceStorage]';\n\n  setDevices(devices: DeviceMap) {\n    this.devices = devices;\n  }\n\n  rememberDevices(value: boolean) {\n    this.remember = value;\n  }\n\n  /**\n   * This will update the passed in type value in storage\n   * @param {string} type - One of audioInput | videoInput | audioOutput\n   * @param {DeviceInfo} param\n   * @returns {void}\n   */\n  updateSelection(type: 'audioInput' | 'videoInput' | 'audioOutput', { deviceId, groupId }: DeviceInfo) {\n    if (!this.devices || !this.remember) {\n      return;\n    }\n    const newSelection = this.devices[type].find(device => this.isSame({ deviceId, groupId }, device));\n    if (!newSelection) {\n      HMSLogger.w(this.TAG, `Could not find device with deviceId: ${deviceId}, groupId: ${groupId}`);\n      return;\n    }\n    const selectedDevices = this.storage.get() || {};\n    if (type === 'audioOutput') {\n      selectedDevices[type] = newSelection as MediaDeviceInfo;\n    } else {\n      selectedDevices[type] = newSelection as MediaDeviceInfo;\n    }\n    this.storage.set(selectedDevices);\n  }\n\n  getSelection() {\n    if (!this.remember) {\n      return undefined;\n    }\n    return this.storage.get();\n  }\n\n  cleanup() {\n    this.remember = false;\n    this.devices = undefined;\n  }\n\n  private isSame(current: DeviceInfo, device: DeviceInfo) {\n    // Safari doesn't give groupId from nativeTrack. Check if groupId's match or current groupId is not present\n    return current.deviceId === device.deviceId && (current.groupId === device.groupId || !current.groupId);\n  }\n}\n\nexport const DeviceStorageManager = new DeviceStorage();\n", "/**\n * A plugin implementing this interface can be registered with HMSLocalAudioTrack to transform, process or\n * analyze the local audio track.These can include applications like background noise removal, speech commands, live\n * analysis of audio etc. The below functions are required for the sdk to properly use the plugin, usually\n * the plugin would also be exposing some public functions of its own for the UI to control its working.\n */\n\nexport interface HMSAudioPlugin {\n  /**\n   * This function will be called by the SDK for audio track which the plugin needs to process.\n   * The reason audio context is also part of the interface is that it's recommended to reuse on audio context\n   * instead of creating new for every use - https://developer.mozilla.org/en-US/docs/Web/API/AudioContext\n   */\n  processAudioTrack(ctx: AudioContext, source: AudioNode): Promise<AudioNode>;\n\n  /**\n   * This function will be called before the call to init, it is used to check whether the plugin supports current\n   * OS, browser and audio device or not. An error object will be thrown back to the user if they try to use an unsupported plugin.\n   */\n  checkSupport(ctx?: AudioContext): HMSPluginSupportResult;\n\n  /**\n   * @deprecated. Will be deleted in future updates. Use checkSupport instead.\n   */\n  isSupported(): boolean;\n\n  /**\n   * This function will be called in the beginning for initialization which may include tasks like setting up\n   * variables, loading ML models etc. This can be used by a plugin to ensure it's prepared at the time\n   * processAudio is called.\n   */\n  init(): Promise<void> | void;\n\n  /**\n   * The name is meant to uniquely specify a plugin instance. This will be used to track number of plugins\n   * added to the track, and same name won't be allowed twice.\n   */\n  getName(): string;\n\n  /**\n   This sets the Plugin type @see HMSAudioPluginType, processing will happen\n   based on the type of plugin\n   */\n  getPluginType(): HMSAudioPluginType;\n  /*\n   * the plugin can use this function to dispose off its resources. It'll be called when the plugin instance is\n   * no longer needed at the end.\n   */\n  stop(): void;\n}\n\n/**\n * Specifies the type of the plugin a transforming plugin will get an output audio node to give the resulting\n * transformation. While an analyzing plugin will only be passed the input node.\n * For analyse plugins, you can return the source node passed to plugin.processTrack to not modify anything\n */\nexport enum HMSAudioPluginType {\n  TRANSFORM = 'TRANSFORM',\n  ANALYZE = 'ANALYZE',\n}\n\nexport interface HMSPluginSupportResult {\n  isSupported: boolean;\n  errType?: HMSPluginUnsupportedTypes;\n  errMsg?: string;\n}\n\nexport enum HMSPluginUnsupportedTypes {\n  PLATFORM_NOT_SUPPORTED = 'PLATFORM_NOT_SUPPORTED',\n  DEVICE_NOT_SUPPORTED = 'DEVICE_NOT_SUPPORTED',\n}\n", "import AnalyticsEvent from './AnalyticsEvent';\nimport { AnalyticsEventLevel } from './AnalyticsEventLevel';\nimport { HMSException } from '../error/HMSException';\n\nexport default class MediaPluginsAnalyticsFactory {\n  static failure(pluginName: string, error: HMSException) {\n    const name = 'mediaPlugin.failed';\n    const level = AnalyticsEventLevel.ERROR;\n    const properties = { plugin_name: pluginName, ...error.toAnalyticsProperties() };\n\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static audioPluginFailure(pluginName: string, sampleRate: number, error: HMSException) {\n    const name = 'mediaPlugin.failed';\n    const level = AnalyticsEventLevel.ERROR;\n    const properties = { plugin_name: pluginName, sampleRate: sampleRate, ...error.toAnalyticsProperties() };\n\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static audioPluginStats({\n    pluginName,\n    duration,\n    loadTime,\n    sampleRate,\n  }: {\n    pluginName: string;\n    duration: number;\n    loadTime: number;\n    sampleRate: number;\n  }) {\n    const name = 'mediaPlugin.stats';\n    const level = AnalyticsEventLevel.INFO;\n    const properties = {\n      plugin_name: pluginName,\n      duration: duration,\n      load_time: loadTime,\n      sampleRate: sampleRate,\n    };\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static added(pluginName: string, added_at: number) {\n    const name = 'mediaPlugin.added';\n    const level = AnalyticsEventLevel.INFO;\n    const properties = {\n      plugin_name: pluginName,\n      added_at: added_at,\n    };\n    return new AnalyticsEvent({ name, level, properties });\n  }\n\n  static stats({\n    pluginName,\n    duration,\n    loadTime,\n    avgPreProcessingTime,\n    avgProcessingTime,\n    inputFrameRate,\n    pluginFrameRate,\n  }: {\n    pluginName: string;\n    duration: number;\n    loadTime: number;\n    avgPreProcessingTime?: number;\n    avgProcessingTime?: number;\n    inputFrameRate?: number;\n    pluginFrameRate?: number;\n  }) {\n    const name = 'mediaPlugin.stats';\n    const level = AnalyticsEventLevel.INFO;\n    const properties = {\n      plugin_name: pluginName,\n      duration: duration,\n      load_time: loadTime,\n      avg_preprocessing_time: avgPreProcessingTime,\n      avg_processing_time: avgProcessingTime,\n      input_frame_rate: inputFrameRate,\n      plugin_frame_rate: pluginFrameRate,\n    };\n    return new AnalyticsEvent({ name, level, properties });\n  }\n}\n", "import MediaPluginsAnalyticsFactory from '../../analytics/MediaPluginsAnalyticsFactory';\nimport { ErrorFactory } from '../../error/ErrorFactory';\nimport { HMSAction } from '../../error/HMSAction';\nimport { HMSException } from '../../error/HMSException';\nimport { EventBus } from '../../events/EventBus';\nimport HMSLogger from '../../utils/logger';\n\nexport class AudioPluginsAnalytics {\n  private readonly TAG = '[AudioPluginsAnalytics]';\n  private readonly initTime: Record<string, number>;\n  private readonly addedTimestamps: Record<string, number>;\n  private readonly pluginAdded: Record<string, boolean>;\n  private readonly pluginSampleRate: Record<string, number>;\n\n  constructor(private eventBus: EventBus) {\n    this.initTime = {};\n    this.addedTimestamps = {};\n    this.pluginAdded = {};\n    this.pluginSampleRate = {};\n  }\n\n  added(name: string, sampleRate: number) {\n    this.pluginAdded[name] = true;\n    this.addedTimestamps[name] = Date.now();\n    this.initTime[name] = 0;\n    this.pluginSampleRate[name] = sampleRate;\n    this.eventBus.analytics.publish(MediaPluginsAnalyticsFactory.added(name, this.addedTimestamps[name]));\n  }\n\n  removed(name: string) {\n    //send stats\n    if (this.pluginAdded[name]) {\n      const stats = {\n        pluginName: name,\n        // duration in seconds\n        duration: Math.floor((Date.now() - this.addedTimestamps[name]) / 1000),\n        loadTime: this.initTime[name],\n        sampleRate: this.pluginSampleRate[name],\n      };\n      //send stats\n      this.eventBus.analytics.publish(MediaPluginsAnalyticsFactory.audioPluginStats(stats));\n      //clean the plugin details\n      this.clean(name);\n    }\n  }\n\n  failure(name: string, error: HMSException) {\n    // send failure event\n    if (this.pluginAdded[name]) {\n      this.eventBus.analytics.publish(\n        MediaPluginsAnalyticsFactory.audioPluginFailure(name, this.pluginSampleRate[name], error),\n      );\n      //clean the plugin details\n      this.clean(name);\n    }\n  }\n\n  async initWithTime<T>(name: string, initFn: () => Promise<T>) {\n    if (this.initTime[name]) {\n      HMSLogger.i(this.TAG, `Plugin Already loaded ${name}, time it took: ${this.initTime[name]}`);\n      return;\n    }\n    let time: number | undefined = undefined;\n    try {\n      time = await this.timeInMs(initFn);\n      HMSLogger.i(this.TAG, `Time taken for Plugin ${name} initialization : ${time}`);\n    } catch (e) {\n      //Failed during initialization of plugin(model loading etc...)\n      const err = ErrorFactory.MediaPluginErrors.InitFailed(\n        HMSAction.AUDIO_PLUGINS,\n        `failed during initialization of plugin${(e as Error).message || e}`,\n      );\n      HMSLogger.e(this.TAG, err);\n      this.failure(name, err);\n      throw err;\n    }\n    if (time) {\n      this.initTime[name] = time;\n    }\n  }\n\n  private async timeInMs<T>(fn: () => Promise<T>): Promise<number> {\n    const start = Date.now();\n    await fn();\n    return Math.floor(Date.now() - start);\n  }\n\n  private clean(name: string) {\n    delete this.addedTimestamps[name];\n    delete this.initTime[name];\n    delete this.pluginAdded[name];\n    delete this.pluginSampleRate[name];\n  }\n}\n", "import { AudioPluginsAnalytics } from './AudioPluginsAnalytics';\nimport { HMSAudioPlugin, HMSPluginUnsupportedTypes } from './HMSAudioPlugin'; //HMSAudioPluginType\nimport AnalyticsEventFactory from '../../analytics/AnalyticsEventFactory';\nimport { ErrorFactory } from '../../error/ErrorFactory';\nimport { HMSAction } from '../../error/HMSAction';\nimport { EventBus } from '../../events/EventBus';\nimport { HMSLocalAudioTrack } from '../../media/tracks';\nimport Room from '../../sdk/models/HMSRoom';\nimport HMSLogger from '../../utils/logger';\n\nconst DEFAULT_SAMPLE_RATE = 48000;\n\n//Handling sample rate error in case of firefox\nconst checkBrowserSupport = () => {\n  return navigator.userAgent.indexOf('Firefox') !== -1;\n};\n\n/**\n * This class manages applying different plugins on a local audio track. Plugins which need to modify the audio\n * are called in the order they were added. Plugins which do not need to modify the audio are called\n * with the original input.\n *\n * Concepts -\n * Audio Plugin - A module which can take in input audio, do some processing on it and return an AudioNode\n *\n * For Each Plugin, an AudioNode will be created and the source will be created from local audio track.\n * Each Audio node will be connected in the following order\n * source -> first plugin -> second plugin -> third plugin .. so on\n * @see HMSAudioPlugin\n */\nexport class HMSAudioPluginsManager {\n  private readonly TAG = '[AudioPluginsManager]';\n  private readonly hmsTrack: HMSLocalAudioTrack;\n  // Map maintains the insertion order\n  readonly pluginsMap: Map<string, HMSAudioPlugin>;\n  private audioContext?: AudioContext;\n\n  private sourceNode?: MediaStreamAudioSourceNode;\n  private destinationNode?: MediaStreamAudioDestinationNode;\n  private prevAudioNode?: any;\n  private analytics: AudioPluginsAnalytics;\n  // This will replace the native track in peer connection when plugins are enabled\n  private outputTrack?: MediaStreamTrack;\n  private pluginAddInProgress = false;\n  private room?: Room;\n\n  constructor(track: HMSLocalAudioTrack, private eventBus: EventBus, room?: Room) {\n    this.hmsTrack = track;\n    this.pluginsMap = new Map();\n    this.analytics = new AudioPluginsAnalytics(eventBus);\n    this.createAudioContext();\n    this.room = room;\n  }\n\n  getPlugins(): string[] {\n    return Array.from(this.pluginsMap.keys());\n  }\n\n  async addPlugin(plugin: HMSAudioPlugin) {\n    const name = plugin.getName?.();\n    if (!name) {\n      HMSLogger.w('no name provided by the plugin');\n      return;\n    }\n    if (this.pluginAddInProgress) {\n      const err = ErrorFactory.MediaPluginErrors.AddAlreadyInProgress(\n        HMSAction.AUDIO_PLUGINS,\n        'Add Plugin is already in Progress',\n      );\n      this.analytics.added(name, this.audioContext!.sampleRate);\n      this.analytics.failure(name, err);\n      HMSLogger.w(\"can't add another plugin when previous add is in progress\");\n      throw err;\n    }\n\n    switch (plugin.getName()) {\n      case 'HMSKrispPlugin':\n        if (!this.room?.isNoiseCancellationEnabled) {\n          const errorMessage = 'Krisp Noise Cancellation is not enabled for this room';\n          if (this.pluginsMap.size === 0) {\n            throw Error(errorMessage);\n          } else {\n            HMSLogger.w(this.TAG, errorMessage);\n            return;\n          }\n        }\n        this.eventBus.analytics.publish(AnalyticsEventFactory.krispStart());\n        break;\n\n      default:\n    }\n    this.pluginAddInProgress = true;\n\n    try {\n      await this.addPluginInternal(plugin);\n    } finally {\n      this.pluginAddInProgress = false;\n    }\n  }\n\n  // eslint-disable-next-line complexity\n  private async addPluginInternal(plugin: HMSAudioPlugin) {\n    const name = plugin.getName?.();\n    if (this.pluginsMap.get(name)) {\n      HMSLogger.w(this.TAG, `plugin - ${name} already added.`);\n      return;\n    }\n\n    await this.validateAndThrow(name, plugin);\n    // @ts-ignore\n    plugin.setEventBus?.(this.eventBus);\n\n    try {\n      if (this.pluginsMap.size === 0) {\n        await this.initAudioNodes();\n      } else if (this.prevAudioNode) {\n        // Previous node will be connected to destination. Disconnect that\n        this.prevAudioNode.disconnect();\n      }\n      this.analytics.added(name, this.audioContext!.sampleRate);\n      await this.analytics.initWithTime(name, async () => plugin.init());\n      this.pluginsMap.set(name, plugin);\n      await this.processPlugin(plugin);\n      await this.connectToDestination();\n      await this.updateProcessedTrack();\n    } catch (err) {\n      HMSLogger.e(this.TAG, 'failed to add plugin', err);\n      throw err;\n    }\n  }\n\n  validatePlugin(plugin: HMSAudioPlugin) {\n    return plugin.checkSupport(this.audioContext);\n  }\n\n  async validateAndThrow(name: string, plugin: HMSAudioPlugin) {\n    const result = this.validatePlugin(plugin);\n    if (result.isSupported) {\n      HMSLogger.i(this.TAG, `plugin is supported,- ${plugin.getName()}`);\n    } else {\n      //Needed to re-add in the reprocess case, to send error message in case of failure\n      this.analytics.added(name, this.audioContext!.sampleRate);\n      if (result.errType === HMSPluginUnsupportedTypes.PLATFORM_NOT_SUPPORTED) {\n        const err = ErrorFactory.MediaPluginErrors.PlatformNotSupported(\n          HMSAction.AUDIO_PLUGINS,\n          'platform not supported, see docs',\n        );\n        this.analytics.failure(name, err);\n        await this.cleanup();\n        throw err;\n      } else if (result.errType === HMSPluginUnsupportedTypes.DEVICE_NOT_SUPPORTED) {\n        const err = ErrorFactory.MediaPluginErrors.DeviceNotSupported(\n          HMSAction.AUDIO_PLUGINS,\n          'audio device not supported, see docs',\n        );\n        this.analytics.failure(name, err);\n        await this.cleanup();\n        throw err;\n      }\n    }\n  }\n\n  async removePlugin(plugin: HMSAudioPlugin) {\n    switch (plugin.getName()) {\n      case 'HMSKrispPlugin':\n        this.eventBus.analytics.publish(AnalyticsEventFactory.krispStop());\n        break;\n      default:\n        break;\n    }\n    await this.removePluginInternal(plugin);\n    if (this.pluginsMap.size === 0) {\n      // remove all previous nodes\n      await this.cleanup();\n      HMSLogger.i(this.TAG, `No plugins left, stopping plugins loop`);\n      await this.hmsTrack.setProcessedTrack(undefined);\n    } else {\n      // Reprocess the remaining plugins again because there is no way to connect\n      // the source of the removed plugin to destination of removed plugin\n      await this.reprocessPlugins();\n    }\n  }\n\n  async cleanup() {\n    for (const plugin of this.pluginsMap.values()) {\n      await this.removePluginInternal(plugin);\n    }\n    await this.hmsTrack.setProcessedTrack(undefined);\n    //disconnect nodes, stop track\n    this.sourceNode?.disconnect();\n    this.prevAudioNode?.disconnect();\n    this.outputTrack?.stop();\n\n    // reset all variables\n    this.sourceNode = undefined;\n    this.destinationNode = undefined;\n    this.prevAudioNode = undefined;\n    this.outputTrack = undefined;\n  }\n\n  //Keeping it separate since we are initializing context only once\n  async closeContext() {\n    this.audioContext?.close();\n    this.audioContext = undefined;\n  }\n\n  async reprocessPlugins() {\n    if (this.pluginsMap.size === 0 || !this.sourceNode) {\n      return;\n    }\n    const plugins = Array.from(this.pluginsMap.values()); // make a copy of plugins\n    await this.cleanup();\n    await this.initAudioNodes();\n    for (const plugin of plugins) {\n      await this.addPlugin(plugin);\n    }\n    this.updateProcessedTrack();\n  }\n\n  private async initAudioNodes() {\n    if (this.audioContext) {\n      if (!this.sourceNode) {\n        const audioStream = new MediaStream([this.hmsTrack.nativeTrack]);\n        this.sourceNode = this.audioContext.createMediaStreamSource(audioStream);\n      }\n      if (!this.destinationNode) {\n        this.destinationNode = this.audioContext.createMediaStreamDestination();\n        this.outputTrack = this.destinationNode.stream.getAudioTracks()[0];\n      }\n    }\n  }\n\n  private async updateProcessedTrack() {\n    try {\n      await this.hmsTrack.setProcessedTrack(this.outputTrack);\n    } catch (err) {\n      HMSLogger.e(this.TAG, 'error in setting processed track', err);\n      throw err;\n    }\n  }\n\n  private async processPlugin(plugin: HMSAudioPlugin) {\n    try {\n      const currentNode = await plugin.processAudioTrack(\n        this.audioContext!, // it is always present at this point\n        this.prevAudioNode || this.sourceNode,\n      );\n      if (this.prevAudioNode) {\n        // if previous node was present while adding this plugin\n        // it is disconnected from destination, connect the previous node to\n        // to the current node\n        this.prevAudioNode.connect(currentNode);\n      }\n      this.prevAudioNode = currentNode;\n    } catch (err) {\n      const name = plugin.getName();\n      //TODO error happened on processing of plugin notify UI\n      HMSLogger.e(this.TAG, `error in processing plugin ${name}`, err);\n      //remove plugin from loop and stop analytics for it\n      await this.removePluginInternal(plugin);\n    }\n  }\n\n  private async connectToDestination() {\n    try {\n      if (this.prevAudioNode && this.destinationNode && this.prevAudioNode.context === this.destinationNode.context) {\n        this.prevAudioNode.connect(this.destinationNode);\n      }\n    } catch (err) {\n      HMSLogger.e(this.TAG, 'error in connecting to destination node', err);\n    }\n  }\n\n  private async removePluginInternal(plugin: HMSAudioPlugin) {\n    const name = plugin.getName?.();\n    if (!this.pluginsMap.get(name)) {\n      HMSLogger.w(this.TAG, `plugin - ${name} not found to remove.`);\n      return;\n    }\n    HMSLogger.i(this.TAG, `removing plugin ${name}`);\n    this.pluginsMap.delete(name);\n    plugin.stop();\n    this.analytics.removed(name);\n  }\n\n  private createAudioContext() {\n    if (!this.audioContext) {\n      if (checkBrowserSupport()) {\n        /**\n        Not setting default sample rate for firefox since connecting\n        audio nodes from context with different sample rate is not\n        supported in firefox\n */\n        this.audioContext = new AudioContext();\n      } else {\n        this.audioContext = new AudioContext({ sampleRate: DEFAULT_SAMPLE_RATE });\n      }\n    }\n  }\n}\n", "import adapter from 'webrtc-adapter';\nimport { ErrorFactory } from './ErrorFactory';\nimport { HMSAction } from './HMSAction';\nimport { HMSException } from './HMSException';\n\nexport enum HMSGetMediaActions {\n  UNKNOWN = 'unknown(video or audio)',\n  AUDIO = 'audio',\n  VIDEO = 'video',\n  AV = 'audio, video',\n  SCREEN = 'screen',\n}\n\nfunction getDefaultError(error: string, deviceInfo: string) {\n  const message = error.toLowerCase();\n  if (message.includes('device not found')) {\n    return ErrorFactory.TracksErrors.DeviceNotAvailable(HMSAction.TRACK, deviceInfo, error);\n  } else if (message.includes('permission denied')) {\n    return ErrorFactory.TracksErrors.CantAccessCaptureDevice(HMSAction.TRACK, deviceInfo, error);\n  } else {\n    return ErrorFactory.TracksErrors.GenericTrack(HMSAction.TRACK, error);\n  }\n}\n\n/**\n * # Edge Cases:\n * - Screenshare error: The problem is when block at OS level, chrome throws NotAllowedError(HMS code - 3001) while firefox throws NotFoundError(HMS code - 3002),\n * we will handle this internally and throw error as User block - 3001 and OS block - 3011 for all browsers.\n * Chrome -\n * User blocked - NotAllowedError - Permission denied\n * System blocked - NotAllowedError - Permission denied by system\n */\n// eslint-disable-next-line complexity\nfunction convertMediaErrorToHMSException(err: Error, deviceInfo = ''): HMSException {\n  /**\n   * Note: Adapter detects all chromium browsers as 'chrome'\n   */\n  const chromeSystemDenied =\n    adapter.browserDetails.browser === 'chrome' &&\n    err.name === 'NotAllowedError' &&\n    err.message.includes('denied by system');\n\n  if (chromeSystemDenied) {\n    return ErrorFactory.TracksErrors.SystemDeniedPermission(HMSAction.TRACK, deviceInfo, err.message);\n  }\n\n  if (adapter.browserDetails.browser === 'firefox' && err.name === 'NotFoundError') {\n    const hmsError = ErrorFactory.TracksErrors.SystemDeniedPermission(HMSAction.TRACK, deviceInfo, err.message);\n    hmsError.description = `Capture device is either blocked at Operating System level or not available - ${deviceInfo}`;\n    return hmsError;\n  }\n\n  switch (err.name) {\n    case 'OverconstrainedError':\n      return ErrorFactory.TracksErrors.OverConstrained(\n        HMSAction.TRACK,\n        deviceInfo,\n        (err as OverconstrainedError).constraint,\n      );\n    case 'NotAllowedError':\n      return ErrorFactory.TracksErrors.CantAccessCaptureDevice(HMSAction.TRACK, deviceInfo, err.message);\n    case 'NotFoundError':\n      return ErrorFactory.TracksErrors.DeviceNotAvailable(HMSAction.TRACK, deviceInfo, err.message);\n    case 'NotReadableError':\n      return ErrorFactory.TracksErrors.DeviceInUse(HMSAction.TRACK, deviceInfo, err.message);\n    case 'TypeError':\n      return ErrorFactory.TracksErrors.NothingToReturn(HMSAction.TRACK, err.message);\n    default:\n      return getDefaultError(err.message, deviceInfo);\n  }\n}\n\nexport function BuildGetMediaError(err: Error, deviceInfo: string): HMSException {\n  const exception = convertMediaErrorToHMSException(err, deviceInfo);\n  exception.addNativeError(err);\n  return exception;\n}\n", "import { BuildGetMediaError, HMSGetMediaActions } from '../error/utils';\nimport { HMSAudioTrackSettings, HMSVideoTrackSettings } from '../media/settings';\n\nexport async function getAudioTrack(settings: HMSAudioTrackSettings): Promise<MediaStreamTrack> {\n  try {\n    const stream = await navigator.mediaDevices.getUserMedia({\n      audio: settings ? settings.toConstraints() : false,\n    });\n    return stream.getAudioTracks()[0];\n  } catch (err) {\n    throw BuildGetMediaError(err as Error, HMSGetMediaActions.AUDIO);\n  }\n}\n\nexport async function getVideoTrack(settings: HMSVideoTrackSettings): Promise<MediaStreamTrack> {\n  try {\n    const stream = await navigator.mediaDevices.getUserMedia({\n      video: settings ? settings.toConstraints() : false,\n    });\n    return stream.getVideoTracks()[0];\n  } catch (err) {\n    throw BuildGetMediaError(err as Error, HMSGetMediaActions.VIDEO);\n  }\n}\n\n// To differentiate between normal track and empty track.\nexport function isEmptyTrack(track: MediaStreamTrack) {\n  // Firefox gives '' as label for empty track(created from audio context)\n  return 'canvas' in track || track.label === 'MediaStreamAudioDestinationNode' || track.label === '';\n}\n", "import HMSLogger from './logger';\nimport { BuildGetMediaError, HMSGetMediaActions } from '../error/utils';\n\nexport async function getLocalStream(constraints: MediaStreamConstraints): Promise<MediaStream> {\n  try {\n    const stream = await navigator.mediaDevices.getUserMedia(constraints);\n    return stream;\n  } catch (err) {\n    throw BuildGetMediaError(err as Error, HMSGetMediaActions.AV);\n  }\n}\n\nexport async function getLocalScreen(constraints: MediaStreamConstraints['video']): Promise<MediaStream> {\n  try {\n    // @ts-ignore [https://github.com/microsoft/TypeScript/issues/33232]\n    const stream = await navigator.mediaDevices.getDisplayMedia({ video: constraints, audio: false });\n    return stream;\n  } catch (err) {\n    throw BuildGetMediaError(err as Error, HMSGetMediaActions.SCREEN);\n  }\n}\n\ninterface MediaDeviceGroups {\n  audioinput: MediaDeviceInfo[];\n  audiooutput: MediaDeviceInfo[];\n  videoinput: MediaDeviceInfo[];\n}\n\nexport async function getLocalDevices(): Promise<MediaDeviceGroups> {\n  try {\n    const devices = await navigator.mediaDevices.enumerateDevices();\n    const deviceGroups: MediaDeviceGroups = {\n      audioinput: [],\n      audiooutput: [],\n      videoinput: [],\n    };\n    devices.forEach(device => deviceGroups[device.kind].push(device));\n    return deviceGroups;\n  } catch (err) {\n    throw BuildGetMediaError(err as Error, HMSGetMediaActions.AV);\n  }\n}\n\nexport interface HMSAudioContext {\n  audioContext: AudioContext | null;\n  getAudioContext: () => AudioContext;\n  resumeContext: () => Promise<void>;\n}\n\nexport const HMSAudioContextHandler: HMSAudioContext = {\n  audioContext: null,\n  getAudioContext() {\n    if (!this.audioContext) {\n      this.audioContext = new AudioContext();\n    }\n    return this.audioContext;\n  },\n  async resumeContext() {\n    try {\n      return await this.getAudioContext().resume();\n    } catch (error) {\n      HMSLogger.e('AudioContext', error);\n    }\n  },\n};\n", "export interface IQueue<T> {\n  size(): number;\n  enqueue(item: T): void;\n  dequeue(): T | undefined;\n}\n\nexport class Queue<T> implements IQueue<T> {\n  protected storage: T[] = [];\n\n  constructor(private capacity: number = Infinity) {}\n\n  size() {\n    return this.storage.length;\n  }\n\n  toList() {\n    return this.storage.slice(0);\n  }\n\n  enqueue(item: T) {\n    if (this.size() === this.capacity) {\n      this.dequeue();\n    }\n    this.storage.push(item);\n  }\n\n  dequeue() {\n    return this.storage.shift();\n  }\n\n  aggregate<R>(aggregationFn: (values: T[]) => R): R {\n    return aggregationFn(this.storage);\n  }\n}\n", "export const worker = `(function workerSetup() {\n  function ticker() {\n    self.postMessage('tick');\n  }\n  self.onmessage = function (event) {\n    const [data, time] = event.data;\n    switch (data) {\n      case 'start':\n        setTimeout(ticker, time);\n        break;\n      default:\n        break;\n    }\n  };\n})()`;\n\n/**\n * Delay for a @see ms amount of time\n * @param ms -- time in milliseconds\n */\nexport function sleep(ms: number): Promise<void> {\n  if (ms < 0) {\n    throw Error('`ms` should be a positive integer');\n  }\n\n  return new Promise(resolve => {\n    setTimeout(resolve, ms);\n  });\n}\n\nexport function workerSleep(ms: number): Promise<void> {\n  if (ms < 0) {\n    throw Error('`ms` should be a positive integer');\n  }\n  if (typeof Worker === 'undefined') {\n    return sleep(ms);\n  }\n  const WorkerThread = new Worker(URL.createObjectURL(new Blob([worker], { type: 'application/javascript' })));\n  WorkerThread.postMessage(['start', ms]);\n  return new Promise(resolve => {\n    WorkerThread.onmessage = event => {\n      if (event.data === 'tick') {\n        resolve();\n        WorkerThread.terminate();\n      }\n    };\n  });\n}\n\nexport function reusableWorker() {\n  if (typeof Worker === 'undefined') {\n    return {\n      sleep: (ms: number) => sleep(ms),\n    };\n  }\n  const WorkerThread = new Worker(URL.createObjectURL(new Blob([worker], { type: 'application/javascript' })));\n  return {\n    sleep: (ms: number) => {\n      WorkerThread.postMessage(['start', ms]);\n      return new Promise<void>(resolve => {\n        WorkerThread.onmessage = event => {\n          if (event.data === 'tick') {\n            resolve();\n          }\n        };\n      });\n    },\n  };\n}\n\n/**\n * Debounce Fn - Function to limit the number of executions of the passed in\n * function in a given time duration\n * @param fn Function to be called\n * @param delay time by which the function execution has to be delayed\n * @returns {void}\n */\nexport function debounce<T extends (...args: any) => any>(fn: T, delay = 300) {\n  let timer: any | undefined;\n  return function (...args: []) {\n    clearTimeout(timer);\n    timer = undefined;\n    //@ts-ignore\n    //eslint-disable-next-line\n    const context = this;\n    timer = setTimeout(() => {\n      fn.apply(context, args);\n    }, delay);\n  };\n}\n", "import HMSLogger from './logger';\nimport { HMSAudioContextHandler } from './media';\nimport { Queue } from './queue';\nimport { sleep } from './timer-utils';\nimport { HMSInternalEvent } from '../events/HMSInternalEvent';\nimport { HMSLocalAudioTrack } from '../internal';\n\n/** Send update only if audio level is above THRESHOLD */\nconst THRESHOLD = 35;\n\n/** Send update only if audio level is changed by UPDATE_THRESHOLD */\nconst UPDATE_THRESHOLD = 5;\n\nexport interface ITrackAudioLevelUpdate {\n  track: HMSLocalAudioTrack;\n  audioLevel: number;\n}\n\n// Audio level algorithm referenced from official MDN example - https://github.com/mdn/dom-examples/tree/main/media/web-dictaphone\nexport class TrackAudioLevelMonitor {\n  private readonly TAG = '[TrackAudioLevelMonitor]';\n  private audioLevel = 0;\n  private analyserNode?: AnalyserNode;\n  private dataArray?: Uint8Array;\n  private isMonitored = false;\n  /** Frequency of polling audio level from track */\n  private interval = 100;\n  /** Store past audio levels for this duration */\n  private historyInterval = 700;\n  private history = new Queue<number>(this.historyInterval / this.interval);\n\n  constructor(\n    private track: HMSLocalAudioTrack,\n    private audioLevelEvent: HMSInternalEvent<ITrackAudioLevelUpdate>,\n    private silenceEvent: HMSInternalEvent<{ track: HMSLocalAudioTrack }>,\n  ) {\n    try {\n      const stream = new MediaStream([this.track.nativeTrack]);\n      this.analyserNode = this.createAnalyserNodeForStream(stream);\n      const bufferLength = this.analyserNode.frequencyBinCount;\n      this.dataArray = new Uint8Array(bufferLength);\n    } catch (ex) {\n      HMSLogger.w(this.TAG, 'Unable to initialize AudioContext', ex);\n    }\n  }\n\n  /**\n   * To detect silence we check if the track is unmuted and silent in the current moment\n   * periodically. If the track is found to be silent more than a threshold number of times\n   * we send the event. The threshold number of time is there to reduce the chance of false\n   * positives.\n   */\n  detectSilence = async () => {\n    const tickInterval = 20;\n    const tickThreshold = 50;\n    let silenceCounter = 0;\n\n    while (this.isMonitored) {\n      if (this.track.enabled) {\n        if (this.isSilentThisInstant()) {\n          silenceCounter++;\n          if (silenceCounter > tickThreshold) {\n            this.silenceEvent.publish({ track: this.track });\n            break;\n          }\n        } else {\n          // bail out immediately if sound is found\n          break;\n        }\n      }\n      await sleep(tickInterval);\n    }\n  };\n\n  start() {\n    this.stop();\n    this.isMonitored = true;\n    HMSLogger.d(this.TAG, 'Starting track Monitor', `${this.track}`);\n    this.loop().then(() => HMSLogger.d(this.TAG, 'Stopping track Monitor', `${this.track}`));\n  }\n\n  stop() {\n    if (!this.analyserNode) {\n      HMSLogger.d(this.TAG, 'AudioContext not initialized');\n      return;\n    }\n\n    this.sendAudioLevel(0);\n    this.isMonitored = false;\n  }\n\n  private async loop() {\n    while (this.isMonitored) {\n      this.sendAudioLevel(this.getMaxAudioLevelOverPeriod());\n      await sleep(this.interval);\n    }\n  }\n\n  private sendAudioLevel(audioLevel = 0) {\n    audioLevel = audioLevel > THRESHOLD ? audioLevel : 0;\n    const isSignificantChange = Math.abs(this.audioLevel - audioLevel) > UPDATE_THRESHOLD;\n    if (isSignificantChange) {\n      this.audioLevel = audioLevel;\n      const audioLevelUpdate: ITrackAudioLevelUpdate = { track: this.track, audioLevel: this.audioLevel };\n      this.audioLevelEvent.publish(audioLevelUpdate);\n    }\n  }\n\n  private getMaxAudioLevelOverPeriod() {\n    if (!this.analyserNode) {\n      HMSLogger.d(this.TAG, 'AudioContext not initialized');\n      return;\n    }\n    const newLevel = this.calculateAudioLevel();\n    newLevel !== undefined && this.history.enqueue(newLevel);\n    return this.history.aggregate(values => Math.max(...values));\n  }\n\n  private calculateAudioLevel() {\n    if (!this.analyserNode || !this.dataArray) {\n      HMSLogger.d(this.TAG, 'AudioContext not initialized');\n      return;\n    }\n\n    this.analyserNode.getByteTimeDomainData(this.dataArray);\n    const lowest = 0.009;\n    let max = lowest;\n    for (const frequency of this.dataArray) {\n      max = Math.max(max, (frequency - 128) / 128);\n    }\n    const normalized = (Math.log(lowest) - Math.log(max)) / Math.log(lowest);\n    const percent = Math.ceil(Math.min(Math.max(normalized * 100, 0), 100));\n    return percent;\n  }\n\n  private isSilentThisInstant() {\n    if (!this.analyserNode || !this.dataArray) {\n      HMSLogger.d(this.TAG, 'AudioContext not initialized');\n      return;\n    }\n\n    this.analyserNode.getByteTimeDomainData(this.dataArray);\n\n    // For absolute silence(in case of mic/software failures), all frequencies are 128 or 0.\n    return this.dataArray.every(frequency => frequency === 128 || frequency === 0);\n  }\n\n  private createAnalyserNodeForStream(stream: MediaStream): AnalyserNode {\n    const audioContext = HMSAudioContextHandler.getAudioContext();\n    const source = audioContext.createMediaStreamSource(stream);\n    const analyser = audioContext.createAnalyser();\n    analyser.fftSize = 2048;\n    source.connect(analyser);\n    return analyser;\n  }\n}\n", "import { HMSAudioTrack, HMSTrack, HMSVideoTrack } from '../../media/tracks';\nimport { HMSRole } from '../role';\n\nexport enum HMSPeerType {\n  SIP = 'sip',\n  REGULAR = 'regular',\n}\n\nexport interface HMSPeer {\n  peerId: string;\n  name: string;\n  isLocal: boolean;\n  joinedAt?: Date;\n  customerUserId?: string;\n  metadata?: string;\n  audioTrack?: HMSAudioTrack;\n  videoTrack?: HMSVideoTrack;\n  auxiliaryTracks: HMSTrack[];\n  role?: HMSRole;\n  networkQuality?: number;\n  groups?: string[];\n  realtime?: boolean;\n  isHandRaised: boolean;\n  type: HMSPeerType;\n\n  updateRole(newRole: HMSRole): void;\n  updateName(newName: string): void;\n  updateMetadata(data: string): void;\n  updateNetworkQuality(value: number): void;\n  updateGroups(groups: string[]): void;\n}\n", "import { ServerError } from './internal';\nimport { HMSException } from '../error/HMSException';\n\nexport enum HMSRecordingState {\n  NONE = 'none',\n  INITIALISED = 'initialised',\n  STARTED = 'started',\n  PAUSED = 'paused',\n  RESUMED = 'resumed',\n  STOPPED = 'stopped',\n  FAILED = 'failed',\n}\n\nexport enum HMSStreamingState {\n  NONE = 'none',\n  INITIALISED = 'initialised',\n  STARTED = 'started',\n  STOPPED = 'stopped',\n  FAILED = 'failed',\n}\n\nexport interface HMSRoom {\n  id: string;\n  name?: string;\n  sessionId?: string;\n  joinedAt?: Date;\n  startedAt?: Date;\n  recording: HMSRecording;\n  rtmp: HMSRTMP;\n  hls: HMSHLS;\n  peerCount?: number;\n  templateId?: string;\n  description?: string;\n  max_size?: number;\n  large_room_optimization?: boolean;\n  isEffectsEnabled?: boolean;\n  isVBEnabled?: boolean;\n  effectsKey?: string;\n  isHipaaEnabled?: boolean;\n  isNoiseCancellationEnabled?: boolean;\n  transcriptions?: HMSTranscriptionInfo[];\n}\n\nexport interface HMSRecording {\n  browser: HMSBrowserRecording;\n  server: HMSSFURecording;\n  hls: HMSHLSRecording;\n}\n\nexport interface HMSBrowserRecording {\n  running: boolean;\n  startedAt?: Date;\n  state?: HMSRecordingState;\n  error?: HMSException;\n}\n\nexport interface HMSSFURecording {\n  running: boolean;\n  startedAt?: Date;\n  state?: HMSRecordingState;\n  error?: HMSException;\n}\n\nexport interface HMSHLSRecording {\n  running: boolean;\n  initialisedAt?: Date;\n  startedAt?: Date;\n  state?: HMSRecordingState;\n  error?: ServerError;\n  /**\n   * if the final output is one file or one file per hls layer\n   */\n  singleFilePerLayer?: boolean;\n  /**\n   * if video on demand needs to be turned on, false by default\n   */\n  hlsVod?: boolean;\n}\n\nexport interface HMSRTMP {\n  running: boolean;\n  /**\n   * @alpha\n   **/\n  startedAt?: Date;\n  state?: HMSStreamingState;\n  error?: HMSException;\n}\n\nexport interface HMSHLS {\n  running: boolean;\n  variants: Array<HLSVariant>;\n  error?: HMSException;\n}\n\nexport enum HLSPlaylistType {\n  DVR = 'dvr',\n  NO_DVR = 'no-dvr',\n}\n\nexport enum HLSStreamType {\n  REGULAR = 'regular',\n  SCREEN = 'screen',\n  COMPOSITE = 'composite',\n}\nexport interface HLSVariant {\n  url: string;\n  playlist_type?: HLSPlaylistType;\n  meetingURL?: string;\n  metadata?: string;\n  startedAt?: Date;\n  initialisedAt?: Date;\n  state?: HMSStreamingState;\n  stream_type?: HLSStreamType;\n}\n\n/*\nTranscription related details\n*/\nexport enum HMSTranscriptionState {\n  INITIALISED = 'initialised',\n  STARTED = 'started',\n  STOPPED = 'stopped',\n  FAILED = 'failed',\n}\nexport enum HMSTranscriptionMode {\n  CAPTION = 'caption',\n}\nexport interface HMSTranscriptionInfo {\n  state?: HMSTranscriptionState;\n  mode?: HMSTranscriptionMode;\n  initialised_at?: Date;\n  started_at?: Date;\n  updated_at?: Date;\n  stopped_at?: Date;\n  error?: HMSException;\n}\n", "export enum HMSSimulcastLayer {\n  NONE = 'none',\n  LOW = 'low',\n  MEDIUM = 'medium',\n  HIGH = 'high',\n}\n\nexport interface SimulcastLayer {\n  rid: string;\n  scaleResolutionDownBy: number;\n  maxBitrate: number;\n  maxFramerate: number;\n}\n\nexport interface SimulcastResolution {\n  width: number;\n  height: number;\n}\n\nexport interface SimulcastLayers {\n  layers?: SimulcastLayer[];\n}\n\nexport type HMSPreferredSimulcastLayer = Exclude<HMSSimulcastLayer, HMSSimulcastLayer.NONE>;\nexport interface HMSSimulcastLayerDefinition {\n  layer: HMSPreferredSimulcastLayer;\n  resolution: SimulcastResolution;\n}\n\nexport type RID = 'f' | 'h' | 'q';\n\nexport const simulcastMapping = {\n  f: HMSSimulcastLayer.HIGH,\n  h: HMSSimulcastLayer.MEDIUM,\n  q: HMSSimulcastLayer.LOW,\n};\n", "export enum HMSVideoCodec {\n  VP8 = 'vp8',\n  VP9 = 'vp9',\n  H264 = 'h264',\n}\n\nexport enum HMSAudioCodec {\n  OPUS = 'opus',\n}\n\n/**\n * Refer https://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/facingMode\n * for more details.\n */\nexport enum HMSFacingMode {\n  USER = 'user',\n  ENVIRONMENT = 'environment',\n  LEFT = 'left',\n  RIGHT = 'right',\n}\n\nexport enum HMSAudioMode {\n  VOICE = 'voice',\n  MUSIC = 'music',\n}\n\nexport interface HMSAudioTrackSettings {\n  volume?: number;\n  codec?: HMSAudioCodec;\n  maxBitrate?: number;\n  deviceId?: string;\n  advanced?: Array<MediaTrackConstraintSet>;\n  audioMode?: HMSAudioMode;\n}\n\nexport interface HMSVideoTrackSettings {\n  width?: number;\n  height?: number;\n  codec?: HMSVideoCodec;\n  maxFramerate?: number;\n  maxBitrate?: number;\n  deviceId?: string;\n  advanced?: Array<MediaTrackConstraintSet>;\n  facingMode?: HMSFacingMode;\n}\n\n/**\n * Config to have control over screenshare being captured. Note that\n * not all fields are supported on all browsers. Even when they're supported\n * the fields acts as hints and the browser can override them.\n */\nexport interface HMSScreenShareConfig {\n  /**\n   * discard the video and only share audio track with others, useful\n   * for sharing music.\n   * @default false\n   */\n  audioOnly?: boolean;\n  /**\n   * do not give an option to share audio while screen sharing.\n   * @default false\n   */\n  videoOnly?: boolean;\n  /**\n   * preselect the relevant tab in screenshare menu\n   * browser - for preferring a browser tab\n   * window - for application window\n   * monitor - for full screen\n   * @default monitor\n   */\n  displaySurface?: 'browser' | 'monitor' | 'window';\n  /**\n   * show the current tab first in supported browser, throws\n   * error if user doesn't select current tab for sharing.\n   * @default false\n   */\n  forceCurrentTab?: boolean;\n  /**\n   * show the current tab first in supported browser, but don't throw error\n   * if user selects something else.\n   * @default false\n   */\n  preferCurrentTab?: boolean;\n  /**\n   * whether to show an option for sharing the current tab in the screen share\n   * prompt. Screen sharing current tab might lead to hall of mirrors effect.\n   * Default is exclude, if either of forceCurrentTab or preferCurrentTab are true,\n   * this is set to include.\n   * @default exclude\n   */\n  selfBrowserSurface?: 'include' | 'exclude';\n  /**\n   * whether to hint browser to show a \"share this tab instead\" option when\n   * tab is shared.\n   * Default is include, set to exclude if forceCurrentTab is true\n   * @default include\n   */\n  surfaceSwitching?: 'include' | 'exclude';\n  /**\n   * whether to show option for sharing system level audio if full screen\n   * is being shared. Not applicable if isVideoOnly is true.\n   * Note that sharing system audio will cause echo if mic is on.\n   * @default exclude\n   */\n  systemAudio?: 'include' | 'exclude';\n  /**\n   * used for region capture in screenshare, if the current tab is being screenshared\n   * the screenshare video track will be cropped to only this element. Will throw\n   * error if the element is not present in DOM.\n   */\n  cropElement?: HTMLDivElement;\n  /**\n   * used for region capture in screenshare, the screenshare video track will be\n   * cropped to only the passed in cropTarget. This cropTarget must come from\n   * the tab which is being shared\n   */\n  cropTarget?: object;\n}\n\nexport interface ScreenCaptureHandle {\n  handle: string;\n  exposeOrigin: boolean;\n}\n\nexport interface ScreenCaptureHandleConfig extends ScreenCaptureHandle {\n  permittedOrigins: string[];\n}\n", "import { HMSException } from '../error/HMSException';\n\nexport interface HMSDeviceChangeEvent {\n  isUserSelection?: boolean;\n  error?: HMSException;\n  devices?: DeviceMap;\n  selection?: Partial<MediaDeviceInfo>;\n  type: 'audioOutput' | 'audioInput' | 'video';\n}\n\nexport enum DeviceType {\n  videoInput = 'videoInput',\n  audioInput = 'audioInput',\n  audioOutput = 'audioOutput',\n}\n\nexport interface DeviceMap {\n  [DeviceType.audioInput]: MediaDeviceInfo[];\n  [DeviceType.audioOutput]: MediaDeviceInfo[];\n  [DeviceType.videoInput]: MediaDeviceInfo[];\n}\n\nexport interface DeviceChangeListener {\n  onDeviceChange?(event: HMSDeviceChangeEvent): void;\n}\n\nexport type SelectedDevices = {\n  [DeviceType.audioInput]?: MediaDeviceInfo;\n  [DeviceType.videoInput]?: MediaDeviceInfo;\n  [DeviceType.audioOutput]?: MediaDeviceInfo;\n};\n", "import { IAnalyticsPropertiesProvider } from '../../analytics/IAnalyticsPropertiesProvider';\nimport { HMSAudioCodec, HMSAudioMode, HMSAudioTrackSettings as IHMSAudioTrackSettings } from '../../interfaces';\n\nexport class HMSAudioTrackSettingsBuilder {\n  private _volume = 1.0;\n  private _codec?: HMSAudioCodec = HMSAudioCodec.OPUS;\n  private _maxBitrate?: number = 32;\n  private _deviceId = 'default';\n  private _audioMode: HMSAudioMode = HMSAudioMode.VOICE;\n  private _advanced: Array<MediaTrackConstraintSet> = [\n    // @ts-ignore\n    { googEchoCancellation: { exact: true } },\n    // @ts-ignore\n    { googExperimentalEchoCancellation: { exact: true } },\n    // @ts-ignore\n    { autoGainControl: { exact: true } },\n    // @ts-ignore\n    { noiseSuppression: { exact: true } },\n    // @ts-ignore\n    { googHighpassFilter: { exact: true } },\n    // @ts-ignore\n    { googAudioMirroring: { exact: true } },\n  ];\n\n  volume(volume: number) {\n    if (!(0.0 <= volume && volume <= 1.0)) {\n      throw Error('volume can only be in range [0.0, 1.0]');\n    }\n    this._volume = volume;\n    return this;\n  }\n\n  codec(codec?: HMSAudioCodec) {\n    this._codec = codec;\n    return this;\n  }\n\n  maxBitrate(maxBitrate?: number) {\n    if (maxBitrate && maxBitrate <= 0) {\n      throw Error('maxBitrate should be >= 1');\n    }\n    this._maxBitrate = this._audioMode === HMSAudioMode.MUSIC ? 320 : maxBitrate;\n    return this;\n  }\n\n  deviceId(deviceId: string) {\n    // TODO: Validate if device-id is OK\n    this._deviceId = deviceId;\n    return this;\n  }\n\n  audioMode(mode: HMSAudioMode = HMSAudioMode.VOICE) {\n    this._audioMode = mode;\n    if (this._audioMode === HMSAudioMode.MUSIC) {\n      this._maxBitrate = 320;\n    } else {\n      this._maxBitrate = 32;\n    }\n    return this;\n  }\n\n  advanced(advanced: Array<MediaTrackConstraintSet>) {\n    this._advanced = advanced;\n    return this;\n  }\n\n  build() {\n    return new HMSAudioTrackSettings(\n      this._volume,\n      this._codec,\n      this._maxBitrate,\n      this._deviceId,\n      this._advanced,\n      this._audioMode,\n    );\n  }\n}\n\nexport class HMSAudioTrackSettings implements IHMSAudioTrackSettings, IAnalyticsPropertiesProvider {\n  readonly volume?: number;\n  readonly codec?: HMSAudioCodec;\n  readonly maxBitrate?: number;\n  readonly deviceId?: string;\n  readonly advanced?: Array<MediaTrackConstraintSet>;\n  readonly audioMode?: HMSAudioMode;\n\n  constructor(\n    volume?: number,\n    codec?: HMSAudioCodec,\n    maxBitrate?: number,\n    deviceId?: string,\n    advanced?: Array<MediaTrackConstraintSet>,\n    audioMode?: HMSAudioMode,\n  ) {\n    this.volume = volume;\n    this.codec = codec;\n    this.maxBitrate = maxBitrate;\n    this.deviceId = deviceId;\n    this.advanced = advanced;\n    this.audioMode = audioMode;\n    if (this.audioMode === HMSAudioMode.MUSIC) {\n      this.maxBitrate = 320;\n    } else {\n      this.maxBitrate = 32;\n    }\n  }\n\n  toConstraints(): MediaTrackConstraints {\n    return {\n      deviceId: this.deviceId,\n      advanced: this.audioMode === HMSAudioMode.MUSIC ? [] : this.advanced,\n    };\n  }\n\n  toAnalyticsProperties() {\n    return {\n      audio_bitrate: this.maxBitrate,\n      audio_codec: this.codec,\n    };\n  }\n}\n", "import { IAnalyticsPropertiesProvider } from '../../analytics/IAnalyticsPropertiesProvider';\nimport { HMSFacingMode, HMSVideoCodec, HMSVideoTrackSettings as IHMSVideoTrackSettings } from '../../interfaces';\nimport { isMobile } from '../../utils/support';\n\nexport class HMSVideoTrackSettingsBuilder {\n  private _width?: number = 320;\n  private _height?: number = 180;\n  private _codec?: HMSVideoCodec = HMSVideoCodec.VP8;\n  private _maxFramerate?: number = 30;\n  private _maxBitrate?: number = 150;\n  private _deviceId?: string;\n  private _facingMode?: HMSFacingMode;\n  private _advanced: Array<MediaTrackConstraintSet> = [];\n\n  setWidth(width?: number) {\n    this._width = width;\n    return this;\n  }\n\n  setHeight(height?: number) {\n    this._height = height;\n    return this;\n  }\n\n  codec(codec?: HMSVideoCodec) {\n    this._codec = codec;\n    return this;\n  }\n\n  maxFramerate(maxFramerate?: number) {\n    if (maxFramerate && maxFramerate <= 0) {\n      throw Error('maxFramerate should be >= 1');\n    }\n    this._maxFramerate = maxFramerate;\n    return this;\n  }\n\n  /**\n   * @param useDefault Ignored if maxBitrate is valid.\n   * If true and maxBitrate is undefined - sets a default value.\n   * If false and maxBitrate is undefined - sets undefined.\n   */\n  maxBitrate(maxBitrate?: number, useDefault = true) {\n    if (typeof maxBitrate === 'number' && maxBitrate <= 0) {\n      throw Error('maxBitrate should be >= 1');\n    }\n    this._maxBitrate = maxBitrate;\n    if (!this._maxBitrate && useDefault) {\n      this._maxBitrate = 150_000;\n    }\n    return this;\n  }\n\n  deviceId(deviceId: string) {\n    // TODO: Validate if device-id is OK\n    this._deviceId = deviceId;\n    return this;\n  }\n\n  advanced(advanced: Array<MediaTrackConstraintSet>) {\n    this._advanced = advanced;\n    return this;\n  }\n\n  facingMode(mode: HMSFacingMode) {\n    this._facingMode = mode;\n    return this;\n  }\n\n  build() {\n    return new HMSVideoTrackSettings(\n      this._width,\n      this._height,\n      this._codec,\n      this._maxFramerate,\n      this._deviceId,\n      this._advanced,\n      this._maxBitrate,\n      this._facingMode,\n    );\n  }\n}\n\nexport class HMSVideoTrackSettings implements IHMSVideoTrackSettings, IAnalyticsPropertiesProvider {\n  readonly width?: number;\n  readonly height?: number;\n  readonly codec?: HMSVideoCodec;\n  readonly maxFramerate?: number;\n  readonly maxBitrate?: number;\n  readonly deviceId?: string;\n  readonly advanced?: Array<MediaTrackConstraintSet>;\n  facingMode?: HMSFacingMode;\n\n  constructor(\n    width?: number,\n    height?: number,\n    codec?: HMSVideoCodec,\n    maxFramerate?: number,\n    deviceId?: string | undefined,\n    advanced?: Array<MediaTrackConstraintSet>,\n    maxBitrate?: number,\n    facingMode?: HMSFacingMode,\n  ) {\n    this.width = width;\n    this.height = height;\n    this.codec = codec;\n    this.maxFramerate = maxFramerate;\n    this.maxBitrate = maxBitrate;\n    this.deviceId = deviceId;\n    this.advanced = advanced;\n    this.facingMode = facingMode;\n  }\n\n  toConstraints(isScreenShare?: boolean): MediaTrackConstraints {\n    let dimensionConstraintKey = 'ideal';\n    if (isScreenShare) {\n      dimensionConstraintKey = 'max';\n    }\n\n    const aspectRatio = this.improviseConstraintsAspect();\n    return {\n      width: { [dimensionConstraintKey]: aspectRatio.width },\n      height: { [dimensionConstraintKey]: aspectRatio.height },\n      frameRate: this.maxFramerate,\n      deviceId: this.deviceId,\n      facingMode: this.facingMode,\n    };\n  }\n\n  toAnalyticsProperties() {\n    return {\n      width: this.width,\n      height: this.height,\n      video_bitrate: this.maxBitrate,\n      framerate: this.maxFramerate,\n      video_codec: this.codec,\n      facingMode: this.facingMode,\n    };\n  }\n\n  // reverse the height and width if mobile as mobile web browsers override the height and width basis orientation\n  private improviseConstraintsAspect(): Partial<IHMSVideoTrackSettings> {\n    if (isMobile() && this.height && this.width && this.height > this.width) {\n      return {\n        width: this.height,\n        height: this.width,\n      };\n    }\n    return {\n      width: this.width,\n      height: this.height,\n    };\n  }\n}\n", "import { HMSAudioTrackSettings, HMSAudioTrackSettingsBuilder } from './HMSAudioTrackSettings';\nimport { HMSVideoTrackSettings, HMSVideoTrackSettingsBuilder } from './HMSVideoTrackSettings';\nimport { IAnalyticsPropertiesProvider } from '../../analytics/IAnalyticsPropertiesProvider';\nimport { ErrorFactory } from '../../error/ErrorFactory';\nimport { HMSAction } from '../../error/HMSAction';\n\nexport class HMSTrackSettingsBuilder {\n  private _video: HMSVideoTrackSettings | null = new HMSVideoTrackSettingsBuilder().build();\n  private _audio: HMSAudioTrackSettings | null = new HMSAudioTrackSettingsBuilder().build();\n  private _screen: HMSVideoTrackSettings | null = new HMSVideoTrackSettingsBuilder().build();\n  private _simulcast = false;\n\n  video(video: HMSVideoTrackSettings | null) {\n    this._video = video;\n    return this;\n  }\n\n  audio(audio: HMSAudioTrackSettings | null) {\n    this._audio = audio;\n    return this;\n  }\n\n  screen(screen: HMSVideoTrackSettings | null) {\n    this._screen = screen;\n    return this;\n  }\n\n  simulcast(enabled: boolean) {\n    this._simulcast = enabled;\n    return this;\n  }\n\n  build() {\n    if (this._audio === null && this._video === null) {\n      throw ErrorFactory.TracksErrors.NothingToReturn(HMSAction.TRACK);\n    }\n\n    if (this._video === null && this._simulcast) {\n      throw ErrorFactory.TracksErrors.InvalidVideoSettings(\n        HMSAction.TRACK,\n        'Cannot enable simulcast when no video settings are provided',\n      );\n    }\n\n    return new HMSTrackSettings(this._video, this._audio, this._simulcast, this._screen || undefined);\n  }\n}\n\nexport class HMSTrackSettings implements IAnalyticsPropertiesProvider {\n  readonly video: HMSVideoTrackSettings | null | undefined;\n  readonly audio: HMSAudioTrackSettings | null | undefined;\n  readonly screen: HMSVideoTrackSettings | null;\n  readonly simulcast: boolean;\n\n  constructor(\n    video: HMSVideoTrackSettings | null | undefined,\n    audio: HMSAudioTrackSettings | null | undefined,\n    simulcast: boolean,\n    screen: HMSVideoTrackSettings | null = null,\n  ) {\n    this.video = video;\n    this.audio = audio;\n    this.simulcast = simulcast;\n    this.screen = screen;\n  }\n\n  toAnalyticsProperties() {\n    let properties = {\n      audio_enabled: this.audio !== null,\n      video_enabled: this.video !== null,\n    };\n\n    if (this.audio) {\n      properties = { ...this.audio.toAnalyticsProperties(), ...properties };\n    }\n\n    if (this.video) {\n      properties = { ...this.video.toAnalyticsProperties(), ...properties };\n    }\n\n    return properties;\n  }\n}\n", "import { HMSAudioTrack } from './HMSAudioTrack';\n\nexport class HMSRemoteAudioTrack extends HMSAudioTrack {\n  async setEnabled(value: boolean): Promise<void> {\n    if (value === this.enabled) {\n      return;\n    }\n    await super.setEnabled(value);\n    await this.subscribeToAudio(value);\n  }\n}\n", "import { HMSTrack, HMSTrackSource } from './HMSTrack';\nimport { HMSTrackType } from './HMSTrackType';\nimport { VideoElementManager } from './VideoElementManager';\nimport HMSLogger from '../../utils/logger';\nimport { isSafari } from '../../utils/support';\nimport { HMSMediaStream } from '../streams';\n\nexport class HMSVideoTrack extends HMSTrack {\n  readonly type: HMSTrackType = HMSTrackType.VIDEO;\n  private sinkCount = 0;\n  videoHandler!: VideoElementManager;\n\n  constructor(stream: HMSMediaStream, track: MediaStreamTrack, source?: string) {\n    super(stream, track, source as HMSTrackSource);\n    if (track.kind !== 'video') {\n      throw new Error(\"Expected 'track' kind = 'video'\");\n    }\n  }\n\n  setVideoHandler(videoHandler: VideoElementManager) {\n    this.videoHandler = videoHandler;\n  }\n\n  /**\n   * sink=video element rendering the video\n   */\n  hasSinks() {\n    return this.sinkCount > 0;\n  }\n\n  getSinks() {\n    return this.videoHandler.getVideoElements() || [];\n  }\n\n  attach(videoElement: HTMLVideoElement) {\n    this.videoHandler.addVideoElement(videoElement);\n  }\n\n  detach(videoElement: HTMLVideoElement) {\n    this.videoHandler.removeVideoElement(videoElement);\n  }\n\n  /**\n   * attaches the track to the passed in video element\n   * @param videoElement\n   */\n  addSink(videoElement: HTMLVideoElement) {\n    this.addSinkInternal(videoElement, this.nativeTrack);\n  }\n\n  /**\n   * removes the track from the passed in video element\n   * @param videoElement\n   */\n  removeSink(videoElement: HTMLVideoElement) {\n    if (videoElement.srcObject !== null) {\n      videoElement.srcObject = null;\n      this.reduceSinkCount();\n    }\n  }\n\n  cleanup(): void {\n    super.cleanup();\n    this.videoHandler.cleanup();\n  }\n\n  protected addSinkInternal(videoElement: HTMLVideoElement, track: MediaStreamTrack) {\n    const srcObject = videoElement.srcObject;\n    if (srcObject !== null && srcObject instanceof MediaStream) {\n      const existingTrack = srcObject.getVideoTracks()[0];\n      if (existingTrack?.id === track.id) {\n        if (!existingTrack.muted && existingTrack.readyState === 'live') {\n          // it's already attached, attaching again would just cause flickering\n          return;\n        } else {\n          this.reduceSinkCount();\n        }\n      } else {\n        this.reduceSinkCount();\n      }\n    }\n\n    this.addPropertiesToElement(videoElement);\n    const stream = new MediaStream([track]);\n    videoElement.srcObject = stream;\n    this.reTriggerPlay({ videoElement });\n    this.sinkCount++;\n  }\n\n  handleTrackUnmute() {\n    this.getSinks().forEach(videoElement => this.reTriggerPlay({ videoElement }));\n  }\n\n  private reTriggerPlay = ({ videoElement }: { videoElement: HTMLVideoElement }) => {\n    setTimeout(() => {\n      videoElement.play().catch(() => {\n        HMSLogger.w('[HMSVideoTrack]', 'failed to play');\n      });\n    }, 0);\n  };\n\n  private reduceSinkCount() {\n    if (this.sinkCount > 0) {\n      this.sinkCount--;\n    }\n  }\n\n  private addPropertiesToElement(element: HTMLVideoElement) {\n    if (!isSafari) {\n      element.autoplay = true;\n    }\n    element.playsInline = true;\n    element.muted = true;\n    element.controls = false;\n  }\n}\n", "import isEqual from 'lodash.isequal';\nimport { HMSVideoTrack } from './HMSVideoTrack';\nimport { VideoElementManager } from './VideoElementManager';\nimport AnalyticsEventFactory from '../../analytics/AnalyticsEventFactory';\nimport { DeviceStorageManager } from '../../device-manager/DeviceStorage';\nimport { ErrorFactory } from '../../error/ErrorFactory';\nimport { HMSAction } from '../../error/HMSAction';\nimport { EventBus } from '../../events/EventBus';\nimport {\n  HMSFacingMode,\n  HMSSimulcastLayerDefinition,\n  HMSVideoTrackSettings as IHMSVideoTrackSettings,\n  ScreenCaptureHandle,\n} from '../../interfaces';\nimport { HMSPluginSupportResult, HMSVideoPlugin } from '../../plugins';\nimport { HMSMediaStreamPlugin, HMSVideoPluginsManager } from '../../plugins/video';\nimport { HMSMediaStreamPluginsManager } from '../../plugins/video/HMSMediaStreamPluginsManager';\nimport { LocalTrackManager } from '../../sdk/LocalTrackManager';\nimport Room from '../../sdk/models/HMSRoom';\nimport HMSLogger from '../../utils/logger';\nimport { isBrowser, isMobile } from '../../utils/support';\nimport { getVideoTrack, isEmptyTrack } from '../../utils/track';\nimport { HMSVideoTrackSettings, HMSVideoTrackSettingsBuilder } from '../settings';\nimport { HMSLocalStream } from '../streams';\n\nfunction generateHasPropertyChanged(newSettings: Partial<HMSVideoTrackSettings>, oldSettings: HMSVideoTrackSettings) {\n  return function hasChanged(\n    prop: 'codec' | 'width' | 'height' | 'maxFramerate' | 'maxBitrate' | 'deviceId' | 'advanced' | 'facingMode',\n  ) {\n    return !isEqual(newSettings[prop], oldSettings[prop]);\n  };\n}\n\nexport class HMSLocalVideoTrack extends HMSVideoTrack {\n  settings: HMSVideoTrackSettings;\n  private pluginsManager: HMSVideoPluginsManager;\n  private mediaStreamPluginsManager: HMSMediaStreamPluginsManager;\n  private processedTrack?: MediaStreamTrack;\n  private _layerDefinitions: HMSSimulcastLayerDefinition[] = [];\n  private TAG = '[HMSLocalVideoTrack]';\n  private enabledStateBeforeBackground = false;\n\n  /**\n   * true if it's screenshare and current tab is what is being shared. Browser dependent, Chromium only\n   * at the point of writing this comment.\n   */\n  isCurrentTab = false;\n\n  /**\n   * @internal\n   * This is required for handling remote mute/unmute as the published track will not necessarily be same as\n   * the first track id or current native track's id.\n   * It won't be same as first track id if the native track was changed after preview started but before join happened,\n   * with device change, or mute/unmute.\n   * It won't be same as native track id, as the native track can change post join(and publish), when the nativetrack\n   * changes, replacetrack is used which doesn't involve republishing which means from server's point of view, the track id\n   * is same as what was initially published.\n   * This will only be available if the track was actually published and won't be set for preview tracks.\n   */\n  publishedTrackId?: string;\n\n  /**\n   * will be false for preview tracks\n   */\n  isPublished = false;\n\n  constructor(\n    stream: HMSLocalStream,\n    track: MediaStreamTrack,\n    source: string,\n    private eventBus: EventBus,\n    settings: HMSVideoTrackSettings = new HMSVideoTrackSettingsBuilder().build(),\n    private room?: Room,\n  ) {\n    super(stream, track, source);\n    this.addTrackEventListeners(track);\n    stream.tracks.push(this);\n    this.setVideoHandler(new VideoElementManager(this));\n    this.settings = settings;\n    // Replace the 'default' or invalid deviceId with the actual deviceId\n    // This is to maintain consistency with selected devices as in some cases there will be no 'default' device\n    if (settings.deviceId !== track.getSettings().deviceId && track.enabled) {\n      this.settings = this.buildNewSettings({ deviceId: track.getSettings().deviceId });\n    }\n    this.pluginsManager = new HMSVideoPluginsManager(this, eventBus);\n    this.mediaStreamPluginsManager = new HMSMediaStreamPluginsManager(eventBus, room);\n    this.setFirstTrackId(this.trackId);\n    if (isBrowser && source === 'regular' && isMobile()) {\n      document.addEventListener('visibilitychange', this.handleVisibilityChange);\n    }\n  }\n\n  clone(stream: HMSLocalStream) {\n    const track = new HMSLocalVideoTrack(\n      stream,\n      this.nativeTrack.clone(),\n      this.source!,\n      this.eventBus,\n      this.settings,\n      this.room,\n    );\n    track.peerId = this.peerId;\n\n    if (this.pluginsManager.pluginsMap.size > 0) {\n      this.pluginsManager.pluginsMap.forEach(value => {\n        track\n          .addPlugin(value)\n          .catch((e: Error) => HMSLogger.e(this.TAG, 'Plugin add failed while migrating', value, e));\n      });\n    }\n    if (this.mediaStreamPluginsManager.plugins.size > 0) {\n      track.addStreamPlugins(Array.from(this.mediaStreamPluginsManager.plugins));\n    }\n    return track;\n  }\n\n  /** @internal */\n  setSimulcastDefinitons(definitions: HMSSimulcastLayerDefinition[]) {\n    this._layerDefinitions = definitions;\n  }\n\n  /**\n   * Method to get available simulcast definitions for the track\n   * @returns {HMSSimulcastLayerDefinition[]}\n   */\n  getSimulcastDefinitions(): HMSSimulcastLayerDefinition[] {\n    return this._layerDefinitions;\n  }\n\n  /**\n   * use this function to set the enabled state of a track. If true the track will be unmuted and muted otherwise.\n   * @param value\n   */\n  async setEnabled(value: boolean): Promise<void> {\n    if (value === this.enabled) {\n      return;\n    }\n    if (this.source === 'regular') {\n      let track: MediaStreamTrack;\n      if (value) {\n        track = await this.replaceTrackWith(this.settings);\n      } else {\n        track = await this.replaceTrackWithBlank();\n      }\n      await this.replaceSender(track, value);\n      this.nativeTrack?.stop();\n      this.nativeTrack = track;\n      await super.setEnabled(value);\n      if (value) {\n        await this.pluginsManager.waitForRestart();\n        await this.processPlugins();\n        this.settings = this.buildNewSettings({ deviceId: track.getSettings().deviceId });\n      }\n      this.videoHandler.updateSinks();\n    }\n    this.eventBus.localVideoEnabled.publish({ enabled: value, track: this });\n  }\n\n  private async processPlugins() {\n    try {\n      if (this.pluginsManager.getPlugins().length > 0) {\n        return;\n      }\n      const plugins = this.mediaStreamPluginsManager.getPlugins();\n      if (plugins.length > 0) {\n        const processedStream = this.mediaStreamPluginsManager.applyPlugins(new MediaStream([this.nativeTrack]));\n        const newTrack = processedStream.getVideoTracks()[0];\n        await this.setProcessedTrack(newTrack);\n      } else {\n        await this.setProcessedTrack();\n      }\n      this.videoHandler.updateSinks();\n    } catch (e) {\n      console.error('error in processing plugin(s)', e);\n    }\n  }\n\n  async addStreamPlugins(plugins: HMSMediaStreamPlugin[]) {\n    if (this.pluginsManager.getPlugins().length > 0) {\n      throw Error('Plugins of type HMSMediaStreamPlugin and HMSVideoPlugin cannot be used together');\n    }\n    this.mediaStreamPluginsManager.addPlugins(plugins);\n    await this.processPlugins();\n  }\n\n  async removeStreamPlugins(plugins: HMSMediaStreamPlugin[]) {\n    this.mediaStreamPluginsManager.removePlugins(plugins);\n    await this.processPlugins();\n  }\n\n  /**\n   * verify if the track id being passed is of this track for correlating server messages like degradation\n   */\n  isPublishedTrackId(trackId: string) {\n    return this.publishedTrackId === trackId;\n  }\n\n  /**\n   * @see HMSVideoTrack#addSink()\n   */\n  addSink(videoElement: HTMLVideoElement) {\n    this.addSinkInternal(videoElement, this.processedTrack || this.nativeTrack);\n  }\n\n  /**\n   * This function can be used to set media track settings. Frequent options -\n   * deviceID: can be used to change to different input source\n   * width, height - can be used to change capture dimensions\n   * maxFramerate - can be used to control the capture framerate\n   * @param settings\n   */\n  async setSettings(settings: Partial<IHMSVideoTrackSettings>, internal = false) {\n    const newSettings = this.buildNewSettings(settings);\n    await this.handleDeviceChange(newSettings, internal);\n    if (!this.enabled || isEmptyTrack(this.nativeTrack)) {\n      // if track is muted, we just cache the settings for when it is unmuted\n      this.settings = newSettings;\n      return;\n    } else {\n      await this.pluginsManager.waitForRestart();\n    }\n    await this.handleSettingsChange(newSettings);\n    this.settings = newSettings;\n  }\n\n  /**\n   * @see HMSVideoPlugin\n   */\n  getPlugins(): string[] {\n    return this.mediaStreamPluginsManager.getPlugins().length > 0\n      ? this.mediaStreamPluginsManager.getPlugins()\n      : this.pluginsManager.getPlugins();\n  }\n\n  /**\n   * @see HMSVideoPlugin\n   */\n  async addPlugin(plugin: HMSVideoPlugin, pluginFrameRate?: number): Promise<void> {\n    if (this.mediaStreamPluginsManager.getPlugins().length > 0) {\n      throw Error('Plugins of type HMSVideoPlugin and HMSMediaStreamPlugin cannot be used together');\n    }\n    return this.pluginsManager.addPlugin(plugin, pluginFrameRate);\n  }\n\n  /**\n   * @see HMSVideoPlugin\n   */\n  async removePlugin(plugin: HMSVideoPlugin): Promise<void> {\n    return this.pluginsManager.removePlugin(plugin);\n  }\n\n  /**\n   * @see HMSVideoPlugin\n   */\n  validatePlugin(plugin: HMSVideoPlugin): HMSPluginSupportResult {\n    return this.pluginsManager.validatePlugin(plugin);\n  }\n\n  /**\n   * @internal\n   */\n  async cleanup() {\n    this.removeTrackEventListeners(this.nativeTrack);\n    super.cleanup();\n    this.transceiver = undefined;\n    await this.pluginsManager.cleanup();\n    this.processedTrack?.stop();\n    this.isPublished = false;\n    if (isBrowser && isMobile()) {\n      document.removeEventListener('visibilitychange', this.handleVisibilityChange);\n    }\n  }\n\n  /**\n   * only for screenshare track to crop to a cropTarget\n   * @internal\n   */\n  async cropTo(cropTarget?: object) {\n    if (!cropTarget) {\n      return;\n    }\n    if (this.source !== 'screen') {\n      return;\n    }\n    try {\n      // @ts-ignore\n      if (this.nativeTrack.cropTo) {\n        // @ts-ignore\n        await this.nativeTrack.cropTo(cropTarget);\n      }\n    } catch (err) {\n      HMSLogger.e(this.TAG, 'failed to crop screenshare capture - ', err);\n      throw ErrorFactory.TracksErrors.GenericTrack(HMSAction.TRACK, 'failed to crop screenshare capture');\n    }\n  }\n\n  /**\n   * only for screenshare track to get the captureHandle\n   * TODO: add an API for capturehandlechange event\n   * @internal\n   */\n  getCaptureHandle(): ScreenCaptureHandle | undefined {\n    // @ts-ignore\n    if (this.nativeTrack.getCaptureHandle) {\n      // @ts-ignore\n      return this.nativeTrack.getCaptureHandle();\n    }\n    return undefined;\n  }\n\n  /**\n   * once the plugin manager has done its processing it can set or remove processed track via this method\n   * note that replacing sender track only makes sense if the native track is enabled. if it's disabled there is\n   * no point in replacing it. We'll update the processed track variable though so next time unmute happens\n   * it's set properly.\n   * @internal\n   */\n  async setProcessedTrack(processedTrack?: MediaStreamTrack) {\n    // required replacement will happen when video is unmuted\n    if (!this.nativeTrack.enabled) {\n      this.processedTrack = processedTrack;\n      return;\n    }\n    await this.removeOrReplaceProcessedTrack(processedTrack);\n    this.videoHandler.updateSinks();\n  }\n\n  /**\n   * @internal\n   * sent track id will be different in case there was some processing done using plugins.\n   * replace track is used to, start sending data from a new track without un publishing the prior one. There\n   * are thus two track ids - the one which was initially published and should be unpublished when required.\n   * The one whose data is currently being sent, which will be used when removing from connection senders.\n   */\n  getTrackIDBeingSent() {\n    return this.getTrackBeingSent().id;\n  }\n\n  getTrackBeingSent() {\n    return this.enabled ? this.processedTrack || this.nativeTrack : this.nativeTrack;\n  }\n\n  /**\n   * will change the facingMode to environment if current facing mode is user or vice versa.\n   * will be useful when on mobile web to toggle between front and back camera's\n   */\n  async switchCamera() {\n    const currentFacingMode = this.getMediaTrackSettings().facingMode;\n    if (!currentFacingMode || this.source !== 'regular') {\n      HMSLogger.d(this.TAG, 'facingMode not supported');\n      return;\n    }\n    const facingMode = currentFacingMode === HMSFacingMode.ENVIRONMENT ? HMSFacingMode.USER : HMSFacingMode.ENVIRONMENT;\n    this.nativeTrack?.stop();\n    const track = await this.replaceTrackWith(this.buildNewSettings({ facingMode: facingMode, deviceId: undefined }));\n    await this.replaceSender(track, this.enabled);\n    this.nativeTrack = track;\n    await this.processPlugins();\n    this.videoHandler.updateSinks();\n    this.settings = this.buildNewSettings({ deviceId: this.nativeTrack.getSettings().deviceId, facingMode });\n    DeviceStorageManager.updateSelection('videoInput', {\n      deviceId: this.settings.deviceId,\n      groupId: this.nativeTrack.getSettings().groupId,\n    });\n  }\n\n  /**\n   * called when the video is unmuted\n   * @private\n   */\n  private async replaceTrackWith(settings: HMSVideoTrackSettings) {\n    const prevTrack = this.nativeTrack;\n    /**\n     * not stopping previous track results in device in use more frequently, as many devices will not allow even if\n     * you are requesting for a new device.\n     * Note: Do not change the order of this.\n     */\n    this.removeTrackEventListeners(prevTrack);\n    prevTrack?.stop();\n    try {\n      const newTrack = await getVideoTrack(settings);\n      this.addTrackEventListeners(newTrack);\n      HMSLogger.d(this.TAG, 'replaceTrack, Previous track stopped', prevTrack, 'newTrack', newTrack);\n      // Replace deviceId with actual deviceId when it is default\n      if (this.settings.deviceId === 'default') {\n        this.settings = this.buildNewSettings({ deviceId: this.nativeTrack.getSettings().deviceId });\n      }\n      return newTrack;\n    } catch (error) {\n      // Generate a new track from previous settings so there won't be blank tile because previous track is stopped\n      const track = await getVideoTrack(this.settings);\n      this.addTrackEventListeners(track);\n      await this.replaceSender(track, this.enabled);\n      this.nativeTrack = track;\n      await this.processPlugins();\n      this.videoHandler.updateSinks();\n      if (this.isPublished) {\n        this.eventBus.analytics.publish(\n          AnalyticsEventFactory.publish({\n            error: error as Error,\n          }),\n        );\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * called when the video is muted. A blank track is used to replace the original track. This is in order to\n   * turn off the camera light and keep the bytes flowing to avoid av sync, timestamp issues.\n   * @private\n   */\n  private async replaceTrackWithBlank() {\n    const prevTrack = this.nativeTrack;\n    const newTrack = LocalTrackManager.getEmptyVideoTrack(prevTrack);\n    this.removeTrackEventListeners(prevTrack);\n    this.addTrackEventListeners(newTrack);\n    prevTrack?.stop();\n    HMSLogger.d(this.TAG, 'replaceTrackWithBlank, Previous track stopped', prevTrack, 'newTrack', newTrack);\n    return newTrack;\n  }\n\n  private async replaceSender(newTrack: MediaStreamTrack, enabled: boolean) {\n    if (enabled) {\n      await this.replaceSenderTrack(this.processedTrack || newTrack);\n    } else {\n      await this.replaceSenderTrack(newTrack);\n    }\n    const localStream = this.stream as HMSLocalStream;\n    localStream.replaceStreamTrack(this.nativeTrack, newTrack);\n  }\n\n  private replaceSenderTrack = async (track: MediaStreamTrack) => {\n    if (!this.transceiver || this.transceiver.direction !== 'sendonly') {\n      HMSLogger.d(this.TAG, `transceiver for ${this.trackId} not available or not connected yet`);\n      return;\n    }\n    await this.transceiver.sender.replaceTrack(track);\n  };\n\n  private buildNewSettings = (settings: Partial<HMSVideoTrackSettings>) => {\n    const { width, height, codec, maxFramerate, maxBitrate, deviceId, advanced, facingMode } = {\n      ...this.settings,\n      ...settings,\n    };\n    const newSettings = new HMSVideoTrackSettings(\n      width,\n      height,\n      codec,\n      maxFramerate,\n      deviceId,\n      advanced,\n      maxBitrate,\n      facingMode,\n    );\n    return newSettings;\n  };\n\n  // eslint-disable-next-line complexity\n  private handleSettingsChange = async (settings: HMSVideoTrackSettings) => {\n    const stream = this.stream as HMSLocalStream;\n    const hasPropertyChanged = generateHasPropertyChanged(settings, this.settings);\n    if (hasPropertyChanged('maxBitrate') && settings.maxBitrate) {\n      await stream.setMaxBitrateAndFramerate(this);\n    }\n    if (hasPropertyChanged('width') || hasPropertyChanged('height') || hasPropertyChanged('advanced')) {\n      if (this.source === 'video') {\n        const track = await this.replaceTrackWith(settings);\n        await this.replaceSender(track, this.enabled);\n        this.nativeTrack = track;\n        await this.processPlugins();\n        this.videoHandler.updateSinks();\n      } else {\n        await this.nativeTrack.applyConstraints(settings.toConstraints());\n      }\n    }\n  };\n\n  /**\n   * Replace video track with new track on device change\n   * @param settings - VideoSettings Object constructed with new settings\n   * @param internal - whether the change was because of internal sdk call or external client call\n   */\n  private handleDeviceChange = async (settings: HMSVideoTrackSettings, internal = false) => {\n    const hasPropertyChanged = generateHasPropertyChanged(settings, this.settings);\n\n    if (hasPropertyChanged('deviceId') && this.source === 'regular') {\n      if (this.enabled) {\n        delete settings.facingMode;\n        const track = await this.replaceTrackWith(settings);\n        await this.replaceSender(track, this.enabled);\n        this.nativeTrack = track;\n        await this.processPlugins();\n        this.videoHandler.updateSinks();\n      }\n      const groupId = this.nativeTrack.getSettings().groupId;\n      if (!internal && settings.deviceId) {\n        DeviceStorageManager.updateSelection('videoInput', {\n          deviceId: settings.deviceId,\n          groupId,\n        });\n        this.eventBus.deviceChange.publish({\n          isUserSelection: true,\n          type: 'video',\n          selection: {\n            deviceId: settings.deviceId,\n            groupId: groupId,\n          },\n        });\n      }\n    }\n  };\n\n  private addTrackEventListeners(track: MediaStreamTrack) {\n    track.addEventListener('mute', this.handleTrackMute);\n    track.addEventListener('unmute', this.handleTrackUnmute);\n  }\n\n  private removeTrackEventListeners(track: MediaStreamTrack) {\n    track.removeEventListener('mute', this.handleTrackMute);\n    track.removeEventListener('unmute', this.handleTrackUnmute);\n  }\n\n  private handleTrackMute = () => {\n    HMSLogger.d(this.TAG, 'muted natively');\n    this.eventBus.analytics.publish(\n      this.sendInterruptionEvent({\n        started: true,\n        reason: 'incoming-call',\n      }),\n    );\n    this.eventBus.localVideoEnabled.publish({ enabled: false, track: this });\n  };\n\n  /** @internal */\n  handleTrackUnmute = () => {\n    HMSLogger.d(this.TAG, 'unmuted natively');\n    this.eventBus.analytics.publish(\n      this.sendInterruptionEvent({\n        started: false,\n        reason: 'incoming-call',\n      }),\n    );\n    super.handleTrackUnmute();\n    this.eventBus.localVideoEnabled.publish({ enabled: this.enabled, track: this });\n    this.eventBus.localVideoUnmutedNatively.publish();\n  };\n\n  /**\n   * This will either remove or update the processedTrack value on the class instance.\n   * It will also replace sender if the processedTrack is updated\n   * @param {MediaStreamTrack|undefined}processedTrack\n   */\n  private removeOrReplaceProcessedTrack = async (processedTrack?: MediaStreamTrack) => {\n    // if all plugins are removed reset everything back to native track\n    if (!processedTrack) {\n      this.processedTrack = undefined;\n    } else if (processedTrack !== this.processedTrack) {\n      this.processedTrack = processedTrack;\n    }\n    await this.replaceSenderTrack(this.processedTrack || this.nativeTrack);\n  };\n\n  // eslint-disable-next-line complexity\n  private handleVisibilityChange = async () => {\n    if (document.visibilityState === 'hidden') {\n      this.enabledStateBeforeBackground = this.enabled;\n      if (this.enabled) {\n        const track = await this.replaceTrackWithBlank();\n        await this.replaceSender(track, this.enabled);\n        this.nativeTrack?.stop();\n        this.nativeTrack = track;\n      } else {\n        await this.replaceSender(this.nativeTrack, false);\n      }\n      // started interruption event\n      this.eventBus.analytics.publish(\n        this.sendInterruptionEvent({\n          started: true,\n          reason: 'visibility-change',\n        }),\n      );\n    } else {\n      HMSLogger.d(this.TAG, 'visibility visibile, restoring track state', this.enabledStateBeforeBackground);\n      if (this.enabledStateBeforeBackground) {\n        await this.setEnabled(true);\n      } else {\n        this.nativeTrack.enabled = this.enabledStateBeforeBackground;\n        await this.replaceSender(this.nativeTrack, this.enabledStateBeforeBackground);\n      }\n      // ended interruption event\n      this.eventBus.analytics.publish(\n        this.sendInterruptionEvent({\n          started: false,\n          reason: 'visibility-change',\n        }),\n      );\n    }\n    this.eventBus.localVideoEnabled.publish({ enabled: this.nativeTrack.enabled, track: this });\n  };\n}\n", "import { v4 as uuid } from 'uuid';\nimport { getClosestLayer, layerToIntMapping } from './trackUtils';\nimport { HMSPreferredSimulcastLayer } from '../../interfaces/simulcast-layers';\nimport { HMSLocalVideoTrack, HMSRemoteVideoTrack } from '../../internal';\nimport { HMSIntersectionObserver } from '../../utils/intersection-observer';\nimport HMSLogger from '../../utils/logger';\nimport { HMSResizeObserver } from '../../utils/resize-observer';\nimport { isBrowser } from '../../utils/support';\n\n/**\n * This class is to manager video elements for video tracks.\n * This will handle attaching/detaching when element is in view or out of view.\n * This will also handle selecting appropriate layer when element size changesx\n */\nexport class VideoElementManager {\n  private readonly TAG = '[VideoElementManager]';\n  private resizeObserver?: typeof HMSResizeObserver;\n  private intersectionObserver?: typeof HMSIntersectionObserver;\n  private videoElements = new Set<HTMLVideoElement>();\n  private entries = new WeakMap<HTMLVideoElement, DOMRectReadOnly>();\n  private id: string;\n\n  constructor(private track: HMSLocalVideoTrack | HMSRemoteVideoTrack) {\n    this.init();\n    this.id = uuid();\n  }\n\n  updateSinks(requestLayer = false) {\n    for (const videoElement of this.videoElements) {\n      if (this.track.enabled) {\n        this.track.addSink(videoElement, requestLayer);\n      } else {\n        this.track.removeSink(videoElement, requestLayer);\n      }\n    }\n  }\n\n  // eslint-disable-next-line complexity\n  async addVideoElement(videoElement: HTMLVideoElement) {\n    if (this.videoElements.has(videoElement)) {\n      return;\n    }\n    // Call init again, to initialize again if for some reason it failed in constructor\n    // it will be a no-op if initialize already\n    this.init();\n    HMSLogger.d(this.TAG, `Adding video element for ${this.track}`, this.id);\n    this.videoElements.add(videoElement);\n    if (this.videoElements.size >= 10) {\n      HMSLogger.w(\n        this.TAG,\n        `${this.track}`,\n        `the track is added to ${this.videoElements.size} video elements, while this may be intentional, it's likely that there is a bug leading to unnecessary creation of video elements in the UI`,\n      );\n    }\n\n    if (this.intersectionObserver?.isSupported()) {\n      this.intersectionObserver.observe(videoElement, this.handleIntersection);\n    } else if (isBrowser) {\n      if (this.isElementInViewport(videoElement)) {\n        this.track.addSink(videoElement);\n      } else {\n        this.track.removeSink(videoElement);\n      }\n    }\n    if (this.resizeObserver) {\n      this.resizeObserver.observe(videoElement, this.handleResize);\n    } else if (this.track instanceof HMSRemoteVideoTrack) {\n      await this.track.setPreferredLayer(this.track.getPreferredLayer());\n    }\n  }\n\n  removeVideoElement(videoElement: HTMLVideoElement): void {\n    this.track.removeSink(videoElement);\n    this.videoElements.delete(videoElement);\n    this.entries.delete(videoElement);\n    this.resizeObserver?.unobserve(videoElement);\n    this.intersectionObserver?.unobserve(videoElement);\n    HMSLogger.d(this.TAG, `Removing video element for ${this.track}`);\n  }\n\n  getVideoElements(): HTMLVideoElement[] {\n    return Array.from(this.videoElements);\n  }\n\n  private init() {\n    if (isBrowser) {\n      this.resizeObserver = HMSResizeObserver;\n      this.intersectionObserver = HMSIntersectionObserver;\n    }\n  }\n\n  private handleIntersection = async (entry: IntersectionObserverEntry) => {\n    const isVisibile = getComputedStyle(entry.target).visibility === 'visible';\n    // .contains check is needed for pip component as the video tiles are not mounted to dom element\n    if (this.track.enabled && ((entry.isIntersecting && isVisibile) || !document.contains(entry.target))) {\n      HMSLogger.d(this.TAG, 'add sink intersection', `${this.track}`, this.id);\n      this.entries.set(entry.target as HTMLVideoElement, entry.boundingClientRect);\n      await this.selectMaxLayer();\n      await this.track.addSink(entry.target as HTMLVideoElement);\n    } else {\n      HMSLogger.d(this.TAG, 'remove sink intersection', `${this.track}`, this.id);\n      await this.track.removeSink(entry.target as HTMLVideoElement);\n    }\n  };\n\n  private handleResize = async (entry: ResizeObserverEntry) => {\n    if (!this.track.enabled || !(this.track instanceof HMSRemoteVideoTrack)) {\n      return;\n    }\n    this.entries.set(entry.target as HTMLVideoElement, entry.contentRect);\n    await this.selectMaxLayer();\n  };\n\n  /**\n   *  Taken from\n   *  https://stackoverflow.com/a/125106/4321808\n   */\n  // eslint-disable-next-line complexity\n  private isElementInViewport(el: HTMLElement) {\n    let top = el.offsetTop;\n    let left = el.offsetLeft;\n    const width = el.offsetWidth;\n    const height = el.offsetHeight;\n    const { hidden } = el;\n    const { opacity, display } = getComputedStyle(el);\n\n    while (el.offsetParent) {\n      el = el.offsetParent as HTMLElement;\n      top += el.offsetTop;\n      left += el.offsetLeft;\n    }\n\n    return (\n      top < window.pageYOffset + window.innerHeight &&\n      left < window.pageXOffset + window.innerWidth &&\n      top + height > window.pageYOffset &&\n      left + width > window.pageXOffset &&\n      !hidden &&\n      (opacity !== '' ? parseFloat(opacity) > 0 : true) &&\n      display !== 'none'\n    );\n  }\n\n  // eslint-disable-next-line complexity\n  private async selectMaxLayer() {\n    if (!(this.track instanceof HMSRemoteVideoTrack) || this.videoElements.size === 0) {\n      return;\n    }\n    let maxLayer!: HMSPreferredSimulcastLayer;\n    for (const element of this.videoElements) {\n      const entry = this.entries.get(element);\n      if (!entry) {\n        continue;\n      }\n      const { width, height } = entry;\n      if (width === 0 || height === 0) {\n        continue;\n      }\n      const layer = getClosestLayer(this.track.getSimulcastDefinitions(), { width, height });\n      if (!maxLayer) {\n        maxLayer = layer;\n      } else {\n        maxLayer = layerToIntMapping[layer] > layerToIntMapping[maxLayer] ? layer : maxLayer;\n      }\n    }\n    if (maxLayer) {\n      HMSLogger.d(this.TAG, `selecting max layer ${maxLayer} for the track`, `${this.track}`);\n      await this.track.setPreferredLayer(maxLayer);\n    }\n  }\n\n  cleanup = () => {\n    this.videoElements.forEach(videoElement => {\n      videoElement.srcObject = null;\n      this.resizeObserver?.unobserve(videoElement);\n      this.intersectionObserver?.unobserve(videoElement);\n    });\n    this.videoElements.clear();\n    this.resizeObserver = undefined;\n    this.intersectionObserver = undefined;\n  };\n}\n", "import { HMSPreferredSimulcastLayer, HMSSimulcastLayer, HMSSimulcastLayerDefinition } from '../../interfaces';\n\nexport const layerToIntMapping = {\n  [HMSSimulcastLayer.NONE]: -1,\n  [HMSSimulcastLayer.LOW]: 0,\n  [HMSSimulcastLayer.MEDIUM]: 1,\n  [HMSSimulcastLayer.HIGH]: 2,\n};\nconst DELTA_THRESHOLD = 0.5;\n\n/**\n * Given the simulcast layers and the current video element dimensions, this function finds the\n * layer with dimensions closer to the video element dimensions.\n */\n// eslint-disable-next-line complexity\nexport const getClosestLayer = (\n  simulcastLayers: HMSSimulcastLayerDefinition[],\n  videoElementDimensions: { width: number; height: number },\n): HMSPreferredSimulcastLayer => {\n  let closestLayer: HMSPreferredSimulcastLayer = HMSSimulcastLayer.HIGH;\n  // when both width and height are equal pick height to select a better quality\n  const maxDimension = videoElementDimensions.width > videoElementDimensions.height ? 'width' : 'height';\n  const layers = [...simulcastLayers].sort((a, b) => layerToIntMapping[a.layer] - layerToIntMapping[b.layer]);\n  const videoDimesion = videoElementDimensions[maxDimension] * (window?.devicePixelRatio || 1);\n  for (let i = 0; i < layers.length; i++) {\n    const { resolution, layer } = layers[i];\n    const layerDimension = resolution[maxDimension];\n    // we break here because the layers are already sorted, the next would always be greater if the below condition satisifes\n    if (videoDimesion <= layerDimension) {\n      closestLayer = layer;\n      break;\n    } else {\n      const nextLayer = layers[i + 1];\n      const nextLayerDimension = nextLayer ? nextLayer.resolution[maxDimension] : Number.POSITIVE_INFINITY;\n      // calculating which layer this dimension is closer to\n      const proximityPercent = (videoDimesion - layerDimension) / (nextLayerDimension - layerDimension);\n      if (proximityPercent < DELTA_THRESHOLD) {\n        // the element's dimension is closer to the current layer\n        closestLayer = layer;\n        break;\n      }\n    }\n  }\n  return closestLayer;\n};\n", "import HMSLogger from './logger';\nimport { isBrowser } from './support';\n\nexport interface HMSIntersectionObserverCallback {\n  (entry: IntersectionObserverEntry): void;\n}\n\n/**\n * This is a wrapper around IntersectionObserver which will call the callback passed\n * for an element while observing, only when that element is intersecting\n */\nexport class HMSIntersectionObserverWrapper {\n  private intersectionObserver?: IntersectionObserver;\n  private readonly TAG = '[HMSIntersectionObserverWrapper]';\n  private listeners = new WeakMap<HTMLElement, HMSIntersectionObserverCallback>();\n  constructor() {\n    this.createObserver();\n  }\n\n  isSupported() {\n    const isSupported = isBrowser && typeof window.IntersectionObserver !== 'undefined';\n    if (!isSupported) {\n      HMSLogger.w(this.TAG, 'IntersectionObserver is not supported, fallback will be used instead');\n    }\n    return isSupported;\n  }\n\n  observe = (element: HTMLElement, onIntersection: HMSIntersectionObserverCallback) => {\n    this.createObserver();\n    // unobserve before observing the element\n    this.unobserve(element);\n    this.intersectionObserver?.observe(element);\n    this.listeners.set(element, onIntersection);\n  };\n\n  unobserve = (element: HTMLElement) => {\n    this.intersectionObserver?.unobserve(element);\n    this.listeners.delete(element);\n  };\n\n  private createObserver = () => {\n    if (this.isSupported() && !this.intersectionObserver) {\n      this.intersectionObserver = new IntersectionObserver(this.handleIntersection);\n    }\n  };\n\n  private handleIntersection = (entries: IntersectionObserverEntry[]) => {\n    for (const entry of entries) {\n      this.listeners.get(entry.target as HTMLElement)?.(entry);\n    }\n  };\n}\n\nexport const HMSIntersectionObserver = new HMSIntersectionObserverWrapper();\n", "import HMSLogger from './logger';\nimport { isBrowser } from './support';\nimport { debounce } from './timer-utils';\n\nexport interface HMSResizeObserverCallback {\n  (entry: ResizeObserverEntry): void;\n}\n\n/**\n * This is a wrapper around ResizeObserver which will call the callback passed\n * for an element while observing, only when that element is intersecting\n */\nexport class HMSResizeObserverWrapper {\n  private resizeObserver?: ResizeObserver;\n  private readonly TAG = '[HMSResizeObserverWrapper]';\n  private listeners = new WeakMap<HTMLElement, HMSResizeObserverCallback>();\n  constructor() {\n    this.createObserver();\n  }\n\n  isSupported() {\n    const isSupported = isBrowser && typeof window.ResizeObserver !== 'undefined';\n    if (!isSupported) {\n      HMSLogger.w(this.TAG, 'Resize Observer is not supported');\n    }\n    return isSupported;\n  }\n\n  observe = (\n    element: HTMLElement,\n    onResize: HMSResizeObserverCallback,\n    options: ResizeObserverOptions = { box: 'border-box' },\n  ) => {\n    this.createObserver();\n    // unobserve before observing the element\n    this.unobserve(element);\n    this.resizeObserver?.observe(element, options);\n    this.listeners.set(element, onResize);\n  };\n\n  unobserve = (element: HTMLElement) => {\n    this.resizeObserver?.unobserve(element);\n    this.listeners.delete(element);\n  };\n\n  private createObserver = () => {\n    if (this.isSupported() && !this.resizeObserver) {\n      this.resizeObserver = new ResizeObserver(debounce(this.handleResize, 300));\n    }\n  };\n\n  private handleResize = (entries: ResizeObserverEntry[]) => {\n    for (const entry of entries) {\n      this.listeners.get(entry.target as HTMLElement)?.(entry);\n    }\n  };\n}\n\nexport const HMSResizeObserver = new HMSResizeObserverWrapper();\n", "import { HMSPluginSupportResult } from '../audio';\n\n/**\n * A plugin implementing this interface can be registered with HMSLocalVideoTrack to transform, process or\n * analyze the local video track.These can include applications like video filters, virtual background, live\n * analysis of video etc. The below functions are required for the sdk to properly use the plugin, usually\n * the plugin would also be exposing some public functions of its own for the UI to control its working.\n */\nexport interface HMSVideoPlugin {\n  /**\n   * The name is meant to uniquely specify a plugin instance. This will be used to track number of plugins\n   * added to the track, and same name won't be allowed twice.\n   */\n  getName(): string;\n\n  /**\n   * This function will be called before the call to init, it is used to check whether the plugin supports current\n   * OS and device or not. An error will be thrown back to the user if they try to use an unsupported plugin.\n   */\n  checkSupport(): HMSPluginSupportResult;\n\n  /**\n   * @deprecated. Will be deleted in future updates. Use checkSupport instead.\n   */\n  isSupported(): boolean;\n\n  /**\n   * This function will be called in the beginning for initialization which may include tasks like setting up\n   * variables, loading ML models etc. This can be used by a plugin to ensure it's prepared at the time\n   * processVideoFrame is called.\n   */\n  init(): Promise<void>;\n\n  /**\n   * @see HMSVideoPluginType\n   */\n  getPluginType(): HMSVideoPluginType;\n\n  getContextType?(): HMSVideoPluginCanvasContextType;\n\n  /**\n   * This function will be called by the SDK for every video frame which the plugin needs to process.\n   * PluginFrameRate - the rate at which the plugin is expected to process the video frames. This is not necessarily\n   * equal to the capture frame rate. The user can specify this rate, and the sdk might also change it on basis of\n   * device type, or CPU usage.\n   * For an analyzing plugin, the below function will be called at plugin framerate.\n   * For a transforming plugin, the sdk will pass in the input and output at real frame rate with an additional boolean\n   * pass. The expectation is that the plugin should use results of previous runs instead of doing a complex processing\n   * again when pass is set to true. This helps in maintaining the framerate of the video as well as bringing down\n   * CPU usage in case of complex processing.\n   * @param input input canvas containing the input frame\n   * @param output the output canvas which should contain the output frame\n   * @param skipProcessing use results from previous run if true\n   */\n  processVideoFrame(\n    input: HTMLCanvasElement,\n    output?: HTMLCanvasElement,\n    skipProcessing?: boolean,\n  ): Promise<void> | void;\n\n  /**\n   * the plugin can use this function to dispose off its resources. It'll be called when the processor instance is\n   * no longer needed at the end.\n   */\n  stop(): void;\n}\n\n/**\n * Specifies the type of the plugin a transforming plugin will get an output canvas to give the resulting\n * transformation. While an analyzing plugin will only be passed the input canvas.\n */\nexport enum HMSVideoPluginType {\n  TRANSFORM = 'TRANSFORM',\n  ANALYZE = 'ANALYZE',\n}\n\nexport enum HMSVideoPluginCanvasContextType {\n  '2D' = '2d',\n  WEBGL = 'webgl',\n  'WEBGL2' = 'webgl2',\n}\n", "export class RunningAverage {\n  private total = 0;\n  private count = 0;\n\n  add(item: number) {\n    this.count++;\n    this.total += item;\n  }\n\n  getAvg(): number {\n    return Math.floor(this.total / this.count);\n  }\n\n  reset() {\n    this.total = 0;\n    this.count = 0;\n  }\n}\n", "import MediaPluginsAnalyticsFactory from '../../analytics/MediaPluginsAnalyticsFactory';\nimport { ErrorFactory } from '../../error/ErrorFactory';\nimport { HMSAction } from '../../error/HMSAction';\nimport { HMSException } from '../../error/HMSException';\nimport { EventBus } from '../../events/EventBus';\nimport HMSLogger from '../../utils/logger';\nimport { RunningAverage } from '../../utils/math';\n\nexport class VideoPluginsAnalytics {\n  private readonly TAG = '[VideoPluginsAnalytics]';\n  private readonly initTime: Record<string, number>;\n  private readonly addedTimestamps: Record<string, number>;\n  private readonly preProcessingAvgs: RunningAverage;\n  private readonly processingAvgs: Record<string, RunningAverage>;\n  private readonly pluginAdded: Record<string, boolean>;\n  private readonly pluginInputFrameRate: Record<string, number>;\n  private readonly pluginFrameRate: Record<string, number>;\n\n  constructor(private eventBus: EventBus) {\n    this.initTime = {};\n    this.preProcessingAvgs = new RunningAverage();\n    this.addedTimestamps = {};\n    this.processingAvgs = {};\n    this.pluginAdded = {};\n    this.pluginInputFrameRate = {};\n    this.pluginFrameRate = {};\n  }\n\n  added(name: string, inputFrameRate?: number, pluginFrameRate?: number) {\n    this.pluginAdded[name] = true;\n    this.addedTimestamps[name] = Date.now();\n    this.initTime[name] = 0;\n    this.processingAvgs[name] = new RunningAverage();\n    if (inputFrameRate) {\n      this.pluginInputFrameRate[name] = inputFrameRate;\n      this.pluginFrameRate[name] = pluginFrameRate || inputFrameRate;\n    }\n    this.eventBus.analytics.publish(MediaPluginsAnalyticsFactory.added(name, this.addedTimestamps[name]));\n  }\n\n  removed(name: string) {\n    //send stats\n    if (this.pluginAdded[name]) {\n      const stats = {\n        pluginName: name,\n        // duration in seconds\n        duration: Math.floor((Date.now() - this.addedTimestamps[name]) / 1000),\n        loadTime: this.initTime[name],\n        avgPreProcessingTime: this.preProcessingAvgs.getAvg(), //Do we need this in stat not plugin specific\n        avgProcessingTime: this.processingAvgs[name]?.getAvg(),\n        inputFrameRate: this.pluginInputFrameRate[name],\n        pluginFrameRate: this.pluginFrameRate[name],\n      };\n      //send stats\n      this.eventBus.analytics.publish(MediaPluginsAnalyticsFactory.stats(stats));\n      //clean the plugin details\n      this.clean(name);\n    }\n  }\n\n  failure(name: string, error: HMSException) {\n    // send failure event\n    if (this.pluginAdded[name]) {\n      this.eventBus.analytics.publish(MediaPluginsAnalyticsFactory.failure(name, error));\n      //clean the plugin details\n      this.clean(name);\n    }\n  }\n\n  async initWithTime<T>(name: string, initFn: () => Promise<T>) {\n    if (this.initTime[name]) {\n      HMSLogger.i(this.TAG, `Plugin Already loaded ${name}, time it took: ${this.initTime[name]}`);\n      return;\n    }\n    let time: number | undefined = undefined;\n    try {\n      time = await this.timeInMs(initFn);\n      HMSLogger.i(this.TAG, `Time taken for Plugin ${name} initialization : ${time}`);\n    } catch (e) {\n      //Failed during initialization of plugin(model loading etc...)\n      const err = ErrorFactory.MediaPluginErrors.InitFailed(\n        HMSAction.VIDEO_PLUGINS,\n        `failed during initialization of plugin${(e as Error).message || e}`,\n      );\n      HMSLogger.e(this.TAG, err);\n      this.failure(name, err);\n      throw err;\n    }\n    if (time) {\n      this.initTime[name] = time;\n    }\n  }\n\n  async preProcessWithTime<T>(preProcessFn: () => Promise<T>) {\n    //TODO: check if it is required to maintain and shall we handle preprocess failures\n    const time = await this.timeInMs(preProcessFn);\n    this.preProcessingAvgs.add(time);\n  }\n\n  async processWithTime<T>(name: string, processFn: () => Promise<T>) {\n    let time: number | undefined = undefined;\n    try {\n      time = await this.timeInMs(processFn);\n    } catch (e) {\n      //Failed during processing of plugin\n      const err = ErrorFactory.MediaPluginErrors.ProcessingFailed(\n        HMSAction.VIDEO_PLUGINS,\n        `Failed during processing of plugin${(e as Error).message || e}`,\n      );\n      HMSLogger.e(this.TAG, err);\n      this.failure(name, err);\n      throw err;\n    }\n    if (time) {\n      this.processingAvgs[name]?.add(time);\n    }\n  }\n\n  private async timeInMs<T>(fn: () => Promise<T>): Promise<number> {\n    const start = Date.now();\n    await fn();\n    return Math.floor(Date.now() - start);\n  }\n\n  private clean(name: string) {\n    delete this.addedTimestamps[name];\n    delete this.initTime[name];\n    delete this.processingAvgs[name];\n    delete this.pluginAdded[name];\n    delete this.pluginInputFrameRate[name];\n    delete this.pluginFrameRate[name];\n  }\n}\n", "/* eslint-disable complexity */\nimport { HMSVideoPlugin, HMSVideoPluginCanvasContextType, HMSVideoPluginType } from './HMSVideoPlugin';\nimport { VideoPluginsAnalytics } from './VideoPluginsAnalytics';\nimport { ErrorFactory } from '../../error/ErrorFactory';\nimport { HMSAction } from '../../error/HMSAction';\nimport { EventBus } from '../../events/EventBus';\nimport { HMSLocalVideoTrack } from '../../media/tracks';\nimport HMSLogger from '../../utils/logger';\nimport { reusableWorker, workerSleep } from '../../utils/timer-utils';\nimport { HMSPluginUnsupportedTypes } from '../audio';\n\nconst DEFAULT_FRAME_RATE = 24;\nconst DEFAULT_WIDTH = 320;\nconst DEFAULT_HEIGHT = 240;\n\ninterface CanvasElement extends HTMLCanvasElement {\n  captureStream(frameRate?: number): MediaStream;\n}\n\n/**\n * This class manages applying different plugins on a local video track. Plugins which need to modify the video\n * are called in the order they were added. Plugins which do not need to modify the video frames are called\n * with the original input.\n *\n * Concepts -\n * Video Plugin - A module which can take in input video painted on a canvas, do some processing on it and optionally\n * render its output on a passed in output canvas which will be shown in the UI.\n *\n * frameRate - the frame rate of the input video as present in track.getSettings, this is the rate at which new frames\n * are being produced and the rate we need to maintain in output as well.\n *\n * pluginFrameRate - this is the rate at which the plugin is supposed to do its processing. The processing can be an\n * expensive operation and can result in high usage of resources like CPU. This rate would usually be lower than the\n * real frame rate.\n *\n * pluginsLoop - a loop is run at framerate in this class, on each loop if the original track is unmuted all added\n * plugins are called one by one in the order they were called.\n *\n * @see HMSVideoPlugin\n */\nexport class HMSVideoPluginsManager {\n  private readonly TAG = '[VideoPluginsManager]';\n\n  /**\n   * plugins loop is the loop in which all plugins are applied\n   */\n  private pluginsLoopRunning = false;\n  private pluginsLoopState: 'paused' | 'running' = 'paused';\n  private readonly hmsTrack: HMSLocalVideoTrack;\n  readonly pluginsMap: Map<string, HMSVideoPlugin>; // plugin names to their instance mapping\n  private inputVideo?: HTMLVideoElement;\n  private inputCanvas?: CanvasElement;\n  private outputCanvas?: CanvasElement;\n  private outputTrack?: MediaStreamTrack;\n  private analytics: VideoPluginsAnalytics;\n  private pluginAddInProgress = false;\n  private pluginNumFramesToSkip: Record<string, number>;\n  private pluginNumFramesSkipped: Record<string, number>;\n  private canvases: Array<CanvasElement>; //array of canvases to store intermediate result\n  private reusableWorker = reusableWorker();\n\n  constructor(track: HMSLocalVideoTrack, eventBus: EventBus) {\n    this.hmsTrack = track;\n    this.pluginsMap = new Map();\n    this.pluginNumFramesToSkip = {};\n    this.pluginNumFramesSkipped = {};\n    this.analytics = new VideoPluginsAnalytics(eventBus);\n    this.canvases = new Array<CanvasElement>();\n  }\n\n  getPlugins(): string[] {\n    return Array.from(this.pluginsMap.keys());\n  }\n\n  /**\n   * @param plugin\n   * @param pluginFrameRate\n   */\n  async addPlugin(plugin: HMSVideoPlugin, pluginFrameRate?: number) {\n    if (this.pluginAddInProgress) {\n      const name = plugin.getName?.();\n      if (!name || name === '') {\n        HMSLogger.w('no name provided by the plugin');\n        return;\n      }\n\n      const err = ErrorFactory.MediaPluginErrors.AddAlreadyInProgress(\n        HMSAction.VIDEO_PLUGINS,\n        'Add Plugin is already in Progress',\n      );\n      this.analytics.failure(name, err);\n\n      HMSLogger.w(\"can't add another plugin when previous add is in progress\");\n      throw err;\n    }\n\n    this.pluginAddInProgress = true;\n\n    try {\n      await this.addPluginInternal(plugin, pluginFrameRate);\n    } finally {\n      this.pluginAddInProgress = false;\n    }\n  }\n\n  private async addPluginInternal(plugin: HMSVideoPlugin, pluginFrameRate?: number) {\n    const name = plugin.getName?.();\n    if (!name || name === '') {\n      HMSLogger.w('no name provided by the plugin');\n      return;\n    }\n    if (this.pluginsMap.has(name)) {\n      HMSLogger.w(this.TAG, `plugin - ${plugin.getName()} already added.`);\n      return;\n    }\n    //TODO: assuming this inputFrameRate from getMediaTrackSettings will not change once set\n    //TODO: even if it changes will not have the info/params to know the change\n    const inputFrameRate = this.hmsTrack.getMediaTrackSettings().frameRate || DEFAULT_FRAME_RATE;\n\n    let numFramesToSkip = 0;\n    if (pluginFrameRate && pluginFrameRate > 0) {\n      HMSLogger.i(this.TAG, `adding plugin ${plugin.getName()} with framerate ${pluginFrameRate}`);\n      if (pluginFrameRate < inputFrameRate) {\n        numFramesToSkip = Math.ceil(inputFrameRate / pluginFrameRate) - 1;\n      }\n      this.analytics.added(name, inputFrameRate, pluginFrameRate);\n    } else {\n      HMSLogger.i(this.TAG, `adding plugin ${plugin.getName()}`);\n      this.analytics.added(name, inputFrameRate);\n    }\n\n    HMSLogger.i(this.TAG, 'numFrames to skip processing', numFramesToSkip);\n    this.pluginNumFramesToSkip[name] = numFramesToSkip;\n    this.pluginNumFramesSkipped[name] = numFramesToSkip;\n\n    this.validateAndThrow(name, plugin);\n\n    try {\n      await this.analytics.initWithTime(name, async () => await plugin.init());\n      this.pluginsMap.set(name, plugin);\n      // add new canvases according to new added plugins\n      if (this.pluginsMap.size + 1 > this.canvases.length) {\n        for (let i = this.canvases.length; i <= this.pluginsMap.size; i++) {\n          this.canvases[i] = document.createElement('canvas') as CanvasElement;\n        }\n      }\n      await this.startPluginsLoop(plugin.getContextType?.());\n    } catch (err) {\n      HMSLogger.e(this.TAG, 'failed to add plugin', err);\n      await this.removePlugin(plugin);\n      throw err;\n    }\n  }\n\n  validatePlugin(plugin: HMSVideoPlugin) {\n    return plugin.checkSupport();\n  }\n\n  validateAndThrow(name: string, plugin: HMSVideoPlugin) {\n    const result = this.validatePlugin(plugin);\n    if (result.isSupported) {\n      HMSLogger.i(this.TAG, `plugin is supported,- ${plugin.getName()}`);\n    } else {\n      let error;\n      switch (result.errType) {\n        case HMSPluginUnsupportedTypes.PLATFORM_NOT_SUPPORTED:\n          error = ErrorFactory.MediaPluginErrors.PlatformNotSupported(\n            HMSAction.VIDEO_PLUGINS,\n            'platform not supported, see docs',\n          );\n          this.analytics.failure(name, error);\n          throw error;\n        case HMSPluginUnsupportedTypes.DEVICE_NOT_SUPPORTED:\n          error = ErrorFactory.MediaPluginErrors.DeviceNotSupported(\n            HMSAction.VIDEO_PLUGINS,\n            'video device not supported, see docs',\n          );\n          this.analytics.failure(name, error);\n          throw error;\n      }\n    }\n  }\n\n  async removePlugin(plugin: HMSVideoPlugin) {\n    const name = plugin.getName();\n    if (!this.pluginsMap.get(name)) {\n      HMSLogger.w(this.TAG, `plugin - ${name} not found to remove.`);\n      return;\n    }\n    HMSLogger.i(this.TAG, `removing plugin ${name}`);\n    this.removePluginEntry(name);\n    if (this.pluginsMap.size === 0) {\n      HMSLogger.i(this.TAG, `No plugins left, stopping plugins loop`);\n      await this.stopPluginsLoop();\n    }\n    plugin.stop();\n    this.analytics.removed(name);\n  }\n\n  removePluginEntry(name: string) {\n    this.pluginsMap.delete(name);\n    if (this.pluginNumFramesToSkip[name]) {\n      delete this.pluginNumFramesToSkip[name];\n    }\n    if (this.pluginNumFramesSkipped[name]) {\n      delete this.pluginNumFramesSkipped[name];\n    }\n  }\n\n  /**\n   * when video is unmuted it takes some time for all the plugins to be re run and an output stream to be\n   * produced. It can await on this function to confirm and tell the new unmuted state.\n   * If this is not awaited on video will freeze with a frame from past run.\n   */\n  async waitForRestart() {\n    if (!this.pluginsLoopRunning || this.pluginsLoopState === 'running') {\n      return;\n    }\n    while (this.pluginsLoopState === 'paused') {\n      await workerSleep(100);\n    }\n  }\n\n  /**\n   * remove every plugin one by one\n   */\n  async cleanup() {\n    for (const plugin of this.pluginsMap.values()) {\n      await this.removePlugin(plugin);\n    }\n    // memory cleanup\n    this.outputTrack?.stop();\n  }\n\n  private initElementsAndStream(contextType?: HMSVideoPluginCanvasContextType) {\n    if (!this.inputCanvas) {\n      this.inputCanvas = document.createElement('canvas') as CanvasElement;\n    }\n    this.outputCanvas = document.createElement('canvas') as CanvasElement;\n    if (!this.inputVideo) {\n      this.inputVideo = document.createElement('video');\n    }\n    // FF issue https://bugzilla.mozilla.org/show_bug.cgi?id=1388974\n    this.inputCanvas.getContext('2d');\n    this.outputCanvas.getContext(contextType || HMSVideoPluginCanvasContextType['2D']);\n    // capture stream automatically uses the framerate at which the output canvas is changing\n    const outputStream = this.outputCanvas.captureStream();\n    this.outputTrack = outputStream.getVideoTracks()[0];\n  }\n\n  private async startPluginsLoop(contextType?: HMSVideoPluginCanvasContextType) {\n    if (this.pluginsLoopRunning) {\n      return;\n    }\n    this.initElementsAndStream(contextType);\n    this.pluginsLoopRunning = true;\n    try {\n      await this.hmsTrack.setProcessedTrack(this.outputTrack);\n    } catch (err) {\n      this.pluginsLoopRunning = false;\n      HMSLogger.e(this.TAG, 'error in setting processed track', err);\n      throw err;\n    }\n    // can't await on pluginsLoop as it'll run for a long long time\n    this.pluginsLoop().then(() => {\n      HMSLogger.d(this.TAG, 'processLoop stopped');\n    });\n  }\n\n  private async stopPluginsLoop() {\n    this.pluginsLoopRunning = false;\n    await this.hmsTrack.setProcessedTrack(undefined);\n    this.resetCanvases();\n    this.outputTrack?.stop();\n    if (this.inputVideo) {\n      this.inputVideo.srcObject = null;\n      this.inputVideo = undefined;\n    }\n  }\n\n  private async pluginsLoop() {\n    while (this.pluginsLoopRunning) {\n      const inputFrameRate = this.hmsTrack.getMediaTrackSettings().frameRate || DEFAULT_FRAME_RATE;\n      const sleepTimeMs = Math.floor(1000 / inputFrameRate);\n      if (!this.hmsTrack.enabled || this.hmsTrack.nativeTrack.readyState === 'ended') {\n        if (this.pluginsLoopState === 'running') {\n          // mute just happened, reset canvases to black so even if it is sent to remote, it\n          // is a black screen instead of a stucked frame from previous run\n          this.resetCanvases();\n        }\n        this.pluginsLoopState = 'paused';\n        await this.reusableWorker.sleep(sleepTimeMs);\n        continue;\n      }\n      let processingTime = 0;\n      try {\n        await this.analytics.preProcessWithTime(async () => await this.doPreProcessing());\n        const start = Date.now();\n        await this.processFramesThroughPlugins();\n        processingTime = Math.floor(Date.now() - start);\n        if (processingTime > sleepTimeMs) {\n          processingTime = sleepTimeMs;\n        }\n      } catch (err) {\n        // TODO: handle failures properly, detect which plugin failed, stop it and notify back to the UI\n        HMSLogger.e(this.TAG, 'error in plugins loop', err);\n      }\n      this.pluginsLoopState = 'running';\n      // take into account processing time to decide time to wait for the next loop\n      await this.reusableWorker.sleep(sleepTimeMs - processingTime);\n    }\n  }\n\n  private async doPreProcessing() {\n    await this.addTrackToVideo(); // ensure current native track is playing in video\n    await this.updateInputCanvas(); // put the latest video frame on input canvas\n  }\n\n  /**\n   * pass the input canvas through all plugins in a loop\n   * @private\n   */\n  private async processFramesThroughPlugins() {\n    this.canvases[0] = this.inputCanvas!;\n    let i = 0;\n    for (const plugin of this.pluginsMap.values()) {\n      const name = plugin.getName();\n      if (!plugin) {\n        continue;\n      }\n      try {\n        const skipProcessing = this.checkIfSkipRequired(name);\n\n        if (plugin.getPluginType() === HMSVideoPluginType.TRANSFORM) {\n          const process = async (input: CanvasElement, output: CanvasElement) => {\n            try {\n              await plugin.processVideoFrame(input, output, skipProcessing);\n            } catch (err) {\n              HMSLogger.e(this.TAG, `error in processing plugin ${name}`, err);\n            }\n          };\n          if (!skipProcessing) {\n            const currentCanvas = this.canvases[i];\n            const nextCanvas = this.canvases[i + 1];\n            if (i === this.pluginsMap.size - 1) {\n              await this.analytics.processWithTime(name, async () => process(currentCanvas, this.outputCanvas!));\n            } else {\n              await this.analytics.processWithTime(name, async () => process(currentCanvas, nextCanvas));\n            }\n          } else {\n            if (i === this.pluginsMap.size - 1) {\n              await process(this.canvases[i], this.outputCanvas!);\n            } else {\n              await process(this.canvases[i], this.canvases[i + 1]);\n            }\n          }\n        } else if (plugin.getPluginType() === HMSVideoPluginType.ANALYZE && !skipProcessing) {\n          // there is no need to await for this case\n          await this.analytics.processWithTime(name, async () => await plugin.processVideoFrame(this.inputCanvas!));\n        }\n      } catch (err) {\n        //TODO error happened on processing of plugin notify UI\n        HMSLogger.e(this.TAG, `error in processing plugin ${name}`, err);\n        //remove plugin from loop and stop analytics for it\n        await this.removePlugin(plugin);\n      }\n      i++;\n    }\n  }\n\n  /**\n   * add the current native track to the inputVideoElement if it's not already added.\n   * @private\n   */\n  private async addTrackToVideo() {\n    if (!this.inputVideo) {\n      return;\n    }\n    const srcObject = this.inputVideo.srcObject;\n    if (srcObject !== null && srcObject instanceof MediaStream) {\n      const existingTrackID = srcObject.getVideoTracks()[0]?.id;\n      if (existingTrackID === this.hmsTrack.nativeTrack.id) {\n        // it's already attached\n        return;\n      }\n    }\n    this.inputVideo.pause();\n    this.inputVideo.srcObject = new MediaStream([this.hmsTrack.nativeTrack]);\n    this.inputVideo.muted = true;\n    this.inputVideo.playsInline = true;\n    await this.inputVideo.play();\n  }\n\n  /**\n   * get the new video frame from input video element and put it on canvas\n   * @private\n   */\n  private async updateInputCanvas() {\n    if (!this.inputCanvas || !this.inputVideo) {\n      return;\n    }\n    const { width = DEFAULT_WIDTH, height = DEFAULT_HEIGHT } = this.hmsTrack.getMediaTrackSettings();\n    // TODO: should we reduce height/width to optimize?\n    if (this.inputCanvas.height !== height) {\n      this.inputCanvas.height = height;\n    }\n    if (this.inputCanvas.width !== width) {\n      this.inputCanvas.width = width;\n    }\n    const ctx = this.inputCanvas.getContext('2d');\n    ctx!.drawImage(this.inputVideo, 0, 0, width, height);\n  }\n\n  private resetCanvases() {\n    if (!this.outputCanvas || !this.inputCanvas) {\n      return;\n    }\n    const inputCtx = this.inputCanvas.getContext('2d');\n    if (inputCtx) {\n      inputCtx.fillStyle = `rgb(0, 0, 0)`;\n      inputCtx.fillRect(0, 0, this.outputCanvas.width, this.outputCanvas.height);\n    }\n    this.canvases = [];\n  }\n\n  /**\n    N = ceil(inputFrameRate/pluginFrameRate) - 1\n    N = this.pluginNumFramesToSkip[name] = frames to skip for every processed frame\n    all the frames we are skipping are using the previous frame output\n   **/\n  private checkIfSkipRequired(name: string) {\n    let skip = false;\n\n    if (this.pluginNumFramesSkipped[name] < this.pluginNumFramesToSkip[name]) {\n      this.pluginNumFramesSkipped[name]++;\n      skip = true;\n    } else {\n      skip = false;\n      this.pluginNumFramesSkipped[name] = 0;\n    }\n\n    return skip;\n  }\n}\n", "import { HMSMediaStreamPlugin } from './HMSMediaStreamPlugin';\nimport { VideoPluginsAnalytics } from './VideoPluginsAnalytics';\nimport { EventBus } from '../../events/EventBus';\nimport { HMSException } from '../../internal';\nimport Room from '../../sdk/models/HMSRoom';\nimport HMSLogger from '../../utils/logger';\n\nexport class HMSMediaStreamPluginsManager {\n  private readonly TAG = '[MediaStreamPluginsManager]';\n  private analytics: VideoPluginsAnalytics;\n  readonly plugins: Set<HMSMediaStreamPlugin>;\n  private room?: Room;\n\n  constructor(eventBus: EventBus, room?: Room) {\n    this.plugins = new Set<HMSMediaStreamPlugin>();\n    this.analytics = new VideoPluginsAnalytics(eventBus);\n    this.room = room;\n  }\n\n  addPlugins(plugins: HMSMediaStreamPlugin[]): void {\n    plugins.forEach(plugin => {\n      switch (plugin.getName()) {\n        case 'HMSEffectsPlugin':\n          if (!this.room?.isEffectsEnabled) {\n            const errorMessage = 'Effects Virtual Background is not enabled for this room';\n            if (this.plugins.size === 0) {\n              throw Error(errorMessage);\n            } else {\n              HMSLogger.w(this.TAG, errorMessage);\n              return;\n            }\n          }\n          break;\n        default:\n      }\n      this.plugins.add(plugin);\n    });\n  }\n\n  removePlugins(plugins: HMSMediaStreamPlugin[]) {\n    plugins.forEach(plugin => {\n      plugin.stop();\n      this.analytics.removed(plugin.getName());\n      this.plugins.delete(plugin);\n    });\n  }\n\n  applyPlugins(inputStream: MediaStream): MediaStream {\n    let processedStream = inputStream;\n    for (const plugin of this.plugins) {\n      const pluginName = plugin.getName();\n      try {\n        processedStream = plugin.apply(processedStream);\n        this.analytics.added(pluginName);\n      } catch (e) {\n        this.analytics.failure(pluginName, e as HMSException);\n        HMSLogger.e('Could not apply plugin', e, pluginName);\n      }\n    }\n    return processedStream;\n  }\n\n  getPlugins(): string[] {\n    return Array.from(this.plugins).map(plugin => plugin.getName());\n  }\n}\n", "import { v4 as uuid } from 'uuid';\nimport { Store } from './store';\nimport AnalyticsEventFactory from '../analytics/AnalyticsEventFactory';\nimport { AnalyticsTimer, TimedEvent } from '../analytics/AnalyticsTimer';\nimport { DeviceManager } from '../device-manager';\nimport { ErrorCodes } from '../error/ErrorCodes';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { HMSException } from '../error/HMSException';\nimport { BuildGetMediaError, HMSGetMediaActions } from '../error/utils';\nimport { EventBus } from '../events/EventBus';\nimport {\n  HMSAudioCodec,\n  HMSAudioMode,\n  HMSScreenShareConfig,\n  HMSVideoCodec,\n  ScreenCaptureHandleConfig,\n} from '../interfaces';\nimport InitialSettings from '../interfaces/settings';\nimport { HMSLocalAudioTrack, HMSLocalTrack, HMSLocalVideoTrack, HMSTrackType } from '../internal';\nimport {\n  HMSAudioTrackSettings,\n  HMSAudioTrackSettingsBuilder,\n  HMSTrackSettings,\n  HMSTrackSettingsBuilder,\n  HMSVideoTrackSettings,\n  HMSVideoTrackSettingsBuilder,\n} from '../media/settings';\nimport { HMSLocalStream } from '../media/streams/HMSLocalStream';\nimport ITransportObserver from '../transport/ITransportObserver';\nimport HMSLogger from '../utils/logger';\nimport { HMSAudioContextHandler } from '../utils/media';\n\nconst defaultSettings = {\n  isAudioMuted: false,\n  isVideoMuted: false,\n  audioInputDeviceId: 'default',\n  audioOutputDeviceId: 'default',\n  videoDeviceId: 'default',\n  audioMode: HMSAudioMode.VOICE,\n};\ntype IFetchTrackOptions = boolean | 'empty';\ninterface IFetchAVTrackOptions {\n  audio: IFetchTrackOptions;\n  video: IFetchTrackOptions;\n}\n\nlet blankCanvas: HTMLCanvasElement | undefined;\nlet intervalID: ReturnType<typeof setInterval> | undefined;\n\nexport class LocalTrackManager {\n  readonly TAG: string = '[LocalTrackManager]';\n  private captureHandleIdentifier?: string;\n\n  constructor(\n    private store: Store,\n    private observer: ITransportObserver,\n    private deviceManager: DeviceManager,\n    private eventBus: EventBus,\n    private analyticsTimer: AnalyticsTimer,\n  ) {\n    this.setScreenCaptureHandleConfig();\n  }\n\n  // eslint-disable-next-line complexity\n  async getTracksToPublish(initialSettings: InitialSettings = defaultSettings): Promise<HMSLocalTrack[]> {\n    const trackSettings = this.getAVTrackSettings(initialSettings);\n    if (!trackSettings) {\n      return [];\n    }\n    const canPublishAudio = !!trackSettings.audio;\n    const canPublishVideo = !!trackSettings.video;\n    let tracksToPublish: Array<HMSLocalTrack> = [];\n    const { videoTrack, audioTrack } = await this.updateCurrentLocalTrackSettings(trackSettings);\n    const localStream = (videoTrack?.stream || audioTrack?.stream) as HMSLocalStream | undefined;\n    // The track gets added to the store only after it is published.\n    const isVideoTrackPublished = Boolean(videoTrack && this.store.getTrackById(videoTrack.trackId));\n    const isAudioTrackPublished = Boolean(audioTrack && this.store.getTrackById(audioTrack.trackId));\n\n    if (isVideoTrackPublished && isAudioTrackPublished) {\n      // there is nothing to publish\n      return [];\n    }\n\n    const fetchTrackOptions: IFetchAVTrackOptions = {\n      audio: canPublishAudio && !audioTrack && (initialSettings.isAudioMuted ? 'empty' : true),\n      video: canPublishVideo && !videoTrack && (initialSettings.isVideoMuted ? 'empty' : true),\n    };\n\n    if (fetchTrackOptions.audio) {\n      this.analyticsTimer.start(TimedEvent.LOCAL_AUDIO_TRACK);\n    }\n    if (fetchTrackOptions.video) {\n      this.analyticsTimer.start(TimedEvent.LOCAL_VIDEO_TRACK);\n    }\n    try {\n      HMSLogger.d(this.TAG, 'Init Local Tracks', { fetchTrackOptions });\n      tracksToPublish = await this.getLocalTracks(fetchTrackOptions, trackSettings, localStream);\n    } catch (error) {\n      tracksToPublish = await this.retryGetLocalTracks(\n        error as HMSException,\n        trackSettings,\n        fetchTrackOptions,\n        localStream,\n      );\n    }\n    if (fetchTrackOptions.audio) {\n      this.analyticsTimer.end(TimedEvent.LOCAL_AUDIO_TRACK);\n    }\n    if (fetchTrackOptions.video) {\n      this.analyticsTimer.end(TimedEvent.LOCAL_VIDEO_TRACK);\n    }\n\n    if (videoTrack && canPublishVideo && !isVideoTrackPublished) {\n      tracksToPublish.push(videoTrack);\n    }\n    if (audioTrack && canPublishAudio && !isAudioTrackPublished) {\n      tracksToPublish.push(audioTrack);\n    }\n    return tracksToPublish;\n  }\n\n  /**\n   * @throws {HMSException}\n   */\n  async getLocalTracks(\n    fetchTrackOptions: IFetchAVTrackOptions = { audio: true, video: true },\n    settings: HMSTrackSettings,\n    localStream?: HMSLocalStream,\n  ): Promise<Array<HMSLocalTrack>> {\n    try {\n      const nativeTracks = await this.getNativeLocalTracks(fetchTrackOptions, settings);\n      return this.createHMSLocalTracks(nativeTracks, settings, localStream);\n    } catch (error) {\n      // TOOD: On OverConstrained error, retry with dropping all constraints.\n      // Just retry getusermedia again - it sometimes work when AbortError or NotFoundError is thrown on a few devices\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.publish({\n          devices: this.deviceManager.getDevices(),\n          error: error as Error,\n          settings,\n        }),\n      );\n      throw error;\n    }\n  }\n\n  /**\n   * @throws {HMSException}\n   */\n  private async getNativeLocalTracks(\n    fetchTrackOptions: IFetchAVTrackOptions = { audio: false, video: false },\n    settings: HMSTrackSettings,\n  ) {\n    const trackSettings = new HMSTrackSettings(\n      fetchTrackOptions.video === true ? settings.video : null,\n      fetchTrackOptions.audio === true ? settings.audio : null,\n      settings.simulcast,\n    );\n    const nativeTracks: MediaStreamTrack[] = [];\n\n    if (trackSettings.audio || trackSettings.video) {\n      nativeTracks.push(...(await this.getAVTracks(trackSettings)));\n    }\n    nativeTracks.push(...this.getEmptyTracks(fetchTrackOptions));\n    return nativeTracks;\n  }\n  private async optimizeScreenShareConstraint(stream: MediaStream, constraints: MediaStreamConstraints) {\n    if (typeof constraints.video === 'boolean' || !constraints.video?.width || !constraints.video?.height) {\n      return;\n    }\n    const publishParams = this.store.getPublishParams();\n    if (!publishParams || !publishParams.allowed?.includes('screen')) {\n      return;\n    }\n    const videoElement = document.createElement('video');\n    videoElement.srcObject = stream;\n    videoElement.addEventListener('loadedmetadata', async () => {\n      const { videoWidth, videoHeight } = videoElement;\n      const screen = publishParams.screen;\n      const pixels = screen.width * screen.height;\n      const actualAspectRatio = videoWidth / videoHeight;\n      const currentAspectRatio = screen.width / screen.height;\n      if (actualAspectRatio > currentAspectRatio) {\n        const videoConstraint = constraints.video as MediaTrackConstraints;\n        const ratio = actualAspectRatio / currentAspectRatio;\n        const sqrt_ratio = Math.sqrt(ratio);\n        if (videoWidth * videoHeight > pixels) {\n          videoConstraint.width = videoWidth / sqrt_ratio;\n          videoConstraint.height = videoHeight / sqrt_ratio;\n        } else {\n          videoConstraint.height = videoHeight * sqrt_ratio;\n          videoConstraint.width = videoWidth * sqrt_ratio;\n        }\n        await stream.getVideoTracks()[0].applyConstraints(videoConstraint);\n      }\n    });\n  }\n  // eslint-disable-next-line complexity\n  async getLocalScreen(partialConfig?: HMSScreenShareConfig, optimise = false) {\n    const config = await this.getOrDefaultScreenshareConfig(partialConfig);\n    const screenSettings = this.getScreenshareSettings(config.videoOnly);\n    const constraints = {\n      video: { ...screenSettings?.video.toConstraints(true), displaySurface: config.displaySurface },\n      preferCurrentTab: config.preferCurrentTab,\n      selfBrowserSurface: config.selfBrowserSurface,\n      surfaceSwitching: config.surfaceSwitching,\n      systemAudio: config.systemAudio,\n    } as MediaStreamConstraints;\n    if (screenSettings?.audio) {\n      const audioConstraints: MediaTrackConstraints = screenSettings?.audio?.toConstraints();\n      // remove advanced constraints as it not supported for screenshare audio\n      delete audioConstraints.advanced;\n      constraints.audio = {\n        ...audioConstraints,\n        autoGainControl: false,\n        noiseSuppression: false,\n        // @ts-ignore\n        googAutoGainControl: false,\n        echoCancellation: false,\n      };\n    } else if (partialConfig?.forceCurrentTab && partialConfig.preferCurrentTab && partialConfig.cropElement) {\n      // only need if crop element with prefer and force current tab\n      constraints.audio = {\n        echoCancellation: true,\n        noiseSuppression: true,\n      };\n    }\n    let stream;\n    try {\n      HMSLogger.d('retrieving screenshare with ', { config }, { constraints });\n      // @ts-ignore [https://github.com/microsoft/TypeScript/issues/33232]\n      stream = (await navigator.mediaDevices.getDisplayMedia(constraints)) as MediaStream;\n      if (optimise) {\n        await this.optimizeScreenShareConstraint(stream, constraints);\n      }\n    } catch (err) {\n      HMSLogger.w(this.TAG, 'error in getting screenshare - ', err);\n      const error = BuildGetMediaError(err as Error, HMSGetMediaActions.SCREEN);\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.publish({\n          error: error as Error,\n          devices: this.deviceManager.getDevices(),\n          settings: new HMSTrackSettings(screenSettings?.video, screenSettings?.audio, false),\n        }),\n      );\n      throw error;\n    }\n\n    const tracks: Array<HMSLocalTrack> = [];\n    const local = new HMSLocalStream(stream);\n    const nativeVideoTrack = stream.getVideoTracks()[0];\n    const videoTrack = new HMSLocalVideoTrack(\n      local,\n      nativeVideoTrack,\n      'screen',\n      this.eventBus,\n      screenSettings?.video,\n      this.store.getRoom(),\n    );\n    videoTrack.setSimulcastDefinitons(this.store.getSimulcastDefinitionsForPeer(this.store.getLocalPeer()!, 'screen'));\n\n    try {\n      const isCurrentTabShared = this.validateCurrentTabCapture(videoTrack, config.forceCurrentTab);\n      videoTrack.isCurrentTab = isCurrentTabShared;\n      await videoTrack.cropTo(config.cropTarget);\n    } catch (err) {\n      stream.getTracks().forEach(track => track.stop());\n      throw err;\n    }\n\n    tracks.push(videoTrack);\n    const nativeAudioTrack = stream.getAudioTracks()[0];\n    if (nativeAudioTrack) {\n      const audioTrack = new HMSLocalAudioTrack(\n        local,\n        nativeAudioTrack,\n        'screen',\n        this.eventBus,\n        screenSettings?.audio,\n        this.store.getRoom(),\n      );\n      tracks.push(audioTrack);\n    }\n\n    HMSLogger.v(this.TAG, 'getLocalScreen', tracks);\n    return tracks;\n  }\n\n  setScreenCaptureHandleConfig(config?: Partial<ScreenCaptureHandleConfig>) {\n    // @ts-ignore\n    if (!navigator.mediaDevices?.setCaptureHandleConfig || this.isInIframe()) {\n      // setCaptureHandleConfig can't be called from within an iframe\n      return;\n    }\n    config = config || {};\n    Object.assign(config, { handle: uuid(), exposeOrigin: false, permittedOrigins: [window.location.origin] });\n    HMSLogger.d('setting capture handle - ', config.handle);\n    // @ts-ignore\n    navigator.mediaDevices.setCaptureHandleConfig(config);\n    this.captureHandleIdentifier = config.handle;\n  }\n\n  validateCurrentTabCapture(track: HMSLocalVideoTrack, forceCurrentTab: boolean): boolean {\n    const trackHandle = track.getCaptureHandle();\n    const isCurrentTabShared = !!(this.captureHandleIdentifier && trackHandle?.handle === this.captureHandleIdentifier);\n    if (forceCurrentTab && !isCurrentTabShared) {\n      HMSLogger.e(this.TAG, 'current tab was not shared with forceCurrentTab as true');\n      throw ErrorFactory.TracksErrors.CurrentTabNotShared();\n    }\n    return isCurrentTabShared;\n  }\n\n  async requestPermissions() {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: true,\n        video: true,\n      });\n      // Stop stream\n      stream.getTracks().forEach(track => track.stop());\n    } catch (error) {\n      HMSLogger.e(this.TAG, error);\n    }\n  }\n\n  static getEmptyVideoTrack(prevTrack?: MediaStreamTrack): MediaStreamTrack {\n    const width = prevTrack?.getSettings()?.width || 320;\n    const height = prevTrack?.getSettings()?.height || 240;\n    const frameRate = 1; // fps TODO: experiment, see if this can be reduced\n    if (!blankCanvas) {\n      blankCanvas = document.createElement('canvas');\n      blankCanvas.width = width;\n      blankCanvas.height = height;\n      blankCanvas.getContext('2d')?.fillRect(0, 0, width, height);\n    }\n    if (!intervalID) {\n      // This is needed to send some data so the track is received on sfu\n      intervalID = setInterval(() => {\n        const ctx = blankCanvas?.getContext('2d');\n        if (ctx) {\n          ctx.fillRect(0, 0, 1, 1);\n        }\n      }, 1000 / frameRate);\n    }\n\n    const stream = blankCanvas.captureStream(frameRate);\n    const emptyTrack = stream.getVideoTracks()[0];\n    emptyTrack.enabled = false;\n    return emptyTrack;\n  }\n\n  static getEmptyAudioTrack(): MediaStreamTrack {\n    const ctx = HMSAudioContextHandler.getAudioContext();\n    const oscillator = ctx.createOscillator();\n    const dst = ctx.createMediaStreamDestination();\n    oscillator.connect(dst);\n    oscillator.start();\n    const emptyTrack = dst.stream.getAudioTracks()[0];\n    emptyTrack.enabled = false;\n    return emptyTrack;\n  }\n\n  static cleanup() {\n    clearInterval(intervalID);\n    intervalID = undefined;\n    blankCanvas = undefined;\n  }\n\n  /**\n   * @throws {HMSException}\n   */\n  private async getAVTracks(settings: HMSTrackSettings): Promise<Array<MediaStreamTrack>> {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: settings.audio ? settings.audio.toConstraints() : false,\n        video: settings.video ? settings.video.toConstraints() : false,\n      });\n\n      return stream.getVideoTracks().concat(stream.getAudioTracks());\n    } catch (error) {\n      await this.deviceManager.init();\n      const videoError = !!(!this.deviceManager.hasWebcamPermission && settings.video);\n      const audioError = !!(!this.deviceManager.hasMicrophonePermission && settings.audio);\n      /**\n       * TODO: Only permission error throws correct device info in error(audio or video or both),\n       * Right now for other errors such as overconstrained error we are unable to get whether audio/video failure.\n       * Fix this by checking the native error message.\n       */\n      const errorType = this.getErrorType(videoError, audioError);\n      throw BuildGetMediaError(error as Error, errorType);\n    }\n  }\n\n  private getAVTrackSettings(initialSettings: InitialSettings): HMSTrackSettings | null {\n    const audioSettings = this.getAudioSettings(initialSettings);\n    const videoSettings = this.getVideoSettings(initialSettings);\n    if (!audioSettings && !videoSettings) {\n      return null;\n    }\n    return new HMSTrackSettingsBuilder().video(videoSettings).audio(audioSettings).build();\n  }\n\n  private isInIframe() {\n    try {\n      return window.self !== window.top;\n    } catch (e) {\n      return true;\n    }\n  }\n\n  // eslint-disable-next-line complexity\n  private async retryGetLocalTracks(\n    error: HMSException,\n    trackSettings: HMSTrackSettings,\n    fetchTrackOptions: IFetchAVTrackOptions,\n    localStream?: HMSLocalStream,\n  ): Promise<Array<HMSLocalTrack>> {\n    if (error instanceof HMSException && error.action === HMSAction.TRACK) {\n      this.observer.onFailure(error);\n\n      const overConstrainedFailure = error.code === ErrorCodes.TracksErrors.OVER_CONSTRAINED;\n      const audioFailure = error.message.includes('audio');\n      const videoFailure = error.message.includes('video');\n      if (overConstrainedFailure) {\n        // TODO: Use this once TODO@L#250 is completed\n        // const newTrackSettings = new HMSTrackSettingsBuilder()\n        //   .video(videoFailure ? new HMSVideoTrackSettings() : trackSettings.video)\n        //   .audio(audioFailure ? new HMSAudioTrackSettings() : trackSettings.audio)\n        //   .build();\n        const newTrackSettings = new HMSTrackSettingsBuilder()\n          .video(new HMSVideoTrackSettings())\n          .audio(new HMSAudioTrackSettings())\n          .build();\n\n        HMSLogger.w(this.TAG, 'Fetch AV Tracks failed with overconstrained error', { fetchTrackOptions }, { error });\n\n        try {\n          // Try get local tracks with no constraints\n          return await this.getLocalTracks(fetchTrackOptions, newTrackSettings, localStream);\n        } catch (error) {\n          /**\n           * This error shouldn't be overconstrained error(as we've dropped all constraints).\n           * If it's an overconstrained error, change error code to avoid recursive loop\n           * Try get local tracks for empty tracks\n           */\n          const nativeError: Error | undefined = error instanceof HMSException ? error.nativeError : (error as Error);\n          let ex = error;\n          if (nativeError?.name === 'OverconstrainedError') {\n            const newError = ErrorFactory.TracksErrors.GenericTrack(\n              HMSAction.TRACK,\n              'Overconstrained error after dropping all constraints',\n            );\n            newError.addNativeError(nativeError);\n            ex = newError;\n          }\n\n          return await this.retryGetLocalTracks(ex as HMSException, trackSettings, fetchTrackOptions, localStream);\n        }\n      }\n\n      fetchTrackOptions.audio = audioFailure ? 'empty' : fetchTrackOptions.audio;\n      fetchTrackOptions.video = videoFailure ? 'empty' : fetchTrackOptions.video;\n      HMSLogger.w(this.TAG, 'Fetch AV Tracks failed', { fetchTrackOptions }, error);\n      try {\n        return await this.getLocalTracks(fetchTrackOptions, trackSettings, localStream);\n      } catch (error) {\n        HMSLogger.w(this.TAG, 'Fetch empty tacks failed', error);\n        fetchTrackOptions.audio = fetchTrackOptions.audio && 'empty';\n        fetchTrackOptions.video = fetchTrackOptions.video && 'empty';\n        this.observer.onFailure(error as HMSException);\n        return await this.getLocalTracks(fetchTrackOptions, trackSettings, localStream);\n      }\n    } else {\n      HMSLogger.w(this.TAG, 'Fetch AV Tracks failed - unknown exception', error);\n      this.observer.onFailure(error);\n      return [];\n    }\n  }\n\n  getErrorType(videoError: boolean, audioError: boolean): HMSGetMediaActions {\n    if (videoError && audioError) {\n      return HMSGetMediaActions.AV;\n    }\n    if (videoError) {\n      return HMSGetMediaActions.VIDEO;\n    }\n    if (audioError) {\n      return HMSGetMediaActions.AUDIO;\n    }\n    return HMSGetMediaActions.UNKNOWN;\n  }\n\n  private getEmptyTracks(fetchTrackOptions: IFetchAVTrackOptions) {\n    const nativeTracks: MediaStreamTrack[] = [];\n    if (fetchTrackOptions.audio === 'empty') {\n      nativeTracks.push(LocalTrackManager.getEmptyAudioTrack());\n    }\n\n    if (fetchTrackOptions.video === 'empty') {\n      nativeTracks.push(LocalTrackManager.getEmptyVideoTrack());\n    }\n    return nativeTracks;\n  }\n\n  private async updateCurrentLocalTrackSettings(trackSettings: HMSTrackSettings | null) {\n    const localTracks = this.store.getLocalPeerTracks();\n    const videoTrack = localTracks.find(t => t.type === HMSTrackType.VIDEO && t.source === 'regular') as\n      | HMSLocalVideoTrack\n      | undefined;\n    const audioTrack = localTracks.find(t => t.type === HMSTrackType.AUDIO && t.source === 'regular') as\n      | HMSLocalAudioTrack\n      | undefined;\n\n    const screenVideoTrack = localTracks.find(t => t.type === HMSTrackType.VIDEO && t.source === 'screen') as\n      | HMSLocalVideoTrack\n      | undefined;\n\n    if (trackSettings?.video) {\n      await videoTrack?.setSettings(trackSettings.video);\n    }\n\n    if (trackSettings?.audio) {\n      await audioTrack?.setSettings(trackSettings.audio);\n    }\n\n    const screenSettings = this.getScreenshareSettings(true);\n    if (screenSettings?.video) {\n      await screenVideoTrack?.setSettings(screenSettings?.video);\n    }\n\n    return { videoTrack, audioTrack };\n  }\n\n  private getAudioSettings(initialSettings: InitialSettings) {\n    const publishParams = this.store.getPublishParams();\n    if (!publishParams || !publishParams.allowed?.includes('audio')) {\n      return null;\n    }\n    const localPeer = this.store.getLocalPeer();\n    const audioTrack = localPeer?.audioTrack;\n    // Get device from the tracks already added in preview\n    const audioDeviceId = audioTrack?.settings.deviceId || initialSettings.audioInputDeviceId;\n\n    return new HMSAudioTrackSettingsBuilder()\n      .codec(publishParams.audio.codec as HMSAudioCodec)\n      .maxBitrate(publishParams.audio.bitRate)\n      .deviceId(audioDeviceId || defaultSettings.audioInputDeviceId)\n      .build();\n  }\n\n  private getVideoSettings(initialSettings: InitialSettings) {\n    const publishParams = this.store.getPublishParams();\n    if (!publishParams || !publishParams.allowed?.includes('video')) {\n      return null;\n    }\n    const localPeer = this.store.getLocalPeer();\n    const videoTrack = localPeer?.videoTrack;\n    // Get device from the tracks already added in preview\n    const videoDeviceId = videoTrack?.settings.deviceId || initialSettings.videoDeviceId;\n    const video = publishParams.video;\n    return new HMSVideoTrackSettingsBuilder()\n      .codec(video.codec as HMSVideoCodec)\n      .maxBitrate(video.bitRate)\n      .maxFramerate(video.frameRate)\n      .setWidth(video.width) // take simulcast width if available\n      .setHeight(video.height) // take simulcast width if available\n      .deviceId(videoDeviceId || defaultSettings.videoDeviceId)\n      .build();\n  }\n\n  private getScreenshareSettings(isVideoOnly = false) {\n    const publishParams = this.store.getPublishParams();\n    if (!publishParams || !publishParams.allowed?.includes('screen')) {\n      return null;\n    }\n    const screen = publishParams.screen;\n    return {\n      video: new HMSVideoTrackSettingsBuilder()\n        // Don't cap maxBitrate for screenshare.\n        // If publish params doesn't have bitRate value - don't set maxBitrate.\n        .maxBitrate(screen.bitRate, false)\n        .codec(screen.codec as HMSVideoCodec)\n        .maxFramerate(screen.frameRate)\n        .setWidth(screen.width)\n        .setHeight(screen.height)\n        .build(),\n      audio: isVideoOnly ? undefined : new HMSAudioTrackSettingsBuilder().build(),\n    };\n  }\n\n  // eslint-disable-next-line complexity\n  private async getOrDefaultScreenshareConfig(partialConfig?: Partial<HMSScreenShareConfig>) {\n    type RequiredConfig = HMSScreenShareConfig &\n      Required<Omit<HMSScreenShareConfig, 'cropTarget' | 'cropElement' | 'displaySurface'>>;\n    const config: RequiredConfig = Object.assign(\n      {\n        videoOnly: false,\n        audioOnly: false,\n        forceCurrentTab: false,\n        preferCurrentTab: false,\n        selfBrowserSurface: 'exclude', // don't give self tab in options\n        surfaceSwitching: 'include', // give option to switch tabs while sharing\n        systemAudio: 'exclude', // system audio share leads to echo in windows\n        displaySurface: 'monitor',\n      },\n      partialConfig || {},\n    );\n    if (config.forceCurrentTab) {\n      config.videoOnly = true; // there will be echo otherwise\n      config.preferCurrentTab = true;\n      config.selfBrowserSurface = 'include';\n      config.surfaceSwitching = 'exclude';\n    }\n    if (config.preferCurrentTab) {\n      config.selfBrowserSurface = 'include';\n      config.displaySurface = undefined; // so the default selected is the current tab\n    }\n    // @ts-ignore\n    if (config.cropElement && window.CropTarget?.fromElement) {\n      // @ts-ignore\n      config.cropTarget = await window.CropTarget.fromElement(config.cropElement);\n    }\n    return config;\n  }\n\n  private createHMSLocalTracks(\n    nativeTracks: MediaStreamTrack[],\n    settings: HMSTrackSettings,\n    localStream?: HMSLocalStream,\n  ) {\n    const nativeVideoTrack = nativeTracks.find(track => track.kind === 'video');\n    const nativeAudioTrack = nativeTracks.find(track => track.kind === 'audio');\n    if (localStream) {\n      nativeTracks.forEach(track => localStream?.nativeStream.addTrack(track));\n    } else {\n      localStream = new HMSLocalStream(new MediaStream(nativeTracks));\n    }\n\n    const tracks: Array<HMSLocalTrack> = [];\n    if (nativeAudioTrack && settings?.audio) {\n      const audioTrack = new HMSLocalAudioTrack(\n        localStream,\n        nativeAudioTrack,\n        'regular',\n        this.eventBus,\n        settings.audio,\n        this.store.getRoom(),\n      );\n      tracks.push(audioTrack);\n    }\n\n    if (nativeVideoTrack && settings?.video) {\n      const videoTrack = new HMSLocalVideoTrack(\n        localStream,\n        nativeVideoTrack,\n        'regular',\n        this.eventBus,\n        settings.video,\n        this.store.getRoom(),\n      );\n      videoTrack.setSimulcastDefinitons(\n        this.store.getSimulcastDefinitionsForPeer(this.store.getLocalPeer()!, 'regular'),\n      );\n      tracks.push(videoTrack);\n    }\n    return tracks;\n  }\n}\n", "import HMSLogger from '../utils/logger';\n\nexport type TimedEventName = 'init' | 'websocket-open' | 'on-policy-change' | 'local-tracks' | 'preview' | 'join';\n\nexport enum TimedEvent {\n  INIT = 'init_response_time',\n  WEBSOCKET_CONNECT = 'ws_connect_time',\n  ON_POLICY_CHANGE = 'on_policy_change_time',\n  LOCAL_AUDIO_TRACK = 'local_audio_track_time',\n  LOCAL_VIDEO_TRACK = 'local_video_track_time',\n  JOIN = 'join_time',\n  PREVIEW = 'preview_time',\n  PEER_LIST = 'peer_list_time',\n  ROOM_STATE = 'room_state_time',\n  JOIN_RESPONSE = 'join_response_time',\n  GET_TOKEN = 'GET_TOKEN',\n}\n\nconst defaultEventNames = [\n  TimedEvent.INIT,\n  TimedEvent.WEBSOCKET_CONNECT,\n  TimedEvent.ON_POLICY_CHANGE,\n  TimedEvent.LOCAL_AUDIO_TRACK,\n  TimedEvent.LOCAL_VIDEO_TRACK,\n  TimedEvent.PEER_LIST,\n  TimedEvent.ROOM_STATE,\n  TimedEvent.JOIN_RESPONSE,\n];\n\nexport class AnalyticsTimer {\n  private eventPerformanceMeasures: Partial<Record<TimedEvent, PerformanceMeasure>> = {};\n\n  start(eventName: TimedEvent) {\n    performance.mark(eventName);\n  }\n\n  end(eventName: TimedEvent) {\n    try {\n      this.eventPerformanceMeasures[eventName] = performance.measure(eventName, eventName);\n      HMSLogger.d('[HMSPerformanceTiming]', eventName, this.eventPerformanceMeasures[eventName]?.duration);\n    } catch (error) {\n      HMSLogger.w('[AnalyticsTimer]', `Error in measuring performance for event ${eventName}`, { error });\n    }\n  }\n\n  getTimeTaken(eventName: TimedEvent) {\n    return this.eventPerformanceMeasures[eventName]?.duration;\n  }\n\n  getTimes(...eventNames: TimedEvent[]) {\n    return [...defaultEventNames, ...eventNames].reduce(\n      (timeObject, eventName) => ({ ...timeObject, [eventName]: this.getTimeTaken(eventName) }),\n      {},\n    );\n  }\n\n  cleanup() {\n    this.eventPerformanceMeasures = {};\n  }\n}\n", "export const RENEGOTIATION_CALLBACK_ID = 'renegotiation-callback-id';\nexport const API_DATA_CHANNEL = 'ion-sfu';\nexport const ANALYTICS_BUFFER_SIZE = 100;\n\n/**\n * Maximum number of retries that transport-layer will try\n * before giving up on the connection and returning a failure\n *\n * Refer https://100ms.atlassian.net/browse/HMS-2369\n */\nexport const MAX_TRANSPORT_RETRIES = 5;\nexport const MAX_TRANSPORT_RETRY_DELAY = 60;\n\nexport const DEFAULT_SIGNAL_PING_TIMEOUT = 12_000;\nexport const DEFAULT_SIGNAL_PING_INTERVAL = 3_000;\nexport const PONG_RESPONSE_TIMES_SIZE = 5;\n\nexport const SUBSCRIBE_ICE_CONNECTION_CALLBACK_ID = 'SUBSCRIBE_ICE_CONNECTION_CALLBACK_ID';\nexport const SUBSCRIBE_TIMEOUT = 60_000;\n\nexport const ICE_DISCONNECTION_TIMEOUT = 5_000;\n\nexport const RTC_STATS_MONITOR_INTERVAL = 1_000;\n\nexport const MAINTAIN_TRACK_HISTORY = false;\n\nexport const CLIENT_ANAYLTICS_PROD_ENDPOINT = 'https://event.100ms.live/v2/client/report';\nexport const CLIENT_ANAYLTICS_QA_ENDPOINT = 'https://event-nonprod.100ms.live/v2/client/report';\nexport const CLIENT_ANAYLTICS_STORAGE_LIMIT = 100;\n\nexport const PUBLISH_STATS_SAMPLE_WINDOW = 30;\nexport const PUBLISH_STATS_PUSH_INTERVAL = 300;\n\nexport const SUBSCRIBE_STATS_SAMPLE_WINDOW = 10;\nexport const SUBSCRIBE_STATS_PUSH_INTERVAL = 60;\n\nexport const MAX_SAFE_INTEGER = Math.pow(2, 31) - 1;\n\nexport const HMSEvents = {\n  DEVICE_CHANGE: 'device-change',\n  LOCAL_AUDIO_ENABLED: 'local-audio-enabled',\n  LOCAL_VIDEO_ENABLED: 'local-video-enabled',\n  LOCAL_VIDEO_UNMUTED_NATIVELY: 'local-video-unmuted-natively',\n  STATS_UPDATE: 'stats-update', // emitted by HMSWebrtcInternals\n  RTC_STATS_UPDATE: 'rtc-stats-update', // emitted by RTCStatsMonitor\n  TRACK_DEGRADED: 'track-degraded',\n  TRACK_RESTORED: 'track-restored',\n  TRACK_AUDIO_LEVEL_UPDATE: 'track-audio-level-update',\n  LOCAL_AUDIO_SILENCE: 'local-audio-silence',\n  ANALYTICS: 'analytics',\n  AUDIO_PLUGIN_FAILED: 'audio-plugin-failed',\n  POLICY_CHANGE: 'policy-change',\n  LOCAL_ROLE_UPDATE: 'local-role-update',\n  AUDIO_TRACK_UPDATE: 'audio-track-update',\n  AUDIO_TRACK_ADDED: 'audio-track-added',\n  AUDIO_TRACK_REMOVED: 'audio-track-removed',\n  AUTOPLAY_ERROR: 'autoplay-error',\n  LEAVE: 'leave',\n};\n\nexport const PROTOCOL_VERSION = '2.5';\n\nexport const PROTOCOL_SPEC = '20240720';\n\nexport const HAND_RAISE_GROUP_NAME = '_handraise';\n\nexport const DEFAULT_PLAYLIST_VIDEO_BITRATE = 1000;\n\nexport const DEFAULT_PLAYLIST_AUDIO_BITRATE = 64;\n\nexport const WHITEBOARD_ORIGIN = 'https://whiteboard.100ms.live';\n\nexport const WHITEBOARD_QA_ORIGIN = 'https://whiteboard-qa.100ms.live';\n", "import { HMSVideoTrack } from './HMSVideoTrack';\nimport { VideoElementManager } from './VideoElementManager';\nimport { VideoTrackLayerUpdate } from '../../connection/channel-messages';\nimport {\n  HMSPreferredSimulcastLayer,\n  HMSSimulcastLayer,\n  HMSSimulcastLayerDefinition,\n} from '../../interfaces/simulcast-layers';\nimport { MAINTAIN_TRACK_HISTORY } from '../../utils/constants';\nimport HMSLogger from '../../utils/logger';\nimport { isEmptyTrack } from '../../utils/track';\nimport { HMSRemoteStream } from '../streams';\n\nexport class HMSRemoteVideoTrack extends HMSVideoTrack {\n  private _degraded = false;\n  private _degradedAt: Date | null = null;\n  private _layerDefinitions: HMSSimulcastLayerDefinition[] = [];\n  private history = new TrackHistory();\n  private preferredLayer: HMSPreferredSimulcastLayer = HMSSimulcastLayer.HIGH;\n  private bizTrackId!: string;\n\n  constructor(stream: HMSRemoteStream, track: MediaStreamTrack, source?: string) {\n    super(stream, track, source);\n    this.setVideoHandler(new VideoElementManager(this));\n  }\n\n  setTrackId(trackId: string) {\n    this.bizTrackId = trackId;\n  }\n\n  get trackId(): string {\n    return this.bizTrackId || super.trackId;\n  }\n\n  public get degraded() {\n    return this._degraded;\n  }\n\n  public get degradedAt() {\n    return this._degradedAt;\n  }\n\n  async setEnabled(value: boolean): Promise<void> {\n    if (value === this.enabled) {\n      return;\n    }\n\n    super.setEnabled(value);\n    this.videoHandler.updateSinks(true);\n  }\n\n  async setPreferredLayer(layer: HMSPreferredSimulcastLayer) {\n    //@ts-ignore\n    if (layer === HMSSimulcastLayer.NONE) {\n      HMSLogger.w(`layer ${HMSSimulcastLayer.NONE} will be ignored`);\n      return;\n    }\n    this.preferredLayer = layer;\n    if (!this.shouldSendVideoLayer(layer, 'preferLayer')) {\n      return;\n    }\n    if (!this.hasSinks()) {\n      HMSLogger.d(\n        `[Remote Track] ${this.logIdentifier}\n        streamId=${this.stream.id} \n        trackId=${this.trackId}\n        saving ${layer}, source=${this.source}\n        Track does not have any sink`,\n      );\n      return;\n    }\n    await this.requestLayer(layer, 'preferLayer');\n    this.pushInHistory(`uiPreferLayer-${layer}`);\n  }\n\n  /**\n   * @deprecated\n   * @returns {HMSSimulcastLayer}\n   */\n  getSimulcastLayer() {\n    return (this.stream as HMSRemoteStream).getSimulcastLayer();\n  }\n\n  getLayer() {\n    return (this.stream as HMSRemoteStream).getVideoLayer();\n  }\n\n  getPreferredLayer() {\n    return this.preferredLayer;\n  }\n\n  getPreferredLayerDefinition() {\n    return this._layerDefinitions.find(layer => layer.layer === this.preferredLayer);\n  }\n\n  replaceTrack(track: HMSRemoteVideoTrack) {\n    this.nativeTrack = track.nativeTrack;\n    if (track.transceiver) {\n      this.transceiver = track.transceiver;\n      // replace dummy streamId with actual streamId retaining all other properties\n      this.stream.updateId(track.stream.id);\n    }\n    this.videoHandler.updateSinks();\n  }\n\n  async addSink(videoElement: HTMLVideoElement, shouldSendVideoLayer = true) {\n    // if the native track is empty track, just request the preferred layer else attach it\n    if (isEmptyTrack(this.nativeTrack)) {\n      await this.requestLayer(this.preferredLayer, 'addSink');\n    } else {\n      super.addSink(videoElement);\n      if (shouldSendVideoLayer) {\n        await this.updateLayer('addSink');\n      }\n    }\n    this.pushInHistory(`uiSetLayer-high`);\n  }\n\n  async removeSink(videoElement: HTMLVideoElement, shouldSendVideoLayer = true) {\n    super.removeSink(videoElement);\n    if (shouldSendVideoLayer) {\n      await this.updateLayer('removeSink');\n    }\n    this._degraded = false;\n    this.pushInHistory('uiSetLayer-none');\n  }\n\n  /**\n   * Method to get available simulcast definitions for the track\n   * @returns {HMSSimulcastLayerDefinition[]}\n   */\n  getSimulcastDefinitions() {\n    // send a clone to store as it will freeze the object from further updates\n    return [...this._layerDefinitions];\n  }\n\n  /** @internal */\n  setSimulcastDefinitons(definitions: HMSSimulcastLayerDefinition[]) {\n    this._layerDefinitions = definitions;\n  }\n\n  /**\n   * @internal\n   * SFU will change track's layer(degrade or restore) and tell the sdk to update\n   * it locally.\n   * @returns {boolean} isDegraded - returns true if degraded\n   * */\n  setLayerFromServer(layerUpdate: VideoTrackLayerUpdate) {\n    this._degraded =\n      this.enabled &&\n      (layerUpdate.publisher_degraded || layerUpdate.subscriber_degraded) &&\n      layerUpdate.current_layer === HMSSimulcastLayer.NONE;\n    this._degradedAt = this._degraded ? new Date() : this._degradedAt;\n    const currentLayer = layerUpdate.current_layer;\n    HMSLogger.d(\n      `[Remote Track] ${this.logIdentifier} \n      streamId=${this.stream.id} \n      trackId=${this.trackId}\n      layer update from sfu\n      currLayer=${layerUpdate.current_layer}\n      preferredLayer=${layerUpdate.expected_layer}\n      sub_degraded=${layerUpdate.subscriber_degraded}\n      pub_degraded=${layerUpdate.publisher_degraded}\n      isDegraded=${this._degraded}`,\n    );\n    // No need to send preferLayer update, as server has done it already\n    (this.stream as HMSRemoteStream).setVideoLayerLocally(currentLayer, this.logIdentifier, 'setLayerFromServer');\n    this.pushInHistory(`sfuLayerUpdate-${currentLayer}`);\n    return this._degraded;\n  }\n\n  private async updateLayer(source: string) {\n    const newLayer = this.degraded || !this.enabled || !this.hasSinks() ? HMSSimulcastLayer.NONE : this.preferredLayer;\n    if (!this.shouldSendVideoLayer(newLayer, source)) {\n      return;\n    }\n    await this.requestLayer(newLayer, source);\n  }\n\n  private pushInHistory(action: string) {\n    if (MAINTAIN_TRACK_HISTORY) {\n      this.history.push({ name: action, layer: this.getLayer(), degraded: this.degraded });\n    }\n  }\n\n  private async requestLayer(layer: HMSSimulcastLayer, source: string) {\n    try {\n      const response = await (this.stream as HMSRemoteStream).setVideoLayer(\n        layer,\n        this.trackId,\n        this.logIdentifier,\n        source,\n      );\n      HMSLogger.d(\n        `[Remote Track] ${this.logIdentifier} \n      streamId=${this.stream.id}\n      trackId=${this.trackId}\n      Requested layer ${layer}, source=${source}`,\n      );\n      return response;\n    } catch (error) {\n      HMSLogger.d(\n        `[Remote Track] ${this.logIdentifier} \n      streamId=${this.stream.id}\n      trackId=${this.trackId}\n      Failed to set layer ${layer}, source=${source}\n      error=${(error as Error).message}`,\n      );\n      throw error;\n    }\n  }\n\n  /**\n   * given the new layer, figure out if the update should be sent to server or not.\n   * It won't be sent if the track is already on the targetLayer. If the track is\n   * degraded though and the target layer is none, update will be sent.\n   * If there are tracks degraded on a page and user paginates away to other page,\n   * it's necessary to send the layer none message to SFU so it knows that the app\n   * is no longer interested in the track and doesn't recover degraded tracks on non\n   * visible pages.\n   *\n   * TODO: if track is degraded, send the update if target layer is lower than current layer\n   * @private\n   */\n  private shouldSendVideoLayer(targetLayer: HMSSimulcastLayer, source: string) {\n    const currLayer = this.getLayer();\n    if (this.degraded && targetLayer === HMSSimulcastLayer.NONE) {\n      return true;\n    }\n    if (currLayer === targetLayer) {\n      HMSLogger.d(\n        `[Remote Track] ${this.logIdentifier}`,\n        `Not sending update, already on layer ${targetLayer}, source=${source}`,\n      );\n      return false;\n    }\n    return true;\n  }\n}\n\n/**\n * to store history of everything that happened to a remote track which decides\n * it's current layer and degraded status.\n */\nclass TrackHistory {\n  history: Record<string, any>[] = [];\n\n  push(action: Record<string, any>) {\n    action.time = new Date().toISOString().split('T')[1];\n    this.history.push(action);\n  }\n}\n", "import { HMSMediaStream } from './HMSMediaStream';\nimport HMSPublishConnection from '../../connection/publish/publishConnection';\nimport { SimulcastLayer } from '../../interfaces';\nimport HMSLogger from '../../utils/logger';\nimport { isNode } from '../../utils/support';\nimport { HMSAudioTrackSettings, HMSVideoTrackSettings } from '../settings';\nimport { HMSLocalTrack, HMSLocalVideoTrack } from '../tracks';\n\nexport class HMSLocalStream extends HMSMediaStream {\n  /** Connection set when publish is called for the first track */\n  private readonly TAG = '[HMSLocalStream]';\n  private connection: HMSPublishConnection | null = null;\n\n  setConnection(connection: HMSPublishConnection) {\n    this.connection = connection;\n  }\n\n  addTransceiver(track: HMSLocalTrack, simulcastLayers: SimulcastLayer[]) {\n    const transceiver = this.connection!.addTransceiver(track.getTrackBeingSent(), {\n      streams: [this.nativeStream],\n      direction: 'sendonly',\n      sendEncodings: this.getTrackEncodings(track, simulcastLayers),\n    });\n    this.setPreferredCodec(transceiver, track.nativeTrack.kind);\n    track.transceiver = transceiver;\n    return transceiver;\n  }\n\n  async setMaxBitrateAndFramerate(\n    track: HMSLocalTrack,\n    updatedSettings?: HMSAudioTrackSettings | HMSVideoTrackSettings,\n  ): Promise<void> {\n    await this.connection?.setMaxBitrateAndFramerate(track, updatedSettings);\n  }\n\n  // @ts-ignore\n  setPreferredCodec(_transceiver: RTCRtpTransceiver, _kind: string) {\n    // TODO: Some browsers don't support setCodecPreferences, resort to SDPMunging?\n  }\n\n  replaceStreamTrack(track: MediaStreamTrack, withTrack: MediaStreamTrack) {\n    this.nativeStream.addTrack(withTrack);\n    this.nativeStream.removeTrack(track);\n  }\n\n  removeSender(track: HMSLocalTrack) {\n    if (!this.connection || this.connection.connectionState === 'closed') {\n      HMSLogger.d(this.TAG, `publish connection is not initialised or closed`);\n      return;\n    }\n    const sender = track.transceiver?.sender;\n    if (!sender) {\n      HMSLogger.w(this.TAG, `No sender found for trackId=${track.trackId}`);\n      return;\n    }\n    this.connection?.removeTrack(sender);\n    const toRemoveLocalTrackIdx = this.tracks.indexOf(track);\n    if (toRemoveLocalTrackIdx !== -1) {\n      this.tracks.splice(toRemoveLocalTrackIdx, 1);\n    } else {\n      HMSLogger.w(this.TAG, `Cannot find ${track.trackId} in locally stored tracks`);\n    }\n  }\n\n  private getTrackEncodings(track: HMSLocalTrack, simulcastLayers: SimulcastLayer[]) {\n    const trackEncodings: RTCRtpEncodingParameters[] = [];\n    if (track instanceof HMSLocalVideoTrack) {\n      if (simulcastLayers.length > 0) {\n        HMSLogger.d(this.TAG, 'Simulcast enabled with layers', simulcastLayers);\n        trackEncodings.push(...simulcastLayers);\n      } else {\n        const encodings: RTCRtpEncodingParameters = { active: this.nativeStream.active };\n        if (track.settings.maxBitrate && !isNode) {\n          encodings.maxBitrate = track.settings.maxBitrate;\n        }\n        trackEncodings.push(encodings);\n      }\n    }\n    return trackEncodings;\n  }\n}\n", "import { HMSMediaStream } from './HMSMediaStream';\nimport HMSSubscribeConnection from '../../connection/subscribe/subscribeConnection';\nimport { HMSSimulcastLayer } from '../../interfaces';\nimport HMSLogger from '../../utils/logger';\n\n/** @internal */\nexport class HMSRemoteStream extends HMSMediaStream {\n  private readonly connection: HMSSubscribeConnection;\n  private audio = true;\n  private video = HMSSimulcastLayer.NONE;\n\n  constructor(nativeStream: MediaStream, connection: HMSSubscribeConnection) {\n    super(nativeStream);\n    this.connection = connection;\n  }\n\n  async setAudio(enabled: boolean, trackId: string, identifier?: string) {\n    if (this.audio === enabled) {\n      return;\n    }\n\n    this.audio = enabled;\n    HMSLogger.d(\n      `[Remote stream] ${identifier || ''} \n    streamId=${this.id}\n    trackId=${trackId}\n    subscribing audio - ${this.audio}`,\n    );\n    await this.connection.sendOverApiDataChannelWithResponse({\n      params: {\n        subscribed: this.audio,\n        track_id: trackId,\n      },\n      method: 'prefer-audio-track-state',\n    });\n  }\n\n  /**\n   * Sets the video layer after receiving new state from SFU. This is used when server side subscribe\n   * degradation is ON.\n   * @param layer is simulcast layer to be set\n   * @param identifier is stream identifier to be printed in logs\n   */\n  setVideoLayerLocally(layer: HMSSimulcastLayer, identifier: string, source: string) {\n    this.video = layer;\n    HMSLogger.d(`[Remote stream] ${identifier}\n    streamId=${this.id}\n    source: ${source}\n    Setting layer field to=${layer}`);\n  }\n\n  /**\n   * Sets the video layer and updates the track state to SFU via api datachannel. This is used when client\n   * side subscribe degradation is ON or client unsubscribes the current track.\n   * @param layer is simulcast layer to be set\n   * @param identifier is stream identifier to be printed in logs\n   */\n  setVideoLayer(layer: HMSSimulcastLayer, trackId: string, identifier: string, source: string) {\n    HMSLogger.d(\n      `[Remote stream] ${identifier} \n      streamId=${this.id}\n      trackId=${trackId} \n      source: ${source} request ${layer} layer`,\n    );\n    this.setVideoLayerLocally(layer, identifier, source);\n    return this.connection.sendOverApiDataChannelWithResponse({\n      params: {\n        max_spatial_layer: this.video,\n        track_id: trackId,\n      },\n      method: 'prefer-video-track-state',\n    });\n  }\n\n  /**\n   * @deprecated\n   * @returns {HMSSimulcastLayer}\n   */\n  getSimulcastLayer() {\n    return this.video;\n  }\n\n  getVideoLayer() {\n    return this.video;\n  }\n\n  isAudioSubscribed() {\n    return this.audio;\n  }\n}\n", "import AnalyticsEventFactory from '../analytics/AnalyticsEventFactory';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { EventBus } from '../events/EventBus';\nimport { RID } from '../interfaces';\nimport {\n  HMSLocalTrackStats,\n  HMSPeerStats,\n  HMSTrackStats,\n  MissingInboundStats,\n  PeerConnectionType,\n  RTCRemoteInboundRtpStreamStats,\n} from '../interfaces/webrtc-stats';\nimport { HMSLocalTrack, HMSRemoteTrack } from '../media/tracks';\nimport HMSLogger from '../utils/logger';\nimport { isPresent } from '../utils/validations';\n\nexport const getLocalTrackStats = async (\n  eventBus: EventBus,\n  track: HMSLocalTrack,\n  peerName?: string,\n  prevTrackStats?: Record<string, HMSTrackStats>,\n): Promise<Record<string, HMSTrackStats> | undefined> => {\n  let trackReport: RTCStatsReport | undefined;\n  const trackStats: Record<string, HMSTrackStats> = {};\n  if (!track.transceiver?.sender.track) {\n    return;\n  }\n  try {\n    trackReport = await track.transceiver.sender.getStats();\n    const mimeTypes: { [key: string]: string } = {}; // codecId -> mimeType\n    const outbound: Record<string, RTCOutboundRtpStreamStats> = {};\n    const inbound: Record<string, RTCInboundRtpStreamStats & MissingInboundStats> = {};\n    trackReport?.forEach(stat => {\n      switch (stat.type) {\n        case 'outbound-rtp':\n          outbound[stat.id] = stat;\n          break;\n        case 'remote-inbound-rtp':\n          inbound[stat.ssrc] = stat;\n          break;\n        case 'codec':\n          mimeTypes[stat.id] = stat.mimeType;\n          break;\n        default:\n          break;\n      }\n    });\n\n    Object.keys({ ...outbound }).forEach(stat => {\n      const codecId = outbound[stat]?.codecId;\n      const mimeType = codecId ? mimeTypes[codecId] : undefined;\n      let codec: string | undefined;\n      if (mimeType) {\n        codec = mimeType.substring(mimeType.indexOf('/') + 1);\n      }\n      const out = { ...outbound[stat], rid: (outbound[stat] as HMSLocalTrackStats)?.rid as RID | undefined };\n      const inStats = inbound[out.ssrc];\n      trackStats[stat] = {\n        ...out,\n        bitrate: computeBitrate('bytesSent', out, prevTrackStats?.[stat]),\n        packetsLost: inStats?.packetsLost,\n        jitter: inStats?.jitter,\n        roundTripTime: inStats?.roundTripTime,\n        totalRoundTripTime: inStats?.totalRoundTripTime,\n        peerName,\n        peerID: track.peerId,\n        enabled: track.enabled,\n        codec,\n      };\n    });\n  } catch (err: any) {\n    eventBus.analytics.publish(\n      AnalyticsEventFactory.rtcStatsFailed(\n        ErrorFactory.WebrtcErrors.StatsFailed(\n          HMSAction.TRACK,\n          `Error getting local track stats ${track.trackId} - ${err.message}`,\n        ),\n      ),\n    );\n    HMSLogger.w('[HMSWebrtcStats]', 'Error in getting local track stats', track, err, (err as Error).name);\n  }\n  return trackStats;\n};\n\nexport const getTrackStats = async (\n  eventBus: EventBus,\n  track: HMSRemoteTrack,\n  peerName?: string,\n  prevTrackStats?: HMSTrackStats,\n): Promise<HMSTrackStats | undefined> => {\n  let trackReport: RTCStatsReport | undefined;\n  try {\n    trackReport = await track.transceiver?.receiver.getStats();\n  } catch (err: any) {\n    eventBus.analytics.publish(\n      AnalyticsEventFactory.rtcStatsFailed(\n        ErrorFactory.WebrtcErrors.StatsFailed(\n          HMSAction.TRACK,\n          `Error getting remote track stats ${track.trackId} - ${err.message}`,\n        ),\n      ),\n    );\n    HMSLogger.w('[HMSWebrtcStats]', 'Error in getting remote track stats', track, err);\n  }\n  const trackStats = getRelevantStatsFromTrackReport(trackReport);\n\n  const bitrate = computeBitrate('bytesReceived', trackStats, prevTrackStats);\n\n  const packetsLostRate = computeStatRate('packetsLost', trackStats, prevTrackStats);\n\n  if (trackStats?.remote) {\n    Object.assign(trackStats.remote, {\n      packetsLostRate: computeStatRate('packetsLost', trackStats.remote, prevTrackStats?.remote),\n    });\n  }\n\n  return (\n    trackStats && {\n      ...trackStats,\n      bitrate,\n      packetsLostRate,\n      peerID: track.peerId,\n      enabled: track.enabled,\n      peerName,\n      codec: trackStats.codec,\n    }\n  );\n};\n\nconst getRelevantStatsFromTrackReport = (trackReport?: RTCStatsReport) => {\n  let streamStats: RTCInboundRtpStreamStats | (RTCOutboundRtpStreamStats & { rid?: RID }) | undefined;\n  // Valid by Webrtc spec, not in TS\n  // let remoteStreamStats: RTCRemoteInboundRtpStreamStats | RTCRemoteOutboundRtpStreamStats;\n  let remoteStreamStats: RTCRemoteInboundRtpStreamStats | undefined;\n\n  const mimeTypes: { [key: string]: string } = {}; // codecId -> mimeType\n  trackReport?.forEach(stat => {\n    switch (stat.type) {\n      case 'inbound-rtp':\n        streamStats = stat;\n        break;\n      case 'outbound-rtp':\n        streamStats = stat;\n        break;\n      case 'remote-inbound-rtp':\n        remoteStreamStats = stat;\n        break;\n      case 'codec':\n        mimeTypes[stat.id] = stat.mimeType;\n        break;\n      default:\n        break;\n    }\n  });\n\n  const mimeType = streamStats?.codecId ? mimeTypes[streamStats.codecId] : undefined;\n  let codec: string | undefined;\n  if (mimeType) {\n    codec = mimeType.substring(mimeType.indexOf('/') + 1);\n  }\n\n  return (\n    streamStats &&\n    Object.assign(streamStats, {\n      remote: remoteStreamStats,\n      codec: codec,\n    })\n  );\n};\n\nexport const getLocalPeerStatsFromReport = (\n  type: PeerConnectionType,\n  report?: RTCStatsReport,\n  prevStats?: HMSPeerStats,\n): (RTCIceCandidatePairStats & { bitrate: number }) | undefined => {\n  const activeCandidatePair = getActiveCandidatePairFromReport(report);\n  const bitrate = computeBitrate(\n    (type === 'publish' ? 'bytesSent' : 'bytesReceived') as any,\n    activeCandidatePair,\n    prevStats && prevStats[type],\n  );\n\n  return activeCandidatePair && Object.assign(activeCandidatePair, { bitrate });\n};\n\nexport const getActiveCandidatePairFromReport = (report?: RTCStatsReport): RTCIceCandidatePairStats | undefined => {\n  let activeCandidatePair: RTCIceCandidatePairStats | undefined;\n  report?.forEach(stat => {\n    if (stat.type === 'transport') {\n      // TS doesn't have correct types for RTCStatsReports\n      // @ts-expect-error\n      activeCandidatePair = report?.get(stat.selectedCandidatePairId);\n    }\n  });\n\n  // Fallback for Firefox.\n  if (!activeCandidatePair) {\n    report?.forEach(stat => {\n      if (stat.type === 'candidate-pair' && stat.selected) {\n        activeCandidatePair = stat;\n      }\n    });\n  }\n\n  return activeCandidatePair;\n};\n\nexport const getPacketsLostAndJitterFromReport = (report?: RTCStatsReport): { packetsLost: number; jitter: number } => {\n  const result = { packetsLost: 0, jitter: 0 };\n  report?.forEach(stat => {\n    if (stat.packetsLost) {\n      result.packetsLost += stat.packetsLost;\n    }\n    if (stat.jitter > result.jitter) {\n      result.jitter = stat.jitter;\n    }\n  });\n\n  return result;\n};\n\nexport const union = <T>(arr1: T[], arr2: T[]): T[] => {\n  return Array.from(new Set(arr1.concat(arr2)));\n};\n\n/**\n * Ref: https://github.dev/peermetrics/webrtc-stats/blob/b5c1fed68325543e6f563c6d3f4450a4b51e12b7/src/utils.ts#L62\n */\nexport const computeBitrate = <T extends HMSTrackStats>(\n  statName: keyof T,\n  newReport?: Partial<T>,\n  oldReport?: Partial<T>,\n): number => computeStatRate(statName, newReport, oldReport) * 8; // Bytes to bits\n\nconst computeStatRate = <T extends HMSTrackStats>(\n  statName: keyof T,\n  newReport?: Partial<T>,\n  oldReport?: Partial<T>,\n): number => {\n  const newVal = newReport && newReport[statName];\n  const oldVal = oldReport ? oldReport[statName] : null;\n  const conditions = [newReport, oldReport, isPresent(newVal), isPresent(oldVal)];\n  if (conditions.every(condition => !!condition)) {\n    // Type not null checked in `isPresent`\n    // * 1000 - ms to s\n    return (\n      computeNumberRate(\n        newVal as unknown as number,\n        oldVal as unknown as number,\n        newReport?.timestamp,\n        oldReport?.timestamp,\n      ) * 1000\n    );\n  } else {\n    return 0;\n  }\n};\n\nexport const computeNumberRate = (newVal?: number, oldVal?: number, newTimestamp?: number, oldTimestamp?: number) => {\n  if (isPresent(newVal) && isPresent(oldVal) && newTimestamp && oldTimestamp) {\n    return ((newVal as number) - (oldVal as number)) / (newTimestamp - oldTimestamp);\n  } else {\n    return 0;\n  }\n};\n", "import {\n  computeNumberRate,\n  getLocalPeerStatsFromReport,\n  getLocalTrackStats,\n  getPacketsLostAndJitterFromReport,\n  getTrackStats,\n  union,\n} from './utils';\nimport AnalyticsEventFactory from '../analytics/AnalyticsEventFactory';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { EventBus } from '../events/EventBus';\nimport { HMSPeerStats, HMSTrackStats } from '../interfaces/webrtc-stats';\nimport { HMSLocalTrack, HMSRemoteAudioTrack, HMSRemoteTrack, HMSRemoteVideoTrack } from '../media/tracks';\nimport { Store } from '../sdk/store';\nimport HMSLogger from '../utils/logger';\n\nexport class HMSWebrtcStats {\n  private readonly TAG = '[HMSWebrtcStats]';\n  private localPeerID?: string;\n  private peerStats: Record<string, HMSPeerStats> = {};\n  private remoteTrackStats: Record<string, HMSTrackStats> = {};\n  private localTrackStats: Record<string, Record<string, HMSTrackStats>> = {};\n\n  /**\n   * Removed localPeerID check in other places as it will be present before\n   * this is initialized\n   */\n  constructor(\n    private store: Store,\n    private readonly eventBus: EventBus,\n    private publishConnection?: RTCPeerConnection,\n    private subscribeConnection?: RTCPeerConnection,\n  ) {\n    this.localPeerID = this.store.getLocalPeer()?.peerId;\n  }\n\n  setPeerConnections({ publish, subscribe }: { publish?: RTCPeerConnection; subscribe?: RTCPeerConnection }) {\n    this.publishConnection = publish;\n    this.subscribeConnection = subscribe;\n  }\n\n  getPublishPeerConnection() {\n    return this.publishConnection;\n  }\n\n  getSubscribePeerConnection() {\n    return this.subscribeConnection;\n  }\n\n  getLocalPeerStats = (): HMSPeerStats | undefined => {\n    return this.peerStats[this.localPeerID!];\n  };\n\n  getRemoteTrackStats = (trackId: string): HMSTrackStats | undefined => {\n    return this.remoteTrackStats[trackId];\n  };\n\n  getAllRemoteTracksStats = () => {\n    return this.remoteTrackStats;\n  };\n\n  getLocalTrackStats = () => {\n    return this.localTrackStats;\n  };\n\n  /**\n   * @internal\n   */\n  updateStats = async () => {\n    await this.updateLocalPeerStats();\n    await this.updateLocalTrackStats();\n    await this.updateRemoteTrackStats();\n  };\n\n  private updateLocalPeerStats = async () => {\n    const prevLocalPeerStats = this.getLocalPeerStats();\n    let publishReport: RTCStatsReport | undefined;\n    try {\n      publishReport = await this.publishConnection?.getStats();\n    } catch (err: any) {\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.rtcStatsFailed(ErrorFactory.WebrtcErrors.StatsFailed(HMSAction.PUBLISH, err.message)),\n      );\n      HMSLogger.w(this.TAG, 'Error in getting publish stats', err);\n    }\n    const publishStats: HMSPeerStats['publish'] | undefined =\n      publishReport && getLocalPeerStatsFromReport('publish', publishReport, prevLocalPeerStats);\n    let subscribeReport: RTCStatsReport | undefined;\n    try {\n      subscribeReport = await this.subscribeConnection?.getStats();\n    } catch (err: any) {\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.rtcStatsFailed(ErrorFactory.WebrtcErrors.StatsFailed(HMSAction.SUBSCRIBE, err.message)),\n      );\n      HMSLogger.w(this.TAG, 'Error in getting subscribe stats', err);\n    }\n    const baseSubscribeStats =\n      subscribeReport && getLocalPeerStatsFromReport('subscribe', subscribeReport, prevLocalPeerStats);\n    const { packetsLost, jitter } = getPacketsLostAndJitterFromReport(subscribeReport);\n    const packetsLostRate = computeNumberRate(\n      packetsLost,\n      prevLocalPeerStats?.subscribe?.packetsLost,\n      baseSubscribeStats?.timestamp,\n      prevLocalPeerStats?.subscribe?.timestamp,\n    );\n\n    const subscribeStats: HMSPeerStats['subscribe'] =\n      baseSubscribeStats && Object.assign(baseSubscribeStats, { packetsLostRate, jitter, packetsLost });\n\n    this.peerStats[this.localPeerID!] = { publish: publishStats, subscribe: subscribeStats };\n  };\n\n  private updateRemoteTrackStats = async () => {\n    const tracks = Array.from(this.store.getTracksMap().values()).filter(\n      track => track instanceof HMSRemoteVideoTrack || track instanceof HMSRemoteAudioTrack,\n    );\n    const trackIds = tracks.map(track => track.trackId);\n    Object.keys(this.remoteTrackStats).forEach(trackId => {\n      if (!trackIds.includes(trackId)) {\n        delete this.remoteTrackStats[trackId];\n      }\n    });\n    for (const track of tracks) {\n      const peerName = track.peerId && this.store.getPeerById(track.peerId)?.name;\n      const prevTrackStats = this.getRemoteTrackStats(track.trackId);\n      const trackStats = await getTrackStats(this.eventBus, track as HMSRemoteTrack, peerName, prevTrackStats);\n      if (trackStats) {\n        this.remoteTrackStats[track.trackId] = trackStats;\n      }\n    }\n  };\n\n  private updateLocalTrackStats = async () => {\n    const tracks = this.store.getLocalPeerTracks().reduce<Record<string, HMSLocalTrack>>((res, track) => {\n      res[track.getTrackIDBeingSent()] = track;\n      return res;\n    }, {});\n    const trackIDs = union(Object.keys(this.localTrackStats), Object.keys(tracks));\n    for (const trackID of trackIDs) {\n      const track = tracks[trackID] as HMSLocalTrack;\n      if (track) {\n        const peerName = this.store.getLocalPeer()?.name;\n        const trackStats = await getLocalTrackStats(this.eventBus, track, peerName, this.localTrackStats[trackID]);\n        if (trackStats) {\n          this.localTrackStats[trackID] = trackStats;\n        }\n      } else {\n        delete this.localTrackStats[trackID];\n      }\n    }\n  };\n}\n", "import { HMSWebrtcStats } from './HMSWebrtcStats';\nimport AnalyticsEventFactory from '../analytics/AnalyticsEventFactory';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { EventBus } from '../events/EventBus';\nimport { Store } from '../sdk/store';\nimport { RTC_STATS_MONITOR_INTERVAL } from '../utils/constants';\nimport HMSLogger from '../utils/logger';\nimport { sleep } from '../utils/timer-utils';\n\nexport class HMSWebrtcInternals {\n  private readonly TAG = '[HMSWebrtcInternals]';\n  private readonly interval = RTC_STATS_MONITOR_INTERVAL;\n  private isMonitored = false;\n  private hmsStats?: HMSWebrtcStats;\n\n  constructor(private readonly store: Store, private readonly eventBus: EventBus) {}\n\n  getCurrentStats() {\n    return this.hmsStats;\n  }\n\n  getPublishPeerConnection() {\n    return this.hmsStats?.getPublishPeerConnection();\n  }\n\n  getSubscribePeerConnection() {\n    return this.hmsStats?.getSubscribePeerConnection();\n  }\n\n  onStatsChange(statsChangeCb: (stats: HMSWebrtcStats) => void) {\n    this.eventBus.statsUpdate.subscribe(statsChangeCb);\n    return () => {\n      this.eventBus.statsUpdate.unsubscribe(statsChangeCb);\n    };\n  }\n\n  private handleStatsUpdate = async () => {\n    await this.hmsStats?.updateStats();\n    if (this.hmsStats) {\n      this.eventBus.statsUpdate.publish(this.hmsStats);\n    }\n  };\n\n  /**\n   *\n   * @internal\n   */\n  setPeerConnections({ publish, subscribe }: { publish?: RTCPeerConnection; subscribe?: RTCPeerConnection }) {\n    if (this.hmsStats) {\n      this.hmsStats.setPeerConnections({ publish, subscribe });\n    } else {\n      this.hmsStats = new HMSWebrtcStats(this.store, this.eventBus, publish, subscribe);\n    }\n  }\n\n  /**\n   * @internal\n   */\n  async start() {\n    if (this.isMonitored) {\n      HMSLogger.d(this.TAG, 'Already started');\n      return;\n    }\n    this.stop();\n    this.isMonitored = true;\n    HMSLogger.d(this.TAG, 'Starting Webrtc Stats Monitor');\n    this.startLoop()\n      .then(() => HMSLogger.d(this.TAG, 'Stopping Webrtc Stats Monitor'))\n      .catch(e => {\n        this.eventBus.analytics.publish(\n          AnalyticsEventFactory.rtcStatsFailed(ErrorFactory.WebrtcErrors.StatsFailed(HMSAction.PUBLISH, e.message)),\n        );\n        HMSLogger.e(this.TAG, e.message);\n      });\n  }\n\n  private stop() {\n    this.isMonitored = false;\n  }\n\n  private async startLoop() {\n    while (this.isMonitored) {\n      await this.handleStatsUpdate();\n      await sleep(this.interval);\n    }\n  }\n\n  /**\n   * @internal\n   */\n  cleanup() {\n    this.stop();\n    this.eventBus.statsUpdate.removeAllListeners();\n  }\n}\n", "import { HMSPeer as IHMSPeer } from '../../../interfaces/peer';\nimport { HMSPeerType } from '../../../interfaces/peer/hms-peer';\nimport { HMSRole } from '../../../interfaces/role';\nimport { HMSAudioTrack, HMSTrack, HMSVideoTrack } from '../../../media/tracks';\nimport { HAND_RAISE_GROUP_NAME } from '../../../utils/constants';\n\nexport type HMSPeerInit = {\n  peerId: string;\n  name: string;\n  isLocal: boolean;\n  customerUserId?: string;\n  metadata?: string;\n  role?: HMSRole;\n  joinedAt?: Date;\n  fromRoomState?: boolean;\n  metworkQuality?: number;\n  groups?: string[];\n  realtime?: boolean;\n  isHandRaised?: boolean;\n  type: HMSPeerType;\n};\n\nexport class HMSPeer implements IHMSPeer {\n  readonly peerId: string;\n  readonly isLocal: boolean;\n  name: string;\n  customerUserId?: string = '';\n  metadata?: string = '';\n  audioTrack?: HMSAudioTrack;\n  videoTrack?: HMSVideoTrack;\n  auxiliaryTracks: HMSTrack[] = [];\n  role?: HMSRole;\n  joinedAt?: Date;\n  networkQuality?: number;\n  groups?: string[];\n  realtime?: boolean;\n  type: HMSPeerType;\n\n  constructor({\n    peerId,\n    name,\n    isLocal,\n    customerUserId,\n    metadata,\n    role,\n    joinedAt,\n    groups,\n    realtime,\n    type,\n  }: HMSPeerInit) {\n    this.name = name;\n    this.peerId = peerId;\n    this.isLocal = isLocal;\n    this.customerUserId = customerUserId;\n    this.metadata = metadata;\n    this.joinedAt = joinedAt;\n    this.groups = groups;\n    this.realtime = realtime;\n    this.type = type;\n\n    if (role) {\n      this.role = role;\n    }\n  }\n\n  get isHandRaised() {\n    return !!this.groups?.includes(HAND_RAISE_GROUP_NAME);\n  }\n\n  /**\n   * @internal\n   */\n  updateRole(newRole: HMSRole) {\n    this.role = newRole;\n  }\n  /**\n   * @internal\n   */\n  updateName(newName: string) {\n    this.name = newName;\n  }\n\n  updateNetworkQuality(quality: number) {\n    this.networkQuality = quality;\n  }\n\n  /**\n   * @internal\n   */\n  updateMetadata(data: string) {\n    this.metadata = data;\n  }\n\n  updateGroups(groups: string[]) {\n    this.groups = groups;\n  }\n\n  toString() {\n    return `{\n      name: ${this.name};\n      role: ${this.role?.name};\n      peerId: ${this.peerId};\n      customerUserId: ${this.customerUserId};\n      ${this.audioTrack ? `audioTrack: ${this.audioTrack?.trackId};` : ''}\n      ${this.videoTrack ? `videoTrack: ${this.videoTrack?.trackId};` : ''}\n      groups: ${this.groups?.join()}\n    }`;\n  }\n}\n", "import { v4 as uuidv4 } from 'uuid';\n\nexport default class HMSIdFactory {\n  static makePeerId = () => uuidv4();\n}\n", "import { HMSPeer, HMSPeerInit } from './HMSPeer';\nimport { HMSLocalPeer as IHMSLocalPeer } from '../../../interfaces/peer';\nimport { HMSRole } from '../../../interfaces/role';\nimport { HMSLocalAudioTrack, HMSLocalTrack, HMSLocalVideoTrack } from '../../../media/tracks';\nimport HMSIdFactory from '../../../utils/id-factory';\n\ntype HMSLocalPeerInit = Omit<HMSPeerInit, 'isLocal' | 'peerId'> & { asRole?: HMSRole };\n\nexport class HMSLocalPeer extends HMSPeer implements IHMSLocalPeer {\n  isLocal = true;\n  declare audioTrack?: HMSLocalAudioTrack;\n  declare videoTrack?: HMSLocalVideoTrack;\n  auxiliaryTracks: HMSLocalTrack[] = [];\n  asRole?: HMSRole;\n\n  constructor(peerData: HMSLocalPeerInit) {\n    super({ ...peerData, peerId: HMSIdFactory.makePeerId(), isLocal: true });\n    this.asRole = peerData.asRole;\n  }\n\n  isInPreview() {\n    return !!this.asRole;\n  }\n\n  toString(): string {\n    return `{\n      name: ${this.name};\n      role: ${this.role?.name};\n      peerId: ${this.peerId};\n      customerUserId: ${this.customerUserId};\n      ${this.asRole ? `asRole: ${this.asRole.name};` : ''}\n      ${this.audioTrack ? `audioTrack: ${this.audioTrack?.trackId};` : ''}\n      ${this.videoTrack ? `videoTrack: ${this.videoTrack?.trackId};` : ''}\n    }`;\n  }\n}\n", "import { HMSPeer, HMSPeerInit } from './HMSPeer';\nimport { HMSRemotePeer as IHMSRemotePeer } from '../../../interfaces/peer';\nimport { HMSRemoteAudioTrack, HMSRemoteTrack, HMSRemoteVideoTrack } from '../../../media/tracks';\n\ntype HMSRemotePeerInit = Omit<HMSPeerInit, 'isLocal'>;\n\nexport class HMSRemotePeer extends HMSPeer implements IHMSRemotePeer {\n  isLocal = false;\n  declare audioTrack?: HMSRemoteAudioTrack;\n  declare videoTrack?: HMSRemoteVideoTrack;\n  auxiliaryTracks: HMSRemoteTrack[] = [];\n  fromRoomState = false;\n\n  constructor(peerData: HMSRemotePeerInit) {\n    super({ ...peerData, isLocal: false });\n    this.fromRoomState = !!peerData.fromRoomState;\n  }\n}\n", "import { HMSRemotePeer } from '../../sdk/models/peer';\nimport { Store } from '../../sdk/store';\nimport { PeerNotificationInfo } from '../HMSNotifications';\n\nexport const createRemotePeer = (notifPeer: PeerNotificationInfo, store: Store) => {\n  return new HMSRemotePeer({\n    peerId: notifPeer.peer_id,\n    name: notifPeer.info.name,\n    role: store.getPolicyForRole(notifPeer.role),\n    customerUserId: notifPeer.info.user_id,\n    metadata: notifPeer.info.data,\n    groups: notifPeer.groups,\n    type: notifPeer.info.type,\n  });\n};\n", "import { HMSRemotePeer } from './models/peer';\nimport { Store } from './store';\nimport { HMSPeerListIteratorOptions } from '../interfaces/peer-list-iterator';\nimport { PeerNotificationInfo } from '../notification-manager';\nimport { createRemotePeer } from '../notification-manager/managers/utils';\nimport { PeersIterationResponse } from '../signal/interfaces';\nimport HMSTransport from '../transport';\n\nexport class HMSPeerListIterator {\n  private isEnd = false;\n  private iterator: string | null = null;\n  private total = 0;\n  private defaultPaginationLimit = 10;\n  constructor(private transport: HMSTransport, private store: Store, private options?: HMSPeerListIteratorOptions) {}\n\n  private validateConnection() {\n    if (!this.transport || !this.store) {\n      throw Error(`Use usePaginatedParticipants or hmsActions.getPeerListIterator after preview or join has happened`);\n    }\n  }\n\n  hasNext(): boolean {\n    return !this.isEnd;\n  }\n\n  getTotal(): number {\n    return this.total;\n  }\n\n  async findPeers() {\n    this.validateConnection();\n    const response = await this.transport.signal.findPeers({\n      ...(this.options || {}),\n      limit: this.options?.limit || this.defaultPaginationLimit,\n    });\n    this.updateState(response);\n    return this.processPeers(response.peers);\n  }\n\n  async next() {\n    this.validateConnection();\n    let response: PeersIterationResponse;\n    if (!this.iterator && !this.isEnd) {\n      return await this.findPeers();\n    } else if (this.iterator) {\n      response = await this.transport.signal.peerIterNext({\n        iterator: this.iterator,\n        limit: this.options?.limit || this.defaultPaginationLimit,\n      });\n      this.updateState(response);\n      return this.processPeers(response.peers);\n    }\n    return [];\n  }\n\n  private processPeers(peers: PeerNotificationInfo[]) {\n    const hmsPeers: HMSRemotePeer[] = [];\n    peers.forEach(peer => {\n      const hmsPeer = createRemotePeer(peer, this.store);\n      hmsPeers.push(hmsPeer);\n    });\n    return hmsPeers;\n  }\n\n  private updateState(response: PeersIterationResponse) {\n    this.isEnd = response.eof;\n    this.total = response.total;\n    // iterator is only received once in findpeer -  reuse the same iterator\n    if (response.iterator) {\n      this.iterator = response.iterator;\n    }\n  }\n}\n", "import HMSLogger from '../utils/logger';\n\nexport class AudioContextManager {\n  private audioContext: AudioContext;\n  private destinationNode?: MediaStreamAudioDestinationNode;\n  private source: MediaElementAudioSourceNode;\n  private readonly TAG = '[AudioContextManager]';\n\n  constructor(element: HTMLMediaElement) {\n    this.audioContext = new AudioContext();\n    this.source = this.audioContext.createMediaElementSource(element);\n    this.source.connect(this.audioContext.destination);\n  }\n\n  /**\n   * Resume AudioContext if it is suspended\n   * Note: when the browser tab is muted by default, AudioContext will be in suspended state\n   * It has to be resumed for the video/audio to be played.\n   */\n  async resumeContext() {\n    if (this.audioContext.state === 'suspended') {\n      await this.audioContext.resume();\n      HMSLogger.d(this.TAG, 'AudioContext is resumed');\n    }\n  }\n\n  getAudioTrack() {\n    // Always create a destinationNode to get new audio track id\n    if (this.destinationNode) {\n      this.source.disconnect(this.destinationNode);\n    }\n    this.destinationNode = this.audioContext.createMediaStreamDestination();\n    this.source.connect(this.destinationNode);\n    return this.destinationNode.stream.getAudioTracks()[0];\n  }\n\n  cleanup() {\n    if (this.audioContext.state !== 'closed') {\n      this.audioContext.close().catch(e => {\n        HMSLogger.d(this.TAG, 'AudioContext close error', e.message);\n      });\n    }\n  }\n}\n", "import { EventEmitter2 as EventEmitter } from 'eventemitter2';\n\n/**\n * Typed Event Emitter Reference:\n * https://rjzaworski.com/2019/10/event-emitters-in-typescript#a-typescript-event-emitter-interface\n */\n\nexport type EventMap = Record<string, any>;\n\nexport type EventKey<T extends EventMap> = string & keyof T;\nexport type EventReceiver<T> = (params: T) => void;\n\n// interface Emitter<T extends EventMap> {\n//   on<K extends EventKey<T>>(eventName: K, fn: EventReceiver<T[K]>): void;\n//   off<K extends EventKey<T>>(eventName: K, fn: EventReceiver<T[K]>): void;\n//   emit<K extends EventKey<T>>(eventName: K, params: T[K]): void;\n// }\n\nexport abstract class TypedEventEmitter<T extends EventMap> extends EventEmitter {\n  on<K extends EventKey<T>>(eventName: K, fn: EventReceiver<T[K]>) {\n    return super.on(eventName, fn);\n  }\n\n  off<K extends EventKey<T>>(eventName: K, fn: EventReceiver<T[K]>) {\n    return super.off(eventName, fn);\n  }\n\n  emit<K extends EventKey<T>>(eventName: K, params: T[K]) {\n    return super.emit(eventName, params);\n  }\n\n  listeners<K extends EventKey<T>>(eventName: K): EventReceiver<T[K]>[] {\n    return super.listeners(eventName) as EventReceiver<T[K]>[];\n  }\n}\n", "import { AudioContextManager } from './AudioContextManager';\nimport HMSLogger from '../utils/logger';\nimport { TypedEventEmitter } from '../utils/typed-event-emitter';\n\n/**\n * This class handles audio playlist management\n * - An audio element and audio context which processes audio from audio element is created\n *   in the constructor\n * It handles playback in the following steps\n *  - set's the url on the audio element created in the constructor\n *  - oncanplaythrough event of the audio element\n *    - resume the audio context if it is suspended\n *    - play the audio element\n *    - Get audio track from the audio context manager\n *    - The track is passed to playlist manager to publish\n */\nexport class PlaylistAudioManager extends TypedEventEmitter<{ ended: null; progress: Event }> {\n  private audioElement: HTMLAudioElement | null = null;\n  private track?: MediaStreamTrack;\n  private audioContextManager!: AudioContextManager;\n  private readonly TAG = '[PlaylistAudioManager]';\n  // This is to handle audio playing when seekTo is called when audio is paused\n  private seeked = false;\n\n  async play(url: string) {\n    this.audioElement = this.getAudioElement();\n    return new Promise<MediaStreamTrack[]>((resolve, reject) => {\n      this.audioElement = this.getAudioElement();\n      this.audioElement.src = url;\n      this.seeked = false;\n      this.audioElement.onerror = () => {\n        const error = `Error loading ${url}`;\n        HMSLogger.e(this.TAG, error);\n        this.stop();\n        reject(error);\n      };\n      // oncanplaythrough is called when enough media is loaded for play to be possible in two cases -\n      //    * when play is called for the first time\n      //    * when user seeks jumps to any mid track timestamp\n      this.audioElement.oncanplaythrough = async () => {\n        try {\n          if (!this.audioElement) {\n            return;\n          }\n          this.audioContextManager.resumeContext();\n          // Create audio track only once and reuse, it will be updated with current content\n          if (!this.track) {\n            await this.audioElement.play();\n            const audioTrack = this.audioContextManager.getAudioTrack();\n            this.track = audioTrack;\n            resolve([audioTrack]);\n          } else {\n            if (!this.seeked) {\n              // if this was called in response to a play call\n              await this.audioElement.play();\n              resolve([this.track]);\n            } else {\n              // if seek happened, there is no play call/promise to be resolved, just reset seeked\n              this.seeked = false;\n            }\n          }\n        } catch (err) {\n          HMSLogger.e(this.TAG, 'Error playing audio', url, (err as ErrorEvent).message);\n          reject(err);\n        }\n      };\n      this.audioElement.onseeked = () => {\n        this.seeked = true;\n      };\n    });\n  }\n\n  getTracks() {\n    return this.track ? [this.track.id] : [];\n  }\n\n  getElement() {\n    if (!this.audioElement) {\n      this.audioElement = this.getAudioElement();\n    }\n    return this.audioElement;\n  }\n\n  stop() {\n    this.audioElement?.pause();\n    this.audioElement?.removeAttribute('src');\n    this.audioElement = null;\n    this.audioContextManager?.cleanup();\n    this.track = undefined;\n  }\n\n  private getAudioElement() {\n    if (this.audioElement) {\n      return this.audioElement;\n    }\n    const audioElement = document.createElement('audio');\n    audioElement.crossOrigin = 'anonymous';\n    audioElement.addEventListener('timeupdate', event => this.emit('progress', event));\n    audioElement.addEventListener('ended', () => {\n      this.emit('ended', null);\n    });\n    this.audioContextManager = new AudioContextManager(audioElement);\n    return audioElement;\n  }\n}\n", "import { AudioContextManager } from './AudioContextManager';\nimport HMSLogger from '../utils/logger';\nimport { TypedEventEmitter } from '../utils/typed-event-emitter';\n\n/**\n * This class handles video playlist management\n * - An video element, canvas and audio context which processes audio from video element is created\n *   in the constructor\n * It handles playback in the following steps\n *  - set's the url on the video element created in the constructor\n *  - oncanplaythrough event of the video element\n *    - resume the audio context if it is suspended\n *    - set width/height on canvas\n *    - captureStream on canvas element if not already captured\n *    - play the video element\n *    - on video element is played, it is drawn to canvas\n *    - Get audio track from the audio context manager\n *    - add audioTrack to canvas stream\n *    - The audio and video tracks are passed to playlist manager to publish\n */\nexport class PlaylistVideoManager extends TypedEventEmitter<{ ended: null; progress: Event }> {\n  private readonly TAG = '[PlaylistVideoManager]';\n  private videoElement: HTMLVideoElement | null = null;\n  private canvasContext: CanvasRenderingContext2D | null = null;\n  private canvas!: HTMLCanvasElement;\n  private timer: any;\n  private tracks: MediaStreamTrack[] = [];\n  private audioContextManager!: AudioContextManager;\n  private DEFAUL_FPS = 24;\n  // This is to handle video playing when seekTo is called when video is paused\n  private seeked = false;\n\n  play(url: string) {\n    this.videoElement = this.getVideoElement();\n    this.createCanvas();\n    return new Promise<MediaStreamTrack[]>((resolve, reject) => {\n      this.videoElement = this.getVideoElement();\n      this.videoElement.src = url;\n      this.seeked = false;\n      this.videoElement.onerror = () => {\n        const error = `Error loading ${url}`;\n        HMSLogger.e(this.TAG, error);\n        this.stop();\n        reject(error);\n      };\n      // oncanplaythrough is called when enough media is loaded for play to be possible in two cases -\n      //    * when play is called for the first time\n      //    * when user jumps to any mid track timestamp using seekTo\n      this.videoElement.oncanplaythrough = async () => {\n        try {\n          if (!this.videoElement) {\n            return;\n          }\n          this.canvas.width = this.videoElement.videoWidth;\n          this.canvas.height = this.videoElement.videoHeight;\n          // Capture stream only once and reuse the same tracks. it will be autoupdated with the selected video\n          if (this.tracks.length === 0) {\n            this.clearCanvasAndTracks();\n            //@ts-ignore\n            const stream = this.canvas.captureStream();\n            if (!stream) {\n              HMSLogger.e(this.TAG, 'Browser does not support captureStream');\n              return;\n            }\n            this.videoElement.onplay = this.drawImage;\n            await this.audioContextManager.resumeContext();\n            await this.videoElement.play();\n            const audioTrack = this.audioContextManager.getAudioTrack();\n            stream.addTrack(audioTrack);\n            stream.getTracks().forEach((track: MediaStreamTrack) => {\n              this.tracks.push(track);\n            });\n            resolve(this.tracks);\n          } else {\n            // No need to capture canvas stream/get audio track. They wull be auto updated\n            if (!this.seeked) {\n              // if this was called in response to a play call\n              await this.videoElement.play();\n              resolve(this.tracks);\n            } else {\n              // if seek happened, there is no play call/promise to be resolved, just reset seeked\n              this.seeked = false;\n              // This event will be called on seekTo when paused. Just draw the one frame on canvas.\n              this.canvasContext?.drawImage(this.videoElement, 0, 0, this.canvas?.width, this.canvas?.height);\n            }\n          }\n        } catch (err) {\n          HMSLogger.e(this.TAG, 'Error playing video', url, (err as ErrorEvent).message);\n          reject(err);\n        }\n      };\n      this.videoElement.onseeked = () => {\n        this.seeked = true;\n      };\n    });\n  }\n\n  getTracks() {\n    return this.tracks.map(track => track.id);\n  }\n\n  getElement() {\n    if (!this.videoElement) {\n      this.videoElement = this.getVideoElement();\n    }\n    return this.videoElement;\n  }\n\n  stop() {\n    this.videoElement?.pause();\n    this.videoElement?.removeAttribute('src');\n    this.videoElement = null;\n    this.audioContextManager?.cleanup();\n    this.clearCanvasAndTracks();\n  }\n\n  private clearCanvasAndTracks() {\n    this.tracks = [];\n    // clear canvas before playing new video\n    this.canvasContext?.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    clearTimeout(this.timer);\n  }\n\n  private drawImage = () => {\n    if (this.videoElement && !this.videoElement.paused && !this.videoElement.ended) {\n      this.canvasContext?.drawImage(this.videoElement, 0, 0, this.canvas?.width, this.canvas?.height);\n      this.timer = setTimeout(() => {\n        this.drawImage();\n      }, 1000 / this.DEFAUL_FPS);\n    }\n  };\n\n  private getVideoElement() {\n    if (this.videoElement) {\n      return this.videoElement;\n    }\n    const videoElement = document.createElement('video');\n    videoElement.crossOrigin = 'anonymous';\n    videoElement.addEventListener('timeupdate', event => this.emit('progress', event));\n    videoElement.addEventListener('ended', () => {\n      this.emit('ended', null);\n    });\n    this.audioContextManager = new AudioContextManager(videoElement);\n    return videoElement;\n  }\n\n  private createCanvas() {\n    if (!this.canvas) {\n      this.canvas = document.createElement('canvas');\n      this.canvasContext = this.canvas.getContext('2d');\n    }\n  }\n}\n", "import { PlaylistAudioManager } from './PlaylistAudioManager';\nimport { PlaylistVideoManager } from './PlaylistVideoManager';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { EventBus } from '../events/EventBus';\nimport { HMSPlaylistItem, HMSPlaylistManager, HMSPlaylistProgressEvent, HMSPlaylistType } from '../interfaces';\nimport { HMSLocalTrack } from '../media/tracks';\nimport { HMSSdk } from '../sdk';\nimport { stringifyMediaStreamTrack } from '../utils/json';\nimport HMSLogger from '../utils/logger';\nimport { TypedEventEmitter } from '../utils/typed-event-emitter';\n\ntype PlaylistManagerState<T> = {\n  audio: {\n    list: HMSPlaylistItem<T>[];\n    currentIndex: number;\n    isAutoplayOn: boolean;\n  };\n  video: {\n    list: HMSPlaylistItem<T>[];\n    currentIndex: number;\n    isAutoplayOn: boolean;\n  };\n};\n\nconst INITIAL_STATE: PlaylistManagerState<any> = {\n  audio: {\n    list: [],\n    currentIndex: -1,\n    isAutoplayOn: true,\n  },\n  video: {\n    list: [],\n    currentIndex: -1,\n    isAutoplayOn: true,\n  },\n};\n\nexport class PlaylistManager\n  extends TypedEventEmitter<{\n    newTrackStart: HMSPlaylistItem<any>;\n    playlistEnded: HMSPlaylistType;\n    currentTrackEnded: HMSPlaylistItem<any>;\n  }>\n  implements HMSPlaylistManager\n{\n  private state = { audio: { ...INITIAL_STATE.audio }, video: { ...INITIAL_STATE.video } };\n  private audioManager: PlaylistAudioManager;\n  private videoManager: PlaylistVideoManager;\n  private readonly TAG = '[PlaylistManager]';\n\n  constructor(private sdk: HMSSdk, private eventBus: EventBus) {\n    super();\n    this.audioManager = new PlaylistAudioManager();\n    this.videoManager = new PlaylistVideoManager();\n    this.addListeners();\n  }\n\n  getList<T>(type: HMSPlaylistType = HMSPlaylistType.audio): HMSPlaylistItem<T>[] {\n    return this.state[type].list;\n  }\n\n  setList<T>(list: HMSPlaylistItem<T>[]): void {\n    if (!list || list.length === 0) {\n      HMSLogger.w(this.TAG, `Please pass in a list of HMSPlaylistItem's`);\n      return;\n    }\n    list.forEach((item: HMSPlaylistItem<T>) => {\n      if (!this.state[item.type].list.find(_item => _item.id === item.id)) {\n        this.state[item.type].list.push(item);\n      }\n    });\n  }\n\n  async clearList(type: HMSPlaylistType): Promise<void> {\n    if (this.isPlaying(type)) {\n      await this.stop(type);\n    }\n    this.state[type].list = [];\n  }\n\n  async removeItem(id: string, type: HMSPlaylistType): Promise<boolean> {\n    const { list, currentIndex } = this.state[type];\n    const index = list.findIndex(playItem => id === playItem.id);\n    if (index > -1) {\n      // stop if the item is playing\n      if (currentIndex === index && this.isPlaying(type)) {\n        await this.stop(type);\n      }\n      list.splice(index, 1);\n      return true;\n    }\n    return false;\n  }\n\n  seek(value: number, type: HMSPlaylistType = HMSPlaylistType.audio): void {\n    const { currentIndex } = this.state[type];\n    if (currentIndex === -1) {\n      throw ErrorFactory.PlaylistErrors.NoEntryToPlay(HMSAction.PLAYLIST, 'No item is currently playing');\n    }\n    const element = this.getElement(type);\n    if (element) {\n      const updatedValue = Math.max(element.currentTime + value, 0);\n      element.currentTime = Math.min(updatedValue, element.duration);\n    }\n  }\n\n  seekTo(value: number, type: HMSPlaylistType = HMSPlaylistType.audio): void {\n    const { currentIndex } = this.state[type];\n    if (currentIndex === -1) {\n      throw ErrorFactory.PlaylistErrors.NoEntryToPlay(HMSAction.PLAYLIST, 'No item is currently playing');\n    }\n    if (value < 0) {\n      throw Error('value cannot be negative');\n    }\n    const element = this.getElement(type);\n    if (element) {\n      element.currentTime = Math.min(value, element.duration);\n    }\n  }\n\n  setVolume(value: number, type: HMSPlaylistType = HMSPlaylistType.audio): void {\n    if (value < 0 || value > 100) {\n      throw Error('Please pass a valid number between 0-100');\n    }\n    const element = this.getElement(type);\n    if (element) {\n      element.volume = value * 0.01;\n    }\n  }\n\n  getVolume(type: HMSPlaylistType = HMSPlaylistType.audio): number {\n    const element = this.getElement(type);\n    if (element) {\n      return Math.floor(element.volume * 100);\n    }\n    return 0;\n  }\n\n  getCurrentTime(type: HMSPlaylistType = HMSPlaylistType.audio) {\n    const element = this.getElement(type);\n    return element?.currentTime || 0;\n  }\n\n  getCurrentIndex(type: HMSPlaylistType = HMSPlaylistType.audio) {\n    return this.state[type].currentIndex;\n  }\n\n  getCurrentProgress(type: HMSPlaylistType = HMSPlaylistType.audio) {\n    const { list, currentIndex } = this.state[type];\n    const activeUrl = list[currentIndex]?.url;\n    const element = this.getElement(type);\n    if (!activeUrl || !element) {\n      return 0;\n    }\n    return Math.floor(100 * (element.currentTime / element.duration));\n  }\n\n  getCurrentSelection(type: HMSPlaylistType = HMSPlaylistType.audio) {\n    const { list, currentIndex } = this.state[type];\n    if (currentIndex === -1) {\n      return undefined;\n    }\n    return list[currentIndex];\n  }\n\n  isPlaying(type: HMSPlaylistType = HMSPlaylistType.audio) {\n    const element = this.getElement(type);\n    return !!element && !element.paused;\n  }\n\n  setIsAutoplayOn(type: HMSPlaylistType = HMSPlaylistType.audio, autoplay: boolean) {\n    this.state[type].isAutoplayOn = autoplay;\n  }\n\n  getPlaybackRate(type: HMSPlaylistType = HMSPlaylistType.audio) {\n    const element = this.getElement(type);\n    return element ? element.playbackRate : 1.0;\n  }\n\n  setPlaybackRate(type: HMSPlaylistType = HMSPlaylistType.audio, value: number) {\n    if (value < 0.25 || value > 2.0) {\n      throw Error('Please pass a value between 0.25 and 2.0');\n    }\n    const element = this.getElement(type);\n    if (element) {\n      element.playbackRate = value;\n    }\n  }\n\n  async setEnabled(\n    enabled: boolean,\n    { id, type = HMSPlaylistType.audio }: { id: string; type: HMSPlaylistType },\n  ): Promise<void> {\n    const list = this.state[type].list;\n    const currentIndex = list.findIndex(item => item.id === id);\n    if (!id || currentIndex === -1) {\n      HMSLogger.w(this.TAG, 'Pass a valid id');\n      return;\n    }\n    const url = this.state[type].list[currentIndex].url;\n    if (enabled) {\n      await this.play(url, type);\n    } else {\n      await this.pause(url, type);\n    }\n    this.state[type].currentIndex = currentIndex;\n    this.setDuration(type);\n  }\n\n  async playNext(type: HMSPlaylistType = HMSPlaylistType.audio): Promise<void> {\n    const { list, currentIndex } = this.state[type];\n    if (currentIndex >= list.length - 1) {\n      throw ErrorFactory.PlaylistErrors.NoEntryToPlay(HMSAction.PLAYLIST, 'Reached end of playlist');\n    }\n    await this.play(list[currentIndex + 1].url, type);\n    this.state[type].currentIndex = currentIndex + 1;\n    this.setDuration(type);\n  }\n\n  async playPrevious(type: HMSPlaylistType = HMSPlaylistType.audio): Promise<void> {\n    const { list, currentIndex } = this.state[type];\n    if (currentIndex <= 0) {\n      throw ErrorFactory.PlaylistErrors.NoEntryToPlay(HMSAction.PLAYLIST, 'Reached start of playlist');\n    }\n    await this.play(list[currentIndex - 1].url, type);\n    this.state[type].currentIndex = currentIndex - 1;\n    this.setDuration(type);\n  }\n\n  async stop(type: HMSPlaylistType = HMSPlaylistType.audio): Promise<void> {\n    const manager = type === HMSPlaylistType.audio ? this.audioManager : this.videoManager;\n    manager.getElement()?.pause(); //pause local video/audio and remove tracks in next step\n    await this.removeTracks(type);\n    manager.stop();\n    this.state[type].currentIndex = -1;\n  }\n\n  cleanup() {\n    this.state = { audio: { ...INITIAL_STATE.audio }, video: { ...INITIAL_STATE.video } };\n    this.eventBus.localAudioEnabled.unsubscribe(this.handlePausePlaylist);\n    this.eventBus.localVideoEnabled.unsubscribe(this.handlePausePlaylist);\n    this.audioManager.stop();\n    this.videoManager.stop();\n  }\n\n  onProgress(fn: (progress: HMSPlaylistProgressEvent) => void) {\n    this.videoManager.on('progress', () => {\n      try {\n        fn({\n          type: HMSPlaylistType.video,\n          progress: this.getCurrentProgress(HMSPlaylistType.video),\n        });\n      } catch (error) {\n        HMSLogger.e(this.TAG, 'Error in onProgress callback');\n      }\n    });\n    this.audioManager.on('progress', () => {\n      try {\n        fn({\n          type: HMSPlaylistType.audio,\n          progress: this.getCurrentProgress(HMSPlaylistType.audio),\n        });\n      } catch (error) {\n        HMSLogger.e(this.TAG, 'Error in onProgress callback');\n      }\n    });\n  }\n\n  onNewTrackStart<T>(fn: (item: HMSPlaylistItem<T>) => void) {\n    this.on('newTrackStart', fn);\n  }\n\n  onPlaylistEnded(fn: (type: HMSPlaylistType) => void) {\n    this.on('playlistEnded', fn);\n  }\n\n  onCurrentTrackEnded<T>(fn: (item: HMSPlaylistItem<T>) => void) {\n    this.on('currentTrackEnded', fn);\n  }\n\n  private getElement(type: HMSPlaylistType = HMSPlaylistType.audio) {\n    return type === HMSPlaylistType.audio ? this.audioManager.getElement() : this.videoManager.getElement();\n  }\n\n  private async removeTracks(type: HMSPlaylistType = HMSPlaylistType.audio) {\n    const manager = type === HMSPlaylistType.audio ? this.audioManager : this.videoManager;\n    const tracks = manager.getTracks();\n    for (const trackId of tracks) {\n      await this.removeTrack(trackId);\n    }\n  }\n\n  private async play(url: string, type: HMSPlaylistType = HMSPlaylistType.audio): Promise<void> {\n    const manager = type === HMSPlaylistType.audio ? this.audioManager : this.videoManager;\n    const element = manager.getElement();\n    if (this.isItemCurrentlyPlaying(url, type)) {\n      HMSLogger.w(this.TAG, `The ${type} is currently playing`);\n      return;\n    }\n    if (element?.src.includes(url)) {\n      await element.play();\n    } else {\n      element?.pause();\n      const tracks: MediaStreamTrack[] = await manager.play(url);\n      for (const track of tracks) {\n        await this.addTrack(track, type === HMSPlaylistType.audio ? 'audioplaylist' : 'videoplaylist');\n      }\n    }\n  }\n\n  private isItemCurrentlyPlaying(url: string, type: HMSPlaylistType): boolean {\n    const element = this.getElement(type);\n    return !!(element && !element.paused && element.src.includes(url));\n  }\n\n  private setDuration(type: HMSPlaylistType = HMSPlaylistType.audio) {\n    const element = this.getElement(type);\n    const { list, currentIndex } = this.state[type];\n    if (list[currentIndex]) {\n      list[currentIndex].duration = element?.duration || 0;\n    }\n    this.emit('newTrackStart', list[currentIndex]);\n  }\n\n  private async pause(url: string, type: HMSPlaylistType = HMSPlaylistType.audio): Promise<void> {\n    const el = this.getElement(type);\n    if (el && !el.paused && el.src.includes(url)) {\n      el.pause();\n      HMSLogger.d(this.TAG, 'paused url', url);\n    } else {\n      HMSLogger.w(this.TAG, 'The passed in url is not currently playing');\n    }\n  }\n\n  private handlePausePlaylist = async ({ enabled, track }: { enabled: boolean; track: HMSLocalTrack }) => {\n    if (enabled) {\n      return;\n    }\n    let type: HMSPlaylistType | undefined = undefined;\n    if (track.source === 'audioplaylist') {\n      type = HMSPlaylistType.audio;\n    }\n    if (track.source === 'videoplaylist') {\n      type = HMSPlaylistType.video;\n    }\n    if (!type) {\n      return;\n    }\n    this.getElement(type)?.pause();\n  };\n\n  private addListeners() {\n    this.audioManager.on('ended', () => this.handleEnded(HMSPlaylistType.audio));\n    this.videoManager.on('ended', () => this.handleEnded(HMSPlaylistType.video));\n    this.eventBus.localAudioEnabled.subscribe(this.handlePausePlaylist);\n    this.eventBus.localVideoEnabled.subscribe(this.handlePausePlaylist);\n  }\n\n  /**\n   * Remove tracks if reached the end of list otherwise play next\n   * @param {HMSPlaylistType} type\n   */\n  private async handleEnded(type: HMSPlaylistType = HMSPlaylistType.audio) {\n    const { list, currentIndex, isAutoplayOn } = this.state[type];\n    if (currentIndex === list.length - 1) {\n      await this.stop(type);\n      this.emit('playlistEnded', type);\n    } else {\n      if (isAutoplayOn) {\n        this.playNext(type);\n      } else {\n        // when autoplay not allowed, pause the media element\n        await this.pause(list[currentIndex].url, type);\n      }\n    }\n    this.emit('currentTrackEnded', list[currentIndex]);\n  }\n\n  private addTrack = async (track: MediaStreamTrack, source: string) => {\n    await this.sdk.addTrack(track, source);\n    HMSLogger.d(this.TAG, 'Playlist track added', stringifyMediaStreamTrack(track));\n  };\n\n  private removeTrack = async (trackId: string) => {\n    await this.sdk.removeTrack(trackId, true);\n    HMSLogger.d(this.TAG, 'Playlist track removed', trackId);\n  };\n}\n", "import { createSelector } from 'reselect';\nimport { HMSPlaylistSelector, HMSPlaylistType, HMSStore } from '../schema';\n\n/**\n * @internal\n */\nconst selectPlaylistMap =\n  (type: HMSPlaylistType = HMSPlaylistType.audio) =>\n  (store: HMSStore) =>\n    store.playlist[type].list;\n\nconst selectPlaylistSelection =\n  (type: HMSPlaylistType = HMSPlaylistType.audio) =>\n  (store: HMSStore) =>\n    store.playlist[type].selection;\n\nconst selectPlaylistProgress =\n  (type: HMSPlaylistType = HMSPlaylistType.audio) =>\n  (store: HMSStore) =>\n    store.playlist[type].progress;\n\nconst selectPlaylistCurrentTime =\n  (type: HMSPlaylistType = HMSPlaylistType.audio) =>\n  (store: HMSStore) =>\n    store.playlist[type].currentTime;\n\nconst selectPlaylistPlaybackRate =\n  (type: HMSPlaylistType = HMSPlaylistType.audio) =>\n  (store: HMSStore) =>\n    store.playlist[type].playbackRate;\n\nconst selectPlaylistVolume =\n  (type: HMSPlaylistType = HMSPlaylistType.audio) =>\n  (store: HMSStore) =>\n    store.playlist[type].volume;\n\n/**\n * Select an array of playlist items.\n */\nconst selectPlaylist = (type: HMSPlaylistType = HMSPlaylistType.audio) =>\n  createSelector(selectPlaylistMap(type), storePlaylist => {\n    return Object.values(storePlaylist);\n  });\n\nconst selectPlaylistSelectedItem = (type: HMSPlaylistType = HMSPlaylistType.audio) =>\n  createSelector(selectPlaylistMap(type), selectPlaylistSelection(type), (storePlaylist, currentSelection) => {\n    if (!currentSelection.id) {\n      return;\n    }\n    return storePlaylist[currentSelection.id];\n  });\n\nexport const selectAudioPlaylist: HMSPlaylistSelector = {\n  selection: selectPlaylistSelection(HMSPlaylistType.audio),\n  progress: selectPlaylistProgress(HMSPlaylistType.audio),\n  currentTime: selectPlaylistCurrentTime(HMSPlaylistType.audio),\n  playbackRate: selectPlaylistPlaybackRate(HMSPlaylistType.audio),\n  volume: selectPlaylistVolume(HMSPlaylistType.audio),\n  list: selectPlaylist(HMSPlaylistType.audio),\n  selectedItem: selectPlaylistSelectedItem(HMSPlaylistType.audio) as any,\n};\n\nexport const selectVideoPlaylist: HMSPlaylistSelector = {\n  selection: selectPlaylistSelection(HMSPlaylistType.video),\n  progress: selectPlaylistProgress(HMSPlaylistType.video),\n  currentTime: selectPlaylistCurrentTime(HMSPlaylistType.video),\n  playbackRate: selectPlaylistPlaybackRate(HMSPlaylistType.video),\n  volume: selectPlaylistVolume(HMSPlaylistType.video),\n  list: selectPlaylist(HMSPlaylistType.video),\n  selectedItem: selectPlaylistSelectedItem(HMSPlaylistType.video) as any,\n};\n", "import { createSelector } from 'reselect';\nimport { byIDCurry } from './common';\nimport {\n  selectFullAppData,\n  selectHMSMessages,\n  selectLocalPeerID,\n  selectLocalPeerRole,\n  selectMessagesMap,\n  selectPeers,\n  selectPeersMap,\n  selectPollsMap,\n  selectTracksMap,\n} from './selectors';\nimport {\n  getScreenSharesByPeer,\n  isAudio,\n  isAudioPlaylist,\n  isTrackEnabled,\n  isVideo,\n  isVideoPlaylist,\n} from './selectorUtils';\nimport { HMSLogger } from '../common/ui-logger';\nimport { HMSTranscriptionMode } from '../internal';\nimport {\n  HMSAudioTrack,\n  HMSGenericTypes,\n  HMSPeer,\n  HMSPeerID,\n  HMSRoleName,\n  HMSScreenVideoTrack,\n  HMSStore,\n  HMSTrack,\n  HMSTrackID,\n  HMSVideoTrack,\n} from '../schema';\n\nconst selectPeerID = (_store: HMSStore, peerID: HMSPeerID | undefined) => peerID;\nconst selectTrackID = (_store: HMSStore, trackID: HMSTrackID | undefined) => trackID;\nconst selectRoleName = (_store: HMSStore, roleName: HMSRoleName | undefined) => roleName;\nconst selectAppDataKey = (_store: HMSStore, key: string | undefined) => key;\nconst selectPollID = (_store: HMSStore, pollID: string | undefined) => pollID;\n\nconst selectPeerByIDBare = createSelector([selectPeersMap, selectPeerID], (storePeers, peerID) =>\n  peerID ? storePeers[peerID] : null,\n);\n\nconst selectTrackByIDBare = createSelector([selectTracksMap, selectTrackID], (storeTracks, trackID) =>\n  trackID ? storeTracks[trackID] : null,\n);\n\nconst selectVideoTrackByIDBare = createSelector([selectTracksMap, selectTrackID], (storeTracks, trackID) => {\n  if (!trackID) {\n    return null;\n  }\n  const track = storeTracks[trackID] as HMSVideoTrack | undefined;\n  if (track?.type === 'video') {\n    return track;\n  }\n  return null;\n});\n\nconst selectAudioTrackByIDBare = createSelector([selectTracksMap, selectTrackID], (storeTracks, trackID) => {\n  if (!trackID) {\n    return null;\n  }\n  const track = storeTracks[trackID] as HMSAudioTrack | undefined;\n  if (track?.type === 'audio') {\n    return track;\n  }\n  return null;\n});\n\nconst selectScreenAudioTrackByIDBare = createSelector([selectTracksMap, selectTrackID], (storeTracks, trackID) => {\n  if (!trackID) {\n    return null;\n  }\n  const track = storeTracks[trackID] as HMSAudioTrack | undefined;\n  if (track?.type === 'audio' && track?.source === 'screen') {\n    return track;\n  }\n  return null;\n});\nconst selectScreenVideoTrackByIDBare = createSelector([selectTracksMap, selectTrackID], (storeTracks, trackID) => {\n  if (!trackID) {\n    return null;\n  }\n  const track = storeTracks[trackID] as HMSScreenVideoTrack | undefined;\n  if (track?.type === 'video' && track?.source === 'screen') {\n    return track;\n  }\n  return null;\n});\n\nconst selectPollByIDBare = createSelector([selectPollsMap, selectPollID], (storePolls, pollID) =>\n  pollID ? storePolls[pollID] : null,\n);\n\n/**\n * Select the {@link HMSPeer} object given a peer ID.\n */\nexport const selectPeerByID = byIDCurry(selectPeerByIDBare);\n\n/**\n * Select a particular key from ui app data by passed in key.\n * if key is not passed, full data is returned.\n */\nexport const selectAppData = byIDCurry(\n  createSelector([selectFullAppData, selectAppDataKey], (appData, key) => {\n    if (!appData) {\n      return undefined;\n    }\n    if (key) {\n      return appData[key];\n    }\n    return appData;\n  }),\n);\n\n/**\n * Select a particular key from session store by passed in key.\n * if key is not passed, full data is returned.\n */\nexport function selectSessionStore<T extends HMSGenericTypes = { sessionStore: Record<string, any> }>(): (\n  store: HMSStore<T>,\n) => T['sessionStore'] | undefined;\nexport function selectSessionStore<\n  T extends HMSGenericTypes = { sessionStore: Record<string, any> },\n  K extends keyof T['sessionStore'] = keyof T['sessionStore'],\n>(key: K): (store: HMSStore<T>) => T['sessionStore'][K] | undefined;\nexport function selectSessionStore<\n  T extends HMSGenericTypes = { sessionStore: Record<string, any> },\n  K extends keyof T['sessionStore'] = keyof T['sessionStore'],\n>(key?: K) {\n  return (store: HMSStore<T>) => {\n    if (!store.sessionStore) {\n      return undefined;\n    }\n    if (key) {\n      return store.sessionStore[key];\n    }\n    return store.sessionStore;\n  };\n}\n\nexport const selectAppDataByPath = (...keys: string[]) =>\n  createSelector([selectFullAppData], appData => {\n    if (!appData) {\n      return undefined;\n    }\n    if (keys && keys.length > 0) {\n      let value = appData;\n      for (const key of keys) {\n        if (!key) {\n          return value;\n        }\n        value = value?.[key];\n      }\n      return value;\n    }\n    return appData;\n  });\n\n/**\n * Select the name of a {@link HMSPeer} given a peer ID.\n */\nexport const selectPeerNameByID = byIDCurry(createSelector(selectPeerByIDBare, peer => peer?.name));\n\nexport const selectPeerTypeByID = byIDCurry(createSelector(selectPeerByIDBare, peer => peer?.type));\n\n/**\n * Select the {@link HMSTrack} object given a track ID.\n */\nexport const selectTrackByID = byIDCurry(selectTrackByIDBare);\n\n/**\n * Select the {@link HMSVideoTrack} object given a track ID.\n */\nexport const selectVideoTrackByID = byIDCurry(selectVideoTrackByIDBare);\n\n/**\n * Select the {@link HMSAudioTrack} object given a track ID.\n */\nexport const selectAudioTrackByID = byIDCurry(selectAudioTrackByIDBare);\n\n/**\n * Select the {@link HMSScreenAudioTrack} object given a track ID.\n */\nexport const selectScreenAudioTrackByID = byIDCurry(selectScreenAudioTrackByIDBare);\n\n/**\n * Select the {@link HMSScreenVideoTrack} object given a track ID.\n */\nexport const selectScreenVideoTrackByID = byIDCurry(selectScreenVideoTrackByIDBare);\n\n/**\n * Select the primary video track of a peer given a peer ID.\n */\nexport const selectVideoTrackByPeerID = byIDCurry((store: HMSStore, peerID?: HMSPeerID): HMSVideoTrack | undefined => {\n  const peer = selectPeerByIDBare(store, peerID);\n  if (peer && peer.videoTrack && peer.videoTrack !== '') {\n    return store.tracks[peer.videoTrack] as HMSVideoTrack;\n  }\n  return undefined;\n});\n\n/**\n * Select the primary audio track of a peer given a peer ID.\n */\nexport const selectAudioTrackByPeerID = byIDCurry((store: HMSStore, peerID?: HMSPeerID): HMSAudioTrack | undefined => {\n  const peer = selectPeerByIDBare(store, peerID);\n  if (peer && peer.audioTrack && peer.audioTrack !== '') {\n    return store.tracks[peer.audioTrack] as HMSAudioTrack;\n  }\n  return undefined;\n});\n\n/**\n * Select the camera stream of a peer given a peer ID.\n * This is the primary video track of a peer.\n */\nexport const selectCameraStreamByPeerID = selectVideoTrackByPeerID;\n\n/**\n * Select an array of auxiliary tracks of a peer given a peer ID.\n */\nexport const selectAuxiliaryTracksByPeerID = byIDCurry((store: HMSStore, peerID?: HMSPeerID): HMSTrack[] => {\n  const peer = selectPeerByIDBare(store, peerID);\n  return peer?.auxiliaryTracks.map(trackID => store.tracks[trackID]) || [];\n});\n\nconst selectSpeakerByTrackID = (store: HMSStore, trackID: HMSTrackID | undefined) => {\n  return trackID ? store.speakers[trackID] : null;\n};\n\n/**\n * Select the audio level of a track given a track ID.\n */\nexport const selectTrackAudioByID = byIDCurry(\n  createSelector(selectSpeakerByTrackID, speaker => speaker?.audioLevel || 0),\n);\n\n/**\n * Select speaker object of audioTrack of a peer given a peer ID.\n */\nconst selectSpeakerByPeerID = (store: HMSStore, peerID: HMSPeerID | undefined) => {\n  const peerAudioTrack = selectAudioTrackByPeerID(peerID)(store);\n  return selectSpeakerByTrackID(store, peerAudioTrack?.id);\n};\n\n/**\n * Select audio level of audioTrack of a peer given a peer ID\u00DF.\n */\nexport const selectPeerAudioByID = byIDCurry(\n  createSelector(selectSpeakerByPeerID, speaker => speaker?.audioLevel || 0),\n);\n\nexport const selectConnectionQualityByPeerID = byIDCurry((store: HMSStore, peerID: HMSPeerID | undefined) => {\n  if (peerID) {\n    return store.connectionQualities[peerID];\n  }\n  return undefined;\n});\n\n/**\n * Select the first auxiliary audio track of a peer given a peer ID.\n */\nexport const selectAuxiliaryAudioByPeerID = byIDCurry((store: HMSStore, peerID?: HMSPeerID) => {\n  const peer = selectPeerByIDBare(store, peerID);\n  if (peer) {\n    const trackID = peer?.auxiliaryTracks.find(trackID => isAudio(store.tracks[trackID]));\n    return trackID ? (store.tracks[trackID] as HMSAudioTrack) : undefined;\n  }\n  return undefined;\n});\n\nexport const selectVideoPlaylistVideoTrackByPeerID = byIDCurry(\n  createSelector(selectTracksMap, selectPeerByIDBare, (tracks, peer) => {\n    const trackID = peer?.auxiliaryTracks.find(trackID => {\n      const track = tracks[trackID];\n      return isVideoPlaylist(track) && isVideo(track);\n    });\n    return trackID ? (tracks[trackID] as HMSVideoTrack) : undefined;\n  }),\n);\n\nexport const selectVideoPlaylistAudioTrackByPeerID = byIDCurry(\n  createSelector(selectTracksMap, selectPeerByIDBare, (tracks, peer) => {\n    const trackID = peer?.auxiliaryTracks.find(trackID => {\n      const track = tracks[trackID];\n      return isVideoPlaylist(track) && isAudio(track);\n    });\n    return trackID ? (tracks[trackID] as HMSAudioTrack) : undefined;\n  }),\n);\n\nexport const selectAudioPlaylistTrackByPeerID = byIDCurry(\n  createSelector(selectTracksMap, selectPeerByIDBare, (tracks, peer) => {\n    const trackID = peer?.auxiliaryTracks.find(trackID => {\n      const track = tracks[trackID];\n      return isAudioPlaylist(track) && isAudio(track);\n    });\n    return trackID ? (tracks[trackID] as HMSAudioTrack) : undefined;\n  }),\n);\n\nexport const selectScreenSharesByPeerId = byIDCurry(\n  createSelector(selectTracksMap, selectPeerByIDBare, (tracks, peer) => {\n    return getScreenSharesByPeer(tracks, peer);\n  }),\n);\n\n/**\n * Select the screen share video track of a peer given a peer ID.\n */\nexport const selectScreenShareByPeerID = (id?: string) =>\n  createSelector(selectScreenSharesByPeerId(id), screenshare => {\n    return screenshare.video;\n  });\n\n/**\n * Select the screen share audio track of a peer given a peer ID.\n */\nexport const selectScreenShareAudioByPeerID = (id?: string) =>\n  createSelector(selectScreenSharesByPeerId(id), screenshare => {\n    return screenshare.audio;\n  });\n\n/**\n * Select a boolean denoting whether a peer has unmuted audio and sharing it to other peers.\n */\nexport const selectIsPeerAudioEnabled = byIDCurry((store: HMSStore, peerID?: string) => {\n  const peer = selectPeerByIDBare(store, peerID);\n  return isTrackEnabled(store, peer?.audioTrack);\n});\n\n/**\n * Select a boolean denoting whether a peer has unmuted video and sharing it to other peers.\n */\nexport const selectIsPeerVideoEnabled = byIDCurry((store: HMSStore, peerID?: string) => {\n  const peer = selectPeerByIDBare(store, peerID);\n  return isTrackEnabled(store, peer?.videoTrack);\n});\n\n/**\n * Select a boolean denoting whether you've muted an audio track locally(only for you) given a track ID.\n */\nexport const selectIsAudioLocallyMuted = byIDCurry((store: HMSStore, trackID?: string) => {\n  if (trackID && store.tracks[trackID]) {\n    return (store.tracks[trackID] as HMSAudioTrack).volume === 0;\n  }\n  return undefined;\n});\n\n/**\n * Select a boolean denoting whether you've muted the primary audio track of a peer locally(only for you) given a peer ID.\n */\nexport const selectIsLocallyMutedByPeerID = byIDCurry((store: HMSStore, peerID?: string) => {\n  const peer = selectPeerByIDBare(store, peerID);\n  return selectIsAudioLocallyMuted(peer?.audioTrack)(store);\n});\n\n/**\n * Select a boolean denoting whether you've muted the screen share audio track of a peer locally(only for you) given a peer ID.\n */\nexport const selectIsScreenShareLocallyMutedByPeerID = byIDCurry((store: HMSStore, peerID?: string) => {\n  const track = selectScreenShareAudioByPeerID(peerID)(store);\n  return selectIsAudioLocallyMuted(track?.id)(store);\n});\n\n/**\n * Select the local audio volume of an audio track given a track ID.\n *\n * NOTE: **Volume** of a track is different from **Audio Level** of a track,\n * - Audio Level measures the audio of a track and it comes from 100ms's servers.\n * - Volume is how loud you hear the audio of a track, this is controlled by you at the client side.\n */\nexport const selectAudioTrackVolume = byIDCurry((store: HMSStore, trackID?: string) => {\n  const track = selectTrackByIDBare(store, trackID);\n  if (track) {\n    if (track.type !== 'audio') {\n      HMSLogger.w('Please pass audio track here');\n      return undefined;\n    }\n    return track.volume;\n  }\n  return undefined;\n});\n\n/**\n * Select the local audio volume of the primary audio track of a peer given a peer ID.\n */\nexport const selectAudioVolumeByPeerID = byIDCurry((store: HMSStore, peerID?: string) => {\n  const peer = selectPeerByIDBare(store, peerID);\n  return selectAudioTrackVolume(peer?.audioTrack)(store);\n});\n\n/**\n * Select the local audio volume of the screen share of a peer given a peer ID.\n */\nexport const selectScreenshareAudioVolumeByPeerID = byIDCurry((store: HMSStore, peerID?: string) => {\n  const track = selectScreenShareAudioByPeerID(peerID)(store);\n  return selectAudioTrackVolume(track?.id)(store);\n});\n\n/**\n * Select the current simulcast layer of a track given a track ID.\n */\nexport const selectSimulcastLayerByTrack = byIDCurry((store: HMSStore, trackID?: string) => {\n  const track = selectTrackByIDBare(store, trackID);\n  if (track) {\n    if (track.type !== 'video') {\n      HMSLogger.w('Please pass video track here');\n      return undefined;\n    }\n    return track.layer;\n  }\n  return undefined;\n});\n\nconst selectMessagesByPeerIDInternal = createSelector(\n  [selectHMSMessages, selectLocalPeerID, selectPeerID],\n  (messages, localPeerID, peerID) => {\n    if (!peerID) {\n      return undefined;\n    }\n    return messages.filter(message => {\n      // Broadcast message\n      if (!message.recipientPeer && !message.recipientRoles?.length) {\n        return false;\n      }\n      // if localPeer or peerID is not a sender remove this\n      if (message.sender && ![localPeerID, peerID].includes(message.sender)) {\n        return false;\n      }\n      // at this point we know the sender is one of local or passed in peer, check the recipient side\n      return [localPeerID, peerID].includes(message.recipientPeer!);\n    });\n  },\n);\n\nconst selectMessagesByRoleInternal = createSelector([selectHMSMessages, selectRoleName], (messages, roleName) => {\n  if (!roleName) {\n    return undefined;\n  }\n  return messages.filter(message => {\n    // Not Role message - Broadcast message or Private Peer message\n    if (!message.recipientRoles?.length) {\n      return false;\n    }\n    return message.recipientRoles?.includes(roleName);\n  });\n});\n\nexport const selectBroadcastMessages = createSelector(selectHMSMessages, messages => {\n  return messages.filter(message => {\n    return !message.recipientPeer && !message.recipientRoles?.length;\n  });\n});\n\nconst selectUnreadMessageCountByRole = createSelector([selectMessagesByRoleInternal, selectRoleName], messages => {\n  if (!messages) {\n    return 0;\n  }\n  return messages.filter(m => !m.read).length;\n});\n\nconst selectUnreadMessageCountByPeerID = createSelector([selectMessagesByPeerIDInternal, selectPeerID], messages => {\n  if (!messages) {\n    return 0;\n  }\n  return messages.filter(m => !m.read).length;\n});\n\nexport const selectBroadcastMessagesUnreadCount = createSelector(selectBroadcastMessages, messages => {\n  return messages.filter(m => !m.read).length;\n});\n\nexport const selectMessagesByPeerID = byIDCurry(selectMessagesByPeerIDInternal);\n\nexport const selectMessagesByRole = byIDCurry(selectMessagesByRoleInternal);\n\nexport const selectMessagesUnreadCountByRole = byIDCurry(selectUnreadMessageCountByRole);\nexport const selectMessagesUnreadCountByPeerID = byIDCurry(selectUnreadMessageCountByPeerID);\n\n/**\n * Select an array of peers of a particular role\n * @param role HMSRoleName\n * @returns HMSPeer[]\n */\nexport const selectPeersByRole = (role: HMSRoleName) =>\n  createSelector([selectPeers], peers => {\n    return peers.filter(p => p.roleName === role);\n  });\n\n/**\n * Select an array of peers of a particular role\n * @param roles HMSRoleName[]\n * @returns HMSPeer[]\n */\nexport const selectPeersByRoles = (roles: HMSRoleName[]) =>\n  createSelector([selectPeers], (peers: HMSPeer[]) => {\n    return peers.filter((peer: HMSPeer) => {\n      return peer.roleName ? roles.includes(peer.roleName) : false;\n    });\n  });\n/**\n * Selects the peer metadata for the passed in peer and returns it as JSON. If metadata is not present\n * or conversion to JSON gives an error, an empty object is returned.\n * Please directly use peer.metadata in case the metadata is not JSON by design.\n */\nexport const selectPeerMetadata = (peerId: HMSPeerID) =>\n  createSelector(selectPeerByID(peerId), peer => {\n    try {\n      return peer?.metadata && peer.metadata !== '' ? JSON.parse(peer.metadata) : {};\n    } catch (error) {\n      console.error('cannot parse peer metadata', error);\n      return {};\n    }\n  });\n\nexport const selectHasPeerHandRaised = (peerId: HMSPeerID) =>\n  createSelector(selectPeerByID(peerId), peer => {\n    return !!peer?.isHandRaised;\n  });\n\nexport const selectPeerName = (peerId: HMSPeerID) => createSelector(selectPeerByID(peerId), peer => peer?.name);\n\nexport const selectPollByID = byIDCurry(selectPollByIDBare);\n\nexport const selectMessageByMessageID = (id: string) =>\n  createSelector(selectMessagesMap, messages => {\n    return messages[id];\n  });\n\nexport const selectIsTranscriptionAllowedByMode = (mode: HMSTranscriptionMode) =>\n  createSelector(selectLocalPeerRole, role => {\n    if (!role?.permissions.transcriptions) {\n      return false;\n    }\n    // only one admin permission\n    return role.permissions.transcriptions[mode].length > 0;\n  });\n", "import { HMSStatsStore, HMSStore } from '../schema';\n\nexport type StoreTypes = HMSStore | HMSStatsStore;\n\ntype byIDSelector<S extends StoreTypes, T> = (store: S, id?: string) => T;\n\n/**\n * StoreSelector is a function that takes in {@link HMSStore} as argument\n * and returns a part of the store that is queried using the selector.\n * @typeParam T Part of the store that you wish to query.\n */\nexport type StoreSelector<S extends StoreTypes, T> = (store: S) => T;\n\n/**\n * takes in a normal selector which has store and id as input and curries it to make it easier to use.\n * Before: store.getState((store) => normalSelector(store, peerID))\n * After: store.getState(curriedSelector(peerID))\n */\nexport function byIDCurry<S extends StoreTypes, T>(selector: byIDSelector<S, T>): (id?: string) => StoreSelector<S, T> {\n  return (id?: string) => {\n    return (store: S) => selector(store, id);\n  };\n}\n", "import { HMSLogLevel } from '../internal';\n\nconst HMS_STORE_TAG = 'HMS-Store:';\n\nexport class HMSLogger {\n  static level: HMSLogLevel = HMSLogLevel.VERBOSE;\n\n  static v(tag: string, ...data: any[]) {\n    this.log(HMSLogLevel.VERBOSE, tag, ...data);\n  }\n\n  static d(...data: any[]) {\n    this.log(HMSLogLevel.DEBUG, ...data);\n  }\n\n  static i(...data: any[]) {\n    this.log(HMSLogLevel.INFO, ...data);\n  }\n\n  static w(...data: any[]) {\n    this.log(HMSLogLevel.WARN, ...data);\n  }\n\n  static e(...data: any[]) {\n    this.log(HMSLogLevel.ERROR, ...data);\n  }\n\n  static time(mark: string) {\n    this.log(HMSLogLevel.TIME, '[HMSPerformanceTiming]', mark);\n  }\n\n  static timeEnd(mark: string) {\n    this.log(HMSLogLevel.TIMEEND, '[HMSPerformanceTiming]', mark, mark);\n  }\n\n  static cleanup() {\n    performance.clearMarks();\n    performance.clearMeasures();\n  }\n\n  /* eslint-disable */\n  private static log(level: HMSLogLevel, ...data: any[]) {\n    if (this.level.valueOf() > level.valueOf()) {\n      return;\n    }\n\n    switch (level) {\n      case HMSLogLevel.VERBOSE: {\n        console.log(HMS_STORE_TAG, ...data);\n        break;\n      }\n      case HMSLogLevel.DEBUG: {\n        console.debug(HMS_STORE_TAG, ...data);\n        break;\n      }\n      case HMSLogLevel.INFO: {\n        console.info(HMS_STORE_TAG, ...data);\n        break;\n      }\n      case HMSLogLevel.WARN: {\n        console.warn(HMS_STORE_TAG, ...data);\n        break;\n      }\n      case HMSLogLevel.ERROR: {\n        console.error(HMS_STORE_TAG, ...data);\n        break;\n      }\n      case HMSLogLevel.TIME: {\n        performance.mark(data[1]);\n        break;\n      }\n      case HMSLogLevel.TIMEEND: {\n        const tag = data[0];\n        const mark = data[1];\n        try {\n          const entry = performance.measure(mark, mark);\n          //@ts-ignore\n          this.log(HMSLogLevel.DEBUG, tag, mark, entry?.duration);\n          performance.clearMarks(mark);\n          performance.clearMeasures(mark);\n        } catch (error) {\n          this.log(HMSLogLevel.DEBUG, tag, mark, error);\n        }\n        break;\n      }\n    }\n  }\n}\n", "import { createSelector } from 'reselect';\nimport { selectLocalPeerRole, selectPeersMap, selectPreviewRole, selectRolesMap, selectTracksMap } from './selectors';\nimport { isRoleAllowedToPublish } from './selectorUtils';\nimport { HMSRole } from '../internal';\nimport { HMSPeer, HMSStore } from '../schema';\n\nexport interface HMSPeerWithMuteStatus {\n  peer: HMSPeer;\n  isAudioEnabled?: boolean;\n}\n\n/**\n * @privateRemarks\n * this is more friendly to UI format, the object in store has only peer id and role name instead of the full objects\n */\nexport interface HMSRoleChangeRequest {\n  requestedBy?: HMSPeer;\n  role: HMSRole;\n  token: string;\n}\n\nexport const selectPeersWithAudioStatus = createSelector([selectPeersMap, selectTracksMap], (peersMap, tracksMap) => {\n  const participants: HMSPeerWithMuteStatus[] = Object.values(peersMap).map(peer => {\n    return {\n      peer: peer,\n      isAudioEnabled: peer.audioTrack ? tracksMap[peer.audioTrack]?.enabled : false,\n    };\n  });\n  return participants;\n});\n\nconst selectRoleChangeStoreRequest = (store: HMSStore) => {\n  return store.roleChangeRequests[0] || null;\n};\n\n/**\n * Select the role change request received for your local peer.\n */\nexport const selectRoleChangeRequest = createSelector(\n  [selectRoleChangeStoreRequest, selectPeersMap, selectRolesMap],\n  (request, peersMap, rolesMap): HMSRoleChangeRequest | null => {\n    if (!request) {\n      return null;\n    }\n    return {\n      requestedBy: request.requestedBy ? peersMap[request.requestedBy] : undefined,\n      role: rolesMap[request.roleName],\n      token: request.token,\n    };\n  },\n);\n\n/**\n * Select what streams is the local peer allowed to publish from video, audio and screenshare.\n */\nexport const selectIsAllowedToPublish = createSelector([selectLocalPeerRole], role => isRoleAllowedToPublish(role));\n\n/**\n * Select what streams is the local peer allowed to preview from video, audio\n */\nexport const selectIsAllowedToPreviewMedia = createSelector([selectPreviewRole], role => isRoleAllowedToPublish(role));\n", "import { createSelector } from 'reselect';\nimport {\n  selectLocalAudioTrackID,\n  selectLocalVideoTrackID,\n  selectPeers,\n  selectRolesMap,\n  selectRoom,\n  selectTracksMap,\n} from './selectors';\nimport { isRoleAllowedToPublish } from './selectorUtils';\nimport { HMSPeer, HMSTrack } from '../schema';\n\nexport const selectRoleByRoleName = (roleName: string) =>\n  createSelector([selectRolesMap], rolesMap => rolesMap[roleName]);\n\nexport const selectIsRoleAllowedToPublish = (roleName: string) => {\n  return createSelector(selectRoleByRoleName(roleName), role => isRoleAllowedToPublish(role));\n};\n\nconst selectLocalVideoPlugins = createSelector([selectLocalVideoTrackID, selectTracksMap], (trackID, tracksMap) => {\n  let track: HMSTrack | null = null;\n  if (trackID) {\n    track = tracksMap[trackID];\n  }\n  return track?.plugins || [];\n});\n\nconst selectLocalAudioPlugins = createSelector([selectLocalAudioTrackID, selectTracksMap], (trackID, tracksMap) => {\n  let track: HMSTrack | null = null;\n  if (trackID) {\n    track = tracksMap[trackID];\n  }\n  return track?.plugins || [];\n});\n\nexport const selectIsLocalVideoPluginPresent = (pluginName: string) => {\n  return createSelector([selectLocalVideoPlugins], plugins => {\n    return plugins.includes(pluginName);\n  });\n};\n\nexport const selectIsLocalAudioPluginPresent = (pluginName: string) => {\n  return createSelector([selectLocalAudioPlugins], plugins => {\n    return plugins.includes(pluginName);\n  });\n};\n\n/**\n * Selects the first peer passing the condition given by the argument predicate function\n *\n * Ex: to select a peer whose metadata has spotlight set to true(assuming peer.metadata is a valid json string), use\n * ```js\n * const spotlightPeer = useHMSStore(selectPeerByCondition(peer => JSON.parse(peer.metadata).spotlight))\n * ```\n */\nexport const selectPeerByCondition = (predicate: (peer: HMSPeer) => boolean) =>\n  createSelector(selectPeers, peers => {\n    return peers.find(predicate);\n  });\n\n/**\n * Selects all peers passing the condition given by the argument predicate function\n *\n * Ex: to select peers with isHandRaised set to true in their metadata(assuming peer.metadata is a valid json string), use\n * ```js\n * const handRaisedPeers = useHMSStore(selectPeersByCondition(peer => JSON.parse(peer.metadata).isHandRaised))\n * ```\n */\nexport const selectPeersByCondition = (predicate: (peer: HMSPeer) => boolean) =>\n  createSelector(selectPeers, peers => {\n    return peers.filter(predicate);\n  });\n\n/**\n * Returns a boolean to indicate if the local peer joined within the past `timeMs` milliseconds.\n *\n * Ex: to know if the local peer joined within the last one second\n * ```js\n * const joinedWithinASecond = useHMSStore(selectDidIJoinWithin(1000));\n * ```\n */\nexport const selectDidIJoinWithin = (timeMs: number) =>\n  createSelector(selectRoom, room => room.joinedAt && Date.now() - room.joinedAt.getTime() <= timeMs);\n", "import { produce } from 'immer';\nimport shallow from 'zustand/shallow';\nimport create, {\n  EqualityChecker,\n  PartialState,\n  SetState,\n  State,\n  StateSelector,\n  StateSliceListener,\n  StoreApi,\n} from 'zustand/vanilla';\nimport { HMSNotifications } from './HMSNotifications';\nimport { HMSSDKActions } from './HMSSDKActions';\nimport { NamedSetState } from './internalTypes';\nimport { storeNameWithTabTitle } from '../common/storeName';\nimport { HMSDiagnosticsInterface } from '../diagnostics/interfaces';\nimport { IHMSActions } from '../IHMSActions';\nimport { IHMSStatsStoreReadOnly, IHMSStore, IHMSStoreReadOnly, IStore } from '../IHMSStore';\nimport { isBrowser } from '../internal';\nimport { createDefaultStoreState, HMSGenericTypes, HMSStore } from '../schema';\nimport { IHMSNotifications } from '../schema/notification';\nimport { HMSSdk } from '../sdk';\nimport { HMSStats } from '../webrtc-stats';\n\ndeclare global {\n  interface Window {\n    __hms: HMSReactiveStore;\n    __triggerBeamEvent__: (args: any) => void;\n  }\n}\n\nexport class HMSReactiveStore<T extends HMSGenericTypes = { sessionStore: Record<string, any> }> {\n  private readonly sdk?: HMSSdk;\n  private readonly actions: IHMSActions<T>;\n  private readonly store: IHMSStore<T>;\n  private readonly notifications: HMSNotifications<T>;\n  private stats?: HMSStats;\n  private diagnostics?: HMSDiagnosticsInterface;\n  /** @TODO store flag for both HMSStore and HMSInternalsStore */\n  private initialTriggerOnSubscribe: boolean;\n\n  constructor(hmsStore?: IHMSStore<T>, hmsActions?: IHMSActions<T>, hmsNotifications?: HMSNotifications<T>) {\n    if (hmsStore) {\n      this.store = hmsStore;\n    } else {\n      this.store = HMSReactiveStore.createNewHMSStore<HMSStore<T>>(\n        storeNameWithTabTitle('HMSStore'),\n        createDefaultStoreState,\n      );\n    }\n    if (hmsNotifications) {\n      this.notifications = hmsNotifications;\n    } else {\n      this.notifications = new HMSNotifications(this.store);\n    }\n    if (hmsActions) {\n      this.actions = hmsActions;\n    } else {\n      this.sdk = new HMSSdk();\n      this.actions = new HMSSDKActions(this.store, this.sdk, this.notifications);\n    }\n\n    // @ts-ignore\n    this.actions.setFrameworkInfo({ type: 'js', sdkVersion: require('../../package.json').version });\n\n    this.initialTriggerOnSubscribe = false;\n\n    if (isBrowser) {\n      // @ts-ignore\n      window.__hms = this;\n    }\n  }\n\n  /**\n   * By default store.subscribe does not call the handler with the current state at time of subscription,\n   * this behaviour can be modified by calling this function. What it means is that instead of calling the\n   * handler only for changes which happen post subscription we'll also call it exactly once at the time\n   * of subscription with the current state. This behaviour is similar to that of BehaviourSubject in RxJS.\n   * This will be an irreversible change\n   *\n   * Note: you don't need this if you're using our react hooks, it takes care of this requirement.\n   */\n  triggerOnSubscribe(): void {\n    if (this.initialTriggerOnSubscribe) {\n      // already done\n      return;\n    }\n    HMSReactiveStore.makeStoreTriggerOnSubscribe(this.store);\n    this.initialTriggerOnSubscribe = true;\n  }\n\n  /**\n   * A reactive store which has a subscribe method you can use in combination with selectors\n   * to subscribe to a subset of the store. The store serves as a single source of truth for\n   * all data related to the corresponding HMS Room.\n   */\n  getStore(): IHMSStoreReadOnly {\n    return this.store;\n  }\n\n  /**\n   * Any action which may modify the store or may need to talk to the SDK will happen\n   * through the IHMSActions instance returned by this\n   *\n   * @deprecated use getActions\n   */\n  getHMSActions(): IHMSActions<T> {\n    return this.actions;\n  }\n\n  /**\n   * Any action which may modify the store or may need to talk to the SDK will happen\n   * through the IHMSActions instance returned by this\n   */\n  getActions(): IHMSActions<T> {\n    return this.actions;\n  }\n\n  /**\n   * This return notification handler function to which you can pass your callback to\n   * receive notifications like peer joined, peer left, etc. to show in your UI or use\n   * for analytics\n   */\n  getNotifications(): IHMSNotifications {\n    return { onNotification: this.notifications.onNotification };\n  }\n\n  /**\n   * @alpha\n   */\n  getStats = (): IHMSStatsStoreReadOnly => {\n    if (!this.stats) {\n      this.stats = new HMSStats(this.store as unknown as IHMSStore, this.sdk);\n    }\n    return this.stats;\n  };\n\n  getDiagnosticsSDK = (): HMSDiagnosticsInterface => {\n    if (!this.diagnostics) {\n      this.diagnostics = this.actions.initDiagnostics();\n    }\n\n    return this.diagnostics;\n  };\n\n  /**\n   * @internal\n   */\n  static createNewHMSStore<T extends State>(storeName: string, defaultCreatorFn: () => T): IStore<T> {\n    const hmsStore = create<T>(() => defaultCreatorFn());\n    // make set state immutable, by passing functions through immer\n    const savedSetState = hmsStore.setState;\n    hmsStore.setState = (partial: any) => {\n      const nextState = typeof partial === 'function' ? produce(partial) : partial;\n      savedSetState(nextState);\n    };\n    // add option to pass selector to getState\n    const prevGetState = hmsStore.getState;\n    // eslint-disable-next-line complexity\n    hmsStore.getState = <StateSlice>(selector?: StateSelector<T, StateSlice>) => {\n      return selector ? selector(prevGetState()) : prevGetState();\n    };\n    HMSReactiveStore.compareWithShallowCheckInSubscribe(hmsStore);\n    const namedSetState = HMSReactiveStore.setUpDevtools(hmsStore, storeName);\n    return { ...hmsStore, namedSetState };\n  }\n\n  /**\n   * @internal\n   */\n  static makeStoreTriggerOnSubscribe<T extends State>(store: IStore<T>) {\n    const prevSubscribe = store.subscribe;\n    store.subscribe = <StateSlice>(\n      listener: StateSliceListener<StateSlice>,\n      selector?: StateSelector<T, StateSlice>,\n      equalityFn?: EqualityChecker<StateSlice>,\n    ): (() => void) => {\n      // initial call, the prev state will always be null for this\n      listener(store.getState(selector), undefined as unknown as StateSlice);\n      // then subscribe\n      return prevSubscribe(listener, selector!, equalityFn);\n    };\n  }\n\n  /**\n   * use shallow equality check by default for subscribe to optimize for array/object selectors.\n   * by default zustand does only reference matching so something like, getPeers for eg. would trigger\n   * the corresponding component even if peers didn't actually change, as selectPeers creates a new array every time.\n   * Although the array reference changes, the order of peers and peer objects don't themselves change in this case,\n   * and a shallow check avoids that triggering.\n   * @private\n   */\n  private static compareWithShallowCheckInSubscribe<T extends State>(hmsStore: StoreApi<T>) {\n    const prevSubscribe = hmsStore.subscribe;\n    hmsStore.subscribe = <StateSlice>(\n      listener: StateSliceListener<StateSlice>,\n      selector?: StateSelector<T, StateSlice>,\n      equalityFn?: EqualityChecker<StateSlice>,\n    ): (() => void) => {\n      if (!selector) {\n        selector = (store): StateSlice => store as unknown as StateSlice;\n      }\n      equalityFn = equalityFn || shallow;\n      return prevSubscribe(listener, selector, equalityFn);\n    };\n  }\n\n  /**\n   * @private\n   * @privateRemarks\n   * sets up redux devtools for the store, so redux extension can be used to visualize the store.\n   * zustand's default devtool middleware only enhances the set function, we're here creating another nameSetState in\n   * IHMStore which behaves like setState but takes an extra parameter for action name\n   * https://github.com/zalmoxisus/redux-devtools-extension/blob/master/docs/API/Methods.md\n   * modified version of zustand's devtools - https://github.com/pmndrs/zustand/blob/v3.5.7/src/middleware.ts#L46\n   */\n  private static setUpDevtools<T extends State>(api: StoreApi<T>, prefix: string): NamedSetState<T> {\n    let extension;\n    try {\n      extension = (window as any).__REDUX_DEVTOOLS_EXTENSION__ || (window as any).top.__REDUX_DEVTOOLS_EXTENSION__;\n    } catch {}\n    if (!extension) {\n      return (fn: any) => {\n        api.setState(fn);\n      };\n    }\n    const devtools = extension.connect(HMSReactiveStore.devtoolsOptions(prefix));\n    devtools.prefix = prefix ? `${prefix} > ` : '';\n    const savedSetState = api.setState;\n    api.setState = (fn: any) => {\n      savedSetState(fn);\n      devtools.send(`${devtools.prefix}setState`, api.getState());\n    };\n\n    devtools.subscribe(HMSReactiveStore.devtoolsSubscribe(devtools, api, savedSetState));\n\n    devtools.send('setUpStore', api.getState());\n\n    return (fn: any, action?: string) => {\n      savedSetState(fn);\n      const actionName = action ? action : `${devtools.prefix}action`;\n      devtools.send(actionName, api.getState());\n    };\n  }\n\n  /**\n   * https://github.com/zalmoxisus/redux-devtools-extension/blob/master/docs/API/Arguments.md\n   */\n  private static devtoolsOptions(prefix: string) {\n    return {\n      name: prefix,\n      actionsBlacklist: ['audioLevel', 'playlistProgress', 'connectionQuality'], // very high frequency update, pollutes the action history\n    };\n  }\n\n  /**\n   * redux devtools allows for time travel debugging where it sends an action to update the store, users can\n   * also export and import state in the devtools, listen to the corresponding functions from devtools and take\n   * required action.\n   * @param devtools - reference to devtools extension object\n   * @param api\n   * @param savedSetState - setState saved before its modified to update devtools\n   * @private\n   */\n  private static devtoolsSubscribe<T extends State>(devtools: any, api: StoreApi<T>, savedSetState: SetState<T>) {\n    // disabling complexity check instead of refactoring so as to keep the code close to zustand's and make\n    // any future update based on upstream changes easier.\n    // eslint-disable-next-line complexity\n    return (message: any) => {\n      if (message.type === 'DISPATCH' && message.state) {\n        const ignoreState = ['JUMP_TO_ACTION', 'JUMP_TO_STATE'].includes(message.payload.type);\n        if (!ignoreState) {\n          // manual dispatch from the extension\n          api.setState(JSON.parse(message.state));\n        } else {\n          // for time travel, no need to add new state changes in devtools\n          savedSetState(JSON.parse(message.state));\n        }\n      } else if (message.type === 'DISPATCH' && message.payload?.type === 'COMMIT') {\n        devtools.init(api.getState());\n      } else if (message.type === 'DISPATCH' && message.payload?.type === 'IMPORT_STATE') {\n        const actions = message.payload.nextLiftedState?.actionsById;\n        const computedStates = message.payload.nextLiftedState?.computedStates || [];\n\n        computedStates.forEach(({ state }: { state: PartialState<T> }, index: number) => {\n          const action = actions[index] || `${devtools.prefix}setState`;\n          if (index === 0) {\n            devtools.init(state);\n          } else {\n            savedSetState(state);\n            devtools.send(action, api.getState());\n          }\n        });\n      }\n    };\n  }\n}\n", "import { EventEmitter2 as EventEmitter } from 'eventemitter2';\nimport {\n  PEER_NOTIFICATION_TYPES,\n  POLL_NOTIFICATION_TYPES,\n  TRACK_NOTIFICATION_TYPES,\n  TRANSCRIPTION_NOTIFICATION_TYPES,\n} from './common/mapping';\nimport { IHMSStore } from '../IHMSStore';\nimport * as sdkTypes from '../internal';\nimport {\n  HMSChangeMultiTrackStateRequest,\n  HMSChangeTrackStateRequest,\n  HMSDeviceChangeEvent,\n  HMSException,\n  HMSGenericTypes,\n  HMSLeaveRoomRequest,\n  HMSMessage,\n  HMSNotification,\n  HMSNotificationSeverity,\n  HMSNotificationTypes,\n  HMSPeer,\n  HMSPlaylistItem,\n  HMSTrack,\n  HMSTrackID,\n} from '../schema';\nimport {\n  HMSNotificationCallback,\n  HMSNotificationInCallback,\n  HMSNotificationTypeParam,\n  IHMSNotifications,\n} from '../schema/notification';\nimport { selectPeerByID, selectPollByID, selectTrackByID } from '../selectors';\n\nconst HMS_NOTIFICATION_EVENT = 'hmsNotification';\n\nexport class HMSNotifications<T extends HMSGenericTypes = { sessionStore: Record<string, any> }>\n  implements IHMSNotifications\n{\n  private id = 0;\n  private eventEmitter: EventEmitter;\n  private store: IHMSStore<T>;\n\n  constructor(store: IHMSStore<T>) {\n    this.store = store;\n    this.eventEmitter = new EventEmitter({ maxListeners: Object.keys(HMSNotificationTypes).length });\n  }\n  onNotification = <T extends HMSNotificationTypeParam>(cb: HMSNotificationCallback<T>, type?: T) => {\n    const eventCallback = (notification: HMSNotificationInCallback<T>) => {\n      if (type) {\n        let matchesType: boolean;\n        if (Array.isArray(type)) {\n          matchesType = type.includes(notification.type as HMSNotificationTypes);\n        } else {\n          matchesType = type === notification.type;\n        }\n        if (!matchesType) {\n          return;\n        }\n      }\n      cb(notification);\n    };\n    this.eventEmitter.addListener(HMS_NOTIFICATION_EVENT, eventCallback);\n    return () => {\n      this.eventEmitter.removeListener(HMS_NOTIFICATION_EVENT, eventCallback);\n    };\n  };\n\n  sendPlaylistTrackEnded<T>(item: HMSPlaylistItem<T>): void {\n    const notification = this.createNotification(\n      HMSNotificationTypes.PLAYLIST_TRACK_ENDED,\n      item,\n      HMSNotificationSeverity.INFO,\n    );\n    this.emitEvent(notification);\n  }\n\n  sendDeviceChange(request: HMSDeviceChangeEvent) {\n    const notification = this.createNotification(\n      HMSNotificationTypes.DEVICE_CHANGE_UPDATE,\n      request,\n      request.error ? HMSNotificationSeverity.ERROR : HMSNotificationSeverity.INFO,\n      `Selected ${request.type} device - ${request.selection?.label}`,\n    );\n    this.emitEvent(notification);\n  }\n\n  sendLeaveRoom(request: HMSLeaveRoomRequest) {\n    const peerName = request.requestedBy?.name;\n    const notification = this.createNotification(\n      request.roomEnded || !peerName ? HMSNotificationTypes.ROOM_ENDED : HMSNotificationTypes.REMOVED_FROM_ROOM,\n      request,\n      HMSNotificationSeverity.INFO,\n      `${request.roomEnded ? `Room ended` : 'Removed from room'} ${peerName ? `by ${peerName}` : ''}`,\n    );\n    this.emitEvent(notification);\n  }\n\n  sendPeerList(peers: HMSPeer[]) {\n    if (peers.length === 0) {\n      return;\n    }\n    const notification = this.createNotification(HMSNotificationTypes.PEER_LIST, peers, HMSNotificationSeverity.INFO);\n    this.emitEvent(notification);\n  }\n\n  sendPeerUpdate(type: sdkTypes.HMSPeerUpdate, peer: HMSPeer | null) {\n    const hmsPeer = this.store.getState(selectPeerByID(peer?.id)) || peer;\n    const notificationType = PEER_NOTIFICATION_TYPES[type];\n    if (notificationType && hmsPeer) {\n      const notification = this.createNotification(notificationType, hmsPeer, HMSNotificationSeverity.INFO);\n      this.emitEvent(notification);\n    }\n  }\n\n  sendTrackUpdate(type: sdkTypes.HMSTrackUpdate, trackID: HMSTrackID) {\n    const hmsTrack = this.store.getState(selectTrackByID(trackID));\n    const notificationType = TRACK_NOTIFICATION_TYPES[type];\n    if (notificationType) {\n      const notification = this.createNotification(notificationType, hmsTrack, HMSNotificationSeverity.INFO);\n      this.emitEvent(notification);\n    }\n  }\n\n  sendMessageReceived(message: HMSMessage) {\n    const notification = this.createNotification(\n      HMSNotificationTypes.NEW_MESSAGE,\n      message,\n      HMSNotificationSeverity.INFO,\n    );\n    this.emitEvent(notification);\n  }\n\n  sendError(error: HMSException) {\n    const notification = this.createNotification(HMSNotificationTypes.ERROR, error, HMSNotificationSeverity.ERROR);\n    this.emitEvent(notification);\n  }\n\n  sendReconnecting(error: HMSException) {\n    const notification = this.createNotification(\n      HMSNotificationTypes.RECONNECTING,\n      error,\n      HMSNotificationSeverity.ERROR,\n    );\n    this.emitEvent(notification);\n  }\n\n  sendReconnected() {\n    const notification = this.createNotification(HMSNotificationTypes.RECONNECTED, null, HMSNotificationSeverity.INFO);\n    this.emitEvent(notification);\n  }\n\n  sendChangeTrackStateRequest(request: HMSChangeTrackStateRequest) {\n    const notification = this.createNotification(\n      HMSNotificationTypes.CHANGE_TRACK_STATE_REQUEST,\n      request,\n      HMSNotificationSeverity.INFO,\n    );\n    this.emitEvent(notification);\n  }\n\n  sendChangeMultiTrackStateRequest(request: HMSChangeMultiTrackStateRequest) {\n    const notification = this.createNotification(\n      HMSNotificationTypes.CHANGE_MULTI_TRACK_STATE_REQUEST,\n      request,\n      HMSNotificationSeverity.INFO,\n    );\n    this.emitEvent(notification);\n  }\n\n  sendPollUpdate(type: sdkTypes.HMSPollsUpdate, pollID: string) {\n    const notificationType = POLL_NOTIFICATION_TYPES[type];\n    const poll = this.store.getState(selectPollByID(pollID));\n\n    if (notificationType) {\n      const notification = this.createNotification(notificationType, poll, HMSNotificationSeverity.INFO);\n      this.emitEvent(notification);\n    }\n  }\n\n  sendTranscriptionUpdate(transcriptions?: sdkTypes.HMSTranscriptionInfo[]) {\n    const notification = this.createNotification(\n      TRANSCRIPTION_NOTIFICATION_TYPES[sdkTypes.HMSRoomUpdate.TRANSCRIPTION_STATE_UPDATED],\n      transcriptions,\n      HMSNotificationSeverity.INFO,\n    );\n    this.emitEvent(notification);\n  }\n  private emitEvent(notification: HMSNotification) {\n    this.eventEmitter.emit(HMS_NOTIFICATION_EVENT, notification);\n  }\n\n  private createNotification<T>(\n    type: HMSNotificationTypes,\n    data?:\n      | HMSPeer\n      | HMSPeer[]\n      | HMSTrack\n      | HMSMessage\n      | HMSException\n      | HMSChangeTrackStateRequest\n      | HMSChangeMultiTrackStateRequest\n      | HMSLeaveRoomRequest\n      | HMSDeviceChangeEvent\n      | HMSPlaylistItem<T>\n      | sdkTypes.HMSPoll\n      | sdkTypes.HMSTranscriptionInfo[]\n      | null,\n    severity?: HMSNotificationSeverity,\n    message = '',\n  ): HMSNotification {\n    this.id++;\n    return {\n      id: this.id,\n      type,\n      message,\n      data,\n      severity,\n    } as HMSNotification;\n  }\n}\n", "import * as sdkTypes from '../../internal';\nimport { HMSNotificationTypes } from '../../schema/notification';\n\ntype PeerNotificationMap = { [key in sdkTypes.HMSPeerUpdate]?: HMSNotificationTypes };\n\nexport const PEER_NOTIFICATION_TYPES: PeerNotificationMap = {\n  [sdkTypes.HMSPeerUpdate.PEER_JOINED]: HMSNotificationTypes.PEER_JOINED,\n  [sdkTypes.HMSPeerUpdate.PEER_LEFT]: HMSNotificationTypes.PEER_LEFT,\n  [sdkTypes.HMSPeerUpdate.ROLE_UPDATED]: HMSNotificationTypes.ROLE_UPDATED,\n  [sdkTypes.HMSPeerUpdate.NAME_UPDATED]: HMSNotificationTypes.NAME_UPDATED,\n  [sdkTypes.HMSPeerUpdate.METADATA_UPDATED]: HMSNotificationTypes.METADATA_UPDATED,\n  [sdkTypes.HMSPeerUpdate.HAND_RAISE_CHANGED]: HMSNotificationTypes.HAND_RAISE_CHANGED,\n};\n\ntype TrackNotificationMap = { [key in sdkTypes.HMSTrackUpdate]: HMSNotificationTypes };\nexport const TRACK_NOTIFICATION_TYPES: TrackNotificationMap = {\n  [sdkTypes.HMSTrackUpdate.TRACK_ADDED]: HMSNotificationTypes.TRACK_ADDED,\n  [sdkTypes.HMSTrackUpdate.TRACK_REMOVED]: HMSNotificationTypes.TRACK_REMOVED,\n  [sdkTypes.HMSTrackUpdate.TRACK_MUTED]: HMSNotificationTypes.TRACK_MUTED,\n  [sdkTypes.HMSTrackUpdate.TRACK_UNMUTED]: HMSNotificationTypes.TRACK_UNMUTED,\n  [sdkTypes.HMSTrackUpdate.TRACK_DEGRADED]: HMSNotificationTypes.TRACK_DEGRADED,\n  [sdkTypes.HMSTrackUpdate.TRACK_RESTORED]: HMSNotificationTypes.TRACK_RESTORED,\n  [sdkTypes.HMSTrackUpdate.TRACK_DESCRIPTION_CHANGED]: HMSNotificationTypes.TRACK_DESCRIPTION_CHANGED,\n};\n\ntype PollNotificationMap = { [key in sdkTypes.HMSPollsUpdate]: HMSNotificationTypes };\n\nexport const POLL_NOTIFICATION_TYPES: PollNotificationMap = {\n  [sdkTypes.HMSPollsUpdate.POLL_CREATED]: HMSNotificationTypes.POLL_CREATED,\n  [sdkTypes.HMSPollsUpdate.POLL_STARTED]: HMSNotificationTypes.POLL_STARTED,\n  [sdkTypes.HMSPollsUpdate.POLL_STOPPED]: HMSNotificationTypes.POLL_STOPPED,\n  [sdkTypes.HMSPollsUpdate.POLL_STATS_UPDATED]: HMSNotificationTypes.POLL_VOTES_UPDATED,\n  [sdkTypes.HMSPollsUpdate.POLLS_LIST]: HMSNotificationTypes.POLLS_LIST,\n};\n\ntype TranscriptionNotificationMap = {\n  [key in sdkTypes.HMSRoomUpdate.TRANSCRIPTION_STATE_UPDATED]: HMSNotificationTypes;\n};\n\nexport const TRANSCRIPTION_NOTIFICATION_TYPES: TranscriptionNotificationMap = {\n  [sdkTypes.HMSRoomUpdate.TRANSCRIPTION_STATE_UPDATED]: HMSNotificationTypes.TRANSCRIPTION_STATE_UPDATED,\n};\n", "import { HMSLogger } from '../../common/ui-logger';\nimport { IHMSStore } from '../../IHMSStore';\nimport { HMSGenericTypes, HMSStore } from '../../schema';\n\ntype ActionName = string;\ntype SetTimeOutId = number;\ntype SetState = (store: HMSStore) => void;\n\n/**\n * pass in an action and an update function, the update functions will be batched and run such that\n * store updates are limited to only one action in a time interval\n *\n */\nexport class ActionBatcher<T extends HMSGenericTypes = { sessionStore: Record<string, any> }> {\n  private queuedUpdates: Record<ActionName, SetState[]> = {};\n  private timers: Record<ActionName, SetTimeOutId> = {};\n  private DEFAULT_INTERVAL_MS = 50;\n  private store: IHMSStore<T>;\n  constructor(store: IHMSStore<T>) {\n    this.store = store;\n  }\n\n  setState(fn: SetState, action: ActionName, timeout = this.DEFAULT_INTERVAL_MS) {\n    this.queuedUpdates[action] = this.queuedUpdates[action] || [];\n    this.queuedUpdates[action].push(fn);\n    if (this.timers[action]) {\n      return;\n    }\n    // set a future timeout if a timer is not there already\n    if (window) {\n      this.timers[action] = window.setTimeout(() => this.setStateBatched(action), timeout);\n    } else {\n      // nodejs, ignore batching for now\n      this.setStateBatched(action);\n    }\n  }\n\n  private setStateBatched(action: ActionName) {\n    if (this.queuedUpdates[action]?.length > 0) {\n      const batchedFn = (draftStore: HMSStore) => {\n        this.queuedUpdates[action].forEach(fn => {\n          try {\n            fn(draftStore);\n          } catch (err) {\n            HMSLogger.w('failed to update store', err);\n          }\n        });\n      };\n      console.time(`timed-${action}`);\n      this.store.namedSetState(batchedFn, action);\n      console.timeEnd(`timed-${action}`);\n    }\n    // cleanup\n    delete this.queuedUpdates[action];\n    if (window && this.timers[action]) {\n      window.clearTimeout(this.timers[action]);\n      delete this.timers[action];\n    }\n  }\n}\n", "import { HMSRemoteAudioTrack, HMSRemoteVideoTrack, HMSTrack } from '../../internal';\n\nexport function isRemoteTrack(track: HMSTrack) {\n  return track instanceof HMSRemoteAudioTrack || track instanceof HMSRemoteVideoTrack;\n}\n", "import { HMSPeerStats, HMSTrackStats } from '../../interfaces';\nimport { HMSLocalTrack as SDKHMSLocalTrack, HMSPoll } from '../../internal';\nimport { HMSPeer, HMSPeerID, HMSScreenVideoTrack, HMSTrack, HMSTrackID, HMSVideoTrack } from '../../schema';\n\n/**\n * updates draftPeers with newPeers ensuring minimal reference changes\n * @remarks\n * This is mutable and impure function, it modifies the passed in data to ensure\n * minimal reference changes\n * @param draftPeers the current peers object in store, an immer draft object\n * @param newPeers the latest update which needs to be stored\n * @param newHmsTracks this will be update if required\n * @param newHmsSDkTracks this is future value of local hms tacks map\n */\n// eslint-disable-next-line complexity\nexport const mergeNewPeersInDraft = (\n  draftPeers: Record<HMSPeerID, HMSPeer>,\n  newPeers: Record<HMSPeerID, Partial<HMSPeer>>,\n) => {\n  const peerIDs = union(Object.keys(draftPeers), Object.keys(newPeers));\n  for (const peerID of peerIDs) {\n    const oldPeer = draftPeers[peerID];\n    const newPeer = newPeers[peerID];\n    if (isEntityUpdated(oldPeer, newPeer)) {\n      if (areArraysEqual(oldPeer.auxiliaryTracks, newPeer.auxiliaryTracks)) {\n        newPeer.auxiliaryTracks = oldPeer.auxiliaryTracks;\n      }\n      if (oldPeer.groups && areArraysEqual(oldPeer.groups, newPeer.groups)) {\n        newPeer.groups = oldPeer.groups;\n      }\n      Object.assign(oldPeer, newPeer);\n    } else if (isEntityRemoved(oldPeer, newPeer)) {\n      delete draftPeers[peerID];\n    } else if (isEntityAdded(oldPeer, newPeer)) {\n      draftPeers[peerID] = newPeer as HMSPeer;\n    }\n  }\n};\n\nexport const mergeNewTracksInDraft = (\n  draftTracks: Record<HMSTrackID, HMSTrack>,\n  newTracks: Record<HMSTrackID, Partial<HMSTrack>>,\n) => {\n  const trackIDs = union(Object.keys(draftTracks), Object.keys(newTracks));\n  for (const trackID of trackIDs) {\n    const oldTrack = draftTracks[trackID];\n    const newTrack = newTracks[trackID];\n    if (isEntityUpdated(oldTrack, newTrack)) {\n      mergeTrackArrayFields(oldTrack, newTrack);\n      Object.assign(oldTrack, newTrack);\n    } else if (isEntityRemoved(oldTrack, newTrack)) {\n      delete draftTracks[trackID];\n    } else if (isEntityAdded(oldTrack, newTrack)) {\n      draftTracks[trackID] = newTrack as HMSTrack;\n    }\n  }\n};\n\nexport const mergeNewPollsInDraft = (\n  draftPolls: Record<string, HMSPoll>,\n  newPolls: Record<string, Partial<HMSPoll>>,\n) => {\n  const pollIDs = union(Object.keys(draftPolls), Object.keys(newPolls));\n  for (const pollID of pollIDs) {\n    const oldPoll = draftPolls[pollID];\n    const newPoll = newPolls[pollID];\n    if (isEntityUpdated(oldPoll, newPoll)) {\n      if (oldPoll.questions && areArraysEqual(oldPoll.questions, newPoll.questions)) {\n        newPoll.questions = oldPoll.questions;\n      }\n      Object.assign(oldPoll, newPoll);\n    } else if (isEntityAdded(oldPoll, newPoll)) {\n      draftPolls[pollID] = newPoll as HMSPoll;\n    }\n  }\n};\n\nexport const mergeNewIndividualStatsInDraft = <TID extends string, T extends HMSPeerStats | HMSTrackStats>(\n  draftStats: Record<TID, T | undefined>,\n  newStats: Record<TID, Partial<T | undefined>>,\n) => {\n  const IDs = union(Object.keys(draftStats), Object.keys(newStats)) as TID[];\n  for (const trackID of IDs) {\n    const oldStat = draftStats[trackID];\n    const newStat = newStats[trackID];\n    if (isEntityUpdated(oldStat, newStat)) {\n      Object.assign(oldStat!, newStat);\n    } else if (isEntityRemoved(oldStat, newStat)) {\n      delete draftStats[trackID];\n    } else if (isEntityAdded(oldStat, newStat)) {\n      draftStats[trackID] = newStat as T;\n    }\n  }\n};\n\nexport const mergeLocalTrackStats = (\n  draftStats: Record<HMSTrackID, HMSTrackStats[] | undefined>,\n  newStats: Record<HMSTrackID, Record<string, HMSTrackStats>>,\n  tracks: SDKHMSLocalTrack[],\n) => {\n  const trackMap: Record<string, HMSTrackStats[]> = tracks.reduce((acc, track) => {\n    // @ts-ignore\n    acc[track.firstTrackId] = Object.values(newStats[track.getTrackIDBeingSent()] || {}).sort((a, b) => {\n      if (!a.rid || !b.rid) {\n        return 0;\n      }\n      return a.rid < b.rid ? -1 : 1;\n    });\n    return acc;\n  }, {});\n  const IDs = union(Object.keys(draftStats), Object.keys(trackMap));\n  for (const trackID of IDs) {\n    if (!trackMap[trackID]) {\n      delete draftStats[trackID];\n      continue;\n    }\n    draftStats[trackID] = trackMap[trackID];\n  }\n};\n\n/**\n * array's are usually created with new reference, avoid that update if both arrays are same\n */\nexport const mergeTrackArrayFields = (oldTrack: HMSTrack, newTrack: Partial<HMSTrack>) => {\n  if (oldTrack.plugins && areArraysEqual(oldTrack.plugins, newTrack.plugins)) {\n    newTrack.plugins = oldTrack.plugins;\n  }\n  if (\n    oldTrack.type === 'video' &&\n    oldTrack.layerDefinitions &&\n    areArraysEqual(oldTrack.layerDefinitions, (newTrack as HMSVideoTrack | HMSScreenVideoTrack).layerDefinitions)\n  ) {\n    (newTrack as HMSVideoTrack | HMSScreenVideoTrack).layerDefinitions = oldTrack.layerDefinitions;\n  }\n};\n\nexport const isEntityUpdated = <T>(oldItem: T, newItem: T) => oldItem && newItem;\nconst isEntityRemoved = <T>(oldItem: T, newItem: T) => oldItem && !newItem;\nconst isEntityAdded = <T>(oldItem: T, newItem: T) => !oldItem && newItem;\n\n// eslint-disable-next-line complexity\nexport const areArraysEqual = <T>(arr1: T[], arr2?: T[]): boolean => {\n  if (arr1 === arr2 || (arr1.length === 0 && arr2?.length === 0)) {\n    // reference check\n    return true;\n  }\n  if (!arr1 || !arr2 || !(arr1.length === arr2.length)) {\n    return false;\n  }\n  for (let i = 0; i < arr1.length; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n};\n\nconst union = <T>(arr1: T[], arr2: T[]): T[] => {\n  const set: Set<T> = new Set();\n  for (const elem of arr1) {\n    set.add(elem);\n  }\n  for (const elem of arr2) {\n    set.add(elem);\n  }\n  return Array.from(set);\n};\n", "import { areArraysEqual } from './sdkUtils/storeMergeUtils';\nimport * as sdkTypes from '../internal';\nimport {\n  HMSLocalAudioTrack as SDKHMSLocalAudioTrack,\n  HMSLocalVideoTrack as SDKHMSLocalVideoTrack,\n  HMSRemoteAudioTrack as SDKHMSRemoteAudioTrack,\n  HMSRemoteVideoTrack as SDKHMSRemoteVideoTrack,\n  HMSRoleChangeRequest as SDKHMSRoleChangeRequest,\n  HMSTrack as SDKHMSTrack,\n} from '../internal';\nimport { MessageNotification } from '../notification-manager';\nimport {\n  HMSAudioTrack,\n  HMSDeviceChangeEvent,\n  HMSException,\n  HMSMessage,\n  HMSPeer,\n  HMSPeerID,\n  HMSPlaylistItem,\n  HMSPlaylistType,\n  HMSRole,\n  HMSRoleChangeStoreRequest,\n  HMSRoleName,\n  HMSRoom,\n  HMSScreenVideoTrack,\n  HMSTrack,\n  HMSTrackFacingMode,\n  HMSVideoTrack,\n} from '../schema';\n\n/**\n * This file has conversion functions from schema defined in sdk to normalised schema defined in store.\n * A lot of conversions below involve deep clone as once the object goes into store it becomes unmodifiable\n * due to immer, so it can't be mutated later.\n *\n * Objects directly from the SDK are not stored as is and cloned because the SDK might modify it later\n */\n\nexport class SDKToHMS {\n  static convertPeer(sdkPeer: sdkTypes.HMSPeer): Partial<HMSPeer> & Pick<HMSPeer, 'id'> {\n    return {\n      id: sdkPeer.peerId,\n      name: sdkPeer.name,\n      roleName: sdkPeer.role?.name,\n      isLocal: sdkPeer.isLocal,\n      videoTrack: sdkPeer.videoTrack?.trackId,\n      audioTrack: sdkPeer.audioTrack?.trackId,\n      auxiliaryTracks: sdkPeer.auxiliaryTracks.map(track => track.trackId),\n      customerUserId: sdkPeer.customerUserId,\n      metadata: sdkPeer.metadata,\n      joinedAt: sdkPeer.joinedAt,\n      groups: sdkPeer.groups,\n      isHandRaised: sdkPeer.isHandRaised,\n      type: sdkPeer.type,\n    };\n  }\n\n  static convertTrack(sdkTrack: SDKHMSTrack, peerId?: HMSPeerID): HMSTrack {\n    const track: HMSTrack = {\n      id: sdkTrack.trackId,\n      source: sdkTrack.source,\n      type: sdkTrack.type,\n      enabled: sdkTrack.enabled,\n      displayEnabled: sdkTrack.enabled,\n      peerId: sdkTrack.peerId || peerId,\n    } as HMSTrack;\n    this.enrichTrack(track, sdkTrack);\n    return track;\n  }\n\n  static enrichTrack(track: HMSTrack, sdkTrack: SDKHMSTrack) {\n    const mediaSettings = sdkTrack.getMediaTrackSettings();\n\n    if (sdkTrack instanceof SDKHMSRemoteAudioTrack) {\n      (track as HMSAudioTrack).volume = sdkTrack.getVolume() || 0;\n    }\n    SDKToHMS.updateDeviceID(track, sdkTrack);\n    SDKToHMS.enrichLocalTrack(track, sdkTrack);\n    if (track.type === 'video') {\n      if (track.source === 'screen') {\n        // @ts-ignore\n        track.displaySurface = mediaSettings.displaySurface;\n        SDKToHMS.enrichScreenTrack(track as HMSScreenVideoTrack, sdkTrack);\n      } else if (track.source === 'regular') {\n        (track as HMSVideoTrack).facingMode = mediaSettings.facingMode as HMSTrackFacingMode;\n      }\n      track.height = mediaSettings.height;\n      track.width = mediaSettings.width;\n      SDKToHMS.enrichVideoTrack(track as HMSVideoTrack, sdkTrack);\n    }\n    SDKToHMS.enrichPluginsDetails(track, sdkTrack);\n  }\n\n  static enrichLocalTrack(track: HMSTrack, sdkTrack: SDKHMSTrack) {\n    if (sdkTrack instanceof SDKHMSLocalVideoTrack || sdkTrack instanceof SDKHMSLocalAudioTrack) {\n      track.isPublished = sdkTrack.isPublished;\n    }\n  }\n\n  static updateDeviceID(track: HMSTrack, sdkTrack: SDKHMSTrack) {\n    if (sdkTrack instanceof SDKHMSLocalVideoTrack || sdkTrack instanceof SDKHMSLocalAudioTrack) {\n      track.deviceID = sdkTrack.settings.deviceId;\n    } else {\n      track.deviceID = sdkTrack.getMediaTrackSettings()?.deviceId;\n    }\n  }\n\n  static enrichVideoTrack(track: HMSVideoTrack, sdkTrack: SDKHMSTrack) {\n    if (sdkTrack instanceof SDKHMSRemoteVideoTrack) {\n      track.layer = sdkTrack.getLayer();\n      track.preferredLayer = sdkTrack.getPreferredLayer();\n      track.degraded = sdkTrack.degraded;\n    }\n    if (sdkTrack instanceof SDKHMSRemoteVideoTrack || sdkTrack instanceof SDKHMSLocalVideoTrack) {\n      if (!areArraysEqual(sdkTrack.getSimulcastDefinitions(), track.layerDefinitions)) {\n        track.layerDefinitions = sdkTrack.getSimulcastDefinitions();\n      }\n    }\n  }\n\n  static enrichScreenTrack(track: HMSScreenVideoTrack, sdkTrack: SDKHMSTrack) {\n    if (sdkTrack instanceof SDKHMSLocalVideoTrack) {\n      const newCaptureHandle = sdkTrack.getCaptureHandle?.();\n      if (newCaptureHandle?.handle !== track.captureHandle?.handle) {\n        track.captureHandle = newCaptureHandle;\n      }\n      if (sdkTrack.isCurrentTab) {\n        track.displaySurface = 'selfBrowser';\n      }\n    }\n  }\n\n  static enrichPluginsDetails(track: HMSTrack, sdkTrack: SDKHMSTrack) {\n    if (sdkTrack instanceof SDKHMSLocalVideoTrack || sdkTrack instanceof SDKHMSLocalAudioTrack) {\n      if (!areArraysEqual(sdkTrack.getPlugins(), track.plugins)) {\n        track.plugins = sdkTrack.getPlugins();\n      }\n    }\n  }\n\n  static convertRoom(sdkRoom: sdkTypes.HMSRoom, sdkLocalPeerId?: string): Partial<HMSRoom> {\n    const { recording, rtmp, hls, transcriptions } = SDKToHMS.convertRecordingStreamingState(\n      sdkRoom.recording,\n      sdkRoom.rtmp,\n      sdkRoom.hls,\n      sdkRoom.transcriptions,\n    );\n    return {\n      id: sdkRoom.id,\n      name: sdkRoom.name,\n      localPeer: sdkLocalPeerId,\n      recording,\n      rtmp,\n      hls,\n      transcriptions,\n      sessionId: sdkRoom.sessionId,\n      startedAt: sdkRoom.startedAt,\n      joinedAt: sdkRoom.joinedAt,\n      peerCount: sdkRoom.peerCount,\n      isLargeRoom: sdkRoom.large_room_optimization,\n      isEffectsEnabled: sdkRoom.isEffectsEnabled,\n      isVBEnabled: sdkRoom.isVBEnabled,\n      effectsKey: sdkRoom.effectsKey,\n      isHipaaEnabled: sdkRoom.isHipaaEnabled,\n      isNoiseCancellationEnabled: sdkRoom.isNoiseCancellationEnabled,\n    };\n  }\n\n  static convertMessage(\n    sdkMessage: MessageNotification,\n    localPeerId: HMSPeerID,\n  ): Partial<HMSMessage> & Pick<HMSMessage, 'sender'> {\n    return {\n      sender: sdkMessage.peer?.peer_id,\n      senderName: sdkMessage.peer?.info.name,\n      senderRole: sdkMessage.peer?.role,\n      senderUserId: sdkMessage.peer?.info.user_id,\n      recipientPeer: sdkMessage.private ? localPeerId : undefined,\n      recipientRoles: sdkMessage.roles,\n      time: new Date(sdkMessage.timestamp),\n      type: sdkMessage.info.type,\n      message: sdkMessage.info.message,\n      id: sdkMessage.message_id,\n    };\n  }\n\n  static convertRoles(sdkRoles: HMSRole[]): Record<HMSRoleName, HMSRole> {\n    const roles: Record<HMSRoleName, HMSRole> = {};\n    if (sdkRoles) {\n      sdkRoles.forEach(role => {\n        roles[role.name] = role;\n      });\n    }\n    return roles;\n  }\n\n  static convertRoleChangeRequest(req: SDKHMSRoleChangeRequest): HMSRoleChangeStoreRequest {\n    return {\n      requestedBy: req.requestedBy?.peerId,\n      roleName: req.role.name,\n      token: req.token,\n    };\n  }\n\n  static convertException(sdkException: sdkTypes.HMSException): HMSException {\n    return {\n      code: sdkException.code,\n      action: sdkException.action,\n      name: sdkException.name,\n      message: sdkException.message,\n      description: sdkException.description,\n      isTerminal: sdkException.isTerminal,\n      nativeError: sdkException.nativeError,\n      timestamp: new Date(),\n    };\n  }\n\n  static convertDeviceChangeUpdate(sdkDeviceChangeEvent: sdkTypes.HMSDeviceChangeEvent): HMSDeviceChangeEvent {\n    const convertedData: HMSDeviceChangeEvent = {\n      devices: sdkDeviceChangeEvent.devices,\n      selection: sdkDeviceChangeEvent.selection,\n      type: sdkDeviceChangeEvent.type,\n    };\n    if (sdkDeviceChangeEvent.error) {\n      convertedData.error = this.convertException(sdkDeviceChangeEvent.error);\n    }\n    return convertedData;\n  }\n\n  static convertPlaylist(playlistManager: sdkTypes.HMSPlaylistManager) {\n    const audioPlaylist = this.getConvertedPlaylistType(playlistManager, HMSPlaylistType.audio);\n    const videoPlaylist = this.getConvertedPlaylistType(playlistManager, HMSPlaylistType.video);\n    return { audio: audioPlaylist, video: videoPlaylist };\n  }\n\n  static convertPlaylistItem<T>(\n    playlistManager: sdkTypes.HMSPlaylistManager,\n    playlistItem: sdkTypes.HMSPlaylistItem<T>,\n  ): HMSPlaylistItem<T> {\n    const type = playlistItem.type;\n    const currentSelection = playlistManager.getCurrentSelection(type);\n    const isPlaying = playlistManager.isPlaying(type);\n    const isSelected = playlistItem.url === currentSelection?.url;\n\n    return {\n      ...playlistItem,\n      type: playlistItem.type as HMSPlaylistType,\n      selected: isSelected,\n      playing: isSelected && isPlaying,\n    };\n  }\n\n  private static getConvertedPlaylistType(playlistManager: sdkTypes.HMSPlaylistManager, type: HMSPlaylistType) {\n    const convertedPlaylist: Record<string, HMSPlaylistItem<any>> = {};\n    const currentSelection = playlistManager.getCurrentSelection(type);\n    const progress = playlistManager.getCurrentProgress(type);\n    const volume = playlistManager.getVolume(type);\n    const list = playlistManager.getList(type);\n    const currentIndex = playlistManager.getCurrentIndex(type);\n\n    playlistManager.getList(type).forEach(playlistItem => {\n      convertedPlaylist[playlistItem.id] = SDKToHMS.convertPlaylistItem(playlistManager, playlistItem);\n    });\n    return {\n      list: convertedPlaylist,\n      selection: {\n        id: currentSelection?.id,\n        hasPrevious: currentIndex > 0,\n        hasNext: currentIndex < list.length - 1,\n      },\n      progress,\n      volume,\n      currentTime: playlistManager.getCurrentTime(type),\n      playbackRate: playlistManager.getPlaybackRate(type),\n    };\n  }\n\n  static convertRecordingStreamingState(\n    recording?: sdkTypes.HMSRecording,\n    rtmp?: sdkTypes.HMSRTMP,\n    hls?: sdkTypes.HMSHLS,\n    transcriptions?: sdkTypes.HMSTranscriptionInfo[],\n  ): {\n    recording: sdkTypes.HMSRecording;\n    rtmp: sdkTypes.HMSRTMP;\n    hls: sdkTypes.HMSHLS;\n    transcriptions: sdkTypes.HMSTranscriptionInfo[];\n  } {\n    return {\n      recording: {\n        browser: {\n          running: false,\n          ...recording?.browser,\n        },\n        server: {\n          running: false,\n          ...recording?.server,\n        },\n        hls: { running: false, ...recording?.hls },\n      },\n      rtmp: { running: false, ...rtmp },\n      hls: {\n        variants: hls?.variants?.map(variant => variant) || [],\n        running: !!hls?.running,\n        error: hls?.error,\n      },\n      transcriptions: transcriptions || [],\n    };\n  }\n}\n", "import { HMSLogger } from '../common/ui-logger';\nimport { IHMSStore } from '../IHMSStore';\nimport { HMSPlaylistManager } from '../internal';\nimport { HMSGenericTypes, HMSPlaylistItem, HMSPlaylistType, IHMSPlaylistActions } from '../schema';\nimport { selectAudioPlaylist, selectVideoPlaylist } from '../selectors';\n\nexport class HMSPlaylist<T extends HMSGenericTypes> implements IHMSPlaylistActions {\n  private type: HMSPlaylistType;\n  constructor(\n    private playlistManager: HMSPlaylistManager,\n    type: HMSPlaylistType,\n    private syncPlaylistState: (action: string) => void,\n    private store: IHMSStore<T>,\n  ) {\n    this.type = type;\n  }\n\n  async play(id: string): Promise<void> {\n    if (!id) {\n      HMSLogger.w('Please pass id to play');\n      return;\n    }\n    await this.playlistManager.setEnabled(true, { id, type: this.type });\n  }\n\n  async pause(): Promise<void> {\n    const selector = this.type === HMSPlaylistType.audio ? selectAudioPlaylist : selectVideoPlaylist;\n    const selection = this.store.getState(selector.selection);\n    if (!selection.id) {\n      HMSLogger.w('No item is currently playing to pause');\n      return;\n    }\n    await this.playlistManager.setEnabled(false, { id: selection.id, type: this.type });\n  }\n\n  async playNext(): Promise<void> {\n    await this.playlistManager.playNext(this.type);\n  }\n\n  async playPrevious(): Promise<void> {\n    await this.playlistManager.playPrevious(this.type);\n  }\n\n  seek(seekValue: number): void {\n    this.playlistManager.seek(seekValue, this.type);\n    this.syncPlaylistState(`seekOn${this.type}Playlist`);\n  }\n\n  seekTo(seekValue: number): void {\n    this.playlistManager.seekTo(seekValue, this.type);\n    this.syncPlaylistState(`seekToOn${this.type}Playlist`);\n  }\n\n  setVolume(volume: number): void {\n    this.playlistManager.setVolume(volume, this.type);\n    this.syncPlaylistState(`setVolumeOn${this.type}Playlist`);\n  }\n\n  setList<T>(list: HMSPlaylistItem<T>[]): void {\n    this.playlistManager.setList(list);\n    this.syncPlaylistState(`setListOn${this.type}Playlist`);\n  }\n\n  async stop(): Promise<void> {\n    await this.playlistManager.stop(this.type);\n    this.syncPlaylistState(`stop${this.type}Playlist`);\n  }\n\n  setIsAutoplayOn(autoplay: boolean) {\n    this.playlistManager.setIsAutoplayOn(this.type, autoplay);\n  }\n\n  setPlaybackRate(playbackRate: number) {\n    this.playlistManager.setPlaybackRate(this.type, playbackRate);\n    this.syncPlaylistState(`set${this.type}PlaybackRate`);\n  }\n\n  async removeItem(id: string) {\n    const removed = await this.playlistManager.removeItem(id, this.type);\n    if (removed) {\n      this.syncPlaylistState(`remove${this.type}PlaylistItem`);\n    }\n    return removed;\n  }\n\n  async clearList() {\n    await this.playlistManager.clearList(this.type);\n    this.syncPlaylistState(`clear${this.type}Playlist`);\n  }\n}\n", "import { SessionStoreUpdate } from '../internal';\nimport { IHMSSessionStoreActions } from '../schema';\nimport { HMSSdk } from '../sdk';\n\nexport class HMSSessionStore<T extends Record<string, any>> implements IHMSSessionStoreActions<T> {\n  constructor(\n    private sdk: HMSSdk,\n    private setLocally: (updates: SessionStoreUpdate | SessionStoreUpdate[], actionName?: string) => void,\n  ) {}\n\n  private get sdkSessionStore() {\n    return this.sdk.getSessionStore();\n  }\n\n  async set<K extends keyof T>(key: K, value?: T[K]) {\n    const { value: latestValue } = await this.sdkSessionStore.set(String(key), value);\n    this.setLocally({ key: key as string, value: latestValue });\n  }\n\n  async observe(keys: keyof T | Array<keyof T>) {\n    const stringifiedKeys: string[] = Array.isArray(keys) ? keys.map(key => String(key)) : [String(keys)];\n    await this.sdkSessionStore.observe(stringifiedKeys);\n  }\n\n  async unobserve(keys: keyof T | Array<keyof T>) {\n    const stringifiedKeys: string[] = Array.isArray(keys) ? keys.map(key => String(key)) : [String(keys)];\n    await this.sdkSessionStore.unobserve(stringifiedKeys);\n  }\n}\n", "import { HMSGenericTypes, HMSPeer, IHMSStore, selectIsConnectedToRoom, selectPeers } from '../../';\nimport { HMSLogger } from '../../common/ui-logger';\nimport { IHMSActions } from '../../IHMSActions';\n\n/**\n * Log data of audio level and speaker speaking periodically to beam for transcript\n * diarization.\n */\nexport class BeamSpeakerLabelsLogger<T extends HMSGenericTypes> {\n  private audioContext?: AudioContext;\n  private readonly intervalMs: number;\n  private shouldMonitor: boolean;\n  private hasStarted: boolean;\n  private unsubs: any[];\n  private readonly analysers: Record<string, AnalyserNode>;\n  private readonly store: IHMSStore<T>;\n  private actions: IHMSActions<T>;\n  constructor(store: IHMSStore<T>, actions: IHMSActions<T>) {\n    this.intervalMs = 100;\n    this.shouldMonitor = false;\n    this.hasStarted = false;\n    this.unsubs = [];\n    this.analysers = {};\n    this.store = store;\n    this.actions = actions;\n  }\n\n  async start() {\n    if (this.hasStarted) {\n      return;\n    }\n    this.hasStarted = true;\n    HMSLogger.d('starting audio level monitor for remote peers', this.store);\n    const isConnected = this.store.getState(selectIsConnectedToRoom);\n    HMSLogger.d('starting audio levels is connected to room', isConnected);\n    if (isConnected) {\n      await this.monitorAudioLevels();\n    }\n    const unsub = this.store.subscribe(this.monitorAudioLevels.bind(this), selectIsConnectedToRoom);\n    this.unsubs.push(unsub);\n  }\n\n  async stop() {\n    if (!this.hasStarted) {\n      return;\n    }\n    this.hasStarted = false;\n    this.shouldMonitor = false;\n    this.unsubs.forEach(unsub => unsub());\n    HMSLogger.d('stopped audio level monitor for remote peers');\n  }\n\n  async monitorAudioLevels() {\n    const isConnected = this.store.getState(selectIsConnectedToRoom);\n    if (!isConnected) {\n      if (this.shouldMonitor) {\n        HMSLogger.i('room no longer connected, stopping audio level monitoring for remote');\n        this.shouldMonitor = false;\n      }\n      return;\n    }\n    if (this.shouldMonitor) {\n      return;\n    }\n    HMSLogger.i('monitoring audio levels');\n    this.shouldMonitor = true;\n    const loop = () => {\n      if (this.shouldMonitor) {\n        this.logAllPeersAudioLevels();\n        setTimeout(loop, this.intervalMs);\n      } else {\n        HMSLogger.i('stopped monitoring audio levels');\n      }\n    };\n    setTimeout(loop, 1000);\n  }\n\n  // eslint-disable-next-line complexity\n  async logAllPeersAudioLevels() {\n    if (!window.__triggerBeamEvent__) {\n      return;\n    }\n    // optimise this to selectTracks instead of selecting peers\n    const allPeers = this.store.getState(selectPeers);\n    const peers = allPeers.filter(peer => !!peer.audioTrack);\n    const peerAudioLevels = [];\n    for (const peer of peers) {\n      const sdkTrack = this.actions.getTrackById(peer.audioTrack || '');\n      const nativeStream: MediaStream | undefined = sdkTrack?.stream?.nativeStream;\n      if (!peer.joinedAt) {\n        continue;\n      }\n      if (nativeStream) {\n        const peerLevel = await this.getAudioLevel(peer, nativeStream);\n        if (peerLevel.level > 0) {\n          peerAudioLevels.push(peerLevel);\n        }\n      }\n    }\n    if (peerAudioLevels.length > 0) {\n      const payload = {\n        event: 'app-audio-level',\n        data: peerAudioLevels,\n      };\n      HMSLogger.d('logging audio levels', peerAudioLevels);\n      window.__triggerBeamEvent__(JSON.stringify(payload));\n    }\n  }\n\n  async getAudioLevel(peer: HMSPeer, stream: MediaStream) {\n    if (!this.analysers[stream.id]) {\n      this.analysers[stream.id] = this.createAnalyserNode(stream);\n    }\n    const analyserNode = this.analysers[stream.id];\n    const level = this.calculateAudioLevel(analyserNode);\n    return {\n      peerId: peer.id,\n      peerName: peer.name,\n      level,\n    };\n  }\n\n  createAnalyserNode(stream: MediaStream) {\n    if (!this.audioContext) {\n      this.audioContext = new AudioContext();\n    }\n    const analyser = this.audioContext.createAnalyser();\n    const source = this.audioContext.createMediaStreamSource(stream);\n    source.connect(analyser);\n    return analyser;\n  }\n\n  calculateAudioLevel(analyserNode: AnalyserNode) {\n    const data = new Uint8Array(analyserNode.fftSize);\n    analyserNode.getByteTimeDomainData(data);\n    const lowest = 0.009;\n    let max = lowest;\n    for (const frequency of data) {\n      max = Math.max(max, (frequency - 128) / 128);\n    }\n    const normalized = (Math.log(lowest) - Math.log(max)) / Math.log(lowest);\n    const percent = Math.ceil(Math.min(Math.max(normalized * 100, 0), 100));\n    return percent;\n  }\n}\n", "import { HMSRole } from '../internal';\n\nexport const DIAGNOSTICS_ROOM_ID = '6669151f480e55c215299a4a';\n\nexport const CONNECTIVITY_TEST_DURATION = 20_000;\nexport const MIC_CHECK_RECORD_DURATION = 10_000;\n\nexport const diagnosticsRole: HMSRole = {\n  name: 'diagnostics-role',\n  priority: 1,\n  publishParams: {\n    allowed: ['audio', 'video'],\n    audio: { bitRate: 32, codec: 'opus' },\n    video: {\n      bitRate: 100,\n      codec: 'vp8',\n      frameRate: 30,\n      height: 720,\n      width: 1280,\n    },\n    screen: {\n      bitRate: 100,\n      codec: 'vp8',\n      frameRate: 10,\n      height: 1080,\n      width: 1920,\n    },\n  },\n  subscribeParams: {\n    subscribeToRoles: [],\n    maxSubsBitRate: 3200,\n  },\n  permissions: {\n    browserRecording: false,\n    changeRole: false,\n    endRoom: false,\n    hlsStreaming: false,\n    mute: false,\n    pollRead: false,\n    pollWrite: false,\n    removeOthers: false,\n    rtmpStreaming: false,\n    unmute: false,\n  },\n};\n\nexport const DEFAULT_TEST_AUDIO_URL = 'https://100ms.live/test-audio.wav';\n", "export class CQSCalculator {\n  private networkScores: number[] = [];\n  private lastPushedAt = 0;\n\n  pushScore(score?: number) {\n    if (!score || score < 0) {\n      return;\n    }\n\n    if (this.networkScores.length === 0) {\n      this.networkScores.push(score);\n      this.lastPushedAt = Date.now();\n    } else {\n      this.addPendingCQSTillNow();\n    }\n  }\n\n  addPendingCQSTillNow() {\n    if (this.networkScores.length > 0) {\n      let timeDiffInSec = (Date.now() - this.lastPushedAt) / 1000;\n      while (timeDiffInSec > 0) {\n        this.networkScores.push(this.networkScores[this.networkScores.length - 1]);\n        timeDiffInSec -= 1;\n      }\n\n      this.lastPushedAt = Date.now();\n    }\n  }\n\n  getCQS() {\n    return this.networkScores.reduce((acc, score) => acc + score, 0) / this.networkScores.length;\n  }\n}\n", "import { DiagnosticsRTCStatsReport } from '.';\nimport { HMSPeerStats, HMSTrackStats } from '../interfaces';\nimport { HMSWebrtcStats } from '../rtc-stats';\nimport { computeBitrate } from '../rtc-stats/utils';\nimport { HMSSdk } from '../sdk';\n\nconst isValidNumber = (num: number | undefined): boolean => !!num && !isNaN(num);\nconst getLastElement = <T>(arr: T[]): T | undefined => arr[arr.length - 1];\nconst calculateAverage = <T>(arr: T[], predicate: (val: T) => number | undefined): number => {\n  const filteredArr = arr.filter(curr => isValidNumber(predicate(curr)));\n  return filteredArr.reduce((acc, curr) => acc + (predicate(curr) || 0), 0) / filteredArr.length;\n};\n\nexport class DiagnosticsStatsCollector {\n  private peerStatsList: HMSPeerStats[] = [];\n  private localAudioTrackStatsList: Record<string, HMSTrackStats>[] = [];\n  private localVideoTrackStatsList: Record<string, HMSTrackStats>[] = [];\n  private remoteAudioTrackStatsList: HMSTrackStats[] = [];\n  private remoteVideoTrackStatsList: HMSTrackStats[] = [];\n\n  constructor(private sdk: HMSSdk) {}\n\n  async handleStatsUpdate(stats: HMSWebrtcStats) {\n    const localPeerStats = stats.getLocalPeerStats();\n    if (localPeerStats) {\n      this.peerStatsList.push(localPeerStats);\n    }\n\n    const localAudioTrackID = this.sdk.getLocalPeer()?.audioTrack?.nativeTrack?.id;\n    const localVideoTrackID = this.sdk.getLocalPeer()?.videoTrack?.nativeTrack?.id;\n\n    const localTrackStats = stats.getLocalTrackStats();\n    if (localTrackStats) {\n      localAudioTrackID && this.localAudioTrackStatsList.push(localTrackStats[localAudioTrackID]);\n      localVideoTrackID && this.localVideoTrackStatsList.push(localTrackStats[localVideoTrackID]);\n    }\n\n    const subscribeStatsReport = await this.sdk.getWebrtcInternals()?.getSubscribePeerConnection()?.getStats();\n    subscribeStatsReport?.forEach(stat => {\n      if (stat.type === 'inbound-rtp') {\n        const list = stat.kind === 'audio' ? this.remoteAudioTrackStatsList : this.remoteVideoTrackStatsList;\n        const bitrate = computeBitrate('bytesReceived', stat, getLastElement(list));\n        list.push({ ...stat, bitrate });\n      }\n    });\n  }\n\n  // eslint-disable-next-line complexity\n  buildReport(): DiagnosticsRTCStatsReport {\n    const lastPublishStats = getLastElement(this.peerStatsList)?.publish;\n    const lastSubscribeStats = getLastElement(this.peerStatsList)?.subscribe;\n    const publishRoundTripTime = lastPublishStats?.responsesReceived\n      ? (lastPublishStats?.totalRoundTripTime || 0) / lastPublishStats.responsesReceived\n      : 0;\n    const subscribeRoundTripTime = lastSubscribeStats?.responsesReceived\n      ? (lastSubscribeStats?.totalRoundTripTime || 0) / lastSubscribeStats.responsesReceived\n      : 0;\n    const roundTripTime = Number((((publishRoundTripTime + subscribeRoundTripTime) / 2) * 1000).toFixed(2));\n\n    const audioPacketsReceived = getLastElement(this.remoteAudioTrackStatsList)?.packetsReceived || 0;\n    const videoPacketsReceived = getLastElement(this.remoteVideoTrackStatsList)?.packetsReceived || 0;\n\n    const ridAveragedAudioBitrateList = this.localAudioTrackStatsList.map(trackStatsMap =>\n      trackStatsMap ? calculateAverage(Object.values(trackStatsMap), curr => curr.bitrate) : 0,\n    );\n\n    const ridAveragedVideoBitrateList = this.localVideoTrackStatsList.map(trackStatsMap =>\n      trackStatsMap ? calculateAverage(Object.values(trackStatsMap), curr => curr.bitrate) : 0,\n    );\n\n    const lastLocalAudioTrackStats = getLastElement(this.localAudioTrackStatsList);\n    const lastLocalVideoTrackStats = getLastElement(this.localVideoTrackStatsList);\n\n    return {\n      combined: {\n        roundTripTime,\n        packetsReceived: audioPacketsReceived + videoPacketsReceived,\n        packetsLost: lastSubscribeStats?.packetsLost || 0,\n        bytesSent: lastPublishStats?.bytesSent || 0,\n        bytesReceived: lastSubscribeStats?.bytesReceived || 0,\n        bitrateSent: calculateAverage(this.peerStatsList, curr => curr.publish?.bitrate),\n        bitrateReceived: calculateAverage(this.peerStatsList, curr => curr.subscribe?.bitrate),\n      },\n      audio: {\n        roundTripTime,\n        packetsReceived: audioPacketsReceived,\n        packetsLost: getLastElement(this.remoteAudioTrackStatsList)?.packetsLost || 0,\n        bytesReceived: getLastElement(this.remoteAudioTrackStatsList)?.bytesReceived || 0,\n        bitrateSent: calculateAverage(ridAveragedAudioBitrateList, curr => curr),\n        bitrateReceived: calculateAverage(this.remoteAudioTrackStatsList, curr => curr.bitrate),\n        bytesSent: lastLocalAudioTrackStats\n          ? Object.values(lastLocalAudioTrackStats).reduce((acc, curr) => acc + (curr.bytesSent || 0), 0)\n          : 0,\n      },\n      video: {\n        roundTripTime,\n        packetsLost: getLastElement(this.remoteVideoTrackStatsList)?.packetsLost || 0,\n        bytesReceived: getLastElement(this.remoteVideoTrackStatsList)?.bytesReceived || 0,\n        packetsReceived: videoPacketsReceived,\n        bitrateSent: calculateAverage(ridAveragedVideoBitrateList, curr => curr),\n        bitrateReceived: calculateAverage(this.remoteVideoTrackStatsList, curr => curr.bitrate),\n        bytesSent: lastLocalVideoTrackStats\n          ? Object.values(lastLocalVideoTrackStats).reduce((acc, curr) => acc + (curr.bytesSent || 0), 0)\n          : 0,\n      },\n    };\n  }\n}\n", "import { RTCIceCandidatePair } from '../connection/IConnectionObserver';\nimport { HMSException, HMSTrack, HMSUpdateListener } from '../internal';\n\nexport enum ConnectivityState {\n  STARTING,\n  INIT_FETCHED,\n  SIGNAL_CONNECTED,\n  ICE_ESTABLISHED,\n  MEDIA_CAPTURED,\n  MEDIA_PUBLISHED,\n  COMPLETED,\n}\n\nexport interface HMSDiagnosticsConnectivityListener extends HMSUpdateListener {\n  onInitSuccess(websocketURL: string): void;\n  onSignallingSuccess(): void;\n  onICESuccess(isPublish: boolean): void;\n  onMediaPublished(track: HMSTrack): void;\n  onICECandidate(candidate: RTCIceCandidate, isPublish: boolean): void;\n  onSelectedICECandidatePairChange(candidatePair: RTCIceCandidatePair, isPublish: boolean): void;\n}\n\nexport interface MediaPermissionCheck {\n  audio?: boolean;\n  video?: boolean;\n}\n\nexport interface HMSDiagnosticsInterface {\n  requestPermission(check: MediaPermissionCheck): Promise<MediaPermissionCheck>;\n  checkBrowserSupport(): void;\n  startMicCheck(args: {\n    inputDevice?: string;\n    onError?: (error: Error) => void;\n    onStop?: () => void;\n    time?: number;\n  }): Promise<void>;\n  getRecordedAudio(): string | undefined;\n  stopMicCheck(): void;\n\n  startCameraCheck(inputDevice?: string): Promise<void>;\n  stopCameraCheck(): void;\n\n  startConnectivityCheck(\n    progress: (state: ConnectivityState) => void,\n    completed: (result: ConnectivityCheckResult) => void,\n    region?: string,\n  ): Promise<void>;\n  stopConnectivityCheck(): Promise<void>;\n}\n\nexport interface ConnectivityCheckResult {\n  testTimestamp: number; // System time in millis (UTC)\n  connectivityState?: ConnectivityState; // This is the initial state\n  signallingReport?: SignallingReport;\n  mediaServerReport?: MediaServerReport;\n  // deviceTestReport?: DeviceTestReport;\n  errors?: Array<HMSException>;\n}\n\nexport interface SignallingReport {\n  isConnected: boolean; // true if websocket was connected successfully\n  isInitConnected: boolean; // True if init call was successful\n  websocketUrl?: string; // websocket url\n}\n\nexport interface MediaServerReport {\n  stats?: DiagnosticsRTCStatsReport; // represents the overall stats of the call\n  isPublishICEConnected: boolean; // True if ICE connected successfully for both publish and subscribe\n  isSubscribeICEConnected: boolean;\n  connectionQualityScore?: number; // Average of all the downlink scores for this call for this peer\n  publishIceCandidatesGathered?: Array<RTCIceCandidate>; // Publish ICE candidates\n  subscribeIceCandidatesGathered: Array<RTCIceCandidate>; // Subscribe ICE candidates\n  publishICECandidatePairSelected?: RTCIceCandidatePair; // publish ICE pair\n  subscribeICECandidatePairSelected?: RTCIceCandidatePair; // subscribe ICE pair\n}\n\nexport interface DiagnosticsRTCStatsReport {\n  combined: DiagnosticsRTCStats;\n  audio: DiagnosticsRTCStats;\n  video: DiagnosticsRTCStats;\n}\n\nexport interface DiagnosticsRTCStats {\n  bytesSent: number;\n  bytesReceived: number;\n  packetsReceived: number;\n  packetsLost: number;\n  bitrateSent: number;\n  bitrateReceived: number;\n  roundTripTime: number;\n}\n", "import { CONNECTIVITY_TEST_DURATION } from './constants';\nimport { CQSCalculator } from './CQSCalculator';\nimport { DiagnosticsStatsCollector } from './DiagnosticsStatsCollector';\nimport { ConnectivityCheckResult, ConnectivityState, HMSDiagnosticsConnectivityListener } from './interfaces';\nimport { RTCIceCandidatePair } from '../connection/IConnectionObserver';\nimport {\n  HMSConnectionQuality,\n  HMSException,\n  HMSRoom,\n  HMSTrack,\n  HMSTrackType,\n  HMSTrackUpdate,\n  HMSUpdateListener,\n} from '../internal';\nimport { HMSSdk } from '../sdk';\nimport { HMSPeer } from '../sdk/models/peer';\n\nexport class ConnectivityCheck implements HMSDiagnosticsConnectivityListener {\n  private wsConnected = false;\n  private websocketURL?: string;\n  private initConnected = false;\n\n  private isPublishICEConnected = false;\n  private isSubscribeICEConnected = false;\n  private selectedPublishICECandidate?: RTCIceCandidatePair;\n  private selectedSubscribeICECandidate?: RTCIceCandidatePair;\n  private gatheredPublishICECandidates: RTCIceCandidate[] = [];\n  private gatheredSubscribeICECandidates: RTCIceCandidate[] = [];\n  private errors: HMSException[] = [];\n  private isAudioTrackCaptured = false;\n  private isVideoTrackCaptured = false;\n  private isAudioTrackPublished = false;\n  private isVideoTrackPublished = false;\n  private statsCollector: DiagnosticsStatsCollector;\n  private cqsCalculator = new CQSCalculator();\n\n  private cleanupTimer?: number;\n  private timestamp = Date.now();\n  private _state?: ConnectivityState;\n  private get state(): ConnectivityState | undefined {\n    return this._state;\n  }\n  private set state(value: ConnectivityState | undefined) {\n    if (value === undefined || (this._state !== undefined && value < this._state)) {\n      return;\n    }\n    this._state = value;\n    this.progressCallback?.(value);\n  }\n\n  constructor(\n    private sdk: HMSSdk,\n    private sdkListener: HMSUpdateListener,\n    private progressCallback: (state: ConnectivityState) => void,\n    private completionCallback: (state: ConnectivityCheckResult) => void,\n  ) {\n    this.statsCollector = new DiagnosticsStatsCollector(sdk);\n    this.state = ConnectivityState.STARTING;\n  }\n  onRoomUpdate = this.sdkListener.onRoomUpdate.bind(this.sdkListener);\n  onPeerUpdate = this.sdkListener.onPeerUpdate.bind(this.sdkListener);\n  onMessageReceived = this.sdkListener.onMessageReceived.bind(this.sdkListener);\n  onReconnected = this.sdkListener.onReconnected.bind(this.sdkListener);\n  onRoleChangeRequest = this.sdkListener.onRoleChangeRequest.bind(this.sdkListener);\n  onRoleUpdate = this.sdkListener.onRoleUpdate.bind(this.sdkListener);\n  onChangeTrackStateRequest = this.sdkListener.onChangeTrackStateRequest.bind(this.sdkListener);\n  onChangeMultiTrackStateRequest = this.sdkListener.onChangeMultiTrackStateRequest.bind(this.sdkListener);\n  onRemovedFromRoom = this.sdkListener.onRemovedFromRoom.bind(this.sdkListener);\n  onNetworkQuality = this.sdkListener.onNetworkQuality?.bind(this.sdkListener);\n  onPreview = this.sdkListener.onPreview.bind(this.sdkListener);\n  onDeviceChange = this.sdkListener.onDeviceChange?.bind(this.sdkListener);\n  onSessionStoreUpdate = this.sdkListener.onSessionStoreUpdate.bind(this.sdkListener);\n  onPollsUpdate = this.sdkListener.onPollsUpdate.bind(this.sdkListener);\n  onWhiteboardUpdate = this.sdkListener.onWhiteboardUpdate.bind(this.sdkListener);\n\n  handleConnectionQualityUpdate = (qualities: HMSConnectionQuality[]) => {\n    const localPeerQuality = qualities.find(quality => quality.peerID === this.sdk?.store.getLocalPeer()?.peerId);\n    this.cqsCalculator.pushScore(localPeerQuality?.downlinkQuality);\n  };\n\n  onICESuccess(isPublish: boolean): void {\n    if (isPublish) {\n      this.isPublishICEConnected = true;\n    } else {\n      this.isSubscribeICEConnected = true;\n    }\n\n    if (this.isPublishICEConnected && this.isSubscribeICEConnected) {\n      this.state = ConnectivityState.ICE_ESTABLISHED;\n    }\n  }\n\n  onSelectedICECandidatePairChange(candidatePair: RTCIceCandidatePair, isPublish: boolean): void {\n    if (isPublish) {\n      this.selectedPublishICECandidate = candidatePair;\n    } else {\n      this.selectedSubscribeICECandidate = candidatePair;\n    }\n  }\n\n  onICECandidate(candidate: RTCIceCandidate, isPublish: boolean): void {\n    if (isPublish) {\n      this.gatheredPublishICECandidates.push(candidate);\n    } else {\n      this.gatheredSubscribeICECandidates.push(candidate);\n    }\n  }\n\n  onMediaPublished(track: HMSTrack): void {\n    switch (track.type) {\n      case HMSTrackType.AUDIO:\n        this.isAudioTrackPublished = true;\n        break;\n      case HMSTrackType.VIDEO:\n        this.isVideoTrackPublished = true;\n        break;\n      default:\n        break;\n    }\n\n    if (this.isVideoTrackPublished && this.isAudioTrackPublished) {\n      this.state = ConnectivityState.MEDIA_PUBLISHED;\n    }\n  }\n\n  onInitSuccess(websocketURL: string): void {\n    this.websocketURL = websocketURL;\n    this.initConnected = true;\n    this.state = ConnectivityState.INIT_FETCHED;\n  }\n\n  onSignallingSuccess(): void {\n    this.wsConnected = true;\n    this.state = ConnectivityState.SIGNAL_CONNECTED;\n  }\n\n  onJoin(room: HMSRoom): void {\n    this.sdkListener.onJoin(room);\n    this.sdk.getWebrtcInternals()?.onStatsChange(stats => this.statsCollector.handleStatsUpdate(stats));\n    this.sdk.getWebrtcInternals()?.start();\n    this.cleanupTimer = window.setTimeout(() => {\n      this.cleanupAndReport();\n    }, CONNECTIVITY_TEST_DURATION);\n  }\n\n  onError(error: HMSException): void {\n    this.sdkListener.onError(error);\n    this.errors.push(error);\n    if (error?.isTerminal) {\n      this.cleanupAndReport();\n    }\n  }\n\n  // eslint-disable-next-line complexity\n  onTrackUpdate(type: HMSTrackUpdate, track: HMSTrack, peer: HMSPeer): void {\n    this.sdkListener.onTrackUpdate(type, track, peer);\n    if (peer.isLocal && type === HMSTrackUpdate.TRACK_ADDED) {\n      switch (track.type) {\n        case HMSTrackType.AUDIO:\n          this.isAudioTrackCaptured = true;\n          break;\n        case HMSTrackType.VIDEO:\n          this.isVideoTrackCaptured = true;\n          break;\n        default:\n          break;\n      }\n\n      if (this.isVideoTrackCaptured && this.isAudioTrackCaptured) {\n        this.state = ConnectivityState.MEDIA_CAPTURED;\n      }\n    }\n  }\n\n  onReconnecting(error: HMSException): void {\n    this.sdkListener.onReconnecting(error);\n    this.cqsCalculator.addPendingCQSTillNow();\n  }\n\n  cleanupAndReport() {\n    clearTimeout(this.cleanupTimer);\n    this.cleanupTimer = undefined;\n    if (this.state === ConnectivityState.MEDIA_PUBLISHED) {\n      this.state = ConnectivityState.COMPLETED;\n    }\n    this.completionCallback?.(this.buildReport());\n    this.sdk.leave();\n  }\n\n  private buildReport(): ConnectivityCheckResult {\n    this.cqsCalculator.addPendingCQSTillNow();\n    const connectionQualityScore = this.cqsCalculator.getCQS();\n    const stats = this.statsCollector.buildReport();\n    return {\n      testTimestamp: this.timestamp,\n      connectivityState: this.state,\n      errors: this.errors,\n      signallingReport: {\n        isConnected: this.wsConnected,\n        isInitConnected: this.initConnected,\n        websocketUrl: this.websocketURL,\n      },\n      mediaServerReport: {\n        stats,\n        connectionQualityScore,\n        isPublishICEConnected: this.isPublishICEConnected,\n        isSubscribeICEConnected: this.isSubscribeICEConnected,\n        publishICECandidatePairSelected: this.selectedPublishICECandidate,\n        subscribeICECandidatePairSelected: this.selectedSubscribeICECandidate,\n        publishIceCandidatesGathered: this.gatheredPublishICECandidates,\n        subscribeIceCandidatesGathered: this.gatheredSubscribeICECandidates,\n      },\n    };\n  }\n}\n", "import { HMSHLS, HMSRecording, HMSRoom, HMSRTMP, HMSTranscriptionInfo } from '../../interfaces/room';\n\nexport default class Room implements HMSRoom {\n  id: string;\n  joinedAt?: Date | undefined;\n  templateId?: string | undefined;\n  sessionId?: string;\n  startedAt?: Date;\n  recording: HMSRecording = { server: { running: false }, browser: { running: false }, hls: { running: false } };\n  rtmp: HMSRTMP = { running: false };\n  hls: HMSHLS = { running: false, variants: [] };\n  name?: string;\n  peerCount?: number;\n  description?: string;\n  max_size?: number;\n  large_room_optimization?: boolean;\n  transcriptions?: HMSTranscriptionInfo[] = [];\n  isEffectsEnabled?: boolean;\n  isVBEnabled?: boolean;\n  effectsKey?: string;\n  isHipaaEnabled?: boolean;\n  isNoiseCancellationEnabled?: boolean;\n\n  constructor(id: string) {\n    this.id = id;\n  }\n}\n", "import { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\n\n/**\n * @param retryCodes codes from the server reponse that needs to be retried\n */\n// eslint-disable-next-line complexity\nexport const fetchWithRetry = async (\n  url: RequestInfo,\n  options: RequestInit,\n  retryCodes?: number[],\n): Promise<Response> => {\n  const MAX_RETRIES = 4;\n  let error = Error('something went wrong during fetch');\n  for (let i = 0; i < MAX_RETRIES; i++) {\n    try {\n      // fetch will throw error if there's a browser-level issue\n      const response = await fetch(url, options);\n      const data = await response.clone().json();\n      // throw error for additional codes to retry based on server's response\n      if (retryCodes && retryCodes.length && !response.ok && retryCodes.includes(data.code)) {\n        throw ErrorFactory.APIErrors.ServerErrors(data.code, HMSAction.GET_TOKEN, data.message, false);\n      }\n\n      return response;\n    } catch (err) {\n      error = err as unknown as Error;\n    }\n  }\n  if (['Failed to fetch', 'NetworkError'].some(message => error.message.includes(message))) {\n    throw ErrorFactory.APIErrors.EndpointUnreachable(HMSAction.GET_TOKEN, error.message);\n  }\n  throw error;\n};\n", "import { ConnectivityCheck } from './ConnectivityCheck';\nimport { DEFAULT_TEST_AUDIO_URL, diagnosticsRole, MIC_CHECK_RECORD_DURATION } from './constants';\nimport {\n  ConnectivityCheckResult,\n  ConnectivityState,\n  HMSDiagnosticsInterface,\n  MediaPermissionCheck,\n} from './interfaces';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { BuildGetMediaError } from '../error/utils';\nimport {\n  HMSException,\n  HMSLocalAudioTrack,\n  HMSLocalVideoTrack,\n  HMSPeerType,\n  HMSPeerUpdate,\n  HMSRoomUpdate,\n  HMSUpdateListener,\n} from '../internal';\nimport { HMSAudioTrackSettingsBuilder, HMSTrackSettingsBuilder, HMSVideoTrackSettingsBuilder } from '../media/settings';\nimport { HMSSdk } from '../sdk';\nimport HMSRoom from '../sdk/models/HMSRoom';\nimport { HMSLocalPeer } from '../sdk/models/peer';\nimport { fetchWithRetry } from '../utils/fetch';\nimport { validateMediaDevicesExistence, validateRTCPeerConnection } from '../utils/validations';\n\nexport class Diagnostics implements HMSDiagnosticsInterface {\n  private recordedAudio?: string = DEFAULT_TEST_AUDIO_URL;\n  private mediaRecorder?: MediaRecorder;\n  private connectivityCheck?: ConnectivityCheck;\n  private onStopMicCheck?: () => void;\n\n  constructor(private sdk: HMSSdk, private sdkListener: HMSUpdateListener) {\n    this.sdk.setIsDiagnostics(true);\n    this.initSdkWithLocalPeer();\n  }\n\n  get localPeer() {\n    return this.sdk?.store.getLocalPeer();\n  }\n\n  checkBrowserSupport(): void {\n    validateMediaDevicesExistence();\n    validateRTCPeerConnection();\n  }\n\n  async requestPermission(check: MediaPermissionCheck): Promise<MediaPermissionCheck> {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia(check);\n      stream.getTracks().forEach(track => track.stop());\n      await this.sdk.deviceManager.init(true);\n      return {\n        audio: stream.getAudioTracks().length > 0,\n        video: stream.getVideoTracks().length > 0,\n      };\n    } catch (err) {\n      throw BuildGetMediaError(err as Error, this.sdk.localTrackManager.getErrorType(!!check.video, !!check.audio));\n    }\n  }\n\n  async startCameraCheck(inputDevice?: string) {\n    this.initSdkWithLocalPeer();\n    if (!this.localPeer) {\n      throw new Error('Local peer not found');\n    }\n\n    this.sdk.store.setSimulcastEnabled(false);\n\n    this.localPeer.role = {\n      ...diagnosticsRole,\n      publishParams: { ...diagnosticsRole.publishParams, allowed: ['video'] },\n    };\n    const settings = new HMSTrackSettingsBuilder()\n      .video(new HMSVideoTrackSettingsBuilder().deviceId(inputDevice || 'default').build())\n      .build();\n    const tracks = await this.sdk?.localTrackManager.getLocalTracks({ audio: false, video: true }, settings);\n    const track = tracks?.find(track => track.type === 'video') as HMSLocalVideoTrack;\n\n    if (!track) {\n      throw new Error('No video track found');\n    }\n\n    this.sdk?.deviceManager.init(true);\n    this.localPeer.videoTrack = track;\n    this.sdk?.listener?.onPeerUpdate(HMSPeerUpdate.PEER_LIST, [this.localPeer]);\n  }\n\n  stopCameraCheck(): void {\n    this.localPeer?.videoTrack?.cleanup();\n    if (this.localPeer) {\n      this.localPeer.videoTrack = undefined;\n    }\n  }\n\n  async startMicCheck({\n    inputDevice,\n    onError,\n    onStop,\n    time = MIC_CHECK_RECORD_DURATION,\n  }: {\n    inputDevice?: string;\n    onError?: (error: Error) => void;\n    onStop?: () => void;\n    time?: number;\n  }) {\n    this.initSdkWithLocalPeer((err: Error) => {\n      this.stopMicCheck();\n      onError?.(err);\n    });\n    const track = await this.getLocalAudioTrack(inputDevice);\n    this.sdk?.deviceManager.init(true);\n    if (!this.localPeer) {\n      throw new Error('Local peer not found');\n    }\n    if (!track) {\n      throw new Error('No audio track found');\n    }\n\n    this.localPeer.audioTrack = track;\n    this.sdk?.initPreviewTrackAudioLevelMonitor();\n    this.sdk?.listener?.onPeerUpdate(HMSPeerUpdate.PEER_LIST, [this.localPeer]);\n\n    this.mediaRecorder = new MediaRecorder(track.stream.nativeStream);\n    const chunks: Blob[] = [];\n\n    this.mediaRecorder.ondataavailable = function (e) {\n      chunks.push(e.data);\n    };\n\n    this.mediaRecorder.onstop = () => {\n      const blob = new Blob(chunks, { type: this.mediaRecorder?.mimeType });\n      this.recordedAudio = URL.createObjectURL(blob);\n      this.onStopMicCheck?.();\n    };\n\n    this.mediaRecorder.start();\n\n    const timeoutId = setTimeout(() => {\n      this.stopMicCheck();\n    }, time);\n\n    this.onStopMicCheck = () => {\n      clearTimeout(timeoutId);\n      onStop?.();\n    };\n  }\n\n  stopMicCheck(): void {\n    this.mediaRecorder?.stop();\n    this.localPeer?.audioTrack?.cleanup();\n    if (this.localPeer) {\n      this.localPeer.audioTrack = undefined;\n    }\n  }\n\n  getRecordedAudio() {\n    return this.recordedAudio;\n  }\n\n  async startConnectivityCheck(\n    progress: (state: ConnectivityState) => void,\n    completed: (result: ConnectivityCheckResult) => void,\n    region?: string,\n  ) {\n    if (!this.sdk) {\n      throw new Error('SDK not found');\n    }\n\n    this.connectivityCheck = new ConnectivityCheck(this.sdk, this.sdkListener, progress, completed);\n\n    const authToken = await this.getAuthToken(region);\n    await this.sdk.leave();\n    await this.sdk.join({ authToken, userName: 'diagnostics-test' }, this.connectivityCheck);\n    this.sdk.addConnectionQualityListener({\n      onConnectionQualityUpdate: qualityUpdates => {\n        this.connectivityCheck?.handleConnectionQualityUpdate(qualityUpdates);\n      },\n    });\n  }\n\n  async stopConnectivityCheck(): Promise<void> {\n    return this.connectivityCheck?.cleanupAndReport();\n  }\n\n  private initSdkWithLocalPeer(onError?: (error: Error) => void) {\n    this.sdkListener &&\n      this.sdk?.initStoreAndManagers({\n        ...this.sdkListener,\n        onError: (error: HMSException) => {\n          onError?.(error);\n          this.sdkListener.onError(error);\n        },\n      });\n    const localPeer = new HMSLocalPeer({\n      name: 'diagnostics-peer',\n      role: diagnosticsRole,\n      type: HMSPeerType.REGULAR,\n    });\n\n    this.sdk?.store.addPeer(localPeer);\n\n    const room = new HMSRoom('diagnostics-room');\n    this.sdk.store.setRoom(room);\n    this.sdkListener.onRoomUpdate(HMSRoomUpdate.ROOM_PEER_COUNT_UPDATED, room);\n    this.sdk?.deviceManager.init(true);\n  }\n\n  private async getAuthToken(region?: string): Promise<string> {\n    const tokenAPIURL = new URL('https://api.100ms.live/v2/diagnostics/token');\n    if (region) {\n      tokenAPIURL.searchParams.append('region', region);\n    }\n    const response = await fetchWithRetry(\n      tokenAPIURL.toString(),\n      { method: 'GET' },\n      [429, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511],\n    );\n\n    const data = await response.json();\n\n    if (!response.ok) {\n      throw ErrorFactory.APIErrors.ServerErrors(data.code, HMSAction.GET_TOKEN, data.message, false);\n    }\n\n    const { token } = data;\n    if (!token) {\n      throw Error(data.message);\n    }\n    return token;\n  }\n\n  private async getLocalAudioTrack(inputDevice?: string) {\n    if (!this.localPeer) {\n      return;\n    }\n\n    this.localPeer.role = {\n      ...diagnosticsRole,\n      publishParams: { ...diagnosticsRole.publishParams, allowed: ['audio'] },\n    };\n    const settings = new HMSTrackSettingsBuilder()\n      .audio(new HMSAudioTrackSettingsBuilder().deviceId(inputDevice || 'default').build())\n      .build();\n    const tracks = await this.sdk?.localTrackManager.getLocalTracks({ audio: true, video: false }, settings);\n    return tracks?.find(track => track.type === 'audio') as HMSLocalAudioTrack;\n  }\n}\n", "import { PEER_NOTIFICATION_TYPES, POLL_NOTIFICATION_TYPES, TRACK_NOTIFICATION_TYPES } from './common/mapping';\nimport { ActionBatcher } from './sdkUtils/ActionBatcher';\nimport { isRemoteTrack } from './sdkUtils/sdkUtils';\nimport {\n  areArraysEqual,\n  isEntityUpdated,\n  mergeNewPeersInDraft,\n  mergeNewPollsInDraft,\n  mergeNewTracksInDraft,\n  mergeTrackArrayFields,\n} from './sdkUtils/storeMergeUtils';\nimport { SDKToHMS } from './adapter';\nimport { HMSNotifications } from './HMSNotifications';\nimport { HMSPlaylist } from './HMSPlaylist';\nimport { HMSSessionStore } from './HMSSessionStore';\nimport { NamedSetState } from './internalTypes';\nimport { HMSLogger } from '../common/ui-logger';\nimport { BeamSpeakerLabelsLogger } from '../controller/beam/BeamSpeakerLabelsLogger';\nimport { Diagnostics } from '../diagnostics';\nimport { HMSSessionFeedback } from '../end-call-feedback';\nimport { IHMSActions } from '../IHMSActions';\nimport { IHMSStore } from '../IHMSStore';\nimport {\n  HMSAudioMode,\n  HMSAudioPlugin,\n  HMSAudioTrack as SDKHMSAudioTrack,\n  HMSChangeMultiTrackStateParams as SDKHMSChangeMultiTrackStateParams,\n  HMSChangeMultiTrackStateRequest as SDKHMSChangeMultiTrackStateRequest,\n  HMSChangeTrackStateRequest as SDKHMSChangeTrackStateRequest,\n  HMSException as SDKHMSException,\n  HMSLeaveRoomRequest as SDKHMSLeaveRoomRequest,\n  HMSLocalAudioTrack as SDKHMSLocalAudioTrack,\n  HMSLocalTrack as SDKHMSLocalTrack,\n  HMSLocalVideoTrack as SDKHMSLocalVideoTrack,\n  HMSLogLevel,\n  HMSMediaStreamPlugin,\n  HMSPluginSupportResult,\n  HMSRemoteTrack as SDKHMSRemoteTrack,\n  HMSRemoteVideoTrack as SDKHMSRemoteVideoTrack,\n  HMSRoleChangeRequest as SDKHMSRoleChangeRequest,\n  HMSScreenShareConfig,\n  HMSSimulcastLayer,\n  HMSTrack as SDKHMSTrack,\n  HMSVideoPlugin,\n  HMSVideoTrack as SDKHMSVideoTrack,\n  SessionStoreUpdate,\n} from '../internal';\nimport * as sdkTypes from '../internal';\nimport { MessageNotification } from '../notification-manager';\nimport {\n  createDefaultStoreState,\n  HMSChangeMultiTrackStateParams,\n  HMSGenericTypes,\n  HMSMediaSettings,\n  HMSMessage,\n  HMSMessageInput,\n  HMSPeer,\n  HMSPeerID,\n  HMSPeerListIteratorOptions,\n  HMSPlaylistType,\n  HMSRoleName,\n  HMSRoomState,\n  HMSStore,\n  HMSTrack,\n  HMSTrackID,\n  HMSTrackSource,\n  HMSVideoTrack,\n  IHMSPlaylistActions,\n  IHMSSessionStoreActions,\n} from '../schema';\nimport { HMSSdk } from '../sdk';\nimport {\n  HMSRoleChangeRequest,\n  selectIsConnectedToRoom,\n  selectIsInPreview,\n  selectIsLocalScreenShared,\n  selectIsLocalVideoDisplayEnabled,\n  selectIsLocalVideoEnabled,\n  selectLocalAudioTrackID,\n  selectLocalMediaSettings,\n  selectLocalPeer,\n  selectLocalPeerID,\n  selectLocalTrackIDs,\n  selectLocalVideoTrackID,\n  selectPeerByID,\n  selectPeersMap,\n  selectPermissions,\n  selectRolesMap,\n  selectRoomState,\n  selectTrackByID,\n  selectTracksMap,\n  selectVideoTrackByID,\n} from '../selectors';\nimport { FindPeerByNameRequestParams } from '../signal/interfaces';\n\n/**\n * This class implements the IHMSActions interface for 100ms SDK. It connects with SDK\n * and takes control of data management by letting every action pass through it. The\n * passed in store is ensured to be the single source of truth reflecting current\n * room related data at any point in time.\n *\n * @privateRemarks\n * Things to keep in mind while updating store -\n * 1. Treat setState as an atomic operation, if an action results in multiple changes,\n *    the changes should all happen within single setState function.\n * 2. While updating the state it's very important to not update the reference if\n *    something is unchanged. Copy data in same reference object don't assign new\n *    object.\n * 3. Mental Model(1) - Actions from backend -> Listeners of this class -> update store -> views update themselves\n *    eg. for this - peer added, remote muted etc.\n * 4. Mental Model(2) - Actions from local -> View calls actions -> update store -> views update themselves\n *    eg. local track enabled, join, leave etc.\n * 5. State is immutable, a new copy with new references is created when there is a change,\n *    if you try to modify state outside of setState, there'll be an error.\n */\nexport class HMSSDKActions<T extends HMSGenericTypes = { sessionStore: Record<string, any> }>\n  implements IHMSActions<T>\n{\n  private readonly sdk: HMSSdk;\n  private readonly store: IHMSStore<T>;\n  private isRoomJoinCalled = false;\n  private hmsNotifications: HMSNotifications<T>;\n  private ignoredMessageTypes: string[] = [];\n  private actionBatcher: ActionBatcher<T>;\n  audioPlaylist!: IHMSPlaylistActions;\n  videoPlaylist!: IHMSPlaylistActions;\n  sessionStore: IHMSSessionStoreActions<T['sessionStore']>;\n  private beamSpeakerLabelsLogger?: BeamSpeakerLabelsLogger<T>;\n\n  constructor(store: IHMSStore<T>, sdk: HMSSdk, notificationManager: HMSNotifications<T>) {\n    this.store = store;\n    this.sdk = sdk;\n    this.hmsNotifications = notificationManager;\n\n    this.sessionStore = new HMSSessionStore<T['sessionStore']>(this.sdk, this.setSessionStoreValueLocally.bind(this));\n    this.actionBatcher = new ActionBatcher(store);\n  }\n  submitSessionFeedback(feedback: HMSSessionFeedback, eventEndpoint?: string): Promise<void> {\n    return this.sdk.submitSessionFeedback(feedback, eventEndpoint);\n  }\n\n  getLocalTrack(trackID: string) {\n    return this.sdk.store.getLocalPeerTracks().find(track => track.trackId === trackID);\n  }\n\n  get interactivityCenter() {\n    return this.sdk.getInteractivityCenter();\n  }\n\n  setPlaylistSettings(settings: sdkTypes.HMSPlaylistSettings): void {\n    this.sdk.updatePlaylistSettings(settings);\n  }\n\n  async refreshDevices() {\n    await this.sdk.refreshDevices();\n  }\n\n  async unblockAudio() {\n    await this.sdk.getAudioOutput().unblockAutoplay();\n  }\n\n  async setVolume(value: number, trackId?: HMSTrackID) {\n    if (trackId) {\n      await this.setTrackVolume(value, trackId);\n    } else {\n      await this.sdk.getAudioOutput().setVolume(value);\n      this.syncRoomState('setOutputVolume');\n    }\n  }\n\n  async setAudioOutputDevice(deviceId: string): Promise<void> {\n    const deviceInfo = await this.sdk.getAudioOutput().setDevice(deviceId);\n    if (deviceInfo) {\n      this.setState(draftStore => {\n        draftStore.settings.audioOutputDeviceId = deviceId;\n      }, 'setAudioOutputDevice');\n    }\n  }\n\n  async setPreferredLayer(trackId: string, layer: sdkTypes.HMSPreferredSimulcastLayer) {\n    const track = this.getTrackById(trackId);\n    if (track) {\n      if (track instanceof SDKHMSRemoteVideoTrack) {\n        //@ts-ignore\n        if (layer === HMSSimulcastLayer.NONE) {\n          HMSLogger.d(`layer ${HMSSimulcastLayer.NONE} will be ignored`);\n          return;\n        }\n        const alreadyInSameState = this.store.getState(selectVideoTrackByID(trackId))?.preferredLayer === layer;\n        if (alreadyInSameState) {\n          HMSLogger.d(`preferred layer is already ${layer}`);\n          return;\n        }\n        this.setState(draftStore => {\n          const track = draftStore.tracks[trackId] as HMSVideoTrack;\n          if (track) {\n            track.preferredLayer = layer;\n          }\n        }, 'setPreferredLayer');\n        await track.setPreferredLayer(layer);\n      } else {\n        HMSLogger.d(`track ${trackId} is not a remote video track`);\n      }\n    } else {\n      this.logPossibleInconsistency(`track ${trackId} not present, unable to set preffer layer`);\n    }\n  }\n\n  getNativeTrackById(trackId: string) {\n    return this.sdk.store.getTrackById(trackId)?.nativeTrack;\n  }\n\n  getTrackById(trackId: string) {\n    return this.sdk.store.getTrackById(trackId);\n  }\n\n  getAuthTokenByRoomCode(\n    tokenRequest: sdkTypes.TokenRequest,\n    tokenRequestOptions?: sdkTypes.TokenRequestOptions,\n  ): Promise<string> {\n    return this.sdk.getAuthTokenByRoomCode(tokenRequest, tokenRequestOptions);\n  }\n\n  async preview(config: sdkTypes.HMSPreviewConfig) {\n    const roomState = this.store.getState(selectRoomState);\n    if (roomState === HMSRoomState.Preview || roomState === HMSRoomState.Connecting) {\n      this.logPossibleInconsistency('attempting to call preview while room is in preview/connecting');\n      return;\n    }\n\n    try {\n      if (roomState !== HMSRoomState.Connected) {\n        this.setState(store => {\n          store.room.roomState = HMSRoomState.Connecting;\n        }, 'connecting');\n      }\n      await this.sdkPreviewWithListeners(config);\n    } catch (err) {\n      HMSLogger.e('Cannot show preview. Failed to connect to room - ', err);\n      throw err;\n    }\n  }\n\n  async cancelMidCallPreview() {\n    return this.sdk.cancelMidCallPreview();\n  }\n\n  async join(config: sdkTypes.HMSConfig) {\n    if (this.isRoomJoinCalled) {\n      this.logPossibleInconsistency('room join is called again');\n      return; // ignore\n    }\n    try {\n      this.isRoomJoinCalled = true;\n      this.setState(store => {\n        store.room.roomState = HMSRoomState.Connecting;\n      }, 'join');\n      await this.sdkJoinWithListeners(config);\n    } catch (err) {\n      this.isRoomJoinCalled = false; // so it can be called again if needed\n      HMSLogger.e('Failed to connect to room - ', err);\n      throw err;\n    }\n  }\n\n  async leave() {\n    const isConnectedToRoom = this.store.getState(selectIsConnectedToRoom);\n    let notifyServer = true;\n    if (!isConnectedToRoom) {\n      notifyServer = false;\n      this.logPossibleInconsistency('room leave is called when no room is connected');\n    }\n    const currentRoomState = this.store.getState(selectRoomState);\n    this.setState(store => {\n      store.room.roomState = HMSRoomState.Disconnecting;\n    }, 'leaving');\n    return this.sdk\n      .leave(notifyServer)\n      .then(() => {\n        this.resetState('leave');\n        if (this.beamSpeakerLabelsLogger) {\n          this.beamSpeakerLabelsLogger.stop().catch(HMSLogger.e);\n        }\n        HMSLogger.i('left room');\n      })\n      .catch(err => {\n        HMSLogger.e('error in leaving room - ', err);\n        this.setState(store => {\n          store.room.roomState = currentRoomState;\n        }, 'revertLeave');\n      });\n  }\n\n  async setScreenShareEnabled(enabled: boolean, config?: HMSScreenShareConfig) {\n    // TODO: remove this, purely for backward compatibility\n    if (typeof config === 'boolean') {\n      config = { audioOnly: config };\n    }\n    try {\n      if (enabled) {\n        await this.startScreenShare(config);\n      } else {\n        await this.stopScreenShare();\n      }\n    } catch (error) {\n      this.hmsNotifications.sendError(SDKToHMS.convertException(error as SDKHMSException));\n      throw error;\n    }\n  }\n\n  async addTrack(track: MediaStreamTrack, type: HMSTrackSource = 'regular') {\n    await this.sdk.addTrack(track, type);\n    this.syncRoomState('addTrack');\n  }\n\n  async removeTrack(trackId: string) {\n    await this.sdk.removeTrack(trackId);\n    this.syncRoomState('removeTrack');\n  }\n\n  async setLocalAudioEnabled(enabled: boolean) {\n    const trackID = this.store.getState(selectLocalAudioTrackID);\n    if (trackID) {\n      await this.setEnabledTrack(trackID, enabled);\n    }\n  }\n\n  async setLocalVideoEnabled(enabled: boolean) {\n    const trackID = this.store.getState(selectLocalVideoTrackID);\n    if (trackID) {\n      await this.setEnabledTrack(trackID, enabled);\n    }\n  }\n\n  async setEnabledTrack(trackID: string, enabled: boolean) {\n    // if mute/unmute is clicked multiple times for same operation, ignore repeated ones\n    const alreadyInSameState = this.store.getState().tracks[trackID]?.enabled === enabled;\n    if (alreadyInSameState) {\n      // it could also be a case of possible inconsistency where UI state is out of sync with truth\n      this.logPossibleInconsistency(`local track[${trackID}] enabled state - ${enabled}`);\n      return;\n    }\n    this.setState(store => {\n      // show on UI immediately\n      if (!store.tracks[trackID]) {\n        this.logPossibleInconsistency('track id not found for setEnabled');\n      } else {\n        store.tracks[trackID].displayEnabled = enabled;\n      }\n    }, 'displayEnabled');\n    try {\n      await this.setEnabledSDKTrack(trackID, enabled); // do the operation\n      this.syncRoomState('setEnabled');\n    } catch (err) {\n      // rollback on failure\n      this.setState(store => {\n        store.tracks[trackID].displayEnabled = !enabled;\n      }, 'rollbackDisplayEnabled');\n      this.hmsNotifications.sendError(SDKToHMS.convertException(err as SDKHMSException));\n      throw err;\n    }\n    const type = enabled ? sdkTypes.HMSTrackUpdate.TRACK_UNMUTED : sdkTypes.HMSTrackUpdate.TRACK_MUTED;\n    this.hmsNotifications.sendTrackUpdate(type, trackID);\n  }\n\n  async setAudioSettings(settings: Partial<sdkTypes.HMSAudioTrackSettings>) {\n    const trackID = this.store.getState(selectLocalAudioTrackID);\n\n    if (trackID) {\n      await this.setSDKLocalAudioTrackSettings(trackID, settings);\n      this.syncRoomState('setAudioSettings');\n    }\n  }\n\n  async setVideoSettings(settings: Partial<sdkTypes.HMSVideoTrackSettings>) {\n    const trackID = this.store.getState(selectLocalVideoTrackID);\n    if (trackID) {\n      await this.setSDKLocalVideoTrackSettings(trackID, settings);\n      this.syncRoomState('setVideoSettings');\n    }\n  }\n\n  async switchCamera(): Promise<void> {\n    const trackID = this.store.getState(selectLocalVideoTrackID);\n    if (trackID) {\n      const sdkTrack = this.sdk.store\n        .getLocalPeerTracks()\n        .find(track => track.trackId === trackID) as SDKHMSLocalVideoTrack;\n      if (sdkTrack) {\n        await sdkTrack.switchCamera();\n        this.syncRoomState('switchCamera');\n      }\n    }\n  }\n\n  sendMessage(message: string) {\n    this.sendBroadcastMessage(message);\n  }\n\n  async sendBroadcastMessage(message: string, type?: string) {\n    const { message_id: id, timestamp: time } = await this.sdk.sendBroadcastMessage(message, type);\n    this.updateMessageInStore({ message, type, id, time });\n  }\n\n  async sendGroupMessage(message: string, roles: string[], type?: string) {\n    const storeRoles = this.store.getState(selectRolesMap);\n    const hmsRoles = roles.map(roleName => {\n      return storeRoles[roleName];\n    });\n    const { message_id: id, timestamp: time } = await this.sdk.sendGroupMessage(message, hmsRoles, type);\n    this.updateMessageInStore({ message, recipientRoles: roles, type, id, time });\n  }\n\n  async sendDirectMessage(message: string, peerID: string, type?: string) {\n    const { message_id: id, timestamp: time } = await this.sdk.sendDirectMessage(message, peerID, type);\n    this.updateMessageInStore({ message, recipientPeer: peerID, type, id, time });\n  }\n\n  private updateMessageInStore(messageInput: HMSMessageInput) {\n    if (!messageInput.message) {\n      HMSLogger.w('sendMessage', 'Failed to send message', messageInput);\n      throw Error(`sendMessage Failed - ${JSON.stringify(messageInput)}`);\n    }\n    const ignoreMessage = !!messageInput.type && this.ignoredMessageTypes.includes(messageInput.type);\n    if (ignoreMessage) {\n      return;\n    }\n    const localPeer = this.sdk.getLocalPeer();\n    const hmsMessage: HMSMessage = {\n      read: true,\n      id: messageInput.id,\n      time: new Date(messageInput.time),\n      message: messageInput.message,\n      type: messageInput.type || 'chat',\n      recipientPeer: messageInput.recipientPeer,\n      recipientRoles: messageInput.recipientRoles,\n      senderName: localPeer?.name,\n      sender: localPeer?.peerId,\n      senderRole: localPeer?.role?.name,\n      ignored: false,\n    };\n    // update directly to store without batch\n    this.setState(store => {\n      store.messages.byID[hmsMessage.id] = hmsMessage;\n      store.messages.allIDs.push(hmsMessage.id);\n    }, 'newMessage');\n  }\n\n  setMessageRead(readStatus: boolean, messageId?: string) {\n    this.setState(store => {\n      if (messageId) {\n        if (!store.messages.byID[messageId]) {\n          this.logPossibleInconsistency('no message with id is found');\n        } else {\n          store.messages.byID[messageId].read = readStatus;\n        }\n      } else {\n        store.messages.allIDs.forEach((id: string) => {\n          store.messages.byID[id].read = readStatus;\n        });\n      }\n    }, 'setMessageRead');\n  }\n\n  async attachVideo(trackID: string, videoElement: HTMLVideoElement) {\n    if (this.localAndVideoUnmuting(trackID)) {\n      // wait till video unmute has finished\n      return new Promise<void>(resolve => {\n        const unsub = this.store.subscribe(async enabled => {\n          if (enabled) {\n            await this.attachVideoInternal(trackID, videoElement);\n            unsub();\n            resolve();\n          }\n        }, selectIsLocalVideoEnabled);\n      });\n    } else {\n      await this.attachVideoInternal(trackID, videoElement);\n    }\n  }\n\n  async detachVideo(trackID: string, videoElement: HTMLVideoElement) {\n    const sdkTrack = this.getTrackById(trackID);\n    if (sdkTrack?.type === 'video') {\n      await this.sdk.detachVideo(sdkTrack as SDKHMSVideoTrack, videoElement);\n    } else {\n      if (videoElement) {\n        videoElement.srcObject = null; // so chrome can clean up\n      }\n      HMSLogger.d('possible inconsistency detected - no video track found to remove sink');\n    }\n  }\n\n  async addPluginToVideoTrack(plugin: HMSVideoPlugin, pluginFrameRate?: number): Promise<void> {\n    return this.addRemoveVideoPlugin(plugin, 'add', pluginFrameRate);\n  }\n\n  async addPluginsToVideoStream(plugins: HMSMediaStreamPlugin[]): Promise<void> {\n    return this.addRemoveMediaStreamVideoPlugins(plugins, 'add');\n  }\n\n  async removePluginsFromVideoStream(plugins: HMSMediaStreamPlugin[]): Promise<void> {\n    return this.addRemoveMediaStreamVideoPlugins(plugins, 'remove');\n  }\n\n  async addPluginToAudioTrack(plugin: HMSAudioPlugin): Promise<void> {\n    return this.addRemoveAudioPlugin(plugin, 'add');\n  }\n\n  validateVideoPluginSupport(plugin: HMSVideoPlugin): HMSPluginSupportResult {\n    let result = {} as HMSPluginSupportResult;\n    result.isSupported = false; //Setting default to false\n    if (!plugin) {\n      HMSLogger.w('no plugin passed in for checking support');\n      result.errMsg = 'no plugin passed in for checking support';\n      return result;\n    }\n    const trackID = this.store.getState(selectLocalVideoTrackID);\n    if (!trackID) {\n      HMSLogger.w('video Track not added to local peer yet');\n      result.errMsg = 'call this function only after local peer has video track';\n      return result;\n    }\n    const sdkTrack = this.getTrackById(trackID);\n    if (sdkTrack) {\n      result = (sdkTrack as SDKHMSLocalVideoTrack).validatePlugin(plugin);\n    } else {\n      HMSLogger.w(`track ${trackID} not present, unable to validate plugin`);\n      result.errMsg = `track ${trackID} not present, unable to validate plugin`;\n    }\n\n    return result;\n  }\n\n  validateAudioPluginSupport(plugin: HMSAudioPlugin): HMSPluginSupportResult {\n    let result = {} as HMSPluginSupportResult;\n    result.isSupported = false; //Setting default to false\n    if (!plugin) {\n      HMSLogger.w('no plugin passed in for checking support\"');\n      result.errMsg = 'no plugin passed in for checking support\"';\n      return result;\n    }\n    const trackID = this.store.getState(selectLocalAudioTrackID);\n    if (!trackID) {\n      HMSLogger.w('audio track not added to local peer yet');\n      result.errMsg = 'call this function only after local peer has audio track';\n      return result;\n    }\n    const sdkTrack = this.getTrackById(trackID);\n    if (sdkTrack) {\n      result = (sdkTrack as SDKHMSLocalAudioTrack).validatePlugin(plugin);\n    } else {\n      HMSLogger.w(`track ${trackID} not present, unable to validate plugin`);\n      result.errMsg = `track ${trackID} not present, unable to validate plugin`;\n    }\n\n    return result;\n  }\n\n  async removePluginFromVideoTrack(plugin: HMSVideoPlugin): Promise<void> {\n    return this.addRemoveVideoPlugin(plugin, 'remove');\n  }\n  async removePluginFromAudioTrack(plugin: HMSAudioPlugin): Promise<void> {\n    return this.addRemoveAudioPlugin(plugin, 'remove');\n  }\n\n  async changeRole(forPeerId: string, toRole: string, force = false) {\n    await this.sdk.changeRoleOfPeer(forPeerId, toRole, force);\n  }\n\n  async changeRoleOfPeer(forPeerId: string, toRole: string, force = false) {\n    await this.sdk.changeRoleOfPeer(forPeerId, toRole, force);\n  }\n\n  async changeRoleOfPeersWithRoles(roles: HMSRoleName[], toRole: HMSRoleName) {\n    const rolesToBeChanged = this.sdk.getRoles().filter(role => roles.includes(role.name));\n    await this.sdk.changeRoleOfPeersWithRoles(rolesToBeChanged, toRole);\n  }\n\n  // TODO: separate out role related things in another file\n  async acceptChangeRole(request: HMSRoleChangeRequest) {\n    const sdkPeer: sdkTypes.HMSPeer | undefined = request.requestedBy\n      ? this.getSDKHMSPeer(request.requestedBy.id)\n      : undefined;\n    if (!sdkPeer) {\n      HMSLogger.w(`peer for which role change is requested no longer available - ${request.requestedBy}`);\n    }\n    const sdkRequest = {\n      requestedBy: sdkPeer,\n      role: request.role,\n      token: request.token,\n    };\n    // TODO: hotfix for HMS-3639. Needs a better solution\n    await this.sdk.acceptChangeRole(sdkRequest);\n    this.removeRoleChangeRequest(request);\n  }\n\n  async raiseLocalPeerHand() {\n    await this.sdk.raiseLocalPeerHand();\n  }\n  async lowerLocalPeerHand() {\n    await this.sdk.lowerLocalPeerHand();\n  }\n  async raiseRemotePeerHand(peerId: string) {\n    await this.sdk.raiseRemotePeerHand(peerId);\n  }\n  async lowerRemotePeerHand(peerId: string) {\n    await this.sdk.lowerRemotePeerHand(peerId);\n  }\n\n  async getPeer(peerId: string) {\n    const peer = await this.sdk.getPeer(peerId);\n    if (peer) {\n      return SDKToHMS.convertPeer(peer) as HMSPeer;\n    }\n    return undefined;\n  }\n\n  async findPeerByName(options: FindPeerByNameRequestParams) {\n    const { offset, peers, eof } = await this.sdk.findPeerByName(options);\n    return { offset, eof, peers: peers.map(peer => SDKToHMS.convertPeer(peer) as HMSPeer) };\n  }\n\n  getPeerListIterator(options?: HMSPeerListIteratorOptions) {\n    const iterator = this.sdk.getPeerListIterator(options);\n    return {\n      hasNext: () => iterator.hasNext(),\n      next: async () => {\n        const sdkPeers = await iterator.next();\n        return sdkPeers.map(peer => SDKToHMS.convertPeer(peer) as HMSPeer);\n      },\n      findPeers: async () => {\n        const sdkPeers = await iterator.findPeers();\n        return sdkPeers.map(peer => SDKToHMS.convertPeer(peer) as HMSPeer);\n      },\n      getTotal: () => iterator.getTotal(),\n    };\n  }\n\n  initAppData(appData: Record<string, any>) {\n    this.setState(store => {\n      store.appData = appData;\n    }, 'initAppData');\n  }\n\n  setAppData(key: string, value: any, merge?: boolean) {\n    const isValueObject = value?.constructor.name === 'Object';\n    this.setState(store => {\n      if (store.appData) {\n        if (merge && isValueObject) {\n          Object.assign(store.appData[key], value);\n        } else {\n          store.appData[key] = value;\n        }\n      } else {\n        const newAppData = {\n          [key]: value,\n        };\n        store.appData = newAppData;\n      }\n    }, `setAppData-${key}`);\n  }\n\n  /**\n   * @privateRemarks\n   * there is no corresponding sdk method for rejecting change role but as the store also maintains the full\n   * state of current pending requests, this method allows it to clean up when the request is rejected\n   */\n  rejectChangeRole(request: HMSRoleChangeRequest) {\n    this.removeRoleChangeRequest(request);\n  }\n\n  async endRoom(lock: boolean, reason: string) {\n    const permissions = this.store.getState(selectPermissions);\n    if (!permissions?.endRoom) {\n      HMSLogger.w('You are not allowed to perform this action - endRoom');\n      return;\n    }\n    const currentRoomState = this.store.getState(selectRoomState);\n    this.setState(store => {\n      store.room.roomState = HMSRoomState.Disconnecting;\n    }, 'endingRoom');\n    try {\n      await this.sdk.endRoom(lock, reason);\n      this.resetState('endRoom');\n    } catch (err) {\n      HMSLogger.e('error in ending room - ', err);\n      this.setState(store => {\n        store.room.roomState = currentRoomState;\n      }, 'revertEndRoom');\n    }\n  }\n\n  async removePeer(peerID: string, reason: string) {\n    const localPeerId = this.sdk.getLocalPeer()?.peerId;\n    if (peerID !== localPeerId) {\n      await this.sdk.removePeer(peerID, reason);\n    }\n  }\n\n  async startRTMPOrRecording(params: sdkTypes.RTMPRecordingConfig) {\n    await this.sdk.startRTMPOrRecording(params);\n  }\n\n  async stopRTMPAndRecording() {\n    await this.sdk.stopRTMPAndRecording();\n  }\n\n  async startHLSStreaming(params?: sdkTypes.HLSConfig) {\n    await this.sdk.startHLSStreaming(params);\n  }\n\n  async stopHLSStreaming(params?: sdkTypes.HLSConfig): Promise<void> {\n    await this.sdk.stopHLSStreaming(params);\n  }\n\n  async startTranscription(params: sdkTypes.TranscriptionConfig) {\n    await this.sdk.startTranscription(params);\n  }\n\n  async stopTranscription(params: sdkTypes.TranscriptionConfig): Promise<void> {\n    await this.sdk.stopTranscription(params);\n  }\n\n  async sendHLSTimedMetadata(metadataList: sdkTypes.HLSTimedMetadata[]): Promise<void> {\n    await this.sdk.sendHLSTimedMetadata(metadataList);\n  }\n  async changeName(name: string) {\n    await this.sdk.changeName(name);\n  }\n\n  async changeMetadata(metadata: string | any) {\n    if (typeof metadata !== 'string') {\n      metadata = JSON.stringify(metadata);\n    }\n    await this.sdk.changeMetadata(metadata);\n  }\n\n  async setSessionMetadata(metadata: any) {\n    await this.sdk.setSessionMetadata(metadata);\n    this.setState(draftStore => {\n      draftStore.sessionMetadata = metadata;\n    }, 'setSessionMetadata');\n    this.setSessionStoreValueLocally({ key: 'default', value: metadata }, 'setSessionMetadata');\n  }\n\n  async populateSessionMetadata(): Promise<void> {\n    const metadata = await this.sdk.getSessionMetadata();\n    this.setState(draftStore => {\n      draftStore.sessionMetadata = metadata;\n    }, 'populateSessionMetadata');\n    this.setSessionStoreValueLocally({ key: 'default', value: metadata }, 'populateSessionmetadata');\n  }\n\n  async setRemoteTrackEnabled(trackID: HMSTrackID | HMSTrackID[], enabled: boolean) {\n    if (typeof trackID === 'string') {\n      const track = this.getTrackById(trackID);\n      if (track && isRemoteTrack(track)) {\n        await this.sdk.changeTrackState(track as SDKHMSRemoteTrack, enabled);\n      } else {\n        this.logPossibleInconsistency(`No remote track with ID ${trackID} found for change track state`);\n      }\n    } else if (Array.isArray(trackID)) {\n      trackID.forEach(id => this.setRemoteTrackEnabled(id, enabled));\n    }\n  }\n\n  async setRemoteTracksEnabled(params: HMSChangeMultiTrackStateParams) {\n    const sdkRequest: SDKHMSChangeMultiTrackStateParams = {\n      enabled: params.enabled,\n      type: params.type,\n      source: params.source,\n    };\n    if (params.roles) {\n      const rolesMap = this.store.getState(selectRolesMap);\n      sdkRequest.roles = params.roles.map(role => rolesMap[role]);\n    }\n    await this.sdk.changeMultiTrackState(sdkRequest);\n  }\n\n  setLogLevel(level: HMSLogLevel) {\n    HMSLogger.level = level;\n    this.sdk.setLogLevel(level);\n  }\n\n  setFrameworkInfo(frameworkInfo: sdkTypes.HMSFrameworkInfo) {\n    this.sdk.setFrameworkInfo(frameworkInfo);\n  }\n\n  ignoreMessageTypes(msgTypes: string[], replace = false) {\n    if (replace) {\n      this.ignoredMessageTypes = msgTypes;\n    } else {\n      for (const msgType of msgTypes) {\n        if (!this.ignoredMessageTypes.includes(msgType)) {\n          this.ignoredMessageTypes.push(msgType);\n        }\n      }\n    }\n  }\n\n  async enableBeamSpeakerLabelsLogging() {\n    if (!this.beamSpeakerLabelsLogger) {\n      HMSLogger.i('enabling beam speaker labels logging');\n      this.beamSpeakerLabelsLogger = new BeamSpeakerLabelsLogger(this.store, this);\n      await this.beamSpeakerLabelsLogger.start();\n    }\n  }\n  initDiagnostics() {\n    const diagnostics = new Diagnostics(this.sdk, {\n      onJoin: this.onJoin.bind(this),\n      onPreview: this.onPreview.bind(this),\n      onRoomUpdate: this.onRoomUpdate.bind(this),\n      onPeerUpdate: this.onPeerUpdate.bind(this),\n      onTrackUpdate: this.onTrackUpdate.bind(this),\n      onMessageReceived: this.onMessageReceived.bind(this),\n      onError: this.onError.bind(this),\n      onReconnected: this.onReconnected.bind(this),\n      onReconnecting: this.onReconnecting.bind(this),\n      onRoleChangeRequest: this.onRoleChangeRequest.bind(this),\n      onRoleUpdate: this.onRoleUpdate.bind(this),\n      onDeviceChange: this.onDeviceChange.bind(this),\n      onChangeTrackStateRequest: this.onChangeTrackStateRequest.bind(this),\n      onChangeMultiTrackStateRequest: this.onChangeMultiTrackStateRequest.bind(this),\n      onRemovedFromRoom: this.onRemovedFromRoom.bind(this),\n      onNetworkQuality: this.onNetworkQuality.bind(this),\n      onSessionStoreUpdate: this.onSessionStoreUpdate.bind(this),\n      onPollsUpdate: this.onPollsUpdate.bind(this),\n      onWhiteboardUpdate: this.onWhiteboardUpdate.bind(this),\n    });\n    this.sdk.addAudioListener({\n      onAudioLevelUpdate: this.onAudioLevelUpdate.bind(this),\n    });\n    this.sdk.addConnectionQualityListener({\n      onConnectionQualityUpdate: this.onConnectionQualityUpdate.bind(this),\n    });\n    return diagnostics;\n  }\n\n  private resetState(reason = 'resetState') {\n    this.isRoomJoinCalled = false;\n    HMSLogger.cleanup();\n    this.setState(store => {\n      Object.assign(store, createDefaultStoreState());\n    }, reason);\n  }\n\n  private async sdkJoinWithListeners(config: sdkTypes.HMSConfig) {\n    await this.sdk.join(config, {\n      onJoin: this.onJoin.bind(this),\n      onPreview: this.onPreview.bind(this),\n      onRoomUpdate: this.onRoomUpdate.bind(this),\n      onPeerUpdate: this.onPeerUpdate.bind(this),\n      onTrackUpdate: this.onTrackUpdate.bind(this),\n      onMessageReceived: this.onMessageReceived.bind(this),\n      onError: this.onError.bind(this),\n      onReconnected: this.onReconnected.bind(this),\n      onReconnecting: this.onReconnecting.bind(this),\n      onRoleChangeRequest: this.onRoleChangeRequest.bind(this),\n      onRoleUpdate: this.onRoleUpdate.bind(this),\n      onDeviceChange: this.onDeviceChange.bind(this),\n      onChangeTrackStateRequest: this.onChangeTrackStateRequest.bind(this),\n      onChangeMultiTrackStateRequest: this.onChangeMultiTrackStateRequest.bind(this),\n      onRemovedFromRoom: this.onRemovedFromRoom.bind(this),\n      onNetworkQuality: this.onNetworkQuality.bind(this),\n      onSessionStoreUpdate: this.onSessionStoreUpdate.bind(this),\n      onPollsUpdate: this.onPollsUpdate.bind(this),\n      onWhiteboardUpdate: this.onWhiteboardUpdate.bind(this),\n      onSFUMigration: this.onSFUMigration.bind(this),\n    });\n    this.sdk.addAudioListener({\n      onAudioLevelUpdate: this.onAudioLevelUpdate.bind(this),\n    });\n    this.sdk.addConnectionQualityListener({\n      onConnectionQualityUpdate: this.onConnectionQualityUpdate.bind(this),\n    });\n  }\n\n  private onSFUMigration() {\n    this.syncRoomState('SFUMigration');\n  }\n  private onRemovedFromRoom(request: SDKHMSLeaveRoomRequest) {\n    const requestedBy = this.store.getState(selectPeerByID(request.requestedBy?.peerId));\n    this.hmsNotifications.sendLeaveRoom({\n      ...request,\n      requestedBy: requestedBy || undefined,\n    });\n    const action = request.roomEnded || !requestedBy ? 'roomEnded' : 'removedFromRoom';\n    HMSLogger.i(`resetting state after peer removed ${action}`, request);\n    this.resetState(action);\n  }\n\n  private onDeviceChange(event: sdkTypes.HMSDeviceChangeEvent) {\n    const devices = event.devices;\n    if (!devices) {\n      return;\n    }\n    const localPeer = this.store.getState(selectLocalPeer);\n    this.setState(store => {\n      if (!areArraysEqual(store.devices.audioInput, devices.audioInput)) {\n        store.devices.audioInput = devices.audioInput;\n      }\n      if (!areArraysEqual(store.devices.videoInput, devices.videoInput)) {\n        store.devices.videoInput = devices.videoInput;\n      }\n      if (!areArraysEqual(store.devices.audioOutput, devices.audioOutput)) {\n        store.devices.audioOutput = devices.audioOutput;\n      }\n      const sdkLocalPeer = this.sdk.getLocalPeer();\n      if (localPeer?.id && sdkLocalPeer) {\n        Object.assign(store.settings, this.getMediaSettings(sdkLocalPeer));\n      }\n    }, 'deviceChange');\n    // send notification only on device change - selection is present\n    if (event.selection) {\n      const notification = SDKToHMS.convertDeviceChangeUpdate(event);\n      this.hmsNotifications.sendDeviceChange(notification);\n    }\n  }\n\n  private async sdkPreviewWithListeners(config: sdkTypes.HMSPreviewConfig) {\n    await this.sdk.preview(config, {\n      onPreview: this.onPreview.bind(this),\n      onError: this.onError.bind(this),\n      onReconnected: this.onReconnected.bind(this),\n      onReconnecting: this.onReconnecting.bind(this),\n      onDeviceChange: this.onDeviceChange.bind(this),\n      onRoomUpdate: this.onRoomUpdate.bind(this),\n      onPeerUpdate: this.onPeerUpdate.bind(this),\n      onNetworkQuality: this.onNetworkQuality.bind(this),\n    });\n    this.sdk.addAudioListener({\n      onAudioLevelUpdate: this.onAudioLevelUpdate.bind(this),\n    });\n  }\n\n  private onNetworkQuality(quality: number) {\n    this.setState(store => {\n      /*\n       * if store does not have peerId yet, fetch from sdk directly.\n       * sdk will have the localpeer already set.\n       */\n      const peerId = store.room.localPeer || this.sdk.getLocalPeer()?.peerId;\n      if (peerId) {\n        store.connectionQualities[peerId] = { peerID: peerId, downlinkQuality: quality };\n      }\n    }, 'ConnectionQuality');\n  }\n\n  private onSessionStoreUpdate(updates: SessionStoreUpdate[]) {\n    this.setSessionStoreValueLocally(updates, 'sessionStoreUpdate');\n  }\n\n  private onPollsUpdate(actionType: sdkTypes.HMSPollsUpdate, polls: sdkTypes.HMSPoll[]) {\n    const actionName = POLL_NOTIFICATION_TYPES[actionType];\n    this.setState(draftStore => {\n      const pollsObject = polls.reduce((acc, poll) => {\n        acc[poll.id] = {\n          ...poll,\n          questions: poll.questions?.map(question => ({\n            ...question,\n            answer: question.answer ? { ...question.answer } : undefined,\n            options: question.options?.map(option => ({ ...option })),\n            responses: question.responses?.map(response => ({ ...response })),\n          })),\n        };\n        return acc;\n      }, {} as { [key: string]: sdkTypes.HMSPoll });\n      mergeNewPollsInDraft(draftStore.polls, pollsObject);\n    }, actionName);\n    polls.forEach(poll => this.hmsNotifications.sendPollUpdate(actionType, poll.id));\n  }\n\n  private onWhiteboardUpdate(whiteboard: sdkTypes.HMSWhiteboard) {\n    this.setState(draftStore => {\n      draftStore.whiteboards[whiteboard.id] = whiteboard;\n    }, 'whiteboardUpdate');\n  }\n\n  private async startScreenShare(config?: HMSScreenShareConfig) {\n    const isScreenShared = this.store.getState(selectIsLocalScreenShared);\n    if (!isScreenShared) {\n      await this.sdk.startScreenShare(() => this.syncRoomState('screenshareStopped'), config);\n      this.syncRoomState('startScreenShare');\n    } else {\n      this.logPossibleInconsistency(\"start screenshare is called while it's on\");\n    }\n  }\n\n  private async stopScreenShare() {\n    const isScreenShared = this.store.getState(selectIsLocalScreenShared);\n    if (isScreenShared) {\n      await this.sdk.stopScreenShare();\n      this.syncRoomState('stopScreenShare');\n    } else {\n      this.logPossibleInconsistency(\"stop screenshare is called while it's not on\");\n    }\n  }\n\n  private async attachVideoInternal(trackID: string, videoElement: HTMLVideoElement) {\n    let sdkTrack = this.getTrackById(trackID);\n    // preview tracks are not added to the sdk store, so access from local peer.\n    if (!sdkTrack) {\n      sdkTrack = this.getLocalTrack(trackID);\n    }\n    if (sdkTrack && sdkTrack.type === 'video') {\n      await this.sdk.attachVideo(sdkTrack as SDKHMSVideoTrack, videoElement);\n    } else {\n      this.logPossibleInconsistency('no video track found to add sink');\n    }\n  }\n\n  /**\n   * This is a very important function as it's responsible for maintaining the source of\n   * truth with maximum efficiency. The efficiency comes from the fact that the only\n   * those portions of the store are updated which have actually changed.\n   * While making a change in this function don't use functions like map, reduce etc.\n   * which return a new copy of the data. Use Object.assign etc. to ensure that if the data\n   * doesn't change reference is also not changed.\n   * The UI and selectors rely on the fact that the store is immutable that is if there is\n   * any change and only if there is a change, they'll get a new copy of the data they're\n   * interested in with a new reference.\n   * @protected\n   */\n  protected syncRoomState(action: string) {\n    action = `${action}_fullSync`;\n    HMSLogger.time(`store-sync-${action}`);\n    const newHmsPeers: Record<HMSPeerID, Partial<HMSPeer>> = {};\n    const newHmsPeerIDs: HMSPeerID[] = []; // to add in room.peers\n    const newHmsTracks: Record<HMSTrackID, Partial<HMSTrack>> = {};\n    const newMediaSettings: Partial<HMSMediaSettings> = {};\n    const newNetworkQuality: Record<HMSPeerID, sdkTypes.HMSConnectionQuality> = {};\n    let newPreview: HMSStore['preview'];\n\n    const sdkPeers: sdkTypes.HMSPeer[] = this.sdk.getPeers();\n\n    // first convert everything in the new format\n    for (const sdkPeer of sdkPeers) {\n      const hmsPeer = SDKToHMS.convertPeer(sdkPeer);\n      newHmsPeers[hmsPeer.id] = hmsPeer;\n      newHmsPeerIDs.push(hmsPeer.id);\n      newNetworkQuality[hmsPeer.id] = {\n        peerID: hmsPeer.id,\n        downlinkQuality: sdkPeer.networkQuality || -1,\n      };\n\n      const sdkTracks = [sdkPeer.audioTrack, sdkPeer.videoTrack, ...sdkPeer.auxiliaryTracks];\n      for (const sdkTrack of sdkTracks) {\n        if (!sdkTrack) {\n          continue;\n        }\n        const hmsTrack = SDKToHMS.convertTrack(sdkTrack);\n        newHmsTracks[hmsTrack.id] = hmsTrack;\n      }\n\n      if (sdkPeer.isLocal) {\n        const localPeer = sdkPeer as sdkTypes.HMSLocalPeer;\n        newPreview = this.getPreviewFields(localPeer);\n        Object.assign(newMediaSettings, this.getMediaSettings(localPeer));\n      }\n    }\n\n    const recording = this.sdk.getRecordingState();\n    const rtmp = this.sdk.getRTMPState();\n    const hls = this.sdk.getHLSState();\n    const transcriptions = this.sdk.getTranscriptionState();\n\n    // then merge them carefully with our store so if something hasn't changed\n    // the reference shouldn't change. Note that the draftStore is an immer draft\n    // object.\n    this.setState(draftStore => {\n      draftStore.room.peers = newHmsPeerIDs;\n      const draftPeers = draftStore.peers;\n      const draftTracks = draftStore.tracks;\n      // the order of below statements are important as merge functions are mutating\n      mergeNewPeersInDraft(draftPeers, newHmsPeers);\n      mergeNewTracksInDraft(draftTracks, newHmsTracks);\n      Object.assign(draftStore.settings, newMediaSettings);\n      if (draftStore.room.isConnected) {\n        Object.assign(draftStore.connectionQualities, newNetworkQuality);\n      }\n\n      /**\n       * if preview is already present merge,\n       * else set as is(which will create/delete)\n       */\n      if (draftStore.preview?.localPeer && newPreview?.localPeer) {\n        Object.assign(draftStore.preview, newPreview);\n      } else {\n        draftStore.preview = newPreview;\n      }\n      Object.assign(draftStore.roles, SDKToHMS.convertRoles(this.sdk.getRoles()));\n      Object.assign(draftStore.playlist, SDKToHMS.convertPlaylist(this.sdk.getPlaylistManager()));\n      Object.assign(draftStore.room, SDKToHMS.convertRecordingStreamingState(recording, rtmp, hls, transcriptions));\n      Object.assign(draftStore.templateAppData, this.sdk.getTemplateAppData());\n    }, action);\n    HMSLogger.timeEnd(`store-sync-${action}`);\n  }\n\n  protected onPreview(sdkRoom: sdkTypes.HMSRoom) {\n    this.setState(store => {\n      Object.assign(store.room, SDKToHMS.convertRoom(sdkRoom, this.sdk.getLocalPeer()?.peerId));\n      store.room.roomState = HMSRoomState.Preview;\n    }, 'previewStart');\n    this.syncRoomState('previewSync');\n  }\n\n  protected onJoin(sdkRoom: sdkTypes.HMSRoom) {\n    const playlistManager = this.sdk.getPlaylistManager();\n    this.audioPlaylist = new HMSPlaylist(\n      playlistManager,\n      HMSPlaylistType.audio,\n      this.syncPlaylistState.bind(this),\n      this.store,\n    );\n    this.videoPlaylist = new HMSPlaylist(\n      playlistManager,\n      HMSPlaylistType.video,\n      this.syncRoomState.bind(this),\n      this.store,\n    );\n    this.syncRoomState('joinSync');\n    this.setState(store => {\n      Object.assign(store.room, SDKToHMS.convertRoom(sdkRoom, this.sdk.getLocalPeer()?.peerId));\n      store.room.isConnected = true;\n      store.room.roomState = HMSRoomState.Connected;\n    }, 'joined');\n\n    playlistManager.onProgress(this.setProgress);\n    playlistManager.onNewTrackStart((item: sdkTypes.HMSPlaylistItem<any>) => {\n      this.syncPlaylistState(`${item.type}PlaylistUpdate`);\n    });\n    playlistManager.onPlaylistEnded((type: HMSPlaylistType) => {\n      this.syncPlaylistState(`${type}PlaylistEnded`);\n    });\n    playlistManager.onCurrentTrackEnded((item: sdkTypes.HMSPlaylistItem<any>) => {\n      this.hmsNotifications.sendPlaylistTrackEnded(SDKToHMS.convertPlaylistItem(playlistManager, item));\n      this.syncPlaylistState(`${item.type}PlaylistItemEnded`);\n    });\n  }\n\n  protected onRoomUpdate(type: sdkTypes.HMSRoomUpdate, room: sdkTypes.HMSRoom) {\n    this.setState(store => {\n      Object.assign(store.room, SDKToHMS.convertRoom(room, this.sdk.getLocalPeer()?.peerId));\n    }, type);\n    if (type === sdkTypes.HMSRoomUpdate.TRANSCRIPTION_STATE_UPDATED) {\n      this.hmsNotifications.sendTranscriptionUpdate(room.transcriptions);\n    }\n  }\n\n  protected onPeerUpdate(type: sdkTypes.HMSPeerUpdate, sdkPeer: sdkTypes.HMSPeer | sdkTypes.HMSPeer[]) {\n    if (\n      [sdkTypes.HMSPeerUpdate.BECAME_DOMINANT_SPEAKER, sdkTypes.HMSPeerUpdate.RESIGNED_DOMINANT_SPEAKER].includes(type)\n    ) {\n      return; // ignore, high frequency update so no point of syncing peers\n    }\n    if (Array.isArray(sdkPeer)) {\n      const storePeers = this.store.getState(selectPeersMap);\n      const newPeerIds = sdkPeer.filter(peer => !storePeers[peer.peerId]);\n      this.syncRoomState('peersJoined');\n      const connected = this.store.getState(selectIsConnectedToRoom);\n      // This is not send unnecessary notifications while in preview\n      // now room state also call peer list to handle large peers\n      if (connected) {\n        const hmsPeers = [];\n        for (const peer of sdkPeer) {\n          const hmsPeer = this.store.getState(selectPeerByID(peer.peerId));\n          if (hmsPeer) {\n            hmsPeers.push(hmsPeer);\n          }\n        }\n        this.hmsNotifications.sendPeerList(hmsPeers);\n      } else {\n        newPeerIds.forEach(peer => {\n          const hmsPeer = this.store.getState(selectPeerByID(peer.peerId));\n          if (hmsPeer) {\n            this.hmsNotifications.sendPeerUpdate(sdkTypes.HMSPeerUpdate.PEER_JOINED, hmsPeer);\n          }\n        });\n      }\n      return;\n    }\n    this.sendPeerUpdateNotification(type, sdkPeer);\n  }\n\n  protected onTrackUpdate(type: sdkTypes.HMSTrackUpdate, track: SDKHMSTrack, peer: sdkTypes.HMSPeer) {\n    // this check is needed because for track removed case, the notification needs to\n    // be send before the track is removed from store\n    if (type === sdkTypes.HMSTrackUpdate.TRACK_REMOVED) {\n      this.hmsNotifications.sendTrackUpdate(type, track.trackId);\n      this.handleTrackRemove(track, peer);\n    } else if ([sdkTypes.HMSTrackUpdate.TRACK_ADDED, sdkTypes.HMSTrackUpdate.TRACK_REMOVED].includes(type)) {\n      const actionName = TRACK_NOTIFICATION_TYPES[type];\n      this.syncRoomState(actionName);\n      this.hmsNotifications.sendTrackUpdate(type, track.trackId);\n    } else {\n      const actionName = TRACK_NOTIFICATION_TYPES[type] || 'trackUpdate';\n      const hmsTrack = SDKToHMS.convertTrack(track);\n      this.setState(draftStore => {\n        const storeTrack = draftStore.tracks[hmsTrack.id];\n        if (isEntityUpdated(storeTrack, hmsTrack)) {\n          mergeTrackArrayFields(storeTrack, hmsTrack);\n          Object.assign(storeTrack, hmsTrack);\n        }\n      }, actionName);\n      this.hmsNotifications.sendTrackUpdate(type, track.trackId);\n    }\n  }\n\n  protected onMessageReceived(message: MessageNotification) {\n    const hmsMessage = SDKToHMS.convertMessage(message, this.store.getState(selectLocalPeerID)) as HMSMessage;\n    hmsMessage.read = false;\n    hmsMessage.ignored = this.ignoredMessageTypes.includes(hmsMessage.type);\n    if (hmsMessage.type === 'hms_transcript') {\n      hmsMessage.ignored = true;\n    }\n    this.putMessageInStore(hmsMessage);\n    this.hmsNotifications.sendMessageReceived(hmsMessage);\n  }\n\n  protected putMessageInStore(hmsMessage: HMSMessage) {\n    if (hmsMessage.ignored) {\n      return;\n    }\n    this.actionBatcher.setState(\n      store => {\n        store.messages.byID[hmsMessage.id] = hmsMessage;\n        store.messages.allIDs.push(hmsMessage.id);\n      },\n      'newMessage',\n      150,\n    );\n  }\n\n  /*\n   * Note: speakers array contain the value only for peers who have audioLevel != 0\n   */\n  protected onAudioLevelUpdate(sdkSpeakers: sdkTypes.HMSSpeaker[]) {\n    this.setState(store => {\n      const trackIDAudioLevelMap: Record<HMSPeerID, number> = {};\n      sdkSpeakers.forEach(sdkSpeaker => {\n        if (!sdkSpeaker.track || !sdkSpeaker.peer) {\n          return;\n        }\n        const trackID = sdkSpeaker.track.trackId;\n        trackIDAudioLevelMap[trackID] = sdkSpeaker.audioLevel;\n        if (!store.speakers[trackID]) {\n          // Set store instances(peers, tracks) references in speaker, not the new ones received.\n          store.speakers[trackID] = {\n            audioLevel: sdkSpeaker.audioLevel,\n            peerID: sdkSpeaker.peer.peerId,\n            trackID: trackID,\n          };\n        }\n      });\n      const speakerEntries = Object.entries(store.speakers);\n      for (const [trackID, speaker] of speakerEntries) {\n        speaker.audioLevel = trackIDAudioLevelMap[trackID] || 0;\n        if (speaker.audioLevel === 0) {\n          delete store.speakers[trackID];\n        }\n      }\n    }, 'audioLevel');\n  }\n\n  /**\n   * The connection quality update is sent for all peers(one needs to know of) every time.\n   */\n  protected onConnectionQualityUpdate(newQualities: sdkTypes.HMSConnectionQuality[]) {\n    this.setState(store => {\n      newQualities.forEach(sdkUpdate => {\n        const peerID = sdkUpdate.peerID;\n        if (!peerID) {\n          return;\n        }\n        if (!store.connectionQualities[peerID]) {\n          store.connectionQualities[peerID] = sdkUpdate;\n        } else {\n          Object.assign(store.connectionQualities[peerID], sdkUpdate);\n        }\n      });\n    }, 'connectionQuality');\n  }\n\n  protected onChangeTrackStateRequest(request: SDKHMSChangeTrackStateRequest) {\n    const requestedBy = this.store.getState(selectPeerByID(request.requestedBy?.peerId));\n    const storeTrackID = this.getStoreLocalTrackIDfromSDKTrack(request.track);\n    const track = this.store.getState(selectTrackByID(storeTrackID));\n\n    if (!track) {\n      return this.logPossibleInconsistency(\n        `Not found track for which track state change was requested, ${request.track}`,\n      );\n    }\n\n    if (!request.enabled) {\n      this.syncRoomState('changeTrackStateRequest');\n    }\n\n    this.hmsNotifications.sendChangeTrackStateRequest({\n      requestedBy: requestedBy || undefined,\n      track,\n      enabled: request.enabled,\n    });\n  }\n\n  protected onChangeMultiTrackStateRequest(request: SDKHMSChangeMultiTrackStateRequest) {\n    const requestedBy = this.store.getState(selectPeerByID(request.requestedBy?.peerId));\n\n    if (!request.enabled) {\n      this.syncRoomState('changeMultiTrackStateRequest');\n    }\n\n    const tracks: HMSTrack[] = [];\n    const tracksMap = this.store.getState(selectTracksMap);\n    for (const track of request.tracks) {\n      const storeTrackID = this.getStoreLocalTrackIDfromSDKTrack(track);\n      if (storeTrackID && tracksMap[storeTrackID]) {\n        tracks.push(tracksMap[storeTrackID]);\n      }\n    }\n\n    this.hmsNotifications.sendChangeMultiTrackStateRequest({\n      requestedBy: requestedBy || undefined,\n      tracks,\n      enabled: request.enabled,\n      type: request.type,\n      source: request.source,\n    });\n  }\n\n  protected onReconnected() {\n    this.syncRoomState('reconnectedSync');\n    this.hmsNotifications.sendReconnected();\n    this.setState(store => {\n      store.room.roomState = store.room.isConnected ? HMSRoomState.Connected : HMSRoomState.Preview;\n    }, 'reconnected');\n  }\n\n  protected onReconnecting(sdkError: SDKHMSException) {\n    const error = SDKToHMS.convertException(sdkError);\n    HMSLogger.e('Reconnection: received error from sdk', error);\n    this.hmsNotifications.sendReconnecting(error);\n    this.setState(store => {\n      store.room.roomState = HMSRoomState.Reconnecting;\n      store.errors.push(error);\n    }, 'reconnecting');\n  }\n\n  protected onError(sdkException: SDKHMSException) {\n    const error = SDKToHMS.convertException(sdkException);\n    if (error.isTerminal) {\n      // terminal error leave room as it is not recoverable\n      this.leave().then(() => HMSLogger.e('error from SDK, left room.'));\n      this.setState(store => {\n        store.room.roomState = HMSRoomState.Failed;\n        store.errors.push(error);\n      }, 'errorTerminal');\n    } else {\n      const numExistingErrors = this.store.getState().errors.length;\n      // just in case there is some infinite loop sending errors\n      if (numExistingErrors < 50) {\n        this.setState(store => {\n          store.errors.push(error);\n        }, 'error');\n      }\n    }\n    this.syncRoomState('errorSync'); //TODO: check if need to be done in a different way\n    // send notification\n    this.hmsNotifications.sendError(error);\n    HMSLogger.e('received error from sdk', error instanceof SDKHMSException ? `${error}` : error);\n  }\n\n  private handleTrackRemove(sdkTrack: SDKHMSTrack, sdkPeer: sdkTypes.HMSPeer) {\n    this.setState(draftStore => {\n      const hmsPeer = draftStore.peers[sdkPeer.peerId];\n      const draftTracks = draftStore.tracks;\n      const trackId = sdkTrack.trackId;\n\n      if (hmsPeer) {\n        if (trackId === hmsPeer.audioTrack) {\n          delete hmsPeer.audioTrack;\n        } else if (trackId === hmsPeer.videoTrack) {\n          delete hmsPeer.videoTrack;\n        } else {\n          const auxiliaryIndex = hmsPeer.auxiliaryTracks.indexOf(trackId);\n          if (auxiliaryIndex > -1) {\n            hmsPeer.auxiliaryTracks.splice(auxiliaryIndex, 1);\n          }\n        }\n      }\n      delete draftTracks[trackId];\n    }, 'trackRemoved');\n  }\n\n  private async setEnabledSDKTrack(trackID: string, enabled: boolean) {\n    const track = this.getLocalTrack(trackID);\n    if (track) {\n      await track.setEnabled(enabled);\n    } else {\n      this.logPossibleInconsistency(`track ${trackID} not present, unable to enabled/disable`);\n    }\n  }\n\n  private async setSDKLocalVideoTrackSettings(trackID: string, settings: Partial<sdkTypes.HMSVideoTrackSettings>) {\n    const track = this.getLocalTrack(trackID) as SDKHMSLocalVideoTrack;\n    if (track) {\n      await track.setSettings(settings);\n    } else {\n      this.logPossibleInconsistency(`local track ${trackID} not present, unable to set settings`);\n    }\n  }\n\n  private async setSDKLocalAudioTrackSettings(trackID: string, settings: Partial<sdkTypes.HMSAudioTrackSettings>) {\n    const track = this.getLocalTrack(trackID) as SDKHMSLocalAudioTrack;\n    if (track) {\n      await track.setSettings(settings);\n    } else {\n      this.logPossibleInconsistency(`local track ${trackID} not present, unable to set settings`);\n    }\n  }\n\n  private getMediaSettings(sdkPeer: sdkTypes.HMSPeer): Partial<HMSMediaSettings> {\n    const settings = this.store.getState(selectLocalMediaSettings);\n    const audioTrack = sdkPeer.audioTrack as SDKHMSLocalAudioTrack;\n    const videoTrack = sdkPeer.videoTrack as SDKHMSLocalVideoTrack;\n    return {\n      audioInputDeviceId: audioTrack?.settings.deviceId || settings.audioInputDeviceId,\n      videoInputDeviceId: videoTrack?.settings.deviceId || settings.videoInputDeviceId,\n      audioOutputDeviceId: this.sdk.getAudioOutput().getDevice()?.deviceId,\n      audioMode: audioTrack?.settings.audioMode || HMSAudioMode.VOICE,\n    };\n  }\n\n  private getPreviewFields(sdkLocalPeer: sdkTypes.HMSLocalPeer): HMSStore['preview'] {\n    // if room is not in preview, clear preview fields\n    if (!sdkLocalPeer.isInPreview()) {\n      return;\n    }\n\n    const hmsLocalPeer = SDKToHMS.convertPeer(sdkLocalPeer);\n\n    return {\n      localPeer: hmsLocalPeer.id,\n      audioTrack: hmsLocalPeer.audioTrack,\n      videoTrack: hmsLocalPeer.videoTrack,\n      asRole: sdkLocalPeer.asRole?.name || sdkLocalPeer.role?.name,\n    };\n  }\n\n  private async setTrackVolume(value: number, trackId: HMSTrackID) {\n    const track = this.getTrackById(trackId);\n    if (track) {\n      if (track instanceof SDKHMSAudioTrack) {\n        await track.setVolume(value);\n        this.setState(draftStore => {\n          const track = draftStore.tracks[trackId];\n          if (track && track.type === 'audio') {\n            track.volume = value;\n          }\n        }, 'trackVolume');\n      } else {\n        HMSLogger.w(`track ${trackId} is not an audio track`);\n      }\n    } else {\n      this.logPossibleInconsistency(`track ${trackId} not present, unable to set volume`);\n    }\n  }\n\n  /**\n   * Tells if the trackID is for local peer and video unmute is in process\n   * @private\n   */\n  private localAndVideoUnmuting(trackID: string) {\n    const localPeer = this.store.getState(selectLocalPeer);\n    if (localPeer?.videoTrack !== trackID) {\n      return false;\n    }\n    const displayEnabled = this.store.getState(selectIsLocalVideoDisplayEnabled);\n    const actuallyEnabled = this.store.getState(selectIsLocalVideoEnabled);\n    return displayEnabled && !actuallyEnabled;\n  }\n\n  private logPossibleInconsistency(inconsistency: string) {\n    HMSLogger.w('possible inconsistency detected - ', inconsistency);\n  }\n\n  private async addRemoveVideoPlugin(plugin: HMSVideoPlugin, action: 'add' | 'remove', pluginFrameRate?: number) {\n    if (!plugin) {\n      HMSLogger.w('Invalid plugin received in store');\n      return;\n    }\n    const trackID = this.store.getState(selectLocalVideoTrackID);\n    if (trackID) {\n      const sdkTrack = this.getLocalTrack(trackID);\n\n      if (sdkTrack) {\n        if (action === 'add') {\n          await (sdkTrack as SDKHMSLocalVideoTrack).addPlugin(plugin, pluginFrameRate);\n        } else if (action === 'remove') {\n          await (sdkTrack as SDKHMSLocalVideoTrack).removePlugin(plugin);\n        }\n        this.syncRoomState(`${action}VideoPlugin`);\n      } else {\n        this.logPossibleInconsistency(`track ${trackID} not present, unable to ${action} plugin`);\n      }\n    }\n  }\n\n  private async addRemoveMediaStreamVideoPlugins(plugins: HMSMediaStreamPlugin[], action: 'add' | 'remove') {\n    if (plugins.length === 0) {\n      HMSLogger.w('Invalid plugin received in store');\n      return;\n    }\n    const trackID = this.store.getState(selectLocalVideoTrackID);\n    if (trackID) {\n      const sdkTrack = this.getLocalTrack(trackID);\n      if (sdkTrack) {\n        if (action === 'add') {\n          await (sdkTrack as SDKHMSLocalVideoTrack).addStreamPlugins(plugins);\n        } else if (action === 'remove') {\n          await (sdkTrack as SDKHMSLocalVideoTrack).removeStreamPlugins(plugins);\n        }\n        this.syncRoomState(`${action}MediaStreamPlugin`);\n      } else {\n        this.logPossibleInconsistency(`track ${trackID} not present, unable to ${action} plugin`);\n      }\n    }\n  }\n\n  private async addRemoveAudioPlugin(plugin: HMSAudioPlugin, action: 'add' | 'remove') {\n    if (!plugin) {\n      HMSLogger.w('Invalid plugin received in store');\n      return;\n    }\n    const trackID = this.store.getState(selectLocalAudioTrackID);\n    if (trackID) {\n      const sdkTrack = this.getLocalTrack(trackID);\n      if (sdkTrack) {\n        if (action === 'add') {\n          await (sdkTrack as SDKHMSLocalAudioTrack).addPlugin(plugin);\n        } else if (action === 'remove') {\n          await (sdkTrack as SDKHMSLocalAudioTrack).removePlugin(plugin);\n        }\n        this.syncRoomState(`${action}AudioPlugin`);\n      } else {\n        this.logPossibleInconsistency(`track ${trackID} not present, unable to ${action} plugin`);\n      }\n    }\n  }\n\n  /**\n   * convert new role change requests to store format and save.\n   * keep only one request at a time in store till we figure out how to handle multiple requests at the same time\n   */\n  private onRoleChangeRequest(request: SDKHMSRoleChangeRequest) {\n    this.setState(store => {\n      if (store.roleChangeRequests.length === 0) {\n        store.roleChangeRequests.push(SDKToHMS.convertRoleChangeRequest(request));\n      }\n    }, 'roleChangeRequest');\n  }\n\n  private removeRoleChangeRequest(toRemove: HMSRoleChangeRequest) {\n    this.setState(store => {\n      const index = store.roleChangeRequests.findIndex(req => {\n        return req.token === toRemove.token;\n      });\n      if (index !== -1) {\n        store.roleChangeRequests.splice(index, 1);\n      }\n    }, 'removeRoleChangeRequest');\n  }\n\n  private onRoleUpdate() {\n    this.syncRoomState('roleUpdate');\n  }\n\n  private getStoreLocalTrackIDfromSDKTrack(sdkTrack: SDKHMSLocalTrack) {\n    const trackIDs = this.store.getState(selectLocalTrackIDs);\n    return trackIDs.find(trackID => this.getTrackById(trackID)?.trackId === sdkTrack.trackId);\n  }\n\n  private setProgress = ({ type, progress }: sdkTypes.HMSPlaylistProgressEvent) => {\n    this.setState(draftStore => {\n      draftStore.playlist[type].progress = progress;\n      draftStore.playlist[type].currentTime = this.sdk.getPlaylistManager().getCurrentTime(type);\n    }, 'playlistProgress');\n  };\n\n  private syncPlaylistState = (action: string) => {\n    this.setState(draftStore => {\n      Object.assign(draftStore.playlist, SDKToHMS.convertPlaylist(this.sdk.getPlaylistManager()));\n    }, action);\n  };\n\n  // eslint-disable-next-line complexity\n  private sendPeerUpdateNotification = (type: sdkTypes.HMSPeerUpdate, sdkPeer: sdkTypes.HMSPeer) => {\n    let peer = this.store.getState(selectPeerByID(sdkPeer.peerId));\n    const actionName = PEER_NOTIFICATION_TYPES[type] || 'peerUpdate';\n    if (type === sdkTypes.HMSPeerUpdate.ROLE_UPDATED) {\n      this.syncRoomState(actionName);\n      this.updateMidCallPreviewRoomState(type, sdkPeer);\n    } else if ([sdkTypes.HMSPeerUpdate.PEER_JOINED, sdkTypes.HMSPeerUpdate.PEER_LEFT].includes(type)) {\n      this.syncRoomState(actionName);\n      // if peer wasn't available before sync(will happen if event is peer join)\n      if (!peer) {\n        peer = this.store.getState(selectPeerByID(sdkPeer.peerId));\n      }\n    } else if (\n      [\n        sdkTypes.HMSPeerUpdate.HAND_RAISE_CHANGED,\n        sdkTypes.HMSPeerUpdate.PEER_REMOVED,\n        sdkTypes.HMSPeerUpdate.PEER_ADDED,\n      ].includes(type)\n    ) {\n      this.syncRoomState(actionName);\n      if (!peer) {\n        peer = this.store.getState(selectPeerByID(sdkPeer.peerId));\n      }\n    } else {\n      const hmsPeer = SDKToHMS.convertPeer(sdkPeer) as HMSPeer;\n      this.setState(draftStore => {\n        const storePeer = draftStore.peers[hmsPeer.id];\n        if (isEntityUpdated(storePeer, hmsPeer)) {\n          if (areArraysEqual(storePeer.auxiliaryTracks, hmsPeer.auxiliaryTracks)) {\n            storePeer.auxiliaryTracks = hmsPeer.auxiliaryTracks;\n          }\n          Object.assign(storePeer, hmsPeer);\n        }\n        peer = hmsPeer;\n      }, actionName);\n    }\n    this.hmsNotifications.sendPeerUpdate(type, peer);\n  };\n\n  private updateMidCallPreviewRoomState(type: sdkTypes.HMSPeerUpdate, sdkPeer: sdkTypes.HMSPeer) {\n    if (sdkPeer.isLocal && type === sdkTypes.HMSPeerUpdate.ROLE_UPDATED && this.store.getState(selectIsInPreview)) {\n      this.setState(store => {\n        store.room.roomState = HMSRoomState.Connected;\n      }, 'midCallPreviewCompleted');\n    }\n  }\n\n  private setSessionStoreValueLocally(\n    updates: SessionStoreUpdate | SessionStoreUpdate[],\n    actionName = 'setSessionStore',\n  ) {\n    const updatesList: SessionStoreUpdate[] = Array.isArray(updates) ? updates : [updates];\n    this.setState(store => {\n      updatesList.forEach(update => {\n        store.sessionStore[update.key as keyof T['sessionStore']] = update.value;\n      });\n    }, actionName);\n  }\n\n  private getSDKHMSPeer = (peerID: HMSPeerID) => {\n    return this.sdk.getPeerMap()[peerID];\n  };\n\n  /**\n   * setState is separate so any future changes to how state change can be done from one place.\n   * @param fn\n   * @param name\n   */\n  private setState: NamedSetState<HMSStore<T>> = (fn, name) => {\n    return this.store.namedSetState(fn, name);\n  };\n}\n", "import { isBrowser } from '../internal';\n\nexport const storeNameWithTabTitle = (storeName: string) => {\n  return isBrowser ? `${storeName} ${document.title}` : storeName;\n};\n", "import AnalyticsEventFactory from '../analytics/AnalyticsEventFactory';\nimport { EventBus } from '../events/EventBus';\nimport { HMSUpdateListener } from '../interfaces';\nimport { NetworkHealth, ScoreMap } from '../signal/init/models';\nimport HMSLogger from '../utils/logger';\nimport { sleep } from '../utils/timer-utils';\n\nexport class NetworkTestManager {\n  private readonly TAG = '[NetworkTestManager]';\n  private controller = new AbortController();\n  private score?: number;\n  constructor(private eventBus: EventBus, private listener?: HMSUpdateListener) {}\n\n  start = async (networkHealth: NetworkHealth) => {\n    if (!networkHealth) {\n      return;\n    }\n    const { url, timeout, scoreMap } = networkHealth;\n    const signal = this.controller.signal;\n\n    const startTime = Date.now();\n    let downloadedSize = 0;\n    const timeoutPromise = sleep(timeout).then(() => {\n      this.controller.abort();\n    });\n    try {\n      const res = await fetch(`${url}?${Date.now()}`, { signal });\n      const reader = res.body?.getReader();\n      if (!reader) {\n        throw Error('unable to process request');\n      }\n      const readData = async () => {\n        if (!reader) {\n          return;\n        }\n        try {\n          let completed = false;\n          while (!completed) {\n            const { value, done } = await reader.read();\n            completed = done;\n            if (value) {\n              downloadedSize += value.byteLength;\n              this.sendScore({ scoreMap, downloadedSize, startTime });\n            }\n          }\n        } catch (error) {\n          if ((error as Error).name !== 'AbortError') {\n            HMSLogger.d(this.TAG, error);\n          }\n        }\n      };\n\n      return Promise.race([readData(), timeoutPromise])\n        .then(() => {\n          this.sendScore({ scoreMap, downloadedSize, startTime, finished: true });\n        })\n        .catch(error => {\n          HMSLogger.d(this.TAG, error);\n          this.updateScoreToListener(0);\n          this.eventBus.analytics.publish(\n            AnalyticsEventFactory.previewNetworkQuality({ error: (error as Error).message }),\n          );\n        });\n    } catch (error) {\n      if ((error as Error).name !== 'AbortError') {\n        HMSLogger.d(this.TAG, error);\n        this.updateScoreToListener(0);\n        this.eventBus.analytics.publish(\n          AnalyticsEventFactory.previewNetworkQuality({ error: (error as Error).message }),\n        );\n      } else {\n        HMSLogger.d(this.TAG, error);\n      }\n    }\n  };\n\n  stop = () => {\n    if (!this.controller.signal.aborted) {\n      this.controller.abort();\n    }\n  };\n\n  private sendScore = ({\n    scoreMap,\n    downloadedSize,\n    startTime,\n    finished = false,\n  }: {\n    scoreMap: ScoreMap;\n    downloadedSize: number;\n    startTime: number;\n    finished?: boolean;\n  }) => {\n    const totalTimeInSecs = (Date.now() - startTime) / 1000;\n    const sizeInKB = downloadedSize / 1024;\n    const bitrate = (sizeInKB / totalTimeInSecs) * 8;\n    let calculatedScore = -1;\n    for (const score in scoreMap) {\n      const thresholds = scoreMap[score];\n      if (bitrate >= thresholds.low && (!thresholds.high || bitrate <= thresholds.high)) {\n        calculatedScore = Number(score);\n      }\n    }\n    this.updateScoreToListener(calculatedScore);\n    if (finished) {\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.previewNetworkQuality({ score: calculatedScore, downLink: bitrate.toFixed(2) }),\n      );\n    }\n  };\n\n  private updateScoreToListener(newQualityScore: number) {\n    if (newQualityScore === this.score) {\n      return;\n    }\n    this.score = newQualityScore;\n    this.listener?.onNetworkQuality?.(newQualityScore);\n  }\n}\n", "import { Store } from './store';\nimport { DeviceManager } from '../device-manager';\nimport { HMSRole } from '../interfaces';\nimport InitialSettings from '../interfaces/settings';\nimport { SimulcastLayers } from '../interfaces/simulcast-layers';\nimport { HMSPeerUpdate, HMSTrackUpdate, HMSUpdateListener } from '../interfaces/update-listener';\nimport { HMSLocalTrack } from '../media/tracks';\nimport HMSTransport from '../transport';\n\nexport default class RoleChangeManager {\n  constructor(\n    private store: Store,\n    private transport: HMSTransport,\n    private deviceManager: DeviceManager,\n    private publish: (settings: InitialSettings) => Promise<void>,\n    private removeAuxiliaryTrack: (trackId: string) => void,\n    private listener?: HMSUpdateListener,\n  ) {}\n\n  handleLocalPeerRoleUpdate = async ({ oldRole, newRole }: { oldRole: HMSRole; newRole: HMSRole }) => {\n    const localPeer = this.store.getLocalPeer();\n\n    if (!localPeer) {\n      return;\n    }\n\n    await this.diffRolesAndPublishTracks({ oldRole, newRole });\n    this.listener?.onPeerUpdate(HMSPeerUpdate.ROLE_UPDATED, localPeer);\n  };\n\n  diffRolesAndPublishTracks = async ({ oldRole, newRole }: { oldRole: HMSRole; newRole: HMSRole }) => {\n    const wasPublishing = new Set(oldRole.publishParams.allowed);\n    const isPublishing = new Set(newRole.publishParams.allowed);\n\n    const removeVideo = this.removeTrack(wasPublishing, isPublishing, 'video');\n\n    const removeAudio = this.removeTrack(wasPublishing, isPublishing, 'audio');\n    const removeScreen = this.removeTrack(wasPublishing, isPublishing, 'screen');\n\n    const videoHasSimulcastDifference = this.hasSimulcastDifference(\n      oldRole.publishParams.simulcast?.video,\n      newRole.publishParams.simulcast?.video,\n    );\n    const screenHasSimulcastDifference = this.hasSimulcastDifference(\n      oldRole.publishParams.simulcast?.screen,\n      newRole.publishParams.simulcast?.screen,\n    );\n\n    const prevVideoEnabled = this.store.getLocalPeer()?.videoTrack?.enabled;\n\n    await this.removeAudioTrack(removeAudio);\n    await this.removeVideoTracks(removeVideo || videoHasSimulcastDifference);\n    await this.removeScreenTracks(removeScreen || screenHasSimulcastDifference);\n\n    const settings = this.getSettings();\n\n    if (videoHasSimulcastDifference) {\n      settings.isVideoMuted = !prevVideoEnabled;\n    }\n\n    // call publish with new settings, local track manager will diff policies\n    await this.publish(settings);\n    await this.syncDevices(settings, newRole);\n  };\n\n  private async syncDevices(initialSettings: InitialSettings, newRole: HMSRole) {\n    if ((!initialSettings.isAudioMuted || !initialSettings.isVideoMuted) && newRole.publishParams.allowed.length > 0) {\n      await this.deviceManager.init(true);\n    }\n  }\n  private async removeVideoTracks(removeVideo: boolean) {\n    if (!removeVideo) {\n      return;\n    }\n    const localPeer = this.store.getLocalPeer();\n    // TODO check auxillary tracks for regular audio and video too\n    if (localPeer?.videoTrack) {\n      // TODO: stop processed track and cleanup plugins loop non async\n      // vb can throw change role off otherwise\n      if (localPeer.videoTrack.isPublished) {\n        await this.transport.unpublish([localPeer.videoTrack]);\n      } else {\n        await localPeer.videoTrack.cleanup();\n      }\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_REMOVED, localPeer.videoTrack, localPeer);\n      localPeer.videoTrack = undefined;\n    }\n    await this.removeAuxTracks(track => track.source !== 'screen' && track.type === 'video');\n  }\n\n  private async removeAudioTrack(removeAudio: boolean) {\n    if (!removeAudio) {\n      return;\n    }\n    const localPeer = this.store.getLocalPeer();\n    if (localPeer?.audioTrack) {\n      if (localPeer.audioTrack.isPublished) {\n        await this.transport.unpublish([localPeer.audioTrack]);\n      } else {\n        await localPeer.audioTrack.cleanup();\n      }\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_REMOVED, localPeer.audioTrack, localPeer);\n      localPeer.audioTrack = undefined;\n    }\n    await this.removeAuxTracks(track => track.source !== 'screen' && track.type === 'audio');\n  }\n\n  private async removeScreenTracks(removeScreen: boolean) {\n    if (!removeScreen) {\n      return;\n    }\n    await this.removeAuxTracks(track => track.source === 'screen');\n  }\n\n  private async removeAuxTracks(predicate: (track: HMSLocalTrack) => boolean) {\n    const localPeer = this.store.getLocalPeer();\n    if (localPeer?.auxiliaryTracks) {\n      const localAuxTracks = [...localPeer.auxiliaryTracks];\n      for (const track of localAuxTracks) {\n        if (predicate(track)) {\n          await this.removeAuxiliaryTrack(track.trackId);\n        }\n      }\n    }\n  }\n\n  private removeTrack(wasPublishing: Set<string>, isPublishing: Set<string>, type: string) {\n    return wasPublishing.has(type) && !isPublishing.has(type);\n  }\n\n  private hasSimulcastDifference(oldLayers?: SimulcastLayers, newLayers?: SimulcastLayers) {\n    if (!oldLayers && !newLayers) {\n      return false;\n    }\n    if (oldLayers?.layers?.length !== newLayers?.layers?.length) {\n      return true;\n    }\n\n    // return true if anyone layer has different maxBitrate/maxFramerate\n    return !!oldLayers?.layers?.some(layer => {\n      const newLayer = newLayers?.layers?.find(newLayer => newLayer.rid === layer.rid);\n      return newLayer?.maxBitrate !== layer.maxBitrate || newLayer?.maxFramerate !== layer.maxFramerate;\n    });\n  }\n\n  private getSettings(): InitialSettings {\n    const initialSettings = this.store.getConfig()?.settings;\n\n    return {\n      isAudioMuted: initialSettings?.isAudioMuted ?? true,\n      isVideoMuted: initialSettings?.isVideoMuted ?? true,\n      audioInputDeviceId: initialSettings?.audioInputDeviceId || 'default',\n      audioOutputDeviceId: initialSettings?.audioOutputDeviceId || 'default',\n      videoDeviceId: initialSettings?.videoDeviceId || 'default',\n    };\n  }\n}\n", "import AnalyticsEvent from './AnalyticsEvent';\nimport { IAnalyticsTransportProvider } from './IAnalyticsTransportProvider';\nimport {\n  CLIENT_ANAYLTICS_PROD_ENDPOINT,\n  CLIENT_ANAYLTICS_QA_ENDPOINT,\n  CLIENT_ANAYLTICS_STORAGE_LIMIT,\n} from '../utils/constants';\nimport { LocalStorage } from '../utils/local-storage';\nimport HMSLogger from '../utils/logger';\nimport { ENV } from '../utils/support';\n\ninterface ClientEventBody {\n  event: string;\n  event_id: string;\n  peer: {\n    peer_id?: string;\n    role?: string;\n    joined_at?: number;\n    left_at?: number;\n    room_id?: string;\n    room_name?: string;\n    session_started_at?: number;\n    user_data?: string;\n    user_name?: string;\n    template_id?: string;\n    session_id?: string;\n  };\n  timestamp: number;\n  cluster: {\n    websocket_url: string;\n  };\n  payload: Record<string, any>;\n  device_id: string;\n}\n\nclass ClientAnalyticsTransport implements IAnalyticsTransportProvider {\n  readonly TAG = '[HTTPAnalyticsTransport]';\n  private failedEvents = new LocalStorage<AnalyticsEvent[]>('client-events');\n  isConnected = true;\n  private env: null | ENV = null;\n  private websocketURL = '';\n\n  setEnv(env: ENV) {\n    this.env = env;\n    this.flushFailedEvents();\n  }\n\n  setWebsocketEndpoint(ws: string) {\n    this.websocketURL = ws;\n  }\n\n  sendEvent(event: AnalyticsEvent) {\n    if (!this.env) {\n      this.addEventToStorage(event);\n      return;\n    }\n    const requestBody: ClientEventBody = {\n      event: event.name,\n      payload: event.properties,\n      event_id: String(event.timestamp),\n      peer: event.metadata.peer,\n      timestamp: event.timestamp,\n      device_id: event.device_id,\n      cluster: {\n        websocket_url: this.websocketURL,\n      },\n    };\n    const url = this.env === ENV.PROD ? CLIENT_ANAYLTICS_PROD_ENDPOINT : CLIENT_ANAYLTICS_QA_ENDPOINT;\n    fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${event.metadata.token}`,\n        user_agent_v2: event.metadata.userAgent,\n      },\n      body: JSON.stringify(requestBody),\n    })\n      .then(response => {\n        // Ignore invalid token or expired token messages\n        if (response.status === 401) {\n          this.removeFromStorage(event);\n          return;\n        }\n        if (response.status !== 200) {\n          throw Error(response.statusText);\n        }\n        this.removeFromStorage(event);\n      })\n      .catch(error => {\n        HMSLogger.v(this.TAG, 'Failed to send event', error, event);\n        this.addEventToStorage(event);\n      });\n  }\n  flushFailedEvents() {\n    const events = this.failedEvents.get();\n    events?.forEach(event => this.sendEvent(event));\n  }\n\n  private addEventToStorage(event: AnalyticsEvent): void {\n    const existingEvents = this.failedEvents.get() || [];\n    if (!existingEvents.find(existingEvent => existingEvent.timestamp === event.timestamp)) {\n      if (existingEvents.length === CLIENT_ANAYLTICS_STORAGE_LIMIT) {\n        existingEvents.shift();\n      }\n      existingEvents.push(event);\n      this.failedEvents.set(existingEvents);\n    }\n  }\n\n  private removeFromStorage(event: AnalyticsEvent): void {\n    const events = this.failedEvents.get() || [];\n    const index = events.findIndex(storageEvent => storageEvent.timestamp === event.timestamp);\n    if (index > -1) {\n      events.splice(index, 1);\n      this.failedEvents.set(events);\n    }\n  }\n}\n\nexport const HTTPAnalyticsTransport = new ClientAnalyticsTransport();\n", "import { VideoTrackLayerUpdate } from '../connection/channel-messages';\nimport { HMSPeerType } from '../interfaces/peer/hms-peer';\nimport { HMSRole } from '../interfaces/role';\nimport { HMSLocalTrack } from '../media/tracks';\nimport { HMSTrack, HMSTrackSource } from '../media/tracks/HMSTrack';\nimport { PollInfoParams, PollResult, Track } from '../signal/interfaces';\n\n/**\n * Interfaces for message received from BIZ Signal through Websocket.\n * These messages are handled by NotificationManager\n * which will call the corresponding HMSUpdateListener callbacks.\n */\n\nexport interface ServerError {\n  code: number;\n  message?: string;\n}\n\nexport interface TrackStateNotification {\n  tracks: {\n    [track_id: string]: TrackState;\n  };\n  peer: PeerNotificationInfo;\n}\n\nexport interface OnTrackLayerUpdateNotification {\n  tracks: {\n    [track_id: string]: VideoTrackLayerUpdate;\n  };\n}\n\nexport interface PeerNotificationInfo {\n  peer_id: string;\n  role: string;\n  groups: string[];\n  info: Info;\n}\n\nexport interface Info {\n  name: string;\n  data: string;\n  user_id: string;\n  type: HMSPeerType;\n}\n\nexport interface FindPeerByNameInfo {\n  name: string;\n  peer_id: string;\n  role: string;\n  type: HMSPeerType;\n}\n\nexport enum HMSRecordingState {\n  NONE = 'none',\n  INITIALISED = 'initialised',\n  STARTED = 'started',\n  PAUSED = 'paused',\n  RESUMED = 'resumed',\n  STOPPED = 'stopped',\n  FAILED = 'failed',\n}\n\nexport enum HMSStreamingState {\n  NONE = 'none',\n  INITIALISED = 'initialised',\n  STARTED = 'started',\n  STOPPED = 'stopped',\n  FAILED = 'failed',\n}\n\nexport enum HMSTranscriptionState {\n  INITIALISED = 'initialised',\n  STARTED = 'started',\n  STOPPED = 'stopped',\n  FAILED = 'failed',\n}\nexport enum HMSTranscriptionMode {\n  CAPTION = 'caption',\n}\nexport interface WhiteBoardPluginPermissions {\n  permissions?: {\n    // list of roles\n    admin?: Array<string>;\n    writer?: Array<string>;\n    reader?: Array<string>;\n  };\n}\n\nexport interface TranscriptionPluginPermissions {\n  permissions?: {\n    // list of roles\n    admin?: Array<string>;\n  };\n  mode: HMSTranscriptionMode;\n}\n\nexport interface NoiseCancellationPlugin {\n  enabled?: boolean;\n}\nexport enum Plugins {\n  WHITEBOARD = 'whiteboard',\n  TRANSCRIPTIONS = 'transcriptions',\n  NOISE_CANCELLATION = 'noiseCancellation',\n}\n\nexport interface PolicyParams {\n  name: string;\n  known_roles: {\n    [role: string]: HMSRole;\n  };\n  plugins: {\n    [Plugins.WHITEBOARD]?: WhiteBoardPluginPermissions;\n    [Plugins.TRANSCRIPTIONS]?: TranscriptionPluginPermissions[];\n    [Plugins.NOISE_CANCELLATION]?: NoiseCancellationPlugin;\n  };\n  template_id: string;\n  app_data?: Record<string, string>;\n}\n\n/**\n * This is in a format biz sends/received the track metadata\n */\nexport class TrackState implements Track {\n  mute: boolean;\n  type: 'audio' | 'video';\n  source: HMSTrackSource;\n  description: string;\n  track_id: string;\n  stream_id: string;\n\n  constructor(track: HMSLocalTrack | Track) {\n    this.type = track.type;\n    this.source = track.source || 'regular';\n    this.description = '';\n    if (track instanceof HMSTrack) {\n      this.mute = !track.enabled;\n      this.track_id = track.publishedTrackId!;\n      this.stream_id = track.stream.id;\n    } else {\n      this.mute = track.mute;\n      this.track_id = track.track_id;\n      this.stream_id = track.stream_id;\n    }\n  }\n}\n\nexport interface PeerNotification {\n  peer_id: string;\n  info: Info;\n  role: string;\n  joined_at?: number;\n  tracks: {\n    [track_id: string]: TrackState;\n  };\n  groups: string[];\n  realtime?: boolean;\n  is_from_room_state?: boolean;\n}\n\nexport interface TranscriptionNotification {\n  state?: HMSTranscriptionState;\n  mode?: HMSTranscriptionMode;\n  initialised_at?: number;\n  started_at?: number;\n  updated_at?: number;\n  stopped_at?: number;\n  peer?: PeerNotificationInfo;\n  error?: ServerError;\n}\n\nexport interface RoomState {\n  name: string;\n  session_id?: string;\n  started_at?: number;\n  recording?: {\n    sfu: {\n      started_at?: number;\n      enabled: boolean;\n      state?: HMSRecordingState;\n    };\n    browser: {\n      started_at?: number;\n      enabled: boolean;\n      state?: HMSRecordingState;\n    };\n    hls: {\n      initialised_at?: number;\n      started_at?: number;\n      enabled: boolean;\n      state?: HMSRecordingState;\n      config?: {\n        hls_vod: boolean;\n        single_file_per_layer: boolean;\n      };\n    };\n  };\n  streaming?: {\n    enabled: boolean;\n    rtmp: { enabled: boolean; started_at?: number; state?: HMSStreamingState };\n    hls: HLSNotification;\n  };\n  transcriptions?: TranscriptionNotification[];\n}\n\nexport interface PeerListNotification {\n  peers: {\n    [peer_id: string]: PeerNotification;\n  };\n  room: RoomState;\n}\n\nexport interface PeriodicRoomState {\n  peer_count: number;\n  room: RoomState;\n  peers?: {\n    [peer_id: string]: PeerNotification;\n  };\n}\n\ninterface Speaker {\n  peer_id: string;\n  track_id: string;\n  level: number;\n}\n\nexport interface SpeakerList {\n  'speaker-list': Speaker[];\n}\n\ninterface ConnectionQuality {\n  peer_id: string;\n  downlink_score: number;\n}\n\nexport interface ConnectionQualityList {\n  peers: ConnectionQuality[];\n}\n\n/**\n * Represents the role change request received from the server\n */\nexport interface RoleChangeRequestParams {\n  requested_by?: string;\n  role: string;\n  token: string;\n}\n\nexport interface TrackUpdateRequestNotification {\n  requested_by?: string;\n  track_id: string;\n  stream_id: string;\n  mute: boolean;\n}\n\nexport interface ChangeTrackMuteStateNotification {\n  requested_by?: string;\n  roles?: string[];\n  type?: 'audio' | 'video';\n  source?: HMSTrackSource;\n  value: boolean;\n}\n\nexport interface PeerLeaveRequestNotification {\n  requested_by?: string;\n  reason: string;\n  room_end: boolean;\n}\n\nexport interface MessageNotification {\n  peer?: {\n    peer_id: string;\n    groups: string[];\n    role: string;\n    info: {\n      name: string;\n      data: any;\n      user_id: string;\n    };\n  };\n  roles?: string[];\n  message_id: string;\n  private: boolean;\n  timestamp: number;\n  info: MessageNotificationInfo;\n}\n\nexport interface SendMessage {\n  info: MessageNotificationInfo;\n  roles?: string[];\n  peer_id?: string;\n}\n\nexport interface MessageNotificationInfo {\n  message: any;\n  type: string;\n}\nexport enum RecordingNotificationType {\n  SFU = 'sfu',\n  BROWSER = 'Browser',\n  HLS = 'HLS',\n}\nexport interface RecordingNotification {\n  type: RecordingNotificationType;\n  initialised_at?: number; // only used for type hls\n  started_at?: number;\n  peer?: PeerNotificationInfo;\n  error?: ServerError;\n  state?: HMSRecordingState;\n  hls_recording?: HLSRecording; // only used for type hls\n}\n\nexport interface RTMPNotification {\n  peer?: PeerNotificationInfo;\n  error?: ServerError;\n  started_at?: number;\n  state?: HMSStreamingState;\n}\n\nexport interface HLSRecording {\n  hls_vod: boolean;\n  single_file_per_layer: boolean;\n}\n\nexport interface HLSNotification {\n  enabled: boolean;\n  variants?: Array<HLSVariantInfo>;\n  error?: ServerError;\n  hls_recording?: HLSRecording;\n}\n\nexport enum HLSPlaylistType {\n  DVR = 'dvr',\n  NO_DVR = 'no-dvr',\n}\nexport enum HLSStreamType {\n  REGULAR = 'regular',\n  SCREEN = 'screen',\n  COMPOSITE = 'composite',\n}\nexport interface HLSVariantInfo {\n  url: string;\n  meeting_url?: string;\n  playlist_type?: HLSPlaylistType;\n  metadata?: string;\n  started_at?: number;\n  initialised_at?: number;\n  state?: HMSStreamingState;\n  stream_type?: HLSStreamType;\n}\n\nexport interface MetadataChangeNotification {\n  values: {\n    change_version?: number;\n    updated_by?: string;\n    data: any;\n    key: string;\n    updated_at?: number;\n  }[];\n}\n\nexport interface PollStartNotification {\n  polls: PollInfoParams[];\n}\n\nexport type PollStopNotification = PollStartNotification;\n\nexport interface PollStats extends PollResult {\n  poll_id: string;\n}\nexport interface PollStatsNotification {\n  polls: PollStats[];\n}\n\nexport interface RoomInfo {\n  room_id: string;\n  name: string;\n  description: string;\n  max_size: number;\n  large_room_optimization: boolean;\n}\n\nexport interface SessionInfo {\n  session_id: string;\n  room_id: string;\n  peer_count: number;\n  track_count: number;\n}\n\nexport interface WhiteboardInfo {\n  id: string;\n  title?: string;\n  owner?: string;\n  state?: string;\n  attributes?: Array<{ name: string; value: unknown }>;\n}\n\nexport interface NodeInfo {\n  sfu_node_id: string;\n}\n", "import { KnownRoles, TrackStateEntry } from './StoreInterfaces';\nimport { HTTPAnalyticsTransport } from '../../analytics/HTTPAnalyticsTransport';\nimport { DeviceStorageManager } from '../../device-manager/DeviceStorage';\nimport { ErrorFactory } from '../../error/ErrorFactory';\nimport { HMSAction } from '../../error/HMSAction';\nimport {\n  HMSConfig,\n  HMSFrameworkInfo,\n  HMSPermissionType,\n  HMSPoll,\n  HMSSpeaker,\n  HMSTranscriptionMode,\n  HMSWhiteboard,\n} from '../../interfaces';\nimport { SelectedDevices } from '../../interfaces/devices';\nimport { IErrorListener } from '../../interfaces/error-listener';\nimport {\n  HMSSimulcastLayerDefinition,\n  RID,\n  SimulcastLayer,\n  SimulcastLayers,\n  simulcastMapping,\n} from '../../interfaces/simulcast-layers';\nimport {\n  HMSAudioTrack,\n  HMSLocalTrack,\n  HMSRemoteAudioTrack,\n  HMSRemoteVideoTrack,\n  HMSTrack,\n  HMSTrackSource,\n  HMSTrackType,\n  HMSVideoTrack,\n} from '../../media/tracks';\nimport {\n  NoiseCancellationPlugin,\n  Plugins,\n  PolicyParams,\n  TranscriptionPluginPermissions,\n  WhiteBoardPluginPermissions,\n} from '../../notification-manager';\nimport HMSLogger from '../../utils/logger';\nimport { ENV } from '../../utils/support';\nimport { createUserAgent } from '../../utils/user-agent';\nimport HMSRoom from '../models/HMSRoom';\nimport { HMSLocalPeer, HMSPeer, HMSRemotePeer } from '../models/peer';\n\nclass Store {\n  private TAG = '[Store]:';\n  private room?: HMSRoom;\n  private knownRoles: KnownRoles = {};\n  private localPeerId?: string;\n  private peers: Record<string, HMSPeer> = {};\n  private tracks = new Map<HMSTrack, HMSTrack>();\n  private templateAppData?: Record<string, string>;\n  // Not used currently. Will be used exclusively for preview tracks.\n  // private previewTracks: Record<string, HMSTrack> = {};\n  private peerTrackStates: Record<string, TrackStateEntry> = {};\n  private speakers: HMSSpeaker[] = [];\n  private videoLayers?: SimulcastLayers;\n  // private screenshareLayers?: SimulcastLayers;\n  private config?: HMSConfig;\n  private errorListener?: IErrorListener;\n  private roleDetailsArrived = false;\n  private env: ENV = ENV.PROD;\n  private simulcastEnabled = false;\n  private userAgent: string = createUserAgent(this.env);\n  private polls = new Map<string, HMSPoll>();\n  private whiteboards = new Map<string, HMSWhiteboard>();\n\n  getConfig() {\n    return this.config;\n  }\n\n  setSimulcastEnabled(enabled: boolean) {\n    this.simulcastEnabled = enabled;\n  }\n\n  removeRemoteTracks() {\n    this.tracks.forEach(track => {\n      if (track instanceof HMSRemoteAudioTrack || track instanceof HMSRemoteVideoTrack) {\n        this.removeTrack(track);\n        delete this.peerTrackStates[track.trackId];\n      }\n    });\n  }\n\n  getEnv() {\n    return this.env;\n  }\n\n  getPublishParams() {\n    const peer = this.getLocalPeer();\n    const role = peer?.asRole || peer?.role;\n    return role?.publishParams;\n  }\n\n  getRoom() {\n    return this.room;\n  }\n\n  getPolicyForRole(role: string) {\n    return this.knownRoles[role];\n  }\n\n  getKnownRoles() {\n    return this.knownRoles;\n  }\n\n  getTemplateAppData() {\n    return this.templateAppData;\n  }\n\n  getLocalPeer() {\n    if (this.localPeerId && this.peers[this.localPeerId]) {\n      return this.peers[this.localPeerId] as HMSLocalPeer;\n    }\n    return undefined;\n  }\n\n  getRemotePeers() {\n    return Object.values(this.peers).filter(peer => !peer.isLocal) as HMSRemotePeer[];\n  }\n\n  getPeers(): HMSPeer[] {\n    return Object.values(this.peers);\n  }\n\n  getPeerMap() {\n    return this.peers;\n  }\n\n  getPeerById(peerId: string) {\n    if (this.peers[peerId]) {\n      return this.peers[peerId];\n    }\n    return undefined;\n  }\n\n  getTracksMap() {\n    return this.tracks;\n  }\n\n  getTracks() {\n    return Array.from(this.tracks.values());\n  }\n\n  getVideoTracks() {\n    return this.getTracks().filter(track => track.type === HMSTrackType.VIDEO) as HMSVideoTrack[];\n  }\n\n  getRemoteVideoTracks() {\n    return this.getTracks().filter(track => track instanceof HMSRemoteVideoTrack) as HMSRemoteVideoTrack[];\n  }\n\n  getAudioTracks() {\n    return this.getTracks().filter(track => track.type === HMSTrackType.AUDIO) as HMSAudioTrack[];\n  }\n\n  getPeerTracks(peerId?: string) {\n    const peer = peerId ? this.peers[peerId] : undefined;\n    const tracks: HMSTrack[] = [];\n    peer?.videoTrack && tracks.push(peer.videoTrack);\n    peer?.audioTrack && tracks.push(peer.audioTrack);\n    return tracks.concat(peer?.auxiliaryTracks || []);\n  }\n\n  getLocalPeerTracks() {\n    return this.getPeerTracks(this.localPeerId) as HMSLocalTrack[];\n  }\n\n  hasTrack(track: HMSTrack) {\n    return this.tracks.has(track);\n  }\n\n  getTrackById(trackId: string) {\n    const track = Array.from(this.tracks.values()).find(track => track.trackId === trackId);\n    if (track) {\n      return track;\n    }\n    const localPeer = this.getLocalPeer();\n    /**\n     * handle case of audio level coming from server for local peer's track where local peer\n     * didn't initially gave audio permission. So track.firstTrackId is that of dummy track and\n     * this.tracks[trackId] doesn't exist.\n     * Example repro which this solves -\n     * - call preview with audio muted, unmute audio in preview then join the room, now initial\n     * track id is that from dummy track but the track id which server knows will be different\n     */\n    if (localPeer) {\n      if (localPeer.audioTrack?.isPublishedTrackId(trackId)) {\n        return localPeer.audioTrack;\n      } else if (localPeer.videoTrack?.isPublishedTrackId(trackId)) {\n        return localPeer.videoTrack;\n      }\n    }\n    return undefined;\n  }\n\n  getPeerByTrackId(trackId: string) {\n    const track = Array.from(this.tracks.values()).find(track => track.trackId === trackId);\n    return track?.peerId ? this.peers[track.peerId] : undefined;\n  }\n\n  getSpeakers() {\n    return this.speakers;\n  }\n\n  getSpeakerPeers() {\n    return this.speakers.map(speaker => speaker.peer);\n  }\n\n  getUserAgent() {\n    return this.userAgent;\n  }\n\n  createAndSetUserAgent(frameworkInfo?: HMSFrameworkInfo) {\n    this.userAgent = createUserAgent(this.env, frameworkInfo);\n  }\n\n  setRoom(room: HMSRoom) {\n    this.room = room;\n  }\n\n  setKnownRoles(params: PolicyParams) {\n    this.knownRoles = params.known_roles;\n    this.addPluginsToRoles(params.plugins);\n    this.roleDetailsArrived = true;\n    this.templateAppData = params.app_data;\n    if (!this.simulcastEnabled) {\n      return;\n    }\n    const publishParams = this.knownRoles[params.name]?.publishParams;\n    this.videoLayers = this.convertSimulcastLayers(publishParams.simulcast?.video);\n    // this.screenshareLayers = this.convertSimulcastLayers(publishParams.simulcast?.screen);\n    this.updatePeersPolicy();\n  }\n\n  hasRoleDetailsArrived(): boolean {\n    return this.roleDetailsArrived;\n  }\n\n  // eslint-disable-next-line complexity\n  setConfig(config: HMSConfig) {\n    DeviceStorageManager.rememberDevices(Boolean(config.rememberDeviceSelection));\n    if (config.rememberDeviceSelection) {\n      const devices: SelectedDevices | undefined = DeviceStorageManager.getSelection();\n      if (devices) {\n        if (!config.settings) {\n          config.settings = {};\n        }\n        if (devices.audioInput?.deviceId) {\n          config.settings.audioInputDeviceId = config.settings.audioInputDeviceId || devices.audioInput.deviceId;\n        }\n        if (devices.audioOutput?.deviceId) {\n          config.settings.audioOutputDeviceId = config.settings.audioOutputDeviceId || devices.audioOutput.deviceId;\n        }\n        if (devices.videoInput?.deviceId) {\n          config.settings.videoDeviceId = config.settings.videoDeviceId || devices.videoInput.deviceId;\n        }\n      }\n    }\n    config.autoManageVideo = config.autoManageVideo !== false;\n    config.autoManageWakeLock = config.autoManageWakeLock !== false;\n    this.config = config;\n    this.setEnv();\n  }\n\n  addPeer(peer: HMSPeer) {\n    this.peers[peer.peerId] = peer;\n    if (peer.isLocal) {\n      this.localPeerId = peer.peerId;\n    }\n  }\n\n  /**\n   * @param {HMSTrack} track the published track that has to be added\n   *\n   * Note: Only use this method to add published tracks not preview traks\n   */\n  addTrack(track: HMSTrack) {\n    this.tracks.set(track, track);\n  }\n\n  getTrackState(trackId: string) {\n    return this.peerTrackStates[trackId];\n  }\n\n  setTrackState(trackStateEntry: TrackStateEntry) {\n    this.peerTrackStates[trackStateEntry.trackInfo.track_id] = trackStateEntry;\n  }\n\n  removeTrackState(trackId: string) {\n    delete this.peerTrackStates[trackId];\n  }\n\n  removePeer(peerId: string) {\n    if (this.localPeerId === peerId) {\n      this.localPeerId = undefined;\n    }\n    delete this.peers[peerId];\n  }\n\n  removeTrack(track: HMSTrack) {\n    this.tracks.delete(track);\n  }\n\n  updateSpeakers(speakers: HMSSpeaker[]) {\n    this.speakers = speakers;\n  }\n\n  async updateAudioOutputVolume(value: number) {\n    for (const track of this.getAudioTracks()) {\n      await track.setVolume(value);\n    }\n  }\n\n  async updateAudioOutputDevice(device: MediaDeviceInfo) {\n    const promises: Promise<void>[] = [];\n    this.getAudioTracks().forEach(track => {\n      if (track instanceof HMSRemoteAudioTrack) {\n        promises.push(track.setOutputDevice(device));\n      }\n    });\n    await Promise.all(promises);\n  }\n\n  getSimulcastLayers(source: HMSTrackSource): SimulcastLayer[] {\n    // Enable only when backend enables and source is video or screen. ignore videoplaylist\n    if (!this.simulcastEnabled || !['screen', 'regular'].includes(source)) {\n      return [];\n    }\n    if (source === 'screen') {\n      return []; //this.screenshareLayers?.layers || []; uncomment this when screenshare simulcast supported\n    }\n    return this.videoLayers?.layers || [];\n  }\n\n  /**\n   * Convert maxBitrate from kbps to bps\n   * @internal\n   * @param simulcastLayers\n   * @returns {SimulcastLayers}\n   */\n  private convertSimulcastLayers(simulcastLayers?: SimulcastLayers) {\n    if (!simulcastLayers) {\n      return;\n    }\n    return {\n      ...simulcastLayers,\n      layers: (simulcastLayers.layers || []).map(layer => {\n        return {\n          ...layer,\n          maxBitrate: layer.maxBitrate * 1000,\n        };\n      }),\n    };\n  }\n\n  getSimulcastDefinitionsForPeer(peer: HMSPeer, source: HMSTrackSource) {\n    // TODO: remove screen check when screenshare simulcast is supported\n    if ([!peer || !peer.role, source === 'screen', !this.simulcastEnabled].some(value => !!value)) {\n      return [];\n    }\n\n    const publishParams = this.getPolicyForRole(peer.role!.name).publishParams;\n    let simulcastLayers: SimulcastLayers | undefined;\n    let width: number;\n    let height: number;\n    if (source === 'regular') {\n      simulcastLayers = publishParams.simulcast?.video;\n      width = publishParams.video.width;\n      height = publishParams.video.height;\n    } else if (source === 'screen') {\n      simulcastLayers = publishParams.simulcast?.screen;\n      width = publishParams.screen.width;\n      height = publishParams.screen.height;\n    }\n    return (\n      simulcastLayers?.layers?.map(value => {\n        const layer = simulcastMapping[value.rid as RID];\n        const resolution = {\n          width: Math.floor(width / value.scaleResolutionDownBy),\n          height: Math.floor(height / value.scaleResolutionDownBy),\n        };\n        return {\n          layer,\n          resolution,\n        } as HMSSimulcastLayerDefinition;\n      }) || []\n    );\n  }\n\n  setPoll(poll: HMSPoll) {\n    this.polls.set(poll.id, poll);\n  }\n\n  getPoll(id: string): HMSPoll | undefined {\n    return this.polls.get(id);\n  }\n\n  setWhiteboard(whiteboard: HMSWhiteboard) {\n    this.whiteboards.set(whiteboard.id, whiteboard);\n  }\n\n  getWhiteboards() {\n    return this.whiteboards;\n  }\n\n  getWhiteboard(id?: string): HMSWhiteboard | undefined {\n    return id ? this.whiteboards.get(id) : this.whiteboards.values().next().value;\n  }\n\n  getErrorListener() {\n    return this.errorListener;\n  }\n\n  cleanup() {\n    const tracks = this.getTracks();\n    for (const track of tracks) {\n      track.cleanup();\n    }\n    this.room = undefined;\n    this.config = undefined;\n    this.localPeerId = undefined;\n    this.roleDetailsArrived = false;\n  }\n\n  setErrorListener(listener: IErrorListener) {\n    this.errorListener = listener;\n  }\n\n  private updatePeersPolicy() {\n    this.getPeers().forEach(peer => {\n      if (!peer.role) {\n        this.errorListener?.onError(ErrorFactory.GenericErrors.InvalidRole(HMSAction.VALIDATION, ''));\n        return;\n      }\n      peer.role = this.getPolicyForRole(peer.role.name);\n    });\n  }\n  private addPluginsToRoles(plugins: PolicyParams['plugins']) {\n    if (!plugins) {\n      return;\n    }\n\n    Object.keys(plugins).forEach(plugin => {\n      const pluginName = plugin as keyof PolicyParams['plugins'];\n      switch (pluginName) {\n        case Plugins.WHITEBOARD: {\n          this.addWhiteboardPluginToRole(plugins[pluginName]);\n          break;\n        }\n        case Plugins.TRANSCRIPTIONS: {\n          this.addTranscriptionsPluginToRole(plugins[pluginName]);\n          break;\n        }\n        case Plugins.NOISE_CANCELLATION: {\n          this.handleNoiseCancellationPlugin(plugins[pluginName]);\n          break;\n        }\n        default: {\n          break;\n        }\n      }\n    });\n  }\n  private addPermissionToRole = (\n    role: string,\n    pluginName: keyof PolicyParams['plugins'],\n    permission: HMSPermissionType,\n    mode?: HMSTranscriptionMode,\n  ) => {\n    if (!this.knownRoles[role]) {\n      HMSLogger.d(this.TAG, `role ${role} is not present in given roles`, this.knownRoles);\n      return;\n    }\n    const rolePermissions = this.knownRoles[role].permissions;\n    if (pluginName === Plugins.TRANSCRIPTIONS && mode) {\n      // currently only admin is allowed, so no issue\n      rolePermissions[pluginName] = {\n        ...rolePermissions[pluginName],\n        [mode]: [permission],\n      };\n    } else if (pluginName === Plugins.WHITEBOARD) {\n      if (!rolePermissions[pluginName]) {\n        rolePermissions[pluginName] = [];\n      }\n      rolePermissions[pluginName]?.push(permission);\n    }\n  };\n  private addWhiteboardPluginToRole = (plugin?: WhiteBoardPluginPermissions) => {\n    const permissions = plugin?.permissions;\n    permissions?.admin?.forEach(role => this.addPermissionToRole(role, Plugins.WHITEBOARD, 'admin'));\n    permissions?.reader?.forEach(role => this.addPermissionToRole(role, Plugins.WHITEBOARD, 'read'));\n    permissions?.writer?.forEach(role => this.addPermissionToRole(role, Plugins.WHITEBOARD, 'write'));\n  };\n  private addTranscriptionsPluginToRole = (plugin: TranscriptionPluginPermissions[] = []) => {\n    for (const transcription of plugin) {\n      transcription.permissions?.admin?.forEach(role =>\n        this.addPermissionToRole(role, Plugins.TRANSCRIPTIONS, 'admin', transcription.mode),\n      );\n    }\n  };\n  private handleNoiseCancellationPlugin = (plugin?: NoiseCancellationPlugin) => {\n    if (!this.room) {\n      return;\n    }\n    // it will be called again after internalConnect room initialization, even after network disconnection\n    this.room.isNoiseCancellationEnabled = !!plugin?.enabled && !!this.room.isNoiseCancellationEnabled;\n  };\n\n  private setEnv() {\n    const endPoint = this.config?.initEndpoint!;\n    const url = endPoint.split('https://')[1];\n    let env: ENV = ENV.PROD;\n    if (url.startsWith(ENV.PROD)) {\n      env = ENV.PROD;\n    } else if (url.startsWith(ENV.QA)) {\n      env = ENV.QA;\n    } else if (url.startsWith(ENV.DEV)) {\n      env = ENV.DEV;\n    }\n    this.env = env;\n    HTTPAnalyticsTransport.setEnv(env);\n  }\n}\n\nexport { Store };\n", "import HMSLogger from '../utils/logger';\n\nexport class WakeLockManager {\n  private readonly TAG = '[WakeLockManager]';\n  private wakeLock: WakeLockSentinel | null = null;\n\n  acquireLock = async () => {\n    await this.requestWakeLock();\n    document?.addEventListener('visibilitychange', this.visibilityHandler);\n  };\n\n  cleanup = async () => {\n    if (this.wakeLock && !this.wakeLock.released) {\n      try {\n        await this.wakeLock.release();\n        HMSLogger.d(this.TAG, 'Wake lock released');\n      } catch (err) {\n        const error = err as Error;\n        HMSLogger.w(this.TAG, 'Error while releasing wake lock', `name=${error.name}, message=${error.message}`);\n      }\n    }\n    document?.removeEventListener('visibilitychange', this.visibilityHandler);\n    this.wakeLock = null;\n  };\n\n  private visibilityHandler = async () => {\n    if (document?.visibilityState === 'visible' && (!this.wakeLock || this.wakeLock.released)) {\n      HMSLogger.d(this.TAG, 'Re-acquiring wake lock due to visibility change');\n      await this.requestWakeLock();\n    }\n  };\n\n  // Function that attempts to request a screen wake lock.\n  private requestWakeLock = async () => {\n    try {\n      if (!('wakeLock' in navigator)) {\n        HMSLogger.d(this.TAG, 'Wake lock feature not supported');\n        return;\n      }\n      this.wakeLock = await navigator.wakeLock.request('screen');\n      HMSLogger.d(this.TAG, 'Wake lock acquired');\n    } catch (err) {\n      const error = err as Error;\n      HMSLogger.w(this.TAG, 'Error acquiring wake lock', `name=${error.name}, message=${error.message}`);\n    }\n  };\n}\n", "import AnalyticsEvent from './AnalyticsEvent';\nimport { HMSAnalyticsLevel } from './AnalyticsEventLevel';\nimport { AnalyticsTransport } from './AnalyticsTransport';\nimport { HTTPAnalyticsTransport } from './HTTPAnalyticsTransport';\nimport { Store } from '../sdk/store';\nimport { ANALYTICS_BUFFER_SIZE } from '../utils/constants';\nimport HMSLogger from '../utils/logger';\n\nexport class AnalyticsEventsService {\n  private bufferSize = ANALYTICS_BUFFER_SIZE;\n  private readonly TAG = '[AnalyticsEventsService]';\n\n  private transport: AnalyticsTransport | null = null;\n  private pendingEvents: AnalyticsEvent[] = [];\n\n  level: HMSAnalyticsLevel = HMSAnalyticsLevel.INFO;\n\n  constructor(private store: Store) {}\n\n  setTransport(transport: AnalyticsTransport) {\n    this.transport = transport;\n  }\n\n  reset() {\n    this.transport = null;\n    this.pendingEvents = [];\n  }\n\n  queue(event: AnalyticsEvent) {\n    if (event.level >= this.level) {\n      this.pendingEvents.push(event);\n\n      if (this.pendingEvents.length > this.bufferSize) {\n        const removedEvent = this.pendingEvents.shift();\n        HMSLogger.d(this.TAG, 'Max buffer size reached', 'Removed event to accommodate new events', removedEvent);\n      }\n    }\n    return this;\n  }\n\n  flushFailedClientEvents() {\n    HTTPAnalyticsTransport.flushFailedEvents();\n  }\n\n  flush() {\n    try {\n      while (this.pendingEvents.length > 0) {\n        const event = this.pendingEvents.shift();\n        if (event) {\n          event.metadata.peer.peer_id = this.store.getLocalPeer()?.peerId;\n          event.metadata.userAgent = this.store.getUserAgent();\n          if (this.transport && this.transport.transportProvider.isConnected) {\n            this.transport.sendEvent(event);\n          } else {\n            this.sendClientEventOnHTTP(event);\n          }\n        }\n      }\n    } catch (error) {\n      HMSLogger.w(this.TAG, 'Flush Failed', error);\n    }\n  }\n\n  private sendClientEventOnHTTP(event: AnalyticsEvent) {\n    const room = this.store.getRoom();\n    const localPeer = this.store.getLocalPeer();\n    event.metadata.token = this.store.getConfig()?.authToken;\n    event.metadata.peer = {\n      session_id: room?.sessionId,\n      room_id: room?.id,\n      room_name: room?.name,\n      template_id: room?.templateId,\n      joined_at: room?.joinedAt?.getTime(),\n      session_started_at: room?.startedAt?.getTime(),\n      role: localPeer?.role?.name,\n      user_name: localPeer?.name,\n      user_data: localPeer?.metadata,\n      peer_id: localPeer?.peerId,\n    };\n    HTTPAnalyticsTransport.sendEvent(event);\n  }\n}\n", "import { v4 as uuid } from 'uuid';\nimport AnalyticsEventFactory from '../analytics/AnalyticsEventFactory';\nimport { DeviceManager } from '../device-manager';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { EventBus } from '../events/EventBus';\nimport { HMSDeviceChangeEvent, HMSTrackUpdate, HMSUpdateListener } from '../interfaces';\nimport { HMSRemoteAudioTrack } from '../media/tracks';\nimport { HMSRemotePeer } from '../sdk/models/peer';\nimport { Store } from '../sdk/store';\nimport HMSLogger from '../utils/logger';\nimport { sleep } from '../utils/timer-utils';\n\n/**\n * Following are the errors thrown when autoplay is blocked in different browsers\n * Firefox - DOMException: The play method is not allowed by the user agent or the platform in the current context, possibly because the user denied permission.\n * Safari - NotAllowedError: The request is not allowed by the user agent or the platform in the current context, possibly because the user denied permission.\n * Chrome - DOMException: play() failed because the user didn't interact with the document first.\n * Brave - DOMException: play() can only be initiated by a user gesture.\n */\ntype AudioSinkState = {\n  autoplayFailed?: boolean;\n  initialized: boolean;\n  // this promise will be set for the first track. remaining tracks will be processed once it's know whether\n  // autoplay is allowed or not\n  autoplayCheckPromise?: Promise<void>;\n};\n\nconst INITIAL_STATE: AudioSinkState = {\n  autoplayFailed: undefined,\n  initialized: false,\n  autoplayCheckPromise: undefined,\n};\n\nexport class AudioSinkManager {\n  private audioSink?: HTMLElement;\n  private autoPausedTracks: Set<HMSRemoteAudioTrack> = new Set();\n  private readonly TAG = '[AudioSinkManager]:';\n  private volume = 100;\n  private state = { ...INITIAL_STATE };\n  private listener?: HMSUpdateListener;\n\n  constructor(private store: Store, private deviceManager: DeviceManager, private eventBus: EventBus) {\n    this.eventBus.audioTrackAdded.subscribe(this.handleTrackAdd);\n    this.eventBus.audioTrackRemoved.subscribe(this.handleTrackRemove);\n    this.eventBus.audioTrackUpdate.subscribe(this.handleTrackUpdate);\n    this.eventBus.deviceChange.subscribe(this.handleAudioDeviceChange);\n    this.eventBus.localVideoUnmutedNatively.subscribe(this.unpauseAudioTracks);\n  }\n\n  setListener(listener?: HMSUpdateListener) {\n    this.listener = listener;\n  }\n\n  private get outputDevice() {\n    return this.deviceManager.outputDevice;\n  }\n\n  getVolume() {\n    return this.volume;\n  }\n\n  async setVolume(value: number) {\n    await this.store.updateAudioOutputVolume(value);\n    this.volume = value;\n  }\n\n  /**\n   *  This function is to be called only on user interaction when\n   *  autoplay error is received.\n   */\n  async unblockAutoplay() {\n    if (this.autoPausedTracks.size > 0) {\n      this.unpauseAudioTracks();\n    }\n  }\n\n  init(elementId?: string) {\n    if (this.state.initialized || this.audioSink) {\n      return;\n    }\n    this.state.initialized = true;\n    const audioSink = document.createElement('div');\n    audioSink.id = `HMS-SDK-audio-sink-${uuid()}`;\n    const userElement = elementId && document.getElementById(elementId);\n    const audioSinkParent = userElement || document.body;\n    audioSinkParent.append(audioSink);\n\n    this.audioSink = audioSink;\n    HMSLogger.d(this.TAG, 'audio sink created', this.audioSink);\n  }\n\n  cleanup() {\n    this.audioSink?.remove();\n    this.audioSink = undefined;\n    this.eventBus.audioTrackAdded.unsubscribe(this.handleTrackAdd);\n    this.eventBus.audioTrackRemoved.unsubscribe(this.handleTrackRemove);\n    this.eventBus.audioTrackUpdate.unsubscribe(this.handleTrackUpdate);\n    this.eventBus.deviceChange.unsubscribe(this.handleAudioDeviceChange);\n    this.eventBus.localVideoUnmutedNatively.unsubscribe(this.unpauseAudioTracks);\n    this.autoPausedTracks = new Set();\n    this.state = { ...INITIAL_STATE };\n  }\n\n  private handleAudioPaused = async (event: any) => {\n    // this means the audio paused because of external factors(headset removal, incoming phone call)\n    HMSLogger.d(this.TAG, 'Audio Paused', event.target.id);\n    const audioTrack = this.store.getTrackById(event.target.id);\n    if (audioTrack) {\n      this.autoPausedTracks.add(audioTrack as HMSRemoteAudioTrack);\n    }\n  };\n\n  private handleTrackUpdate = ({ track }: { track: HMSRemoteAudioTrack; enabled: boolean }) => {\n    HMSLogger.d(this.TAG, 'Track updated', `${track}`);\n  };\n\n  private handleTrackAdd = async ({\n    track,\n    peer,\n    callListener = true,\n  }: {\n    track: HMSRemoteAudioTrack;\n    peer: HMSRemotePeer;\n    callListener?: boolean;\n  }) => {\n    const audioEl = document.createElement('audio');\n    audioEl.style.display = 'none';\n    audioEl.id = track.trackId;\n    audioEl.addEventListener('pause', this.handleAudioPaused);\n\n    audioEl.onerror = async () => {\n      HMSLogger.e(this.TAG, 'error on audio element', audioEl.error);\n      const ex = ErrorFactory.TracksErrors.AudioPlaybackError(\n        `Audio playback error for track - ${track.trackId} code - ${audioEl?.error?.code}`,\n      );\n      this.eventBus.analytics.publish(AnalyticsEventFactory.audioPlaybackError(ex));\n      if (audioEl?.error?.code === MediaError.MEDIA_ERR_DECODE) {\n        this.removeAudioElement(audioEl, track);\n        await sleep(500);\n        await this.handleTrackAdd({ track, peer, callListener: false });\n      }\n    };\n    track.setAudioElement(audioEl);\n    track.setVolume(this.volume);\n    HMSLogger.d(this.TAG, 'Audio track added', `${track}`);\n    this.init(); // call to create sink element if not already created\n    this.audioSink?.append(audioEl);\n    this.outputDevice && (await track.setOutputDevice(this.outputDevice));\n    audioEl.srcObject = new MediaStream([track.nativeTrack]);\n    callListener && this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_ADDED, track, peer);\n    await this.handleAutoplayError(track);\n  };\n\n  private handleAutoplayError = async (track: HMSRemoteAudioTrack) => {\n    /**\n     * if it's not known whether autoplay will succeed, wait for it to be known\n     */\n    if (this.state.autoplayFailed === undefined) {\n      if (!this.state.autoplayCheckPromise) {\n        // it's the first track, try to play it, that'll tell us whether autoplay is allowed\n        this.state.autoplayCheckPromise = new Promise<void>(resolve => {\n          this.playAudioFor(track).then(resolve);\n        });\n      }\n      // and wait for the result to be known\n      await this.state.autoplayCheckPromise;\n    }\n    /**\n     * Don't play the track if autoplay failed, add to paused list\n     */\n    if (this.state.autoplayFailed) {\n      this.autoPausedTracks.add(track);\n      return;\n    }\n    await this.playAudioFor(track);\n  };\n\n  private handleAudioDeviceChange = (event: HMSDeviceChangeEvent) => {\n    // if there is no selection that means this is an init request. No need to do anything\n    if (event.isUserSelection || event.error || !event.selection || event.type === 'video') {\n      return;\n    }\n    this.unpauseAudioTracks();\n  };\n\n  /**\n   * try to play audio for the passed in track, assume autoplay error happened if play fails\n   * @param track\n   * @private\n   */\n  private async playAudioFor(track: HMSRemoteAudioTrack) {\n    const audioEl = track.getAudioElement();\n    if (!audioEl) {\n      HMSLogger.w(this.TAG, 'No audio element found on track', track.trackId);\n      return;\n    }\n    try {\n      await audioEl.play();\n      this.state.autoplayFailed = false;\n      this.autoPausedTracks.delete(track);\n      HMSLogger.d(this.TAG, 'Played track', `${track}`);\n    } catch (err) {\n      this.autoPausedTracks.add(track);\n      HMSLogger.w(this.TAG, 'Failed to play track', `${track}`, err as Error);\n      const error = err as Error;\n      if (!this.state.autoplayFailed && error.name === 'NotAllowedError') {\n        this.state.autoplayFailed = true;\n        const ex = ErrorFactory.TracksErrors.AutoplayBlocked(HMSAction.AUTOPLAY, '');\n        ex.addNativeError(error);\n        this.eventBus.analytics.publish(AnalyticsEventFactory.autoplayError());\n        this.eventBus.autoplayError.publish(ex);\n      }\n    }\n  }\n\n  private handleTrackRemove = (track: HMSRemoteAudioTrack) => {\n    this.autoPausedTracks.delete(track);\n    const audioEl = document.getElementById(track.trackId) as HTMLAudioElement;\n    if (audioEl) {\n      this.removeAudioElement(audioEl, track);\n    }\n    // Reset autoplay error thrown because if all tracks are removed and a new track is added\n    // Autoplay error is thrown in safari\n    if (this.audioSink && this.audioSink.childElementCount === 0) {\n      this.state.autoplayCheckPromise = undefined;\n      this.state.autoplayFailed = undefined;\n    }\n    HMSLogger.d(this.TAG, 'Audio track removed', `${track}`);\n  };\n\n  private unpauseAudioTracks = async () => {\n    const promises: Promise<void>[] = [];\n    this.autoPausedTracks.forEach(track => {\n      promises.push(this.playAudioFor(track));\n    });\n    // Return after all pending tracks are played\n    await Promise.all(promises);\n  };\n\n  private removeAudioElement = (audioEl: HTMLAudioElement, track: HMSRemoteAudioTrack) => {\n    if (audioEl) {\n      HMSLogger.d(this.TAG, 'removing audio element', `${track}`);\n      audioEl.removeEventListener('pause', this.handleAudioPaused);\n      audioEl.srcObject = null;\n      audioEl.remove();\n      track.setAudioElement(null);\n    }\n  };\n}\n", "import AnalyticsEvent from '../analytics/AnalyticsEvent';\nimport { EventBus } from '../events/EventBus';\n\nexport class PluginUsageTracker {\n  private pluginUsage: Map<string, number> = new Map<string, number>();\n  private pluginLastAddedAt: Map<string, number> = new Map<string, number>();\n\n  constructor(private eventBus: EventBus) {\n    this.eventBus.analytics.subscribe(e => this.updatePluginUsageData(e));\n  }\n\n  getPluginUsage = (name: string) => {\n    if (!this.pluginUsage.has(name)) {\n      this.pluginUsage.set(name, 0);\n    }\n    if (this.pluginLastAddedAt.has(name)) {\n      const lastAddedAt = this.pluginLastAddedAt.get(name) || 0;\n      const extraDuration = lastAddedAt ? Date.now() - lastAddedAt : 0;\n      this.pluginUsage.set(name, (this.pluginUsage.get(name) || 0) + extraDuration);\n      this.pluginLastAddedAt.delete(name);\n    }\n    const finalValue = this.pluginUsage.get(name);\n    return finalValue;\n  };\n\n  // eslint-disable-next-line complexity\n  updatePluginUsageData = (event: AnalyticsEvent) => {\n    const name = event.properties?.plugin_name || '';\n    switch (event.name) {\n      case 'mediaPlugin.toggled.on':\n      case 'mediaPlugin.added': {\n        const addedAt = event.properties.added_at || Date.now();\n        this.pluginLastAddedAt.set(name, addedAt);\n        break;\n      }\n      case 'mediaPlugin.toggled.off':\n      case 'mediaPlugin.stats': {\n        if (this.pluginLastAddedAt.has(name)) {\n          const duration = event.properties.duration || (Date.now() - (this.pluginLastAddedAt.get(name) || 0)) / 1000;\n          this.pluginUsage.set(name, (this.pluginUsage.get(name) || 0) + Math.max(duration, 0) * 1000);\n          this.pluginLastAddedAt.delete(name);\n        }\n        break;\n      }\n      default:\n    }\n  };\n\n  cleanup = () => {\n    this.pluginLastAddedAt.clear();\n    this.pluginUsage.clear();\n  };\n}\n", "import { DeviceStorageManager } from './DeviceStorage';\nimport AnalyticsEventFactory from '../analytics/AnalyticsEventFactory';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSException } from '../error/HMSException';\nimport { EventBus } from '../events/EventBus';\nimport { DeviceMap, HMSDeviceChangeEvent, SelectedDevices } from '../interfaces';\nimport { isIOS } from '../internal';\nimport { HMSAudioTrackSettingsBuilder, HMSVideoTrackSettingsBuilder } from '../media/settings';\nimport { HMSLocalAudioTrack, HMSLocalTrack, HMSLocalVideoTrack } from '../media/tracks';\nimport { Store } from '../sdk/store';\nimport HMSLogger from '../utils/logger';\nimport { debounce } from '../utils/timer-utils';\n\ntype DeviceAndGroup = Partial<MediaTrackSettings>;\n\ninterface HMSDeviceManager extends DeviceMap {\n  outputDevice?: MediaDeviceInfo;\n  hasWebcamPermission: boolean;\n  hasMicrophonePermission: boolean;\n}\n\nexport class DeviceManager implements HMSDeviceManager {\n  audioInput: InputDeviceInfo[] = [];\n  audioOutput: MediaDeviceInfo[] = [];\n  videoInput: InputDeviceInfo[] = [];\n  outputDevice?: MediaDeviceInfo;\n  // true if user has allowed the permission\n  // false if user has denied the permission or prompt was never shown or ignored\n  // or if the camera/mic is not available in the device\n  hasWebcamPermission = false;\n  hasMicrophonePermission = false;\n\n  private readonly TAG = '[Device Manager]:';\n  private initialized = false;\n  private videoInputChanged = false;\n  private audioInputChanged = false;\n  private earpieceSelected = false;\n  private timer: ReturnType<typeof setTimeout> | null = null;\n\n  constructor(private store: Store, private eventBus: EventBus) {\n    const isLocalTrackEnabled = ({ enabled, track }: { enabled: boolean; track: HMSLocalTrack }) =>\n      enabled && track.source === 'regular';\n    this.eventBus.localVideoEnabled.waitFor(isLocalTrackEnabled).then(async () => {\n      await this.enumerateDevices();\n      if (this.videoInputChanged) {\n        this.eventBus.deviceChange.publish({ devices: this.getDevices() } as HMSDeviceChangeEvent);\n      }\n    });\n    this.eventBus.localAudioEnabled.waitFor(isLocalTrackEnabled).then(async () => {\n      await this.enumerateDevices();\n      if (this.audioInputChanged) {\n        this.eventBus.deviceChange.publish({ devices: this.getDevices() } as HMSDeviceChangeEvent);\n      }\n    });\n\n    this.eventBus.deviceChange.subscribe(({ type, isUserSelection, selection }) => {\n      if (isUserSelection) {\n        const inputType = type === 'video' ? 'videoInput' : type;\n        const newSelection = this[inputType].find(\n          device => this.createIdentifier(device) === this.createIdentifier(selection),\n        );\n        this.eventBus.analytics.publish(\n          AnalyticsEventFactory.deviceChange({\n            selection: { [inputType]: newSelection },\n            devices: this.getDevices(),\n            type,\n            isUserSelection,\n          }),\n        );\n      }\n    });\n  }\n\n  updateOutputDevice = async (deviceId?: string, isUserSelection?: boolean) => {\n    const newDevice = this.audioOutput.find(device => device.deviceId === deviceId);\n    if (newDevice) {\n      this.outputDevice = newDevice;\n      await this.store.updateAudioOutputDevice(newDevice);\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.deviceChange({\n          isUserSelection,\n          selection: { audioOutput: newDevice },\n          devices: this.getDevices(),\n          type: 'audioOutput',\n        }),\n      );\n      DeviceStorageManager.updateSelection('audioOutput', { deviceId: newDevice.deviceId, groupId: newDevice.groupId });\n    }\n    return newDevice;\n  };\n\n  async init(force = false, logAnalytics = true) {\n    if (this.initialized && !force) {\n      return;\n    }\n    !this.initialized && navigator.mediaDevices.addEventListener('devicechange', this.handleDeviceChange);\n    this.initialized = true;\n    await this.enumerateDevices();\n    // do it only on initial load.\n    if (!force) {\n      await this.updateToActualDefaultDevice();\n      await this.autoSelectAudioOutput();\n      this.startPollingForDevices();\n    }\n    this.logDevices('Init');\n    await this.setOutputDevice();\n    this.eventBus.deviceChange.publish({\n      devices: this.getDevices(),\n    } as HMSDeviceChangeEvent);\n    if (logAnalytics) {\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.deviceChange({\n          selection: this.getCurrentSelection(),\n          type: 'list',\n          devices: this.getDevices(),\n        }),\n      );\n    }\n  }\n\n  getDevices(): DeviceMap {\n    return {\n      audioInput: this.audioInput,\n      audioOutput: this.audioOutput,\n      videoInput: this.videoInput,\n    };\n  }\n\n  cleanup() {\n    this.initialized = false;\n    this.earpieceSelected = false;\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n    this.audioInput = [];\n    this.audioOutput = [];\n    this.videoInput = [];\n    this.outputDevice = undefined;\n    navigator.mediaDevices.removeEventListener('devicechange', this.handleDeviceChange);\n  }\n\n  getCurrentSelection = (): SelectedDevices => {\n    const localPeer = this.store.getLocalPeer();\n    const audioDevice = this.createIdentifier(localPeer?.audioTrack?.getMediaTrackSettings());\n    const videoDevice = this.createIdentifier(localPeer?.videoTrack?.getMediaTrackSettings());\n    const audioSelection = this.audioInput.find(device => {\n      const id = this.createIdentifier(device);\n      return id === audioDevice;\n    });\n    const videoSelection = this.videoInput.find(device => this.createIdentifier(device) === videoDevice);\n    return {\n      audioInput: audioSelection,\n      videoInput: videoSelection,\n      audioOutput: this.outputDevice,\n    };\n  };\n\n  private createIdentifier(deviceInfo?: DeviceAndGroup) {\n    if (!deviceInfo) {\n      return '';\n    }\n    return `${deviceInfo.deviceId}${deviceInfo.groupId}`;\n  }\n\n  private computeChange = (prevDevices: string[], currentDevices: MediaDeviceInfo[]) => {\n    if (prevDevices.length !== currentDevices.length) {\n      return true;\n    }\n    return currentDevices.some(device => !prevDevices.includes(this.createIdentifier(device)));\n  };\n\n  private enumerateDevices = async () => {\n    try {\n      const devices = await navigator.mediaDevices.enumerateDevices();\n      const prevVideoInput = this.videoInput.map(this.createIdentifier);\n      const prevAudioInput = this.audioInput.map(this.createIdentifier);\n      this.audioInput = [];\n      this.audioOutput = [];\n      this.videoInput = [];\n      devices.forEach(device => {\n        if (device.kind === 'audioinput' && device.label) {\n          this.hasMicrophonePermission = true;\n          this.audioInput.push(device as InputDeviceInfo);\n        } else if (device.kind === 'audiooutput') {\n          this.audioOutput.push(device);\n        } else if (device.kind === 'videoinput' && device.label) {\n          this.hasWebcamPermission = true;\n          this.videoInput.push(device as InputDeviceInfo);\n        }\n      });\n      this.videoInputChanged = this.computeChange(prevVideoInput, this.videoInput);\n      this.audioInputChanged = this.computeChange(prevAudioInput, this.audioInput);\n      DeviceStorageManager.setDevices({\n        videoInput: [...this.videoInput],\n        audioInput: [...this.audioInput],\n        audioOutput: [...this.audioOutput],\n      });\n      this.logDevices('Enumerate Devices');\n    } catch (error) {\n      HMSLogger.e(this.TAG, 'Failed enumerating devices', error);\n    }\n  };\n\n  /**\n   * For example, if a different device, say OBS is selected as default from chrome settings, when you do getUserMedia with default, that is not the device\n   * you get. So update to the browser settings default device\n   * Update only when initial deviceId is not passed\n   */\n  private updateToActualDefaultDevice = async () => {\n    const localPeer = this.store.getLocalPeer();\n    const videoDeviceId = this.store.getConfig()?.settings?.videoDeviceId;\n    if (!videoDeviceId && localPeer?.videoTrack) {\n      await localPeer.videoTrack.setSettings({ deviceId: this.videoInput[0]?.deviceId }, true);\n    }\n    const audioDeviceId = this.store.getConfig()?.settings?.audioInputDeviceId;\n    if (!audioDeviceId && localPeer?.audioTrack) {\n      const getInitialDeviceId = () => {\n        const nonIPhoneDevice = this.audioInput.find(device => !device.label.toLowerCase().includes('iphone'));\n        return isIOS() && nonIPhoneDevice ? nonIPhoneDevice?.deviceId : this.getNewAudioInputDevice()?.deviceId;\n      };\n      const deviceIdToUpdate = getInitialDeviceId();\n      if (deviceIdToUpdate) {\n        await localPeer.audioTrack.setSettings({ deviceId: getInitialDeviceId() }, true);\n      }\n    }\n  };\n\n  private handleDeviceChange = debounce(async () => {\n    await this.enumerateDevices();\n    this.logDevices('After Device Change');\n    const localPeer = this.store.getLocalPeer();\n    await this.setOutputDevice(true);\n    await this.handleAudioInputDeviceChange(localPeer?.audioTrack);\n    await this.handleVideoInputDeviceChange(localPeer?.videoTrack);\n    this.eventBus.analytics.publish(\n      AnalyticsEventFactory.deviceChange({\n        selection: this.getCurrentSelection(),\n        type: 'change',\n        devices: this.getDevices(),\n      }),\n    );\n  }, 500).bind(this);\n\n  /**\n   * Function to get the device after device change\n   * Chrome and Edge provide a default device from which we select the actual device\n   * Firefox and safari give 0th device as system default\n   * @returns {MediaDeviceInfo}\n   */\n  getNewAudioInputDevice() {\n    const manualSelection = this.getManuallySelectedAudioDevice();\n    if (manualSelection) {\n      return manualSelection;\n    }\n    // if manually selected device is not available, reset on the track\n    this.store.getLocalPeer()?.audioTrack?.resetManuallySelectedDeviceId();\n    const defaultDevice = this.audioInput.find(device => device.deviceId === 'default');\n    if (defaultDevice) {\n      // Selecting a non-default device so that the deviceId comparision does not give\n      // false positives when device is removed, because the other available device\n      // get's the deviceId as default once this device is removed\n      const nextDevice = this.audioInput.find(device => {\n        return device.deviceId !== 'default' && defaultDevice.label.includes(device.label);\n      });\n      return nextDevice;\n    }\n    return this.audioInput[0];\n  }\n\n  /**\n   * This method is to select the input/output from same group\n   * same group meaning both input/output are of same device\n   * This method might override the default coming from browser and system so as to select options from same\n   * device type. This is required in certain cases where browser's default is not correct.\n   * Algo:\n   * 1. find the non default input device if selected one is default by matching device label\n   * 2. find the corresponding output device which has the same group id or same label\n   * 3. select the previous selected device if nothing was found\n   * 4. select the default one if no matching device was found and previous device doesn't exist anymore\n   * 5. select the first option if there is no default\n   */\n  async setOutputDevice(deviceChange = false) {\n    const inputDevice = this.getNewAudioInputDevice();\n    const prevSelection = this.createIdentifier(this.outputDevice);\n    this.outputDevice = this.getAudioOutputDeviceMatchingInput(inputDevice);\n    if (!this.outputDevice) {\n      // there is no matching device, let's revert back to the prev selected device\n      this.outputDevice = this.audioOutput.find(device => this.createIdentifier(device) === prevSelection);\n      if (!this.outputDevice) {\n        // prev device doesn't exist as well, select default deviceId device if available, otherwise select 0th device\n        this.outputDevice = this.audioOutput.find(device => device.deviceId === 'default') || this.audioOutput[0];\n      }\n    }\n    await this.store.updateAudioOutputDevice(this.outputDevice);\n    // send event only on device change and device is not same as previous\n    if (deviceChange && prevSelection !== this.createIdentifier(this.outputDevice)) {\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.deviceChange({\n          selection: { audioOutput: this.outputDevice },\n          devices: this.getDevices(),\n          type: 'audioOutput',\n        }),\n      );\n      this.eventBus.deviceChange.publish({\n        selection: this.outputDevice,\n        type: 'audioOutput',\n        devices: this.getDevices(),\n      } as HMSDeviceChangeEvent);\n    }\n  }\n\n  private handleAudioInputDeviceChange = async (audioTrack?: HMSLocalAudioTrack) => {\n    if (!audioTrack) {\n      HMSLogger.d(this.TAG, 'No Audio track on local peer');\n      return;\n    }\n    // no need to proceed further if input has not changed\n    if (!this.audioInputChanged) {\n      HMSLogger.d(this.TAG, 'No Change in AudioInput Device');\n      return;\n    }\n    const newSelection = this.getNewAudioInputDevice();\n    if (!newSelection || !newSelection.deviceId) {\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.deviceChange({\n          selection: { audioInput: newSelection },\n          error: ErrorFactory.TracksErrors.SelectedDeviceMissing('audio'),\n          devices: this.getDevices(),\n          type: 'audioInput',\n        }),\n      );\n\n      HMSLogger.e(this.TAG, 'Audio device not found');\n      return;\n    }\n    const { settings } = audioTrack;\n    const newAudioTrackSettings = new HMSAudioTrackSettingsBuilder()\n      .codec(settings.codec)\n      .maxBitrate(settings.maxBitrate)\n      .deviceId(newSelection.deviceId)\n      .audioMode(settings.audioMode)\n      .build();\n    try {\n      await audioTrack.setSettings(newAudioTrackSettings, true);\n      this.eventBus.deviceChange.publish({\n        devices: this.getDevices(),\n        selection: newSelection,\n        type: 'audioInput',\n      } as HMSDeviceChangeEvent);\n      this.logDevices('Audio Device Change Success');\n    } catch (error) {\n      HMSLogger.e(this.TAG, '[Audio Device Change]', error);\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.deviceChange({\n          selection: { audioInput: newSelection },\n          devices: this.getDevices(),\n          type: 'audioInput',\n          error: error as HMSException,\n        }),\n      );\n      this.eventBus.deviceChange.publish({\n        error,\n        selection: newSelection,\n        type: 'audioInput',\n        devices: this.getDevices(),\n      } as HMSDeviceChangeEvent);\n    }\n  };\n\n  private handleVideoInputDeviceChange = async (videoTrack?: HMSLocalVideoTrack) => {\n    if (!videoTrack) {\n      HMSLogger.d(this.TAG, 'No video track on local peer');\n      return;\n    }\n    // no need to proceed further if input has not changed\n    if (!this.videoInputChanged) {\n      HMSLogger.d(this.TAG, 'No Change in VideoInput Device');\n      return;\n    }\n    const newSelection = this.videoInput[0];\n    if (!newSelection || !newSelection.deviceId) {\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.deviceChange({\n          selection: { videoInput: newSelection },\n          error: ErrorFactory.TracksErrors.SelectedDeviceMissing('video'),\n          devices: this.getDevices(),\n          type: 'video',\n        }),\n      );\n      HMSLogger.e(this.TAG, 'Video device not found');\n      return;\n    }\n    const { settings } = videoTrack;\n    const newVideoTrackSettings = new HMSVideoTrackSettingsBuilder()\n      .codec(settings.codec)\n      .maxBitrate(settings.maxBitrate)\n      .maxFramerate(settings.maxFramerate)\n      .setWidth(settings.width)\n      .setHeight(settings.height)\n      .deviceId(newSelection.deviceId)\n      .build();\n    try {\n      await videoTrack.setSettings(newVideoTrackSettings, true);\n      // On replace track, enabled will be true. Need to be set to previous state\n      // videoTrack.setEnabled(enabled); // TODO: remove this once verified on qa.\n      this.eventBus.deviceChange.publish({\n        devices: this.getDevices(),\n        selection: newSelection,\n        type: 'video',\n      } as HMSDeviceChangeEvent);\n      this.logDevices('Video Device Change Success');\n    } catch (error) {\n      HMSLogger.e(this.TAG, '[Video Device Change]', error);\n      this.eventBus.analytics.publish(\n        AnalyticsEventFactory.deviceChange({\n          selection: { videoInput: newSelection },\n          devices: this.getDevices(),\n          type: 'video',\n          error: error as HMSException,\n        }),\n      );\n      this.eventBus.deviceChange.publish({\n        error: error as HMSException,\n        type: 'video',\n        selection: newSelection,\n        devices: this.getDevices(),\n      } as HMSDeviceChangeEvent);\n    }\n  };\n\n  getManuallySelectedAudioDevice() {\n    const localPeer = this.store.getLocalPeer();\n    const audioTrack = localPeer?.audioTrack;\n    return this.audioInput.find(device => device.deviceId === audioTrack?.getManuallySelectedDeviceId());\n  }\n\n  // specifically used for mweb\n  categorizeAudioInputDevices() {\n    let bluetoothDevice: InputDeviceInfo | null = null;\n    let speakerPhone: InputDeviceInfo | null = null;\n    let wired: InputDeviceInfo | null = null;\n    let earpiece: InputDeviceInfo | null = null;\n\n    for (const device of this.audioInput) {\n      const label = device.label.toLowerCase();\n      if (label.includes('speakerphone')) {\n        speakerPhone = device;\n      } else if (label.includes('wired')) {\n        wired = device;\n      } else if (/airpods|buds|wireless|bluetooth/gi.test(label)) {\n        bluetoothDevice = device;\n      } else if (label.includes('earpiece')) {\n        earpiece = device;\n      }\n    }\n\n    return { bluetoothDevice, speakerPhone, wired, earpiece };\n  }\n\n  private startPollingForDevices = () => {\n    // device change supported, no polling needed\n    if ('ondevicechange' in navigator.mediaDevices) {\n      return;\n    }\n    this.timer = setTimeout(() => {\n      (async () => {\n        await this.enumerateDevices();\n        await this.autoSelectAudioOutput();\n        this.startPollingForDevices();\n      })();\n    }, 5000);\n  };\n\n  /**\n   * Mweb is not able to play via call channel by default, this is to switch from media channel to call channel\n   */\n  // eslint-disable-next-line complexity\n  private autoSelectAudioOutput = async () => {\n    if ('ondevicechange' in navigator.mediaDevices) {\n      return;\n    }\n    const { bluetoothDevice, earpiece, speakerPhone, wired } = this.categorizeAudioInputDevices();\n    const localAudioTrack = this.store.getLocalPeer()?.audioTrack;\n    if (!localAudioTrack || !earpiece) {\n      return;\n    }\n    const manualSelection = this.getManuallySelectedAudioDevice();\n    const externalDeviceID =\n      manualSelection?.deviceId || bluetoothDevice?.deviceId || wired?.deviceId || speakerPhone?.deviceId;\n    HMSLogger.d(this.TAG, 'externalDeviceID', externalDeviceID);\n    // already selected appropriate device\n    if (localAudioTrack.settings.deviceId === externalDeviceID && this.earpieceSelected) {\n      return;\n    }\n    if (!this.earpieceSelected) {\n      if (bluetoothDevice?.deviceId === externalDeviceID) {\n        this.earpieceSelected = true;\n        return;\n      }\n      await localAudioTrack.setSettings({ deviceId: earpiece?.deviceId }, true);\n      this.earpieceSelected = true;\n    }\n    await localAudioTrack.setSettings(\n      {\n        deviceId: externalDeviceID,\n      },\n      true,\n    );\n  };\n\n  // eslint-disable-next-line complexity\n  private getAudioOutputDeviceMatchingInput(inputDevice?: MediaDeviceInfo) {\n    const blacklist = this.store.getConfig()?.settings?.speakerAutoSelectionBlacklist || [];\n    if (blacklist === 'all' || !inputDevice) {\n      return;\n    }\n\n    const inputLabel = inputDevice.label.toLowerCase() || '';\n    if (blacklist.some(label => inputLabel.includes(label.toLowerCase()))) {\n      return;\n    }\n\n    const matchingLabel = this.audioOutput.find(\n      device => inputDevice.deviceId !== 'default' && device.label === inputDevice.label,\n    );\n\n    if (matchingLabel) {\n      return matchingLabel;\n    }\n\n    const matchingGroupId = this.audioOutput.find(device => device.groupId === inputDevice.groupId);\n\n    // Select the device with matching group only when it is the default device\n    // if a earphone without mic is connected, the above would pick system speakers instead of the earphone\n    if (\n      matchingGroupId &&\n      this.audioOutput[0].deviceId === 'default' &&\n      matchingGroupId.groupId === this.audioOutput[0].groupId\n    ) {\n      return matchingGroupId;\n    }\n\n    return;\n  }\n\n  private logDevices(label = '') {\n    HMSLogger.d(\n      this.TAG,\n      label,\n      JSON.stringify(\n        {\n          videoInput: [...this.videoInput],\n          audioInput: [...this.audioInput],\n          audioOutput: [...this.audioOutput],\n          selected: this.getCurrentSelection(),\n        },\n        null,\n        4,\n      ),\n    );\n  }\n}\n", "import { DeviceManager } from './DeviceManager';\nimport { AudioSinkManager } from '../audio-sink-manager';\nimport { HMSAudioContextHandler } from '../utils/media';\n\nexport interface IAudioOutputManager {\n  getDevice(): MediaDeviceInfo | undefined;\n  setDevice(deviceId: string): Promise<MediaDeviceInfo | undefined>;\n  getVolume(): number;\n  setVolume(value: number): void;\n}\n\nexport class AudioOutputManager implements IAudioOutputManager {\n  constructor(private deviceManager: DeviceManager, private audioSinkManager: AudioSinkManager) {}\n\n  getVolume() {\n    return this.audioSinkManager.getVolume();\n  }\n\n  setVolume(value: number) {\n    if (value < 0 || value > 100) {\n      throw Error('Please pass a valid number between 0-100');\n    }\n    this.audioSinkManager.setVolume(value);\n  }\n\n  getDevice() {\n    return this.deviceManager.outputDevice;\n  }\n\n  setDevice(deviceId?: string) {\n    return this.deviceManager.updateOutputDevice(deviceId, true);\n  }\n\n  async unblockAutoplay() {\n    await this.audioSinkManager.unblockAutoplay();\n    /**\n     * similar to autoplay error when there's no user interaction,\n     * audio context is paused due to which empty audio tracks do not send any data and therefore it doesn't reach SFU.\n     * resume audio context on user interaction to enable empty audio tracks to send data and be forwarded to remote peers\n     */\n    await HMSAudioContextHandler.resumeContext();\n  }\n}\n", "import { HMSSessionFeedback, HMSSessionInfo } from './interface';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { HMSException } from '../internal';\nimport HMSLogger from '../utils/logger';\n\nexport class FeedbackService {\n  private static TAG = '[FeedbackService]';\n  private static handleError(response: Response) {\n    if (response.status === 404) {\n      throw ErrorFactory.APIErrors.EndpointUnreachable(HMSAction.FEEDBACK, response.statusText);\n    }\n    if (response.status >= 400) {\n      throw ErrorFactory.APIErrors.ServerErrors(response.status, HMSAction.FEEDBACK, response?.statusText);\n    }\n    return;\n  }\n\n  static async sendFeedback({\n    token,\n    eventEndpoint = 'https://event.100ms.live',\n    info,\n    feedback,\n  }: {\n    token: string;\n    eventEndpoint?: string;\n    info: HMSSessionInfo;\n    feedback?: HMSSessionFeedback;\n  }): Promise<void> {\n    HMSLogger.d(\n      this.TAG,\n      `sendFeedback: feedbackEndpoint=${eventEndpoint} peerId=${info.peer.peer_id} session=${info.peer.session_id} `,\n    );\n    const url = new URL('v2/client/feedback', eventEndpoint);\n    const body = {\n      ...info,\n      payload: feedback,\n    };\n    try {\n      const response = await fetch(url, {\n        headers: { Authorization: `Bearer ${token}` },\n        body: JSON.stringify(body),\n        method: 'POST',\n      });\n      try {\n        this.handleError(response);\n        return;\n      } catch (err) {\n        HMSLogger.e(this.TAG, 'error', (err as Error).message, response.status);\n        throw err instanceof HMSException\n          ? err\n          : ErrorFactory.APIErrors.ServerErrors(response.status, HMSAction.FEEDBACK, (err as Error).message);\n      }\n    } catch (err) {\n      const error = err as Error;\n      if (['Failed to fetch', 'NetworkError', 'ECONNRESET'].some(message => error.message.includes(message))) {\n        throw ErrorFactory.APIErrors.EndpointUnreachable(HMSAction.FEEDBACK, error.message);\n      }\n      throw error;\n    }\n  }\n}\n", "import { EventEmitter2 as EventEmitter } from 'eventemitter2';\nimport { HMSInternalEvent } from './HMSInternalEvent';\nimport AnalyticsEvent from '../analytics/AnalyticsEvent';\nimport { HMSException } from '../error/HMSException';\nimport { HMSDeviceChangeEvent, HMSRole } from '../interfaces';\nimport {\n  HMSLocalAudioTrack,\n  HMSLocalVideoTrack,\n  HMSRemoteAudioTrack,\n  HMSRemoteVideoTrack,\n  HMSWebrtcStats,\n} from '../internal';\nimport { PolicyParams } from '../notification-manager/HMSNotifications';\nimport { HMSRemotePeer } from '../sdk/models/peer';\nimport { HMSEvents } from '../utils/constants';\nimport { ITrackAudioLevelUpdate } from '../utils/track-audio-level-monitor';\n\nexport class EventBus {\n  private eventEmitter: EventEmitter = new EventEmitter();\n  readonly analytics: HMSInternalEvent<AnalyticsEvent> = new HMSInternalEvent<AnalyticsEvent>(\n    HMSEvents.ANALYTICS,\n    this.eventEmitter,\n  );\n  readonly deviceChange = new HMSInternalEvent<HMSDeviceChangeEvent>(HMSEvents.DEVICE_CHANGE, this.eventEmitter);\n  readonly localAudioEnabled = new HMSInternalEvent<{ enabled: boolean; track: HMSLocalAudioTrack }>(\n    HMSEvents.LOCAL_AUDIO_ENABLED,\n    this.eventEmitter,\n  );\n  readonly localVideoEnabled = new HMSInternalEvent<{ enabled: boolean; track: HMSLocalVideoTrack }>(\n    HMSEvents.LOCAL_VIDEO_ENABLED,\n    this.eventEmitter,\n  );\n  readonly localVideoUnmutedNatively = new HMSInternalEvent(HMSEvents.LOCAL_VIDEO_UNMUTED_NATIVELY, this.eventEmitter);\n\n  /**\n   * Emitter which processes raw RTC stats from rtcStatsUpdate and calls client callback\n   */\n  readonly statsUpdate = new HMSInternalEvent<HMSWebrtcStats>(HMSEvents.STATS_UPDATE, this.eventEmitter);\n\n  readonly trackDegraded = new HMSInternalEvent<HMSRemoteVideoTrack>(HMSEvents.TRACK_DEGRADED, this.eventEmitter);\n  readonly trackRestored = new HMSInternalEvent<HMSRemoteVideoTrack>(HMSEvents.TRACK_RESTORED, this.eventEmitter);\n\n  /**\n   * Emits audio level updates for audio tracks(used with local track in preview)\n   */\n  readonly trackAudioLevelUpdate = new HMSInternalEvent<ITrackAudioLevelUpdate>(\n    HMSEvents.TRACK_AUDIO_LEVEL_UPDATE,\n    this.eventEmitter,\n  );\n\n  readonly audioPluginFailed = new HMSInternalEvent<HMSException>(HMSEvents.AUDIO_PLUGIN_FAILED, this.eventEmitter);\n\n  readonly localAudioSilence = new HMSInternalEvent<{ track: HMSLocalAudioTrack }>(\n    HMSEvents.LOCAL_AUDIO_SILENCE,\n    this.eventEmitter,\n  );\n\n  readonly policyChange = new HMSInternalEvent<PolicyParams>(HMSEvents.POLICY_CHANGE, this.eventEmitter);\n\n  readonly localRoleUpdate = new HMSInternalEvent<{ oldRole: HMSRole; newRole: HMSRole }>(\n    HMSEvents.LOCAL_ROLE_UPDATE,\n    this.eventEmitter,\n  );\n\n  readonly audioTrackUpdate = new HMSInternalEvent<{ track: HMSRemoteAudioTrack; enabled: boolean }>(\n    HMSEvents.AUDIO_TRACK_UPDATE,\n    this.eventEmitter,\n  );\n\n  readonly audioTrackAdded = new HMSInternalEvent<{ track: HMSRemoteAudioTrack; peer: HMSRemotePeer }>(\n    HMSEvents.AUDIO_TRACK_ADDED,\n    this.eventEmitter,\n  );\n\n  readonly audioTrackRemoved = new HMSInternalEvent<HMSRemoteAudioTrack>(\n    HMSEvents.AUDIO_TRACK_REMOVED,\n    this.eventEmitter,\n  );\n\n  readonly autoplayError = new HMSInternalEvent<HMSException>(HMSEvents.AUTOPLAY_ERROR, this.eventEmitter);\n\n  readonly leave = new HMSInternalEvent<HMSException | undefined>(HMSEvents.LEAVE, this.eventEmitter);\n}\n", "import type { WaitForFilter, WaitForOptions } from 'eventemitter2';\nimport { EventEmitter2 as EventEmitter } from 'eventemitter2';\n\nexport class HMSInternalEvent<T> {\n  constructor(private eventName: string, private eventEmitter: EventEmitter) {}\n\n  publish = (event?: T) => {\n    this.eventEmitter.emit(this.eventName, event);\n  };\n  subscribe = (fn: (event: T) => void | Promise<void>) => {\n    this.eventEmitter.on(this.eventName, fn);\n  };\n  subscribeOnce = (fn: (event: T) => void | Promise<void>) => {\n    this.eventEmitter.once(this.eventName, fn);\n  };\n  unsubscribe = (fn: (event: T) => void | Promise<void>) => {\n    this.eventEmitter.off(this.eventName, fn);\n  };\n  waitFor = (predicate: WaitForFilter) => {\n    return this.eventEmitter.waitFor(this.eventName, {\n      filter: predicate,\n    } as WaitForOptions);\n  };\n  removeAllListeners = () => {\n    this.eventEmitter.removeAllListeners(this.eventName);\n  };\n}\n", "import { HMSAudioListener, HMSPeerUpdate, HMSSpeaker, HMSUpdateListener } from '../../interfaces';\nimport { HMSAudioTrack } from '../../media/tracks';\nimport { Store } from '../../sdk/store';\nimport { SpeakerList } from '../HMSNotifications';\n\nexport class ActiveSpeakerManager {\n  constructor(private store: Store, public listener?: HMSUpdateListener, public audioListener?: HMSAudioListener) {}\n\n  handleActiveSpeakers(speakerList: SpeakerList) {\n    const speakers = speakerList['speaker-list'];\n    const hmsSpeakers: HMSSpeaker[] = speakers.map(speaker => ({\n      audioLevel: speaker.level,\n      peer: this.store.getPeerById(speaker.peer_id)!,\n      track: this.store.getTrackById(speaker.track_id) as HMSAudioTrack,\n    }));\n\n    this.audioListener?.onAudioLevelUpdate(hmsSpeakers);\n    this.store.updateSpeakers(hmsSpeakers);\n    const dominantSpeaker = speakers[0];\n\n    if (dominantSpeaker) {\n      const dominantSpeakerPeer = this.store.getPeerById(dominantSpeaker.peer_id);\n      this.listener?.onPeerUpdate(HMSPeerUpdate.BECAME_DOMINANT_SPEAKER, dominantSpeakerPeer!);\n    } else {\n      this.listener?.onPeerUpdate(HMSPeerUpdate.RESIGNED_DOMINANT_SPEAKER, null);\n    }\n  }\n}\n", "import { HMSUpdateListener } from '../../interfaces';\nimport HMSLogger from '../../utils/logger';\nimport { HMSNotificationMethod } from '../HMSNotificationMethod';\nimport { MessageNotification } from '../HMSNotifications';\n\nexport class BroadcastManager {\n  private readonly TAG = '[BroadcastManager]';\n  constructor(public listener?: HMSUpdateListener) {}\n\n  handleNotification(method: string, notification: any) {\n    if (method !== HMSNotificationMethod.BROADCAST) {\n      return;\n    }\n    this.handleBroadcast(notification);\n  }\n\n  private handleBroadcast(messageNotification: MessageNotification) {\n    HMSLogger.d(this.TAG, `Received Message from sender=${messageNotification?.peer?.peer_id}: ${messageNotification}`);\n    this.listener?.onMessageReceived(messageNotification);\n  }\n}\n", "import { HMSConnectionQuality, HMSConnectionQualityListener } from '../../interfaces';\nimport { Store } from '../../sdk/store';\nimport { ConnectionQualityList } from '../HMSNotifications';\n\nexport class ConnectionQualityManager {\n  constructor(private store: Store, public listener?: HMSConnectionQualityListener) {}\n\n  handleQualityUpdate(qualityList: ConnectionQualityList) {\n    const peers = qualityList.peers;\n    const hmsPeers: HMSConnectionQuality[] = peers.map(peer => {\n      const storePeer = this.store.getPeerById(peer.peer_id);\n      if (storePeer) {\n        storePeer.updateNetworkQuality(peer.downlink_score);\n      }\n      return {\n        peerID: peer.peer_id,\n        downlinkQuality: peer.downlink_score,\n      };\n    });\n    this.listener?.onConnectionQualityUpdate(hmsPeers);\n  }\n}\n", "import { createRemotePeer } from './utils';\nimport { VideoTrackLayerUpdate } from '../../connection/channel-messages';\nimport { EventBus } from '../../events/EventBus';\nimport { HMSRemotePeer, HMSTrackUpdate, HMSUpdateListener } from '../../interfaces';\nimport { HMSRemoteAudioTrack, HMSRemoteTrack, HMSRemoteVideoTrack, HMSTrackType } from '../../media/tracks';\nimport { HMSPeer } from '../../sdk/models/peer';\nimport { Store } from '../../sdk/store';\nimport HMSLogger from '../../utils/logger';\nimport { OnTrackLayerUpdateNotification, TrackState, TrackStateNotification } from '../HMSNotifications';\n\n/**\n * Handles:\n * - Incoming track meta-data from BIZ(signal) to match a track to a peer.\n * - Incoming MediaStreamTracks(wrapped in HMSTracks) from RTCMediaChannel.\n * - Mute/unmute track meta-data updates from BIZ.\n *\n * Since track meta-data and RTC tracks come in asynchronously,\n * we store the track meta-data(TrackState) in SDK Store and tracks temporarily here in tracksToProcess.\n *\n * Once we have both TrackState and track,\n * we add it to peer, send listener.onTrackUpdate and remove it from tracksToProcess.\n *\n * Gotchas:\n * - TRACK_UPDATE comes before TRACK_ADD -> update state, process pending tracks when TRACK_ADD arrives.\n */\nexport class TrackManager {\n  public TAG = '[TrackManager]';\n  private tracksToProcess: Map<string, HMSRemoteTrack> = new Map();\n\n  constructor(public store: Store, public eventBus: EventBus, public listener?: HMSUpdateListener) {}\n\n  /**\n   * Add event from biz on track-add\n   * @param params TrackStateNotification\n   */\n  handleTrackMetadataAdd(params: TrackStateNotification) {\n    HMSLogger.d(this.TAG, `TRACK_METADATA_ADD`, JSON.stringify(params, null, 2));\n\n    for (const trackId in params.tracks) {\n      const trackInfo = params.tracks[trackId];\n      this.store.setTrackState({\n        peerId: params.peer.peer_id,\n        trackInfo,\n      });\n    }\n    this.processPendingTracks();\n  }\n\n  /**\n   * Sets the tracks to peer and returns the peer\n   */\n  handleTrackAdd = (track: HMSRemoteTrack) => {\n    HMSLogger.d(this.TAG, `ONTRACKADD`, `${track}`);\n    this.tracksToProcess.set(track.trackId, track);\n    this.processPendingTracks();\n  };\n\n  handleTrackRemovedPermanently = (notification: TrackStateNotification) => {\n    HMSLogger.d(this.TAG, `ONTRACKREMOVE permanently`, notification);\n    const trackIds = Object.keys(notification.tracks);\n\n    trackIds.forEach(trackId => {\n      const trackStateEntry = this.store.getTrackState(trackId);\n      if (!trackStateEntry) {\n        return;\n      }\n\n      const track = this.store.getTrackById(trackId);\n      if (!track) {\n        HMSLogger.d(this.TAG, 'Track not found in store');\n        return;\n      }\n\n      // emit this event here as peer will already be removed(if left the room) by the time this event is received\n      track.type === HMSTrackType.AUDIO && this.eventBus.audioTrackRemoved.publish(track as HMSRemoteAudioTrack);\n      this.store.removeTrack(track);\n      const hmsPeer = this.store.getPeerById(trackStateEntry.peerId);\n      if (!hmsPeer) {\n        return;\n      }\n      this.removePeerTracks(hmsPeer, track as HMSRemoteTrack);\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_REMOVED, track, hmsPeer);\n    });\n  };\n\n  /**\n   * Sets the track of corresponding peer to null and returns the peer\n   */\n  handleTrackRemove(track: HMSRemoteTrack, remove = true) {\n    HMSLogger.d(this.TAG, `ONTRACKREMOVE`, `${track}`);\n\n    const trackStateEntry = this.store.getTrackState(track.trackId);\n\n    if (!trackStateEntry) {\n      return;\n    }\n\n    const storeHasTrack = this.store.hasTrack(track);\n    if (!storeHasTrack) {\n      HMSLogger.d(this.TAG, 'Track not found in store');\n      return;\n    }\n\n    // remove tracks only when onDemandTracks flag is false\n    if (remove) {\n      this.store.removeTrack(track);\n      const hmsPeer = this.store.getPeerById(trackStateEntry.peerId);\n      if (!hmsPeer) {\n        return;\n      }\n      this.removePeerTracks(hmsPeer, track);\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_REMOVED, track, hmsPeer);\n\n      // emit this event here as peer will already be removed(if left the room) by the time this event is received\n      track.type === HMSTrackType.AUDIO && this.eventBus.audioTrackRemoved.publish(track as HMSRemoteAudioTrack);\n    }\n  }\n\n  handleTrackLayerUpdate = (params: OnTrackLayerUpdateNotification) => {\n    for (const trackId in params.tracks) {\n      const trackEntry = params.tracks[trackId];\n      const track = this.store.getTrackById(trackId);\n      if (!track) {\n        continue;\n      }\n\n      const peer = this.store.getPeerByTrackId(trackId)!;\n      if (!peer) {\n        continue;\n      }\n\n      if (track instanceof HMSRemoteVideoTrack) {\n        this.setLayer(track, trackEntry);\n      }\n    }\n  };\n\n  // eslint-disable-next-line complexity\n  handleTrackUpdate = (params: TrackStateNotification, callListener = true) => {\n    let hmsPeer = this.store.getPeerById(params.peer.peer_id);\n    const notifPeer = params.peer;\n    if (!hmsPeer && !notifPeer) {\n      HMSLogger.d(this.TAG, 'Track Update ignored - Peer not added to store');\n      return;\n    }\n    if (!hmsPeer) {\n      hmsPeer = createRemotePeer(notifPeer, this.store);\n      this.store.addPeer(hmsPeer);\n    }\n\n    for (const trackId in params.tracks) {\n      const currentTrackStateInfo = Object.assign({}, this.store.getTrackState(trackId)?.trackInfo);\n\n      const trackEntry = params.tracks[trackId];\n      const track = this.store.getTrackById(trackId);\n\n      this.store.setTrackState({\n        peerId: params.peer.peer_id,\n        trackInfo: { ...currentTrackStateInfo, ...trackEntry },\n      });\n\n      // TRACK_UPDATE came before TRACK_ADD -> update state, process pending tracks when TRACK_ADD arrives.\n      if (!track || this.tracksToProcess.has(trackId)) {\n        this.processTrackInfo(trackEntry, params.peer.peer_id, callListener);\n        this.processPendingTracks();\n      } else {\n        track.setEnabled(!trackEntry.mute);\n        const eventType = this.processTrackUpdate(track as HMSRemoteTrack, currentTrackStateInfo, trackEntry);\n        if (eventType) {\n          this.listener?.onTrackUpdate(eventType, track, hmsPeer);\n        }\n      }\n    }\n  };\n\n  processTrackInfo = (_trackInfo: TrackState, _peerId: string, _callListener?: boolean) => {};\n\n  processPendingTracks = () => {\n    const tracksCopy = new Map(this.tracksToProcess);\n    tracksCopy.forEach(track => {\n      const state = this.store.getTrackState(track.trackId);\n      if (!state) {\n        HMSLogger.d(this.TAG, 'TrackState not added to store', `peerId - ${track.peerId}`, `trackId -${track.trackId}`);\n        return;\n      }\n\n      const hmsPeer = this.store.getPeerById(state.peerId);\n      if (!hmsPeer) {\n        HMSLogger.d(this.TAG, 'Peer not added to store, peerId', state.peerId);\n        return;\n      }\n\n      track.source = state.trackInfo.source;\n      track.peerId = hmsPeer.peerId;\n      // set log identifier to initial name of the peer\n      track.logIdentifier = hmsPeer.name;\n      track.setEnabled(!state.trackInfo.mute);\n      this.addAudioTrack(hmsPeer, track);\n      this.addVideoTrack(hmsPeer, track);\n      /**\n       * Don't call onTrackUpdate for audio elements immediately because the operations(eg: setVolume) performed\n       * on onTrackUpdate can be overriden in AudioSinkManager when audio element is created\n       **/\n      track.type === HMSTrackType.AUDIO\n        ? this.eventBus.audioTrackAdded.publish({ track: track as HMSRemoteAudioTrack, peer: hmsPeer as HMSRemotePeer })\n        : this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_ADDED, track, hmsPeer);\n      this.tracksToProcess.delete(track.trackId);\n    });\n  };\n\n  private setLayer(track: HMSRemoteVideoTrack, layerUpdate: VideoTrackLayerUpdate) {\n    const peer = this.store.getPeerByTrackId(track.trackId);\n    if (!peer) {\n      return;\n    }\n    const isDegraded = track.setLayerFromServer(layerUpdate);\n    if (isDegraded) {\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_DEGRADED, track, peer);\n    } else {\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_RESTORED, track, peer);\n    }\n  }\n\n  removePeerTracks(hmsPeer: HMSPeer, track: HMSRemoteTrack) {\n    const auxiliaryTrackIndex = hmsPeer.auxiliaryTracks.indexOf(track);\n    if (auxiliaryTrackIndex > -1) {\n      hmsPeer.auxiliaryTracks.splice(auxiliaryTrackIndex, 1);\n      HMSLogger.d(this.TAG, 'auxiliary track removed', `${track}`);\n    } else {\n      if (track.type === HMSTrackType.AUDIO && hmsPeer.audioTrack === track) {\n        hmsPeer.audioTrack = undefined;\n        HMSLogger.d(this.TAG, 'audio track removed', `${track}`);\n      } else if (track.type === HMSTrackType.VIDEO && hmsPeer.videoTrack === track) {\n        hmsPeer.videoTrack = undefined;\n        HMSLogger.d(this.TAG, 'video track removed', `${track}`);\n      }\n    }\n  }\n\n  private addAudioTrack(hmsPeer: HMSPeer, track: HMSRemoteTrack) {\n    if (track.type !== HMSTrackType.AUDIO) {\n      return;\n    }\n    if (track.source === 'regular' && (!hmsPeer.audioTrack || hmsPeer.audioTrack?.trackId === track.trackId)) {\n      hmsPeer.audioTrack = track as HMSRemoteAudioTrack;\n    } else {\n      hmsPeer.auxiliaryTracks.push(track);\n    }\n    this.store.addTrack(track);\n    HMSLogger.d(this.TAG, 'audio track added', `${track}`);\n  }\n\n  addVideoTrack(hmsPeer: HMSPeer, track: HMSRemoteTrack) {\n    if (track.type !== HMSTrackType.VIDEO) {\n      return;\n    }\n    const remoteTrack = track as HMSRemoteVideoTrack;\n    const simulcastDefinitions = this.store.getSimulcastDefinitionsForPeer(hmsPeer, remoteTrack.source!);\n    remoteTrack.setSimulcastDefinitons(simulcastDefinitions);\n    if (this.addAsPrimaryVideoTrack(hmsPeer, remoteTrack)) {\n      if (!hmsPeer.videoTrack) {\n        hmsPeer.videoTrack = remoteTrack;\n      } else {\n        (hmsPeer.videoTrack as HMSRemoteVideoTrack).replaceTrack(remoteTrack);\n      }\n      this.store.addTrack(hmsPeer.videoTrack);\n    } else {\n      const index = hmsPeer.auxiliaryTracks.findIndex(track => track.trackId === remoteTrack.trackId);\n      if (index === -1) {\n        hmsPeer.auxiliaryTracks.push(remoteTrack);\n        this.store.addTrack(remoteTrack);\n      } else {\n        (hmsPeer.auxiliaryTracks[index] as HMSRemoteVideoTrack).replaceTrack(remoteTrack);\n        this.store.addTrack(hmsPeer.auxiliaryTracks[index]);\n      }\n    }\n    HMSLogger.d(this.TAG, 'video track added', `${track}`);\n  }\n\n  addAsPrimaryVideoTrack(hmsPeer: HMSPeer, track: HMSRemoteTrack) {\n    return track.source === 'regular' && (!hmsPeer.videoTrack || hmsPeer.videoTrack?.trackId === track.trackId);\n  }\n\n  private processTrackUpdate(track: HMSRemoteTrack, currentTrackState: TrackState, trackState: TrackState) {\n    let eventType;\n    if (currentTrackState.mute !== trackState.mute) {\n      eventType = trackState.mute ? HMSTrackUpdate.TRACK_MUTED : HMSTrackUpdate.TRACK_UNMUTED;\n      track.type === HMSTrackType.AUDIO &&\n        this.eventBus.audioTrackUpdate.publish({ track: track as HMSRemoteAudioTrack, enabled: !trackState.mute });\n    } else if (currentTrackState.description !== trackState.description) {\n      eventType = HMSTrackUpdate.TRACK_DESCRIPTION_CHANGED;\n    }\n    return eventType;\n  }\n}\n", "import { TrackManager } from './TrackManager';\nimport { EventBus } from '../../events/EventBus';\nimport { HMSPeer, HMSTrackUpdate, HMSUpdateListener } from '../../interfaces';\nimport { HMSRemoteStream } from '../../media/streams/HMSRemoteStream';\nimport { HMSRemoteTrack, HMSRemoteVideoTrack } from '../../media/tracks';\nimport { LocalTrackManager } from '../../sdk/LocalTrackManager';\nimport { Store } from '../../sdk/store';\nimport HMSTransport from '../../transport';\nimport HMSLogger from '../../utils/logger';\nimport { isEmptyTrack } from '../../utils/track';\nimport { TrackState, TrackStateNotification } from '../HMSNotifications';\n\nexport class OnDemandTrackManager extends TrackManager {\n  TAG = '[OnDemandTrackManager]';\n\n  constructor(store: Store, eventBus: EventBus, private transport: HMSTransport, listener?: HMSUpdateListener) {\n    super(store, eventBus, listener);\n  }\n\n  handleTrackMetadataAdd(params: TrackStateNotification) {\n    super.handleTrackMetadataAdd(params);\n    for (const trackId in params.tracks) {\n      if (params.tracks[trackId].type === 'video') {\n        this.processTrackInfo(params.tracks[trackId], params.peer.peer_id);\n      }\n    }\n  }\n\n  handleTrackRemove(track: HMSRemoteTrack) {\n    const isRegularVideo = track.type === 'video' && track.source === 'regular';\n    super.handleTrackRemove(track, !isRegularVideo);\n    if (isRegularVideo) {\n      this.processTrackInfo(\n        {\n          track_id: track.trackId,\n          mute: !track.enabled,\n          type: track.type,\n          source: track.source,\n          stream_id: track.stream.id,\n        } as TrackState,\n        track.peerId!,\n        false,\n      );\n    }\n  }\n\n  /**\n   * Add a blank track for the track received from biz so that the UI can render and show video element\n   * which will trigger the prefer-video-track-state request which results in the actual track being\n   * received from the sfu.\n   * This will also be called when track is removed, as it can be removed when none is sent to sfu to\n   * reduce the overall offer size\n   * @param {TrackState} trackInfo\n   * @param {string} peerId\n   * @param {boolean} callListener\n   * @returns\n   */\n  processTrackInfo = (trackInfo: TrackState, peerId: string, callListener = true) => {\n    if (trackInfo.type !== 'video') {\n      return;\n    }\n    const hmsPeer = this.store.getPeerById(peerId);\n    if (!hmsPeer || !this.isPeerRoleSubscribed(peerId)) {\n      HMSLogger.d(this.TAG, `no peer in store for peerId: ${peerId}`);\n      return;\n    }\n    const remoteStream = new HMSRemoteStream(new MediaStream(), this.transport.getSubscribeConnection()!);\n    const emptyTrack = LocalTrackManager.getEmptyVideoTrack();\n    emptyTrack.enabled = !trackInfo.mute;\n    const track = new HMSRemoteVideoTrack(remoteStream, emptyTrack, trackInfo.source);\n    track.setTrackId(trackInfo.track_id);\n    track.peerId = hmsPeer.peerId;\n    track.logIdentifier = hmsPeer.name;\n    this.addVideoTrack(hmsPeer, track);\n    if (callListener) {\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_ADDED, hmsPeer.videoTrack!, hmsPeer);\n    }\n  };\n\n  addAsPrimaryVideoTrack(hmsPeer: HMSPeer, track: HMSRemoteTrack) {\n    if (track.source !== 'regular') {\n      return false;\n    }\n    if (!hmsPeer.videoTrack) {\n      return true;\n    }\n    if (hmsPeer.videoTrack.trackId === track.trackId) {\n      return true;\n    }\n    return hmsPeer.videoTrack.enabled && isEmptyTrack(hmsPeer.videoTrack.nativeTrack);\n  }\n\n  private isPeerRoleSubscribed(peerId?: string) {\n    if (!peerId) {\n      return true;\n    }\n    const localPeer = this.store.getLocalPeer();\n    const peer = this.store.getPeerById(peerId);\n    return peer && localPeer?.role?.subscribeParams?.subscribeToRoles?.includes(peer.role?.name!);\n  }\n}\n", "import { PeerManager } from './PeerManager';\nimport { TrackManager } from './TrackManager';\nimport { HMSTrackUpdate, HMSUpdateListener } from '../../interfaces';\nimport { HMSPeer } from '../../sdk/models/peer';\nimport { Store } from '../../sdk/store';\nimport HMSLogger from '../../utils/logger';\nimport { HMSNotificationMethod } from '../HMSNotificationMethod';\nimport { PeerListNotification, PeerNotification, PeriodicRoomState } from '../HMSNotifications';\n\n/**\n * Handles:\n * - Initial Peer List - get peer and track meta-data for peers who are already in the room when you join\n * - Reconnect Peer List - Handle peer and track changes in the room missed out due to reconnection\n *\n * Cases to handle in reconnect peer list:\n * - Add additional peers as peer join\n * - Remove missing peers as peer leave\n * - For existing peers:\n *    - Add new tracks as track add\n *    - Remove missing tracks as track remove\n *    - Track state change(enabled) as track update\n */\nexport class PeerListManager {\n  private readonly TAG = '[PeerListManager]';\n  constructor(\n    private store: Store,\n    private peerManager: PeerManager,\n    private trackManager: TrackManager,\n    public listener?: HMSUpdateListener,\n  ) {}\n\n  handleNotification(method: string, notification: any, isReconnecting: boolean) {\n    if (method === HMSNotificationMethod.PEER_LIST) {\n      const peerList = notification as PeerListNotification;\n      if (isReconnecting) {\n        HMSLogger.d(this.TAG, `RECONNECT_PEER_LIST event`, JSON.stringify(peerList, null, 2));\n        this.handleReconnectPeerList(peerList);\n      } else {\n        // TODO: Don't call initial peerlist if atleast 1room state had happen\n        HMSLogger.d(this.TAG, `PEER_LIST event`, JSON.stringify(peerList, null, 2));\n        this.handleInitialPeerList(peerList);\n      }\n    } else if (method === HMSNotificationMethod.ROOM_STATE) {\n      const roomState = notification as PeriodicRoomState;\n      this.handlePreviewRoomState(roomState);\n    }\n  }\n\n  private handleInitialPeerList = (peerList: PeerListNotification) => {\n    const peers = Object.values(peerList.peers);\n    this.peerManager.handlePeerList(peers);\n  };\n\n  private handleReconnectPeerList = (peerList: PeerListNotification) => {\n    this.handleRepeatedPeerList(peerList.peers);\n  };\n\n  private handlePreviewRoomState = (roomState: PeriodicRoomState) => {\n    if (!this.store.hasRoleDetailsArrived()) {\n      // we can't process the peers yet we don't know enough about them(role info)\n      return;\n    }\n    const roomPeers = roomState.peers;\n    if (roomPeers === null || roomPeers === undefined) {\n      // in this case, room state doesn't say anything about the peers,\n      // there can be optimisations in place to not send this field when it's unchanged from previously sent value.\n      // If there are no peers either roomState.peers will be empty object\n      // or peer_count will be 0(handled below)\n      if (roomState.peer_count === 0) {\n        this.handleRepeatedPeerList({});\n      }\n      return;\n    }\n    // we don't get tracks inside the peer object in room state, we're adding\n    // an empty value here so rest of the code flow can ignore this change, the below\n    // can be changed when tracks will be sent as a separate object in future\n    Object.keys(roomPeers).forEach(peer => {\n      roomPeers[peer].tracks = {};\n      roomPeers[peer].is_from_room_state = true;\n    });\n    this.handleRepeatedPeerList(roomPeers);\n  };\n\n  private handleRepeatedPeerList = (peersMap: Record<string, PeerNotification>) => {\n    const currentPeerList = this.store.getRemotePeers();\n    const peers = Object.values(peersMap);\n    const peersToRemove = currentPeerList.filter(hmsPeer => !peersMap[hmsPeer.peerId]);\n    if (peersToRemove.length > 0) {\n      HMSLogger.d(this.TAG, `${peersToRemove}`);\n    }\n\n    // Send peer-leave updates to all the missing peers\n    peersToRemove.forEach(peer => {\n      const peerNotification: PeerNotification = {\n        peer_id: peer.peerId,\n        role: peer.role?.name || '',\n        info: {\n          name: peer.name,\n          data: peer.metadata || '',\n          user_id: peer.customerUserId || '',\n          type: peer.type,\n        },\n        tracks: {},\n        groups: [],\n        realtime: peer.realtime,\n      };\n\n      this.peerManager.handlePeerLeave(peerNotification);\n    });\n\n    const peerList: PeerNotification[] = [];\n    // Check for any tracks which are added/removed\n    peers.forEach(newPeerNotification => {\n      const oldPeer = this.store.getPeerById(newPeerNotification.peer_id);\n      const newPeerTrackStates = Object.values(newPeerNotification.tracks);\n\n      if (oldPeer) {\n        // Peer already present in room, we take diff between the tracks\n        const tracks = this.store.getPeerTracks(oldPeer.peerId);\n\n        // Remove all the tracks which are not present in the peer.tracks\n        tracks.forEach(track => {\n          if (!newPeerNotification.tracks[track.trackId]) {\n            this.removePeerTrack(oldPeer, track.trackId);\n            this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_REMOVED, track, oldPeer);\n          }\n        });\n\n        // Add track-metadata for all the new tracks\n        newPeerTrackStates.forEach(trackData => {\n          if (!this.store.getTrackById(trackData.track_id)) {\n            // NOTE: We assume that, once the connection is re-established,\n            //  transport layer will send a native onTrackAdd\n            this.store.setTrackState({\n              peerId: oldPeer.peerId,\n              trackInfo: trackData,\n            });\n          }\n        });\n\n        // Handle RTC track add and track state change.\n        this.trackManager.handleTrackUpdate(\n          {\n            peer: newPeerNotification,\n            tracks: newPeerNotification.tracks,\n          },\n          false,\n        );\n\n        // Update peer's role locally, new role is received from the reconnect peer-list\n        this.peerManager.handlePeerUpdate(newPeerNotification);\n        peerList.push(newPeerNotification);\n      } else {\n        // New peer joined while reconnecting\n        peerList.push(newPeerNotification);\n      }\n    });\n    if (peerList.length > 0) {\n      this.peerManager.handlePeerList(peerList);\n    }\n  };\n\n  private removePeerTrack(peer: HMSPeer, trackId: string) {\n    HMSLogger.d(this.TAG, `removing track - ${trackId} from ${peer}`);\n    if (peer.audioTrack?.trackId === trackId) {\n      peer.audioTrack = undefined;\n    } else if (peer.videoTrack?.trackId === trackId) {\n      peer.videoTrack = undefined;\n    } else {\n      const trackIndex = peer.auxiliaryTracks.findIndex(track => track.trackId === trackId);\n      trackIndex >= 0 && peer.auxiliaryTracks.splice(trackIndex, 1);\n    }\n  }\n}\n", "export const convertDateNumToDate = (dateNum?: number): Date | undefined => {\n  return dateNum ? new Date(dateNum) : undefined;\n};\n", "import { TrackManager } from './TrackManager';\nimport { createRemotePeer } from './utils';\nimport { HMSPeerUpdate, HMSTrackUpdate, HMSUpdateListener } from '../../interfaces';\nimport { HMSRemoteVideoTrack } from '../../media/tracks';\nimport { HMSPeer, HMSRemotePeer } from '../../sdk/models/peer';\nimport { Store } from '../../sdk/store';\nimport { HAND_RAISE_GROUP_NAME } from '../../utils/constants';\nimport { convertDateNumToDate } from '../../utils/date';\nimport HMSLogger from '../../utils/logger';\nimport { HMSNotificationMethod } from '../HMSNotificationMethod';\nimport { PeerNotification } from '../HMSNotifications';\n\n/**\n * Handles:\n * - New peer join\n * - Peer Leave\n * - Role update for peer\n *\n * Notes:\n * - Peer join comes with track meta-data,\n * we add it to the store and call TrackManager to process it when RTC Track comes in.\n */\nexport class PeerManager {\n  private readonly TAG = '[PeerManager]';\n  constructor(private store: Store, private trackManager: TrackManager, public listener?: HMSUpdateListener) {}\n\n  handleNotification(method: string, notification: any) {\n    switch (method) {\n      case HMSNotificationMethod.PEER_JOIN: {\n        const peer = notification as PeerNotification;\n        this.handlePeerJoin(peer);\n        break;\n      }\n\n      case HMSNotificationMethod.PEER_LEAVE: {\n        const peer = notification as PeerNotification;\n        this.handlePeerLeave(peer);\n        break;\n      }\n      case HMSNotificationMethod.PEER_UPDATE:\n        this.handlePeerUpdate(notification as PeerNotification);\n        break;\n      default:\n        break;\n    }\n  }\n\n  handlePeerList = (peers: PeerNotification[]) => {\n    if (peers.length === 0) {\n      this.listener?.onPeerUpdate(HMSPeerUpdate.PEER_LIST, []);\n      return;\n    }\n    const hmsPeers: HMSRemotePeer[] = [];\n    const newPeers = new Set(peers.map(peer => peer.peer_id));\n    this.store.getRemotePeers().forEach(({ peerId, fromRoomState }) => {\n      /**\n       * Remove only if the peer join happened from preview roomstate update. This will prevent the peer joined\n       * from peer-join event post join from being removed from the store.\n       */\n      if (!newPeers.has(peerId) && fromRoomState) {\n        this.store.removePeer(peerId);\n      }\n    });\n    for (const peer of peers) {\n      hmsPeers.push(this.makePeer(peer));\n    }\n    this.listener?.onPeerUpdate(HMSPeerUpdate.PEER_LIST, hmsPeers);\n    this.trackManager.processPendingTracks();\n  };\n\n  handlePeerJoin = (peer: PeerNotification) => {\n    const hmsPeer = this.makePeer(peer);\n\n    this.listener?.onPeerUpdate(HMSPeerUpdate.PEER_JOINED, hmsPeer);\n    this.trackManager.processPendingTracks();\n  };\n\n  handlePeerLeave = (peer: PeerNotification) => {\n    const hmsPeer = this.store.getPeerById(peer.peer_id);\n    this.store.removePeer(peer.peer_id);\n    HMSLogger.d(this.TAG, `PEER_LEAVE`, peer.peer_id, `remainingPeers=${this.store.getPeers().length}`);\n\n    if (!hmsPeer) {\n      return;\n    }\n\n    if (hmsPeer.audioTrack) {\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_REMOVED, hmsPeer.audioTrack, hmsPeer);\n    }\n\n    if (hmsPeer.videoTrack) {\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_REMOVED, hmsPeer.videoTrack, hmsPeer);\n    }\n\n    hmsPeer.auxiliaryTracks?.forEach(track => {\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_REMOVED, track, hmsPeer);\n    });\n\n    this.listener?.onPeerUpdate(HMSPeerUpdate.PEER_LEFT, hmsPeer);\n  };\n\n  // eslint-disable-next-line complexity\n  handlePeerUpdate(notification: PeerNotification) {\n    let peer = this.store.getPeerById(notification.peer_id);\n    if (!peer && notification.realtime) {\n      // create peer if not already created in store\n      peer = this.makePeer(notification);\n      this.listener?.onPeerUpdate(\n        peer.isHandRaised ? HMSPeerUpdate.HAND_RAISE_CHANGED : HMSPeerUpdate.PEER_ADDED,\n        peer,\n      );\n      return;\n    }\n\n    // if peer is present but not realtime now, remove it from store\n    if (peer && !peer.isLocal && !notification.realtime) {\n      this.store.removePeer(peer.peerId);\n      this.listener?.onPeerUpdate(HMSPeerUpdate.PEER_REMOVED, peer);\n      return;\n    }\n\n    if (!peer) {\n      HMSLogger.d(this.TAG, `peer ${notification.peer_id} not found`);\n      return;\n    }\n\n    if (peer.role && peer.role.name !== notification.role) {\n      const newRole = this.store.getPolicyForRole(notification.role);\n      peer.updateRole(newRole);\n      this.updateSimulcastLayersForPeer(peer);\n      this.listener?.onPeerUpdate(HMSPeerUpdate.ROLE_UPDATED, peer);\n    }\n    const wasHandRaised = peer.isHandRaised;\n    peer.updateGroups(notification.groups);\n    const isHandRaised = notification.groups?.includes(HAND_RAISE_GROUP_NAME);\n    if (wasHandRaised !== isHandRaised) {\n      this.listener?.onPeerUpdate(HMSPeerUpdate.HAND_RAISE_CHANGED, peer);\n    }\n    this.handlePeerInfoUpdate({ peer, ...notification.info });\n  }\n\n  handlePeerInfoUpdate({ peer, name, data }: { peer?: HMSPeer; name?: string; data?: string }) {\n    if (!peer) {\n      return;\n    }\n    if (name && peer.name !== name) {\n      peer.updateName(name);\n      this.listener?.onPeerUpdate(HMSPeerUpdate.NAME_UPDATED, peer);\n    }\n    if (data && peer.metadata !== data) {\n      peer.updateMetadata(data);\n      this.listener?.onPeerUpdate(HMSPeerUpdate.METADATA_UPDATED, peer);\n    }\n  }\n\n  private makePeer(peer: PeerNotification) {\n    let hmsPeer = this.store.getPeerById(peer.peer_id) as HMSRemotePeer;\n    if (!hmsPeer) {\n      hmsPeer = createRemotePeer(peer, this.store);\n      hmsPeer.realtime = peer.realtime;\n      hmsPeer.joinedAt = convertDateNumToDate(peer.joined_at);\n      hmsPeer.fromRoomState = !!peer.is_from_room_state;\n      this.store.addPeer(hmsPeer);\n      HMSLogger.d(this.TAG, `adding to the peerList`, `${hmsPeer}`);\n    }\n\n    for (const trackId in peer.tracks) {\n      const trackInfo = peer.tracks[trackId];\n      this.store.setTrackState({\n        peerId: peer.peer_id,\n        trackInfo,\n      });\n      if (trackInfo.type === 'video') {\n        this.trackManager.processTrackInfo(trackInfo, peer.peer_id, false);\n      }\n    }\n    return hmsPeer;\n  }\n\n  private updateSimulcastLayersForPeer(peer: HMSPeer) {\n    this.store.getPeerTracks(peer.peerId).forEach(track => {\n      if (track.type === 'video' && ['regular', 'screen'].includes(track.source!)) {\n        const remoteTrack = track as HMSRemoteVideoTrack;\n        const simulcastDefinitions = this.store.getSimulcastDefinitionsForPeer(peer, remoteTrack.source!);\n        remoteTrack.setSimulcastDefinitons(simulcastDefinitions);\n      }\n    });\n  }\n}\n", "import { EventBus } from '../../events/EventBus';\nimport { Store } from '../../sdk/store';\nimport HMSLogger from '../../utils/logger';\nimport { PolicyParams } from '../HMSNotifications';\n\n/**\n * Handles:\n * - Set policy with publishParams, simulcast layers to store\n * - Emit 'local-peer-role-update' to trigger RoleChangeManager to publish/unpublish local tracks\n * - Emit 'policy-change' to finish preview before calling listener.onPreview\n */\nexport class PolicyChangeManager {\n  constructor(private store: Store, private eventBus: EventBus) {}\n\n  handlePolicyChange(params: PolicyParams) {\n    const localPeer = this.store.getLocalPeer();\n\n    if (localPeer && !localPeer.role) {\n      const newRole = params.known_roles[params.name];\n      localPeer.updateRole(newRole);\n    }\n\n    this.store.setKnownRoles(params);\n    const room = this.store.getRoom();\n    if (room) {\n      room.templateId = params.template_id;\n    } else {\n      HMSLogger.w('[PolicyChangeManager]', 'on policy change - room not present');\n    }\n    // handle when role is not present in known_roles\n    // const publishParams = params.known_roles[params.name]?.publishParams;\n    // this.store.setPublishParams(publishParams);\n\n    this.updateLocalPeerRole(params);\n    this.eventBus.policyChange.publish(params);\n  }\n\n  private updateLocalPeerRole(params: PolicyParams) {\n    const localPeer = this.store.getLocalPeer();\n    if (localPeer?.role && localPeer.role.name !== params.name) {\n      const newRole = this.store.getPolicyForRole(params.name);\n      const oldRole = localPeer.role;\n      localPeer.updateRole(newRole);\n      if (newRole.name === localPeer.asRole?.name) {\n        delete localPeer.asRole;\n      }\n      this.eventBus.localRoleUpdate.publish({ oldRole, newRole });\n    }\n  }\n}\n", "import { WHITEBOARD_ORIGIN, WHITEBOARD_QA_ORIGIN } from './constants';\nimport { ENV } from './support';\n\nexport const constructWhiteboardURL = (token: string, addr: string, env?: ENV) => {\n  const origin = env === ENV.QA ? WHITEBOARD_QA_ORIGIN : WHITEBOARD_ORIGIN;\n\n  const url = new URL(origin);\n  url.searchParams.set('endpoint', `https://${addr}`);\n  url.searchParams.set('token', token);\n\n  return url.toString();\n};\n", "import { HMSWhiteboard, InteractivityListener } from '../../interfaces';\nimport { HMSWhiteboardInteractivityCenter } from '../../interfaces/session-store/interactivity-center';\nimport { Store } from '../../sdk/store';\nimport { InitFlags } from '../../signal/init/models';\nimport { HMSWhiteboardCreateOptions } from '../../signal/interfaces';\nimport HMSTransport from '../../transport';\nimport HMSLogger from '../../utils/logger';\nimport { constructWhiteboardURL } from '../../utils/whiteboard';\n\nexport class WhiteboardInteractivityCenter implements HMSWhiteboardInteractivityCenter {\n  private TAG = '[HMSWhiteboardInteractivityCenter]';\n  constructor(\n    private readonly transport: HMSTransport,\n    private store: Store,\n    private listener?: InteractivityListener,\n  ) {}\n\n  // @TODO: remove when whiteboard released for general audience\n  get isEnabled() {\n    return this.transport.isFlagEnabled(InitFlags.FLAG_WHITEBOARD_ENABLED);\n  }\n\n  async open(createOptions?: HMSWhiteboardCreateOptions) {\n    if (!this.isEnabled) {\n      return HMSLogger.w(this.TAG, 'Whiteboard is not enabled for customer');\n    }\n    const prevWhiteboard = this.store.getWhiteboard(createOptions?.id);\n    let id = prevWhiteboard?.id;\n\n    if (!prevWhiteboard) {\n      const response = await this.transport.signal.createWhiteboard(this.getCreateOptionsWithDefaults(createOptions));\n      id = response.id;\n    }\n    if (!id) {\n      throw new Error(`Whiteboard ID: ${id} not found`);\n    }\n\n    const response = await this.transport.signal.getWhiteboard({ id });\n    const whiteboard: HMSWhiteboard = {\n      ...prevWhiteboard,\n      title: createOptions?.title,\n      attributes: createOptions?.attributes,\n      id: response.id,\n      url: constructWhiteboardURL(response.token, response.addr, this.store.getEnv()),\n      token: response.token,\n      addr: response.addr,\n      owner: response.owner,\n      permissions: response.permissions || [],\n      open: true,\n    };\n\n    this.store.setWhiteboard(whiteboard);\n    this.listener?.onWhiteboardUpdate(whiteboard);\n  }\n\n  async close(id?: string) {\n    if (!this.isEnabled) {\n      return HMSLogger.w(this.TAG, 'Whiteboard is not enabled for customer');\n    }\n\n    const prevWhiteboard = this.store.getWhiteboard(id);\n    if (!prevWhiteboard) {\n      throw new Error(`Whiteboard ID: ${id} not found`);\n    }\n    const whiteboard: HMSWhiteboard = { id: prevWhiteboard.id, title: prevWhiteboard.title, open: false };\n\n    this.store.setWhiteboard(whiteboard);\n    this.listener?.onWhiteboardUpdate(whiteboard);\n  }\n\n  setListener(listener?: InteractivityListener) {\n    this.listener = listener;\n  }\n\n  async handleLocalRoleUpdate() {\n    const whiteboards = this.store.getWhiteboards();\n\n    for (const whiteboard of whiteboards.values()) {\n      if (whiteboard.url) {\n        const response = await this.transport.signal.getWhiteboard({ id: whiteboard.id });\n        const localPeer = this.store.getLocalPeer();\n        const isOwner = localPeer?.customerUserId === response.owner;\n        const open = isOwner\n          ? localPeer.role?.permissions.whiteboard?.includes('admin')\n          : response.permissions.length > 0;\n        const newWhiteboard: HMSWhiteboard = {\n          ...whiteboard,\n          id: response.id,\n          url: constructWhiteboardURL(response.token, response.addr, this.store.getEnv()),\n          token: response.token,\n          addr: response.addr,\n          owner: response.owner,\n          permissions: response.permissions,\n          open,\n        };\n\n        this.store.setWhiteboard(newWhiteboard);\n        this.listener?.onWhiteboardUpdate(newWhiteboard);\n      }\n    }\n  }\n\n  private getCreateOptionsWithDefaults(createOptions?: HMSWhiteboardCreateOptions): HMSWhiteboardCreateOptions {\n    const roles = Object.values(this.store.getKnownRoles());\n    const reader: Array<string> = [];\n    const writer: Array<string> = [];\n    const admin: Array<string> = [];\n\n    roles.forEach(role => {\n      if (role.permissions.whiteboard?.includes('read')) {\n        reader.push(role.name);\n      }\n      if (role.permissions.whiteboard?.includes('write')) {\n        writer.push(role.name);\n      }\n      if (role.permissions.whiteboard?.includes('admin')) {\n        admin.push(role.name);\n      }\n    });\n\n    return {\n      title: createOptions?.title || `${this.store.getRoom()?.id} Whiteboard`,\n      reader: createOptions?.reader || reader,\n      writer: createOptions?.writer || writer,\n      admin: createOptions?.admin || admin,\n    };\n  }\n}\n", "import { WhiteboardInteractivityCenter } from './HMSWhiteboardCenter';\nimport {\n  HMSInteractivityCenter,\n  HMSPollQuestionCreateParams,\n  HMSPollsUpdate,\n  InteractivityListener,\n} from '../../interfaces';\nimport {\n  HMSPoll,\n  HMSPollCreateParams,\n  HMSPollQuestionAnswer,\n  HMSPollQuestionOption,\n  HMSPollQuestionResponse,\n  HMSPollQuestionResponseCreateParams,\n  HMSPollQuestionType,\n  HMSPollStates,\n  HMSPollUserTrackingMode,\n  HMSQuizLeaderboardResponse,\n} from '../../interfaces/session-store/polls';\nimport { Store } from '../../sdk/store';\nimport { PollInfoParams, PollQuestionParams, PollResponseParams } from '../../signal/interfaces';\nimport HMSTransport from '../../transport';\nimport { convertDateNumToDate } from '../../utils/date';\n\nexport class InteractivityCenter implements HMSInteractivityCenter {\n  whiteboard: WhiteboardInteractivityCenter;\n  constructor(private transport: HMSTransport, private store: Store, private listener?: InteractivityListener) {\n    this.whiteboard = new WhiteboardInteractivityCenter(transport, store, listener);\n  }\n\n  setListener(listener?: InteractivityListener) {\n    this.listener = listener;\n    this.whiteboard.setListener(listener);\n  }\n\n  async createPoll(pollParams: HMSPollCreateParams) {\n    const HMS_USER_TRACKING_MODE_MAP: Record<HMSPollUserTrackingMode, string> = {\n      customerID: 'userid',\n      peerID: 'peerid',\n      userName: 'username',\n    };\n\n    const { poll_id: serverPollID } = await this.transport.signal.setPollInfo({\n      ...pollParams,\n      mode: pollParams.mode ? HMS_USER_TRACKING_MODE_MAP[pollParams.mode] : undefined,\n      poll_id: pollParams.id,\n      vote: pollParams.rolesThatCanVote,\n      responses: pollParams.rolesThatCanViewResponses,\n    });\n\n    if (!pollParams.id) {\n      pollParams.id = serverPollID;\n    }\n\n    if (Array.isArray(pollParams.questions)) {\n      await this.addQuestionsToPoll(pollParams.id, pollParams.questions);\n    }\n\n    const questions = await this.transport.signal.getPollQuestions({ poll_id: pollParams.id, index: 0, count: 50 });\n\n    const poll = createHMSPollFromPollParams({\n      ...pollParams,\n      poll_id: pollParams.id,\n      state: 'created',\n      created_by: this.store.getLocalPeer()?.peerId,\n    });\n\n    poll.questions = questions.questions.map(({ question, options, answer }) => ({ ...question, options, answer }));\n    this.listener?.onPollsUpdate(HMSPollsUpdate.POLL_CREATED, [poll]);\n  }\n\n  async startPoll(poll: string | HMSPollCreateParams): Promise<void> {\n    if (typeof poll === 'string') {\n      await this.transport.signal.startPoll({ poll_id: poll });\n    } else {\n      await this.createPoll(poll);\n      await this.transport.signal.startPoll({ poll_id: poll.id });\n    }\n  }\n\n  async addQuestionsToPoll(pollID: string, questions: HMSPollQuestionCreateParams[]): Promise<void> {\n    if (questions.length > 0) {\n      await this.transport.signal.setPollQuestions({\n        poll_id: pollID,\n        questions: questions.map((question, index) => this.createQuestionSetParams(question, index)),\n      });\n    }\n  }\n\n  async stopPoll(pollID: string): Promise<void> {\n    await this.transport.signal.stopPoll({ poll_id: pollID });\n  }\n\n  async addResponsesToPoll(pollID: string, responses: HMSPollQuestionResponseCreateParams[]) {\n    const poll = this.store.getPoll(pollID);\n    if (!poll) {\n      throw new Error('Invalid poll ID - Poll not found');\n    }\n    const responsesParams: PollResponseParams[] = responses.map(response => {\n      const question = this.getQuestionInPoll(poll, response.questionIndex);\n      if (question.type === HMSPollQuestionType.SINGLE_CHOICE) {\n        response.option = response.option || response.options?.[0] || -1;\n        delete response.text;\n        delete response.options;\n      } else if (question.type === HMSPollQuestionType.MULTIPLE_CHOICE) {\n        response.options?.sort();\n        delete response.text;\n        delete response.option;\n      } else {\n        delete response.option;\n        delete response.options;\n      }\n\n      if (response.skipped) {\n        delete response.option;\n        delete response.options;\n        delete response.text;\n      }\n\n      return { duration: 0, type: question.type, question: response.questionIndex, ...response };\n    });\n\n    await this.transport.signal.setPollResponses({ poll_id: pollID, responses: responsesParams });\n  }\n\n  async fetchLeaderboard(pollID: string, offset: number, count: number): Promise<HMSQuizLeaderboardResponse> {\n    const poll = this.store.getPoll(pollID);\n    if (!poll) {\n      throw new Error('Invalid poll ID - Poll not found');\n    }\n\n    const localPeerPermissions = this.store.getLocalPeer()?.role?.permissions;\n    const canViewSummary = !!(localPeerPermissions?.pollRead || localPeerPermissions?.pollWrite);\n\n    if (poll.anonymous || poll.state !== HMSPollStates.STOPPED || !canViewSummary) {\n      return { entries: [], hasNext: false };\n    }\n    const pollLeaderboard = await this.transport.signal.fetchPollLeaderboard({\n      poll_id: poll.id,\n      count,\n      offset,\n    });\n\n    const summary = {\n      avgScore: pollLeaderboard.avg_score,\n      avgTime: pollLeaderboard.avg_time,\n      votedUsers: pollLeaderboard.voted_users,\n      totalUsers: pollLeaderboard.total_users,\n      correctUsers: pollLeaderboard.correct_users,\n    };\n\n    const leaderboardEntries = pollLeaderboard.questions.map(question => {\n      return {\n        position: question.position,\n        totalResponses: question.total_responses,\n        correctResponses: question.correct_responses,\n        duration: question.duration,\n        peer: question.peer,\n        score: question.score,\n      };\n    });\n\n    return { entries: leaderboardEntries, hasNext: !pollLeaderboard.last, summary };\n  }\n\n  async getPollResponses(poll: HMSPoll, self: boolean) {\n    const serverResponseParams = await this.transport.signal.getPollResponses({\n      poll_id: poll.id,\n      index: 0,\n      count: 50,\n      self,\n    });\n    const pollCopy = JSON.parse(JSON.stringify(poll));\n    serverResponseParams.responses?.forEach(({ response, peer, final }) => {\n      const question = poll?.questions?.find(question => question.index === response.question);\n      if (question) {\n        const pollResponse: HMSPollQuestionResponse = {\n          id: response.response_id,\n          questionIndex: response.question,\n          option: response.option,\n          options: response.options,\n          text: response.text,\n          responseFinal: final,\n          peer: { peerid: peer.peerid, userHash: peer.hash, userid: peer.userid, username: peer.username },\n          skipped: response.skipped,\n          type: response.type,\n          update: response.update,\n        };\n        const existingResponses = question.responses && !self ? [...question.responses] : [];\n\n        if (pollCopy.questions?.[response.question - 1]) {\n          pollCopy.questions[response.question - 1].responses = [...existingResponses, pollResponse];\n        }\n      }\n    });\n    this.store.setPoll(pollCopy);\n    this.listener?.onPollsUpdate(HMSPollsUpdate.POLL_STATS_UPDATED, [pollCopy]);\n  }\n  async getPolls(): Promise<HMSPoll[]> {\n    const launchedPollsList = await this.transport.signal.getPollsList({ count: 50, state: 'started' });\n    const polls: HMSPoll[] = [];\n    const canViewAllPolls = this.store.getLocalPeer()?.role?.permissions.pollWrite;\n\n    let visiblePolls = [...launchedPollsList.polls];\n    if (canViewAllPolls) {\n      const draftPollsList = await this.transport.signal.getPollsList({ count: 50, state: 'created' });\n      const completedPollsList = await this.transport.signal.getPollsList({ count: 50, state: 'stopped' });\n      visiblePolls = [...draftPollsList.polls, ...visiblePolls, ...completedPollsList.polls];\n    }\n\n    for (const pollParams of visiblePolls) {\n      const questions = await this.transport.signal.getPollQuestions({\n        poll_id: pollParams.poll_id,\n        index: 0,\n        count: 50,\n      });\n      const poll = createHMSPollFromPollParams(pollParams);\n      const existingPoll = this.store.getPoll(pollParams.poll_id);\n      poll.questions = questions.questions.map(({ question, options, answer }, index) => ({\n        ...question,\n        options,\n        answer,\n        responses: existingPoll?.questions?.[index]?.responses,\n      }));\n      polls.push(poll);\n      this.store.setPoll(poll);\n    }\n\n    this.listener?.onPollsUpdate(HMSPollsUpdate.POLLS_LIST, polls);\n    return polls;\n  }\n\n  // eslint-disable-next-line complexity\n  private createQuestionSetParams(questionParams: HMSPollQuestionCreateParams, index: number): PollQuestionParams {\n    // early return if the question has been saved before in a draft\n    if (questionParams.index) {\n      const optionsWithIndex = questionParams.options?.map((option, index) => {\n        return { ...option, index: index + 1 };\n      });\n      return {\n        question: { ...questionParams, index: index + 1 },\n        options: optionsWithIndex,\n        answer: questionParams.answer,\n      };\n    }\n    const question: PollQuestionParams['question'] = { ...questionParams, index: index + 1 };\n    let options: HMSPollQuestionOption[] | undefined;\n    const answer: HMSPollQuestionAnswer = questionParams.answer || { hidden: false };\n\n    if (\n      Array.isArray(questionParams.options) &&\n      [HMSPollQuestionType.SINGLE_CHOICE, HMSPollQuestionType.MULTIPLE_CHOICE].includes(questionParams.type)\n    ) {\n      options = questionParams.options?.map((option, index) => ({\n        index: index + 1,\n        text: option.text,\n        weight: option.weight,\n      }));\n\n      if (questionParams.type === HMSPollQuestionType.SINGLE_CHOICE) {\n        answer.option = questionParams.options.findIndex(option => option.isCorrectAnswer) + 1 || undefined;\n      } else {\n        answer.options = questionParams.options\n          .map((option, index) => (option.isCorrectAnswer ? index + 1 : undefined))\n          .filter((val): val is number => !!val);\n      }\n    } else {\n      delete answer?.options;\n      delete answer?.option;\n    }\n\n    return { question, options, answer };\n  }\n\n  private getQuestionInPoll(poll: HMSPoll, questionIndex: number) {\n    const question = poll?.questions?.find(question => question.index === questionIndex);\n    if (!question) {\n      throw new Error('Invalid question index - Question not found in poll');\n    }\n\n    return question;\n  }\n}\n\nexport const createHMSPollFromPollParams = (pollParams: PollInfoParams): HMSPoll => {\n  const BIZ_USER_TRACKING_MODE_MAP: Record<string, HMSPollUserTrackingMode> = {\n    userid: 'customerID',\n    peerid: 'peerID',\n    username: 'userName',\n  };\n\n  return {\n    id: pollParams.poll_id,\n    title: pollParams.title,\n    startedBy: pollParams.started_by,\n    createdBy: pollParams.created_by,\n    anonymous: pollParams.anonymous,\n    type: pollParams.type,\n    duration: pollParams.duration,\n    locked: pollParams.locked, // poll is locked automatically when it starts\n    mode: pollParams.mode ? BIZ_USER_TRACKING_MODE_MAP[pollParams.mode] : undefined,\n    visibility: pollParams.visibility,\n    rolesThatCanVote: pollParams.vote || [],\n    rolesThatCanViewResponses: pollParams.responses || [],\n    state: pollParams.state,\n    stoppedBy: pollParams.stopped_by,\n    startedAt: convertDateNumToDate(pollParams.started_at),\n    stoppedAt: convertDateNumToDate(pollParams.stopped_at),\n    createdAt: convertDateNumToDate(pollParams.created_at),\n  };\n};\n", "import { HMSPoll, HMSPollQuestionResponse, HMSPollsUpdate, HMSUpdateListener } from '../../interfaces';\nimport { Store } from '../../sdk/store';\nimport { createHMSPollFromPollParams } from '../../session-store/interactivity-center/HMSInteractivityCenter';\nimport { PollResult } from '../../signal/interfaces';\nimport HMSTransport from '../../transport';\nimport { convertDateNumToDate } from '../../utils/date';\nimport { HMSNotificationMethod } from '../HMSNotificationMethod';\nimport { PollStartNotification, PollStatsNotification, PollStopNotification } from '../HMSNotifications';\n\nexport class PollsManager {\n  constructor(private store: Store, private transport: HMSTransport, public listener?: HMSUpdateListener) {}\n\n  handleNotification(method: string, notification: any) {\n    switch (method) {\n      case HMSNotificationMethod.POLL_START: {\n        this.handlePollStart(notification as PollStartNotification);\n        break;\n      }\n\n      case HMSNotificationMethod.POLL_STOP: {\n        this.handlePollStop(notification as PollStopNotification);\n        break;\n      }\n      case HMSNotificationMethod.POLL_STATS:\n        this.handlePollStats(notification as PollStatsNotification);\n\n        break;\n      default:\n        break;\n    }\n  }\n\n  private async handlePollStart(notification: PollStartNotification) {\n    const polls: HMSPoll[] = [];\n\n    for (const pollParams of notification.polls) {\n      const pollInStore = this.store.getPoll(pollParams.poll_id);\n\n      if (pollInStore && pollInStore.state === 'started') {\n        this.listener?.onPollsUpdate(HMSPollsUpdate.POLL_STARTED, [pollInStore]);\n        return;\n      }\n\n      const questions = await this.transport.signal.getPollQuestions({\n        poll_id: pollParams.poll_id,\n        index: 0,\n        count: 50,\n      });\n\n      const poll = createHMSPollFromPollParams(pollParams);\n      poll.questions = questions.questions.map(({ question, options, answer }) => ({ ...question, options, answer }));\n\n      await this.updatePollResponses(poll, true);\n\n      polls.push(poll);\n      this.store.setPoll(poll);\n    }\n    this.listener?.onPollsUpdate(HMSPollsUpdate.POLL_STARTED, polls);\n  }\n\n  private async handlePollStop(notification: PollStopNotification) {\n    const stoppedPolls: HMSPoll[] = [];\n\n    for (const poll of notification.polls) {\n      const savedPoll = this.store.getPoll(poll.poll_id);\n      if (savedPoll) {\n        savedPoll.state = 'stopped';\n        savedPoll.stoppedAt = convertDateNumToDate(poll.stopped_at);\n        savedPoll.stoppedBy = poll.stopped_by;\n\n        const pollResult = await this.transport.signal.getPollResult({ poll_id: poll.poll_id });\n        this.updatePollResult(savedPoll, pollResult);\n        stoppedPolls.push(savedPoll);\n      }\n    }\n\n    if (stoppedPolls.length > 0) {\n      this.listener?.onPollsUpdate(HMSPollsUpdate.POLL_STOPPED, stoppedPolls);\n    }\n  }\n\n  private async handlePollStats(notification: PollStatsNotification) {\n    const updatedPolls: HMSPoll[] = [];\n    for (const updatedPoll of notification.polls) {\n      const savedPoll = this.store.getPoll(updatedPoll.poll_id);\n      if (!savedPoll) {\n        return;\n      }\n\n      this.updatePollResult(savedPoll, updatedPoll);\n      updatedPolls.push(savedPoll);\n    }\n\n    if (updatedPolls.length > 0) {\n      this.listener?.onPollsUpdate(HMSPollsUpdate.POLL_STATS_UPDATED, updatedPolls);\n    }\n  }\n\n  private updatePollResult(savedPoll: HMSPoll, pollResult: PollResult) {\n    savedPoll.result = { ...savedPoll.result };\n    savedPoll.result.totalUsers = pollResult.user_count;\n    savedPoll.result.maxUsers = pollResult.max_user;\n    savedPoll.result.totalResponses = pollResult.total_response;\n\n    pollResult.questions?.forEach(updatedQuestion => {\n      const savedQuestion = savedPoll.questions?.find(question => question.index === updatedQuestion.question);\n      if (!savedQuestion) {\n        return;\n      }\n      savedQuestion.result = { ...savedQuestion.result };\n      savedQuestion.result.correctResponses = updatedQuestion.correct;\n      savedQuestion.result.skippedCount = updatedQuestion.skipped;\n      savedQuestion.result.totalResponses = updatedQuestion.total;\n\n      updatedQuestion.options?.forEach((updatedVoteCount, index) => {\n        const savedOption = savedQuestion.options?.[index];\n        if (savedOption && savedOption.voteCount !== updatedVoteCount) {\n          savedOption.voteCount = updatedVoteCount;\n        }\n      });\n    });\n  }\n\n  private async updatePollResponses(poll: HMSPoll, self: boolean) {\n    const serverResponseParams = await this.transport.signal.getPollResponses({\n      poll_id: poll.id,\n      index: 0,\n      count: 50,\n      self,\n    });\n\n    serverResponseParams.responses?.forEach(({ response, peer, final }) => {\n      const question = poll?.questions?.find(question => question.index === response.question);\n      if (!question) {\n        return;\n      }\n      const pollResponse: HMSPollQuestionResponse = {\n        id: response.response_id,\n        questionIndex: response.question,\n        option: response.option,\n        options: response.options,\n        text: response.text,\n        responseFinal: final,\n        peer: { peerid: peer.peerid, userHash: peer.hash, userid: peer.userid, username: peer.username },\n        skipped: response.skipped,\n        type: response.type,\n        update: response.update,\n      };\n\n      if (Array.isArray(question.responses) && question.responses.length > 0) {\n        if (!question.responses.find(({ id }) => id === pollResponse.id)) {\n          question.responses.push(pollResponse);\n        }\n      } else {\n        question.responses = [pollResponse];\n      }\n    });\n  }\n}\n", "import { HMSRemotePeer, HMSRoleChangeRequest, HMSUpdateListener } from '../../interfaces';\nimport { HMSLocalTrack, HMSTrackSource } from '../../media/tracks';\nimport { Store } from '../../sdk/store';\nimport { HMSNotificationMethod } from '../HMSNotificationMethod';\nimport {\n  ChangeTrackMuteStateNotification,\n  RoleChangeRequestParams,\n  TrackUpdateRequestNotification,\n} from '../HMSNotifications';\n\n/**\n * Handles request from remote peers to change something on the local side. For eg. role change, track mute/unmute.\n */\nexport class RequestManager {\n  constructor(private store: Store, public listener?: HMSUpdateListener) {}\n\n  handleNotification(method: string, notification: any) {\n    switch (method) {\n      case HMSNotificationMethod.ROLE_CHANGE_REQUEST:\n        this.handleRoleChangeRequest(notification as RoleChangeRequestParams);\n        break;\n\n      case HMSNotificationMethod.TRACK_UPDATE_REQUEST:\n        this.handleTrackUpdateRequest(notification as TrackUpdateRequestNotification);\n        break;\n\n      case HMSNotificationMethod.CHANGE_TRACK_MUTE_STATE_UPDATE:\n        this.handleChangeTrackStateRequest(notification as ChangeTrackMuteStateNotification);\n        break;\n      default:\n        return;\n    }\n  }\n\n  private handleRoleChangeRequest(notification: RoleChangeRequestParams) {\n    const request: HMSRoleChangeRequest = {\n      requestedBy: notification.requested_by\n        ? (this.store.getPeerById(notification.requested_by) as HMSRemotePeer)\n        : undefined,\n      role: this.store.getPolicyForRole(notification.role),\n      token: notification.token,\n    };\n\n    this.listener?.onRoleChangeRequest(request);\n  }\n\n  // eslint-disable-next-line complexity\n  private handleTrackUpdateRequest(trackUpdateRequest: TrackUpdateRequestNotification) {\n    const { requested_by, track_id, mute } = trackUpdateRequest;\n    const peer = requested_by ? this.store.getPeerById(requested_by) : undefined;\n    const track = this.store.getLocalPeerTracks().find(track => track.publishedTrackId === track_id);\n\n    if (!track) {\n      return;\n    }\n\n    const sendNotification = () => {\n      this.listener?.onChangeTrackStateRequest({ requestedBy: peer as HMSRemotePeer, track, enabled: !mute });\n    };\n\n    if (mute) {\n      // if track is already in the same state as change state, do nothing\n      if (track.enabled === !mute) {\n        return;\n      }\n      /**\n       * Directly mute track when request arrives\n       */\n      track.setEnabled(!mute).then(sendNotification);\n    } else {\n      /**\n       * Notify UI to unmute for requesting consent\n       */\n      sendNotification();\n    }\n  }\n\n  private handleChangeTrackStateRequest(request: ChangeTrackMuteStateNotification) {\n    const { type, source, value, requested_by } = request;\n    const peer = requested_by ? this.store.getPeerById(requested_by) : undefined;\n\n    // value true means the track has to be muted\n    const enabled = !value;\n    const tracksToBeUpdated = this.getTracksToBeUpdated({ type, source, enabled });\n    //Do nothing if all tracks are already in same state as the request\n    if (tracksToBeUpdated.length === 0) {\n      return;\n    }\n    // if track is to be muted, mute and send the notification, otherwise send notification\n    if (!enabled) {\n      const promises: Promise<void>[] = [];\n\n      for (const track of tracksToBeUpdated) {\n        promises.push(track.setEnabled(false));\n      }\n      Promise.all(promises).then(() => {\n        this.listener?.onChangeMultiTrackStateRequest({\n          requestedBy: peer as HMSRemotePeer,\n          tracks: tracksToBeUpdated,\n          enabled: false,\n        });\n      });\n    } else {\n      this.listener?.onChangeMultiTrackStateRequest({\n        requestedBy: peer as HMSRemotePeer,\n        tracks: tracksToBeUpdated,\n        type,\n        source,\n        enabled: true,\n      });\n    }\n  }\n\n  /**\n   * Filter the local tracks based on type, source and enabled state\n   * @returns {HMSLocalTrack[]}\n   */\n  private getTracksToBeUpdated({\n    type,\n    source,\n    enabled,\n  }: {\n    type?: 'audio' | 'video';\n    source?: HMSTrackSource;\n    enabled: boolean;\n  }) {\n    const localPeerTracks = this.store.getLocalPeerTracks();\n    let tracks: HMSLocalTrack[] = localPeerTracks;\n    if (type) {\n      tracks = tracks.filter(track => track.type === type);\n    }\n    if (source) {\n      tracks = tracks.filter(track => track.source === source);\n    }\n    // filter out tracks which are already in the desired state\n    return tracks.filter(track => track.enabled !== enabled);\n  }\n}\n", "import { HMSAction } from '../../error/HMSAction';\nimport { HMSException } from '../../error/HMSException';\nimport {\n  HLSVariant,\n  HMSBrowserRecording,\n  HMSHLS,\n  HMSHLSRecording,\n  HMSRoomUpdate,\n  HMSSFURecording,\n  HMSTranscriptionInfo,\n  HMSUpdateListener,\n} from '../../interfaces';\nimport { ServerError } from '../../interfaces/internal';\nimport { Store } from '../../sdk/store';\nimport { convertDateNumToDate } from '../../utils/date';\nimport HMSLogger from '../../utils/logger';\nimport { HMSNotificationMethod } from '../HMSNotificationMethod';\nimport {\n  HLSNotification,\n  HMSRecordingState,\n  HMSStreamingState,\n  PeerListNotification,\n  PeriodicRoomState,\n  RecordingNotification,\n  RecordingNotificationType,\n  RoomInfo,\n  RoomState,\n  RTMPNotification,\n  SessionInfo,\n  TranscriptionNotification,\n} from '../HMSNotifications';\n\nexport class RoomUpdateManager {\n  private readonly TAG = '[RoomUpdateManager]';\n\n  constructor(private store: Store, public listener?: HMSUpdateListener) {}\n\n  // eslint-disable-next-line complexity\n  handleNotification(method: HMSNotificationMethod, notification: any) {\n    switch (method) {\n      case HMSNotificationMethod.PEER_LIST:\n        this.onRoomState((notification as PeerListNotification).room);\n        break;\n      case HMSNotificationMethod.RTMP_UPDATE:\n        this.updateRTMPStatus(notification as RTMPNotification);\n        break;\n      case HMSNotificationMethod.RECORDING_UPDATE:\n        this.updateRecordingStatus(notification as RecordingNotification);\n        break;\n      case HMSNotificationMethod.ROOM_STATE:\n        this.handlePreviewRoomState(notification as PeriodicRoomState);\n        break;\n      case HMSNotificationMethod.ROOM_INFO:\n        this.handleRoomInfo(notification as RoomInfo);\n        break;\n      case HMSNotificationMethod.SESSION_INFO:\n        this.handleSessionInfo(notification as SessionInfo);\n        break;\n      case HMSNotificationMethod.HLS_UPDATE:\n        this.updateHLSStatus(notification as HLSNotification);\n        break;\n      case HMSNotificationMethod.TRANSCRIPTION_UPDATE:\n        this.handleTranscriptionStatus([notification as TranscriptionNotification]);\n        break;\n      default:\n        break;\n    }\n  }\n\n  private handleRoomInfo(notification: RoomInfo) {\n    const room = this.store.getRoom();\n    if (!room) {\n      HMSLogger.w(this.TAG, 'on session info - room not present');\n      return;\n    }\n    room.description = notification.description;\n    room.large_room_optimization = notification.large_room_optimization;\n    room.max_size = notification.max_size;\n    room.name = notification.name;\n  }\n\n  private handleSessionInfo(notification: SessionInfo) {\n    const room = this.store.getRoom();\n    if (!room) {\n      HMSLogger.w(this.TAG, 'on session info - room not present');\n      return;\n    }\n    room.sessionId = notification.session_id;\n    if (room.peerCount !== notification.peer_count) {\n      room.peerCount = notification.peer_count;\n      this.listener?.onRoomUpdate(HMSRoomUpdate.ROOM_PEER_COUNT_UPDATED, room);\n    }\n  }\n\n  private handlePreviewRoomState(notification: PeriodicRoomState) {\n    const { room } = notification;\n    this.onRoomState(room);\n  }\n\n  private onRoomState(roomNotification: RoomState) {\n    const { recording, streaming, transcriptions, session_id, started_at, name } = roomNotification;\n    const room = this.store.getRoom();\n    if (!room) {\n      HMSLogger.w(this.TAG, 'on room state - room not present');\n      return;\n    }\n\n    room.name = name;\n\n    room.rtmp.running = this.isStreamingRunning(streaming?.rtmp?.state);\n    room.rtmp.startedAt = convertDateNumToDate(streaming?.rtmp?.started_at);\n    room.rtmp.state = streaming?.rtmp?.state;\n\n    room.recording.server = this.getPeerListSFURecording(recording);\n    room.recording.browser = this.getPeerListBrowserRecording(recording);\n    room.recording.hls = this.getPeerListHLSRecording(recording);\n\n    room.hls = this.convertHls(streaming?.hls);\n\n    room.transcriptions = this.addTranscriptionDetail(transcriptions);\n\n    room.sessionId = session_id;\n    room.startedAt = convertDateNumToDate(started_at);\n    this.listener?.onRoomUpdate(HMSRoomUpdate.RECORDING_STATE_UPDATED, room);\n  }\n\n  private addTranscriptionDetail(transcriptions?: TranscriptionNotification[]): HMSTranscriptionInfo[] {\n    if (!transcriptions) {\n      return [];\n    }\n    return transcriptions.map((transcription: TranscriptionNotification) => {\n      return {\n        state: transcription.state,\n        mode: transcription.mode,\n        initialised_at: convertDateNumToDate(transcription.initialised_at),\n        started_at: convertDateNumToDate(transcription.started_at),\n        stopped_at: convertDateNumToDate(transcription.stopped_at),\n        updated_at: convertDateNumToDate(transcription.updated_at),\n        error: this.toSdkError(transcription?.error),\n      };\n    });\n  }\n  private isRecordingRunning(state?: HMSRecordingState): boolean {\n    if (!state) {\n      return false;\n    }\n    return ![\n      HMSRecordingState.NONE,\n      HMSRecordingState.PAUSED,\n      HMSRecordingState.STOPPED,\n      HMSRecordingState.FAILED,\n    ].includes(state);\n  }\n\n  private isStreamingRunning(state?: HMSStreamingState): boolean {\n    if (!state) {\n      return false;\n    }\n    return ![HMSStreamingState.NONE, HMSStreamingState.STOPPED, HMSStreamingState.FAILED].includes(state);\n  }\n\n  private initHLS(notification?: HLSNotification): HMSHLS {\n    const room = this.store.getRoom();\n    const hls: HMSHLS = {\n      running: true,\n      variants: [],\n    };\n    if (!room) {\n      HMSLogger.w(this.TAG, 'on hls - room not present');\n      return hls;\n    }\n    if (!notification?.variants) {\n      return hls;\n    }\n    notification.variants.forEach((variant: HLSVariant, index: number) => {\n      if (variant.state !== HMSStreamingState.INITIALISED) {\n        hls.variants.push({\n          meetingURL: variant?.meetingURL,\n          url: variant?.url,\n          metadata: variant?.metadata,\n          playlist_type: variant?.playlist_type,\n          startedAt: convertDateNumToDate(notification?.variants?.[index].started_at),\n          initialisedAt: convertDateNumToDate(notification?.variants?.[index].initialised_at),\n          state: variant.state,\n          stream_type: variant?.stream_type,\n        });\n      } else {\n        hls.variants.push({\n          initialisedAt: convertDateNumToDate(notification?.variants?.[index].initialised_at),\n          url: '',\n        });\n      }\n    });\n    return hls;\n  }\n  private updateHLSStatus(notification: HLSNotification) {\n    const room = this.store.getRoom();\n    const running =\n      notification.variants && notification.variants.length > 0\n        ? notification.variants.some(variant => this.isStreamingRunning(variant.state))\n        : false;\n    if (!room) {\n      HMSLogger.w(this.TAG, 'on hls - room not present');\n      return;\n    }\n    notification.enabled = running;\n    room.hls = this.convertHls(notification);\n    this.listener?.onRoomUpdate(HMSRoomUpdate.HLS_STREAMING_STATE_UPDATED, room);\n  }\n\n  private handleTranscriptionStatus(notification: TranscriptionNotification[]) {\n    const room = this.store.getRoom();\n    if (!room) {\n      HMSLogger.w(this.TAG, 'on transcription - room not present');\n      return;\n    }\n    room.transcriptions = this.addTranscriptionDetail(notification) || [];\n    this.listener?.onRoomUpdate(HMSRoomUpdate.TRANSCRIPTION_STATE_UPDATED, room);\n  }\n  private convertHls(hlsNotification?: HLSNotification) {\n    // only checking for zeroth variant intialized\n    const isInitialised =\n      hlsNotification?.variants && hlsNotification.variants.length > 0\n        ? hlsNotification.variants.some(variant => variant.state === HMSStreamingState.INITIALISED)\n        : false;\n    // handling for initialized state\n    if (isInitialised) {\n      return this.initHLS(hlsNotification);\n    }\n    const hls: HMSHLS = {\n      running: !!hlsNotification?.enabled,\n      variants: [],\n      error: this.toSdkError(hlsNotification?.error),\n    };\n    hlsNotification?.variants?.forEach(variant => {\n      hls.variants.push({\n        meetingURL: variant?.meeting_url,\n        url: variant?.url,\n        metadata: variant?.metadata,\n        playlist_type: variant?.playlist_type,\n        startedAt: convertDateNumToDate(variant?.started_at),\n        initialisedAt: convertDateNumToDate(variant?.initialised_at),\n        state: variant.state,\n        stream_type: variant?.stream_type,\n      });\n    });\n    return hls;\n  }\n\n  private getHLSRecording(hlsNotification?: RecordingNotification): HMSHLSRecording {\n    let hlsRecording: HMSHLSRecording = { running: false };\n    const running = this.isRecordingRunning(hlsNotification?.state);\n    if (running || hlsNotification?.state === HMSRecordingState.PAUSED) {\n      hlsRecording = {\n        running,\n        singleFilePerLayer: !!hlsNotification?.hls_recording?.single_file_per_layer,\n        hlsVod: !!hlsNotification?.hls_recording?.hls_vod,\n        startedAt: convertDateNumToDate(hlsNotification?.started_at),\n        initialisedAt: convertDateNumToDate(hlsNotification?.initialised_at),\n        state: hlsNotification?.state,\n        error: this.toSdkError(hlsNotification?.error),\n      };\n    }\n    return hlsRecording;\n  }\n\n  private getPeerListHLSRecording(recording?: RoomState['recording']): HMSHLSRecording {\n    const hlsNotification = recording?.hls;\n    const running = this.isRecordingRunning(hlsNotification?.state);\n    return {\n      running,\n      startedAt: convertDateNumToDate(hlsNotification?.started_at),\n      initialisedAt: convertDateNumToDate(hlsNotification?.initialised_at),\n      state: hlsNotification?.state,\n      singleFilePerLayer: hlsNotification?.config?.single_file_per_layer,\n      hlsVod: hlsNotification?.config?.hls_vod,\n    };\n  }\n  private getPeerListBrowserRecording(recording?: RoomState['recording']): HMSBrowserRecording {\n    const browserNotification = recording?.browser;\n    const running = this.isRecordingRunning(browserNotification?.state);\n    return {\n      running,\n      startedAt: convertDateNumToDate(browserNotification?.started_at),\n      state: browserNotification?.state,\n    };\n  }\n  private getPeerListSFURecording(recording?: RoomState['recording']): HMSSFURecording {\n    const sfuNotification = recording?.sfu;\n    const running = this.isRecordingRunning(sfuNotification?.state);\n    return {\n      running,\n      startedAt: convertDateNumToDate(sfuNotification?.started_at),\n      state: sfuNotification?.state,\n    };\n  }\n\n  private updateRecordingStatus(notification: RecordingNotification) {\n    const room = this.store.getRoom();\n    const running = this.isRecordingRunning(notification.state);\n    if (!room) {\n      HMSLogger.w(this.TAG, `set recording status running=${running} - room not present`);\n      return;\n    }\n\n    let action: HMSRoomUpdate;\n    if (notification.type === RecordingNotificationType.SFU) {\n      room.recording.server = {\n        running,\n        startedAt: running ? convertDateNumToDate(notification.started_at) : undefined,\n        error: this.toSdkError(notification.error),\n        state: notification.state,\n      };\n      action = HMSRoomUpdate.SERVER_RECORDING_STATE_UPDATED;\n    } else if (notification.type === RecordingNotificationType.HLS) {\n      room.recording.hls = this.getHLSRecording(notification);\n      action = HMSRoomUpdate.RECORDING_STATE_UPDATED;\n    } else {\n      room.recording.browser = {\n        running,\n        startedAt: running ? convertDateNumToDate(notification.started_at) : undefined,\n        error: this.toSdkError(notification.error),\n        state: notification?.state,\n      };\n      action = HMSRoomUpdate.BROWSER_RECORDING_STATE_UPDATED;\n    }\n    this.listener?.onRoomUpdate(action, room);\n  }\n\n  private updateRTMPStatus(notification: RTMPNotification) {\n    const room = this.store.getRoom();\n    const running = this.isStreamingRunning(notification.state);\n    if (!room) {\n      HMSLogger.w(this.TAG, 'on policy change - room not present');\n      return;\n    }\n    if (!running) {\n      room.rtmp = {\n        running,\n        state: notification.state,\n        error: this.toSdkError(notification.error),\n      };\n      this.listener?.onRoomUpdate(HMSRoomUpdate.RTMP_STREAMING_STATE_UPDATED, room);\n      return;\n    }\n    room.rtmp = {\n      running,\n      startedAt: running ? convertDateNumToDate(notification.started_at) : undefined,\n      state: notification.state,\n      error: this.toSdkError(notification.error),\n    };\n    this.listener?.onRoomUpdate(HMSRoomUpdate.RTMP_STREAMING_STATE_UPDATED, room);\n  }\n\n  private toSdkError(error?: ServerError): HMSException | undefined {\n    if (!error?.code) {\n      return undefined;\n    }\n    const errMsg = error.message || 'error in streaming/recording';\n    const sdkError = new HMSException(error.code, 'ServerErrors', HMSAction.NONE, errMsg, errMsg);\n    HMSLogger.e(this.TAG, 'error in streaming/recording', sdkError);\n    return sdkError;\n  }\n}\n", "import { HMSUpdateListener, SessionStoreUpdate } from '../../interfaces';\nimport { Store } from '../../sdk/store';\nimport { convertDateNumToDate } from '../../utils/date';\nimport { HMSNotificationMethod } from '../HMSNotificationMethod';\nimport { MetadataChangeNotification } from '../HMSNotifications';\n\nexport class SessionMetadataManager {\n  constructor(private store: Store, public listener?: HMSUpdateListener) {}\n\n  handleNotification(method: string, notification: any) {\n    if (method !== HMSNotificationMethod.METADATA_CHANGE) {\n      return;\n    }\n    this.handleMetadataChange(notification);\n  }\n\n  private handleMetadataChange(notification: MetadataChangeNotification) {\n    const updates: SessionStoreUpdate[] = notification.values.map(update => ({\n      key: update.key,\n      value: update.data,\n      updatedAt: convertDateNumToDate(update.updated_at),\n      updatedBy: update.updated_by ? this.store.getPeerById(update.updated_by) : undefined,\n    }));\n    this.listener?.onSessionStoreUpdate(updates);\n  }\n}\n", "import { HMSUpdateListener, HMSWhiteboard } from '../../interfaces';\nimport { Store } from '../../sdk/store';\nimport HMSTransport from '../../transport';\nimport { constructWhiteboardURL } from '../../utils/whiteboard';\nimport { HMSNotificationMethod } from '../HMSNotificationMethod';\nimport { WhiteboardInfo } from '../HMSNotifications';\n\nexport class WhiteboardManager {\n  constructor(private store: Store, private transport: HMSTransport, public listener?: HMSUpdateListener) {}\n\n  handleNotification(method: string, notification: any) {\n    switch (method) {\n      case HMSNotificationMethod.WHITEBOARD_UPDATE: {\n        this.handleWhiteboardUpdate(notification as WhiteboardInfo);\n        break;\n      }\n      default:\n        break;\n    }\n  }\n\n  private async handleWhiteboardUpdate(notification: WhiteboardInfo) {\n    const localPeer = this.store.getLocalPeer();\n    const prev = this.store.getWhiteboard(notification.id);\n    const isOwner = notification.owner === localPeer?.peerId || notification.owner === localPeer?.customerUserId;\n    const open = notification.state === 'open';\n    const whiteboard: HMSWhiteboard = {\n      id: notification.id,\n      title: notification.title,\n      attributes: notification.attributes,\n    };\n    whiteboard.open = isOwner ? prev?.open : open;\n    whiteboard.owner = whiteboard.open ? notification.owner : undefined;\n\n    if (whiteboard.open) {\n      if (isOwner) {\n        whiteboard.url = prev?.url;\n        whiteboard.token = prev?.token;\n        whiteboard.addr = prev?.addr;\n        whiteboard.permissions = prev?.permissions;\n      } else {\n        const response = await this.transport.signal.getWhiteboard({ id: notification.id });\n        whiteboard.url = constructWhiteboardURL(response.token, response.addr, this.store.getEnv());\n        whiteboard.token = response.token;\n        whiteboard.addr = response.addr;\n        whiteboard.permissions = response.permissions;\n        whiteboard.open = response.permissions.length > 0;\n      }\n    }\n\n    this.store.setWhiteboard(whiteboard);\n    this.listener?.onWhiteboardUpdate(whiteboard);\n  }\n}\n", "import { ActiveSpeakerManager } from './managers/ActiveSpeakerManager';\nimport { BroadcastManager } from './managers/BroadcastManager';\nimport { ConnectionQualityManager } from './managers/ConnectionQualityManager';\nimport { OnDemandTrackManager } from './managers/onDemandTrackManager';\nimport { PeerListManager } from './managers/PeerListManager';\nimport { PeerManager } from './managers/PeerManager';\nimport { PolicyChangeManager } from './managers/PolicyChangeManager';\nimport { PollsManager } from './managers/PollsManager';\nimport { RequestManager } from './managers/RequestManager';\nimport { RoomUpdateManager } from './managers/RoomUpdateManager';\nimport { SessionMetadataManager } from './managers/SessionMetadataManager';\nimport { TrackManager } from './managers/TrackManager';\nimport { WhiteboardManager } from './managers/WhiteboardManager';\nimport { HMSNotificationMethod } from './HMSNotificationMethod';\nimport {\n  ConnectionQualityList,\n  NodeInfo,\n  OnTrackLayerUpdateNotification,\n  PolicyParams,\n  SpeakerList,\n  TrackStateNotification,\n} from './HMSNotifications';\nimport { EventBus } from '../events/EventBus';\nimport { HMSAudioListener, HMSConnectionQualityListener, HMSUpdateListener } from '../interfaces';\nimport { HMSRemoteTrack } from '../media/tracks';\nimport { Store } from '../sdk/store';\nimport { InitFlags } from '../signal/init/models';\nimport HMSTransport from '../transport';\nimport HMSLogger from '../utils/logger';\n\nexport class NotificationManager {\n  private readonly TAG = '[HMSNotificationManager]';\n  private trackManager: TrackManager;\n  private peerManager: PeerManager;\n  private peerListManager: PeerListManager;\n  private activeSpeakerManager: ActiveSpeakerManager;\n  private connectionQualityManager: ConnectionQualityManager;\n  private broadcastManager: BroadcastManager;\n  private policyChangeManager: PolicyChangeManager;\n  private requestManager: RequestManager;\n  private roomUpdateManager: RoomUpdateManager;\n  private sessionMetadataManager: SessionMetadataManager;\n  private pollsManager: PollsManager;\n  private whiteboardManager: WhiteboardManager;\n  /**\n   * room state can be sent before join in preview stage as well but that is outdated, based on\n   * eventual consistency and doesn't have all data. If we get at least one consistent room update\n   * from that point onwards we can rely on live server updates and ignore periodic room state messages\n   */\n  private hasConsistentRoomStateArrived = false;\n\n  constructor(\n    private store: Store,\n    eventBus: EventBus,\n    private transport: HMSTransport,\n    private listener?: HMSUpdateListener,\n    private audioListener?: HMSAudioListener,\n    private connectionQualityListener?: HMSConnectionQualityListener,\n  ) {\n    const isOnDemandTracksEnabled = this.transport.isFlagEnabled(InitFlags.FLAG_ON_DEMAND_TRACKS);\n    this.trackManager = isOnDemandTracksEnabled\n      ? new OnDemandTrackManager(this.store, eventBus, this.transport, this.listener)\n      : new TrackManager(this.store, eventBus, this.listener);\n\n    this.peerManager = new PeerManager(this.store, this.trackManager, this.listener);\n    this.peerListManager = new PeerListManager(this.store, this.peerManager, this.trackManager, this.listener);\n    this.broadcastManager = new BroadcastManager(this.listener);\n    this.policyChangeManager = new PolicyChangeManager(this.store, eventBus);\n    this.requestManager = new RequestManager(this.store, this.listener);\n    this.activeSpeakerManager = new ActiveSpeakerManager(this.store, this.listener, this.audioListener);\n    this.connectionQualityManager = new ConnectionQualityManager(this.store, this.connectionQualityListener);\n    this.roomUpdateManager = new RoomUpdateManager(this.store, this.listener);\n    this.sessionMetadataManager = new SessionMetadataManager(this.store, this.listener);\n    this.pollsManager = new PollsManager(this.store, this.transport, this.listener);\n    this.whiteboardManager = new WhiteboardManager(this.store, this.transport, this.listener);\n  }\n\n  setListener(listener?: HMSUpdateListener) {\n    this.listener = listener;\n    this.trackManager.listener = listener;\n    this.peerManager.listener = listener;\n    this.peerListManager.listener = listener;\n    this.broadcastManager.listener = listener;\n    this.requestManager.listener = listener;\n    this.activeSpeakerManager.listener = listener;\n    this.roomUpdateManager.listener = listener;\n    this.sessionMetadataManager.listener = listener;\n    this.pollsManager.listener = listener;\n    this.whiteboardManager.listener = listener;\n  }\n\n  setAudioListener(audioListener?: HMSAudioListener) {\n    this.audioListener = audioListener;\n    this.activeSpeakerManager.audioListener = audioListener;\n  }\n\n  setConnectionQualityListener(qualityListener?: HMSConnectionQualityListener) {\n    this.connectionQualityListener = qualityListener;\n    this.connectionQualityManager.listener = qualityListener;\n  }\n\n  handleNotification(message: { method: string; params: any }, isReconnecting = false) {\n    const method = message.method as HMSNotificationMethod;\n    const notification = message.params;\n\n    if (\n      ![\n        HMSNotificationMethod.ACTIVE_SPEAKERS,\n        HMSNotificationMethod.SFU_STATS,\n        HMSNotificationMethod.CONNECTION_QUALITY,\n        undefined, // this is is to ignore notifications without any method\n      ].includes(method)\n    ) {\n      HMSLogger.d(this.TAG, `Received notification - ${method}`, { notification });\n    }\n    if (method === HMSNotificationMethod.SFU_STATS) {\n      if (window.HMS?.ON_SFU_STATS && typeof window.HMS?.ON_SFU_STATS === 'function') {\n        window.HMS.ON_SFU_STATS(message.params);\n      }\n    }\n\n    if (this.ignoreNotification(method)) {\n      return;\n    }\n\n    this.roomUpdateManager.handleNotification(method, notification);\n    this.peerManager.handleNotification(method, notification);\n    this.requestManager.handleNotification(method, notification);\n    this.peerListManager.handleNotification(method, notification, isReconnecting);\n    this.broadcastManager.handleNotification(method, notification);\n    this.sessionMetadataManager.handleNotification(method, notification);\n    this.pollsManager.handleNotification(method, notification);\n    this.whiteboardManager.handleNotification(method, notification);\n    this.handleIsolatedMethods(method, notification);\n  }\n\n  // eslint-disable-next-line complexity\n  handleIsolatedMethods(method: string, notification: any) {\n    switch (method) {\n      case HMSNotificationMethod.TRACK_METADATA_ADD: {\n        this.trackManager.handleTrackMetadataAdd(notification as TrackStateNotification);\n        break;\n      }\n      case HMSNotificationMethod.TRACK_UPDATE: {\n        this.trackManager.handleTrackUpdate(notification as TrackStateNotification);\n        break;\n      }\n      case HMSNotificationMethod.TRACK_REMOVE: {\n        if (!notification.peer) {\n          HMSLogger.d(this.TAG, `Ignoring sfu notification - ${method}`, { notification });\n          return;\n        }\n        this.trackManager.handleTrackRemovedPermanently(notification as TrackStateNotification);\n        break;\n      }\n      case HMSNotificationMethod.ON_SFU_TRACK_LAYER_UPDATE: {\n        this.trackManager.handleTrackLayerUpdate(notification as OnTrackLayerUpdateNotification);\n        break;\n      }\n      case HMSNotificationMethod.ACTIVE_SPEAKERS:\n        this.activeSpeakerManager.handleActiveSpeakers(notification as SpeakerList);\n        break;\n\n      case HMSNotificationMethod.CONNECTION_QUALITY:\n        this.connectionQualityManager.handleQualityUpdate(notification as ConnectionQualityList);\n        break;\n\n      case HMSNotificationMethod.POLICY_CHANGE:\n        this.policyChangeManager.handlePolicyChange(notification as PolicyParams);\n        break;\n\n      case HMSNotificationMethod.NODE_INFO:\n        this.transport.setSFUNodeId((notification as NodeInfo).sfu_node_id);\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  ignoreNotification = (method: string): boolean => {\n    if (method === HMSNotificationMethod.PEER_LIST) {\n      this.hasConsistentRoomStateArrived = true;\n    } else if (method === HMSNotificationMethod.ROOM_STATE) {\n      // ignore periodic inconsistent room state if consistent one has arrived at least once\n      return this.hasConsistentRoomStateArrived;\n    }\n    return false;\n  };\n\n  handleTrackAdd = (track: HMSRemoteTrack) => {\n    this.trackManager.handleTrackAdd(track);\n  };\n\n  handleTrackRemove = (track: HMSRemoteTrack) => {\n    this.trackManager.handleTrackRemove(track);\n  };\n\n  updateLocalPeer = ({ name, metadata }: { name?: string; metadata?: string }) => {\n    const peer = this.store.getLocalPeer();\n    this.peerManager.handlePeerInfoUpdate({ peer, name, data: metadata });\n  };\n}\n", "import { HMSSessionStore } from '../interfaces';\nimport HMSTransport from '../transport';\nimport { convertDateNumToDate } from '../utils/date';\n\nexport class SessionStore implements HMSSessionStore {\n  private observedKeys: Set<string> = new Set();\n\n  constructor(private transport: HMSTransport) {}\n\n  async get(key: string) {\n    const { data, updated_at } = await this.transport.signal.getSessionMetadata(key);\n\n    return { value: data, updatedAt: convertDateNumToDate(updated_at) };\n  }\n\n  async set(key: string, data: any) {\n    const { data: value, updated_at } = await this.transport.signal.setSessionMetadata({ key, data });\n    const updatedAt = convertDateNumToDate(updated_at);\n    return { value, updatedAt };\n  }\n\n  async observe(keys: string[]) {\n    const prevObservedKeys = new Set(this.observedKeys);\n    keys.forEach(key => this.observedKeys.add(key));\n\n    if (this.observedKeys.size !== prevObservedKeys.size) {\n      try {\n        await this.transport.signal.listenMetadataChange(Array.from(this.observedKeys));\n      } catch (e) {\n        this.observedKeys = prevObservedKeys;\n        throw e;\n      }\n    }\n  }\n\n  async unobserve(keys: string[]) {\n    const prevObservedKeys = new Set(this.observedKeys);\n    this.observedKeys = new Set([...this.observedKeys].filter(key => !keys.includes(key)));\n\n    if (this.observedKeys.size !== prevObservedKeys.size) {\n      try {\n        await this.transport.signal.listenMetadataChange(Array.from(this.observedKeys));\n      } catch (e) {\n        this.observedKeys = prevObservedKeys;\n        throw e;\n      }\n    }\n  }\n}\n", "import { HMSICEServer } from '../../interfaces';\n\nexport class JoinParameters {\n  constructor(\n    public authToken: string,\n    public peerId: string,\n    public peerName: string = '',\n    public data: string = '',\n    public endpoint: string = 'https://prod-init.100ms.live/init',\n    public autoSubscribeVideo: boolean = false,\n    public iceServers?: HMSICEServer[],\n  ) {}\n}\n", "export enum TransportFailureCategory {\n  ConnectFailed,\n  SignalDisconnect,\n  JoinWSMessageFailed,\n  PublishIceConnectionFailed,\n  SubscribeIceConnectionFailed,\n}\n\nexport const Dependencies = {\n  [TransportFailureCategory.ConnectFailed]: [],\n  [TransportFailureCategory.SignalDisconnect]: [],\n  [TransportFailureCategory.JoinWSMessageFailed]: [TransportFailureCategory.SignalDisconnect],\n  [TransportFailureCategory.PublishIceConnectionFailed]: [TransportFailureCategory.SignalDisconnect],\n  [TransportFailureCategory.SubscribeIceConnectionFailed]: [TransportFailureCategory.SignalDisconnect],\n};\n", "export enum TransportState {\n  Disconnected = 'Disconnected',\n  Connecting = 'Connecting',\n  Joined = 'Joined',\n  Preview = 'Preview',\n  Failed = 'Failed',\n  Reconnecting = 'Reconnecting',\n  Leaving = 'Leaving',\n}\n", "export interface PromiseCallbacks<T, K = void> {\n  resolve: (value: T) => void;\n  reject: (reason?: any) => void;\n  metadata?: K;\n}\n\nexport class PromiseWithCallbacks<T> {\n  promise: Promise<T>;\n  resolve!: (value: T) => void;\n  reject!: (reason?: any) => void;\n\n  constructor(cb: (resolve: (value: T) => void, reject: (reason?: any) => void) => any) {\n    this.promise = new Promise<T>((resolve, reject) => {\n      this.resolve = resolve;\n      this.reject = reject;\n      cb(resolve, reject);\n    });\n  }\n}\n", "import { Dependencies as TFCDependencies, TransportFailureCategory as TFC } from './models/TransportFailureCategory';\nimport { TransportState } from './models/TransportState';\nimport { HMSException } from '../error/HMSException';\nimport { MAX_TRANSPORT_RETRIES, MAX_TRANSPORT_RETRY_DELAY } from '../utils/constants';\nimport HMSLogger from '../utils/logger';\nimport { PromiseWithCallbacks } from '../utils/promise';\n\n/**\n * Task which is executed by [RetryScheduler.schedule] until max retry count\n * is reached.\n *\n * Any exception raised while executing the task assumes that task is failed.\n * Failed tasks are retried if max retry count is not reached.\n *\n * @returns True if the task if successful, otherwise False\n *\n *\n */\ntype RetryTask = () => Promise<boolean>;\n\ninterface ScheduleTaskParams {\n  category: TFC;\n  error: HMSException;\n  task: RetryTask;\n  originalState: TransportState;\n  maxFailedRetries?: number;\n  changeState?: boolean;\n}\n\nexport class RetryScheduler {\n  private readonly TAG = '[RetryScheduler]';\n  private inProgress = new Map<TFC, PromiseWithCallbacks<number>>();\n  private retryTaskIds: number[] = [];\n\n  constructor(\n    private onStateChange: (state: TransportState, error?: HMSException) => Promise<void>,\n    private sendEvent: (error: HMSException, category: TFC) => void,\n  ) {}\n\n  async schedule({\n    category,\n    error,\n    task,\n    originalState,\n    maxFailedRetries = MAX_TRANSPORT_RETRIES,\n    changeState = true,\n  }: ScheduleTaskParams) {\n    await this.scheduleTask({ category, error, changeState, task, originalState, maxFailedRetries });\n  }\n\n  reset() {\n    this.retryTaskIds.forEach(future => clearTimeout(future));\n    this.retryTaskIds = [];\n    this.inProgress.clear();\n  }\n\n  isTaskInProgress(category: TFC) {\n    return !!this.inProgress.get(category);\n  }\n\n  // eslint-disable-next-line complexity\n  private async scheduleTask({\n    category,\n    error,\n    changeState,\n    task,\n    originalState,\n    maxFailedRetries = MAX_TRANSPORT_RETRIES,\n    failedRetryCount = 0,\n  }: ScheduleTaskParams & { failedRetryCount?: number }): Promise<void> {\n    HMSLogger.d(this.TAG, 'schedule: ', { category: TFC[category], error });\n\n    // First schedule call\n    if (failedRetryCount === 0) {\n      const inProgressTask = this.inProgress.get(category);\n      if (inProgressTask) {\n        HMSLogger.d(this.TAG, `schedule: Already a task for ${TFC[category]} scheduled, waiting for its completion`);\n        await inProgressTask.promise;\n        return;\n      }\n\n      const taskPromise = new PromiseWithCallbacks<number>((_, __) => {});\n      this.inProgress.set(category, taskPromise);\n\n      this.sendEvent(error, category);\n    }\n\n    let hasFailedDependency = false;\n    const dependencies = TFCDependencies[category];\n\n    for (const dependencyIndexString in dependencies) {\n      const dependency = dependencies[parseInt(dependencyIndexString)];\n      try {\n        const dependencyTask = this.inProgress.get(dependency);\n        if (dependencyTask) {\n          HMSLogger.d(\n            this.TAG,\n            `schedule: Suspending retry task of ${TFC[category]}, waiting for ${TFC[dependency]} to recover`,\n          );\n          await dependencyTask.promise;\n          HMSLogger.d(\n            this.TAG,\n            `schedule: Resuming retry task ${TFC[category]} as it's dependency ${TFC[dependency]} is recovered`,\n          );\n        }\n      } catch (ex) {\n        HMSLogger.d(\n          this.TAG,\n          `schedule: Stopping retry task of ${TFC[category]} as it's dependency ${TFC[dependency]} failed to recover`,\n        );\n        hasFailedDependency = true;\n        break;\n      }\n    }\n\n    if (failedRetryCount >= maxFailedRetries || hasFailedDependency) {\n      error.description += `. [${TFC[category]}] Could not recover after ${failedRetryCount} tries`;\n\n      if (hasFailedDependency) {\n        error.description += ` Could not recover all of it's required dependencies - [${(dependencies as Array<TFC>)\n          .map(dep => TFC[dep])\n          .toString()}]`;\n      }\n      error.isTerminal = true;\n\n      // @NOTE: Don't reject to throw error for dependencies, use onStateChange\n      // const taskPromise = this.inProgress.get(category);\n      this.inProgress.delete(category);\n      // taskPromise?.reject(error);\n      this.sendEvent(error, category);\n\n      this.reset();\n\n      if (changeState) {\n        this.onStateChange(TransportState.Failed, error);\n      } else {\n        throw error;\n      }\n\n      return;\n    }\n\n    if (changeState) {\n      this.onStateChange(TransportState.Reconnecting, error);\n    }\n\n    const delay = this.getDelayForRetryCount(category, failedRetryCount);\n\n    HMSLogger.d(\n      this.TAG,\n      `schedule: [${TFC[category]}] [failedRetryCount=${failedRetryCount}] Scheduling retry task in ${delay}ms`,\n    );\n\n    let taskSucceeded: boolean;\n    try {\n      taskSucceeded = await this.setTimeoutPromise(task, delay);\n    } catch (ex) {\n      taskSucceeded = false;\n      HMSLogger.w(\n        this.TAG,\n        `[${TFC[category]}] Un-caught exception ${(ex as HMSException).name} in retry-task, initiating retry`,\n        ex,\n      );\n    }\n\n    if (taskSucceeded) {\n      const taskPromise = this.inProgress.get(category);\n      this.inProgress.delete(category);\n      taskPromise?.resolve(failedRetryCount);\n\n      if (changeState && this.inProgress.size === 0) {\n        this.onStateChange(originalState);\n      }\n      HMSLogger.d(this.TAG, `schedule: [${TFC[category]}] [failedRetryCount=${failedRetryCount}] Recovered \u267B\uFE0F`);\n    } else {\n      await this.scheduleTask({\n        category,\n        error,\n        changeState,\n        task,\n        originalState,\n        maxFailedRetries,\n        failedRetryCount: failedRetryCount + 1,\n      });\n    }\n  }\n\n  private getBaseDelayForTask(category: TFC, n: number) {\n    if (category === TFC.JoinWSMessageFailed) {\n      // linear backoff(2 + jitter for every retry)\n      return 2;\n    }\n    // exponential backoff\n    return Math.pow(2, n);\n  }\n\n  private getDelayForRetryCount(category: TFC, n: number) {\n    const delay = this.getBaseDelayForTask(category, n);\n    const jitter = category === TFC.JoinWSMessageFailed ? Math.random() * 2 : Math.random();\n    return Math.round(Math.min(delay + jitter, MAX_TRANSPORT_RETRY_DELAY) * 1000);\n  }\n\n  private async setTimeoutPromise<T>(task: () => Promise<T>, delay: number): Promise<T> {\n    return new Promise((resolve, reject) => {\n      const timeoutId = window.setTimeout(async () => {\n        try {\n          const value: T = await task();\n          value && this.retryTaskIds.splice(this.retryTaskIds.indexOf(timeoutId), 1);\n          resolve(value);\n        } catch (error) {\n          reject(error);\n        }\n      }, delay);\n\n      this.retryTaskIds.push(timeoutId);\n    });\n  }\n}\n", "import { ANALYTICS_BUFFER_SIZE } from '../../utils/constants';\nimport { LocalStorage } from '../../utils/local-storage';\nimport { Queue } from '../../utils/queue';\nimport AnalyticsEvent from '../AnalyticsEvent';\n\nexport class LocalStorageEvents extends Queue<AnalyticsEvent> {\n  private localStorage = new LocalStorage<AnalyticsEvent[]>('hms-analytics');\n\n  constructor() {\n    super(ANALYTICS_BUFFER_SIZE);\n    // @TODO: Currently we don't send failed events of old sessions. So reset localstorage for every session.\n    // Once support for failed events from old sessions is added, remove clear and init queue from localstorage.\n    this.localStorage.clear();\n    this.initLocalStorageQueue();\n  }\n\n  enqueue(event: AnalyticsEvent) {\n    super.enqueue(event);\n    this.localStorage.set(this.storage);\n  }\n\n  dequeue() {\n    const removedEvent = super.dequeue();\n    this.localStorage.set(this.storage);\n    return removedEvent;\n  }\n\n  private initLocalStorageQueue() {\n    this.localStorage.get()?.forEach(event => {\n      const eventInstance = new AnalyticsEvent(event);\n      super.enqueue(eventInstance);\n    });\n  }\n}\n", "import AnalyticsEvent from './AnalyticsEvent';\nimport { HTTPAnalyticsTransport } from './HTTPAnalyticsTransport';\nimport { IAnalyticsTransportProvider } from './IAnalyticsTransportProvider';\nimport HMSLogger from '../utils/logger';\nimport { Queue } from '../utils/queue';\n\nexport abstract class AnalyticsTransport {\n  abstract transportProvider: IAnalyticsTransportProvider;\n  abstract failedEvents: Queue<AnalyticsEvent>;\n  private readonly TAG = '[AnalyticsTransport]';\n\n  private eventCount = 0;\n  private lastResetTime: number = Date.now();\n  private readonly MAX_EVENTS_PER_MINUTE: number = 200;\n  private readonly RESET_INTERVAL_MS: number = 60000;\n\n  private checkRateLimit() {\n    const now = Date.now();\n    if (now - this.lastResetTime >= this.RESET_INTERVAL_MS) {\n      this.eventCount = 0;\n      this.lastResetTime = now;\n    }\n    if (this.eventCount >= this.MAX_EVENTS_PER_MINUTE) {\n      throw new Error('Too many events being sent, please check the implementation.');\n    }\n    this.eventCount++;\n  }\n\n  sendEvent(event: AnalyticsEvent) {\n    try {\n      this.checkRateLimit();\n    } catch (e) {\n      HMSLogger.w(this.TAG, 'Rate limit exceeded', e);\n      throw e;\n    }\n    try {\n      this.sendSingleEvent(event);\n      this.flushFailedEvents();\n    } catch (error) {\n      HMSLogger.w(this.TAG, 'sendEvent failed', error);\n    }\n  }\n\n  flushFailedEvents(currentPeerId?: string) {\n    try {\n      HMSLogger.d(this.TAG, 'Flushing failed events', this.failedEvents);\n      while (this.failedEvents.size() > 0) {\n        const event = this.failedEvents.dequeue();\n        if (event) {\n          const isEventFromCurrentPeer = event.metadata?.peer.peer_id === currentPeerId;\n          if (isEventFromCurrentPeer || !event.metadata.peer.peer_id) {\n            this.sendSingleEvent(event);\n          } else {\n            HTTPAnalyticsTransport.sendEvent(event);\n          }\n        }\n      }\n    } catch (error) {\n      HMSLogger.w(this.TAG, 'flushFailedEvents failed', error);\n    }\n  }\n\n  private sendSingleEvent(event: AnalyticsEvent) {\n    try {\n      this.transportProvider.sendEvent(event);\n      HMSLogger.d(this.TAG, 'Sent event', event.name, event);\n    } catch (error) {\n      HMSLogger.w(this.TAG, `${this.transportProvider.TAG}.sendEvent failed, adding to local storage events`, {\n        event,\n        error,\n      });\n      this.failedEvents.enqueue(event);\n      throw error;\n    }\n  }\n}\n", "import { LocalStorageEvents } from './LocalStoageEvents';\nimport JsonRpcSignal from '../../signal/jsonrpc';\nimport { AnalyticsTransport } from '../AnalyticsTransport';\n\nexport class SignalAnalyticsTransport extends AnalyticsTransport {\n  failedEvents = new LocalStorageEvents();\n\n  constructor(public transportProvider: JsonRpcSignal) {\n    super();\n  }\n}\n", "import {\n  LocalAudioTrackAnalytics,\n  LocalBaseSample,\n  LocalVideoSample,\n  LocalVideoTrackAnalytics,\n  PublishAnalyticPayload,\n  RemoteAudioSample,\n  RemoteAudioTrackAnalytics,\n  RemoteVideoSample,\n  RemoteVideoTrackAnalytics,\n  SubscribeAnalyticPayload,\n} from './interfaces';\nimport { EventBus } from '../../events/EventBus';\nimport { HMSTrackStats } from '../../interfaces';\nimport { HMSTrack } from '../../internal';\nimport { HMSWebrtcStats } from '../../rtc-stats';\nimport { Store } from '../../sdk/store';\nimport HMSLogger from '../../utils/logger';\nimport { sleep } from '../../utils/timer-utils';\n\nexport abstract class BaseStatsAnalytics {\n  private shouldSendEvent = false;\n  protected sequenceNum = 1;\n  protected abstract trackAnalytics: Map<string, RunningTrackAnalytics>;\n\n  constructor(\n    protected store: Store,\n    protected eventBus: EventBus,\n    protected readonly sampleWindowSize: number,\n    protected readonly pushInterval: number,\n  ) {\n    this.start();\n  }\n\n  start() {\n    if (this.shouldSendEvent) {\n      return;\n    }\n    this.stop();\n    this.shouldSendEvent = true;\n    this.eventBus.statsUpdate.subscribe(this.handleStatsUpdate.bind(this));\n    this.startLoop().catch(e => HMSLogger.e('[StatsAnalytics]', e.message));\n  }\n\n  stop = () => {\n    if (this.shouldSendEvent) {\n      this.sendEvent();\n    }\n    this.eventBus.statsUpdate.unsubscribe(this.handleStatsUpdate.bind(this));\n    this.shouldSendEvent = false;\n  };\n\n  private async startLoop() {\n    while (this.shouldSendEvent) {\n      await sleep(this.pushInterval * 1000);\n      this.sendEvent();\n    }\n  }\n\n  protected sendEvent(): void {\n    this.trackAnalytics.forEach(trackAnalytic => {\n      trackAnalytic.clearSamples();\n    });\n  }\n\n  protected cleanTrackAnalyticsAndCreateSample(shouldCreateSample: boolean) {\n    // delete track analytics if track is not present in store and no samples are present\n    this.trackAnalytics.forEach(trackAnalytic => {\n      if (!this.store.hasTrack(trackAnalytic.track) && !(trackAnalytic.samples.length > 0)) {\n        this.trackAnalytics.delete(trackAnalytic.track_id);\n      }\n    });\n\n    if (shouldCreateSample) {\n      this.trackAnalytics.forEach(trackAnalytic => {\n        trackAnalytic.createSample();\n      });\n    }\n  }\n\n  protected abstract toAnalytics(): PublishAnalyticPayload | SubscribeAnalyticPayload;\n\n  protected abstract handleStatsUpdate(hmsStats: HMSWebrtcStats): void;\n}\n\nexport type TempStats = HMSTrackStats & {\n  availableOutgoingBitrate?: number;\n  calculatedJitterBufferDelay?: number;\n  avSync?: number;\n  expectedFrameHeight?: number;\n  expectedFrameWidth?: number;\n};\n\nexport abstract class RunningTrackAnalytics {\n  readonly sampleWindowSize: number;\n  track: HMSTrack;\n  track_id: string;\n  source: string;\n  ssrc: string;\n  kind: string;\n  rid?: string;\n\n  samples: (LocalBaseSample | LocalVideoSample | RemoteAudioSample | RemoteVideoSample)[] = [];\n  protected tempStats: TempStats[] = [];\n  protected prevLatestStat?: TempStats;\n\n  constructor({\n    track,\n    ssrc,\n    rid,\n    kind,\n    sampleWindowSize,\n  }: {\n    track: HMSTrack;\n    ssrc: string;\n    kind: string;\n    rid?: string;\n    sampleWindowSize: number;\n  }) {\n    this.track = track;\n    this.ssrc = ssrc;\n    this.rid = rid;\n    this.kind = kind;\n    this.track_id = this.track.trackId;\n    this.source = this.track.source!;\n    this.sampleWindowSize = sampleWindowSize;\n  }\n\n  pushTempStat(stat: TempStats) {\n    this.tempStats.push(stat);\n  }\n\n  createSample() {\n    if (this.tempStats.length === 0) {\n      return;\n    }\n\n    this.samples.push(this.collateSample());\n    this.prevLatestStat = this.getLatestStat();\n    this.tempStats.length = 0;\n  }\n\n  clearSamples() {\n    this.samples.length = 0;\n  }\n\n  abstract shouldCreateSample: () => boolean;\n\n  protected abstract collateSample: () => LocalBaseSample | LocalVideoSample | RemoteAudioSample | RemoteVideoSample;\n\n  protected abstract toAnalytics: () =>\n    | LocalAudioTrackAnalytics\n    | LocalVideoTrackAnalytics\n    | RemoteAudioTrackAnalytics\n    | RemoteVideoTrackAnalytics;\n\n  getLatestStat() {\n    return this.tempStats[this.tempStats.length - 1];\n  }\n\n  protected getFirstStat() {\n    return this.tempStats[0];\n  }\n\n  protected calculateSum(key: keyof TempStats) {\n    const checkStat = this.getLatestStat()[key];\n    if (typeof checkStat !== 'number') {\n      return;\n    }\n    return this.tempStats.reduce((partialSum, stat) => {\n      return partialSum + ((stat[key] || 0) as number);\n    }, 0);\n  }\n\n  protected calculateAverage(key: keyof TempStats, round = true) {\n    const sum = this.calculateSum(key);\n    const avg = sum !== undefined ? sum / this.tempStats.length : undefined;\n    return avg ? (round ? Math.round(avg) : avg) : undefined;\n  }\n\n  protected calculateDifferenceForSample(key: keyof TempStats) {\n    const firstValue = Number(this.prevLatestStat?.[key]) || 0;\n    const latestValue = Number(this.getLatestStat()[key]) || 0;\n\n    return latestValue - firstValue;\n  }\n\n  protected calculateDifferenceAverage(key: keyof TempStats, round = true) {\n    const avg = this.calculateDifferenceForSample(key) / this.tempStats.length;\n    return round ? Math.round(avg) : avg;\n  }\n\n  protected calculateInstancesOfHigh(key: keyof TempStats, threshold: number) {\n    const checkStat = this.getLatestStat()[key];\n    if (typeof checkStat !== 'number') {\n      return;\n    }\n\n    return this.tempStats.reduce((partialSum, stat) => {\n      return partialSum + (((stat[key] || 0) as number) > threshold ? 1 : 0);\n    }, 0);\n  }\n}\n\nexport const hasResolutionChanged = (newStat: TempStats, prevStat: TempStats) =>\n  newStat && prevStat && (newStat.frameWidth !== prevStat.frameWidth || newStat.frameHeight !== prevStat.frameHeight);\n\nexport const hasEnabledStateChanged = (newStat: TempStats, prevStat: TempStats) =>\n  newStat && prevStat && newStat.enabled !== prevStat.enabled;\n\nexport const removeUndefinedFromObject = <T extends Record<string, any>>(data: T) => {\n  return Object.entries(data)\n    .filter(([, value]) => value !== undefined)\n    .reduce((obj, [key, value]) => {\n      obj[key as keyof T] = value;\n      return obj;\n    }, {} as T);\n};\n", "import {\n  BaseStatsAnalytics,\n  hasEnabledStateChanged,\n  hasResolutionChanged,\n  removeUndefinedFromObject,\n  RunningTrackAnalytics,\n} from './BaseStatsAnalytics';\nimport {\n  LocalAudioTrackAnalytics,\n  LocalBaseSample,\n  LocalVideoSample,\n  LocalVideoTrackAnalytics,\n  PublishAnalyticPayload,\n} from './interfaces';\nimport { HMSTrackStats } from '../../interfaces';\nimport { HMSWebrtcStats } from '../../rtc-stats';\nimport { PUBLISH_STATS_SAMPLE_WINDOW } from '../../utils/constants';\nimport AnalyticsEventFactory from '../AnalyticsEventFactory';\n\nexport class PublishStatsAnalytics extends BaseStatsAnalytics {\n  protected trackAnalytics: Map<string, RunningLocalTrackAnalytics> = new Map();\n\n  protected toAnalytics(): PublishAnalyticPayload {\n    const audio: LocalAudioTrackAnalytics[] = [];\n    const video: LocalVideoTrackAnalytics[] = [];\n    this.trackAnalytics.forEach(trackAnalytic => {\n      if (trackAnalytic.track.type === 'audio') {\n        audio.push(trackAnalytic.toAnalytics());\n      } else if (trackAnalytic.track.type === 'video') {\n        video.push(trackAnalytic.toAnalytics());\n      }\n    });\n    return {\n      audio,\n      video,\n      joined_at: this.store.getRoom()?.joinedAt?.getTime()!,\n      sequence_num: this.sequenceNum++,\n      max_window_sec: PUBLISH_STATS_SAMPLE_WINDOW,\n    };\n  }\n\n  protected sendEvent() {\n    this.eventBus.analytics.publish(AnalyticsEventFactory.publishStats(this.toAnalytics()));\n    super.sendEvent();\n  }\n\n  protected handleStatsUpdate(hmsStats: HMSWebrtcStats) {\n    let shouldCreateSample = false;\n\n    const localTracksStats = hmsStats.getLocalTrackStats();\n    Object.keys(localTracksStats).forEach(trackIDBeingSent => {\n      const trackStats = localTracksStats[trackIDBeingSent];\n      const track = this.store.getLocalPeerTracks().find(track => track.getTrackIDBeingSent() === trackIDBeingSent);\n      Object.keys(trackStats).forEach(statId => {\n        const layerStats = trackStats[statId];\n        if (!track) {\n          return;\n        }\n        const identifier = this.getTrackIdentifier(track.trackId, layerStats);\n        const newTempStats = {\n          ...layerStats,\n          availableOutgoingBitrate: hmsStats.getLocalPeerStats()?.publish?.availableOutgoingBitrate,\n        };\n        if (identifier && this.trackAnalytics.has(identifier)) {\n          this.trackAnalytics.get(identifier)?.pushTempStat(newTempStats);\n        } else {\n          if (track) {\n            const trackAnalytics = new RunningLocalTrackAnalytics({\n              track,\n              sampleWindowSize: this.sampleWindowSize,\n              rid: layerStats.rid,\n              ssrc: layerStats.ssrc.toString(),\n              kind: layerStats.kind,\n            });\n            trackAnalytics.pushTempStat(newTempStats);\n            this.trackAnalytics.set(this.getTrackIdentifier(track.trackId, layerStats), trackAnalytics);\n          }\n        }\n\n        const trackAnalytics = this.trackAnalytics.get(identifier);\n        if (trackAnalytics?.shouldCreateSample()) {\n          shouldCreateSample = true;\n        }\n      });\n    });\n\n    this.cleanTrackAnalyticsAndCreateSample(shouldCreateSample);\n  }\n\n  private getTrackIdentifier(trackId: string, stats: HMSTrackStats) {\n    return stats.rid ? `${trackId}:${stats.rid}` : trackId;\n  }\n}\n\nclass RunningLocalTrackAnalytics extends RunningTrackAnalytics {\n  samples: (LocalBaseSample | LocalVideoSample)[] = [];\n\n  protected collateSample = (): LocalBaseSample | LocalVideoSample => {\n    const latestStat = this.getLatestStat();\n\n    const qualityLimitationDurations = latestStat.qualityLimitationDurations;\n    const total_quality_limitation = qualityLimitationDurations && {\n      bandwidth_sec: qualityLimitationDurations.bandwidth,\n      cpu_sec: qualityLimitationDurations.cpu,\n      other_sec: qualityLimitationDurations.other,\n    };\n\n    const resolution = latestStat.frameHeight\n      ? {\n          height_px: this.getLatestStat().frameHeight,\n          width_px: this.getLatestStat().frameWidth,\n        }\n      : undefined;\n    const avg_jitter = this.calculateAverage('jitter', false);\n    const avg_jitter_ms = avg_jitter ? Math.round(avg_jitter * 1000) : undefined;\n\n    const avg_round_trip_time = this.calculateAverage('roundTripTime', false);\n    const avg_round_trip_time_ms = avg_round_trip_time ? Math.round(avg_round_trip_time * 1000) : undefined;\n\n    return removeUndefinedFromObject({\n      timestamp: Date.now(),\n      avg_available_outgoing_bitrate_bps: this.calculateAverage('availableOutgoingBitrate'),\n      avg_bitrate_bps: this.calculateAverage('bitrate'),\n      avg_fps: this.calculateAverage('framesPerSecond'),\n      total_packets_lost: this.getLatestStat().packetsLost,\n      total_packets_sent: this.getLatestStat().packetsSent,\n      total_packet_sent_delay_sec: parseFloat(this.calculateDifferenceForSample('totalPacketSendDelay').toFixed(4)),\n      total_fir_count: this.calculateDifferenceForSample('firCount'),\n      total_pli_count: this.calculateDifferenceForSample('pliCount'),\n      total_nack_count: this.calculateDifferenceForSample('nackCount'),\n      avg_jitter_ms,\n      avg_round_trip_time_ms,\n      total_quality_limitation,\n      resolution,\n    });\n  };\n\n  shouldCreateSample = () => {\n    const length = this.tempStats.length;\n    const newStat = this.tempStats[length - 1];\n    const prevStat = this.tempStats[length - 2];\n\n    return (\n      length === PUBLISH_STATS_SAMPLE_WINDOW ||\n      hasEnabledStateChanged(newStat, prevStat) ||\n      (newStat.kind === 'video' && hasResolutionChanged(newStat, prevStat))\n    );\n  };\n\n  toAnalytics = (): LocalAudioTrackAnalytics | LocalVideoTrackAnalytics => {\n    return {\n      track_id: this.track_id,\n      ssrc: this.ssrc,\n      source: this.source,\n      rid: this.rid,\n      samples: this.samples,\n    };\n  };\n}\n", "import {\n  BaseStatsAnalytics,\n  hasEnabledStateChanged,\n  hasResolutionChanged,\n  removeUndefinedFromObject,\n  RunningTrackAnalytics,\n  TempStats,\n} from './BaseStatsAnalytics';\nimport {\n  RemoteAudioSample,\n  RemoteAudioTrackAnalytics,\n  RemoteVideoSample,\n  RemoteVideoTrackAnalytics,\n  SubscribeAnalyticPayload,\n} from './interfaces';\nimport { HMSTrackStats } from '../../interfaces';\nimport { HMSRemoteVideoTrack } from '../../internal';\nimport { HMSWebrtcStats } from '../../rtc-stats';\nimport { MAX_SAFE_INTEGER, SUBSCRIBE_STATS_SAMPLE_WINDOW } from '../../utils/constants';\nimport AnalyticsEventFactory from '../AnalyticsEventFactory';\n\nexport class SubscribeStatsAnalytics extends BaseStatsAnalytics {\n  protected trackAnalytics: Map<string, RunningRemoteTrackAnalytics> = new Map();\n\n  protected toAnalytics(): SubscribeAnalyticPayload {\n    const audio: RemoteAudioTrackAnalytics[] = [];\n    const video: RemoteVideoTrackAnalytics[] = [];\n    this.trackAnalytics.forEach(trackAnalytic => {\n      if (trackAnalytic.track.type === 'audio') {\n        audio.push(trackAnalytic.toAnalytics());\n      } else if (trackAnalytic.track.type === 'video') {\n        video.push(trackAnalytic.toAnalytics());\n      }\n    });\n    return {\n      audio,\n      video,\n      joined_at: this.store.getRoom()?.joinedAt?.getTime()!,\n      sequence_num: this.sequenceNum++,\n      max_window_sec: SUBSCRIBE_STATS_SAMPLE_WINDOW,\n    };\n  }\n\n  protected sendEvent() {\n    this.eventBus.analytics.publish(AnalyticsEventFactory.subscribeStats(this.toAnalytics()));\n    super.sendEvent();\n  }\n\n  protected handleStatsUpdate(hmsStats: HMSWebrtcStats) {\n    const remoteTracksStats = hmsStats.getAllRemoteTracksStats();\n    let shouldCreateSample = false;\n    Object.keys(remoteTracksStats).forEach(trackID => {\n      const track = this.store.getTrackById(trackID);\n      const trackStats = remoteTracksStats[trackID];\n      const prevTrackStats = this.trackAnalytics.get(trackID)?.getLatestStat();\n\n      // eslint-disable-next-line complexity\n      const getCalculatedJitterBufferDelay = (trackStats: HMSTrackStats, prevTrackStats?: TempStats) => {\n        const prevJBDelay = prevTrackStats?.jitterBufferDelay || 0;\n        const prevJBEmittedCount = prevTrackStats?.jitterBufferEmittedCount || 0;\n        const currentJBDelay = (trackStats?.jitterBufferDelay || 0) - prevJBDelay;\n        const currentJBEmittedCount = (trackStats?.jitterBufferEmittedCount || 0) - prevJBEmittedCount;\n\n        return currentJBEmittedCount > 0\n          ? (currentJBDelay * 1000) / currentJBEmittedCount\n          : prevTrackStats?.calculatedJitterBufferDelay || 0;\n      };\n\n      const calculatedJitterBufferDelay = getCalculatedJitterBufferDelay(trackStats, prevTrackStats);\n\n      const avSync = this.calculateAvSyncForStat(trackStats, hmsStats);\n      const newTempStat: TempStats = { ...trackStats, calculatedJitterBufferDelay, avSync };\n      if (trackStats.kind === 'video') {\n        const definition = (track as HMSRemoteVideoTrack).getPreferredLayerDefinition();\n        newTempStat.expectedFrameHeight = definition?.resolution.height;\n        newTempStat.expectedFrameWidth = definition?.resolution.width;\n      }\n      if (this.trackAnalytics.has(trackID)) {\n        this.trackAnalytics.get(trackID)?.pushTempStat(newTempStat);\n      } else {\n        if (track) {\n          const trackAnalytics = new RunningRemoteTrackAnalytics({\n            track,\n            sampleWindowSize: this.sampleWindowSize,\n            ssrc: trackStats.ssrc.toString(),\n            kind: trackStats.kind,\n          });\n          trackAnalytics.pushTempStat(newTempStat);\n          this.trackAnalytics.set(trackID, trackAnalytics);\n        }\n      }\n      const trackAnalytics = this.trackAnalytics.get(trackID);\n      if (trackAnalytics?.shouldCreateSample()) {\n        shouldCreateSample = true;\n      }\n    });\n\n    this.cleanTrackAnalyticsAndCreateSample(shouldCreateSample);\n  }\n\n  // eslint-disable-next-line complexity\n  private calculateAvSyncForStat(trackStats: HMSTrackStats, hmsStats: HMSWebrtcStats) {\n    if (!trackStats.peerID || !trackStats.estimatedPlayoutTimestamp || trackStats.kind !== 'video') {\n      return;\n    }\n    const peer = this.store.getPeerById(trackStats.peerID);\n    const audioTrack = peer?.audioTrack;\n    const videoTrack = peer?.videoTrack;\n    /**\n     * 1. Send value as MAX_SAFE_INTEGER when either audio or value track is muted for the entire window\n     * 2. When both audio and video are unmuted for a part of window , then divide the difference by those many number of samples only\n     */\n    const areBothTracksEnabled = audioTrack && videoTrack && audioTrack.enabled && videoTrack.enabled;\n    if (!areBothTracksEnabled) {\n      return MAX_SAFE_INTEGER;\n    }\n    const audioStats = hmsStats.getRemoteTrackStats(audioTrack.trackId);\n    if (!audioStats) {\n      return MAX_SAFE_INTEGER;\n    }\n    if (!audioStats.estimatedPlayoutTimestamp) {\n      return;\n    }\n\n    // https://w3c.github.io/webrtc-stats/#dom-rtcinboundrtpstreamstats-estimatedplayouttimestamp\n    return audioStats.estimatedPlayoutTimestamp - trackStats.estimatedPlayoutTimestamp;\n  }\n}\n\nclass RunningRemoteTrackAnalytics extends RunningTrackAnalytics {\n  samples: (RemoteAudioSample | RemoteVideoSample)[] = [];\n\n  protected collateSample = (): RemoteAudioSample | RemoteVideoSample => {\n    const latestStat = this.getLatestStat();\n    const firstStat = this.getFirstStat();\n\n    const baseSample = {\n      timestamp: Date.now(),\n      total_pli_count: this.calculateDifferenceForSample('pliCount'),\n      total_nack_count: this.calculateDifferenceForSample('nackCount'),\n      avg_jitter_buffer_delay: this.calculateAverage('calculatedJitterBufferDelay', false),\n    };\n\n    if (latestStat.kind === 'video') {\n      return removeUndefinedFromObject<RemoteVideoSample>({\n        ...baseSample,\n        avg_av_sync_ms: this.calculateAvgAvSyncForSample(),\n        avg_frames_received_per_sec: this.calculateDifferenceAverage('framesReceived'),\n        avg_frames_dropped_per_sec: this.calculateDifferenceAverage('framesDropped'),\n        avg_frames_decoded_per_sec: this.calculateDifferenceAverage('framesDecoded'),\n        frame_width: this.calculateAverage('frameWidth'),\n        frame_height: this.calculateAverage('frameHeight'),\n        expected_frame_width: this.calculateAverage('expectedFrameWidth'),\n        expected_frame_height: this.calculateAverage('expectedFrameHeight'),\n        pause_count: this.calculateDifferenceForSample('pauseCount'),\n        pause_duration_seconds: this.calculateDifferenceForSample('totalPausesDuration'),\n        freeze_count: this.calculateDifferenceForSample('freezeCount'),\n        freeze_duration_seconds: this.calculateDifferenceForSample('totalFreezesDuration'),\n      });\n    } else {\n      const audio_concealed_samples =\n        (latestStat.concealedSamples || 0) -\n        (latestStat.silentConcealedSamples || 0) -\n        ((firstStat.concealedSamples || 0) - (firstStat.silentConcealedSamples || 0));\n\n      return removeUndefinedFromObject<RemoteAudioSample>({\n        ...baseSample,\n        audio_level: this.calculateInstancesOfHigh('audioLevel', 0.05),\n        audio_concealed_samples,\n        audio_total_samples_received: this.calculateDifferenceForSample('totalSamplesReceived'),\n        audio_concealment_events: this.calculateDifferenceForSample('concealmentEvents'),\n        fec_packets_discarded: this.calculateDifferenceForSample('fecPacketsDiscarded'),\n        fec_packets_received: this.calculateDifferenceForSample('fecPacketsReceived'),\n        total_samples_duration: this.calculateDifferenceForSample('totalSamplesDuration'),\n        total_packets_received: this.calculateDifferenceForSample('packetsReceived'),\n        total_packets_lost: this.calculateDifferenceForSample('packetsLost'),\n      });\n    }\n  };\n\n  shouldCreateSample = () => {\n    const length = this.tempStats.length;\n    const newStat = this.tempStats[length - 1];\n    const prevStat = this.tempStats[length - 2];\n\n    return (\n      length === SUBSCRIBE_STATS_SAMPLE_WINDOW ||\n      hasEnabledStateChanged(newStat, prevStat) ||\n      (newStat.kind === 'video' && hasResolutionChanged(newStat, prevStat))\n    );\n  };\n\n  toAnalytics = (): RemoteAudioTrackAnalytics | RemoteVideoTrackAnalytics => {\n    return {\n      track_id: this.track_id,\n      ssrc: this.ssrc,\n      source: this.source,\n      rid: this.rid,\n      samples: this.samples,\n    };\n  };\n\n  private calculateAvgAvSyncForSample() {\n    const avSyncValues = this.tempStats.map(stat => stat.avSync);\n    const validAvSyncValues: number[] = avSyncValues.filter(\n      (value): value is number => value !== undefined && value !== MAX_SAFE_INTEGER,\n    );\n    if (validAvSyncValues.length === 0) {\n      return MAX_SAFE_INTEGER;\n    }\n    return validAvSyncValues.reduce((a, b) => a + b, 0) / validAvSyncValues.length;\n  }\n}\n", "// Sent in trickle messages as target - biz understands only 0 and 1\nexport enum HMSConnectionRole {\n  Publish = 0,\n  Subscribe = 1,\n}\n\nexport interface HMSTrickle {\n  candidate: RTCIceCandidateInit;\n  target: HMSConnectionRole;\n}\n", "import * as sdpTransform from 'sdp-transform';\nimport { isPresent } from './validations';\nimport { TrackState } from '../notification-manager';\n\n/**\n * @DISCUSS: Should we have a wrapper over RTCSessionDescriptionInit(SDP) and have these methods in it?\n */\n\nexport function fixMsid(desc: RTCSessionDescriptionInit, tracks?: Map<string, TrackState>): RTCSessionDescriptionInit {\n  const parsedSdp = sdpTransform.parse(desc.sdp!);\n\n  if (!parsedSdp.origin?.username.startsWith('mozilla')) {\n    // This isn't firefox, so we return the original offer without doing anything\n    return desc;\n  }\n\n  const mediaTracks = tracks ? Array.from(tracks.values()) : [];\n\n  parsedSdp.media.forEach(m => {\n    const streamId = m.msid?.split(' ')[0];\n    // check for both type and streamid as both video and screenshare have same type but different stream_id\n    const trackId = mediaTracks.find(val => val.type === m.type && val.stream_id === streamId)?.track_id;\n    if (trackId) {\n      m.msid = m.msid?.replace(/\\s(.+)/, ` ${trackId}`);\n    }\n  });\n\n  return { type: desc.type, sdp: sdpTransform.write(parsedSdp) };\n}\n\n/**\n * Get the track ID from the SDP using the transceiver's mid from RTCTrackEvent\n * @TODO: This could take more processing time in a large room and when the SDP is big.\n * Consider using this for Firefox only?\n */\nexport function getSdpTrackIdForMid(\n  desc?: RTCSessionDescriptionInit | null,\n  mid?: RTCRtpTransceiver['mid'],\n): string | undefined {\n  if (!desc?.sdp || !mid) {\n    return undefined;\n  }\n  const parsedSdp = sdpTransform.parse(desc.sdp);\n  const trackSection = parsedSdp.media.find(media => isPresent(media.mid) && parseInt(media.mid!) === parseInt(mid));\n  const trackId = trackSection?.msid?.split(' ')[1];\n  return trackId;\n}\n\nexport function enableOpusDtx(desc: RTCSessionDescriptionInit): RTCSessionDescriptionInit {\n  if (desc.sdp!.includes('usedtx=1')) {\n    return desc;\n  }\n\n  return { type: desc.type, sdp: desc.sdp!.replace('useinbandfec=1', 'useinbandfec=1;usedtx=1') };\n}\n", "import IConnectionObserver, { RTCIceCandidatePair } from './IConnectionObserver';\nimport { HMSConnectionRole } from './model';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { HMSAudioTrackSettings, HMSVideoTrackSettings } from '../media/settings';\nimport { HMSLocalTrack, HMSLocalVideoTrack } from '../media/tracks';\nimport { TrackState } from '../notification-manager';\nimport JsonRpcSignal from '../signal/jsonrpc';\nimport HMSLogger from '../utils/logger';\nimport { enableOpusDtx, fixMsid } from '../utils/session-description';\n\nconst TAG = '[HMSConnection]';\n\nexport default abstract class HMSConnection {\n  readonly role: HMSConnectionRole;\n  protected readonly signal: JsonRpcSignal;\n\n  protected abstract readonly observer: IConnectionObserver;\n  abstract readonly nativeConnection: RTCPeerConnection;\n  /**\n   * We keep a list of pending IceCandidates received\n   * from the signalling server. When the peer-connection\n   * is initialized we call [addIceCandidate] for each.\n   *\n   * WARN:\n   *  - [HMSPublishConnection] keeps the complete list of candidates (for\n   *      ice-connection failed/disconnect) forever.\n   *  - [HMSSubscribeConnection] clears this list as soon as we call [addIceCandidate]\n   */\n  readonly candidates = new Array<RTCIceCandidateInit>();\n  // @ts-ignore\n  sfuNodeId?: string;\n\n  selectedCandidatePair?: RTCIceCandidatePair;\n\n  protected constructor(role: HMSConnectionRole, signal: JsonRpcSignal) {\n    this.role = role;\n    this.signal = signal;\n  }\n\n  public get iceConnectionState(): RTCIceConnectionState {\n    return this.nativeConnection.iceConnectionState;\n  }\n\n  public get connectionState(): RTCPeerConnectionState {\n    return this.nativeConnection.connectionState;\n  }\n\n  private get action() {\n    return this.role === HMSConnectionRole.Publish ? HMSAction.PUBLISH : HMSAction.SUBSCRIBE;\n  }\n\n  setSfuNodeId(nodeId?: string) {\n    this.sfuNodeId = nodeId;\n  }\n\n  addTransceiver(track: MediaStreamTrack, init: RTCRtpTransceiverInit): RTCRtpTransceiver {\n    return this.nativeConnection.addTransceiver(track, init);\n  }\n\n  async createOffer(tracks?: Map<string, TrackState>, options?: RTCOfferOptions): Promise<RTCSessionDescriptionInit> {\n    try {\n      const offer = await this.nativeConnection.createOffer(options);\n      HMSLogger.d(TAG, `[role=${this.role}] createOffer offer=${JSON.stringify(offer, null, 1)}`);\n      return enableOpusDtx(fixMsid(offer, tracks));\n    } catch (error) {\n      throw ErrorFactory.WebrtcErrors.CreateOfferFailed(this.action, (error as Error).message);\n    }\n  }\n\n  async createAnswer(options: RTCOfferOptions | undefined = undefined): Promise<RTCSessionDescriptionInit> {\n    try {\n      const answer = await this.nativeConnection.createAnswer(options);\n      HMSLogger.d(TAG, `[role=${this.role}] createAnswer answer=${JSON.stringify(answer, null, 1)}`);\n      return answer;\n    } catch (error) {\n      throw ErrorFactory.WebrtcErrors.CreateAnswerFailed(this.action, (error as Error).message);\n    }\n  }\n\n  async setLocalDescription(description: RTCSessionDescriptionInit): Promise<void> {\n    try {\n      HMSLogger.d(TAG, `[role=${this.role}] setLocalDescription description=${JSON.stringify(description, null, 1)}`);\n      await this.nativeConnection.setLocalDescription(description);\n    } catch (error) {\n      throw ErrorFactory.WebrtcErrors.SetLocalDescriptionFailed(this.action, (error as Error).message);\n    }\n  }\n\n  async setRemoteDescription(description: RTCSessionDescriptionInit): Promise<void> {\n    try {\n      HMSLogger.d(TAG, `[role=${this.role}] setRemoteDescription description=${JSON.stringify(description, null, 1)}`);\n      await this.nativeConnection.setRemoteDescription(description);\n    } catch (error) {\n      throw ErrorFactory.WebrtcErrors.SetRemoteDescriptionFailed(this.action, (error as Error).message);\n    }\n  }\n\n  async addIceCandidate(candidate: RTCIceCandidateInit): Promise<void> {\n    if (this.nativeConnection.signalingState === 'closed') {\n      HMSLogger.d(TAG, `[role=${this.role}] addIceCandidate signalling state closed`);\n      return;\n    }\n    HMSLogger.d(TAG, `[role=${this.role}] addIceCandidate candidate=${JSON.stringify(candidate, null, 1)}`);\n    await this.nativeConnection.addIceCandidate(candidate);\n  }\n\n  public get remoteDescription(): RTCSessionDescription | null {\n    return this.nativeConnection.remoteDescription;\n  }\n\n  getSenders(): Array<RTCRtpSender> {\n    return this.nativeConnection.getSenders();\n  }\n\n  handleSelectedIceCandidatePairs() {\n    /**\n     * for the very first peer in the room we don't have any subscribe ice candidates\n     * because the peer hasn't subscribed to anything.\n     *\n     * For all peers joining after this peer, we have published and subscribed at the time of join itself\n     * so we're able to log both publish and subscribe ice candidates.\n     * Added try catch for the whole section as the getSenders and getReceivers is throwing errors in load test\n     */\n    try {\n      const transmitters = this.role === HMSConnectionRole.Publish ? this.getSenders() : this.getReceivers();\n\n      transmitters.forEach(transmitter => {\n        const kindOfTrack = transmitter.track?.kind;\n        if (transmitter.transport) {\n          const iceTransport = transmitter.transport.iceTransport;\n\n          const handleSelectedCandidate = () => {\n            // @ts-expect-error\n            if (typeof iceTransport.getSelectedCandidatePair === 'function') {\n              // @ts-expect-error\n              this.selectedCandidatePair = iceTransport.getSelectedCandidatePair();\n              if (this.selectedCandidatePair) {\n                this.observer.onSelectedCandidatePairChange(this.selectedCandidatePair);\n                HMSLogger.d(\n                  TAG,\n                  `${HMSConnectionRole[this.role]} connection`,\n                  `selected ${kindOfTrack || 'unknown'} candidate pair`,\n                  JSON.stringify(this.selectedCandidatePair, null, 2),\n                );\n              }\n            }\n          };\n\n          // @ts-expect-error\n          if (typeof iceTransport.onselectedcandidatepairchange === 'function') {\n            // @ts-expect-error\n            iceTransport.onselectedcandidatepairchange = handleSelectedCandidate;\n          }\n          handleSelectedCandidate();\n        }\n      });\n    } catch (error) {\n      HMSLogger.w(\n        TAG,\n        `Error in logging selected ice candidate pair for ${HMSConnectionRole[this.role]} connection`,\n        error,\n      );\n    }\n  }\n\n  removeTrack(sender: RTCRtpSender) {\n    if (this.nativeConnection.signalingState !== 'closed') {\n      this.nativeConnection.removeTrack(sender);\n    }\n  }\n\n  // eslint-disable-next-line\n  async setMaxBitrateAndFramerate(\n    track: HMSLocalTrack,\n    updatedSettings?: HMSAudioTrackSettings | HMSVideoTrackSettings,\n  ) {\n    const maxBitrate = updatedSettings?.maxBitrate || track.settings.maxBitrate;\n    const maxFramerate = track instanceof HMSLocalVideoTrack && track.settings.maxFramerate;\n    const sender = this.getSenders().find(s => s?.track?.id === track.getTrackIDBeingSent());\n\n    if (sender) {\n      const params = sender.getParameters();\n      // modify only for non-simulcast encodings\n      if (params.encodings.length === 1) {\n        if (maxBitrate) {\n          params.encodings[0].maxBitrate = maxBitrate * 1000;\n        }\n        if (maxFramerate) {\n          // @ts-ignore\n          params.encodings[0].maxFramerate = maxFramerate;\n        }\n      }\n      await sender.setParameters(params);\n    } else {\n      HMSLogger.w(\n        TAG,\n        `no sender found to setMaxBitrate for track - ${track.trackId}, sentTrackId - ${track.getTrackIDBeingSent()}`,\n      );\n    }\n  }\n\n  async getStats() {\n    return await this.nativeConnection.getStats();\n  }\n\n  close() {\n    this.nativeConnection.close();\n  }\n\n  private getReceivers() {\n    return this.nativeConnection.getReceivers();\n  }\n}\n", "import { IPublishConnectionObserver } from './IPublishConnectionObserver';\nimport JsonRpcSignal from '../../signal/jsonrpc';\nimport { API_DATA_CHANNEL } from '../../utils/constants';\nimport HMSLogger from '../../utils/logger';\nimport HMSConnection from '../HMSConnection';\nimport { HMSConnectionRole } from '../model';\n\nexport default class HMSPublishConnection extends HMSConnection {\n  private readonly TAG = '[HMSPublishConnection]';\n  protected readonly observer: IPublishConnectionObserver;\n  readonly nativeConnection: RTCPeerConnection;\n  readonly channel: RTCDataChannel;\n\n  constructor(signal: JsonRpcSignal, config: RTCConfiguration, observer: IPublishConnectionObserver) {\n    super(HMSConnectionRole.Publish, signal);\n    this.observer = observer;\n\n    this.nativeConnection = new RTCPeerConnection(config);\n    this.channel = this.nativeConnection.createDataChannel(API_DATA_CHANNEL, {\n      protocol: 'SCTP',\n    });\n    this.channel.onerror = ev => HMSLogger.e(this.TAG, `publish data channel onerror ${ev}`, ev);\n\n    this.nativeConnection.onicecandidate = ({ candidate }) => {\n      if (candidate) {\n        this.observer.onIceCandidate(candidate);\n        signal.trickle(this.role, candidate);\n      }\n    };\n\n    this.nativeConnection.oniceconnectionstatechange = () => {\n      this.observer.onIceConnectionChange(this.nativeConnection.iceConnectionState);\n    };\n\n    this.nativeConnection.onconnectionstatechange = () => {\n      this.observer.onConnectionStateChange(this.nativeConnection.connectionState);\n\n      // here it replaces the original listener if already present and\n      // handles cases where sctp transport is reinitialised\n      if (this.nativeConnection.sctp) {\n        this.nativeConnection.sctp.transport.onstatechange = () => {\n          this.observer.onDTLSTransportStateChange(this.nativeConnection.sctp?.transport.state);\n        };\n        this.nativeConnection.sctp.transport.onerror = (event: Event) => {\n          this.observer.onDTLSTransportError(\n            new Error((event as RTCErrorEvent)?.error?.errorDetail) || 'DTLS Transport failed',\n          );\n        };\n      }\n    };\n  }\n\n  close() {\n    super.close();\n    this.channel.close();\n  }\n\n  initAfterJoin() {\n    this.nativeConnection.onnegotiationneeded = async () => {\n      HMSLogger.d(this.TAG, `onnegotiationneeded`);\n      await this.observer.onRenegotiationNeeded();\n    };\n  }\n}\n", "import EventEmitter from 'eventemitter2';\nimport { v4 as uuid } from 'uuid';\nimport ISubscribeConnectionObserver from './ISubscribeConnectionObserver';\nimport { HMSRemoteStream, HMSSimulcastLayer } from '../../internal';\nimport { HMSRemoteAudioTrack } from '../../media/tracks/HMSRemoteAudioTrack';\nimport { HMSRemoteVideoTrack } from '../../media/tracks/HMSRemoteVideoTrack';\nimport { InitFlags } from '../../signal/init/models';\nimport JsonRpcSignal from '../../signal/jsonrpc';\nimport { API_DATA_CHANNEL } from '../../utils/constants';\nimport HMSLogger from '../../utils/logger';\nimport { getSdpTrackIdForMid } from '../../utils/session-description';\nimport { workerSleep } from '../../utils/timer-utils';\nimport { PreferAudioLayerParams, PreferLayerResponse, PreferVideoLayerParams } from '../channel-messages';\nimport HMSConnection from '../HMSConnection';\nimport HMSDataChannel from '../HMSDataChannel';\nimport { HMSConnectionRole } from '../model';\n\nexport default class HMSSubscribeConnection extends HMSConnection {\n  private readonly TAG = '[HMSSubscribeConnection]';\n  private readonly remoteStreams = new Map<string, HMSRemoteStream>();\n  protected readonly observer: ISubscribeConnectionObserver;\n  private readonly MAX_RETRIES = 3;\n\n  readonly nativeConnection: RTCPeerConnection;\n\n  private pendingMessageQueue: string[] = [];\n\n  private apiChannel?: HMSDataChannel;\n  private eventEmitter = new EventEmitter({ maxListeners: 60 });\n\n  private initNativeConnectionCallbacks() {\n    this.nativeConnection.oniceconnectionstatechange = () => {\n      this.observer.onIceConnectionChange(this.nativeConnection.iceConnectionState);\n    };\n\n    // @TODO(eswar): Remove this. Use iceconnectionstate change with interval and threshold.\n    this.nativeConnection.onconnectionstatechange = () => {\n      this.observer.onConnectionStateChange(this.nativeConnection.connectionState);\n    };\n\n    this.nativeConnection.ondatachannel = e => {\n      if (e.channel.label !== API_DATA_CHANNEL) {\n        // TODO: this.observer.onDataChannel(e.channel);\n        return;\n      }\n\n      this.apiChannel = new HMSDataChannel(\n        e.channel,\n        {\n          onMessage: (value: string) => {\n            this.eventEmitter.emit('message', value);\n            this.observer.onApiChannelMessage(value);\n          },\n        },\n        `role=${this.role}`,\n      );\n\n      e.channel.onopen = this.handlePendingApiMessages;\n    };\n\n    this.nativeConnection.onicecandidate = e => {\n      if (e.candidate !== null) {\n        this.observer.onIceCandidate(e.candidate);\n        this.signal.trickle(this.role, e.candidate);\n      }\n    };\n\n    this.nativeConnection.ontrack = e => {\n      const stream = e.streams[0];\n      const streamId = stream.id;\n\n      if (!this.remoteStreams.has(streamId)) {\n        const remote = new HMSRemoteStream(stream, this);\n        this.remoteStreams.set(streamId, remote);\n      }\n\n      stream.addEventListener('removetrack', (ev: MediaStreamTrackEvent) => {\n        if (ev.track.id !== e.track.id) {\n          return;\n        }\n        /*\n         * this match has to be with nativetrack.id instead of track.trackId as the latter refers to sdp track id for\n         * ease of correlating update messages coming from the backend. The two track ids are usually the same, but\n         * can be different for some browsers. checkout sdptrackid field in HMSTrack for more details.\n         */\n        const toRemoveTrackIdx = remote.tracks.findIndex(\n          track => track.nativeTrack.id === ev.track.id && e.transceiver.mid === track.transceiver?.mid,\n        );\n        if (toRemoveTrackIdx >= 0) {\n          const toRemoveTrack = remote.tracks[toRemoveTrackIdx];\n          this.observer.onTrackRemove(toRemoveTrack);\n          remote.tracks.splice(toRemoveTrackIdx, 1);\n          // If the length becomes 0 we assume that stream is removed entirely\n          if (remote.tracks.length === 0) {\n            this.remoteStreams.delete(streamId);\n          }\n        }\n      });\n\n      const remote = this.remoteStreams.get(streamId)!;\n      const TrackCls = e.track.kind === 'audio' ? HMSRemoteAudioTrack : HMSRemoteVideoTrack;\n      const track = new TrackCls(remote, e.track);\n      // reset the simulcast layer to none when new video tracks are added, UI will subscribe when required\n      if (e.track.kind === 'video') {\n        remote.setVideoLayerLocally(HMSSimulcastLayer.NONE, 'addTrack', 'subscribeConnection');\n      }\n      track.transceiver = e.transceiver;\n      const trackId = getSdpTrackIdForMid(this.remoteDescription, e.transceiver?.mid);\n      trackId && track.setSdpTrackId(trackId);\n      remote.tracks.push(track);\n      this.observer.onTrackAdd(track);\n    };\n  }\n\n  constructor(\n    signal: JsonRpcSignal,\n    config: RTCConfiguration,\n    private isFlagEnabled: (flag: InitFlags) => boolean,\n    observer: ISubscribeConnectionObserver,\n  ) {\n    super(HMSConnectionRole.Subscribe, signal);\n    this.observer = observer;\n\n    this.nativeConnection = new RTCPeerConnection(config);\n    this.initNativeConnectionCallbacks();\n  }\n\n  sendOverApiDataChannel(message: string) {\n    if (this.apiChannel && this.apiChannel.readyState === 'open') {\n      this.apiChannel.send(message);\n    } else {\n      HMSLogger.w(this.TAG, `API Data channel not ${this.apiChannel ? 'open' : 'present'}, queueing`, message);\n      this.pendingMessageQueue.push(message);\n    }\n  }\n\n  async sendOverApiDataChannelWithResponse<T extends PreferAudioLayerParams | PreferVideoLayerParams>(\n    message: T,\n    requestId?: string,\n  ): Promise<PreferLayerResponse> {\n    const id = uuid();\n    if (message.method === 'prefer-video-track-state') {\n      const disableAutoUnsubscribe = this.isFlagEnabled(InitFlags.FLAG_DISABLE_VIDEO_TRACK_AUTO_UNSUBSCRIBE);\n      if (disableAutoUnsubscribe && message.params.max_spatial_layer === HMSSimulcastLayer.NONE) {\n        HMSLogger.d(this.TAG, 'video auto unsubscribe is disabled, request is ignored');\n        return { id } as PreferLayerResponse;\n      }\n    }\n    const request = JSON.stringify({\n      id: requestId || id,\n      jsonrpc: '2.0',\n      ...message,\n    });\n    return this.sendMessage(request, id);\n  }\n\n  close() {\n    super.close();\n    this.apiChannel?.close();\n  }\n\n  private handlePendingApiMessages = () => {\n    this.eventEmitter.emit('open', true);\n    if (this.pendingMessageQueue.length > 0) {\n      HMSLogger.d(this.TAG, 'Found pending message queue, sending messages');\n      this.pendingMessageQueue.forEach(msg => this.sendOverApiDataChannel(msg));\n      this.pendingMessageQueue.length = 0;\n    }\n  };\n\n  // eslint-disable-next-line complexity\n  private sendMessage = async (request: string, requestId: string): Promise<PreferLayerResponse> => {\n    if (this.apiChannel?.readyState !== 'open') {\n      await this.eventEmitter.waitFor('open');\n    }\n    let response: PreferLayerResponse;\n    for (let i = 0; i < this.MAX_RETRIES; i++) {\n      this.apiChannel!.send(request);\n      response = await this.waitForResponse(requestId);\n      const error = response.error;\n      if (error) {\n        // Don't retry or do anything, track is already removed\n        if (error.code === 404) {\n          HMSLogger.d(this.TAG, `Track not found ${requestId}`, { request, try: i + 1, error });\n          break;\n        }\n        HMSLogger.d(this.TAG, `Failed sending ${requestId}`, { request, try: i + 1, error });\n        const shouldRetry = error.code / 100 === 5 || error.code === 429;\n        if (!shouldRetry) {\n          throw Error(`code=${error.code}, message=${error.message}`);\n        }\n        const delay = (2 + Math.random() * 2) * 1000;\n        await workerSleep(delay);\n      } else {\n        break;\n      }\n    }\n    return response!;\n  };\n\n  private waitForResponse = async (requestId: string): Promise<PreferLayerResponse> => {\n    const res = await this.eventEmitter.waitFor('message', function (value) {\n      return value.includes(requestId);\n    });\n    const response = JSON.parse(res[0] as string);\n    HMSLogger.d(this.TAG, `response for ${requestId} -`, JSON.stringify(response, null, 2));\n    return response;\n  };\n}\n", "import HMSLogger from '../utils/logger';\n\nexport interface DataChannelObserver {\n  onMessage(value: string): void;\n}\n\nexport default class HMSDataChannel {\n  private readonly TAG = '[HMSDataChannel]';\n  private readonly nativeChannel: RTCDataChannel;\n  private readonly observer: DataChannelObserver;\n  private readonly metadata: string;\n\n  public get id() {\n    return this.nativeChannel.id;\n  }\n\n  public get label() {\n    return this.nativeChannel.label;\n  }\n\n  public get readyState() {\n    return this.nativeChannel.readyState;\n  }\n\n  constructor(nativeChannel: RTCDataChannel, observer: DataChannelObserver, metadata = '') {\n    this.nativeChannel = nativeChannel;\n    this.observer = observer;\n    this.metadata = metadata;\n\n    nativeChannel.onmessage = e => {\n      // HMSLogger.d(this.TAG, `[${this.metadata}] onMessage: label=${this.label}, message=${e.data}`);\n      this.observer.onMessage(e.data);\n    };\n  }\n\n  send(message: string) {\n    HMSLogger.d(this.TAG, `[${this.metadata}] Sending [size=${message.length}] message=${message}`);\n    this.nativeChannel.send(message);\n  }\n\n  close() {\n    this.nativeChannel.close();\n  }\n}\n", "import { HMSICEServer } from '../interfaces';\n\nexport const transformIceServerConfig = (defaultConfig?: RTCIceServer[], iceServers?: HMSICEServer[]) => {\n  if (!iceServers || iceServers.length === 0) {\n    return defaultConfig;\n  }\n  const transformedIceServers = iceServers.map(server => {\n    return { urls: server.urls, credentialType: 'password', credential: server.password, username: server.userName };\n  });\n  return transformedIceServers;\n};\n", "import { InitConfig } from './models';\nimport { ErrorFactory } from '../../error/ErrorFactory';\nimport { HMSAction } from '../../error/HMSAction';\nimport { HMSICEServer } from '../../interfaces';\nimport { HMSException } from '../../internal';\nimport { transformIceServerConfig } from '../../utils/ice-server-config';\nimport HMSLogger from '../../utils/logger';\n\nconst TAG = '[InitService]';\nexport default class InitService {\n  private static handleError(response: Response, body: { code: number; message: string }) {\n    switch (response.status) {\n      case 404:\n        throw ErrorFactory.APIErrors.EndpointUnreachable(HMSAction.INIT, body.message || response.statusText);\n      case 200:\n        break;\n      default:\n        throw ErrorFactory.APIErrors.ServerErrors(\n          body.code || response.status,\n          HMSAction.INIT,\n          body.message || response?.statusText,\n        );\n    }\n  }\n\n  static async fetchInitConfig({\n    token,\n    peerId,\n    userAgent,\n    initEndpoint = 'https://prod-init.100ms.live',\n    region = '',\n    iceServers,\n  }: {\n    token: string;\n    peerId: string;\n    userAgent: string;\n    initEndpoint?: string;\n    region?: string;\n    iceServers?: HMSICEServer[];\n  }): Promise<InitConfig> {\n    HMSLogger.d(TAG, `fetchInitConfig: initEndpoint=${initEndpoint} token=${token} peerId=${peerId} region=${region} `);\n    const url = getUrl(initEndpoint, peerId, userAgent, region);\n    try {\n      const response = await fetch(url, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      try {\n        const config = await response.clone().json();\n        this.handleError(response, config);\n        HMSLogger.d(TAG, `config is ${JSON.stringify(config, null, 2)}`);\n        return transformInitConfig(config, iceServers);\n      } catch (err) {\n        const text = await response.text();\n        HMSLogger.e(TAG, 'json error', (err as Error).message, text);\n        throw err instanceof HMSException\n          ? err\n          : ErrorFactory.APIErrors.ServerErrors(response.status, HMSAction.INIT, (err as Error).message);\n      }\n    } catch (err) {\n      const error = err as Error;\n      if (['Failed to fetch', 'NetworkError', 'ECONNRESET'].some(message => error.message.includes(message))) {\n        throw ErrorFactory.APIErrors.EndpointUnreachable(HMSAction.INIT, error.message);\n      }\n      throw error;\n    }\n  }\n}\n\nexport function getUrl(endpoint: string, peerId: string, userAgent: string, region?: string) {\n  try {\n    const url = new URL('/init', endpoint);\n\n    if (region && region.trim().length > 0) {\n      url.searchParams.set('region', region.trim());\n    }\n    url.searchParams.set('peer_id', peerId);\n    url.searchParams.set('user_agent_v2', userAgent);\n    return url.toString();\n  } catch (err) {\n    const error = err as Error;\n    HMSLogger.e(TAG, error.name, error.message);\n    throw error;\n  }\n}\n\nexport function transformInitConfig(config: any, iceServers?: HMSICEServer[]): InitConfig {\n  return {\n    ...config,\n    rtcConfiguration: {\n      ...config.rtcConfiguration,\n      iceServers: transformIceServerConfig(config.rtcConfiguration?.ice_servers, iceServers),\n    },\n  };\n}\n", "import { v4 as uuid } from 'uuid';\nimport { convertSignalMethodtoErrorAction, HMSSignalMethod, JsonRpcRequest, JsonRpcResponse } from './models';\nimport AnalyticsEvent from '../../analytics/AnalyticsEvent';\nimport { HMSConnectionRole, HMSTrickle } from '../../connection/model';\nimport { ErrorFactory } from '../../error/ErrorFactory';\nimport { HMSAction } from '../../error/HMSAction';\nimport { HMSException } from '../../error/HMSException';\nimport { PeerNotificationInfo, SendMessage } from '../../notification-manager';\nimport {\n  DEFAULT_SIGNAL_PING_INTERVAL,\n  DEFAULT_SIGNAL_PING_TIMEOUT,\n  PONG_RESPONSE_TIMES_SIZE,\n} from '../../utils/constants';\nimport HMSLogger from '../../utils/logger';\nimport { PromiseCallbacks } from '../../utils/promise';\nimport { Queue } from '../../utils/queue';\nimport { isPageHidden } from '../../utils/support';\nimport { workerSleep } from '../../utils/timer-utils';\nimport {\n  AcceptRoleChangeParams,\n  BroadcastResponse,\n  CreateWhiteboardResponse,\n  FindPeerByNameRequestParams,\n  FindPeerByNameResponse,\n  FindPeersRequestParams,\n  GetPeerRequestParams,\n  GetSessionMetadataResponse,\n  GetWhiteboardResponse,\n  HLSRequestParams,\n  HLSTimedMetadataParams,\n  HMSPermissionType,\n  HMSWhiteboardCreateOptions,\n  JoinLeaveGroupResponse,\n  MultiTrackUpdateRequestParams,\n  PeerIterRequestParams,\n  PeersIterationResponse,\n  PollInfoGetParams,\n  PollInfoGetResponse,\n  PollInfoSetParams,\n  PollInfoSetResponse,\n  PollLeaderboardGetParams,\n  PollLeaderboardGetResponse,\n  PollListParams,\n  PollListResponse,\n  PollQuestionsGetParams,\n  PollQuestionsGetResponse,\n  PollQuestionsSetParams,\n  PollQuestionsSetResponse,\n  PollResponseSetParams,\n  PollResponseSetResponse,\n  PollResponsesGetParams,\n  PollResponsesGetResponse,\n  PollResultParams,\n  PollResultResponse,\n  PollStartParams,\n  PollStartResponse,\n  PollStopParams,\n  PollStopResponse,\n  RemovePeerRequest,\n  RequestForBulkRoleChangeParams,\n  RequestForRoleChangeParams,\n  SetSessionMetadataParams,\n  SetSessionMetadataResponse,\n  StartRTMPOrRecordingRequestParams,\n  StartTranscriptionRequestParams,\n  Track,\n  TrackUpdateRequestParams,\n  UpdatePeerRequestParams,\n} from '../interfaces';\nimport { ISignalEventsObserver } from '../ISignalEventsObserver';\n\nexport default class JsonRpcSignal {\n  readonly TAG = '[SIGNAL]: ';\n  readonly observer: ISignalEventsObserver;\n  readonly pongResponseTimes = new Queue<number>(PONG_RESPONSE_TIMES_SIZE);\n\n  /**\n   * Sometimes before [join] is completed, there could be a lot of trickles\n   * Sending [HMSTrickle]` before [join] web socket message leads to\n   * error: [500] no rtc transport exists for this Peer\n   *\n   * We keep a list of pending trickles and send them immediately after [join]\n   * is done.\n   */\n  private isJoinCompleted = false;\n  private pendingTrickle: Array<HMSTrickle> = [];\n\n  private socket: WebSocket | null = null;\n\n  private callbacks = new Map<string, PromiseCallbacks<string, { method: HMSSignalMethod }>>();\n\n  private _isConnected = false;\n  private id = 0;\n  private sfuNodeId: string | undefined;\n\n  private onCloseHandler: (event: CloseEvent) => void = () => {};\n\n  public get isConnected(): boolean {\n    return this._isConnected;\n  }\n\n  setSfuNodeId(sfuNodeId?: string) {\n    this.sfuNodeId = sfuNodeId;\n  }\n\n  public setIsConnected(newValue: boolean, reason = '') {\n    HMSLogger.d(this.TAG, `isConnected set id: ${this.id}, oldValue: ${this._isConnected}, newValue: ${newValue}`);\n    if (this._isConnected === newValue) {\n      return;\n    }\n\n    if (this._isConnected && !newValue) {\n      // went offline\n      this._isConnected = newValue;\n      this.rejectPendingCalls(reason);\n      this.observer.onOffline(reason);\n    } else if (!this._isConnected && newValue) {\n      // went online\n      this._isConnected = newValue;\n      this.observer.onOnline();\n    }\n  }\n\n  constructor(observer: ISignalEventsObserver) {\n    this.observer = observer;\n    window.addEventListener('offline', this.offlineListener);\n    window.addEventListener('online', this.onlineListener);\n\n    this.onMessageHandler = this.onMessageHandler.bind(this);\n  }\n\n  getPongResponseTimes() {\n    return this.pongResponseTimes.toList();\n  }\n\n  private async internalCall<T>(method: string, params: any): Promise<T> {\n    const id = uuid();\n    const message = { method, params, id, jsonrpc: '2.0' } as JsonRpcRequest;\n\n    this.socket?.send(JSON.stringify(message));\n\n    try {\n      const response = await new Promise<any>((resolve, reject) => {\n        this.callbacks.set(id, { resolve, reject, metadata: { method: method as HMSSignalMethod } });\n      });\n\n      return response;\n    } catch (ex) {\n      if (ex instanceof HMSException) {\n        throw ex;\n      }\n\n      const error = ex as JsonRpcResponse['error'];\n      throw ErrorFactory.WebsocketMethodErrors.ServerErrors(\n        Number(error.code),\n        convertSignalMethodtoErrorAction(method as HMSSignalMethod),\n        error.message,\n      );\n    }\n  }\n\n  private notify(method: string, params: any) {\n    const message = { method, params };\n\n    if (this.socket?.readyState === WebSocket.OPEN) {\n      this.socket?.send(JSON.stringify(message));\n    }\n  }\n\n  open(uri: string): Promise<void> {\n    return new Promise((resolve, reject) => {\n      let promiseSettled = false;\n      // cleanup\n      if (this.socket) {\n        this.socket.close();\n        this.socket.removeEventListener('close', this.onCloseHandler);\n        this.socket.removeEventListener('message', this.onMessageHandler);\n      }\n\n      this.socket = new WebSocket(uri); // @DISCUSS: Inject WebSocket as a dependency so that it can be easier to mock and test\n\n      const errorListener = () => {\n        /**\n         * there was an error received from websocket leading to disconnection, this can happen either if server\n         * disconnects the websocket for some reason, there is a network disconnect or a firewall/antivirus on user's\n         * device is breaking the websocket connecting(which can happen even after a successful connect).\n         */\n        HMSLogger.e(this.TAG, 'Error from websocket');\n        promiseSettled = true;\n        // above error does not contain any description hence not sent here\n        reject(\n          ErrorFactory.WebSocketConnectionErrors.FailedToConnect(HMSAction.JOIN, `Error opening websocket connection`),\n        );\n      };\n\n      this.onCloseHandler = (event: CloseEvent) => {\n        HMSLogger.w(`Websocket closed code=${event.code}`);\n        if (promiseSettled) {\n          this.setIsConnected(false, `code: ${event.code}${event.code !== 1000 ? ', unexpected websocket close' : ''}`);\n        } else {\n          promiseSettled = true;\n          reject(\n            ErrorFactory.WebSocketConnectionErrors.AbnormalClose(\n              HMSAction.JOIN,\n              `Error opening websocket connection - websocket closed unexpectedly with code=${event.code}`,\n            ),\n          );\n        }\n      };\n\n      this.socket.addEventListener('error', errorListener);\n\n      const openHandler = () => {\n        promiseSettled = true;\n        resolve();\n        this.setIsConnected(true);\n        this.id++;\n        this.socket?.removeEventListener('open', openHandler);\n        this.socket?.removeEventListener('error', errorListener);\n        this.pingPongLoop(this.id);\n      };\n\n      this.socket.addEventListener('open', openHandler);\n      this.socket.addEventListener('close', this.onCloseHandler);\n      this.socket.addEventListener('message', this.onMessageHandler);\n    });\n  }\n\n  async close(): Promise<void> {\n    window.removeEventListener('offline', this.offlineListener);\n    window.removeEventListener('online', this.onlineListener);\n\n    // For `1000` Refer: https://tools.ietf.org/html/rfc6455#section-7.4.1\n    if (this.socket) {\n      this.socket.close(1000, 'Normal Close');\n      this.setIsConnected(false, 'code: 1000, normal websocket close');\n      this.socket.removeEventListener('close', this.onCloseHandler);\n      this.socket.removeEventListener('message', this.onMessageHandler);\n    } else {\n      this.setIsConnected(false, 'websocket not connected yet');\n    }\n  }\n\n  async join(\n    name: string,\n    data: string,\n    disableVidAutoSub: boolean,\n    serverSubDegrade: boolean,\n    simulcast: boolean,\n    onDemandTracks: boolean,\n    offer?: RTCSessionDescriptionInit,\n  ): Promise<RTCSessionDescriptionInit & { sfu_node_id: string | undefined }> {\n    if (!this.isConnected) {\n      throw ErrorFactory.WebSocketConnectionErrors.WebSocketConnectionLost(\n        HMSAction.JOIN,\n        'Failed to send join over WS connection',\n      );\n    }\n    const params = {\n      name,\n      disableVidAutoSub,\n      data,\n      offer,\n      server_sub_degrade: serverSubDegrade,\n      simulcast,\n      onDemandTracks,\n    };\n    const response: RTCSessionDescriptionInit & { sfu_node_id: string | undefined } = await this.internalCall(\n      HMSSignalMethod.JOIN,\n      params,\n    );\n\n    this.isJoinCompleted = true;\n    this.pendingTrickle.forEach(({ target, candidate }) => this.trickle(target, candidate));\n    this.pendingTrickle.length = 0;\n\n    HMSLogger.d(this.TAG, `join: response=${JSON.stringify(response, null, 1)}`);\n    return response;\n  }\n\n  trickle(target: HMSConnectionRole, candidate: RTCIceCandidateInit) {\n    if (this.isJoinCompleted) {\n      this.notify(HMSSignalMethod.TRICKLE, { target, candidate, sfu_node_id: this.sfuNodeId });\n    } else {\n      this.pendingTrickle.push({ target, candidate });\n    }\n  }\n\n  async offer(desc: RTCSessionDescriptionInit, tracks: Map<string, any>): Promise<RTCSessionDescriptionInit> {\n    const response = await this.call(HMSSignalMethod.OFFER, {\n      desc,\n      tracks: Object.fromEntries(tracks),\n      sfu_node_id: this.sfuNodeId,\n    });\n    return response as RTCSessionDescriptionInit;\n  }\n\n  answer(desc: RTCSessionDescriptionInit) {\n    this.notify(HMSSignalMethod.ANSWER, { desc, sfu_node_id: this.sfuNodeId });\n  }\n\n  trackUpdate(tracks: Map<string, Track>) {\n    this.notify(HMSSignalMethod.TRACK_UPDATE, { tracks: Object.fromEntries(tracks) });\n  }\n\n  async broadcast(message: SendMessage) {\n    return await this.call<BroadcastResponse>(HMSSignalMethod.BROADCAST, message);\n  }\n\n  leave() {\n    this.notify(HMSSignalMethod.LEAVE, {});\n  }\n\n  async endRoom(lock: boolean, reason: string) {\n    await this.call(HMSSignalMethod.END_ROOM, { lock, reason });\n  }\n\n  sendEvent(event: AnalyticsEvent) {\n    if (!this.isConnected) {\n      throw Error(`${this.TAG} not connected. Could not send event ${event}`);\n    }\n    this.notify(HMSSignalMethod.ANALYTICS, event.toSignalParams());\n  }\n\n  ping(timeout: number): Promise<number> {\n    const pingTime = Date.now();\n    const timer: Promise<number> = new Promise(resolve => {\n      setTimeout(() => {\n        resolve(Date.now() - pingTime);\n      }, timeout + 1);\n    });\n    const pongTimeDiff = this.internalCall(HMSSignalMethod.PING, { timestamp: pingTime })\n      .then(() => Date.now() - pingTime)\n      .catch(() => Date.now() - pingTime);\n\n    return Promise.race([timer, pongTimeDiff]);\n  }\n\n  async requestRoleChange(params: RequestForRoleChangeParams) {\n    await this.call(HMSSignalMethod.ROLE_CHANGE_REQUEST, params);\n  }\n\n  async requestBulkRoleChange(params: RequestForBulkRoleChangeParams) {\n    await this.call(HMSSignalMethod.ROLE_CHANGE_REQUEST, params);\n  }\n\n  async acceptRoleChangeRequest(params: AcceptRoleChangeParams) {\n    await this.call(HMSSignalMethod.ROLE_CHANGE, params);\n  }\n\n  async requestTrackStateChange(params: TrackUpdateRequestParams) {\n    await this.call(HMSSignalMethod.TRACK_UPDATE_REQUEST, params);\n  }\n\n  async requestMultiTrackStateChange(params: MultiTrackUpdateRequestParams) {\n    await this.call(HMSSignalMethod.CHANGE_TRACK_MUTE_STATE_REQUEST, params);\n  }\n\n  async removePeer(params: RemovePeerRequest) {\n    await this.call(HMSSignalMethod.PEER_LEAVE_REQUEST, params);\n  }\n\n  async startRTMPOrRecording(params: StartRTMPOrRecordingRequestParams) {\n    await this.call(HMSSignalMethod.START_RTMP_OR_RECORDING_REQUEST, { ...params });\n  }\n\n  async stopRTMPAndRecording() {\n    await this.call(HMSSignalMethod.STOP_RTMP_AND_RECORDING_REQUEST, {});\n  }\n\n  async startHLSStreaming(params: HLSRequestParams): Promise<void> {\n    await this.call(HMSSignalMethod.START_HLS_STREAMING, { ...params });\n  }\n\n  async stopHLSStreaming(params?: HLSRequestParams): Promise<void> {\n    await this.call(HMSSignalMethod.STOP_HLS_STREAMING, { ...params });\n  }\n\n  async startTranscription(params: StartTranscriptionRequestParams) {\n    await this.call(HMSSignalMethod.START_TRANSCRIPTION, { ...params });\n  }\n\n  async stopTranscription(params: StartTranscriptionRequestParams) {\n    await this.call(HMSSignalMethod.STOP_TRANSCRIPTION, { ...params });\n  }\n\n  async sendHLSTimedMetadata(params?: HLSTimedMetadataParams): Promise<void> {\n    await this.call(HMSSignalMethod.HLS_TIMED_METADATA, { ...params });\n  }\n\n  async updatePeer(params: UpdatePeerRequestParams) {\n    await this.call(HMSSignalMethod.UPDATE_PEER_METADATA, { ...params });\n  }\n\n  async getPeer(params: GetPeerRequestParams): Promise<PeerNotificationInfo | undefined> {\n    return await this.call(HMSSignalMethod.GET_PEER, { ...params });\n  }\n\n  async joinGroup(name: string): Promise<JoinLeaveGroupResponse> {\n    return await this.call(HMSSignalMethod.GROUP_JOIN, { name });\n  }\n\n  async leaveGroup(name: string): Promise<JoinLeaveGroupResponse> {\n    return await this.call(HMSSignalMethod.GROUP_LEAVE, { name });\n  }\n\n  async addToGroup(peerId: string, name: string) {\n    await this.call(HMSSignalMethod.GROUP_ADD, { name, peer_id: peerId });\n  }\n\n  async removeFromGroup(peerId: string, name: string): Promise<void> {\n    await this.call(HMSSignalMethod.GROUP_REMOVE, { name, peer_id: peerId });\n  }\n\n  async peerIterNext(params: PeerIterRequestParams): Promise<PeersIterationResponse> {\n    return await this.call(HMSSignalMethod.PEER_ITER_NEXT, params);\n  }\n\n  async findPeers(params: FindPeersRequestParams): Promise<PeersIterationResponse> {\n    return await this.call(HMSSignalMethod.FIND_PEER, params);\n  }\n\n  async findPeerByName(params: FindPeerByNameRequestParams): Promise<FindPeerByNameResponse> {\n    return await this.call(HMSSignalMethod.SEARCH_BY_NAME, params);\n  }\n\n  setSessionMetadata(params: SetSessionMetadataParams) {\n    if (!this.isConnected) {\n      throw ErrorFactory.WebSocketConnectionErrors.WebSocketConnectionLost(\n        HMSAction.RECONNECT_SIGNAL,\n        'Failed to set session store value due to network disconnection',\n      );\n    }\n    return this.call<SetSessionMetadataResponse>(HMSSignalMethod.SET_METADATA, { ...params });\n  }\n\n  listenMetadataChange(keys: string[]): Promise<void> {\n    if (!this.isConnected) {\n      throw ErrorFactory.WebSocketConnectionErrors.WebSocketConnectionLost(\n        HMSAction.RECONNECT_SIGNAL,\n        'Failed to observe session store key due to network disconnection',\n      );\n    }\n    return this.call(HMSSignalMethod.LISTEN_METADATA_CHANGE, { keys });\n  }\n\n  getSessionMetadata(key?: string) {\n    if (!this.isConnected) {\n      throw ErrorFactory.WebSocketConnectionErrors.WebSocketConnectionLost(\n        HMSAction.RECONNECT_SIGNAL,\n        'Failed to set session store value due to network disconnection',\n      );\n    }\n    return this.call<GetSessionMetadataResponse>(HMSSignalMethod.GET_METADATA, { key });\n  }\n\n  setPollInfo(params: PollInfoSetParams) {\n    return this.call<PollInfoSetResponse>(HMSSignalMethod.POLL_INFO_SET, { ...params });\n  }\n\n  getPollInfo(params: PollInfoGetParams) {\n    return this.call<PollInfoGetResponse>(HMSSignalMethod.POLL_INFO_GET, { ...params });\n  }\n\n  setPollQuestions(params: PollQuestionsSetParams) {\n    return this.call<PollQuestionsSetResponse>(HMSSignalMethod.POLL_QUESTIONS_SET, { ...params });\n  }\n\n  startPoll(params: PollStartParams) {\n    return this.call<PollStartResponse>(HMSSignalMethod.POLL_START, { ...params });\n  }\n\n  stopPoll(params: PollStopParams) {\n    return this.call<PollStopResponse>(HMSSignalMethod.POLL_STOP, { ...params });\n  }\n\n  getPollQuestions(params: PollQuestionsGetParams): Promise<PollQuestionsGetResponse> {\n    return this.call<PollQuestionsGetResponse>(HMSSignalMethod.POLL_QUESTIONS_GET, { ...params });\n  }\n\n  setPollResponses(params: PollResponseSetParams): Promise<PollResponseSetResponse> {\n    return this.call<PollResponseSetResponse>(HMSSignalMethod.POLL_RESPONSE_SET, { ...params });\n  }\n\n  getPollResponses(params: PollResponsesGetParams): Promise<PollResponsesGetResponse> {\n    return this.call<PollResponsesGetResponse>(HMSSignalMethod.POLL_RESPONSES, { ...params });\n  }\n\n  getPollsList(params: PollListParams): Promise<PollListResponse> {\n    return this.call<PollListResponse>(HMSSignalMethod.POLL_LIST, { ...params });\n  }\n\n  getPollResult(params: PollResultParams): Promise<PollResultResponse> {\n    return this.call<PollResultResponse>(HMSSignalMethod.POLL_RESULT, { ...params });\n  }\n\n  createWhiteboard(params: HMSWhiteboardCreateOptions) {\n    this.validateConnection();\n    return this.call<CreateWhiteboardResponse>(HMSSignalMethod.WHITEBOARD_CREATE, { ...params });\n  }\n\n  getWhiteboard(params: { id: string; permission?: Array<HMSPermissionType> }) {\n    this.validateConnection();\n    return this.call<GetWhiteboardResponse>(HMSSignalMethod.WHITEBOARD_GET, { ...params });\n  }\n\n  fetchPollLeaderboard(params: PollLeaderboardGetParams): Promise<PollLeaderboardGetResponse> {\n    return this.call<PollLeaderboardGetResponse>(HMSSignalMethod.POLL_LEADERBOARD, { ...params });\n  }\n\n  private validateConnection() {\n    if (!this.isConnected) {\n      throw ErrorFactory.WebSocketConnectionErrors.WebSocketConnectionLost(\n        HMSAction.RECONNECT_SIGNAL,\n        'Failed to send message due to network disconnection',\n      );\n    }\n  }\n\n  private onMessageHandler(event: MessageEvent) {\n    const text: string = event.data;\n    const response = JSON.parse(text);\n    this.resolvePingOnAnyResponse();\n    if (response.id) {\n      this.handleResponseWithId(response);\n    } else if (response.method) {\n      this.handleResponseWithMethod(response);\n    } else {\n      throw Error(`WebSocket message has no 'method' or 'id' field, message=${response}`);\n    }\n  }\n\n  private handleResponseWithId(response: any) {\n    /** This is a response to [call] */\n    const typedResponse = response as JsonRpcResponse;\n    const id: string = typedResponse.id;\n    if (this.callbacks.has(id)) {\n      const cb = this.callbacks.get(id)!;\n      this.callbacks.delete(id);\n      if (typedResponse.result) {\n        cb.resolve(typedResponse.result);\n      } else {\n        cb.reject(typedResponse.error);\n      }\n    } else {\n      this.observer.onNotification(typedResponse);\n    }\n  }\n\n  private handleResponseWithMethod(response: any) {\n    switch (response.method) {\n      case HMSSignalMethod.OFFER:\n        this.observer.onOffer(response.params);\n        break;\n      case HMSSignalMethod.TRICKLE:\n        this.observer.onTrickle(response.params);\n        break;\n      case HMSSignalMethod.SERVER_ERROR:\n        this.observer.onServerError(\n          ErrorFactory.WebsocketMethodErrors.ServerErrors(\n            Number(response.params.code),\n            HMSSignalMethod.SERVER_ERROR,\n            response.params.message,\n          ),\n        );\n        break;\n      case HMSSignalMethod.SERVER_WARNING:\n        HMSLogger.w(this.TAG, response.params);\n        break;\n      default:\n        this.observer.onNotification(response);\n        break;\n    }\n  }\n\n  private resolvePingOnAnyResponse = () => {\n    this.callbacks.forEach((callback, key) => {\n      if (callback.metadata?.method === HMSSignalMethod.PING) {\n        //@ts-ignore\n        callback.resolve({ timestamp: Date.now() });\n        this.callbacks.delete(key);\n      }\n    });\n  };\n\n  private rejectPendingCalls(reason = '') {\n    this.callbacks.forEach((callback, id) => {\n      if (callback.metadata?.method !== HMSSignalMethod.PING) {\n        HMSLogger.e(this.TAG, `rejecting pending callback ${callback.metadata?.method}, id=${id}`);\n        callback.reject(\n          ErrorFactory.WebSocketConnectionErrors.WebSocketConnectionLost(\n            callback.metadata?.method\n              ? convertSignalMethodtoErrorAction(callback.metadata?.method)\n              : HMSAction.RECONNECT_SIGNAL,\n            reason,\n          ),\n        );\n        this.callbacks.delete(id);\n      }\n    });\n  }\n\n  private async pingPongLoop(id: number) {\n    const pingTimeout = window.HMS?.PING_TIMEOUT || DEFAULT_SIGNAL_PING_TIMEOUT;\n    if (this.isConnected) {\n      const pongTimeDiff = await this.ping(pingTimeout);\n      this.pongResponseTimes.enqueue(pongTimeDiff);\n      if (pongTimeDiff > pingTimeout) {\n        HMSLogger.d(this.TAG, `Pong timeout ${id}, pageHidden=${isPageHidden()}`);\n        if (this.id === id) {\n          this.setIsConnected(false, 'ping pong failure');\n        }\n      } else {\n        setTimeout(() => this.pingPongLoop(id), window.HMS?.PING_INTERVAL || DEFAULT_SIGNAL_PING_INTERVAL);\n      }\n    }\n  }\n\n  private async call<T>(method: HMSSignalMethod, params: Record<string, any>): Promise<T> {\n    const MAX_RETRIES = 3;\n    let error: HMSException = ErrorFactory.WebsocketMethodErrors.ServerErrors(500, method, `Default ${method} error`);\n    let retry;\n    for (retry = 1; retry <= MAX_RETRIES; retry++) {\n      try {\n        this.validateConnection();\n        HMSLogger.d(this.TAG, `Try number ${retry} sending ${method}`, params);\n        return await this.internalCall(method, params);\n      } catch (err) {\n        error = err as HMSException;\n        HMSLogger.e(this.TAG, `Failed sending ${method} try: ${retry}`, { method, params, error });\n        // 1003 is websocket disconnect - could be because you are offline - retry with delay in this case as well\n        const shouldRetry = parseInt(`${error.code / 100}`) === 5 || error.code === 429 || error.code === 1003;\n        if (!shouldRetry) {\n          break;\n        }\n\n        const delay = (2 + Math.random() * 2) * 1000;\n        await workerSleep(delay);\n      }\n    }\n    HMSLogger.e(`Sending ${method} over WS failed after ${Math.min(retry, MAX_RETRIES)} retries`, {\n      method,\n      params,\n      error,\n    });\n    throw error;\n  }\n\n  private offlineListener = () => {\n    HMSLogger.d(this.TAG, 'Window network offline');\n    this.setIsConnected(false, 'Window network offline');\n  };\n\n  private onlineListener = () => {\n    HMSLogger.d(this.TAG, 'Window network online');\n    this.observer.onNetworkOnline();\n  };\n}\n", "// @ts-nocheck\nimport { isBrowser } from './support';\n\nexport const getNetworkInfo = () => {\n  if (!isBrowser || typeof navigator.connection === 'undefined') {\n    return;\n  }\n\n  const connection = navigator.connection;\n  const networkInfo = {\n    downlink: connection.downlink,\n    downlinkMax: connection.downlinkMax,\n    effectiveType: connection.effectiveType,\n    rtt: connection.rtt,\n    saveData: connection.saveData,\n    type: connection.type,\n  };\n  return networkInfo;\n};\n", "import { JoinParameters } from './models/JoinParameters';\nimport { TransportFailureCategory } from './models/TransportFailureCategory';\nimport { TransportState } from './models/TransportState';\nimport ITransportObserver from './ITransportObserver';\nimport { RetryScheduler } from './RetryScheduler';\nimport { AdditionalAnalyticsProperties } from '../analytics/AdditionalAnalyticsProperties';\nimport AnalyticsEvent from '../analytics/AnalyticsEvent';\nimport AnalyticsEventFactory from '../analytics/AnalyticsEventFactory';\nimport { AnalyticsEventsService } from '../analytics/AnalyticsEventsService';\nimport { AnalyticsTimer, TimedEvent } from '../analytics/AnalyticsTimer';\nimport { HTTPAnalyticsTransport } from '../analytics/HTTPAnalyticsTransport';\nimport { SignalAnalyticsTransport } from '../analytics/signal-transport/SignalAnalyticsTransport';\nimport { PublishStatsAnalytics, SubscribeStatsAnalytics } from '../analytics/stats';\nimport { PluginUsageTracker } from '../common/PluginUsageTracker';\nimport { HMSConnectionRole, HMSTrickle } from '../connection/model';\nimport { IPublishConnectionObserver } from '../connection/publish/IPublishConnectionObserver';\nimport HMSPublishConnection from '../connection/publish/publishConnection';\nimport ISubscribeConnectionObserver from '../connection/subscribe/ISubscribeConnectionObserver';\nimport HMSSubscribeConnection from '../connection/subscribe/subscribeConnection';\nimport { DeviceManager } from '../device-manager';\nimport { HMSDiagnosticsConnectivityListener } from '../diagnostics/interfaces';\nimport { ErrorCodes } from '../error/ErrorCodes';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { HMSException } from '../error/HMSException';\nimport { EventBus } from '../events/EventBus';\nimport { HMSICEServer, HMSRole, HMSTrackUpdate, HMSUpdateListener } from '../interfaces';\nimport { HMSLocalStream } from '../media/streams/HMSLocalStream';\nimport { HMSLocalTrack, HMSLocalVideoTrack, HMSTrack } from '../media/tracks';\nimport { TrackState } from '../notification-manager';\nimport { HMSWebrtcInternals } from '../rtc-stats/HMSWebrtcInternals';\nimport { Store } from '../sdk/store';\nimport InitService from '../signal/init';\nimport { InitConfig, InitFlags } from '../signal/init/models';\nimport { ISignalEventsObserver } from '../signal/ISignalEventsObserver';\nimport JsonRpcSignal from '../signal/jsonrpc';\nimport {\n  ICE_DISCONNECTION_TIMEOUT,\n  MAX_TRANSPORT_RETRIES,\n  PROTOCOL_SPEC,\n  PROTOCOL_VERSION,\n  PUBLISH_STATS_PUSH_INTERVAL,\n  PUBLISH_STATS_SAMPLE_WINDOW,\n  RENEGOTIATION_CALLBACK_ID,\n  SUBSCRIBE_ICE_CONNECTION_CALLBACK_ID,\n  SUBSCRIBE_STATS_PUSH_INTERVAL,\n  SUBSCRIBE_STATS_SAMPLE_WINDOW,\n  SUBSCRIBE_TIMEOUT,\n} from '../utils/constants';\nimport HMSLogger from '../utils/logger';\nimport { getNetworkInfo } from '../utils/network-info';\nimport { PromiseCallbacks } from '../utils/promise';\n\nconst TAG = '[HMSTransport]:';\n\n// @DISCUSS: action and extra are not used at all.\ninterface CallbackTriple {\n  promise: PromiseCallbacks<boolean>;\n  action: HMSAction;\n  extra: any;\n}\n\ninterface NegotiateJoinParams {\n  name: string;\n  data: string;\n  autoSubscribeVideo: boolean;\n}\n\nexport default class HMSTransport {\n  private state: TransportState = TransportState.Disconnected;\n  private trackStates: Map<string, TrackState> = new Map();\n  private publishConnection: HMSPublishConnection | null = null;\n  private subscribeConnection: HMSSubscribeConnection | null = null;\n  private initConfig?: InitConfig;\n  private endpoint!: string;\n  private joinParameters?: JoinParameters;\n  private retryScheduler: RetryScheduler;\n  private webrtcInternals?: HMSWebrtcInternals;\n  private publishStatsAnalytics?: PublishStatsAnalytics;\n  private subscribeStatsAnalytics?: SubscribeStatsAnalytics;\n  private maxSubscribeBitrate = 0;\n  private connectivityListener?: HMSDiagnosticsConnectivityListener;\n  private sfuNodeId?: string;\n  joinRetryCount = 0;\n  private publishDisconnectTimer = 0;\n  private listener?: HMSUpdateListener;\n  private onScreenshareStop = () => {};\n  private screenStream = new Set<MediaStream>();\n\n  constructor(\n    private observer: ITransportObserver,\n    private deviceManager: DeviceManager,\n    private store: Store,\n    private eventBus: EventBus,\n    private analyticsEventsService: AnalyticsEventsService,\n    private analyticsTimer: AnalyticsTimer,\n    private pluginUsageTracker: PluginUsageTracker,\n  ) {\n    this.webrtcInternals = new HMSWebrtcInternals(this.store, this.eventBus);\n\n    const onStateChange = async (state: TransportState, error?: HMSException) => {\n      if (state !== this.state) {\n        this.state = state;\n        await this.observer.onStateChange(this.state, error);\n      }\n    };\n    this.retryScheduler = new RetryScheduler(onStateChange, this.sendErrorAnalyticsEvent.bind(this));\n\n    this.eventBus.statsUpdate.subscribe(stats => {\n      const currentSubscribeBitrate = stats.getLocalPeerStats()?.subscribe?.bitrate || 0;\n      this.maxSubscribeBitrate = Math.max(this.maxSubscribeBitrate, currentSubscribeBitrate);\n    });\n\n    this.eventBus.localAudioEnabled.subscribe(({ track, enabled }) => this.trackUpdate(track, enabled));\n    this.eventBus.localVideoEnabled.subscribe(({ track, enabled }) => this.trackUpdate(track, enabled));\n  }\n\n  /**\n   * Map of callbacks used to wait for an event to fire.\n   * Used here for:\n   *  1. publish/unpublish waits for [IPublishConnectionObserver.onRenegotiationNeeded] to complete\n   */\n  private readonly callbacks = new Map<string, CallbackTriple>();\n\n  setListener = (listener: HMSUpdateListener) => {\n    this.listener = listener;\n  };\n\n  setOnScreenshareStop = (onStop: () => void) => {\n    this.onScreenshareStop = onStop;\n  };\n\n  getWebsocketEndpoint(): string | undefined {\n    if (!this.initConfig) {\n      return;\n    }\n    return this.initConfig.endpoint;\n  }\n\n  private signalObserver: ISignalEventsObserver = {\n    // eslint-disable-next-line complexity\n    onOffer: async (jsep: RTCSessionDescriptionInit & { sfu_node_id?: string }) => {\n      try {\n        if (!this.subscribeConnection) {\n          return;\n        }\n        if (\n          jsep.sfu_node_id &&\n          this.subscribeConnection.sfuNodeId &&\n          this.subscribeConnection.sfuNodeId !== jsep.sfu_node_id\n        ) {\n          HMSLogger.d(TAG, 'ignoring old offer');\n          return;\n        }\n        await this.subscribeConnection.setRemoteDescription(jsep);\n        HMSLogger.d(\n          TAG,\n          `[SUBSCRIBE] Adding ${this.subscribeConnection.candidates.length} ice-candidates`,\n          this.subscribeConnection.candidates,\n        );\n        for (const candidate of this.subscribeConnection.candidates) {\n          await this.subscribeConnection.addIceCandidate(candidate);\n        }\n        this.subscribeConnection.candidates.length = 0;\n        const answer = await this.subscribeConnection.createAnswer();\n        await this.subscribeConnection.setLocalDescription(answer);\n        this.signal.answer(answer);\n        HMSLogger.d(TAG, '[role=SUBSCRIBE] onOffer renegotiation DONE \u2705');\n      } catch (err) {\n        HMSLogger.d(TAG, '[role=SUBSCRIBE] onOffer renegotiation FAILED \u274C', err);\n        this.state = TransportState.Failed;\n        let ex: HMSException;\n        if (err instanceof HMSException) {\n          ex = err;\n        } else {\n          ex = ErrorFactory.GenericErrors.Unknown(HMSAction.SUBSCRIBE, (err as Error).message);\n        }\n        this.observer.onFailure(ex);\n        this.eventBus.analytics.publish(AnalyticsEventFactory.subscribeFail(ex));\n      }\n    },\n\n    onTrickle: async (trickle: HMSTrickle) => {\n      const connection =\n        trickle.target === HMSConnectionRole.Publish ? this.publishConnection : this.subscribeConnection;\n      if (!connection?.remoteDescription) {\n        // ICE candidates can't be added without any remote session description\n        connection?.candidates.push(trickle.candidate);\n      } else {\n        await connection.addIceCandidate(trickle.candidate);\n      }\n    },\n\n    onNotification: (message: any) => this.observer.onNotification(message),\n\n    onServerError: async (error: HMSException) => {\n      await this.observer.onStateChange(TransportState.Failed, error);\n    },\n\n    onFailure: (error: HMSException) => {\n      // @DISCUSS: Should we remove this? Pong failure would have already scheduled signal retry.\n      if (this.joinParameters) {\n        this.retryScheduler.schedule({\n          category: TransportFailureCategory.SignalDisconnect,\n          error,\n          task: this.retrySignalDisconnectTask,\n          originalState: this.state,\n        });\n      }\n    },\n\n    onOffline: async (reason: string) => {\n      HMSLogger.d(TAG, 'socket offline', TransportState[this.state]);\n      try {\n        if (this.state !== TransportState.Leaving && this.joinParameters) {\n          this.retryScheduler.schedule({\n            category: TransportFailureCategory.SignalDisconnect,\n            error: ErrorFactory.WebSocketConnectionErrors.WebSocketConnectionLost(HMSAction.RECONNECT_SIGNAL, reason),\n            task: this.retrySignalDisconnectTask,\n            originalState: this.state,\n          });\n        }\n      } catch (e) {\n        console.error(e);\n      }\n    },\n\n    // this is called when socket connection is successful\n    onOnline: () => {\n      HMSLogger.d(TAG, 'socket online', TransportState[this.state]);\n      this.analyticsSignalTransport.flushFailedEvents(this.store.getLocalPeer()?.peerId);\n    },\n    // this is called when window.online event is triggered\n    onNetworkOnline: () => {\n      this.analyticsEventsService.flushFailedClientEvents();\n    },\n  };\n\n  public readonly signal = new JsonRpcSignal(this.signalObserver);\n  private analyticsSignalTransport = new SignalAnalyticsTransport(this.signal);\n\n  private publishDtlsStateTimer = 0;\n  private lastPublishDtlsState: RTCDtlsTransportState = 'new';\n\n  getWebrtcInternals() {\n    return this.webrtcInternals;\n  }\n\n  isFlagEnabled(flag: InitFlags) {\n    const config = this.initConfig?.config;\n    const flags = config?.enabledFlags || [];\n    return flags.includes(flag);\n  }\n\n  setConnectivityListener(listener: HMSDiagnosticsConnectivityListener) {\n    this.connectivityListener = listener;\n  }\n\n  async preview(\n    token: string,\n    endpoint: string,\n    peerId: string,\n    customData: { name: string; metaData: string },\n    autoSubscribeVideo = false,\n    iceServers?: HMSICEServer[],\n  ): Promise<InitConfig | void> {\n    const initConfig = await this.connect(token, endpoint, peerId, customData, autoSubscribeVideo, iceServers);\n    this.state = TransportState.Preview;\n    this.observer.onStateChange(this.state);\n    return initConfig;\n  }\n\n  async join(\n    authToken: string,\n    peerId: string,\n    customData: { name: string; metaData: string },\n    initEndpoint: string,\n    autoSubscribeVideo = false,\n    iceServers?: HMSICEServer[],\n  ): Promise<void> {\n    HMSLogger.d(TAG, 'join: started \u23F0');\n    try {\n      if (!this.signal.isConnected || !this.initConfig) {\n        await this.connect(authToken, initEndpoint, peerId, customData, autoSubscribeVideo, iceServers);\n      }\n\n      this.validateNotDisconnected('connect');\n\n      if (this.initConfig) {\n        await this.waitForLocalRoleAvailability();\n        await this.createConnectionsAndNegotiateJoin(customData, autoSubscribeVideo);\n        this.initStatsAnalytics();\n\n        HMSLogger.d(TAG, '\u2705 join: Negotiated over PUBLISH connection');\n      }\n    } catch (error) {\n      HMSLogger.e(TAG, `join: failed \u274C [token=${authToken}]`, error);\n      this.state = TransportState.Failed;\n      const ex = error as HMSException;\n      // set isTerminal to true if not already when error code is 500(internal biz server error)\n      ex.isTerminal = ex.isTerminal || ex.code === 500;\n      await this.observer.onStateChange(this.state, ex);\n      throw ex;\n    }\n\n    HMSLogger.d(TAG, '\u2705 join: successful');\n    this.state = TransportState.Joined;\n    this.observer.onStateChange(this.state);\n  }\n\n  async connect(\n    token: string,\n    endpoint: string,\n    peerId: string,\n    customData: { name: string; metaData: string },\n    autoSubscribeVideo = false,\n    iceServers?: HMSICEServer[],\n  ): Promise<InitConfig | void> {\n    this.setTransportStateForConnect();\n    this.joinParameters = new JoinParameters(\n      token,\n      peerId,\n      customData.name,\n      customData.metaData,\n      endpoint,\n      autoSubscribeVideo,\n      iceServers,\n    );\n    try {\n      const response = await this.internalConnect(token, endpoint, peerId, iceServers);\n      return response;\n    } catch (error) {\n      const shouldRetry =\n        error instanceof HMSException &&\n        ([\n          ErrorCodes.WebSocketConnectionErrors.WEBSOCKET_CONNECTION_LOST,\n          ErrorCodes.WebSocketConnectionErrors.FAILED_TO_CONNECT,\n          ErrorCodes.WebSocketConnectionErrors.ABNORMAL_CLOSE,\n          ErrorCodes.APIErrors.ENDPOINT_UNREACHABLE,\n        ].includes(error.code) ||\n          error.code.toString().startsWith('5') ||\n          error.code.toString().startsWith('429'));\n\n      if (shouldRetry) {\n        const task = async () => {\n          await this.internalConnect(token, endpoint, peerId, iceServers);\n          return Boolean(this.initConfig && this.initConfig.endpoint);\n        };\n\n        await this.retryScheduler.schedule({\n          category: TransportFailureCategory.ConnectFailed,\n          error,\n          task,\n          originalState: this.state,\n          maxFailedRetries: MAX_TRANSPORT_RETRIES,\n          changeState: false,\n        });\n      } else {\n        throw error;\n      }\n    }\n  }\n\n  async leave(notifyServer: boolean): Promise<void> {\n    this.retryScheduler.reset();\n    this.joinParameters = undefined;\n    HMSLogger.d(TAG, 'leaving in transport');\n    try {\n      const usage = this.pluginUsageTracker.getPluginUsage('HMSKrispPlugin');\n      if (usage) {\n        this.eventBus.analytics.publish(AnalyticsEventFactory.getKrispUsage(usage));\n      }\n      this.state = TransportState.Leaving;\n      this.publishStatsAnalytics?.stop();\n      this.subscribeStatsAnalytics?.stop();\n      this.webrtcInternals?.cleanup();\n      this.clearPeerConnections();\n      if (notifyServer) {\n        try {\n          this.signal.leave();\n          HMSLogger.d(TAG, 'signal leave done');\n        } catch (err) {\n          HMSLogger.w(TAG, 'failed to send leave on websocket to server', err);\n        }\n      }\n      this.analyticsEventsService.flushFailedClientEvents();\n      this.analyticsEventsService.reset();\n      await this.signal.close();\n    } catch (err) {\n      this.eventBus.analytics.publish(AnalyticsEventFactory.disconnect(err as Error));\n      HMSLogger.e(TAG, 'leave: FAILED \u274C', err);\n    } finally {\n      this.state = TransportState.Disconnected;\n      this.observer.onStateChange(this.state);\n    }\n  }\n\n  handleLocalRoleUpdate = async ({ oldRole, newRole }: { oldRole: HMSRole; newRole: HMSRole }) => {\n    const changedFromNonWebRTCToWebRTC = !this.doesRoleNeedWebRTC(oldRole) && this.doesRoleNeedWebRTC(newRole);\n    if (!changedFromNonWebRTCToWebRTC) {\n      return;\n    }\n\n    HMSLogger.d(\n      TAG,\n      'Local peer role updated to webrtc role, creating PeerConnections and performing inital publish negotiation \u23F3',\n    );\n    this.createPeerConnections();\n    await this.negotiateOnFirstPublish();\n  };\n\n  async publish(tracks: Array<HMSLocalTrack>): Promise<void> {\n    for (const track of tracks) {\n      try {\n        await this.publishTrack(track);\n        this.connectivityListener?.onMediaPublished(track);\n      } catch (error) {\n        this.eventBus.analytics.publish(\n          AnalyticsEventFactory.publish({\n            devices: this.deviceManager.getDevices(),\n            error: error as Error,\n          }),\n        );\n      }\n    }\n  }\n\n  async unpublish(tracks: Array<HMSLocalTrack>): Promise<void> {\n    for (const track of tracks) {\n      await this.unpublishTrack(track);\n    }\n  }\n\n  setSFUNodeId(id?: string) {\n    this.signal.setSfuNodeId(id);\n    if (!this.sfuNodeId) {\n      this.sfuNodeId = id;\n      this.publishConnection?.setSfuNodeId(id);\n      this.subscribeConnection?.setSfuNodeId(id);\n    } else if (id && this.sfuNodeId !== id) {\n      this.sfuNodeId = id;\n      this.handleSFUMigration();\n    }\n  }\n\n  // eslint-disable-next-line complexity\n  async handleSFUMigration() {\n    HMSLogger.time('sfu migration');\n    this.clearPeerConnections();\n    const peers = this.store.getPeerMap();\n    this.store.removeRemoteTracks();\n    for (const peerId in peers) {\n      const peer = peers[peerId];\n      if (peer.isLocal) {\n        continue;\n      }\n      peer.audioTrack = undefined;\n      peer.videoTrack = undefined;\n      peer.auxiliaryTracks = [];\n    }\n\n    const localPeer = this.store.getLocalPeer();\n    if (!localPeer) {\n      return;\n    }\n    this.createPeerConnections();\n    this.trackStates.clear();\n    await this.negotiateOnFirstPublish();\n    const streamMap = new Map<string, HMSLocalStream>();\n    if (localPeer.audioTrack) {\n      const stream = localPeer.audioTrack.stream as HMSLocalStream;\n      if (!streamMap.get(stream.id)) {\n        streamMap.set(stream.id, new HMSLocalStream(new MediaStream()));\n      }\n      const newTrack = localPeer.audioTrack.clone(streamMap.get(stream.id)!);\n      this.store.removeTrack(localPeer.audioTrack);\n      localPeer.audioTrack.cleanup();\n      await this.publishTrack(newTrack);\n      localPeer.audioTrack = newTrack;\n    }\n\n    if (localPeer.videoTrack) {\n      const stream = localPeer.videoTrack.stream as HMSLocalStream;\n      if (!streamMap.get(stream.id)) {\n        streamMap.set(stream.id, new HMSLocalStream(new MediaStream()));\n      }\n      this.store.removeTrack(localPeer.videoTrack);\n      const newTrack = localPeer.videoTrack.clone(streamMap.get(stream.id)!);\n      localPeer.videoTrack.cleanup();\n      await this.publishTrack(newTrack);\n      localPeer.videoTrack = newTrack;\n    }\n\n    const auxTracks = [];\n    while (localPeer.auxiliaryTracks.length > 0) {\n      const track = localPeer.auxiliaryTracks.shift();\n      if (track) {\n        const stream = track.stream as HMSLocalStream;\n        if (!streamMap.get(stream.id)) {\n          /**\n           *  For screenshare, you need to clone the current stream only, cloning the track will not work otherwise, it will have all\n           *  correct states but bytes sent and all other stats would be 0\n           **/\n          streamMap.set(\n            stream.id,\n            new HMSLocalStream(track.source === 'screen' ? stream.nativeStream.clone() : new MediaStream()),\n          );\n        }\n        this.store.removeTrack(track);\n        const newTrack = track.clone(streamMap.get(stream.id)!);\n        if (newTrack.type === 'video' && newTrack.source === 'screen') {\n          /**\n           * Store all the stream so they can be stopped when screenshare stopped. Stopping before is not helping\n           */\n          this.screenStream.add(stream.nativeStream);\n          this.screenStream.add(newTrack.stream.nativeStream);\n          newTrack.nativeTrack.addEventListener('ended', this.onScreenshareStop);\n        }\n        track.cleanup();\n        await this.publishTrack(newTrack);\n        auxTracks.push(newTrack);\n      }\n    }\n    localPeer.auxiliaryTracks = auxTracks;\n    streamMap.clear();\n    this.listener?.onSFUMigration?.();\n    HMSLogger.timeEnd('sfu migration');\n  }\n\n  /**\n   * TODO: check if track.publishedTrackId be used instead of the hack to match with track with same type and\n   * source. The hack won't work if there are multiple tracks with same source and type.\n   */\n  trackUpdate(track: HMSLocalTrack, enabled: boolean) {\n    const currentTrackStates = Array.from(this.trackStates.values());\n    const originalTrackState = currentTrackStates.find(\n      trackState => track.type === trackState.type && track.source === trackState.source,\n    );\n    /**\n     * on call interruption, we just send disabled track update to biz to send to remote peers WITHOUT sending to the local peer\n     * in this case, track.enabled would still be true which is why we are using the value from the localVideoEnabled event\n     *  */\n    if (originalTrackState) {\n      const newTrackState = new TrackState({\n        ...originalTrackState,\n        mute: !enabled,\n      });\n      this.trackStates.set(originalTrackState.track_id, newTrackState);\n      HMSLogger.d(TAG, 'Track Update', this.trackStates, track);\n      this.signal.trackUpdate(new Map([[originalTrackState.track_id, newTrackState]]));\n      const peer = this.store.getLocalPeer();\n      // don't send update in case of call interruption\n      if (peer && enabled === track.enabled) {\n        this.listener?.onTrackUpdate(enabled ? HMSTrackUpdate.TRACK_UNMUTED : HMSTrackUpdate.TRACK_MUTED, track, peer);\n      }\n    }\n  }\n\n  private async publishTrack(track: HMSLocalTrack): Promise<void> {\n    track.publishedTrackId = track.getTrackIDBeingSent();\n    HMSLogger.d(\n      TAG,\n      `\u23F3 publishTrack: trackId=${track.trackId}, toPublishTrackId=${track.publishedTrackId}`,\n      `${track}`,\n    );\n    this.trackStates.set(track.publishedTrackId, new TrackState(track));\n    const p = new Promise<boolean>((resolve, reject) => {\n      this.callbacks.set(RENEGOTIATION_CALLBACK_ID, {\n        promise: { resolve, reject },\n        action: HMSAction.PUBLISH,\n        extra: {},\n      });\n    });\n    const stream = track.stream as HMSLocalStream;\n    stream.setConnection(this.publishConnection!);\n    const simulcastLayers = this.store.getSimulcastLayers(track.source!);\n    stream.addTransceiver(track, simulcastLayers);\n    HMSLogger.time(`publish-${track.trackId}-${track.type}`);\n    await p;\n    HMSLogger.timeEnd(`publish-${track.trackId}-${track.type}`);\n    // add track to store after publish\n    this.store.addTrack(track);\n\n    await stream\n      .setMaxBitrateAndFramerate(track)\n      .then(() => {\n        HMSLogger.d(\n          TAG,\n          `Setting maxBitrate=${track.settings.maxBitrate} kpbs${\n            track instanceof HMSLocalVideoTrack ? ` and maxFramerate=${track.settings.maxFramerate}` : ''\n          } for ${track.source} ${track.type} ${track.trackId}`,\n        );\n      })\n      .catch(error => HMSLogger.w(TAG, 'Failed setting maxBitrate and maxFramerate', error));\n\n    track.isPublished = true;\n\n    HMSLogger.d(TAG, `\u2705 publishTrack: trackId=${track.trackId}`, `${track}`, this.callbacks);\n  }\n\n  private async unpublishTrack(track: HMSLocalTrack): Promise<void> {\n    HMSLogger.d(TAG, `\u23F3 unpublishTrack: trackId=${track.trackId}`, `${track}`);\n    if (track.publishedTrackId && this.trackStates.has(track.publishedTrackId)) {\n      this.trackStates.delete(track.publishedTrackId);\n    } else {\n      // TODO: hotfix to unpublish replaced video track id, solve it properly\n      // it won't work when there are multiple regular video tracks, hmslocalvideotrack can store\n      // the original initial track id for a proper fix\n      const currentTrackStates = Array.from(this.trackStates.values());\n      const originalTrackState = currentTrackStates.find(\n        trackState => track.type === trackState.type && track.source === trackState.source,\n      );\n      if (originalTrackState) {\n        this.trackStates.delete(originalTrackState.track_id);\n      }\n    }\n    const p = new Promise<boolean>((resolve, reject) => {\n      this.callbacks.set(RENEGOTIATION_CALLBACK_ID, {\n        promise: { resolve, reject },\n        action: HMSAction.UNPUBLISH,\n        extra: {},\n      });\n    });\n    const stream = track.stream as HMSLocalStream;\n    stream.removeSender(track);\n    await p;\n    await track.cleanup();\n    if (track.source === 'screen' && this.screenStream) {\n      // stop older screenshare tracks to remove the screenshare banner\n      this.screenStream.forEach(stream => {\n        stream.getTracks().forEach(_track => {\n          _track.stop();\n        });\n        this.screenStream.delete(stream);\n      });\n    }\n    // remove track from store on unpublish\n    this.store.removeTrack(track);\n    HMSLogger.d(TAG, `\u2705 unpublishTrack: trackId=${track.trackId}`, this.callbacks);\n  }\n\n  private async clearPeerConnections() {\n    clearTimeout(this.publishDtlsStateTimer);\n    this.publishDtlsStateTimer = 0;\n    clearTimeout(this.publishDisconnectTimer);\n    this.publishDisconnectTimer = 0;\n    this.lastPublishDtlsState = 'new';\n    this.publishConnection?.close();\n    this.subscribeConnection?.close();\n    this.publishConnection = null;\n    this.subscribeConnection = null;\n  }\n\n  private waitForLocalRoleAvailability() {\n    if (this.store.hasRoleDetailsArrived()) {\n      return;\n    } else {\n      return new Promise<void>(resolve => {\n        this.eventBus.policyChange.subscribeOnce(() => resolve());\n      });\n    }\n  }\n\n  private async createConnectionsAndNegotiateJoin(\n    customData: { name: string; metaData: string },\n    autoSubscribeVideo = false,\n  ) {\n    const isWebRTC = this.doesLocalPeerNeedWebRTC();\n    if (isWebRTC) {\n      this.createPeerConnections();\n    }\n\n    this.analyticsTimer.start(TimedEvent.JOIN_RESPONSE);\n    await this.negotiateJoinWithRetry({\n      name: customData.name,\n      data: customData.metaData,\n      autoSubscribeVideo,\n      isWebRTC,\n    });\n    this.analyticsTimer.end(TimedEvent.JOIN_RESPONSE);\n  }\n\n  private createPeerConnections() {\n    const logConnectionState = (\n      role: HMSConnectionRole,\n      newState: RTCIceConnectionState | RTCPeerConnectionState,\n      ice = false,\n    ) => {\n      const log = ['disconnected', 'failed'].includes(newState)\n        ? HMSLogger.w.bind(HMSLogger)\n        : HMSLogger.d.bind(HMSLogger);\n\n      log(TAG, `${HMSConnectionRole[role]} ${ice ? 'ice' : ''} connection state change: ${newState}`);\n    };\n    if (this.initConfig) {\n      const publishConnectionObserver: IPublishConnectionObserver = {\n        onRenegotiationNeeded: async () => {\n          await this.performPublishRenegotiation();\n        },\n\n        // eslint-disable-next-line complexity\n        onDTLSTransportStateChange: (state?: RTCDtlsTransportState) => {\n          const log = state === 'failed' ? HMSLogger.w.bind(HMSLogger) : HMSLogger.d.bind(HMSLogger);\n          log(TAG, `Publisher on dtls transport state change: ${state}`);\n\n          if (!state || this.lastPublishDtlsState === state) {\n            return;\n          }\n\n          this.lastPublishDtlsState = state;\n          if (this.publishDtlsStateTimer !== 0) {\n            clearTimeout(this.publishDtlsStateTimer);\n            this.publishDtlsStateTimer = 0;\n          }\n\n          if (state !== 'connecting' && state !== 'failed') {\n            return;\n          }\n\n          const timeout = this.initConfig?.config?.dtlsStateTimeouts?.[state];\n          if (!timeout || timeout <= 0) {\n            return;\n          }\n\n          // if we're in connecting check again after timeout\n          // hotfix: mitigate https://100ms.atlassian.net/browse/LIVE-1924\n          this.publishDtlsStateTimer = window.setTimeout(() => {\n            const newState = this.publishConnection?.nativeConnection.connectionState;\n            if (newState && state && newState === state) {\n              // stuck in either `connecting` or `failed` state for long time\n              const err = ErrorFactory.WebrtcErrors.ICEFailure(\n                HMSAction.PUBLISH,\n                `DTLS transport state ${state} timeout:${timeout}ms`,\n                true,\n              );\n              this.eventBus.analytics.publish(AnalyticsEventFactory.disconnect(err));\n              this.observer.onFailure(err);\n            }\n          }, timeout);\n        },\n\n        onDTLSTransportError: (error: Error) => {\n          HMSLogger.e(TAG, `onDTLSTransportError ${error.name} ${error.message}`, error);\n          this.eventBus.analytics.publish(AnalyticsEventFactory.disconnect(error));\n        },\n\n        onIceConnectionChange: async (newState: RTCIceConnectionState) => {\n          logConnectionState(HMSConnectionRole.Publish, newState, true);\n        },\n\n        onConnectionStateChange: async (newState: RTCPeerConnectionState) => {\n          logConnectionState(HMSConnectionRole.Publish, newState, false);\n          if (newState === 'new') {\n            return;\n          }\n\n          if (newState === 'connected') {\n            this.connectivityListener?.onICESuccess(true);\n            this.publishConnection?.handleSelectedIceCandidatePairs();\n          } else if (newState === 'failed') {\n            await this.handleIceConnectionFailure(\n              HMSConnectionRole.Publish,\n              ErrorFactory.WebrtcErrors.ICEFailure(\n                HMSAction.PUBLISH,\n                `local candidate - ${this.publishConnection?.selectedCandidatePair?.local?.candidate}; remote candidate - ${this.publishConnection?.selectedCandidatePair?.remote?.candidate}`,\n              ),\n            );\n          } else {\n            this.publishDisconnectTimer = window.setTimeout(() => {\n              if (this.publishConnection?.connectionState !== 'connected') {\n                this.handleIceConnectionFailure(\n                  HMSConnectionRole.Publish,\n                  ErrorFactory.WebrtcErrors.ICEDisconnected(\n                    HMSAction.PUBLISH,\n                    `local candidate - ${this.publishConnection?.selectedCandidatePair?.local?.candidate}; remote candidate - ${this.publishConnection?.selectedCandidatePair?.remote?.candidate}`,\n                  ),\n                );\n              }\n            }, ICE_DISCONNECTION_TIMEOUT);\n          }\n        },\n\n        onIceCandidate: candidate => {\n          this.connectivityListener?.onICECandidate(candidate, true);\n        },\n\n        onSelectedCandidatePairChange: candidatePair => {\n          this.connectivityListener?.onSelectedICECandidatePairChange(candidatePair, true);\n        },\n      };\n\n      const subscribeConnectionObserver: ISubscribeConnectionObserver = {\n        onApiChannelMessage: (message: string) => {\n          this.observer.onNotification(JSON.parse(message));\n        },\n\n        onTrackAdd: (track: HMSTrack) => {\n          HMSLogger.d(TAG, '[Subscribe] onTrackAdd', `${track}`);\n          this.observer.onTrackAdd(track);\n        },\n\n        onTrackRemove: (track: HMSTrack) => {\n          HMSLogger.d(TAG, '[Subscribe] onTrackRemove', `${track}`);\n          this.observer.onTrackRemove(track);\n        },\n\n        onIceConnectionChange: async (newState: RTCIceConnectionState) => {\n          logConnectionState(HMSConnectionRole.Subscribe, newState, true);\n\n          if (newState === 'connected') {\n            const callback = this.callbacks.get(SUBSCRIBE_ICE_CONNECTION_CALLBACK_ID);\n            this.callbacks.delete(SUBSCRIBE_ICE_CONNECTION_CALLBACK_ID);\n\n            this.connectivityListener?.onICESuccess(false);\n            if (callback) {\n              callback.promise.resolve(true);\n            }\n          }\n        },\n\n        onConnectionStateChange: async (newState: RTCPeerConnectionState) => {\n          logConnectionState(HMSConnectionRole.Subscribe, newState, false);\n\n          if (newState === 'failed') {\n            await this.handleIceConnectionFailure(\n              HMSConnectionRole.Subscribe,\n              ErrorFactory.WebrtcErrors.ICEFailure(\n                HMSAction.SUBSCRIBE,\n                `local candidate - ${this.subscribeConnection?.selectedCandidatePair?.local?.candidate}; remote candidate - ${this.subscribeConnection?.selectedCandidatePair?.remote?.candidate}`,\n              ),\n            );\n          } else if (newState === 'disconnected') {\n            setTimeout(() => {\n              if (this.subscribeConnection?.connectionState === 'disconnected') {\n                this.handleIceConnectionFailure(\n                  HMSConnectionRole.Subscribe,\n                  ErrorFactory.WebrtcErrors.ICEDisconnected(\n                    HMSAction.SUBSCRIBE,\n                    `local candidate - ${this.subscribeConnection?.selectedCandidatePair?.local?.candidate}; remote candidate - ${this.subscribeConnection?.selectedCandidatePair?.remote?.candidate}`,\n                  ),\n                );\n              }\n            }, ICE_DISCONNECTION_TIMEOUT);\n          } else if (newState === 'connected') {\n            this.subscribeConnection?.handleSelectedIceCandidatePairs();\n            const callback = this.callbacks.get(SUBSCRIBE_ICE_CONNECTION_CALLBACK_ID);\n            this.callbacks.delete(SUBSCRIBE_ICE_CONNECTION_CALLBACK_ID);\n\n            if (callback) {\n              callback.promise.resolve(true);\n            }\n          }\n        },\n\n        onIceCandidate: candidate => {\n          this.connectivityListener?.onICECandidate(candidate, false);\n        },\n\n        onSelectedCandidatePairChange: candidatePair => {\n          this.connectivityListener?.onSelectedICECandidatePairChange(candidatePair, false);\n        },\n      };\n      if (!this.publishConnection) {\n        this.publishConnection = new HMSPublishConnection(\n          this.signal,\n          this.initConfig.rtcConfiguration,\n          publishConnectionObserver,\n        );\n      }\n\n      if (!this.subscribeConnection) {\n        this.subscribeConnection = new HMSSubscribeConnection(\n          this.signal,\n          this.initConfig.rtcConfiguration,\n          this.isFlagEnabled.bind(this),\n          subscribeConnectionObserver,\n        );\n      }\n    }\n\n    this.webrtcInternals?.setPeerConnections({\n      publish: this.publishConnection?.nativeConnection,\n      subscribe: this.subscribeConnection?.nativeConnection,\n    });\n  }\n\n  private async negotiateJoinWithRetry({\n    name,\n    data,\n    autoSubscribeVideo,\n    isWebRTC = true,\n  }: NegotiateJoinParams & { isWebRTC: boolean }) {\n    try {\n      await this.negotiateJoin({ name, data, autoSubscribeVideo, isWebRTC });\n    } catch (error) {\n      HMSLogger.e(TAG, 'Join negotiation failed \u274C', error);\n      const hmsError =\n        error instanceof HMSException\n          ? error\n          : ErrorFactory.WebsocketMethodErrors.ServerErrors(\n              500,\n              HMSAction.JOIN,\n              `Websocket join error - ${(error as Error).message}`,\n            );\n      const shouldRetry =\n        parseInt(`${hmsError.code / 100}`) === 5 ||\n        [ErrorCodes.WebSocketConnectionErrors.WEBSOCKET_CONNECTION_LOST, 429].includes(hmsError.code);\n\n      if (hmsError.code === 410) {\n        hmsError.isTerminal = true;\n      }\n\n      if (shouldRetry) {\n        this.joinRetryCount = 0;\n        hmsError.isTerminal = false;\n        const task = async () => {\n          this.joinRetryCount++;\n          return await this.negotiateJoin({ name, data, autoSubscribeVideo, isWebRTC });\n        };\n\n        await this.retryScheduler.schedule({\n          category: TransportFailureCategory.JoinWSMessageFailed,\n          error: hmsError,\n          task,\n          originalState: TransportState.Joined,\n          maxFailedRetries: 3,\n          changeState: false,\n        });\n      } else {\n        throw error;\n      }\n    }\n  }\n\n  private async negotiateJoin({\n    name,\n    data,\n    autoSubscribeVideo,\n    isWebRTC = true,\n  }: NegotiateJoinParams & { isWebRTC: boolean }): Promise<boolean> {\n    if (isWebRTC) {\n      return await this.negotiateJoinWebRTC({ name, data, autoSubscribeVideo });\n    } else {\n      return await this.negotiateJoinNonWebRTC({ name, data, autoSubscribeVideo });\n    }\n  }\n\n  private async negotiateJoinWebRTC({ name, data, autoSubscribeVideo }: NegotiateJoinParams): Promise<boolean> {\n    HMSLogger.d(TAG, '\u23F3 join: Negotiating over PUBLISH connection');\n    if (!this.publishConnection) {\n      HMSLogger.e(TAG, 'Publish peer connection not found, cannot negotiate');\n      return false;\n    }\n    const offer = await this.publishConnection.createOffer();\n    await this.publishConnection.setLocalDescription(offer);\n    const serverSubDegrade = this.isFlagEnabled(InitFlags.FLAG_SERVER_SUB_DEGRADATION);\n    const simulcast = this.isFlagEnabled(InitFlags.FLAG_SERVER_SIMULCAST);\n    const onDemandTracks = this.isFlagEnabled(InitFlags.FLAG_ON_DEMAND_TRACKS);\n    const answer = await this.signal.join(\n      name,\n      data,\n      !autoSubscribeVideo,\n      serverSubDegrade,\n      simulcast,\n      onDemandTracks,\n      offer,\n    );\n    this.setSFUNodeId(answer?.sfu_node_id);\n    await this.publishConnection.setRemoteDescription(answer);\n    for (const candidate of this.publishConnection.candidates) {\n      await this.publishConnection.addIceCandidate(candidate);\n    }\n\n    this.publishConnection.initAfterJoin();\n    return !!answer;\n  }\n\n  private async negotiateJoinNonWebRTC({ name, data, autoSubscribeVideo }: NegotiateJoinParams): Promise<boolean> {\n    HMSLogger.d(TAG, '\u23F3 join: Negotiating Non-WebRTC');\n    const serverSubDegrade = this.isFlagEnabled(InitFlags.FLAG_SERVER_SUB_DEGRADATION);\n    const simulcast = this.isFlagEnabled(InitFlags.FLAG_SERVER_SIMULCAST);\n    const onDemandTracks = this.isFlagEnabled(InitFlags.FLAG_ON_DEMAND_TRACKS);\n    const response = await this.signal.join(\n      name,\n      data,\n      !autoSubscribeVideo,\n      serverSubDegrade,\n      simulcast,\n      onDemandTracks,\n    );\n    this.setSFUNodeId(response?.sfu_node_id);\n    return !!response;\n  }\n\n  /**\n   * Negotiate on first publish after changing role from non-webrtc peer to webrtc peer by sending offer\n   */\n  private async negotiateOnFirstPublish() {\n    HMSLogger.d(TAG, '\u23F3 Negotiating offer over PUBLISH connection');\n    if (!this.publishConnection) {\n      HMSLogger.e(TAG, 'Publish peer connection not found, cannot negotiate');\n      return false;\n    }\n    try {\n      const offer = await this.publishConnection.createOffer(this.trackStates);\n      await this.publishConnection.setLocalDescription(offer);\n      const answer = await this.signal.offer(offer, this.trackStates);\n      await this.publishConnection.setRemoteDescription(answer);\n      for (const candidate of this.publishConnection.candidates) {\n        await this.publishConnection.addIceCandidate(candidate);\n      }\n\n      this.publishConnection.initAfterJoin();\n      return !!answer;\n    } catch (ex) {\n      // resolve for now as this might happen during migration\n      if (ex instanceof HMSException && ex.code === 421) {\n        return true;\n      }\n      throw ex;\n    }\n  }\n\n  private async performPublishRenegotiation(constraints?: RTCOfferOptions) {\n    HMSLogger.d(TAG, `\u23F3 [role=PUBLISH] onRenegotiationNeeded START`, this.trackStates);\n    const callback = this.callbacks.get(RENEGOTIATION_CALLBACK_ID);\n    if (!callback) {\n      HMSLogger.w(TAG, 'no callback found for renegotiation');\n      return;\n    }\n\n    if (!this.publishConnection) {\n      HMSLogger.e(TAG, 'Publish peer connection not found, cannot renegotiate');\n      return;\n    }\n\n    try {\n      const offer = await this.publishConnection.createOffer(this.trackStates, constraints);\n      await this.publishConnection.setLocalDescription(offer);\n      HMSLogger.time(`renegotiation-offer-exchange`);\n      const answer = await this.signal.offer(offer, this.trackStates);\n      this.callbacks.delete(RENEGOTIATION_CALLBACK_ID);\n      HMSLogger.timeEnd(`renegotiation-offer-exchange`);\n      await this.publishConnection.setRemoteDescription(answer);\n      callback.promise.resolve(true);\n      HMSLogger.d(TAG, `[role=PUBLISH] onRenegotiationNeeded DONE \u2705`);\n    } catch (err) {\n      let ex: HMSException;\n      if (err instanceof HMSException) {\n        ex = err;\n      } else {\n        ex = ErrorFactory.GenericErrors.Unknown(HMSAction.PUBLISH, (err as Error).message);\n      }\n\n      // resolve for now as this might happen during migration\n      if (ex.code === 421) {\n        callback.promise.resolve(true);\n      } else {\n        callback.promise.reject(ex);\n      }\n      HMSLogger.d(TAG, `[role=PUBLISH] onRenegotiationNeeded FAILED \u274C`);\n    }\n  }\n\n  private async handleIceConnectionFailure(role: HMSConnectionRole, error: HMSException) {\n    // ice retry is already in progress(from disconnect state)\n    if (\n      this.retryScheduler.isTaskInProgress(\n        HMSConnectionRole.Publish\n          ? TransportFailureCategory.PublishIceConnectionFailed\n          : TransportFailureCategory.SubscribeIceConnectionFailed,\n      )\n    ) {\n      return;\n    }\n\n    if (role === HMSConnectionRole.Publish) {\n      this.retryScheduler.schedule({\n        category: TransportFailureCategory.PublishIceConnectionFailed,\n        error,\n        task: this.retryPublishIceFailedTask,\n        originalState: TransportState.Joined,\n      });\n    } else {\n      this.retryScheduler.schedule({\n        category: TransportFailureCategory.SubscribeIceConnectionFailed,\n        error,\n        task: this.retrySubscribeIceFailedTask,\n        originalState: TransportState.Joined,\n        maxFailedRetries: 1,\n      });\n    }\n  }\n\n  private async internalConnect(token: string, initEndpoint: string, peerId: string, iceServers?: HMSICEServer[]) {\n    HMSLogger.d(TAG, 'connect: started \u23F0');\n    const connectRequestedAt = new Date();\n    try {\n      this.analyticsTimer.start(TimedEvent.INIT);\n      this.initConfig = await InitService.fetchInitConfig({\n        token,\n        peerId,\n        userAgent: this.store.getUserAgent(),\n        initEndpoint,\n        iceServers,\n      });\n      this.connectivityListener?.onInitSuccess(this.initConfig.endpoint);\n      const room = this.store.getRoom();\n      if (room) {\n        room.effectsKey = this.initConfig.config.vb?.effectsKey;\n        room.isEffectsEnabled = this.isFlagEnabled(InitFlags.FLAG_EFFECTS_SDK_ENABLED);\n        room.isVBEnabled = this.isFlagEnabled(InitFlags.FLAG_VB_ENABLED);\n        room.isHipaaEnabled = this.isFlagEnabled(InitFlags.FLAG_HIPAA_ENABLED);\n        room.isNoiseCancellationEnabled = this.isFlagEnabled(InitFlags.FLAG_NOISE_CANCELLATION);\n      }\n      this.analyticsTimer.end(TimedEvent.INIT);\n      HTTPAnalyticsTransport.setWebsocketEndpoint(this.initConfig.endpoint);\n      // if leave was called while init was going on, don't open websocket\n      this.validateNotDisconnected('post init');\n      await this.openSignal(token, peerId);\n      this.observer.onConnected();\n      this.connectivityListener?.onSignallingSuccess();\n      this.store.setSimulcastEnabled(this.isFlagEnabled(InitFlags.FLAG_SERVER_SIMULCAST));\n      HMSLogger.d(TAG, 'Adding Analytics Transport: JsonRpcSignal');\n      this.analyticsEventsService.setTransport(this.analyticsSignalTransport);\n      this.analyticsEventsService.flush();\n      return this.initConfig;\n    } catch (error) {\n      if (this.state !== TransportState.Reconnecting) {\n        this.eventBus.analytics.publish(\n          AnalyticsEventFactory.connect(\n            error as Error,\n            this.getAdditionalAnalyticsProperties(),\n            connectRequestedAt,\n            new Date(),\n            initEndpoint,\n          ),\n        );\n      }\n      HMSLogger.e(TAG, '\u274C internal connect: failed', error);\n      throw error;\n    }\n  }\n\n  // leave could be called between any two async tasks, which would make\n  // the state disconnected instead of connecting, throw error for those cases.\n  private validateNotDisconnected(stage: string) {\n    if (this.state === TransportState.Disconnected) {\n      HMSLogger.w(TAG, 'aborting join as transport state is disconnected');\n      throw ErrorFactory.GenericErrors.ValidationFailed(`leave called before join could complete - stage=${stage}`);\n    }\n  }\n\n  private async openSignal(token: string, peerId: string) {\n    if (!this.initConfig) {\n      throw ErrorFactory.APIErrors.InitConfigNotAvailable(HMSAction.INIT, 'Init Config not found');\n    }\n\n    HMSLogger.d(TAG, '\u23F3 internal connect: connecting to ws endpoint', this.initConfig.endpoint);\n    const url = new URL(this.initConfig.endpoint);\n    url.searchParams.set('peer', peerId);\n    url.searchParams.set('token', token);\n    url.searchParams.set('user_agent_v2', this.store.getUserAgent());\n    url.searchParams.set('protocol_version', PROTOCOL_VERSION);\n    url.searchParams.set('protocol_spec', PROTOCOL_SPEC);\n\n    this.endpoint = url.toString();\n    this.analyticsTimer.start(TimedEvent.WEBSOCKET_CONNECT);\n    await this.signal.open(this.endpoint);\n    this.analyticsTimer.end(TimedEvent.WEBSOCKET_CONNECT);\n    this.analyticsTimer.start(TimedEvent.ON_POLICY_CHANGE);\n    this.analyticsTimer.start(TimedEvent.ROOM_STATE);\n    HMSLogger.d(TAG, '\u2705 internal connect: connected to ws endpoint');\n  }\n\n  private initStatsAnalytics() {\n    if (this.isFlagEnabled(InitFlags.FLAG_PUBLISH_STATS)) {\n      this.publishStatsAnalytics = new PublishStatsAnalytics(\n        this.store,\n        this.eventBus,\n        this.getValueFromInitConfig('publishStats', 'maxSampleWindowSize', PUBLISH_STATS_SAMPLE_WINDOW),\n        this.getValueFromInitConfig('publishStats', 'maxSamplePushInterval', PUBLISH_STATS_PUSH_INTERVAL),\n      );\n\n      this.getWebrtcInternals()?.start();\n    }\n\n    if (this.isFlagEnabled(InitFlags.FLAG_SUBSCRIBE_STATS)) {\n      this.subscribeStatsAnalytics = new SubscribeStatsAnalytics(\n        this.store,\n        this.eventBus,\n        this.getValueFromInitConfig('subscribeStats', 'maxSampleWindowSize', SUBSCRIBE_STATS_SAMPLE_WINDOW),\n        this.getValueFromInitConfig('subscribeStats', 'maxSamplePushInterval', SUBSCRIBE_STATS_PUSH_INTERVAL),\n      );\n\n      this.getWebrtcInternals()?.start();\n    }\n  }\n\n  private getValueFromInitConfig(\n    baseKey: 'publishStats' | 'subscribeStats',\n    subKey: 'maxSampleWindowSize' | 'maxSamplePushInterval',\n    defaultValue: number,\n  ) {\n    return this.initConfig?.config[baseKey]?.[subKey] || defaultValue;\n  }\n\n  /**\n   * Role does not need WebRTC(peer connections to communicate to SFU) if it cannot publish or subscribe to anything\n   * @returns boolean denoting if a peer cannot publish(video, audio or screen) and cannot subscribe to any role\n   */\n  private doesRoleNeedWebRTC(role: HMSRole) {\n    if (!this.isFlagEnabled(InitFlags.FLAG_NON_WEBRTC_DISABLE_OFFER)) {\n      return true;\n    }\n\n    const isPublishing = Boolean(role.publishParams.allowed && role.publishParams.allowed?.length > 0);\n    const isSubscribing = Boolean(\n      role.subscribeParams.subscribeToRoles && role.subscribeParams.subscribeToRoles?.length > 0,\n    );\n\n    return isPublishing || isSubscribing;\n  }\n\n  private doesLocalPeerNeedWebRTC() {\n    const localRole = this.store.getLocalPeer()?.role;\n    if (!localRole) {\n      return true;\n    }\n\n    return this.doesRoleNeedWebRTC(localRole);\n  }\n\n  private retryPublishIceFailedTask = async () => {\n    /**\n     * Proceed with the retry even if the connection state is connected as the offer could have failed\n     * which will cause missing tiles if it is not sent again.\n     * Do iceRestart only if not connected\n     */\n    if (this.publishConnection) {\n      const p = new Promise<boolean>((resolve, reject) => {\n        this.callbacks.set(RENEGOTIATION_CALLBACK_ID, {\n          promise: { resolve, reject },\n          action: HMSAction.RESTART_ICE,\n          extra: {},\n        });\n      });\n      await this.performPublishRenegotiation({ iceRestart: this.publishConnection.connectionState !== 'connected' });\n      await p;\n    }\n\n    return true;\n  };\n\n  private retrySubscribeIceFailedTask = async () => {\n    if (this.subscribeConnection && this.subscribeConnection.connectionState !== 'connected') {\n      const p = new Promise<boolean>((resolve, reject) => {\n        // Use subscribe constant string\n        this.callbacks.set(SUBSCRIBE_ICE_CONNECTION_CALLBACK_ID, {\n          promise: { resolve, reject },\n          action: HMSAction.RESTART_ICE,\n          extra: {},\n        });\n      });\n\n      const timeout = new Promise(resolve => {\n        setTimeout(resolve, SUBSCRIBE_TIMEOUT, false);\n      });\n\n      return Promise.race([p, timeout]) as Promise<boolean>;\n    }\n\n    return true;\n  };\n\n  private retrySignalDisconnectTask = async () => {\n    HMSLogger.d(TAG, 'retrySignalDisconnectTask', { signalConnected: this.signal.isConnected });\n    // Check if ws is disconnected - otherwise if only publishIce fails\n    // and ws connect is success then we don't need to reconnect to WebSocket\n    if (!this.signal.isConnected) {\n      await this.internalConnect(\n        this.joinParameters!.authToken,\n        this.joinParameters!.endpoint,\n        this.joinParameters!.peerId,\n        this.joinParameters!.iceServers,\n      );\n    }\n\n    // Only retry publish failed task after joining the call - not needed in preview signal reconnect\n    const ok = this.store.getRoom()?.joinedAt\n      ? this.signal.isConnected && (await this.retryPublishIceFailedTask())\n      : this.signal.isConnected;\n    // Send track update to sync local track state changes during reconnection\n    this.signal.trackUpdate(this.trackStates);\n\n    return ok;\n  };\n\n  private setTransportStateForConnect() {\n    if (this.state === TransportState.Failed) {\n      this.state = TransportState.Disconnected;\n    }\n\n    if (this.state !== TransportState.Disconnected && this.state !== TransportState.Reconnecting) {\n      throw ErrorFactory.WebsocketMethodErrors.AlreadyJoined(\n        HMSAction.JOIN,\n        `Cannot join a meeting in ${this.state} state`,\n      );\n    }\n\n    if (this.state === TransportState.Disconnected) {\n      this.state = TransportState.Connecting;\n      this.observer.onStateChange(this.state);\n    }\n  }\n\n  private sendErrorAnalyticsEvent(error: HMSException, category: TransportFailureCategory) {\n    const additionalProps = this.getAdditionalAnalyticsProperties();\n    let event: AnalyticsEvent;\n    switch (category) {\n      case TransportFailureCategory.ConnectFailed:\n        event = AnalyticsEventFactory.connect(error, additionalProps);\n        break;\n      case TransportFailureCategory.SignalDisconnect:\n        event = AnalyticsEventFactory.disconnect(error, additionalProps);\n        break;\n      case TransportFailureCategory.JoinWSMessageFailed:\n        event = AnalyticsEventFactory.join({\n          error,\n          time: this.analyticsTimer.getTimeTaken(TimedEvent.JOIN),\n          init_response_time: this.analyticsTimer.getTimeTaken(TimedEvent.INIT),\n          ws_connect_time: this.analyticsTimer.getTimeTaken(TimedEvent.WEBSOCKET_CONNECT),\n          on_policy_change_time: this.analyticsTimer.getTimeTaken(TimedEvent.ON_POLICY_CHANGE),\n          local_audio_track_time: this.analyticsTimer.getTimeTaken(TimedEvent.LOCAL_AUDIO_TRACK),\n          local_video_track_time: this.analyticsTimer.getTimeTaken(TimedEvent.LOCAL_VIDEO_TRACK),\n          retries_join: this.joinRetryCount,\n        });\n        break;\n      case TransportFailureCategory.PublishIceConnectionFailed:\n        event = AnalyticsEventFactory.publish({ error });\n        break;\n      case TransportFailureCategory.SubscribeIceConnectionFailed:\n        event = AnalyticsEventFactory.subscribeFail(error);\n        break;\n    }\n    this.eventBus.analytics.publish(event!);\n  }\n\n  getSubscribeConnection() {\n    return this.subscribeConnection;\n  }\n\n  getAdditionalAnalyticsProperties(): AdditionalAnalyticsProperties {\n    const network_info = getNetworkInfo();\n    const document_hidden = typeof document !== 'undefined' && document.hidden;\n    const num_degraded_tracks = this.store.getRemoteVideoTracks().filter(track => track.degraded).length;\n    const publishBitrate = this.getWebrtcInternals()?.getCurrentStats()?.getLocalPeerStats()?.publish?.bitrate;\n    const subscribeBitrate = this.getWebrtcInternals()?.getCurrentStats()?.getLocalPeerStats()?.subscribe?.bitrate;\n\n    return {\n      network_info,\n      document_hidden,\n      num_degraded_tracks,\n      bitrate: {\n        publish: publishBitrate,\n        subscribe: subscribeBitrate,\n      },\n      max_sub_bitrate: this.maxSubscribeBitrate,\n      recent_pong_response_times: this.signal.getPongResponseTimes(),\n      transport_state: this.state,\n    };\n  }\n}\n", "import { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\n\nexport interface AuthToken {\n  roomId: string;\n  userId: string;\n  role: string;\n}\n\nexport default function decodeJWT(token?: string): AuthToken {\n  if (!token || token.length === 0) {\n    throw ErrorFactory.APIErrors.InvalidTokenFormat(\n      HMSAction.INIT,\n      'Token cannot be an empty string or undefined or null',\n    );\n  }\n\n  const parts = token.split('.');\n  if (parts.length !== 3) {\n    throw ErrorFactory.APIErrors.InvalidTokenFormat(\n      HMSAction.INIT,\n      `Expected 3 '.' separate fields - header, payload and signature respectively`,\n    );\n  }\n\n  const payloadStr = atob(parts[1]);\n  try {\n    const payload = JSON.parse(payloadStr);\n    return {\n      roomId: payload.room_id,\n      userId: payload.user_id,\n      role: payload.role,\n    } as AuthToken;\n  } catch (err) {\n    throw ErrorFactory.APIErrors.InvalidTokenFormat(\n      HMSAction.INIT,\n      `couldn't parse to json - ${(err as Error).message}`,\n    );\n  }\n}\n", "import HMSRoom from './models/HMSRoom';\nimport { HMSLocalPeer } from './models/peer';\nimport { HMSPeerListIterator } from './HMSPeerListIterator';\nimport { LocalTrackManager } from './LocalTrackManager';\nimport { NetworkTestManager } from './NetworkTestManager';\nimport RoleChangeManager from './RoleChangeManager';\nimport { Store } from './store';\nimport { WakeLockManager } from './WakeLockManager';\nimport AnalyticsEvent from '../analytics/AnalyticsEvent';\nimport AnalyticsEventFactory from '../analytics/AnalyticsEventFactory';\nimport { HMSAnalyticsLevel } from '../analytics/AnalyticsEventLevel';\nimport { AnalyticsEventsService } from '../analytics/AnalyticsEventsService';\nimport { AnalyticsTimer, TimedEvent } from '../analytics/AnalyticsTimer';\nimport { AudioSinkManager } from '../audio-sink-manager';\nimport { PluginUsageTracker } from '../common/PluginUsageTracker';\nimport { DeviceManager } from '../device-manager';\nimport { AudioOutputManager } from '../device-manager/AudioOutputManager';\nimport { DeviceStorageManager } from '../device-manager/DeviceStorage';\nimport { HMSDiagnosticsConnectivityListener } from '../diagnostics/interfaces';\nimport { FeedbackService, HMSSessionFeedback, HMSSessionInfo } from '../end-call-feedback';\nimport { ErrorCodes } from '../error/ErrorCodes';\nimport { ErrorFactory } from '../error/ErrorFactory';\nimport { HMSAction } from '../error/HMSAction';\nimport { HMSException } from '../error/HMSException';\nimport { EventBus } from '../events/EventBus';\nimport {\n  HMSAudioCodec,\n  HMSChangeMultiTrackStateParams,\n  HMSConfig,\n  HMSConnectionQualityListener,\n  HMSDeviceChangeEvent,\n  HMSFrameworkInfo,\n  HMSMessageInput,\n  HMSPeerType,\n  HMSPlaylistSettings,\n  HMSPlaylistType,\n  HMSPreviewConfig,\n  HMSRole,\n  HMSRoleChangeRequest,\n  HMSScreenShareConfig,\n  HMSVideoCodec,\n  TokenRequest,\n  TokenRequestOptions,\n} from '../interfaces';\nimport { DeviceChangeListener } from '../interfaces/devices';\nimport { IErrorListener } from '../interfaces/error-listener';\nimport { HLSConfig, HLSTimedMetadata } from '../interfaces/hls-config';\nimport { HMSInterface } from '../interfaces/hms';\nimport { HMSLeaveRoomRequest } from '../interfaces/leave-room-request';\nimport { HMSPeerListIteratorOptions } from '../interfaces/peer-list-iterator';\nimport { HMSPreviewListener } from '../interfaces/preview-listener';\nimport { RTMPRecordingConfig } from '../interfaces/rtmp-recording-config';\nimport InitialSettings from '../interfaces/settings';\nimport { HMSAudioListener, HMSPeerUpdate, HMSTrackUpdate, HMSUpdateListener } from '../interfaces/update-listener';\nimport { PlaylistManager, TranscriptionConfig } from '../internal';\nimport { HMSAudioTrackSettingsBuilder, HMSVideoTrackSettingsBuilder } from '../media/settings';\nimport { HMSLocalStream } from '../media/streams/HMSLocalStream';\nimport {\n  HMSLocalAudioTrack,\n  HMSLocalTrack,\n  HMSLocalVideoTrack,\n  HMSRemoteTrack,\n  HMSTrackSource,\n  HMSTrackType,\n  HMSVideoTrack,\n} from '../media/tracks';\nimport {\n  HMSNotificationMethod,\n  PeerLeaveRequestNotification,\n  PeerNotificationInfo,\n  SendMessage,\n} from '../notification-manager';\nimport { createRemotePeer } from '../notification-manager/managers/utils';\nimport { NotificationManager } from '../notification-manager/NotificationManager';\nimport { SessionStore } from '../session-store';\nimport { InteractivityCenter } from '../session-store/interactivity-center';\nimport { InitConfig, InitFlags } from '../signal/init/models';\nimport {\n  FindPeerByNameRequestParams,\n  HLSRequestParams,\n  HLSTimedMetadataParams,\n  HLSVariant,\n  StartRTMPOrRecordingRequestParams,\n  StartTranscriptionRequestParams,\n} from '../signal/interfaces';\nimport HMSTransport from '../transport';\nimport ITransportObserver from '../transport/ITransportObserver';\nimport { TransportState } from '../transport/models/TransportState';\nimport { getAnalyticsDeviceId } from '../utils/analytics-deviceId';\nimport {\n  DEFAULT_PLAYLIST_AUDIO_BITRATE,\n  DEFAULT_PLAYLIST_VIDEO_BITRATE,\n  HAND_RAISE_GROUP_NAME,\n} from '../utils/constants';\nimport { fetchWithRetry } from '../utils/fetch';\nimport decodeJWT from '../utils/jwt';\nimport HMSLogger, { HMSLogLevel } from '../utils/logger';\nimport { HMSAudioContextHandler } from '../utils/media';\nimport { isNode } from '../utils/support';\nimport { workerSleep } from '../utils/timer-utils';\nimport { validateMediaDevicesExistence, validatePublishParams, validateRTCPeerConnection } from '../utils/validations';\n\nconst INITIAL_STATE = {\n  published: false,\n  isInitialised: false,\n  isReconnecting: false,\n  isPreviewInProgress: false,\n  isPreviewCalled: false,\n  isJoinInProgress: false,\n  deviceManagersInitialised: false,\n};\n\nexport class HMSSdk implements HMSInterface {\n  private transport!: HMSTransport;\n  private readonly TAG = '[HMSSdk]:';\n  public listener?: HMSUpdateListener;\n  private errorListener?: IErrorListener;\n  private deviceChangeListener?: DeviceChangeListener;\n  private audioListener?: HMSAudioListener;\n  public store!: Store;\n  private notificationManager?: NotificationManager;\n  /** @internal */\n  public deviceManager!: DeviceManager;\n  private audioSinkManager!: AudioSinkManager;\n  private playlistManager!: PlaylistManager;\n  private audioOutput!: AudioOutputManager;\n  private transportState: TransportState = TransportState.Disconnected;\n  private roleChangeManager?: RoleChangeManager;\n  /** @internal */\n  public localTrackManager!: LocalTrackManager;\n  private analyticsEventsService!: AnalyticsEventsService;\n  private analyticsTimer = new AnalyticsTimer();\n  private eventBus!: EventBus;\n  private networkTestManager!: NetworkTestManager;\n  private wakeLockManager!: WakeLockManager;\n  private sessionStore!: SessionStore;\n  private interactivityCenter!: InteractivityCenter;\n  private pluginUsageTracker!: PluginUsageTracker;\n  private sdkState = { ...INITIAL_STATE };\n  private frameworkInfo?: HMSFrameworkInfo;\n  private isDiagnostics = false;\n  /**\n   * will be set post join\n   * this will not be reset on leave but after feedback success\n   * we will just clean token after successful submit feedback\n   * will be replaced when a newer join happens.\n   */\n  private sessionPeerInfo?: HMSSessionInfo;\n\n  private playlistSettings: HMSPlaylistSettings = {\n    video: {\n      bitrate: DEFAULT_PLAYLIST_VIDEO_BITRATE,\n    },\n    audio: {\n      bitrate: DEFAULT_PLAYLIST_AUDIO_BITRATE,\n    },\n  };\n\n  private setSessionPeerInfo(websocketURL: string, peer?: HMSLocalPeer) {\n    const room = this.store.getRoom();\n    if (!peer || !room) {\n      HMSLogger.e(this.TAG, 'setSessionPeerInfo> Local peer or room is undefined');\n      return;\n    }\n    this.sessionPeerInfo = {\n      peer: {\n        peer_id: peer.peerId,\n        role: peer.role?.name,\n        joined_at: peer.joinedAt?.valueOf() || 0,\n        room_name: room.name,\n        session_started_at: room.startedAt?.valueOf() || 0,\n        user_data: peer.customerUserId,\n        user_name: peer.name,\n        template_id: room.templateId,\n        session_id: room.sessionId,\n        token: this.store.getConfig()?.authToken,\n      },\n      agent: this.store.getUserAgent(),\n      device_id: getAnalyticsDeviceId(),\n      cluster: {\n        websocket_url: websocketURL,\n      },\n      timestamp: Date.now(),\n    };\n  }\n  private initNotificationManager() {\n    if (!this.notificationManager) {\n      this.notificationManager = new NotificationManager(\n        this.store,\n        this.eventBus,\n        this.transport!,\n        this.listener,\n        this.audioListener,\n      );\n    }\n  }\n\n  /** @internal */\n  initStoreAndManagers(listener: HMSPreviewListener | HMSUpdateListener | HMSDiagnosticsConnectivityListener) {\n    this.listener = listener as unknown as HMSUpdateListener;\n    this.errorListener = listener;\n    this.deviceChangeListener = listener;\n    this.store?.setErrorListener(this.errorListener);\n\n    if (this.sdkState.isInitialised) {\n      /**\n       * Set listener after both join and preview, since they can have different listeners\n       */\n      this.notificationManager?.setListener(this.listener);\n      this.audioSinkManager.setListener(this.listener);\n      this.interactivityCenter.setListener(this.listener);\n      this.transport.setListener(this.listener);\n      return;\n    }\n\n    this.sdkState.isInitialised = true;\n    this.store = new Store();\n    this.store.setErrorListener(this.errorListener);\n    this.eventBus = new EventBus();\n    this.pluginUsageTracker = new PluginUsageTracker(this.eventBus);\n    this.wakeLockManager = new WakeLockManager();\n    this.networkTestManager = new NetworkTestManager(this.eventBus, this.listener);\n    this.playlistManager = new PlaylistManager(this, this.eventBus);\n    this.deviceManager = new DeviceManager(this.store, this.eventBus);\n    this.audioSinkManager = new AudioSinkManager(this.store, this.deviceManager, this.eventBus);\n    this.audioOutput = new AudioOutputManager(this.deviceManager, this.audioSinkManager);\n    this.audioSinkManager.setListener(this.listener);\n    this.eventBus.autoplayError.subscribe(this.handleAutoplayError);\n    this.localTrackManager = new LocalTrackManager(\n      this.store,\n      this.observer,\n      this.deviceManager,\n      this.eventBus,\n      this.analyticsTimer,\n    );\n    this.analyticsEventsService = new AnalyticsEventsService(this.store);\n    this.transport = new HMSTransport(\n      this.observer,\n      this.deviceManager,\n      this.store,\n      this.eventBus,\n      this.analyticsEventsService,\n      this.analyticsTimer,\n      this.pluginUsageTracker,\n    );\n    // add diagnostics callbacks if present\n    if ('onInitSuccess' in listener) {\n      this.transport.setConnectivityListener(listener);\n    }\n    this.sessionStore = new SessionStore(this.transport);\n    this.interactivityCenter = new InteractivityCenter(this.transport, this.store, this.listener);\n    /**\n     * Note: Subscribe to events here right after creating stores and managers\n     * to not miss events that are published before the handlers are subscribed.\n     */\n    this.eventBus.analytics.subscribe(this.sendAnalyticsEvent);\n    this.eventBus.deviceChange.subscribe(this.handleDeviceChange);\n    this.eventBus.localVideoUnmutedNatively.subscribe(this.unpauseRemoteVideoTracks);\n    this.eventBus.audioPluginFailed.subscribe(this.handleAudioPluginError);\n  }\n\n  private validateJoined(name: string) {\n    if (!this.localPeer) {\n      throw ErrorFactory.GenericErrors.NotConnected(HMSAction.VALIDATION, `Not connected - ${name}`);\n    }\n  }\n\n  // @ts-ignore\n  private sendHLSAnalytics(error: HMSException) {\n    this.sendAnalyticsEvent(AnalyticsEventFactory.hlsPlayerError(error));\n  }\n\n  async refreshDevices() {\n    this.validateJoined('refreshDevices');\n    await this.deviceManager.init(true);\n  }\n\n  getWebrtcInternals() {\n    return this.transport?.getWebrtcInternals();\n  }\n\n  getSessionStore() {\n    return this.sessionStore;\n  }\n\n  getPlaylistManager(): PlaylistManager {\n    return this.playlistManager;\n  }\n\n  getRecordingState() {\n    return this.store.getRoom()?.recording;\n  }\n\n  getRTMPState() {\n    return this.store.getRoom()?.rtmp;\n  }\n\n  getHLSState() {\n    return this.store.getRoom()?.hls;\n  }\n\n  getTranscriptionState() {\n    return this.store.getRoom()?.transcriptions;\n  }\n\n  getTemplateAppData() {\n    return this.store.getTemplateAppData();\n  }\n\n  getInteractivityCenter() {\n    return this.interactivityCenter;\n  }\n\n  getPeerListIterator(options?: HMSPeerListIteratorOptions) {\n    return new HMSPeerListIterator(this.transport, this.store, options);\n  }\n\n  updatePlaylistSettings(options: HMSPlaylistSettings) {\n    if (options.video) {\n      Object.assign(this.playlistSettings.video, options.video);\n    }\n    if (options.audio) {\n      Object.assign(this.playlistSettings.audio, options.audio);\n    }\n  }\n\n  private handleAutoplayError = (error: HMSException) => {\n    this.errorListener?.onError?.(error);\n  };\n\n  private get localPeer(): HMSLocalPeer | undefined {\n    return this.store?.getLocalPeer();\n  }\n\n  private observer: ITransportObserver = {\n    onNotification: (message: any) => {\n      if (message.method === HMSNotificationMethod.PEER_LEAVE_REQUEST) {\n        this.handlePeerLeaveRequest(message.params as PeerLeaveRequestNotification);\n        return;\n      }\n\n      switch (message.method) {\n        case HMSNotificationMethod.POLICY_CHANGE:\n          this.analyticsTimer.end(TimedEvent.ON_POLICY_CHANGE);\n          break;\n        case HMSNotificationMethod.PEER_LIST:\n          this.analyticsTimer.end(TimedEvent.PEER_LIST);\n          this.sendJoinAnalyticsEvent(this.sdkState.isPreviewCalled);\n          break;\n        case HMSNotificationMethod.ROOM_STATE:\n          this.analyticsTimer.end(TimedEvent.ROOM_STATE);\n          break;\n        default:\n      }\n\n      this.notificationManager?.handleNotification(message, this.sdkState.isReconnecting);\n    },\n\n    onConnected: () => {\n      this.initNotificationManager();\n    },\n\n    onTrackAdd: (track: HMSRemoteTrack) => {\n      this.notificationManager?.handleTrackAdd(track);\n    },\n\n    onTrackRemove: (track: HMSRemoteTrack) => {\n      this.notificationManager?.handleTrackRemove(track);\n    },\n\n    onFailure: (exception: HMSException) => {\n      this.errorListener?.onError(exception);\n    },\n\n    onStateChange: async (state: TransportState, error?: HMSException) => {\n      const handleFailedState = async (error?: HMSException) => {\n        await this.internalLeave(true, error);\n        /**\n         * no need to call onError here when preview/join is in progress\n         * since preview/join will call onError when they receive leave event from the above call\n         */\n        if (!this.sdkState.isPreviewInProgress && !this.sdkState.isJoinInProgress) {\n          this.errorListener?.onError?.(error!);\n        }\n        this.sdkState.isReconnecting = false;\n      };\n\n      switch (state) {\n        case TransportState.Preview:\n        case TransportState.Joined:\n          this.initNotificationManager();\n          if (this.transportState === TransportState.Reconnecting) {\n            this.listener?.onReconnected();\n          }\n          break;\n        case TransportState.Failed:\n          await handleFailedState(error);\n          break;\n        case TransportState.Reconnecting:\n          this.sdkState.isReconnecting = true;\n          this.listener?.onReconnecting(error!);\n          break;\n      }\n\n      this.transportState = state;\n      HMSLogger.d(this.TAG, 'Transport State Change', this.transportState);\n    },\n  };\n\n  private handlePeerLeaveRequest = (message: PeerLeaveRequestNotification) => {\n    const peer = message.requested_by ? this.store.getPeerById(message.requested_by) : undefined;\n    const request: HMSLeaveRoomRequest = {\n      roomEnded: message.room_end,\n      reason: message.reason,\n      requestedBy: peer,\n    };\n    this.listener?.onRemovedFromRoom(request);\n    this.internalLeave(false);\n  };\n\n  async preview(config: HMSPreviewConfig, listener: HMSPreviewListener) {\n    validateMediaDevicesExistence();\n    validateRTCPeerConnection();\n\n    if (this.sdkState.isPreviewInProgress) {\n      return Promise.reject(\n        ErrorFactory.GenericErrors.PreviewAlreadyInProgress(HMSAction.PREVIEW, 'Preview already called'),\n      );\n    }\n\n    if ([TransportState.Joined, TransportState.Reconnecting].includes(this.transportState)) {\n      return this.midCallPreview(config.asRole, config.settings);\n    }\n\n    this.analyticsTimer.start(TimedEvent.PREVIEW);\n    this.setUpPreview(config, listener);\n\n    // Request permissions and populate devices before waiting for policy\n    if (config.alwaysRequestPermissions) {\n      this.localTrackManager.requestPermissions().then(async () => {\n        await this.initDeviceManagers();\n      });\n    }\n\n    let initSuccessful = false;\n    let networkTestFinished = false;\n    const timerId = setTimeout(() => {\n      // If init or network is not done by 3s send -1\n      if (!initSuccessful || !networkTestFinished) {\n        this.listener?.onNetworkQuality?.(-1);\n      }\n    }, 3000);\n    return new Promise<void>((resolve, reject) => {\n      const policyHandler = async () => {\n        if (this.localPeer) {\n          const newRole = config.asRole && this.store.getPolicyForRole(config.asRole);\n          this.localPeer.asRole = newRole || this.localPeer.role;\n        }\n        const tracks = await this.localTrackManager.getTracksToPublish(config.settings);\n        tracks.forEach(track => this.setLocalPeerTrack(track));\n        this.localPeer?.audioTrack && this.initPreviewTrackAudioLevelMonitor();\n        await this.initDeviceManagers();\n        this.sdkState.isPreviewInProgress = false;\n        this.analyticsTimer.end(TimedEvent.PREVIEW);\n        const room = this.store.getRoom();\n        if (room) {\n          listener.onPreview(room, tracks);\n        }\n        this.sendPreviewAnalyticsEvent();\n        resolve();\n      };\n\n      this.eventBus.policyChange.subscribeOnce(policyHandler);\n      this.eventBus.leave.subscribeOnce(this.handlePreviewError);\n      this.eventBus.leave.subscribeOnce(ex => reject(ex as HMSException));\n\n      this.transport\n        .preview(\n          config.authToken,\n          config.initEndpoint!,\n          this.localPeer!.peerId,\n          { name: config.userName, metaData: config.metaData || '' },\n          config.autoVideoSubscribe,\n          config.iceServers,\n        )\n        .then((initConfig: InitConfig | void) => {\n          initSuccessful = true;\n          clearTimeout(timerId);\n          if (initConfig && config.captureNetworkQualityInPreview) {\n            this.networkTestManager.start(initConfig.config?.networkHealth).then(() => {\n              networkTestFinished = true;\n            });\n          }\n        })\n        .catch(ex => {\n          this.handlePreviewError(ex);\n          reject(ex);\n        });\n    });\n  }\n\n  private handlePreviewError = (ex?: HMSException) => {\n    this.analyticsTimer.end(TimedEvent.PREVIEW);\n    ex && this.errorListener?.onError(ex);\n    this.sendPreviewAnalyticsEvent(ex);\n    this.sdkState.isPreviewInProgress = false;\n  };\n\n  private async midCallPreview(asRole?: string, settings?: InitialSettings): Promise<void> {\n    if (!this.localPeer || this.transportState !== TransportState.Joined) {\n      throw ErrorFactory.GenericErrors.NotConnected(HMSAction.VALIDATION, 'Not connected - midCallPreview');\n    }\n\n    const newRole = asRole && this.store.getPolicyForRole(asRole);\n    if (!newRole) {\n      throw ErrorFactory.GenericErrors.InvalidRole(HMSAction.PREVIEW, `role ${asRole} does not exist in policy`);\n    }\n    this.localPeer.asRole = newRole;\n\n    const tracks = await this.localTrackManager.getTracksToPublish(settings);\n    tracks.forEach(track => this.setLocalPeerTrack(track));\n    this.localPeer?.audioTrack && this.initPreviewTrackAudioLevelMonitor();\n    await this.initDeviceManagers();\n\n    this.listener?.onPreview(this.store.getRoom()!, tracks);\n  }\n\n  async cancelMidCallPreview() {\n    if (!this.localPeer || !this.localPeer.isInPreview()) {\n      HMSLogger.w(this.TAG, 'Cannot cancel mid call preview as preview is not in progress');\n    }\n\n    if (this.localPeer?.asRole && this.localPeer.role) {\n      const oldRole = this.localPeer.asRole;\n      const newRole = this.localPeer.role;\n      delete this.localPeer.asRole;\n      await this.roleChangeManager?.diffRolesAndPublishTracks({\n        oldRole,\n        newRole,\n      });\n\n      this.listener?.onPeerUpdate(HMSPeerUpdate.ROLE_UPDATED, this.localPeer);\n    }\n  }\n\n  private handleDeviceChange = (event: HMSDeviceChangeEvent) => {\n    if (event.isUserSelection) {\n      return;\n    }\n    HMSLogger.d(this.TAG, 'Device Change event', event);\n    this.deviceChangeListener?.onDeviceChange?.(event);\n    const disableTrackOnError = () => {\n      if (event.error && event.type) {\n        const track = event.type.includes('audio') ? this.localPeer?.audioTrack : this.localPeer?.videoTrack;\n        this.errorListener?.onError(event.error);\n        if (\n          [\n            ErrorCodes.TracksErrors.CANT_ACCESS_CAPTURE_DEVICE,\n            ErrorCodes.TracksErrors.DEVICE_IN_USE,\n            ErrorCodes.TracksErrors.DEVICE_NOT_AVAILABLE,\n          ].includes(event.error.code) &&\n          track\n        ) {\n          track.setEnabled(false);\n          this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_MUTED, track, this.localPeer!);\n        }\n      }\n    };\n    disableTrackOnError();\n  };\n\n  private handleAudioPluginError = (error: HMSException) => {\n    HMSLogger.e(this.TAG, 'Audio Plugin Error event', error);\n    this.errorListener?.onError(error);\n  };\n\n  // eslint-disable-next-line complexity\n  async join(config: HMSConfig, listener: HMSUpdateListener) {\n    validateMediaDevicesExistence();\n    validateRTCPeerConnection();\n\n    if (this.sdkState.isPreviewInProgress) {\n      throw ErrorFactory.GenericErrors.NotReady(HMSAction.JOIN, \"Preview is in progress, can't join\");\n    }\n\n    // remove terminal error handling from preview(do not send preview.failed after join on disconnect)\n    this.eventBus?.leave?.unsubscribe(this.handlePreviewError);\n    this.analyticsTimer.start(TimedEvent.JOIN);\n    this.sdkState.isJoinInProgress = true;\n\n    const { roomId, userId, role } = decodeJWT(config.authToken);\n    const previewRole = this.localPeer?.asRole?.name || this.localPeer?.role?.name;\n    this.networkTestManager?.stop();\n    this.commonSetup(config, roomId, listener);\n    this.removeDevicesFromConfig(config);\n    this.store.setConfig(config);\n    /** set after config since we need config to get env for user agent */\n    this.store.createAndSetUserAgent(this.frameworkInfo);\n    HMSAudioContextHandler.resumeContext();\n    // acquire screen lock to stay awake while in call\n    const storeConfig = this.store.getConfig();\n    if (storeConfig?.autoManageWakeLock) {\n      this.wakeLockManager.acquireLock();\n    }\n\n    if (!this.localPeer) {\n      this.createAndAddLocalPeerToStore(config, role, userId);\n    } else {\n      this.localPeer.name = config.userName;\n      this.localPeer.role = this.store.getPolicyForRole(role);\n      this.localPeer.customerUserId = userId;\n      this.localPeer.metadata = config.metaData;\n      delete this.localPeer.asRole;\n    }\n\n    this.roleChangeManager = new RoleChangeManager(\n      this.store,\n      this.transport,\n      this.deviceManager,\n      this.getAndPublishTracks.bind(this),\n      this.removeTrack.bind(this),\n      this.listener,\n    );\n    this.eventBus.localRoleUpdate.subscribe(this.handleLocalRoleUpdate);\n\n    HMSLogger.d(this.TAG, `\u23F3 Joining room ${roomId}`);\n\n    HMSLogger.time(`join-room-${roomId}`);\n\n    try {\n      await this.transport.join(\n        config.authToken,\n        this.localPeer!.peerId,\n        { name: config.userName, metaData: config.metaData! },\n        config.initEndpoint!,\n        config.autoVideoSubscribe,\n        config.iceServers,\n      );\n      HMSLogger.d(this.TAG, `\u2705 Joined room ${roomId}`);\n      this.analyticsTimer.start(TimedEvent.PEER_LIST);\n      await this.notifyJoin();\n      this.sdkState.isJoinInProgress = false;\n      await this.publish(config.settings, previewRole);\n    } catch (error) {\n      this.analyticsTimer.end(TimedEvent.JOIN);\n      this.sdkState.isJoinInProgress = false;\n      this.listener?.onError(error as HMSException);\n      this.sendJoinAnalyticsEvent(this.sdkState.isPreviewCalled, error as HMSException);\n      HMSLogger.e(this.TAG, 'Unable to join room', error);\n      throw error;\n    }\n    HMSLogger.timeEnd(`join-room-${roomId}`);\n  }\n\n  private stringifyMetadata(config: HMSConfig) {\n    if (config.metaData && typeof config.metaData !== 'string') {\n      config.metaData = JSON.stringify(config.metaData);\n    } else if (!config.metaData) {\n      config.metaData = '';\n    }\n  }\n\n  private cleanup() {\n    this.cleanDeviceManagers();\n    this.eventBus.analytics.unsubscribe(this.sendAnalyticsEvent);\n    this.eventBus.localVideoUnmutedNatively.unsubscribe(this.unpauseRemoteVideoTracks);\n    this.analyticsTimer.cleanup();\n    DeviceStorageManager.cleanup();\n    this.playlistManager.cleanup();\n    this.wakeLockManager?.cleanup();\n    LocalTrackManager.cleanup();\n    this.notificationManager = undefined;\n    HMSLogger.cleanup();\n    this.sdkState = { ...INITIAL_STATE };\n    /**\n     * when leave is called after preview itself without join.\n     * Store won't have the tracks in this case\n     */\n    if (this.localPeer) {\n      this.localPeer.audioTrack?.cleanup();\n      this.localPeer.audioTrack = undefined;\n      this.localPeer.videoTrack?.cleanup();\n      this.localPeer.videoTrack = undefined;\n    }\n    this.store.cleanup();\n    this.listener = undefined;\n    if (this.roleChangeManager) {\n      this.eventBus.localRoleUpdate.unsubscribe(this.handleLocalRoleUpdate);\n    }\n  }\n\n  leave(notifyServer?: boolean) {\n    return this.internalLeave(notifyServer);\n  }\n\n  private async internalLeave(notifyServer = true, error?: HMSException) {\n    const room = this.store?.getRoom();\n    if (room) {\n      // Wait for preview or join to finish to prevent any race conditions happening because preview/join are called multiple times\n      // This can happen when useEffects are not properly handled in case of react apps\n      // when error is terminal this will go into infinite loop so error?.isTerminal check is needed\n      while ((this.sdkState.isPreviewInProgress || this.sdkState.isJoinInProgress) && !error?.isTerminal) {\n        await workerSleep(100);\n      }\n      const roomId = room.id;\n      // setSessionJoin\n      this.setSessionPeerInfo(this.transport.getWebsocketEndpoint() || '', this.localPeer);\n      this.networkTestManager?.stop();\n      this.eventBus.leave.publish(error);\n      const peerId = this.localPeer?.peerId;\n      HMSLogger.d(this.TAG, `\u23F3 Leaving room ${roomId}, peerId=${peerId}`);\n      // browsers often put limitation on amount of time a function set on window onBeforeUnload can take in case of\n      // tab refresh or close. Therefore prioritise the leave action over anything else, if tab is closed/refreshed\n      // we would want leave to succeed to stop stucked peer for others. The followup cleanup however is important\n      // for cases where uses stays on the page post leave.\n      await this.transport?.leave(notifyServer);\n      this.cleanup();\n      HMSLogger.d(this.TAG, `\u2705 Left room ${roomId}, peerId=${peerId}`);\n    }\n  }\n\n  async getAuthTokenByRoomCode(tokenRequest: TokenRequest, tokenRequestOptions?: TokenRequestOptions): Promise<string> {\n    const tokenAPIURL = (tokenRequestOptions || {}).endpoint || 'https://auth.100ms.live/v2/token';\n    this.analyticsTimer.start(TimedEvent.GET_TOKEN);\n    const response = await fetchWithRetry(\n      tokenAPIURL,\n      {\n        method: 'POST',\n        body: JSON.stringify({ code: tokenRequest.roomCode, user_id: tokenRequest.userId }),\n      },\n      [429, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511],\n    );\n\n    const data = await response.json();\n    this.analyticsTimer.end(TimedEvent.GET_TOKEN);\n\n    if (!response.ok) {\n      throw ErrorFactory.APIErrors.ServerErrors(data.code, HMSAction.GET_TOKEN, data.message, false);\n    }\n\n    const { token } = data;\n    if (!token) {\n      throw Error(data.message);\n    }\n    return token;\n  }\n\n  getLocalPeer() {\n    return this.store.getLocalPeer();\n  }\n\n  getPeers() {\n    return this.store.getPeers();\n  }\n\n  getPeerMap() {\n    return this.store.getPeerMap();\n  }\n\n  getAudioOutput() {\n    return this.audioOutput;\n  }\n\n  sendMessage(type: string, message: string) {\n    this.sendMessageInternal({ message, type });\n  }\n\n  async sendBroadcastMessage(message: string, type?: string) {\n    return await this.sendMessageInternal({ message, type });\n  }\n\n  async sendGroupMessage(message: string, roles: HMSRole[], type?: string) {\n    const knownRoles = this.store.getKnownRoles();\n    const recipientRoles =\n      roles.filter(role => {\n        return knownRoles[role.name];\n      }) || [];\n    if (recipientRoles.length === 0) {\n      throw ErrorFactory.GenericErrors.ValidationFailed('No valid role is present', roles);\n    }\n    return await this.sendMessageInternal({ message, recipientRoles: roles, type });\n  }\n\n  async sendDirectMessage(message: string, peerId: string, type?: string) {\n    if (this.localPeer?.peerId === peerId) {\n      throw ErrorFactory.GenericErrors.ValidationFailed('Cannot send message to self');\n    }\n    const isLargeRoom = !!this.store.getRoom()?.large_room_optimization;\n    let recipientPeer = this.store.getPeerById(peerId);\n    if (!recipientPeer) {\n      if (isLargeRoom) {\n        const peer = await this.transport.signal.getPeer({ peer_id: peerId });\n        if (!peer) {\n          throw ErrorFactory.GenericErrors.ValidationFailed('Invalid peer - peer not present in the room', peerId);\n        }\n        recipientPeer = createRemotePeer(peer, this.store);\n      } else {\n        throw ErrorFactory.GenericErrors.ValidationFailed('Invalid peer - peer not present in the room', peerId);\n      }\n    }\n\n    return await this.sendMessageInternal({ message, recipientPeer, type });\n  }\n  async submitSessionFeedback(feedback: HMSSessionFeedback, eventEndpoint?: string) {\n    if (!this.sessionPeerInfo) {\n      HMSLogger.e(this.TAG, 'submitSessionFeedback> session is undefined');\n      throw new Error('session is undefined');\n    }\n    const token = this.sessionPeerInfo.peer.token;\n    if (!token) {\n      HMSLogger.e(this.TAG, 'submitSessionFeedback> token is undefined');\n      throw new Error('Internal error, token is not present');\n    }\n    try {\n      await FeedbackService.sendFeedback({\n        token: token,\n        info: this.sessionPeerInfo,\n        feedback,\n        eventEndpoint,\n      });\n      HMSLogger.i(this.TAG, 'submitSessionFeedback> submitted feedback');\n      this.sessionPeerInfo = undefined;\n    } catch (e) {\n      HMSLogger.e(this.TAG, 'submitSessionFeedback> error occured ', e);\n      throw new Error('Unable to submit feedback');\n    }\n  }\n  async getPeer(peerId: string) {\n    const response = await this.transport.signal.getPeer({ peer_id: peerId });\n    if (response) {\n      return createRemotePeer(response, this.store);\n    }\n    return undefined;\n  }\n\n  async findPeerByName({ query, limit = 10, offset }: FindPeerByNameRequestParams) {\n    const {\n      peers,\n      offset: responseOffset,\n      eof,\n    } = await this.transport.signal.findPeerByName({ query: query?.toLowerCase(), limit, offset });\n    if (peers.length > 0) {\n      return {\n        offset: responseOffset,\n        eof,\n        peers: peers.map(peerInfo => {\n          return createRemotePeer(\n            {\n              peer_id: peerInfo.peer_id,\n              role: peerInfo.role,\n              groups: [],\n              info: {\n                name: peerInfo.name,\n                data: '',\n                user_id: '',\n                type: peerInfo.type,\n              },\n            } as PeerNotificationInfo,\n            this.store,\n          );\n        }),\n      };\n    }\n    return { offset: responseOffset, peers: [] };\n  }\n\n  private async sendMessageInternal({ recipientRoles, recipientPeer, type = 'chat', message }: HMSMessageInput) {\n    if (message.replace(/\\u200b/g, ' ').trim() === '') {\n      HMSLogger.w(this.TAG, 'sendMessage', 'Ignoring empty message send');\n      throw ErrorFactory.GenericErrors.ValidationFailed('Empty message not allowed');\n    }\n    const sendParams: SendMessage = {\n      info: {\n        message,\n        type,\n      },\n    };\n    if (recipientRoles?.length) {\n      sendParams.roles = recipientRoles.map(role => role.name);\n    }\n    if (recipientPeer?.peerId) {\n      sendParams.peer_id = recipientPeer.peerId;\n    }\n    HMSLogger.d(this.TAG, 'Sending Message: ', sendParams);\n    return await this.transport.signal.broadcast(sendParams);\n  }\n\n  async startScreenShare(onStop: () => void, config?: HMSScreenShareConfig) {\n    const publishParams = this.store.getPublishParams();\n    if (!publishParams) {\n      return;\n    }\n\n    const { allowed } = publishParams;\n    const canPublishScreen = allowed && allowed.includes('screen');\n\n    if (!canPublishScreen) {\n      HMSLogger.e(this.TAG, `Role ${this.localPeer?.role} cannot share screen`);\n      return;\n    }\n\n    if (this.localPeer?.auxiliaryTracks?.find(track => track.source === 'screen')) {\n      throw Error('Cannot share multiple screens');\n    }\n\n    const tracks = await this.getScreenshareTracks(onStop, config);\n    if (!this.localPeer) {\n      HMSLogger.d(this.TAG, 'Screenshared when not connected');\n      tracks.forEach(track => {\n        track.cleanup();\n      });\n      return;\n    }\n    this.transport.setOnScreenshareStop(() => {\n      this.stopEndedScreenshare(onStop);\n    });\n    await this.transport.publish(tracks);\n    tracks.forEach(track => {\n      track.peerId = this.localPeer?.peerId;\n      this.localPeer?.auxiliaryTracks.push(track);\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_ADDED, track, this.localPeer!);\n    });\n  }\n\n  private async stopEndedScreenshare(onStop: () => void) {\n    HMSLogger.d(this.TAG, `\u2705 Screenshare ended natively`);\n    await this.stopScreenShare();\n    onStop();\n  }\n\n  async stopScreenShare() {\n    HMSLogger.d(this.TAG, `\u2705 Screenshare ended from app`);\n    const screenTracks = this.localPeer?.auxiliaryTracks.filter(t => t.source === 'screen');\n    if (screenTracks) {\n      for (const track of screenTracks) {\n        await this.removeTrack(track.trackId);\n      }\n    }\n  }\n\n  async addTrack(track: MediaStreamTrack, source: HMSTrackSource = 'regular'): Promise<void> {\n    if (!track) {\n      HMSLogger.w(this.TAG, 'Please pass a valid MediaStreamTrack');\n      return;\n    }\n    if (!this.localPeer) {\n      throw ErrorFactory.GenericErrors.NotConnected(HMSAction.VALIDATION, 'No local peer present, cannot addTrack');\n    }\n    const isTrackPresent = this.localPeer.auxiliaryTracks.find(t => t.trackId === track.id);\n    if (isTrackPresent) {\n      return;\n    }\n\n    const type = track.kind;\n    const nativeStream = new MediaStream([track]);\n    const stream = new HMSLocalStream(nativeStream);\n\n    const TrackKlass = type === 'audio' ? HMSLocalAudioTrack : HMSLocalVideoTrack;\n    const hmsTrack = new TrackKlass(stream, track, source, this.eventBus);\n    await this.applySettings(hmsTrack);\n    await this.setPlaylistSettings({\n      track,\n      hmsTrack,\n      source,\n    });\n\n    await this.transport?.publish([hmsTrack]);\n    hmsTrack.peerId = this.localPeer?.peerId;\n    this.localPeer?.auxiliaryTracks.push(hmsTrack);\n    this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_ADDED, hmsTrack, this.localPeer!);\n  }\n\n  async removeTrack(trackId: string, internal = false) {\n    if (!this.localPeer) {\n      throw ErrorFactory.GenericErrors.NotConnected(HMSAction.VALIDATION, 'No local peer present, cannot removeTrack');\n    }\n    const trackIndex = this.localPeer.auxiliaryTracks.findIndex(t => t.trackId === trackId);\n    if (trackIndex > -1) {\n      const track = this.localPeer.auxiliaryTracks[trackIndex];\n      if (track.isPublished) {\n        await this.transport!.unpublish([track]);\n      } else {\n        await track.cleanup();\n      }\n      // Stop local playback when playlist track is removed\n      if (!internal) {\n        this.stopPlaylist(track);\n      }\n      this.localPeer.auxiliaryTracks.splice(trackIndex, 1);\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_REMOVED, track, this.localPeer);\n    } else {\n      HMSLogger.w(this.TAG, `No track found for ${trackId}`);\n    }\n  }\n\n  setAnalyticsLevel(level: HMSAnalyticsLevel) {\n    this.analyticsEventsService.level = level;\n  }\n\n  setLogLevel(level: HMSLogLevel) {\n    HMSLogger.level = level;\n  }\n\n  addAudioListener(audioListener: HMSAudioListener) {\n    this.audioListener = audioListener;\n    this.notificationManager?.setAudioListener(audioListener);\n  }\n\n  addConnectionQualityListener(qualityListener: HMSConnectionQualityListener) {\n    this.notificationManager?.setConnectionQualityListener(qualityListener);\n  }\n\n  /** @internal */\n  setIsDiagnostics(isDiagnostics: boolean) {\n    this.isDiagnostics = isDiagnostics;\n  }\n\n  async changeRole(forPeerId: string, toRole: string, force = false) {\n    await this.transport?.signal.requestRoleChange({\n      requested_for: forPeerId,\n      role: toRole,\n      force,\n    });\n  }\n\n  async changeRoleOfPeer(forPeerId: string, toRole: string, force = false) {\n    await this.transport?.signal.requestRoleChange({\n      requested_for: forPeerId,\n      role: toRole,\n      force,\n    });\n  }\n\n  async changeRoleOfPeersWithRoles(roles: HMSRole[], toRole: string) {\n    if (roles.length <= 0 || !toRole) {\n      return;\n    }\n    await this.transport?.signal.requestBulkRoleChange({\n      roles: roles.map((role: HMSRole) => role.name),\n      role: toRole,\n      force: true,\n    });\n  }\n\n  async acceptChangeRole(request: HMSRoleChangeRequest) {\n    await this.transport?.signal.acceptRoleChangeRequest({\n      requested_by: request.requestedBy?.peerId,\n      role: request.role.name,\n      token: request.token,\n    });\n  }\n\n  async endRoom(lock: boolean, reason: string) {\n    if (!this.localPeer) {\n      throw ErrorFactory.GenericErrors.NotConnected(HMSAction.VALIDATION, 'No local peer present, cannot end room');\n    }\n    await this.transport?.signal.endRoom(lock, reason);\n    await this.leave();\n  }\n\n  async removePeer(peerId: string, reason: string) {\n    if (!this.localPeer) {\n      throw ErrorFactory.GenericErrors.NotConnected(HMSAction.VALIDATION, 'No local peer present, cannot remove peer');\n    }\n    await this.transport?.signal.removePeer({ requested_for: peerId, reason });\n  }\n\n  async startRTMPOrRecording(params: RTMPRecordingConfig) {\n    if (!this.localPeer) {\n      throw ErrorFactory.GenericErrors.NotConnected(\n        HMSAction.VALIDATION,\n        'No local peer present, cannot start streaming or recording',\n      );\n    }\n    const signalParams: StartRTMPOrRecordingRequestParams = {\n      meeting_url: params.meetingURL,\n      record: params.record,\n    };\n\n    if (params.rtmpURLs?.length) {\n      signalParams.rtmp_urls = params.rtmpURLs;\n    }\n\n    if (params.resolution) {\n      signalParams.resolution = params.resolution;\n    }\n\n    await this.transport?.signal.startRTMPOrRecording(signalParams);\n  }\n\n  async stopRTMPAndRecording() {\n    if (!this.localPeer) {\n      throw ErrorFactory.GenericErrors.NotConnected(\n        HMSAction.VALIDATION,\n        'No local peer present, cannot stop streaming or recording',\n      );\n    }\n\n    await this.transport?.signal.stopRTMPAndRecording();\n  }\n\n  async startHLSStreaming(params?: HLSConfig) {\n    if (!this.localPeer) {\n      throw ErrorFactory.GenericErrors.NotConnected(\n        HMSAction.VALIDATION,\n        'No local peer present, cannot start HLS streaming',\n      );\n    }\n    const hlsParams: HLSRequestParams = {};\n    if (params && params.variants && params.variants.length > 0) {\n      hlsParams.variants = params.variants.map(variant => {\n        const hlsVariant: HLSVariant = { meeting_url: variant.meetingURL };\n        if (variant.metadata) {\n          hlsVariant.metadata = variant.metadata;\n        }\n        return hlsVariant;\n      });\n    }\n    if (params?.recording) {\n      hlsParams.hls_recording = {\n        single_file_per_layer: params.recording.singleFilePerLayer,\n        hls_vod: params.recording.hlsVod,\n      };\n    }\n    await this.transport?.signal.startHLSStreaming(hlsParams);\n  }\n\n  async stopHLSStreaming(params?: HLSConfig) {\n    if (!this.localPeer) {\n      throw ErrorFactory.GenericErrors.NotConnected(\n        HMSAction.VALIDATION,\n        'No local peer present, cannot stop HLS streaming',\n      );\n    }\n    if (params) {\n      const hlsParams: HLSRequestParams = {\n        variants: params?.variants?.map(variant => {\n          const hlsVariant: HLSVariant = { meeting_url: variant.meetingURL };\n          if (variant.metadata) {\n            hlsVariant.metadata = variant.metadata;\n          }\n          return hlsVariant;\n        }),\n      };\n      await this.transport?.signal.stopHLSStreaming(hlsParams);\n    }\n    await this.transport?.signal.stopHLSStreaming();\n  }\n\n  async startTranscription(params: TranscriptionConfig) {\n    if (!this.localPeer) {\n      throw ErrorFactory.GenericErrors.NotConnected(\n        HMSAction.VALIDATION,\n        'No local peer present, cannot start transcriptions',\n      );\n    }\n    const transcriptionParams: StartTranscriptionRequestParams = {\n      mode: params.mode,\n    };\n    await this.transport?.signal.startTranscription(transcriptionParams);\n  }\n\n  async stopTranscription(params: TranscriptionConfig) {\n    if (!this.localPeer) {\n      throw ErrorFactory.GenericErrors.NotConnected(\n        HMSAction.VALIDATION,\n        'No local peer present, cannot stop transcriptions',\n      );\n    }\n    if (!params) {\n      throw ErrorFactory.GenericErrors.Signalling(HMSAction.VALIDATION, 'No mode is passed to stop the transcription');\n    }\n    const transcriptionParams: StartTranscriptionRequestParams = {\n      mode: params.mode,\n    };\n    await this.transport?.signal.stopTranscription(transcriptionParams);\n  }\n\n  async sendHLSTimedMetadata(metadataList: HLSTimedMetadata[]) {\n    this.validateJoined('sendHLSTimedMetadata');\n    if (metadataList.length > 0) {\n      const hlsMtParams: HLSTimedMetadataParams = {\n        metadata_objs: metadataList,\n      };\n      await this.transport?.signal.sendHLSTimedMetadata(hlsMtParams);\n    }\n  }\n\n  async changeName(name: string) {\n    this.validateJoined('changeName');\n    const peer = this.store.getLocalPeer();\n    if (peer && peer.name !== name) {\n      await this.transport?.signal.updatePeer({\n        name: name,\n      });\n      this.notificationManager?.updateLocalPeer({ name });\n    }\n  }\n\n  async changeMetadata(metadata: string) {\n    this.validateJoined('changeMetadata');\n    await this.transport?.signal.updatePeer({\n      data: metadata,\n    });\n    this.notificationManager?.updateLocalPeer({ metadata });\n  }\n\n  async setSessionMetadata(metadata: any) {\n    await this.transport?.signal.setSessionMetadata({ key: 'default', data: metadata });\n  }\n\n  async getSessionMetadata() {\n    const response = await this.transport?.signal.getSessionMetadata('default');\n    return response.data;\n  }\n\n  getRoles(): HMSRole[] {\n    return Object.values(this.store.getKnownRoles());\n  }\n\n  async changeTrackState(forRemoteTrack: HMSRemoteTrack, enabled: boolean) {\n    if (forRemoteTrack.type === HMSTrackType.VIDEO && forRemoteTrack.source !== 'regular') {\n      HMSLogger.w(this.TAG, `Muting non-regular video tracks is currently not supported`);\n      return;\n    }\n\n    if (forRemoteTrack.enabled === enabled) {\n      HMSLogger.w(this.TAG, `Aborting change track state, track already has enabled - ${enabled}`, forRemoteTrack);\n      return;\n    }\n\n    if (!this.store.getTrackById(forRemoteTrack.trackId)) {\n      throw ErrorFactory.GenericErrors.ValidationFailed('No track found for change track state', forRemoteTrack);\n    }\n\n    const peer = this.store.getPeerByTrackId(forRemoteTrack.trackId);\n\n    if (!peer) {\n      throw ErrorFactory.GenericErrors.ValidationFailed('No peer found for change track state', forRemoteTrack);\n    }\n\n    await this.transport?.signal.requestTrackStateChange({\n      requested_for: peer.peerId,\n      track_id: forRemoteTrack.trackId,\n      stream_id: forRemoteTrack.stream.id,\n      mute: !enabled,\n    });\n  }\n\n  async changeMultiTrackState(params: HMSChangeMultiTrackStateParams) {\n    if (typeof params.enabled !== 'boolean') {\n      throw ErrorFactory.GenericErrors.ValidationFailed('Pass a boolean for enabled');\n    }\n    const { enabled, roles, type, source } = params;\n    await this.transport?.signal.requestMultiTrackStateChange({\n      value: !enabled,\n      type,\n      source,\n      roles: roles?.map(role => role?.name),\n    });\n  }\n\n  async raiseLocalPeerHand() {\n    this.validateJoined('raiseLocalPeerHand');\n    await this.transport?.signal.joinGroup(HAND_RAISE_GROUP_NAME);\n  }\n  async lowerLocalPeerHand() {\n    this.validateJoined('lowerLocalPeerHand');\n    await this.transport?.signal.leaveGroup(HAND_RAISE_GROUP_NAME);\n  }\n  async raiseRemotePeerHand(peerId: string) {\n    await this.transport?.signal.addToGroup(peerId, HAND_RAISE_GROUP_NAME);\n  }\n  async lowerRemotePeerHand(peerId: string) {\n    await this.transport?.signal.removeFromGroup(peerId, HAND_RAISE_GROUP_NAME);\n  }\n\n  setFrameworkInfo(frameworkInfo: HMSFrameworkInfo) {\n    this.frameworkInfo = { ...this.frameworkInfo, ...frameworkInfo };\n  }\n\n  async attachVideo(track: HMSVideoTrack, videoElement: HTMLVideoElement) {\n    const config = this.store.getConfig();\n    if (config?.autoManageVideo) {\n      track.attach(videoElement);\n    } else {\n      await track.addSink(videoElement);\n    }\n  }\n\n  async detachVideo(track: HMSVideoTrack, videoElement: HTMLVideoElement) {\n    const config = this.store.getConfig();\n    if (config?.autoManageVideo) {\n      track.detach(videoElement);\n    } else {\n      await track.removeSink(videoElement);\n    }\n  }\n\n  private async publish(initialSettings?: InitialSettings, oldRole?: string) {\n    if ([this.store.getPublishParams(), !this.sdkState.published, !isNode].every(value => !!value)) {\n      // if preview asRole(oldRole) is used, use roleChangeManager to diff policy and publish, else do normal publish\n      const publishAction =\n        oldRole && oldRole !== this.localPeer?.role?.name\n          ? () =>\n              this.roleChangeManager?.diffRolesAndPublishTracks({\n                oldRole: this.store.getPolicyForRole(oldRole),\n                newRole: this.localPeer!.role!,\n              })\n          : () => this.getAndPublishTracks(initialSettings);\n\n      await publishAction?.()?.catch(error => {\n        HMSLogger.e(this.TAG, 'Error in publish', error);\n        this.listener?.onError(error);\n      });\n    }\n  }\n\n  private async getAndPublishTracks(initialSettings?: InitialSettings) {\n    const tracks = await this.localTrackManager.getTracksToPublish(initialSettings);\n    await this.setAndPublishTracks(tracks);\n    this.localPeer?.audioTrack?.initAudioLevelMonitor();\n    this.sdkState.published = true;\n  }\n\n  private handleLocalRoleUpdate = async ({ oldRole, newRole }: { oldRole: HMSRole; newRole: HMSRole }) => {\n    await this.transport.handleLocalRoleUpdate({ oldRole, newRole });\n    await this.roleChangeManager?.handleLocalPeerRoleUpdate({ oldRole, newRole });\n    await this.interactivityCenter.whiteboard.handleLocalRoleUpdate();\n  };\n\n  private async setAndPublishTracks(tracks: HMSLocalTrack[]) {\n    for (const track of tracks) {\n      await this.transport.publish([track]);\n      this.setLocalPeerTrack(track);\n      this.listener?.onTrackUpdate(HMSTrackUpdate.TRACK_ADDED, track, this.localPeer!);\n    }\n    await this.initDeviceManagers();\n  }\n\n  private setLocalPeerTrack(track: HMSLocalTrack) {\n    track.peerId = this.localPeer?.peerId;\n    switch (track.type) {\n      case HMSTrackType.AUDIO:\n        this.localPeer!.audioTrack = track as HMSLocalAudioTrack;\n        break;\n\n      case HMSTrackType.VIDEO:\n        this.localPeer!.videoTrack = track as HMSLocalVideoTrack;\n        break;\n    }\n  }\n\n  private async initDeviceManagers() {\n    // No need to initialise and add listeners if already initialised in preview\n    if (this.sdkState.deviceManagersInitialised) {\n      return;\n    }\n    this.sdkState.deviceManagersInitialised = true;\n    await this.deviceManager.init();\n    if (!(await this.deviceManager.updateOutputDevice(this.store.getConfig()?.settings?.audioOutputDeviceId))) {\n      await this.deviceManager.updateOutputDevice(DeviceStorageManager.getSelection()?.audioOutput?.deviceId);\n    }\n    this.audioSinkManager.init(this.store.getConfig()?.audioSinkElementId);\n  }\n\n  private cleanDeviceManagers() {\n    this.eventBus.deviceChange.unsubscribe(this.handleDeviceChange);\n    this.eventBus.audioPluginFailed.unsubscribe(this.handleAudioPluginError);\n    this.eventBus.autoplayError.unsubscribe(this.handleAutoplayError);\n    this.deviceManager.cleanup();\n    this.audioSinkManager.cleanup();\n  }\n\n  /** @internal */\n  initPreviewTrackAudioLevelMonitor() {\n    const localAudioTrack = this.localPeer?.audioTrack;\n    localAudioTrack?.initAudioLevelMonitor();\n    this.eventBus.trackAudioLevelUpdate.subscribe(audioLevelUpdate => {\n      const hmsSpeakers =\n        audioLevelUpdate && audioLevelUpdate.track.trackId === localAudioTrack?.trackId\n          ? [{ audioLevel: audioLevelUpdate.audioLevel, peer: this.localPeer!, track: localAudioTrack! }]\n          : [];\n      this.store.updateSpeakers(hmsSpeakers);\n      this.audioListener?.onAudioLevelUpdate(hmsSpeakers);\n    });\n    this.eventBus.localAudioSilence.subscribe(this.sendAudioPresenceFailed);\n  }\n\n  private notifyJoin() {\n    const localPeer = this.store.getLocalPeer();\n    const room = this.store.getRoom();\n    if (!room) {\n      HMSLogger.w(this.TAG, 'notify join - room not present');\n      return;\n    }\n\n    room.joinedAt = new Date();\n    if (localPeer) {\n      localPeer.joinedAt = room.joinedAt;\n    }\n\n    if (localPeer?.role) {\n      this.analyticsTimer.end(TimedEvent.JOIN);\n      this.listener?.onJoin(room);\n      return;\n    }\n\n    return new Promise<void>((resolve, reject) => {\n      this.eventBus.policyChange.subscribeOnce(() => {\n        this.analyticsTimer.end(TimedEvent.JOIN);\n        this.listener?.onJoin(room);\n        resolve();\n      });\n\n      this.eventBus.leave.subscribeOnce(ex => {\n        reject(ex);\n      });\n    });\n  }\n\n  /**\n   * Init store and other managers, setup listeners, create local peer, room\n   * @param {HMSConfig} config\n   * @param {HMSPreviewListener} listener\n   */\n  private setUpPreview(config: HMSPreviewConfig, listener: HMSPreviewListener) {\n    this.sdkState.isPreviewCalled = true;\n    this.sdkState.isPreviewInProgress = true;\n    const { roomId, userId, role } = decodeJWT(config.authToken);\n    this.commonSetup(config, roomId, listener);\n    this.store.setConfig(config);\n    /** set after config since we need config to get env for user agent */\n    this.store.createAndSetUserAgent(this.frameworkInfo);\n    this.createAndAddLocalPeerToStore(config, role, userId, config.asRole);\n  }\n\n  /**\n   * Set bitrate and dimensions for playlist track\n   */\n  private async setPlaylistSettings({\n    track,\n    hmsTrack,\n    source,\n  }: {\n    track: MediaStreamTrack;\n    hmsTrack: HMSLocalAudioTrack | HMSLocalVideoTrack;\n    source: string;\n  }) {\n    if (source === 'videoplaylist') {\n      const settings: { maxBitrate?: number; width?: number; height?: number } = {};\n      if (track.kind === 'audio') {\n        settings.maxBitrate = this.playlistSettings.audio?.bitrate || DEFAULT_PLAYLIST_AUDIO_BITRATE;\n      } else {\n        settings.maxBitrate = this.playlistSettings.video?.bitrate || DEFAULT_PLAYLIST_VIDEO_BITRATE;\n        const { width, height } = track.getSettings();\n        settings.width = width;\n        settings.height = height;\n      }\n      // TODO: rt update from policy once policy is updated\n      await hmsTrack.setSettings(settings);\n    } else if (source === 'audioplaylist') {\n      // TODO: rt update from policy once policy is updated\n      await hmsTrack.setSettings({ maxBitrate: 64 });\n    }\n  }\n\n  /**\n   * @param {HMSConfig} config\n   * @param {string} role\n   * @param {string} userId\n   */\n  private createAndAddLocalPeerToStore(config: HMSConfig, role: string, userId: string, asRole?: string) {\n    const policy = this.store.getPolicyForRole(role);\n    const asRolePolicy = asRole ? this.store.getPolicyForRole(asRole) : undefined;\n    const localPeer = new HMSLocalPeer({\n      name: config.userName || '',\n      customerUserId: userId,\n      metadata: config.metaData || '',\n      role: policy,\n      // default value is the original role if user didn't pass asRole in config\n      asRole: asRolePolicy || policy,\n      type: HMSPeerType.REGULAR,\n    });\n\n    this.store.addPeer(localPeer);\n  }\n\n  /**\n   * init managers and set listeners - common for join and preview\n   * @param {HMSConfig} config\n   * @param {string} roomId\n   * @param {HMSPreviewListener | HMSUpdateListener} listener\n   */\n  private commonSetup(config: HMSConfig, roomId: string, listener: HMSPreviewListener | HMSUpdateListener) {\n    this.stringifyMetadata(config);\n    if (!config.initEndpoint) {\n      config.initEndpoint = 'https://prod-init.100ms.live';\n    }\n\n    this.initStoreAndManagers(listener);\n    if (!this.store.getRoom()) {\n      this.store.setRoom(new HMSRoom(roomId));\n    }\n  }\n\n  /**\n   * Remove deviceId's passed in config for join if preview was already called\n   * @param {HMSConfig} config\n   */\n  private removeDevicesFromConfig(config: HMSConfig) {\n    const storedConfig = this.store.getConfig();\n    if (storedConfig && config.settings) {\n      // preview was called\n      delete config.settings.audioOutputDeviceId;\n      delete config.settings.videoDeviceId;\n      delete config.settings.audioInputDeviceId;\n    }\n  }\n\n  /**\n   * Get screenshare based on policy and audioOnly flag\n   * @param {function} onStop\n   * @param config\n   * @returns\n   */\n  private async getScreenshareTracks(onStop: () => void, config?: HMSScreenShareConfig) {\n    const isOptimizedScreenShare = this.transport.isFlagEnabled(InitFlags.FLAG_SCALE_SCREENSHARE_BASED_ON_PIXELS);\n    const [videoTrack, audioTrack] = await this.localTrackManager.getLocalScreen(config, isOptimizedScreenShare);\n\n    const handleEnded = () => {\n      this.stopEndedScreenshare(onStop);\n    };\n\n    const tracks = [];\n    if (config?.audioOnly) {\n      videoTrack.nativeTrack.stop();\n      if (!audioTrack) {\n        throw ErrorFactory.TracksErrors.NothingToReturn(\n          HMSAction.TRACK,\n          'Select share audio when sharing screen',\n          'No audio found',\n        );\n      }\n      tracks.push(audioTrack);\n      audioTrack.nativeTrack.addEventListener('ended', handleEnded);\n    } else {\n      tracks.push(videoTrack);\n      videoTrack.nativeTrack.addEventListener('ended', handleEnded);\n      // audio track is not always available\n      if (audioTrack) {\n        tracks.push(audioTrack);\n      }\n    }\n    return tracks;\n  }\n\n  private unpauseRemoteVideoTracks = () => {\n    this.store.getRemoteVideoTracks().forEach(track => track.handleTrackUnmute());\n  };\n\n  private sendAudioPresenceFailed = () => {\n    const error = ErrorFactory.TracksErrors.NoAudioDetected(HMSAction.PREVIEW);\n    HMSLogger.w(this.TAG, 'Audio Presence Failure', this.transportState, error);\n    // this.sendAnalyticsEvent(\n    //   AnalyticsEventFactory.audioDetectionFail(error, this.deviceManager.getCurrentSelection().audioInput),\n    // );\n    if (this.isDiagnostics) {\n      this.listener?.onError(error);\n    }\n  };\n\n  private sendJoinAnalyticsEvent = (is_preview_called = false, error?: HMSException) => {\n    this.eventBus.analytics.publish(\n      AnalyticsEventFactory.join({\n        error,\n        ...this.analyticsTimer.getTimes(),\n        time: this.analyticsTimer.getTimeTaken(TimedEvent.JOIN),\n        is_preview_called,\n        retries_join: this.transport.joinRetryCount,\n      }),\n    );\n  };\n\n  private sendPreviewAnalyticsEvent = (error?: HMSException) => {\n    this.eventBus.analytics.publish(\n      AnalyticsEventFactory.preview({\n        error,\n        ...this.analyticsTimer.getTimes(),\n        time: this.analyticsTimer.getTimeTaken(TimedEvent.PREVIEW),\n      }),\n    );\n  };\n\n  private sendAnalyticsEvent = (event: AnalyticsEvent) => {\n    // don't send analytics for diagnostics\n    if (this.isDiagnostics) {\n      return;\n    }\n    this.analyticsEventsService.queue(event).flush();\n  };\n\n  private stopPlaylist(track: HMSLocalTrack) {\n    if (track.source === 'audioplaylist') {\n      this.playlistManager.stop(HMSPlaylistType.audio);\n    } else if (track.source === 'videoplaylist') {\n      this.playlistManager.stop(HMSPlaylistType.video);\n    }\n  }\n\n  // eslint-disable-next-line complexity\n  private async applySettings(track: HMSLocalTrack) {\n    validatePublishParams(this.store);\n    const publishParams = this.store.getPublishParams();\n    // this is not needed but added for avoiding ? later\n    if (!publishParams) {\n      return;\n    }\n    if (track instanceof HMSLocalVideoTrack) {\n      const publishKey = track.source === 'regular' ? 'video' : track.source === 'screen' ? 'screen' : '';\n      if (!publishKey || !publishParams.allowed.includes(publishKey)) {\n        return;\n      }\n      const video = publishParams[publishKey];\n      if (!video) {\n        return;\n      }\n      const settings = new HMSVideoTrackSettingsBuilder()\n        .codec(video.codec as HMSVideoCodec)\n        .maxBitrate(video.bitRate)\n        .maxFramerate(video.frameRate)\n        .setWidth(video.width)\n        .setHeight(video.height)\n        .build();\n\n      await track.setSettings(settings);\n    } else if (track instanceof HMSLocalAudioTrack) {\n      if (!publishParams.allowed.includes('audio')) {\n        return;\n      }\n      const settings = new HMSAudioTrackSettingsBuilder()\n        .codec(publishParams.audio.codec as HMSAudioCodec)\n        .maxBitrate(publishParams.audio.bitRate)\n        .build();\n      await track.setSettings(settings);\n    }\n  }\n}\n", "import { IHMSStatsStore, IHMSStore } from '../IHMSStore';\nimport { HMSPeerStats, HMSTrackStats } from '../interfaces';\nimport { mergeLocalTrackStats, mergeNewIndividualStatsInDraft } from '../reactive-store/sdkUtils/storeMergeUtils';\nimport { HMSWebrtcStats } from '../rtc-stats';\nimport { createDefaultStatsStore, HMSPeerID, HMSRoomState, HMSTrack, HMSTrackID } from '../schema';\nimport { HMSSdk } from '../sdk';\nimport {\n  selectLocalAudioTrackID,\n  selectLocalPeerID,\n  selectLocalVideoTrackID,\n  selectRoomState,\n  selectTracksMap,\n} from '../selectors';\n\ntype Unsubscribe = (() => void) | undefined;\nexport const subscribeToSdkWebrtcStats = (sdk: HMSSdk, webrtcStore: IHMSStatsStore, store: IHMSStore) => {\n  // also used as flag to check if webrtc internals has been initialised\n  let unsubscribe: Unsubscribe;\n  /**\n   * Connected to room, webrtc internals can be initialized\n   */\n  if (store.getState(selectRoomState) === HMSRoomState.Connected) {\n    unsubscribe = initAndSubscribeWebrtcStore(sdk, webrtcStore, store);\n  }\n\n  /**\n   * Subscribe to room state for 2 purposes:\n   * - unsubscribe on leave\n   * - if internals is called before join is completed, init internals when roomState changes to connected\n   */\n  store.subscribe(roomState => {\n    if ([HMSRoomState.Connected, HMSRoomState.Reconnecting].includes(roomState)) {\n      if (!unsubscribe) {\n        unsubscribe = initAndSubscribeWebrtcStore(sdk, webrtcStore, store);\n      }\n      // room state can go to disconnecting and back to connected if leave fails, we don't want to resubscribe in that case\n    } else if ([HMSRoomState.Disconnected, HMSRoomState.Failed].includes(roomState)) {\n      if (unsubscribe) {\n        resetHMSStatsStore(webrtcStore, roomState);\n        unsubscribe();\n        // set flag to defined after unsubscribing to enable subscribing again\n        unsubscribe = undefined;\n      }\n    }\n  }, selectRoomState);\n};\n\nconst initAndSubscribeWebrtcStore = (sdk: HMSSdk, webrtcStore: IHMSStatsStore, store: IHMSStore) => {\n  const unsubLocalPeer = updateLocalPeerInWebrtcStore(store, webrtcStore);\n\n  sdk.getWebrtcInternals()?.start();\n  const unsubSdkStats = sdk\n    .getWebrtcInternals()\n    ?.onStatsChange(stats => updateWebrtcStoreStats(webrtcStore, stats, store, sdk));\n\n  return () => {\n    unsubLocalPeer();\n    unsubSdkStats && unsubSdkStats();\n  };\n};\n\nconst updateLocalPeerInWebrtcStore = (store: IHMSStore, webrtcStore: IHMSStatsStore) => {\n  let unsubID: Unsubscribe, unsubVideoTrackID: Unsubscribe, unsubAudioTrackID: Unsubscribe;\n  if (store.getState(selectLocalPeerID)) {\n    webrtcStore.namedSetState(draft => {\n      draft.localPeer.id = store.getState(selectLocalPeerID);\n    }, 'localpeer-id');\n  } else {\n    unsubID = store.subscribe(localPeerID => {\n      localPeerID &&\n        webrtcStore.namedSetState(draft => {\n          draft.localPeer.id = localPeerID;\n        }, 'localpeer-id');\n    }, selectLocalPeerID);\n  }\n\n  if (store.getState(selectLocalVideoTrackID)) {\n    webrtcStore.namedSetState(draft => {\n      draft.localPeer.videoTrack = store.getState(selectLocalVideoTrackID);\n    }, 'localpeer-videotrack-id');\n  } else {\n    unsubVideoTrackID = store.subscribe(videoTrackID => {\n      videoTrackID &&\n        webrtcStore.namedSetState(draft => {\n          draft.localPeer.videoTrack = videoTrackID;\n        }, 'localpeer-videotrack-id');\n    }, selectLocalVideoTrackID);\n  }\n\n  if (store.getState(selectLocalAudioTrackID)) {\n    webrtcStore.namedSetState(draft => {\n      draft.localPeer.audioTrack = store.getState(selectLocalAudioTrackID);\n    }, 'localpeer-audiotrack-id');\n  } else {\n    unsubAudioTrackID = store.subscribe(audioTrackID => {\n      audioTrackID &&\n        webrtcStore.namedSetState(draft => {\n          draft.localPeer.audioTrack = audioTrackID;\n        }, 'localpeer-audiotrack-id');\n    }, selectLocalAudioTrackID);\n  }\n\n  return () => {\n    unsubID?.();\n    unsubVideoTrackID?.();\n    unsubAudioTrackID?.();\n  };\n};\n\nconst updateWebrtcStoreStats = (\n  webrtcStore: IHMSStatsStore,\n  stats: HMSWebrtcStats,\n  hmsStore: IHMSStore,\n  sdk: HMSSdk,\n) => {\n  const tracks: Record<HMSTrackID, HMSTrack> = hmsStore.getState(selectTracksMap);\n  webrtcStore.namedSetState(store => {\n    const localPeerID = hmsStore.getState(selectLocalPeerID);\n    const newTrackStats: Record<HMSTrackID, HMSTrackStats> = {};\n    const trackIDs = Object.keys(tracks).filter(trackID => tracks[trackID].peerId !== localPeerID);\n\n    for (const trackID of trackIDs) {\n      const sdkTrackStats = stats.getRemoteTrackStats(trackID);\n      if (sdkTrackStats) {\n        newTrackStats[trackID] = sdkTrackStats;\n      }\n    }\n\n    mergeNewIndividualStatsInDraft<HMSTrackID, HMSTrackStats>(store.remoteTrackStats, newTrackStats);\n\n    // @TODO: Include all peer stats, own ticket, transmit local peer stats to other peer's using biz\n    const newPeerStats = { [localPeerID]: stats.getLocalPeerStats() };\n    mergeNewIndividualStatsInDraft<HMSPeerID, HMSPeerStats>(store.peerStats, newPeerStats);\n    // @ts-ignore\n    mergeLocalTrackStats(store.localTrackStats, stats.getLocalTrackStats(), sdk.store.getLocalPeerTracks());\n  }, 'webrtc-stats');\n};\n\nconst resetHMSStatsStore = (store: IHMSStatsStore, reason = 'resetState') => {\n  store.namedSetState(draft => {\n    Object.assign(draft, createDefaultStatsStore());\n  }, reason);\n};\n", "import { Subscribe } from 'zustand/vanilla';\nimport { HMSReactiveStore } from './internal';\nimport { subscribeToSdkWebrtcStats } from './webrtc-stats-store';\nimport { storeNameWithTabTitle } from '../common/storeName';\nimport { GetState, IHMSStatsStore, IHMSStatsStoreReadOnly, IHMSStore } from '../IHMSStore';\nimport { createDefaultStatsStore, HMSStatsStore } from '../schema';\nimport { HMSSdk } from '../sdk';\nimport { selectRoomState } from '../selectors';\n\n/**\n * @internal\n */\nexport class HMSStats implements IHMSStatsStoreReadOnly {\n  readonly getState: GetState<HMSStatsStore>;\n  readonly subscribe: Subscribe<HMSStatsStore>;\n  readonly getPublishPeerConnection: () => Promise<RTCPeerConnection | undefined>;\n  readonly getSubscribePeerConnection: () => Promise<RTCPeerConnection | undefined>;\n  private readonly store: IHMSStatsStore;\n\n  constructor(private hmsStore: IHMSStore, private sdk?: HMSSdk) {\n    this.store = HMSReactiveStore.createNewHMSStore<HMSStatsStore>(\n      storeNameWithTabTitle('HMSStatsStore'),\n      createDefaultStatsStore,\n    );\n\n    this.getState = this.store.getState;\n    this.subscribe = this.store.subscribe;\n\n    this.getPublishPeerConnection = () =>\n      new Promise<RTCPeerConnection | undefined>(resolve => {\n        if (this.hmsStore.getState(selectRoomState) === 'Connected') {\n          resolve(this.sdk?.getWebrtcInternals()?.getPublishPeerConnection());\n        } else {\n          this.hmsStore.subscribe(roomState => {\n            if (roomState === 'Connected') {\n              resolve(this.sdk?.getWebrtcInternals()?.getPublishPeerConnection());\n            }\n          }, selectRoomState);\n        }\n      });\n\n    this.getSubscribePeerConnection = () =>\n      new Promise<RTCPeerConnection | undefined>(resolve => {\n        if (this.hmsStore.getState(selectRoomState) === 'Connected') {\n          resolve(this.sdk?.getWebrtcInternals()?.getSubscribePeerConnection());\n        } else {\n          this.hmsStore.subscribe(roomState => {\n            if (roomState === 'Connected') {\n              resolve(this.sdk?.getWebrtcInternals()?.getSubscribePeerConnection());\n            }\n          }, selectRoomState);\n        }\n      });\n\n    if (!this.sdk) {\n      return;\n    }\n\n    subscribeToSdkWebrtcStats(this.sdk, this.store, this.hmsStore);\n  }\n}\n", "import { createSelector } from 'reselect';\nimport { HMSPreferredSimulcastLayer, RID, simulcastMapping } from '../internal';\nimport { HMSPeerID, HMSStatsStore, HMSTrackID } from '../schema';\nimport { byIDCurry } from '../selectors/common';\n\nconst selectLocalPeerID = (store: HMSStatsStore) => store.localPeer.id;\nconst selectLocalAudioTrackID = (store: HMSStatsStore) => store.localPeer.audioTrack;\nconst selectLocalVideoTrackID = (store: HMSStatsStore) => store.localPeer.videoTrack;\nconst selectPeerID = (_store: HMSStatsStore, peerID: HMSPeerID | undefined) => peerID;\nconst selectTrackID = (_store: HMSStatsStore, trackID: HMSTrackID | undefined) => trackID;\nconst selectRemoteTrackStatsMap = (store: HMSStatsStore) => store.remoteTrackStats;\nconst selectPeerStatsMap = (store: HMSStatsStore) => store.peerStats;\nconst selectLocalTrackStatsMap = (store: HMSStatsStore) => store.localTrackStats;\n\n/**\n * Local peer stats selectors\n */\nconst localPeerStats = createSelector(\n  [selectPeerStatsMap, selectLocalPeerID],\n  (storePeerStats, localPeerID) => storePeerStats[localPeerID],\n);\n\n/**\n *  The total number of packets lost during the call\n */\nconst packetsLost = createSelector(localPeerStats, localPeerStats => localPeerStats?.subscribe?.packetsLost);\n\nconst jitter = createSelector(localPeerStats, localPeerStats => localPeerStats?.subscribe?.jitter);\n\n/**\n * The bitrate at which all the local tracks are being published at\n */\nconst publishBitrate = createSelector(localPeerStats, localPeerStats => localPeerStats?.publish?.bitrate);\n\n/**\n * The bitrate at which all the remote tracks are being received at\n */\nconst subscribeBitrate = createSelector(localPeerStats, localPeerStats => localPeerStats?.subscribe?.bitrate);\n\n/**\n * The total bitrate available for publishing\n */\nconst availablePublishBitrate = createSelector(\n  localPeerStats,\n  localPeerStats => localPeerStats?.publish?.availableOutgoingBitrate,\n);\n\n/**\n * The total bitrate available for subscribing to remote peers\n */\nconst availableSubscribeBitrate = createSelector(\n  localPeerStats,\n  localPeerStats => localPeerStats?.subscribe?.availableIncomingBitrate,\n);\n\n/**\n * The total bytes sent by the local peer\n */\nconst totalBytesSent = createSelector(localPeerStats, localPeerStats => localPeerStats?.publish?.bytesSent);\n\n/**\n * The total bytes received by the local peer\n */\nconst totalBytesReceived = createSelector(localPeerStats, localPeerStats => localPeerStats?.subscribe?.bytesReceived);\n\n/**\n * By ID Selectors\n * To be used for remote tracks\n */\n\nconst selectPeerStatsByIDBare = createSelector([selectPeerStatsMap, selectPeerID], (storePeerStats, peerID) =>\n  peerID ? storePeerStats[peerID] : undefined,\n);\n\nconst selectTrackStatsByIDBare = createSelector(\n  [selectRemoteTrackStatsMap, selectTrackID],\n  (storeTrackStats, trackID) => (trackID ? storeTrackStats[trackID] : undefined),\n);\n\nconst selectLocalTrackStatsByIDBare = createSelector(\n  [selectLocalTrackStatsMap, selectTrackID],\n  (storeLocalTrackStats, trackID) => (trackID ? storeLocalTrackStats[trackID] : undefined),\n);\n\n/**\n * Stats(bitrate, bytes sent/received, etc...) for a single peer given the peer ID\n */\nconst peerStatsByID = byIDCurry(selectPeerStatsByIDBare);\n\n/**\n * Stats(bitrate, bytes sent/received, framerate, FPS, etc...) for a remote track\n */\nconst trackStatsByID = byIDCurry(selectTrackStatsByIDBare);\n\n/**\n * Local track stats selectors\n */\n\nconst localAudioTrackStats = createSelector(\n  [selectLocalTrackStatsMap, selectLocalAudioTrackID],\n  (trackStats, trackID) => (trackID ? trackStats[trackID]?.[0] : undefined),\n);\n\nconst localAudioTrackStatsByID = byIDCurry(\n  createSelector(selectLocalTrackStatsByIDBare, trackStats => trackStats?.[0]),\n);\n\nconst localVideoTrackStats = createSelector(\n  [selectLocalTrackStatsMap, selectLocalVideoTrackID],\n  (trackStats, trackID) => (trackID ? trackStats[trackID]?.[0] : undefined),\n);\n\nconst localVideoTrackStatsByID = byIDCurry(createSelector(selectLocalTrackStatsByIDBare, trackStats => trackStats));\n\nconst localVideoTrackStatsByLayer = (layer?: HMSPreferredSimulcastLayer) =>\n  byIDCurry(\n    createSelector(selectLocalTrackStatsByIDBare, stats => {\n      const rid = (Object.keys(simulcastMapping) as RID[]).find(key => simulcastMapping[key] === layer);\n      return layer ? stats?.find(stat => stat.rid === rid) || stats?.[0] : stats?.[0];\n    }),\n  );\n\nexport const selectHMSStats = {\n  localPeerStats,\n  packetsLost,\n  jitter,\n  publishBitrate,\n  subscribeBitrate,\n  availablePublishBitrate,\n  availableSubscribeBitrate,\n  totalBytesSent,\n  totalBytesReceived,\n  peerStatsByID,\n  trackStatsByID,\n  localAudioTrackStatsByID,\n  localVideoTrackStatsByID,\n  localVideoTrackStatsByLayer,\n  localAudioTrackStats,\n  localVideoTrackStats,\n};\n", "/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nimport {adapterFactory} from './adapter_factory.js';\n\nconst adapter =\n  adapterFactory({window: typeof window === 'undefined' ? undefined : window});\nexport default adapter;\n", "/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nimport * as utils from './utils';\n\n// Browser shims.\nimport * as chromeShim from './chrome/chrome_shim';\nimport * as firefoxShim from './firefox/firefox_shim';\nimport * as safariShim from './safari/safari_shim';\nimport * as commonShim from './common_shim';\nimport * as sdp from 'sdp';\n\n// Shimming starts here.\nexport function adapterFactory({window} = {}, options = {\n  shimChrome: true,\n  shimFirefox: true,\n  shimSafari: true,\n}) {\n  // Utils.\n  const logging = utils.log;\n  const browserDetails = utils.detectBrowser(window);\n\n  const adapter = {\n    browserDetails,\n    commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings,\n    // Expose sdp as a convenience. For production apps include directly.\n    sdp,\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      chromeShim.shimGetUserMedia(window, browserDetails);\n      chromeShim.shimMediaStream(window, browserDetails);\n      chromeShim.shimPeerConnection(window, browserDetails);\n      chromeShim.shimOnTrack(window, browserDetails);\n      chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n      chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n      chromeShim.shimGetStats(window, browserDetails);\n      chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n      chromeShim.fixNegotiationNeeded(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      firefoxShim.shimGetUserMedia(window, browserDetails);\n      firefoxShim.shimPeerConnection(window, browserDetails);\n      firefoxShim.shimOnTrack(window, browserDetails);\n      firefoxShim.shimRemoveStream(window, browserDetails);\n      firefoxShim.shimSenderGetStats(window, browserDetails);\n      firefoxShim.shimReceiverGetStats(window, browserDetails);\n      firefoxShim.shimRTCDataChannel(window, browserDetails);\n      firefoxShim.shimAddTransceiver(window, browserDetails);\n      firefoxShim.shimGetParameters(window, browserDetails);\n      firefoxShim.shimCreateOffer(window, browserDetails);\n      firefoxShim.shimCreateAnswer(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      // Must be called before shimCallbackAPI.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      safariShim.shimRTCIceServerUrls(window, browserDetails);\n      safariShim.shimCreateOfferLegacy(window, browserDetails);\n      safariShim.shimCallbacksAPI(window, browserDetails);\n      safariShim.shimLocalStreamsAPI(window, browserDetails);\n      safariShim.shimRemoteStreamsAPI(window, browserDetails);\n      safariShim.shimTrackEventTransceiver(window, browserDetails);\n      safariShim.shimGetUserMedia(window, browserDetails);\n      safariShim.shimAudioContext(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n", "/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nlet logDisabled_ = true;\nlet deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nexport function extractVersion(uastring, expr, pos) {\n  const match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nexport function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  const nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    const wrappedCallback = (e) => {\n      const modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        if (cb.handleEvent) {\n          cb.handleEvent(modifiedEvent);\n        } else {\n          cb(modifiedEvent);\n        }\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    if (!this._eventMap[eventNameToWrap]) {\n      this._eventMap[eventNameToWrap] = new Map();\n    }\n    this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  const nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[eventNameToWrap]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    if (!this._eventMap[eventNameToWrap].has(cb)) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    const unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n    this._eventMap[eventNameToWrap].delete(cb);\n    if (this._eventMap[eventNameToWrap].size === 0) {\n      delete this._eventMap[eventNameToWrap];\n    }\n    if (Object.keys(this._eventMap).length === 0) {\n      delete this._eventMap;\n    }\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\nexport function disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return (bool) ? 'adapter.js logging disabled' :\n    'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nexport function disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nexport function log() {\n  if (typeof window === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nexport function deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n      ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nexport function detectBrowser(window) {\n  // Returned result object.\n  const result = {browser: null, version: null};\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator ||\n      !window.navigator.userAgent) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  const {navigator} = window;\n\n  if (navigator.mozGetUserMedia) { // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent,\n      /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia ||\n      (window.isSecureContext === false && window.webkitRTCPeerConnection)) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent,\n      /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (window.RTCPeerConnection &&\n      navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent,\n      /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver &&\n        'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else { // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nexport function compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function(accumulator, key) {\n    const isObj = isObject(data[key]);\n    const value = isObj ? compactObject(data[key]) : data[key];\n    const isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, {[key]: value});\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nexport function walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(name => {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(id => {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nexport function filterStats(result, track, outbound) {\n  const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  const filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  const trackStats = [];\n  result.forEach(value => {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(trackStat => {\n    result.forEach(stats => {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n", "/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n      window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get() {\n        return this._ontrack;\n      },\n      set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    const origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = (e) => {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', te => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === te.track.id);\n              } else {\n                receiver = {track: te.track};\n              }\n\n              const event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(track => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === track.id);\n              } else {\n                receiver = {track};\n              }\n              const event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver',\n          {value: {receiver: e.receiver}});\n      }\n      return e;\n    });\n  }\n}\n\nexport function shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (typeof window === 'object' && window.RTCPeerConnection &&\n      !('getSenders' in window.RTCPeerConnection.prototype) &&\n      'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    const shimSenderWithDtmf = function(pc, track) {\n      return {\n        track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack =\n        function addTrack(track, stream) {\n          let sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack =\n        function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          const idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n    }\n    const origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(track => {\n        this._senders.push(shimSenderWithDtmf(this, track));\n      });\n    };\n\n    const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(track => {\n          const sender = this._senders.find(s => s.track === track);\n          if (sender) { // remove sender\n            this._senders.splice(this._senders.indexOf(sender), 1);\n          }\n        });\n      };\n  } else if (typeof window === 'object' && window.RTCPeerConnection &&\n             'getSenders' in window.RTCPeerConnection.prototype &&\n             'createDTMFSender' in window.RTCPeerConnection.prototype &&\n             window.RTCRtpSender &&\n             !('dtmf' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nexport function shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 ||\n        typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    const fixChromeStats_ = function(response) {\n      const standardReport = {};\n      const reports = response.result();\n      reports.forEach(report => {\n        const standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(name => {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    const makeMapStats = function(stats) {\n      return new Map(Object.keys(stats).map(key => [key, stats[key]]));\n    };\n\n    if (arguments.length >= 2) {\n      const successCallbackWrapper_ = function(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_,\n        selector]);\n    }\n\n    // promise-support\n    return new Promise((resolve, reject) => {\n      origGetStats.apply(this, [\n        function(response) {\n          resolve(makeMapStats(fixChromeStats_(response)));\n        }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        const senders = origGetSenders.apply(this, []);\n        senders.forEach(sender => sender._pc = this);\n        return senders;\n      };\n    }\n\n    const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        const sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      const sender = this;\n      return this._pc.getStats().then(result =>\n        /* Note: this will include stats of all senders that\n         *   send a track with the same id as sender.track as\n         *   it is not possible to identify the RTCRtpSender.\n         */\n        utils.filterStats(result, sender.track, true));\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers =\n        function getReceivers() {\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(receiver => receiver._pc = this);\n          return receivers;\n        };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      const receiver = this;\n      return this._pc.getStats().then(result =>\n        utils.filterStats(result, receiver.track, false));\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype &&\n      'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 &&\n        arguments[0] instanceof window.MediaStreamTrack) {\n      const track = arguments[0];\n      let sender;\n      let receiver;\n      let err;\n      this.getSenders().forEach(s => {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(r => {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || (sender && receiver)) {\n        return Promise.reject(new DOMException(\n          'There are more than one sender or receiver for the track.',\n          'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException(\n        'There is no sender or receiver for the track.',\n        'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nexport function shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams)\n        .map(streamId => this._shimmedLocalStreams[streamId][0]);\n    };\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      const sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    const existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    const newSenders = this.getSenders()\n      .filter(newSender => existingSenders.indexOf(newSender) === -1);\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n  const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(streamId => {\n          const idx = this._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            this._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (this._shimmedLocalStreams[streamId].length === 1) {\n            delete this._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n}\n\nexport function shimAddTrackRemoveTrack(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack &&\n      browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  const origGetLocalStreams = window.RTCPeerConnection.prototype\n    .getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      const nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(stream => this._reverseStreams[stream.id]);\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      const newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [(this._streams[stream.id] || stream)]);\n      delete this._reverseStreams[(this._streams[stream.id] ?\n        this._streams[stream.id].id : stream.id)];\n      delete this._streams[stream.id];\n    };\n\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      const streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(t => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      const oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(() => {\n          this.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        const newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(s => s.track === track);\n    };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n        externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n        internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function(method) {\n    const nativeMethod = window.RTCPeerConnection.prototype[method];\n    const methodObj = {[method]() {\n      const args = arguments;\n      const isLegacyCall = arguments.length &&\n          typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [\n          (description) => {\n            const desc = replaceInternalStreamId(this, description);\n            args[0].apply(null, [desc]);\n          },\n          (err) => {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]\n        ]);\n      }\n      return nativeMethod.apply(this, arguments)\n        .then(description => replaceInternalStreamId(this, description));\n    }};\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  const origSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  const origLocalDescription = Object.getOwnPropertyDescriptor(\n    window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype,\n    'localDescription', {\n      get() {\n        const description = origLocalDescription.get.apply(this);\n        if (description.type === '') {\n          return description;\n        }\n        return replaceInternalStreamId(this, description);\n      }\n    });\n\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      const isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n          'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      let stream;\n      Object.keys(this._streams).forEach(streamid => {\n        const hasTrack = this._streams[streamid].getTracks()\n          .find(track => sender.track === track);\n        if (hasTrack) {\n          stream = this._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n}\n\n// Attempt to fix ONN in plan-b mode.\nexport function fixNegotiationNeeded(window, browserDetails) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', e => {\n    const pc = e.target;\n    if (browserDetails.version < 72 || (pc.getConfiguration &&\n        pc.getConfiguration().sdpSemantics === 'plan-b')) {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n", "/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\nconst logging = utils.log;\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  const constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    const cc = {};\n    Object.keys(c).forEach(key => {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      const r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      const oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        let oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(mix => {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  const shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      const remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      let face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      const getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        let matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n            .then(devices => {\n              devices = devices.filter(d => d.kind === 'videoinput');\n              let dev = devices.find(d => matches.some(match =>\n                d.label.toLowerCase().includes(match)));\n              if (!dev && devices.length && matches.includes('back')) {\n                dev = devices[devices.length - 1]; // more likely the back cam\n              }\n              if (dev) {\n                constraints.video.deviceId = face.exact\n                  ? {exact: dev.deviceId}\n                  : {ideal: dev.deviceId};\n              }\n              constraints.video = constraintsToChrome_(constraints.video);\n              logging('chrome: ' + JSON.stringify(constraints));\n              return func(constraints);\n            });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  const shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  const getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, c => {\n      navigator.webkitGetUserMedia(c, onSuccess, e => {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, c => origGetUserMedia(c).then(stream => {\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(track => {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, e => Promise.reject(shimError_(e))));\n    };\n  }\n}\n", "/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nexport function shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n        'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      return getSourceId(constraints)\n        .then(sourceId => {\n          const widthSpecified = constraints.video && constraints.video.width;\n          const heightSpecified = constraints.video &&\n            constraints.video.height;\n          const frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n}\n", "/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      ('receiver' in window.RTCTrackEvent.prototype) &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (typeof window !== 'object' ||\n      !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n\n  const modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n    return nativeGetStats.apply(this, [selector || null])\n      .then(stats => {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(stat => {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach((stat, i) => {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      })\n      .then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n  }\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      const sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) :\n      Promise.resolve(new Map());\n  };\n}\n\nexport function shimReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      const receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(receiver => receiver._pc = this);\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', e => {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nexport function shimRemoveStream(window) {\n  if (!window.RTCPeerConnection ||\n      'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(sender => {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          this.removeTrack(sender);\n        }\n      });\n    };\n}\n\nexport function shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nexport function shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver =\n      function addTransceiver() {\n        this.setParametersPromises = [];\n        // WebIDL input coercion and validation\n        let sendEncodings = arguments[1] && arguments[1].sendEncodings;\n        if (sendEncodings === undefined) {\n          sendEncodings = [];\n        }\n        sendEncodings = [...sendEncodings];\n        const shouldPerformCheck = sendEncodings.length > 0;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          sendEncodings.forEach((encodingParam) => {\n            if ('rid' in encodingParam) {\n              const ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        const transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          const {sender} = transceiver;\n          const params = sender.getParameters();\n          if (!('encodings' in params) ||\n              // Avoid being fooled by patched getParameters() below.\n              (params.encodings.length === 1 &&\n               Object.keys(params.encodings[0]).length === 0)) {\n            params.encodings = sendEncodings;\n            sender.sendEncodings = sendEncodings;\n            this.setParametersPromises.push(sender.setParameters(params)\n              .then(() => {\n                delete sender.sendEncodings;\n              }).catch(() => {\n                delete sender.sendEncodings;\n              })\n            );\n          }\n        }\n        return transceiver;\n      };\n  }\n}\n\nexport function shimGetParameters(window) {\n  if (!(typeof window === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  const origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters =\n      function getParameters() {\n        const params = origGetParameters.apply(this, arguments);\n        if (!('encodings' in params)) {\n          params.encodings = [].concat(this.sendEncodings || [{}]);\n        }\n        return params;\n      };\n  }\n}\n\nexport function shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateOffer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nexport function shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateAnswer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n", "/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n  const MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n      'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    const remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        const obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      const nativeApplyConstraints =\n        MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n", "/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        const err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n}\n", "/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nimport * as utils from '../utils';\n\nexport function shimLocalStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams =\n      function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n      stream.getVideoTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n    };\n\n    window.RTCPeerConnection.prototype.addTrack =\n      function addTrack(track, ...streams) {\n        if (streams) {\n          streams.forEach((stream) => {\n            if (!this._localStreams) {\n              this._localStreams = [stream];\n            } else if (!this._localStreams.includes(stream)) {\n              this._localStreams.push(stream);\n            }\n          });\n        }\n        return _addTrack.apply(this, arguments);\n      };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        const index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        const tracks = stream.getTracks();\n        this.getSenders().forEach(sender => {\n          if (tracks.includes(sender.track)) {\n            this.removeTrack(sender);\n          }\n        });\n      };\n  }\n}\n\nexport function shimRemoteStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams =\n      function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get() {\n        return this._onaddstream;\n      },\n      set(f) {\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = (e) => {\n          e.streams.forEach(stream => {\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.includes(stream)) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            const event = new Event('addstream');\n            event.stream = stream;\n            this.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        const pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(stream => {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n  }\n}\n\nexport function shimCallbacksAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  const prototype = window.RTCPeerConnection.prototype;\n  const origCreateOffer = prototype.createOffer;\n  const origCreateAnswer = prototype.createAnswer;\n  const setLocalDescription = prototype.setLocalDescription;\n  const setRemoteDescription = prototype.setRemoteDescription;\n  const addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer =\n    function createOffer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  prototype.createAnswer =\n    function createAnswer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  let withCallback = function(description, successCallback, failureCallback) {\n    const promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function(description, successCallback, failureCallback) {\n    const promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function(candidate, successCallback, failureCallback) {\n    const promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    const mediaDevices = navigator.mediaDevices;\n    const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = (constraints) => {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices &&\n    navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints)\n        .then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nexport function shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({},\n      constraints,\n      {video: utils.compactObject(constraints.video)}\n    );\n  }\n\n  return constraints;\n}\n\nexport function shimRTCIceServerUrls(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  const OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection =\n    function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        const newIceServers = [];\n        for (let i = 0; i < pcConfig.iceServers.length; i++) {\n          let server = pcConfig.iceServers[i];\n          if (server.urls === undefined && server.url) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in OrigPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nexport function shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      'receiver' in window.RTCTrackEvent.prototype &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimCreateOfferLegacy(window) {\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer =\n    function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio =\n            !!offerOptions.offerToReceiveAudio;\n        }\n        const audioTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'audio');\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          this.addTransceiver('audio', {direction: 'recvonly'});\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo =\n            !!offerOptions.offerToReceiveVideo;\n        }\n        const videoTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'video');\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          this.addTransceiver('video', {direction: 'recvonly'});\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n}\n\nexport function shimAudioContext(window) {\n  if (typeof window !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n\n", "/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport SDPUtils from 'sdp';\nimport * as utils from './utils';\n\nexport function shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  const NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (typeof args === 'object' && args.candidate &&\n        args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substring(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      const nativeCandidate = new NativeRTCIceCandidate(args);\n      const parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      for (const key in parsedCandidate) {\n        if (!(key in nativeCandidate)) {\n          Object.defineProperty(nativeCandidate, key,\n            {value: parsedCandidate[key]});\n        }\n      }\n\n      // Override serializer to not serialize the extra attributes.\n      nativeCandidate.toJSON = function toJSON() {\n        return {\n          candidate: nativeCandidate.candidate,\n          sdpMid: nativeCandidate.sdpMid,\n          sdpMLineIndex: nativeCandidate.sdpMLineIndex,\n          usernameFragment: nativeCandidate.usernameFragment,\n        };\n      };\n      return nativeCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nexport function shimRTCIceCandidateRelayProtocol(window) {\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'relayProtocol' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      const parsedCandidate = SDPUtils.parseCandidate(e.candidate.candidate);\n      if (parsedCandidate.type === 'relay') {\n        // This is a libwebrtc-specific mapping of local type preference\n        // to relayProtocol.\n        e.candidate.relayProtocol = {\n          0: 'tls',\n          1: 'tcp',\n          2: 'udp',\n        }[parsedCandidate.priority >> 24];\n      }\n    }\n    return e;\n  });\n}\n\nexport function shimMaxMessageSize(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  const sctpInDescription = function(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    const sections = SDPUtils.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(mediaSection => {\n      const mLine = SDPUtils.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application'\n          && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  const getRemoteFirefoxVersion = function(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    const version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  const getCanSendMaxMessageSize = function(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    let canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize =\n          browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  const getMaxMessageSize = function(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    let maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox'\n         && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    const match = SDPUtils.matchPrefix(description.sdp,\n      'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substring(19), 10);\n    } else if (browserDetails.browser === 'firefox' &&\n                remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n    function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        const {sdpSemantics} = this.getConfiguration();\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n            enumerable: true,\n            configurable: true,\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        let maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        const sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n}\n\nexport function shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection &&\n      'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    const origDataChannelSend = dc.send;\n    dc.send = function send() {\n      const data = arguments[0];\n      const length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' &&\n          pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' +\n          pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  const origCreateDataChannel =\n    window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel =\n    function createDataChannel() {\n      const dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', e => {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nexport function shimConnectionState(window) {\n  if (!window.RTCPeerConnection ||\n      'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get() {\n      return this._onconnectionstatechange || null;\n    },\n    set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange',\n          this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange',\n          this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n    const origMethod = proto[method];\n    proto[method] = function() {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = e => {\n          const pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            const newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange',\n          this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nexport function removeExtmapAllowMixed(window, browserDetails) {\n  /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n    return;\n  }\n  const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n  function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      const sdp = desc.sdp.split('\\n').filter((line) => {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n      // Safari enforces read-only-ness of RTCSessionDescription fields.\n      if (window.RTCSessionDescription &&\n          desc instanceof window.RTCSessionDescription) {\n        arguments[0] = new window.RTCSessionDescription({\n          type: desc.type,\n          sdp,\n        });\n      } else {\n        desc.sdp = sdp;\n      }\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\nexport function shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n  // Support for addIceCandidate(null or undefined)\n  // as well as addIceCandidate({candidate: \"\", ...})\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n  // Note: must be called before other polyfills which change the signature.\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeAddIceCandidate =\n      window.RTCPeerConnection.prototype.addIceCandidate;\n  if (!nativeAddIceCandidate || nativeAddIceCandidate.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      // Native support for ignoring exists for Chrome M77+.\n      // Safari ignores as well, exact version unknown but works in the same\n      // version that also ignores addIceCandidate(null).\n      if (((browserDetails.browser === 'chrome' && browserDetails.version < 78)\n           || (browserDetails.browser === 'firefox'\n               && browserDetails.version < 68)\n           || (browserDetails.browser === 'safari'))\n          && arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n}\n\n// Note: Make sure to call this ahead of APIs that modify\n// setLocalDescription.length\nexport function shimParameterlessSetLocalDescription(window, browserDetails) {\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  if (!nativeSetLocalDescription || nativeSetLocalDescription.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      let desc = arguments[0] || {};\n      if (typeof desc !== 'object' || (desc.type && desc.sdp)) {\n        return nativeSetLocalDescription.apply(this, arguments);\n      }\n      // The remaining steps should technically happen when SLD comes off the\n      // RTCPeerConnection's operations chain (not ahead of going on it), but\n      // this is too difficult to shim. Instead, this shim only covers the\n      // common case where the operations chain is empty. This is imperfect, but\n      // should cover many cases. Rationale: Even if we can't reduce the glare\n      // window to zero on imperfect implementations, there's value in tapping\n      // into the perfect negotiation pattern that several browsers support.\n      desc = {type: desc.type, sdp: desc.sdp};\n      if (!desc.type) {\n        switch (this.signalingState) {\n          case 'stable':\n          case 'have-local-offer':\n          case 'have-remote-pranswer':\n            desc.type = 'offer';\n            break;\n          default:\n            desc.type = 'answer';\n            break;\n        }\n      }\n      if (desc.sdp || (desc.type !== 'offer' && desc.type !== 'answer')) {\n        return nativeSetLocalDescription.apply(this, [desc]);\n      }\n      const func = desc.type === 'offer' ? this.createOffer : this.createAnswer;\n      return func.apply(this)\n        .then(d => nativeSetLocalDescription.apply(this, [d]));\n    };\n}\n", "import React, { useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { selectLocalPeerName, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { config as cssConfig, Dialog } from '../../..';\nimport { Sheet } from '../../../Sheet';\n// @ts-ignore: No implicit Any\nimport { ToastManager } from '../Toast/ToastManager';\n// @ts-ignore: No implicit Any\nimport { ChangeNameContent } from './ChangeNameContent';\n// @ts-ignore: No implicit Any\nimport { UserPreferencesKeys, useUserPreferences } from '../hooks/useUserPreferences';\n\nexport const ChangeNameModal = ({\n  onOpenChange,\n  openParentSheet = undefined,\n}: {\n  onOpenChange: (value: boolean) => void;\n  openParentSheet?: () => void;\n}) => {\n  const [previewPreference, setPreviewPreference] = useUserPreferences(UserPreferencesKeys.PREVIEW);\n  const hmsActions = useHMSActions();\n  const localPeerName = useHMSStore(selectLocalPeerName);\n  const [currentName, setCurrentName] = useState(localPeerName);\n  const isMobile = useMedia(cssConfig.media.md);\n\n  const changeName = async () => {\n    const name = currentName?.trim() || '';\n    if (!name || name === localPeerName) {\n      return;\n    }\n    try {\n      await hmsActions.changeName(name);\n      setPreviewPreference({\n        ...(previewPreference || {}),\n        name,\n      });\n    } catch (error) {\n      console.error('failed to update name', error);\n      ToastManager.addToast({ title: (error as Error).message });\n    } finally {\n      onOpenChange(false);\n    }\n  };\n\n  const props = {\n    changeName,\n    setCurrentName,\n    currentName,\n    localPeerName,\n    isMobile,\n    onExit: () => onOpenChange(false),\n    onBackClick: () => {\n      onOpenChange(false);\n      openParentSheet?.();\n    },\n  };\n\n  if (isMobile) {\n    return (\n      <Sheet.Root defaultOpen onOpenChange={onOpenChange}>\n        <Sheet.Content css={{ bg: '$surface_dim', p: '$8 0' }}>\n          <ChangeNameContent {...props} />\n        </Sheet.Content>\n      </Sheet.Root>\n    );\n  }\n\n  return (\n    <Dialog.Root defaultOpen onOpenChange={onOpenChange}>\n      <Dialog.Portal>\n        <Dialog.Overlay />\n        <Dialog.Content css={{ bg: '$surface_dim', width: 'min(400px,80%)', p: '$10' }}>\n          <ChangeNameContent {...props} />\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n};\n", "import React from 'react';\nimport { ChevronLeftIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Button } from '../../../Button';\nimport { Input } from '../../../Input';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\n\nexport const ChangeNameContent = ({\n  changeName,\n  setCurrentName,\n  currentName,\n  localPeerName,\n  isMobile,\n  onExit,\n  onBackClick,\n}: {\n  changeName: () => Promise<void>;\n  setCurrentName: (name: string) => void;\n  currentName?: string;\n  localPeerName?: string;\n  isMobile: boolean;\n  onExit: () => void;\n  onBackClick: () => void;\n}) => {\n  return (\n    <form\n      onSubmit={async e => {\n        e.preventDefault();\n        await changeName();\n      }}\n    >\n      <Text\n        variant={isMobile ? 'md' : 'lg'}\n        css={{\n          color: '$on_surface_high',\n          fontWeight: '$semiBold',\n          display: 'flex',\n          pb: '$4',\n          '@md': { px: '$8', borderBottom: '1px solid $border_default' },\n        }}\n      >\n        {isMobile ? <ChevronLeftIcon onClick={onBackClick} style={{ marginRight: '0.5rem' }} /> : null}\n        Change Name\n        <Box\n          css={{ color: 'inherit', ml: 'auto', '&:hover': { color: '$on_surface_medium', cursor: 'pointer' } }}\n          onClick={onExit}\n        >\n          <CrossIcon />\n        </Box>\n      </Text>\n      <Text variant=\"sm\" css={{ color: '$on_surface_medium', pb: '$6', mb: '$8', '@md': { px: '$8', mt: '$4' } }}>\n        Your name will be visible to other participants in the session.\n      </Text>\n      <Flex justify=\"center\" align=\"center\" css={{ my: '$8', w: '100%', '@md': { px: '$8' } }}>\n        <Input\n          css={{ width: '100%', bg: '$surface_default' }}\n          value={currentName}\n          // Prevents popup from showing up on chrome mweb\n          type={isMobile ? 'search' : 'text'}\n          onChange={e => {\n            setCurrentName(e.target.value);\n          }}\n          autoComplete=\"name\"\n          required\n          data-testid=\"change_name_field\"\n          onKeyDown={async e => {\n            if (e.key === 'Enter' && currentName && currentName.trim().length > 0 && currentName !== localPeerName) {\n              e.preventDefault();\n              if (isMobile) {\n                return;\n              }\n              changeName();\n            }\n          }}\n        />\n      </Flex>\n\n      <Flex\n        justify=\"between\"\n        align=\"center\"\n        css={{\n          width: '100%',\n          gap: '$md',\n          mt: '$10',\n          '@md': { px: '$4' },\n        }}\n      >\n        {isMobile ? null : (\n          <Button\n            variant=\"standard\"\n            css={{ w: '100%' }}\n            outlined\n            type=\"submit\"\n            disabled={!localPeerName}\n            onClick={onExit}\n          >\n            Cancel\n          </Button>\n        )}\n\n        <Button\n          variant=\"primary\"\n          css={{ width: '100%' }}\n          type=\"submit\"\n          disabled={!currentName?.trim() || currentName?.trim() === localPeerName}\n          data-testid=\"popup_change_btn\"\n        >\n          Change\n        </Button>\n      </Flex>\n    </form>\n  );\n};\n", "import { useCallback } from 'react';\nimport { selectAppData, useHMSActions, useHMSStore, useHMSVanillaStore } from '@100mslive/react-sdk';\nimport { APP_DATA } from '../../common/constants';\n\nexport const useIsSheetTypeOpen = (sheetType: string) => {\n  if (!sheetType) {\n    throw Error('Pass one of the sheet options');\n  }\n  return useHMSStore(selectAppData(APP_DATA.sheet)) === sheetType;\n};\n\nexport const useSheetState = () => {\n  const sheet = useHMSStore(selectAppData(APP_DATA.sheet));\n  return sheet;\n};\n\nexport const useSheetToggle = (sheetType: string) => {\n  const hmsActions = useHMSActions();\n  const vanillaStore = useHMSVanillaStore();\n  const toggleSheet = useCallback(() => {\n    const isOpen = vanillaStore.getState(selectAppData(APP_DATA.sheet)) === sheetType;\n    hmsActions.setAppData(APP_DATA.sheet, !isOpen ? sheetType : '');\n  }, [vanillaStore, hmsActions, sheetType]);\n  return toggleSheet;\n};\n\nexport const useSheetReset = () => {\n  const hmsActions = useHMSActions();\n  const resetSheet = useCallback(() => {\n    hmsActions.setAppData(APP_DATA.sheet, '');\n  }, [hmsActions]);\n  return resetSheet;\n};\n", "import { useEffect, useState } from 'react';\nimport { selectLocalPeerID } from '@100mslive/hms-video-store';\nimport { HMSNotificationTypes, useHMSNotifications, useHMSStore } from '@100mslive/react-sdk';\n\nexport const useUnreadPollQuizPresent = () => {\n  const localPeerID = useHMSStore(selectLocalPeerID);\n  const notification = useHMSNotifications(HMSNotificationTypes.POLL_STARTED);\n  const [unreadPollQuiz, setUnreadPollQuiz] = useState(false);\n\n  useEffect(() => {\n    if (!notification) {\n      return;\n    }\n    setUnreadPollQuiz(notification.data.startedBy !== localPeerID);\n  }, [localPeerID, notification]);\n  return { unreadPollQuiz, setUnreadPollQuiz };\n};\n", "import React from 'react';\nimport { HandIcon, HandRaiseSlashedIcon } from '@100mslive/react-icons';\nimport { CSS } from '../../Theme';\nimport { Tooltip } from '../../Tooltip';\n// @ts-ignore: No implicit Any\nimport IconButton from '../IconButton';\nimport { useRoomLayoutConferencingScreen } from '../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useMyMetadata } from './hooks/useMetadata';\n\nexport const RaiseHand = ({ css }: { css?: CSS }) => {\n  const { isHandRaised, toggleHandRaise } = useMyMetadata();\n  const { elements } = useRoomLayoutConferencingScreen();\n\n  if (!elements.hand_raise) {\n    return null;\n  }\n\n  return (\n    <Tooltip title={isHandRaised ? 'Lower hand' : 'Raise hand'}>\n      <IconButton\n        data-testid=\"hand_raise_btn\"\n        css={css}\n        active={!isHandRaised}\n        onClick={async () => await toggleHandRaise()}\n      >\n        {isHandRaised ? <HandRaiseSlashedIcon /> : <HandIcon />}\n      </IconButton>\n    </Tooltip>\n  );\n};\n", "import React, { Fragment } from 'react';\nimport { selectIsAllowedToPublish, useAwayNotifications, useHMSStore, useScreenShare } from '@100mslive/react-sdk';\nimport { ShareScreenIcon } from '@100mslive/react-icons';\nimport { ShareScreenOptions } from './pdfAnnotator/shareScreenOptions';\nimport { ToastManager } from './Toast/ToastManager';\nimport { Box, Flex } from '../../Layout';\nimport { Tooltip } from '../../Tooltip';\nimport { ScreenShareButton } from './ShareMenuIcon';\nimport { useUISettings } from './AppData/useUISettings';\nimport { isScreenshareSupported } from '../common/utils';\nimport { UI_SETTINGS } from '../common/constants';\n\nexport const ScreenshareToggle = ({ css = {} }) => {\n  const isAllowedToPublish = useHMSStore(selectIsAllowedToPublish);\n  const isAudioOnly = useUISettings(UI_SETTINGS.isAudioOnly);\n\n  const {\n    amIScreenSharing,\n    screenShareVideoTrackId: video,\n    toggleScreenShare,\n  } = useScreenShare(error => {\n    ToastManager.addToast({\n      title: error.message,\n      variant: 'error',\n      duration: 2000,\n    });\n  });\n  const { requestPermission } = useAwayNotifications();\n  const isVideoScreenshare = amIScreenSharing && !!video;\n  if (!isAllowedToPublish.screen || !isScreenshareSupported()) {\n    return null;\n  }\n\n  return (\n    <Fragment>\n      <Flex direction=\"row\">\n        <ScreenShareButton\n          variant=\"standard\"\n          key=\"ShareScreen\"\n          active={!isVideoScreenshare}\n          css={css}\n          disabled={isAudioOnly}\n          onClick={async () => {\n            await toggleScreenShare();\n            await requestPermission();\n          }}\n        >\n          <Tooltip title={`${!isVideoScreenshare ? 'Start' : 'Stop'} screen sharing`}>\n            <Box>\n              <ShareScreenIcon />\n            </Box>\n          </Tooltip>\n        </ScreenShareButton>\n        <ShareScreenOptions />\n      </Flex>\n    </Fragment>\n  );\n};\n", "import React, { Fragment, useState } from 'react';\nimport { useScreenShare } from '@100mslive/react-sdk';\nimport { StarIcon, VerticalMenuIcon } from '@100mslive/react-icons';\nimport PDFShareImg from './../../images/pdf-share.png';\nimport ScreenShareImg from './../../images/screen-share.png';\nimport { Box, Dropdown, Flex, IconButton, Text, Tooltip } from '../../../';\nimport { ShareMenuIcon } from '../ShareMenuIcon';\nimport { PDFFileOptions } from './pdfFileOptions';\n\nconst MODALS = {\n  SHARE: 'share',\n  SCREEN_SHARE: 'screenShare',\n  PDF_SHARE: 'pdfShare',\n};\n\nexport function ShareScreenOptions() {\n  const [openModals, setOpenModals] = useState(new Set());\n  const { amIScreenSharing } = useScreenShare();\n  const updateState = (modalName, value) => {\n    setOpenModals(modals => {\n      const copy = new Set(modals);\n      if (value) {\n        copy.add(modalName);\n      } else {\n        copy.delete(modalName);\n      }\n      return copy;\n    });\n  };\n  const { toggleScreenShare } = useScreenShare();\n  return (\n    <Fragment>\n      <Dropdown.Root\n        open={openModals.has(MODALS.SHARE)}\n        onOpenChange={value => updateState(MODALS.SHARE, value)}\n        modal={false}\n      >\n        <Dropdown.Trigger asChild data-testid=\"sharing_btn\" disabled={amIScreenSharing}>\n          <ShareMenuIcon disabled={amIScreenSharing}>\n            <Tooltip title=\"Share\">\n              <Box>\n                <VerticalMenuIcon />\n              </Box>\n            </Tooltip>\n          </ShareMenuIcon>\n        </Dropdown.Trigger>\n        <Dropdown.Content\n          sideOffset={5}\n          css={{\n            w: '$96',\n            maxHeight: '$96',\n            p: 0,\n            bg: '$surface_dim',\n          }}\n        >\n          <Dropdown.Item\n            css={{\n              flexDirection: 'column',\n              alignItems: 'flex-start',\n              px: '$10',\n              pt: '$10',\n              pb: '$6',\n              '&:hover': {\n                bg: 'transparent',\n                cursor: 'default',\n              },\n            }}\n          >\n            <Text variant=\"h6\">Start Sharing</Text>\n            <Text variant=\"sm\">Choose what you want to share</Text>\n          </Dropdown.Item>\n          <Dropdown.Item\n            css={{\n              flexDirection: 'row',\n              alignItems: 'flex-start',\n              gap: '$8',\n              px: '$10',\n              pt: '$6',\n              pb: '$10',\n              '&:hover': {\n                bg: 'transparent',\n                cursor: 'default',\n              },\n            }}\n          >\n            <Flex\n              direction=\"column\"\n              align=\"center\"\n              css={{\n                gap: '$6',\n              }}\n            >\n              <IconButton\n                as=\"div\"\n                onClick={toggleScreenShare}\n                css={{\n                  p: '$6',\n                  display: 'flex',\n                  justifyContent: 'center',\n                  border: '1px solid $border_bright',\n                  r: '$2',\n                  bg: '$surface_brighter',\n                  pb: '0',\n                }}\n              >\n                <img\n                  src={ScreenShareImg}\n                  alt=\"screen-share\"\n                  width=\"100%\"\n                  height=\"100%\"\n                  style={{\n                    borderTopLeftRadius: '0.5rem', // TODO: create image component to solve for style hardcoding\n                    borderTopRightRadius: '0.5rem',\n                  }}\n                />\n              </IconButton>\n              <Flex direction=\"column\" align=\"center\">\n                <Text variant=\"body2\">Share Screen</Text>\n                <Text\n                  variant=\"caption\"\n                  css={{\n                    c: '$on_surface_low',\n                    textAlign: 'center',\n                  }}\n                >\n                  Share your tab, window or your entire screen\n                </Text>\n              </Flex>\n            </Flex>\n            <Flex\n              direction=\"column\"\n              align=\"center\"\n              css={{\n                gap: '$6',\n              }}\n            >\n              <IconButton\n                onClick={() => {\n                  updateState(MODALS.PDF_SHARE, true);\n                }}\n                disabled={amIScreenSharing}\n                css={{\n                  p: '$6',\n                  display: 'flex',\n                  justifyContent: 'center',\n                  border: '$border_bright 1px solid',\n                  r: '$2',\n                  bg: '$surface_bright',\n                  pb: '0',\n                }}\n              >\n                <img\n                  src={PDFShareImg}\n                  alt=\"pdf-share\"\n                  width=\"100%\"\n                  height=\"100%\"\n                  style={{\n                    borderTopLeftRadius: '0.5rem', // TODO: create image component to solve for style hardcoding\n                    borderTopRightRadius: '0.5rem',\n                  }}\n                />\n                <Flex\n                  direction=\"row\"\n                  align=\"center\"\n                  css={{\n                    position: 'absolute',\n                    top: '35%',\n                    left: '54%',\n                    padding: '$2 $4',\n                    r: '$2',\n                    bg: '$primary_bright',\n                    zIndex: '2',\n                    gap: '$2',\n                  }}\n                >\n                  <StarIcon height={14} width={14} />\n\n                  <Text\n                    variant=\"xs\"\n                    css={{\n                      fontWeight: '$semiBold',\n                      c: '$on_primary_high',\n                      pr: '$4',\n                    }}\n                  >\n                    New\n                  </Text>\n                </Flex>\n              </IconButton>\n              <Flex direction=\"column\" align=\"center\">\n                <Text variant=\"body2\">Share PDF</Text>\n                <Text\n                  variant=\"caption\"\n                  css={{\n                    c: '$on_surface_low',\n                    textAlign: 'center',\n                  }}\n                >\n                  Annotate, draw shapes, and more over PDFs\n                </Text>\n              </Flex>\n            </Flex>\n          </Dropdown.Item>\n        </Dropdown.Content>\n      </Dropdown.Root>\n      {openModals.has(MODALS.PDF_SHARE) && (\n        <PDFFileOptions onOpenChange={value => updateState(MODALS.PDF_SHARE, value)} />\n      )}\n    </Fragment>\n  );\n}\n", "import { styled } from '../../Theme';\nimport IconButton from '../IconButton';\n\nexport const ScreenShareButton = styled(IconButton, {\n  h: '$14',\n  px: '$8',\n  r: '$1',\n  borderTopRightRadius: 0,\n  borderBottomRightRadius: 0,\n  '@md': {\n    px: '$4',\n    mx: 0,\n  },\n});\n\nexport const ShareMenuIcon = styled(ScreenShareButton, {\n  borderTopLeftRadius: 0,\n  borderBottomLeftRadius: 0,\n  borderTopRightRadius: '$1',\n  borderBottomRightRadius: '$1',\n  borderLeftWidth: 0,\n  w: '$4',\n  '@md': {\n    w: 'unset',\n    px: '$2',\n  },\n});\n", "import React, { useState } from 'react';\nimport { Dialog, Flex } from '../../../';\nimport { DialogInputFile } from '../../primitives/DialogContent';\nimport { PDFHeader } from './pdfHeader';\nimport { SubmitPDF } from './submitPdf';\nimport { UploadedFile } from './uploadedFile';\n\nexport function PDFFileOptions({ onOpenChange }) {\n  const [pdfFile, setPDFFile] = useState(null);\n\n  return !pdfFile ? (\n    <Dialog.Root defaultOpen onOpenChange={onOpenChange}>\n      <Dialog.Portal>\n        <Dialog.Overlay />\n        <Dialog.Content\n          css={{\n            w: 'min(420px,80%)',\n            overflow: 'auto',\n            p: '$10',\n            bg: '$surface_dim',\n          }}\n        >\n          <Flex direction=\"column\">\n            <PDFHeader />\n            <DialogInputFile\n              onChange={target => {\n                setPDFFile(target.files[0]);\n              }}\n              placeholder=\"Click to upload\"\n              type=\"file\"\n              accept=\".pdf\"\n            />\n\n            <SubmitPDF pdfFile={pdfFile} onOpenChange={onOpenChange} />\n          </Flex>\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  ) : (\n    <UploadedFile pdfFile={pdfFile} setPDFFile={setPDFFile} onOpenChange={onOpenChange} />\n  );\n}\n", "import React from 'react';\nimport { Dialog, Text } from '../../../';\nimport { DialogCol } from '../../primitives/DialogContent';\n\nexport const PDFHeader = () => {\n  return (\n    <DialogCol\n      align=\"start\"\n      css={{\n        mt: 0,\n        mb: '$6',\n      }}\n    >\n      <Dialog.Title asChild>\n        <Text as=\"h6\" variant=\"h6\">\n          Share PDF\n        </Text>\n      </Dialog.Title>\n      <Dialog.Description asChild>\n        <Text\n          variant=\"sm\"\n          css={{\n            c: '$on_surface_medium',\n          }}\n        >\n          Choose PDF you want to annotate and share\n        </Text>\n      </Dialog.Description>\n    </DialogCol>\n  );\n};\n", "import React from 'react';\nimport { Button, Flex } from '../../../';\nimport { useSetAppDataByKey } from '../AppData/useUISettings';\nimport { APP_DATA } from '../../common/constants';\n\nexport const SubmitPDF = ({ pdfFile, onOpenChange }) => {\n  const [, setPDFConfig] = useSetAppDataByKey(APP_DATA.pdfConfig);\n\n  return (\n    <Flex\n      direction=\"row\"\n      css={{\n        mb: '0',\n        mt: 'auto',\n        gap: '$8',\n      }}\n    >\n      <Button\n        variant=\"standard\"\n        outlined\n        type=\"submit\"\n        onClick={() => {\n          onOpenChange(false);\n        }}\n        css={{ w: '50%' }}\n      >\n        Cancel\n      </Button>\n      <Button\n        variant=\"primary\"\n        type=\"submit\"\n        onClick={() => {\n          if (pdfFile) {\n            setPDFConfig(pdfFile);\n            onOpenChange(false);\n          }\n        }}\n        disabled={!pdfFile}\n        data-testid=\"share_pdf_btn\"\n        css={{\n          w: '50%',\n        }}\n      >\n        Start Sharing\n      </Button>\n    </Flex>\n  );\n};\n", "import React from 'react';\nimport { TrashIcon } from '@100mslive/react-icons';\nimport { Dialog, Flex, Text } from '../../../';\nimport { DialogRow } from '../../primitives/DialogContent';\nimport { PDFHeader } from './pdfHeader';\nimport { PDFInfo } from './pdfInfo';\nimport { SubmitPDF } from './submitPdf';\n\nexport const UploadedFile = ({ pdfFile, setPDFFile, onOpenChange }) => {\n  const [fileName, ext] = pdfFile.name.split('.');\n  return (\n    <Dialog.Root defaultOpen onOpenChange={onOpenChange}>\n      <Dialog.Portal>\n        <Dialog.Overlay />\n        <Dialog.Content\n          css={{\n            w: 'min(420px,80%)',\n            overflow: 'auto',\n            p: '$10',\n            bg: '$surface_dim',\n          }}\n        >\n          <Flex direction=\"column\">\n            <PDFHeader />\n            <DialogRow\n              css={{\n                fontFamily: '$sans',\n                bg: '$surface_bright',\n                r: '$1',\n                outline: 'none',\n                border: '1px solid $border_bright',\n                p: '$4 $6',\n                minHeight: '$11',\n                c: '$on_primary_high',\n                fs: '$md',\n                w: '100%',\n                '&:focus': {\n                  boxShadow: '0 0 0 1px $colors$primary_default',\n                  border: '1px solid transparent',\n                },\n                mb: 0,\n                mt: '$6',\n              }}\n            >\n              <Flex direction=\"row\" css={{ flexGrow: '1', maxWidth: '88%' }}>\n                <Text\n                  css={{\n                    textOverflow: 'ellipsis',\n                    overflow: 'hidden',\n                    whiteSpace: 'nowrap',\n                  }}\n                >\n                  {fileName}\n                </Text>\n                <Text css={{ whiteSpace: 'nowrap' }}>.{ext}</Text>\n              </Flex>\n              <TrashIcon\n                onClick={() => setPDFFile(null)}\n                style={{\n                  cursor: 'pointer',\n                }}\n              />\n            </DialogRow>\n            <PDFInfo />\n            <SubmitPDF pdfFile={pdfFile} onOpenChange={onOpenChange} />\n          </Flex>\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n};\n", "import React from 'react';\nimport { InfoIcon } from '@100mslive/react-icons';\nimport { Text } from '../../../';\nimport { DialogRow } from '../../primitives/DialogContent';\n\nexport const PDFInfo = () => {\n  return (\n    <DialogRow\n      css={{\n        px: '$8',\n        py: '$3',\n        bg: '$surface_default',\n        r: '$1',\n        outline: 'none',\n        border: '1px solid $border_bright',\n        minHeight: '$11',\n      }}\n    >\n      <InfoIcon\n        width=\"64px\"\n        height=\"64px\"\n        style={{\n          paddingRight: '16px',\n        }}\n      />\n      <Text variant=\"caption\">\n        On the next screen, ensure you select \u201CThis Tab\u201D and click on share. Only the PDF viewer will be seen by other\n        participants\n      </Text>\n    </DialogRow>\n  );\n};\n", "import React, { useEffect } from 'react';\n// eslint-disable-next-line\nimport { HMSVirtualBackgroundTypes } from '@100mslive/hms-virtual-background/hmsvbplugin';\nimport {\n  selectAppData,\n  selectIsEffectsEnabled,\n  selectIsLocalVideoEnabled,\n  selectIsVBEnabled,\n  useAVToggle,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { VirtualBackgroundIcon } from '@100mslive/react-icons';\nimport { Loading } from '../../../Loading';\nimport { Tooltip } from '../../../Tooltip';\nimport IconButton from '../../IconButton';\nimport { VBHandler } from './VBHandler';\n// @ts-ignore\nimport { useIsSidepaneTypeOpen, useSidepaneToggle } from '../AppData/useSidepane';\nimport { APP_DATA, isSafari, SIDE_PANE_OPTIONS } from '../../common/constants';\n\nexport const VBToggle = () => {\n  const toggleVB = useSidepaneToggle(SIDE_PANE_OPTIONS.VB);\n  const isVBOpen = useIsSidepaneTypeOpen(SIDE_PANE_OPTIONS.VB);\n  const isVideoOn = useHMSStore(selectIsLocalVideoEnabled);\n  const isVBEnabled = useHMSStore(selectIsVBEnabled);\n  const isEffectsEnabled = useHMSStore(selectIsEffectsEnabled);\n  const loadingEffects = useHMSStore(selectAppData(APP_DATA.loadingEffects));\n  const hmsActions = useHMSActions();\n  const { toggleVideo } = useAVToggle();\n\n  useEffect(() => {\n    if (!toggleVideo) {\n      VBHandler?.reset();\n      hmsActions.setAppData(APP_DATA.background, HMSVirtualBackgroundTypes.NONE);\n    }\n  }, [hmsActions, toggleVideo]);\n\n  if (!isVideoOn || (!isEffectsEnabled && isSafari) || !isVBEnabled) {\n    return null;\n  }\n\n  return (\n    <Tooltip side=\"top\" disabled={isVBOpen} title=\"Configure Virtual Background\">\n      <IconButton active={!isVBOpen} onClick={toggleVB} data-testid=\"virtual_bg_btn\">\n        {loadingEffects ? <Loading size={18} /> : <VirtualBackgroundIcon />}\n      </IconButton>\n    </Tooltip>\n  );\n};\n", "import React from 'react';\nimport { selectUnreadHMSMessagesCount, useHMSStore } from '@100mslive/react-sdk';\nimport { ChatIcon } from '@100mslive/react-icons';\nimport { Box, Flex, Text, Tooltip } from '../../..';\n// @ts-ignore: No implicit Any\nimport IconButton from '../../IconButton';\n// @ts-ignore: No implicit Any\nimport { useIsSidepaneTypeOpen, useSidepaneToggle } from '../AppData/useSidepane';\n// @ts-ignore: No implicit Any\nimport { SIDE_PANE_OPTIONS } from '../../common/constants';\n\nexport const ChatToggle = ({ onClick }: { onClick?: () => void }) => {\n  const countUnreadMessages = useHMSStore(selectUnreadHMSMessagesCount);\n  const isChatOpen = useIsSidepaneTypeOpen(SIDE_PANE_OPTIONS.CHAT);\n  const toggleChat = useSidepaneToggle(SIDE_PANE_OPTIONS.CHAT);\n\n  return (\n    <Box\n      css={{\n        position: 'relative',\n      }}\n    >\n      <Tooltip key=\"chat\" title={`${isChatOpen ? 'Close' : 'Open'} chat`}>\n        <IconButton\n          onClick={() => (onClick ? onClick() : toggleChat())}\n          css={{ bg: isChatOpen ? '$surface_brighter' : '' }}\n          data-testid=\"chat_btn\"\n        >\n          <ChatIcon />\n        </IconButton>\n      </Tooltip>\n      {countUnreadMessages > 0 && (\n        <Flex\n          css={{\n            height: '$8',\n            p: '$4 4.5px',\n            justifyContent: 'center',\n            alignItems: 'center',\n            position: 'absolute',\n            top: '-$4',\n            right: '-$4',\n            borderRadius: '$space$14',\n            background: '$primary_default',\n          }}\n        >\n          <Text variant=\"overline\">{countUnreadMessages > 99 ? '99+' : countUnreadMessages}</Text>\n        </Flex>\n      )}\n    </Box>\n  );\n};\n", "import React, { Fragment, useCallback, useState } from 'react';\nimport { useDebounce, useMedia } from 'react-use';\nimport {\n  HMSPeer,\n  HMSPeerType,\n  HMSRoleName,\n  selectAvailableRoleNames,\n  selectHandRaisedPeers,\n  selectHasPeerHandRaised,\n  selectIsLargeRoom,\n  selectIsPeerAudioEnabled,\n  selectLocalPeerID,\n  selectPeerCount,\n  selectPermissions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport {\n  AddIcon,\n  CallIcon,\n  ChangeRoleIcon,\n  CrossIcon,\n  HandIcon,\n  MicOffIcon,\n  PeopleIcon,\n  PersonSettingsIcon,\n  SearchIcon,\n  VerticalMenuIcon,\n} from '@100mslive/react-icons';\nimport { Accordion, Box, Button, config as cssConfig, Dropdown, Flex, Input, Text, textEllipsis } from '../../..';\n// @ts-ignore: No implicit Any\nimport IconButton from '../../IconButton';\nimport { ConnectionIndicator } from '../Connection/ConnectionIndicator';\nimport { RemoveParticipant } from '../RemoveParticipant';\nimport { RoleChangeModal } from '../RoleChangeModal';\nimport { RoleAccordion } from './RoleAccordion';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { useIsSidepaneTypeOpen, useSidepaneToggle } from '../AppData/useSidepane';\nimport { useSidepaneResetOnLayoutUpdate } from '../AppData/useSidepaneResetOnLayoutUpdate';\nimport { usePeerOnStageActions } from '../hooks/usePeerOnStageActions';\nimport { useParticipants } from '../../common/hooks';\n// @ts-ignore: No implicit Any\nimport { getFormattedCount } from '../../common/utils';\nimport { SIDE_PANE_OPTIONS } from '../../common/constants';\n\nexport const ParticipantList = ({\n  offStageRoles = [],\n  onActive,\n}: {\n  offStageRoles: HMSRoleName[];\n  onActive: (role: string) => void;\n}) => {\n  const [filter, setFilter] = useState<{ search?: string } | undefined>();\n  const { participants, isConnected, peerCount } = useParticipants(filter);\n  const isLargeRoom = useHMSStore(selectIsLargeRoom);\n  const peersOrderedByRoles: Record<string, HMSPeer[]> = {};\n\n  const handRaisedPeers = useHMSStore(selectHandRaisedPeers);\n\n  participants.forEach(participant => {\n    if (participant.roleName) {\n      if (peersOrderedByRoles[participant.roleName] === undefined) {\n        peersOrderedByRoles[participant.roleName] = [];\n      }\n      peersOrderedByRoles[participant.roleName].push(participant);\n    }\n  });\n\n  // prefill off_stage roles of large rooms to load more peers\n  if (isLargeRoom) {\n    offStageRoles.forEach(role => {\n      if (!peersOrderedByRoles[role]) {\n        peersOrderedByRoles[role] = [];\n      }\n    });\n  }\n\n  useSidepaneResetOnLayoutUpdate('participant_list', SIDE_PANE_OPTIONS.PARTICIPANTS);\n\n  const onSearch = useCallback((value: string) => {\n    setFilter(filterValue => {\n      if (!filterValue) {\n        filterValue = {};\n      }\n      filterValue.search = value.toLowerCase();\n      return { ...filterValue };\n    });\n  }, []);\n\n  if (peerCount === 0) {\n    return null;\n  }\n\n  return (\n    <Fragment>\n      <Flex\n        direction=\"column\"\n        css={{\n          size: '100%',\n          gap: '$4',\n        }}\n      >\n        {!filter?.search && participants.length === 0 ? null : <ParticipantSearch onSearch={onSearch} inSidePane />}\n        <VirtualizedParticipants\n          peersOrderedByRoles={peersOrderedByRoles}\n          handRaisedList={handRaisedPeers}\n          isConnected={!!isConnected}\n          filter={filter}\n          offStageRoles={offStageRoles}\n          isLargeRoom={isLargeRoom}\n          onActive={onActive}\n        >\n          {participants.length === 0 ? (\n            <Flex\n              align=\"center\"\n              justify=\"center\"\n              className=\"emptyParticipants\"\n              css={{ w: '100%', p: '$8 0', display: 'none' }}\n            >\n              <Text variant=\"sm\">{!filter ? 'No participants' : 'No matching participants'}</Text>\n            </Flex>\n          ) : null}\n        </VirtualizedParticipants>\n      </Flex>\n    </Fragment>\n  );\n};\n\nexport const ParticipantCount = () => {\n  const peerCount = useHMSStore(selectPeerCount);\n  const toggleSidepane = useSidepaneToggle(SIDE_PANE_OPTIONS.PARTICIPANTS);\n  const isPeerListOpen = useIsSidepaneTypeOpen(SIDE_PANE_OPTIONS.PARTICIPANTS);\n\n  if (peerCount === 0) {\n    return null;\n  }\n  return (\n    <IconButton\n      css={{\n        w: 'auto',\n        p: '$4',\n        h: 'auto',\n        bg: isPeerListOpen ? '$surface_brighter' : '',\n      }}\n      onClick={() => {\n        if (peerCount > 0) {\n          toggleSidepane();\n        }\n      }}\n      data-testid=\"participant_list\"\n    >\n      <PeopleIcon />\n      <Text variant=\"sm\" css={{ mx: '$4', c: 'inherit' }}>\n        {getFormattedCount(peerCount)}\n      </Text>\n    </IconButton>\n  );\n};\n\nexport const Participant = ({\n  peer,\n  isConnected,\n  isHandRaisedAccordion,\n  style,\n}: {\n  peer: HMSPeer;\n  isConnected: boolean;\n  isHandRaisedAccordion?: boolean;\n  style: React.CSSProperties;\n}) => {\n  const localPeerId = useHMSStore(selectLocalPeerID);\n  return (\n    <Flex\n      key={peer.id}\n      css={{\n        w: '100%',\n        p: '$4 $8',\n        pr: '$6',\n        h: '$16',\n        '&:hover .participant_item': { display: 'flex' },\n      }}\n      align=\"center\"\n      justify=\"between\"\n      data-testid={'participant_' + peer.name}\n      style={style}\n    >\n      <Text\n        variant=\"sm\"\n        css={{ ...textEllipsis('100%'), flex: '1 1 0', mr: '$8', fontWeight: '$semiBold', color: '$on_surface_high' }}\n      >\n        {peer.name} {localPeerId === peer.id ? '(You)' : ''}\n      </Text>\n      {isConnected && peer.roleName ? (\n        <ParticipantActions\n          peerId={peer.id}\n          peerType={peer.type}\n          role={peer.roleName}\n          isHandRaisedAccordion={isHandRaisedAccordion}\n        />\n      ) : null}\n    </Flex>\n  );\n};\n\nconst VirtualizedParticipants = ({\n  peersOrderedByRoles = {},\n  isConnected,\n  filter,\n  handRaisedList = [],\n  offStageRoles,\n  isLargeRoom,\n  onActive,\n  children,\n}: {\n  peersOrderedByRoles: Record<string, HMSPeer[]>;\n  isConnected: boolean;\n  filter: undefined | { search?: string };\n  handRaisedList: HMSPeer[];\n  offStageRoles: HMSRoleName[];\n  isLargeRoom: boolean;\n  onActive: (role: string) => void;\n  children: React.ReactNode;\n}) => {\n  return (\n    <Flex\n      direction=\"column\"\n      css={{\n        gap: '$8',\n        overflowY: 'auto',\n        overflowX: 'hidden',\n        pr: '$10',\n        mr: '-$10',\n        flex: '1 1 0',\n        '& > div:empty ~ .emptyParticipants': {\n          display: 'flex',\n        },\n      }}\n    >\n      <Accordion.Root type={isLargeRoom ? 'single' : 'multiple'} collapsible>\n        {handRaisedList.length > 0 ? (\n          <RoleAccordion\n            peerList={handRaisedList}\n            roleName=\"Hand Raised\"\n            filter={filter}\n            isConnected={isConnected}\n            isHandRaisedAccordion\n            offStageRoles={offStageRoles}\n          />\n        ) : null}\n        {Object.keys(peersOrderedByRoles).map(role => (\n          <RoleAccordion\n            key={role}\n            peerList={peersOrderedByRoles[role]}\n            roleName={role}\n            isConnected={isConnected}\n            filter={filter}\n            offStageRoles={offStageRoles}\n            onActive={onActive}\n          />\n        ))}\n      </Accordion.Root>\n      {children}\n    </Flex>\n  );\n};\n\n/**\n * shows settings to change for a participant like changing their role\n */\nconst ParticipantActions = React.memo(\n  ({\n    peerId,\n    peerType,\n    role,\n    isHandRaisedAccordion,\n  }: {\n    peerId: string;\n    role: string;\n    isHandRaisedAccordion?: boolean;\n    peerType: HMSPeerType;\n  }) => {\n    const isHandRaised = useHMSStore(selectHasPeerHandRaised(peerId));\n    const canChangeRole = useHMSStore(selectPermissions)?.changeRole;\n    const canRemoveOthers = useHMSStore(selectPermissions)?.removeOthers;\n    const { elements } = useRoomLayoutConferencingScreen();\n    const { on_stage_exp } = elements || {};\n    const shouldShowMoreActions = (on_stage_exp && canChangeRole) || canRemoveOthers;\n    const isAudioMuted = !useHMSStore(selectIsPeerAudioEnabled(peerId));\n\n    return (\n      <Flex\n        align=\"center\"\n        css={{\n          flexShrink: 0,\n          gap: '$8',\n        }}\n      >\n        {isHandRaisedAccordion ? (\n          <HandRaisedAccordionParticipantActions peerId={peerId} role={role} />\n        ) : (\n          <>\n            <ConnectionIndicator peerId={peerId} />\n            {peerType === HMSPeerType.SIP && (\n              <Flex\n                align=\"center\"\n                justify=\"center\"\n                css={{ p: '$1', c: '$on_surface_high', bg: '$surface_bright', borderRadius: '$round' }}\n              >\n                <CallIcon width={19} height={19} />\n              </Flex>\n            )}\n            {isHandRaised && (\n              <Flex\n                align=\"center\"\n                justify=\"center\"\n                css={{ p: '$1', c: '$on_surface_high', bg: '$surface_bright', borderRadius: '$round' }}\n              >\n                <HandIcon height={19} width={19} />\n              </Flex>\n            )}\n            {isAudioMuted ? (\n              <Flex\n                align=\"center\"\n                justify=\"center\"\n                css={{ p: '$2', c: '$on_surface_high', bg: '$surface_bright', borderRadius: '$round' }}\n              >\n                <MicOffIcon height={19} width={19} />\n              </Flex>\n            ) : null}\n\n            {shouldShowMoreActions ? <ParticipantMoreActions peerId={peerId} role={role} /> : null}\n          </>\n        )}\n      </Flex>\n    );\n  },\n);\n\nconst quickActionStyle = { p: '$1', borderRadius: '$round' };\nconst HandRaisedAccordionParticipantActions = ({ peerId, role }: { peerId: string; role: string }) => {\n  const { handleStageAction, lowerPeerHand, shouldShowStageRoleChange, isInStage } = usePeerOnStageActions({\n    peerId,\n    role,\n  });\n  if (!shouldShowStageRoleChange) {\n    return null;\n  }\n  return (\n    <>\n      <Button variant=\"standard\" css={quickActionStyle} onClick={lowerPeerHand}>\n        <CrossIcon height={18} width={18} />\n      </Button>\n      {!isInStage && (\n        <Button variant=\"primary\" onClick={handleStageAction} css={quickActionStyle}>\n          <AddIcon height={18} width={18} />\n        </Button>\n      )}\n    </>\n  );\n};\n\nconst ParticipantMoreActions = ({ peerId, role }: { peerId: string; role: string }) => {\n  const {\n    open,\n    setOpen,\n    bring_to_stage_label,\n    remove_from_stage_label,\n    handleStageAction,\n    isInStage,\n    shouldShowStageRoleChange,\n  } = usePeerOnStageActions({ peerId, role });\n  const canChangeRole = !!useHMSStore(selectPermissions)?.changeRole;\n  const [openRoleChangeModal, setOpenRoleChangeModal] = useState(false);\n  const roles = useHMSStore(selectAvailableRoleNames);\n\n  return (\n    <>\n      <Dropdown.Root open={open} onOpenChange={value => setOpen(value)} modal={false}>\n        <Dropdown.Trigger\n          asChild\n          data-testid=\"participant_more_actions\"\n          className=\"participant_item\"\n          css={{\n            p: '$1',\n            r: '$0',\n            c: '$on_surface_high',\n            display: open ? 'flex' : 'none',\n            '&:hover': {\n              bg: '$surface_bright',\n            },\n            '@md': {\n              display: 'flex',\n            },\n          }}\n          tabIndex={0}\n        >\n          <Box css={{ my: 'auto' }}>\n            <VerticalMenuIcon />\n          </Box>\n        </Dropdown.Trigger>\n        <Dropdown.Portal>\n          <Dropdown.Content align=\"end\" sideOffset={8} css={{ w: '$64', bg: '$surface_default' }}>\n            {shouldShowStageRoleChange ? (\n              <Dropdown.Item css={{ bg: '$surface_default' }} onClick={() => handleStageAction()}>\n                <ChangeRoleIcon />\n                <Text variant=\"sm\" css={{ ml: '$4', fontWeight: '$semiBold', c: '$on_surface_high' }}>\n                  {isInStage ? remove_from_stage_label : bring_to_stage_label}\n                </Text>\n              </Dropdown.Item>\n            ) : null}\n\n            {canChangeRole && roles.length > 1 ? (\n              <Dropdown.Item css={{ bg: '$surface_default' }} onClick={() => setOpenRoleChangeModal(true)}>\n                <PersonSettingsIcon />\n                <Text variant=\"sm\" css={{ ml: '$4', fontWeight: '$semiBold', c: '$on_surface_high' }}>\n                  Switch Role\n                </Text>\n              </Dropdown.Item>\n            ) : null}\n            <RemoveParticipant peerId={peerId} />\n          </Dropdown.Content>\n        </Dropdown.Portal>\n      </Dropdown.Root>\n      {openRoleChangeModal && <RoleChangeModal peerId={peerId} onOpenChange={setOpenRoleChangeModal} />}\n    </>\n  );\n};\n\nexport const ParticipantSearch = ({\n  onSearch,\n  placeholder = 'Search for participants',\n  inSidePane = false,\n}: {\n  inSidePane?: boolean;\n  placeholder?: string;\n  onSearch: (val: string) => void;\n}) => {\n  const [value, setValue] = React.useState('');\n  const isMobile = useMedia(cssConfig.media.md);\n\n  useDebounce(\n    () => {\n      onSearch(value);\n    },\n    300,\n    [value, onSearch],\n  );\n\n  return (\n    <Flex\n      align=\"center\"\n      css={{\n        p: isMobile ? '0' : '$2 0',\n        mb: '$2',\n        position: 'relative',\n        color: '$on_surface_medium',\n        mt: inSidePane ? '$4' : '',\n      }}\n      onClick={e => e.stopPropagation()}\n    >\n      <SearchIcon style={{ position: 'absolute', left: '0.5rem' }} />\n      <Input\n        type=\"text\"\n        placeholder={placeholder}\n        css={{ w: '100%', p: '$6', pl: '$14', bg: inSidePane ? '$surface_default' : '$surface_dim' }}\n        value={value}\n        onKeyDown={event => {\n          event.stopPropagation();\n        }}\n        onChange={event => {\n          setValue(event.currentTarget.value);\n        }}\n        autoComplete=\"off\"\n        aria-autocomplete=\"none\"\n      />\n    </Flex>\n  );\n};\n", "import React from 'react';\nimport { HMSPeerType, selectConnectionQualityByPeerID, selectPeerTypeByID, useHMSStore } from '@100mslive/react-sdk';\nimport { PoorConnectivityIcon } from '@100mslive/react-icons';\nimport { styled, Tooltip, useTheme } from '../../..';\n// @ts-ignore\nimport { getColor, getTooltipText } from './connectionQualityUtils';\n\nconst Wrapper = styled('span', {\n  width: '28px',\n  height: '28px',\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n  borderRadius: '$round',\n  variants: {\n    isTile: {\n      true: {\n        width: 'unset',\n        height: 'unset',\n      },\n    },\n  },\n});\n\nexport const ConnectionIndicator = ({\n  peerId,\n  isTile = false,\n  hideBg = false,\n}: {\n  peerId: string;\n  isTile?: boolean;\n  hideBg?: boolean;\n}) => {\n  const downlinkQuality = useHMSStore(selectConnectionQualityByPeerID(peerId))?.downlinkQuality;\n  const peerType = useHMSStore(selectPeerTypeByID(peerId));\n  const { theme } = useTheme();\n  const defaultColor = theme.colors.on_surface_low;\n  if (downlinkQuality === -1 || downlinkQuality === undefined || peerType === HMSPeerType.SIP) {\n    return null;\n  }\n  if (downlinkQuality === 0) {\n    return (\n      <Tooltip side=\"left\" title={getTooltipText(downlinkQuality)}>\n        <Wrapper isTile={isTile} css={{ color: '#ED4C5A' }} data-testid=\"tile_network\">\n          <PoorConnectivityIcon />\n        </Wrapper>\n      </Tooltip>\n    );\n  }\n  const size = isTile ? 12 : 16;\n  return (\n    <Tooltip side=\"left\" title={getTooltipText(downlinkQuality)}>\n      <Wrapper isTile={isTile} data-testid=\"tile_network\" css={{ backgroundColor: hideBg ? '' : '$surface_bright' }}>\n        <svg\n          width={size}\n          height={size}\n          viewBox=\"0 0 14 12\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          xmlSpace=\"preserve\"\n          style={{\n            fillRule: 'evenodd',\n            clipRule: 'evenodd',\n            strokeLinejoin: 'round',\n            strokeMiterlimit: 2,\n          }}\n        >\n          <path\n            d=\"M6.875 0c2.549.035 4.679.902 6.445 2.648.366.362.45.796.216 1.096-.239.306-.714.34-1.142.072a2.28 2.28 0 0 1-.341-.271C9.24.862 4.924.775 1.992 3.346c-.284.249-.594.419-.983.393-.272-.019-.49-.135-.613-.388-.125-.261-.05-.498.114-.713.073-.092.156-.177.245-.254C2.516.804 4.591.039 6.875 0Z\"\n            fill={getColor(4, downlinkQuality, defaultColor, theme)}\n            transform=\"translate(-.333)\"\n          />\n          <path\n            d=\"M7.056 2.964c1.756.035 3.208.7 4.499 1.763.162.134.277.315.354.512.098.251.114.503-.075.72-.193.222-.452.259-.725.198-.293-.066-.518-.247-.738-.443a4.859 4.859 0 0 0-6.198-.26c-.166.127-.318.271-.475.409-.242.211-.513.343-.843.317-.43-.034-.679-.397-.561-.81.062-.211.181-.4.345-.546 1.265-1.162 2.733-1.836 4.417-1.86Z\"\n            fill={getColor(3, downlinkQuality, defaultColor, theme)}\n            transform=\"translate(-.333)\"\n          />\n          <path\n            d=\"M7.384,6.052C8.293,6.068 9.157,6.449 9.783,7.108C10.005,7.339 10.157,7.6 10.07,7.942C9.959,8.377 9.435,8.581 9.071,8.243C7.935,7.191 6.356,7.183 5.152,8.183C4.816,8.462 4.6,8.485 4.332,8.27C4.063,8.055 3.998,7.691 4.177,7.358C4.273,7.179 4.414,7.038 4.57,6.911C5.26,6.349 6.149,6.05 7.384,6.052L7.384,6.052Z\"\n            fill={getColor(2, downlinkQuality, defaultColor, theme)}\n          />\n          <path\n            d=\"M8.214,9.941C8.214,10.234 8.097,10.515 7.888,10.721C7.68,10.928 7.398,11.042 7.104,11.039C6.471,11.036 5.982,10.541 5.993,9.912C6.004,9.259 6.499,8.766 7.133,8.779C7.744,8.791 8.22,9.301 8.214,9.941Z\"\n            fill={getColor(1, downlinkQuality, defaultColor, theme)}\n          />\n        </svg>\n      </Wrapper>\n    </Tooltip>\n  );\n};\n", "const connectionTooltip = {\n  0: 'Reconnecting',\n  1: 'Very Bad Connection',\n  2: 'Bad Connection',\n  3: 'Moderate Connection',\n  4: 'Good Connection',\n  5: 'Excellent Connection',\n};\nconnectionTooltip[-1] = 'Network Unknown';\n\n/**\n * @param connectionScore -> 1-5 connection score for network quality\n */\nexport const getTooltipText = connectionScore => {\n  return connectionTooltip[connectionScore];\n};\n\n/**\n * position is needed here as we don't want all the dots/arcs to be colored,\n * the non colored ones will be passed in the default color. If user is\n * disconnected(score=0), no dot/arc will be colored.\n * @param position -> 1 to 5\n * @param connectionScore -> 0 to 5, 0 means disconnected\n * @param defaultColor -> color for components not taking the connection color\n */\nexport const getColor = (position, connectionScore, defaultColor, theme) => {\n  const shouldBeColored = position <= connectionScore;\n  if (!shouldBeColored) {\n    return defaultColor;\n  }\n  if (connectionScore >= 4) {\n    return theme.colors.alert_success;\n  } else if (connectionScore >= 1) {\n    return theme.colors.alert_warning;\n  }\n  return defaultColor;\n};\n", "import React from 'react';\nimport { HMSPeerID, selectLocalPeerID, selectPermissions, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { PeopleRemoveIcon } from '@100mslive/react-icons';\n// @ts-ignore: No implicit Any\nimport { ToastManager } from './Toast/ToastManager';\nimport { Dropdown } from '../../Dropdown';\nimport { Text } from '../../Text';\n\nexport const RemoveParticipant = ({ peerId }: { peerId: HMSPeerID }) => {\n  const canRemoveOthers = useHMSStore(selectPermissions)?.removeOthers;\n  const localPeerId = useHMSStore(selectLocalPeerID);\n  const actions = useHMSActions();\n\n  if (peerId === localPeerId || !canRemoveOthers) {\n    return null;\n  }\n  return (\n    <Dropdown.Item\n      css={{ color: '$alert_error_default', bg: '$surface_default' }}\n      onClick={async () => {\n        try {\n          await actions.removePeer(peerId, '');\n        } catch (error) {\n          const ex = error as Error;\n          ToastManager.addToast({ title: ex.message, variant: 'error' });\n        }\n      }}\n    >\n      <PeopleRemoveIcon />\n      <Text variant=\"sm\" css={{ ml: '$4', color: 'inherit', fontWeight: '$semiBold' }}>\n        Remove Participant\n      </Text>\n    </Dropdown.Item>\n  );\n};\n", "import React, { useEffect } from 'react';\nimport { useMeasure } from 'react-use';\nimport { FixedSizeList } from 'react-window';\nimport { HMSPeer, selectIsLargeRoom, useHMSStore, usePaginatedParticipants } from '@100mslive/react-sdk';\nimport { AddIcon, ChevronRightIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Accordion } from '../../../Accordion';\nimport { Button } from '../../../Button';\nimport { HorizontalDivider } from '../../../Divider';\nimport { Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { Participant } from './ParticipantList';\nimport { RoleOptions } from './RoleOptions';\nimport { useGroupOnStageActions } from '../hooks/useGroupOnStageActions';\n// @ts-ignore: No implicit Any\nimport { getFormattedCount } from '../../common/utils';\n\nexport const ROW_HEIGHT = 50;\nconst ITER_TIMER = 5000;\n\nexport interface ItemData {\n  peerList: HMSPeer[];\n  isHandRaisedAccordion?: boolean;\n  isConnected: boolean;\n}\n\nexport function itemKey(index: number, data: ItemData) {\n  return data.peerList[index]?.id;\n}\n\nexport const VirtualizedParticipantItem = React.memo(\n  ({ index, data, style }: { index: number; data: ItemData; style: React.CSSProperties }) => {\n    return (\n      <Participant\n        key={data.peerList[index].id}\n        peer={data.peerList[index]}\n        isHandRaisedAccordion={data.isHandRaisedAccordion}\n        isConnected={data.isConnected}\n        style={style}\n      />\n    );\n  },\n);\n\nexport const RoleAccordion = ({\n  peerList = [],\n  roleName,\n  isConnected,\n  filter,\n  isHandRaisedAccordion = false,\n  offStageRoles,\n  onActive,\n}: ItemData & {\n  roleName: string;\n  isHandRaisedAccordion?: boolean;\n  filter?: { search?: string };\n  offStageRoles: string[];\n  onActive?: (role: string) => void;\n}) => {\n  const [ref, { width }] = useMeasure<HTMLDivElement>();\n  const isLargeRoom = useHMSStore(selectIsLargeRoom);\n  const { peers, total, loadPeers } = usePaginatedParticipants({ role: roleName, limit: 10 });\n  const isOffStageRole = roleName && offStageRoles.includes(roleName);\n  let peersInAccordion = peerList;\n  // for large rooms, peer list would be empty\n  if (isOffStageRole && isLargeRoom) {\n    peersInAccordion = peers;\n    if (filter?.search) {\n      peersInAccordion = peersInAccordion.filter(peer => peer.name.toLowerCase().includes(filter.search || ''));\n    }\n  }\n  const { bringAllToStage, bring_to_stage_label, canBringToStage, lowerAllHands } = useGroupOnStageActions({\n    peers: peersInAccordion,\n  });\n\n  useEffect(() => {\n    if (!isOffStageRole || !isLargeRoom) {\n      return;\n    }\n    loadPeers();\n    const interval = setInterval(() => {\n      loadPeers();\n    }, ITER_TIMER);\n    return () => clearInterval(interval);\n  }, [isOffStageRole, isLargeRoom]); //eslint-disable-line\n\n  if (peersInAccordion.length === 0 || (isHandRaisedAccordion && filter?.search)) {\n    return null;\n  }\n\n  const height = ROW_HEIGHT * peersInAccordion.length;\n  const hasNext = total > peersInAccordion.length && !filter?.search;\n\n  return (\n    <Accordion.Item value={roleName} css={{ '&:hover .role_actions': { visibility: 'visible' }, mb: '$8' }} ref={ref}>\n      <Accordion.Header\n        chevronID={`role_accordion_btn_${roleName}`}\n        iconStyles={{ c: '$on_surface_high' }}\n        css={{\n          textTransform: 'capitalize',\n          p: '$6 $8',\n          fontSize: '$sm',\n          fontWeight: '$semiBold',\n          c: '$on_surface_medium',\n          borderRadius: '$1',\n          border: '1px solid $border_default',\n          '&[data-state=\"open\"]': {\n            borderBottomLeftRadius: 0,\n            borderBottomRightRadius: 0,\n          },\n        }}\n      >\n        <Flex justify=\"between\" align=\"center\" css={{ flexGrow: 1, pr: '$6' }}>\n          <Text\n            variant=\"sm\"\n            css={{ fontWeight: '$semiBold', textTransform: 'capitalize', color: '$on_surface_medium' }}\n          >\n            {roleName} {`(${getFormattedCount(isLargeRoom && isOffStageRole ? total : peerList.length)})`}\n          </Text>\n          <RoleOptions roleName={roleName} peerList={peersInAccordion} />\n        </Flex>\n      </Accordion.Header>\n      <Accordion.Content contentStyles={{ border: '1px solid $border_default', borderTop: 'none' }}>\n        <FixedSizeList\n          itemSize={ROW_HEIGHT}\n          itemData={{\n            peerList: isHandRaisedAccordion\n              ? peersInAccordion.sort((a, b) => {\n                  try {\n                    const aHandRaisedAt = JSON.parse(a.metadata || '{}').handRaisedAt;\n                    const bHandRaisedAt = JSON.parse(b.metadata || '{}').handRaisedAt;\n                    return aHandRaisedAt - bHandRaisedAt;\n                  } catch (err) {\n                    return 0;\n                  }\n                })\n              : peersInAccordion,\n            isConnected,\n            isHandRaisedAccordion,\n          }}\n          itemKey={itemKey}\n          itemCount={peersInAccordion.length}\n          width={width}\n          height={height}\n        >\n          {VirtualizedParticipantItem}\n        </FixedSizeList>\n        {offStageRoles?.includes(roleName) && hasNext ? (\n          <Flex\n            align=\"center\"\n            justify=\"end\"\n            css={{\n              gap: '$1',\n              cursor: 'pointer',\n              color: '$on_surface_high',\n              p: '$6',\n              borderTop: '1px solid $border_default',\n            }}\n            onClick={() => onActive?.(roleName)}\n          >\n            <Text variant=\"sm\" css={{ color: 'inherit' }}>\n              View All\n            </Text>\n            <ChevronRightIcon />\n          </Flex>\n        ) : null}\n        {isHandRaisedAccordion && canBringToStage && (\n          <>\n            <HorizontalDivider />\n            <Flex css={{ w: '100%', p: '$6', gap: '$4' }} justify=\"center\">\n              <Button variant=\"standard\" onClick={lowerAllHands} icon css={{ pl: '$2' }}>\n                <CrossIcon /> Lower all hands\n              </Button>\n\n              <Button onClick={bringAllToStage} icon css={{ pl: '$2' }}>\n                <AddIcon /> {bring_to_stage_label}\n              </Button>\n            </Flex>\n          </>\n        )}\n      </Accordion.Content>\n    </Accordion.Item>\n  );\n};\n", "import React, { useState } from 'react';\nimport { DefaultConferencingScreen_Elements } from '@100mslive/types-prebuilt';\nimport { match } from 'ts-pattern';\nimport {\n  HMSPeer,\n  selectPermissions,\n  selectRoleByRoleName,\n  selectTracksMap,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport {\n  MicOffIcon,\n  MicOnIcon,\n  PersonRectangleIcon,\n  RemoveUserIcon,\n  VerticalMenuIcon,\n  VideoOffIcon,\n  VideoOnIcon,\n} from '@100mslive/react-icons';\nimport { Dropdown } from '../../../Dropdown';\nimport { Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { getMetadata } from '../../common/utils';\n\nconst dropdownItemCSS = { backgroundColor: '$surface_default', gap: '$4', p: '$8' };\nconst optionTextCSS = {\n  fontWeight: '$semiBold',\n  color: '$on_surface_high',\n  textTransform: 'none',\n  whiteSpace: 'nowrap',\n};\n\nconst DropdownWrapper = ({ children }: { children: React.ReactNode }) => {\n  const [openOptions, setOpenOptions] = useState(false);\n  if (React.Children.toArray(children).length === 0) {\n    return null;\n  }\n  return (\n    <Dropdown.Root open={openOptions} onOpenChange={setOpenOptions}>\n      <Dropdown.Trigger\n        data-testid=\"role_group_options\"\n        onClick={e => e.stopPropagation()}\n        className=\"role_actions\"\n        asChild\n        css={{\n          p: '$1',\n          r: '$0',\n          c: '$on_surface_high',\n          visibility: openOptions ? 'visible' : 'hidden',\n          '&:hover': {\n            c: '$on_surface_medium',\n          },\n          '@md': {\n            visibility: 'visible',\n          },\n        }}\n      >\n        <Flex>\n          <VerticalMenuIcon />\n        </Flex>\n      </Dropdown.Trigger>\n      <Dropdown.Content\n        onClick={e => e.stopPropagation()}\n        css={{ w: 'max-content', bg: '$surface_default', py: 0 }}\n        align=\"end\"\n      >\n        {children}\n      </Dropdown.Content>\n    </Dropdown.Root>\n  );\n};\n\nexport const RoleOptions = ({ roleName, peerList }: { roleName: string; peerList: HMSPeer[] }) => {\n  const permissions = useHMSStore(selectPermissions);\n  const hmsActions = useHMSActions();\n  const { elements } = useRoomLayoutConferencingScreen();\n  const { on_stage_role, off_stage_roles = [] } = (elements as DefaultConferencingScreen_Elements)?.on_stage_exp || {};\n  const canRemoveRoleFromStage = permissions?.changeRole && roleName === on_stage_role;\n  const role = useHMSStore(selectRoleByRoleName(roleName));\n  const tracks = useHMSStore(selectTracksMap);\n  if (!role) {\n    return null;\n  }\n  const canPublishAudio = role.publishParams.allowed.includes('audio');\n  const canPublishVideo = role.publishParams.allowed.includes('video');\n\n  let isVideoOnForSomePeers = false;\n  let isAudioOnForSomePeers = false;\n\n  peerList.forEach(peer => {\n    if (peer.isLocal) {\n      return;\n    }\n    const isAudioOn = !!peer.audioTrack && tracks[peer.audioTrack]?.enabled;\n    const isVideoOn = !!peer.videoTrack && tracks[peer.videoTrack]?.enabled;\n    isAudioOnForSomePeers = isAudioOnForSomePeers || isAudioOn;\n    isVideoOnForSomePeers = isVideoOnForSomePeers || isVideoOn;\n  });\n\n  const setTrackEnabled = async (type: 'audio' | 'video', enabled = false) => {\n    try {\n      await hmsActions.setRemoteTracksEnabled({ roles: [roleName], source: 'regular', type, enabled });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  // on stage and off stage roles\n  const canRemoveRoleFromRoom =\n    permissions?.removeOthers && (on_stage_role === roleName || off_stage_roles?.includes(roleName));\n\n  if (\n    peerList.length === 0 ||\n    // if only local peer is present no need to show any options\n    (peerList.length === 1 && peerList[0].isLocal) ||\n    !role\n  ) {\n    return null;\n  }\n\n  const removeAllFromStage = () => {\n    peerList.forEach(peer => {\n      const prevRole = getMetadata(peer.metadata).prevRole;\n      if (prevRole) {\n        hmsActions.changeRoleOfPeer(peer.id, prevRole, true);\n      }\n    });\n  };\n\n  const removePeersFromRoom = async () => {\n    try {\n      peerList.forEach(async peer => {\n        await hmsActions.removePeer(peer.id, '');\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  return (\n    <DropdownWrapper>\n      {canRemoveRoleFromStage ? (\n        <Dropdown.Item\n          css={{ ...dropdownItemCSS, borderBottom: '1px solid $border_bright' }}\n          onClick={removeAllFromStage}\n        >\n          <PersonRectangleIcon />\n          <Text variant=\"sm\" css={optionTextCSS}>\n            Remove all from Stage\n          </Text>\n        </Dropdown.Item>\n      ) : null}\n\n      {match({ canPublishAudio, isAudioOnForSomePeers, canMute: permissions?.mute, canUnmute: permissions?.unmute })\n        .with({ canPublishAudio: true, isAudioOnForSomePeers: true, canMute: true }, () => {\n          return (\n            <Dropdown.Item css={dropdownItemCSS} onClick={() => setTrackEnabled('audio', false)}>\n              <MicOffIcon />\n              <Text variant=\"sm\" css={optionTextCSS}>\n                Mute Audio for All\n              </Text>\n            </Dropdown.Item>\n          );\n        })\n        .with({ canPublishAudio: true, isAudioOnForSomePeers: false, canUnmute: true }, () => {\n          return (\n            <Dropdown.Item css={dropdownItemCSS} onClick={() => setTrackEnabled('audio', true)}>\n              <MicOnIcon />\n              <Text variant=\"sm\" css={optionTextCSS}>\n                Request to Unmute Audio for All\n              </Text>\n            </Dropdown.Item>\n          );\n        })\n        .otherwise(() => null)}\n      {match({ canPublishVideo, isVideoOnForSomePeers, canMute: permissions?.mute, canUnmute: permissions?.unmute })\n        .with({ canPublishVideo: true, isVideoOnForSomePeers: true, canMute: true }, () => {\n          return (\n            <Dropdown.Item css={dropdownItemCSS} onClick={() => setTrackEnabled('video', false)}>\n              <VideoOffIcon />\n              <Text variant=\"sm\" css={optionTextCSS}>\n                Mute Video for All\n              </Text>\n            </Dropdown.Item>\n          );\n        })\n        .with({ canPublishVideo: true, isVideoOnForSomePeers: false, canUnmute: true }, () => {\n          return (\n            <Dropdown.Item css={dropdownItemCSS} onClick={() => setTrackEnabled('video', true)}>\n              <VideoOnIcon />\n              <Text variant=\"sm\" css={optionTextCSS}>\n                Request to Unmute Video for All\n              </Text>\n            </Dropdown.Item>\n          );\n        })\n        .otherwise(() => null)}\n\n      {canRemoveRoleFromRoom ? (\n        <Dropdown.Item\n          css={{ ...dropdownItemCSS, borderTop: '1px solid $border_bright', color: '$alert_error_default' }}\n          onClick={removePeersFromRoom}\n        >\n          <RemoveUserIcon />\n          <Text variant=\"sm\" css={{ ...optionTextCSS, color: 'inherit' }}>\n            Remove all from Room\n          </Text>\n        </Dropdown.Item>\n      ) : null}\n    </DropdownWrapper>\n  );\n};\n", "import { match, P } from 'ts-pattern';\nimport { HMSPeer, selectPermissions, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n\nexport const useGroupOnStageActions = ({ peers }: { peers: HMSPeer[] }) => {\n  const hmsActions = useHMSActions();\n  const { elements } = useRoomLayoutConferencingScreen();\n  const {\n    bring_to_stage_label,\n    remove_from_stage_label,\n    on_stage_role,\n    off_stage_roles = [],\n    skip_preview_for_role_change = false,\n  } = elements.on_stage_exp || {};\n  const canChangeRole = useHMSStore(selectPermissions)?.changeRole;\n\n  const offStageRolePeers = peers.filter(peer =>\n    match({ on_stage_role, bring_to_stage_label, roleName: peer.roleName })\n      .with(\n        {\n          on_stage_role: P.when(role => !!role),\n          bring_to_stage_label: P.when(label => !!label),\n          roleName: P.when(role => !!role && off_stage_roles.includes(role)),\n        },\n        () => true,\n      )\n      .otherwise(() => false),\n  );\n\n  const lowerAllHands = async () => {\n    return Promise.all(peers.map(peer => hmsActions.lowerRemotePeerHand(peer.id)));\n  };\n\n  const bringAllToStage = () => {\n    if (!canChangeRole || !on_stage_role) {\n      return;\n    }\n    return Promise.all(\n      offStageRolePeers.map(peer => {\n        return hmsActions.changeRoleOfPeer(peer.id, on_stage_role, skip_preview_for_role_change).then(() => {\n          return skip_preview_for_role_change ? hmsActions.lowerRemotePeerHand(peer.id) : null;\n        });\n      }),\n    );\n  };\n\n  return {\n    lowerAllHands,\n    bringAllToStage,\n    canBringToStage: canChangeRole && offStageRolePeers.length > 0,\n    bring_to_stage_label,\n    remove_from_stage_label,\n  };\n};\n", "import { useEffect } from 'react';\nimport { DefaultConferencingScreen_Elements } from '@100mslive/types-prebuilt';\nimport { selectAppData, useHMSStore } from '@100mslive/react-sdk';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore\nimport { useSidepaneReset } from './useSidepane';\nimport { APP_DATA, SidePaneOption } from '../../common/constants';\n\n// Closes the sidepane if an element is removed from the layout via the customiser\nexport const useSidepaneResetOnLayoutUpdate = (\n  layoutKey: keyof DefaultConferencingScreen_Elements,\n  sidepaneOption: SidePaneOption,\n) => {\n  const { elements } = useRoomLayoutConferencingScreen();\n  const sidepane = useHMSStore(selectAppData(APP_DATA.sidePane));\n  const resetSidePane = useSidepaneReset();\n  useEffect(() => {\n    if (sidepane === sidepaneOption && !elements?.[layoutKey]) {\n      resetSidePane();\n    }\n  }, [elements, elements?.[layoutKey], resetSidePane, sidepane, layoutKey, sidepaneOption]);\n};\n", "import { useState } from 'react';\nimport { selectPeerMetadata, selectPermissions, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n\nexport const usePeerOnStageActions = ({ peerId, role }: { peerId: string; role: string }) => {\n  const hmsActions = useHMSActions();\n  const { elements } = useRoomLayoutConferencingScreen();\n  const {\n    bring_to_stage_label,\n    remove_from_stage_label,\n    on_stage_role,\n    off_stage_roles = [],\n    skip_preview_for_role_change = false,\n  } = elements.on_stage_exp || {};\n  const isInStage = role === on_stage_role;\n  const canChangeRole = useHMSStore(selectPermissions)?.changeRole;\n  const shouldShowStageRoleChange =\n    canChangeRole &&\n    ((isInStage && remove_from_stage_label) || (off_stage_roles?.includes(role) && bring_to_stage_label));\n  const prevRole = useHMSStore(selectPeerMetadata(peerId))?.prevRole;\n  const [open, setOpen] = useState(false);\n\n  const lowerPeerHand = async () => {\n    await hmsActions.lowerRemotePeerHand(peerId);\n  };\n\n  const handleStageAction = async () => {\n    if (isInStage) {\n      prevRole && hmsActions.changeRoleOfPeer(peerId, prevRole, true);\n    } else if (on_stage_role) {\n      await hmsActions.changeRoleOfPeer(peerId, on_stage_role, skip_preview_for_role_change);\n      if (skip_preview_for_role_change) {\n        await lowerPeerHand();\n      }\n    }\n    setOpen(false);\n  };\n\n  return {\n    open,\n    setOpen,\n    lowerPeerHand,\n    handleStageAction,\n    shouldShowStageRoleChange,\n    isInStage,\n    bring_to_stage_label,\n    remove_from_stage_label,\n  };\n};\n", "import React, { useEffect } from 'react';\nimport { QuizActiveIcon, QuizIcon } from '@100mslive/react-icons';\nimport { Tooltip } from '../../..';\n// @ts-ignore: No implicit Any\nimport IconButton from '../../IconButton';\n// @ts-ignore: No implicit Any\nimport { useIsSidepaneTypeOpen, usePollViewToggle } from '../AppData/useSidepane';\nimport { useUnreadPollQuizPresent } from '../hooks/useUnreadPollQuizPresent';\n// @ts-ignore: No implicit Any\nimport { SIDE_PANE_OPTIONS } from '../../common/constants';\n\nexport const PollsToggle = () => {\n  const isPollsOpen = useIsSidepaneTypeOpen(SIDE_PANE_OPTIONS.POLLS);\n  const togglePollView = usePollViewToggle();\n  const { unreadPollQuiz, setUnreadPollQuiz } = useUnreadPollQuizPresent();\n\n  useEffect(() => {\n    if (unreadPollQuiz && isPollsOpen) {\n      setUnreadPollQuiz(false);\n    }\n  }, [isPollsOpen, unreadPollQuiz, setUnreadPollQuiz]);\n\n  return (\n    <Tooltip key=\"polls\" title={`${isPollsOpen ? 'Close' : 'Open'} polls and quizzes`}>\n      <IconButton\n        onClick={() => {\n          togglePollView();\n          setUnreadPollQuiz(false);\n        }}\n        css={{ bg: isPollsOpen ? '$surface_brighter' : '' }}\n        data-testid=\"polls_btn\"\n      >\n        {unreadPollQuiz ? <QuizActiveIcon /> : <QuizIcon />}\n      </IconButton>\n    </Tooltip>\n  );\n};\n", "import React from 'react';\nimport { selectPeerScreenSharing, useHMSStore, useWhiteboard } from '@100mslive/react-sdk';\nimport { PencilDrawIcon } from '@100mslive/react-icons';\nimport { Tooltip } from '../../..';\n// @ts-ignore: No implicit Any\nimport IconButton from '../../IconButton';\n// @ts-ignore: No implicit Any\nimport { ToastManager } from '../Toast/ToastManager';\n\nexport const WhiteboardToggle = () => {\n  const { toggle, open, isOwner } = useWhiteboard();\n  const peerSharing = useHMSStore(selectPeerScreenSharing);\n  const disabled = !!peerSharing || (open && !isOwner);\n\n  if (!toggle) {\n    return null;\n  }\n\n  return (\n    <Tooltip\n      key=\"whiteboard\"\n      title={\n        peerSharing ? 'Cannot open whiteboard when viewing a shared screen' : `${open ? 'Close' : 'Open'} Whiteboard`\n      }\n    >\n      <IconButton\n        onClick={async () => {\n          if (disabled) {\n            return;\n          }\n          try {\n            await toggle();\n          } catch (error) {\n            ToastManager.addToast({ title: (error as Error).message, variant: 'error' });\n          }\n        }}\n        active={!open}\n        disabled={disabled}\n        data-testid=\"whiteboard_btn\"\n      >\n        <PencilDrawIcon />\n      </IconButton>\n    </Tooltip>\n  );\n};\n", "import React, { useCallback, useState } from 'react';\nimport { selectHLSState, useHMSActions, useHMSStore, useRecordingStreaming } from '@100mslive/react-sdk';\nimport { Button } from '../../../Button';\nimport { Flex } from '../../../Layout';\nimport { Dialog } from '../../../Modal';\nimport { Text } from '../../../Text';\n// @ts-ignore: No implicit Any\nimport { useSetAppDataByKey } from '../AppData/useUISettings';\n// @ts-ignore: No implicit Any\nimport { APP_DATA } from '../../common/constants';\n\nexport function HLSFailureModal() {\n  const hlsError = useHMSStore(selectHLSState).error || false;\n  const [openModal, setOpenModal] = useState(!!hlsError);\n  const hmsActions = useHMSActions();\n  const { isRTMPRunning } = useRecordingStreaming();\n  const [isHLSStarted, setHLSStarted] = useSetAppDataByKey(APP_DATA.hlsStarted);\n  const startHLS = useCallback(async () => {\n    try {\n      if (isHLSStarted || isRTMPRunning) {\n        return;\n      }\n      setHLSStarted(true);\n      await hmsActions.startHLSStreaming({});\n    } catch (error) {\n      console.error(error);\n      setHLSStarted(false);\n    }\n  }, [hmsActions, isHLSStarted, setHLSStarted, isRTMPRunning]);\n\n  return hlsError ? (\n    <Dialog.Root\n      open={openModal}\n      onOpenChange={value => {\n        if (!value) {\n          setOpenModal(false);\n        }\n      }}\n    >\n      <Dialog.Portal>\n        <Dialog.Overlay />\n        <Dialog.Content css={{ w: 'min(360px, 90%)' }}>\n          <Dialog.Title\n            css={{\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'space-between',\n              borderBottom: '1px solid $border_default',\n              mt: '$4',\n            }}\n          >\n            <Text variant=\"h6\" css={{ fontWeight: '$semiBold' }}>\n              Failed to Go Live\n            </Text>\n          </Dialog.Title>\n          <Text variant=\"sm\" css={{ mb: '$10', color: '$on_surface_medium' }}>\n            Something went wrong and your live broadcast failed. Please try again.\n          </Text>\n          <Flex align=\"center\" justify=\"between\" css={{ w: '100%', gap: '$8' }}>\n            <Button outlined variant=\"standard\" css={{ w: '100%' }} onClick={() => setOpenModal(false)}>\n              Dismiss\n            </Button>\n            <Button css={{ w: '100%' }} onClick={startHLS}>\n              Go Live\n            </Button>\n          </Flex>\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  ) : null;\n}\n", "import React, { useEffect } from 'react';\nimport {\n  selectIsInPreview,\n  selectLocalPeerName,\n  selectLocalPeerRoleName,\n  selectRoleChangeRequest,\n  useCustomEvent,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { Flex, Text } from '../../..';\n// @ts-ignore: No implicit Any\nimport { PreviewControls, PreviewTile } from '../Preview/PreviewJoin';\nimport { RequestPrompt } from './RequestPrompt';\nimport { useRoomLayoutPreviewScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useMyMetadata } from '../hooks/useMetadata';\n// @ts-ignore: No implicit Any\nimport { ROLE_CHANGE_DECLINED } from '../../common/constants';\n\nexport const RoleChangeRequestModal = () => {\n  const hmsActions = useHMSActions();\n  const { updateMetaData } = useMyMetadata();\n  const isPreview = useHMSStore(selectIsInPreview);\n  const currentRole = useHMSStore(selectLocalPeerRoleName);\n  const roleChangeRequest = useHMSStore(selectRoleChangeRequest);\n  const name = useHMSStore(selectLocalPeerName);\n  const { sendEvent } = useCustomEvent({ type: ROLE_CHANGE_DECLINED });\n  const { elements = {} } = useRoomLayoutPreviewScreen();\n  const { virtual_background } = elements || {};\n\n  useEffect(() => {\n    if (!roleChangeRequest?.role) {\n      return;\n    }\n    (async () => {\n      await hmsActions.preview({ asRole: roleChangeRequest.role.name });\n    })();\n  }, [hmsActions, roleChangeRequest, currentRole, updateMetaData]);\n\n  if (!roleChangeRequest?.role) {\n    return null;\n  }\n\n  const body = (\n    <>\n      <Text\n        variant=\"xs\"\n        css={{\n          c: '$on_surface_medium',\n          textAlign: 'center',\n          '@md': { textAlign: 'left', borderBottom: '1px solid $border_bright', pb: '$4', px: '$8' },\n        }}\n      >\n        Setup your audio and video before joining\n      </Text>\n      <Flex\n        align=\"center\"\n        justify=\"center\"\n        css={{\n          '@sm': { width: '100%' },\n          flexDirection: 'column',\n          mt: '$6',\n          '@md': { px: '$8' },\n        }}\n      >\n        <PreviewTile name={name || ''} />\n\n        <PreviewControls hideSettings={true} vbEnabled={!!virtual_background} />\n      </Flex>\n    </>\n  );\n\n  return (\n    <RequestPrompt\n      title=\"You're invited to join the stage\"\n      onOpenChange={async value => {\n        if (!value) {\n          hmsActions.rejectChangeRole(roleChangeRequest);\n          sendEvent({ ...roleChangeRequest, peerName: name }, { peerId: roleChangeRequest.requestedBy?.id });\n          await hmsActions.cancelMidCallPreview();\n          await hmsActions.lowerLocalPeerHand();\n        }\n      }}\n      body={body}\n      onAction={async () => {\n        await hmsActions.acceptChangeRole(roleChangeRequest);\n        await updateMetaData({ prevRole: currentRole });\n        await hmsActions.lowerLocalPeerHand();\n      }}\n      actionText=\"Accept\"\n      disableActions={!isPreview}\n    />\n  );\n};\n", "import React, { Fragment, useCallback, useEffect, useMemo, useState } from 'react';\nimport { useMeasure, useMedia } from 'react-use';\nimport {\n  HMSRoomState,\n  selectAppData,\n  selectIsLocalVideoEnabled,\n  selectIsVBEnabled,\n  selectLocalPeer,\n  selectRoomState,\n  selectVideoTrackByID,\n  useAVToggle,\n  useAwayNotifications,\n  useHMSStore,\n  useParticipants,\n  usePreviewJoin,\n  useRecordingStreaming,\n} from '@100mslive/react-sdk';\nimport { MicOffIcon, SettingsIcon } from '@100mslive/react-icons';\nimport { Avatar, Box, config as cssConfig, Flex, flexCenter, styled, StyledVideoTile, Text, Video } from '../../..';\nimport { AudioLevel } from '../../../AudioLevel';\nimport { useHMSPrebuiltContext } from '../../AppContext';\nimport IconButton from '../../IconButton';\nimport SidePane from '../../layouts/SidePane';\nimport { AudioVideoToggle, NoiseCancellation } from '../AudioVideoToggle';\nimport Chip from '../Chip';\nimport TileConnection from '../Connection/TileConnection';\nimport FullPageProgress from '../FullPageProgress';\n// @ts-ignore: No implicit Any\nimport { Logo } from '../Header/HeaderComponents';\n// @ts-ignore: No implicit Any\nimport SettingsModal from '../Settings/SettingsModal';\nimport { VBToggle } from '../VirtualBackground/VBToggle';\nimport PreviewForm from './PreviewForm';\nimport { useRoomLayoutPreviewScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport {\n  useAuthToken,\n  useUISettings,\n  // @ts-ignore: No implicit Any\n} from '../AppData/useUISettings';\n// @ts-ignore: No implicit Any\nimport { defaultPreviewPreference, UserPreferencesKeys, useUserPreferences } from '../hooks/useUserPreferences';\n// @ts-ignore: No implicit Any\nimport { calculateAvatarAndAttribBoxSize, getFormattedCount } from '../../common/utils';\nimport { APP_DATA, UI_SETTINGS } from '../../common/constants';\n\nconst getParticipantChipContent = (peerCount = 0) => {\n  if (peerCount === 0) {\n    return 'You are the first to join';\n  }\n  const formattedNum = getFormattedCount(peerCount);\n  return `${formattedNum} other${parseInt(formattedNum) === 1 ? '' : 's'} in the session`;\n};\n\nconst useLocalTileAspectRatio = () => {\n  const localPeer = useHMSStore(selectLocalPeer);\n  const videoTrack = useHMSStore(selectVideoTrackByID(localPeer?.videoTrack));\n  const isMobile = useMedia(cssConfig.media.md);\n  let aspectRatio = 0;\n  if (videoTrack?.width && videoTrack?.height) {\n    aspectRatio = videoTrack.width / videoTrack.height;\n  } else {\n    aspectRatio = isMobile ? 9 / 16 : 16 / 9;\n  }\n  return aspectRatio;\n};\n\nconst PreviewJoin = ({\n  skipPreview,\n  initialName,\n  asRole,\n}: {\n  skipPreview?: boolean;\n  initialName?: string;\n  asRole?: string;\n}) => {\n  const [previewPreference, setPreviewPreference] = useUserPreferences(\n    UserPreferencesKeys.PREVIEW,\n    defaultPreviewPreference,\n  );\n  const { isStreamingOn } = useRecordingStreaming();\n  const authToken = useAuthToken();\n  const [name, setName] = useState(initialName || previewPreference.name);\n  const { toggleAudio, toggleVideo } = useAVToggle();\n  const [previewError, setPreviewError] = useState(false);\n  const { endpoints } = useHMSPrebuiltContext();\n  const { peerCount } = useParticipants();\n  const loadingEffects = useHMSStore(selectAppData(APP_DATA.loadingEffects));\n  const { enableJoin, preview, join } = usePreviewJoin({\n    name,\n    token: authToken,\n    initEndpoint: endpoints?.init,\n    initialSettings: {\n      isAudioMuted: skipPreview || previewPreference.isAudioMuted,\n      isVideoMuted: skipPreview || previewPreference.isVideoMuted,\n      speakerAutoSelectionBlacklist: ['Yeti Stereo Microphone'],\n    },\n    captureNetworkQualityInPreview: true,\n    handleError: (_, method) => {\n      if (method === 'preview') {\n        setPreviewError(true);\n      }\n    },\n    asRole,\n  });\n  const { requestPermission } = useAwayNotifications();\n  const roomState = useHMSStore(selectRoomState);\n  const savePreferenceAndJoin = useCallback(() => {\n    setPreviewPreference({\n      name,\n    });\n    join();\n  }, [join, name, setPreviewPreference]);\n  const { elements = {} } = useRoomLayoutPreviewScreen();\n  const { preview_header: previewHeader = {}, virtual_background } = elements || {};\n  const aspectRatio = useLocalTileAspectRatio();\n  useEffect(() => {\n    if (authToken) {\n      if (skipPreview) {\n        savePreferenceAndJoin();\n      } else {\n        preview().then(() => requestPermission());\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [authToken, skipPreview]);\n\n  useEffect(() => {\n    if (initialName) {\n      setName(initialName);\n    }\n  }, [initialName]);\n\n  return roomState === HMSRoomState.Preview ? (\n    <Flex justify=\"center\" css={{ size: '100%', position: 'relative' }}>\n      <Container css={{ h: '100%', pt: '$6', '@md': { justifyContent: 'space-between', pt: '$10' } }}>\n        {toggleVideo ? null : <Box />}\n        <Flex direction=\"column\" justify=\"center\" css={{ w: '100%', maxWidth: '600px', gap: '$8' }}>\n          <Logo />\n          <Text variant=\"h4\" css={{ wordBreak: 'break-word', textAlign: 'center' }}>\n            {previewHeader.title}\n          </Text>\n          <Text\n            css={{ c: '$on_surface_medium', textAlign: 'center', maxWidth: '100%', wordWrap: 'break-word' }}\n            variant=\"sm\"\n          >\n            {previewHeader.sub_title}\n          </Text>\n          <Flex justify=\"center\" css={{ gap: '$4' }}>\n            {isStreamingOn ? (\n              <Chip\n                content=\"LIVE\"\n                backgroundColor=\"$alert_error_default\"\n                textColor=\"#FFF\"\n                icon={<Box css={{ h: '$sm', w: '$sm', backgroundColor: '$on_primary_high', borderRadius: '$round' }} />}\n              />\n            ) : null}\n            <Chip content={getParticipantChipContent(peerCount)} hideIfNoContent />\n          </Flex>\n        </Flex>\n        {toggleVideo ? <PreviewTile name={name} error={previewError} /> : null}\n        <Box css={{ w: '100%', maxWidth: `${Math.max(aspectRatio, 1) * 340}px` }}>\n          <PreviewControls hideSettings={!toggleVideo && !toggleAudio} vbEnabled={!!virtual_background} />\n          <PreviewForm\n            name={name}\n            disabled={!!initialName}\n            onChange={setName}\n            enableJoin={enableJoin && !loadingEffects}\n            onJoin={savePreferenceAndJoin}\n            cannotPublishVideo={!toggleVideo}\n            cannotPublishAudio={!toggleAudio}\n          />\n        </Box>\n      </Container>\n      <Box css={{ position: 'absolute', right: '0', top: 0, height: '100%', overflow: 'hidden' }}>\n        <SidePane />\n      </Box>\n    </Flex>\n  ) : (\n    <FullPageProgress />\n  );\n};\n\nconst Container = styled('div', {\n  width: '100%',\n  ...flexCenter,\n  flexDirection: 'column',\n  px: '$10',\n});\n\nexport const PreviewTile = ({ name, error }: { name: string; error?: boolean }) => {\n  const localPeer = useHMSStore(selectLocalPeer);\n  const { isLocalAudioEnabled, toggleAudio } = useAVToggle();\n  const isVideoOn = useHMSStore(selectIsLocalVideoEnabled);\n  const mirrorLocalVideo = useUISettings(UI_SETTINGS.mirrorLocalVideo);\n  const trackSelector = selectVideoTrackByID(localPeer?.videoTrack);\n  const track = useHMSStore(trackSelector);\n  const showMuteIcon = !isLocalAudioEnabled || !toggleAudio;\n  const aspectRatio = useLocalTileAspectRatio();\n  const [ref, { width: calculatedWidth, height: calculatedHeight }] = useMeasure<HTMLDivElement>();\n  const [avatarSize, attribBoxSize] = useMemo(\n    () => calculateAvatarAndAttribBoxSize(calculatedWidth, calculatedHeight),\n    [calculatedWidth, calculatedHeight],\n  );\n\n  return (\n    <StyledVideoTile.Container\n      ref={ref}\n      css={{\n        bg: '$surface_default',\n        aspectRatio,\n        height: 'min(340px, 70vh)',\n        width: 'auto',\n        maxWidth: '600px',\n        overflow: 'clip',\n        mt: '$10',\n        '@md': {\n          mt: 0,\n          width: 'min(220px, 70vw)',\n          maxWidth: '100%',\n          my: '$4',\n        },\n      }}\n    >\n      {localPeer ? (\n        <>\n          <TileConnection name=\"\" peerId={localPeer.id} hideLabel={false} />\n          <Video\n            mirror={track?.facingMode !== 'environment' && mirrorLocalVideo}\n            trackId={localPeer.videoTrack}\n            data-testid=\"preview_tile\"\n          />\n\n          {!isVideoOn ? (\n            <StyledVideoTile.AvatarContainer>\n              <Avatar name={name} data-testid=\"preview_avatar_tile\" size={avatarSize} />\n            </StyledVideoTile.AvatarContainer>\n          ) : null}\n        </>\n      ) : null}\n      {!localPeer && !error ? <FullPageProgress /> : null}\n\n      {showMuteIcon ? (\n        <StyledVideoTile.AudioIndicator size={attribBoxSize}>\n          <MicOffIcon />\n        </StyledVideoTile.AudioIndicator>\n      ) : (\n        <StyledVideoTile.AudioIndicator size={attribBoxSize}>\n          <AudioLevel trackId={localPeer?.audioTrack} />\n        </StyledVideoTile.AudioIndicator>\n      )}\n    </StyledVideoTile.Container>\n  );\n};\n\nexport const PreviewControls = ({ hideSettings, vbEnabled }: { hideSettings: boolean; vbEnabled: boolean }) => {\n  const isMobile = useMedia(cssConfig.media.md);\n  const isVBEnabledForUser = useHMSStore(selectIsVBEnabled);\n  return (\n    <Flex\n      justify={hideSettings && isMobile ? 'center' : 'between'}\n      css={{\n        width: '100%',\n        mt: '$6',\n      }}\n    >\n      <Flex css={{ gap: '$4' }}>\n        <AudioVideoToggle />\n        {vbEnabled && isVBEnabledForUser ? <VBToggle /> : null}\n      </Flex>\n      <Flex align=\"center\" gap=\"1\">\n        {isMobile && <NoiseCancellation iconOnly />}\n        {!hideSettings ? <PreviewSettings /> : null}\n      </Flex>\n    </Flex>\n  );\n};\n\nexport const PreviewSettings = React.memo(() => {\n  const [open, setOpen] = useState(false);\n\n  return (\n    <Fragment>\n      <IconButton data-testid=\"preview_setting_btn\" css={{ flexShrink: 0 }} onClick={() => setOpen(value => !value)}>\n        <SettingsIcon />\n      </IconButton>\n      {open && <SettingsModal open={open} onOpenChange={setOpen} />}\n    </Fragment>\n  );\n});\n\nexport default PreviewJoin;\n", "import React, { useEffect } from 'react';\nimport { useMedia } from 'react-use';\nimport { match } from 'ts-pattern';\nimport { selectAppData, selectVideoTrackByPeerID, useHMSStore } from '@100mslive/react-sdk';\nimport { Polls } from '../components/Polls/Polls';\nimport { RoomDetailsPane } from '../components/RoomDetails/RoomDetailsPane';\nimport { LayoutMode } from '../components/Settings/LayoutSettings';\nimport { SidePaneTabs } from '../components/SidePaneTabs';\nimport { TileCustomisationProps } from '../components/VideoLayouts/GridLayout';\nimport VideoTile from '../components/VideoTile';\nimport { VBPicker } from '../components/VirtualBackground/VBPicker';\nimport { Flex } from '../../Layout';\nimport { config as cssConfig, styled } from '../../Theme';\n// @ts-ignore: No implicit Any\nimport { useSidepaneReset } from '../components/AppData/useSidepane';\n// @ts-ignore: No implicit Any\nimport { useUISettings } from '../components/AppData/useUISettings';\nimport {\n  useRoomLayoutConferencingScreen,\n  useRoomLayoutPreviewScreen,\n} from '../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useLandscapeHLSStream, useMobileHLSStream } from '../common/hooks';\nimport { translateAcross } from '../../utils';\nimport { APP_DATA, SIDE_PANE_OPTIONS, UI_SETTINGS } from '../common/constants';\n\nconst Wrapper = styled('div', {\n  w: '$100',\n  h: '100%',\n  p: '$10',\n  flex: '1 1 0',\n  background: '$surface_dim',\n  r: '$1',\n  position: 'relative',\n  '@lg': {\n    w: '100%',\n    h: '100%',\n    ml: 0,\n    right: 0,\n    position: 'fixed',\n    bottom: 0,\n    borderRadius: 0,\n    zIndex: 10,\n  },\n  '@md': {\n    p: '$6 $8',\n    animation: `${translateAcross({ yFrom: '100%' })} 150ms cubic-bezier(0.22, 1, 0.36, 1)`,\n  },\n  variants: {\n    landscapeStream: {\n      true: {\n        '@lg': {\n          position: 'unset',\n          minHeight: '100%',\n        },\n      },\n    },\n    mobileStream: {\n      true: {\n        '@md': {\n          position: 'unset',\n        },\n      },\n    },\n    overlayChat: {\n      true: {\n        '@lg': {\n          maxHeight: '300px',\n          background: 'linear-gradient(180deg, rgba(0, 0, 0, 0.00) 35.94%, rgba(0, 0, 0, 0.64) 100%)',\n          position: 'fixed',\n          zIndex: 12,\n          bottom: 0,\n        },\n      },\n    },\n    roomDescription: {\n      true: {\n        overflowY: 'auto',\n      },\n    },\n    hideControls: {\n      true: {},\n    },\n    virtualBackground: {\n      true: {\n        maxHeight: '100%',\n        background: '$surface_dim',\n      },\n    },\n  },\n  compoundVariants: [\n    {\n      landscapeStream: true,\n      overlayChat: true,\n      css: {\n        position: 'unset',\n        height: '100%',\n        maxHeight: 'unset',\n        '@md': {\n          pb: 0,\n        },\n      },\n    },\n    {\n      mobileStream: true,\n      overlayChat: true,\n      css: {\n        position: 'unset',\n        height: '100%',\n        maxHeight: 'unset',\n      },\n    },\n    {\n      hideControls: false,\n      overlayChat: true,\n      css: {\n        pb: '$17',\n      },\n    },\n  ],\n});\n\nconst SidePane = ({\n  tileProps,\n  hideControls = false,\n}: {\n  tileProps?: TileCustomisationProps;\n  hideControls?: boolean;\n}) => {\n  const isMobile = useMedia(cssConfig.media.md);\n  const sidepane = useHMSStore(selectAppData(APP_DATA.sidePane));\n  const activeScreensharePeerId = useHMSStore(selectAppData(APP_DATA.activeScreensharePeerId));\n  const trackId = useHMSStore(selectVideoTrackByPeerID(activeScreensharePeerId))?.id;\n  const { elements } = useRoomLayoutConferencingScreen();\n  const { elements: preview_elements } = useRoomLayoutPreviewScreen();\n  const layoutMode = useUISettings(UI_SETTINGS.layoutMode);\n\n  const isLandscapeHLSStream = useLandscapeHLSStream();\n  const isMobileHLSStream = useMobileHLSStream();\n\n  const backgroundMedia = preview_elements?.virtual_background?.background_media?.length\n    ? preview_elements?.virtual_background?.background_media\n    : elements?.virtual_background?.background_media || [];\n\n  const tileLayout = {\n    hideParticipantNameOnTile: tileProps?.hide_participant_name_on_tile,\n    roundedVideoTile: tileProps?.rounded_video_tile,\n    hideAudioMuteOnTile: tileProps?.hide_audio_mute_on_tile,\n    hideMetadataOnTile: tileProps?.hide_metadata_on_tile,\n    objectFit: tileProps?.video_object_fit,\n  };\n  const mwebStreamingChat = isMobile && sidepane === SIDE_PANE_OPTIONS.CHAT && elements?.chat?.is_overlay;\n  const commonProps = {\n    landscapeStream: isLandscapeHLSStream,\n    mobileStream: isMobileHLSStream,\n    hideControls,\n    overlayChat: !!elements?.chat?.is_overlay,\n    roomDescription: sidepane === SIDE_PANE_OPTIONS.ROOM_DETAILS,\n    virtualBackground: sidepane === SIDE_PANE_OPTIONS.VB,\n  };\n\n  const SidepaneComponent = match(sidepane)\n    .with(SIDE_PANE_OPTIONS.POLLS, () => (\n      <Wrapper\n        css={{\n          '@md': {\n            borderTopLeftRadius: '$2',\n            borderTopRightRadius: '$2',\n          },\n        }}\n        {...commonProps}\n      >\n        <Polls />\n      </Wrapper>\n    ))\n    .with(SIDE_PANE_OPTIONS.VB, () => (\n      <Wrapper css={{ p: '$10 $6 $10 $10' }} {...commonProps}>\n        <VBPicker backgroundMedia={backgroundMedia} />\n      </Wrapper>\n    ))\n    .with(SIDE_PANE_OPTIONS.CHAT, SIDE_PANE_OPTIONS.PARTICIPANTS, () => (\n      <Wrapper {...commonProps} overlayChat={mwebStreamingChat}>\n        <SidePaneTabs active={sidepane} hideTab={isMobileHLSStream || isLandscapeHLSStream} />\n      </Wrapper>\n    ))\n    .with(SIDE_PANE_OPTIONS.ROOM_DETAILS, () => (\n      <Wrapper {...commonProps}>\n        <RoomDetailsPane />\n      </Wrapper>\n    ))\n    .otherwise(() => {\n      return null;\n    });\n\n  const resetSidePane = useSidepaneReset();\n\n  useEffect(() => {\n    return () => {\n      resetSidePane();\n    };\n  }, [resetSidePane]);\n\n  if (!SidepaneComponent && !trackId) {\n    return null;\n  }\n\n  return (\n    <Flex\n      direction=\"column\"\n      justify=\"center\"\n      css={{\n        w: match({ isMobileHLSStream, isLandscapeHLSStream })\n          .with({ isLandscapeHLSStream: true }, () => '340px')\n          .with({ isMobileHLSStream: true }, () => '100%')\n          .otherwise(() => '$100'),\n        h: '100%',\n        flexShrink: 0,\n        gap: '$4',\n        position: 'relative',\n        '&:empty': { display: 'none' },\n        '@md': {\n          position: 'absolute',\n          zIndex: 12,\n        },\n      }}\n    >\n      {trackId && layoutMode === LayoutMode.GALLERY && (\n        <VideoTile\n          peerId={activeScreensharePeerId}\n          trackId={trackId}\n          width=\"100%\"\n          height={225}\n          rootCSS={{ p: 0, alignSelf: 'start', flexShrink: 0 }}\n          {...tileLayout}\n        />\n      )}\n      {SidepaneComponent}\n    </Flex>\n  );\n};\n\nexport default SidePane;\n", "import React from 'react';\n// @ts-ignore: No implicit Any\nimport { PollsQuizMenu } from './CreatePollQuiz/PollsQuizMenu';\n// @ts-ignore: No implicit Any\nimport { CreateQuestions } from './CreateQuestions/CreateQuestions';\nimport { LeaderboardSummary } from './Voting/LeaderboardSummary';\n// @ts-ignore: No implicit Any\nimport { Voting } from './Voting/Voting';\n// @ts-ignore: No implicit Any\nimport { usePollViewToggle } from '../AppData/useSidepane';\n// @ts-ignore: No implicit Any\nimport { usePollViewState } from '../AppData/useUISettings';\n// @ts-ignore: No implicit Any\nimport { POLL_VIEWS } from '../../common/constants';\n\nexport const Polls = () => {\n  const togglePollView = usePollViewToggle();\n  const { pollInView: pollID, view } = usePollViewState();\n\n  if (view === POLL_VIEWS.CREATE_POLL_QUIZ) {\n    return <PollsQuizMenu />;\n  } else if (view === POLL_VIEWS.CREATE_QUESTIONS) {\n    return <CreateQuestions />;\n  } else if (view === POLL_VIEWS.VOTE) {\n    return <Voting toggleVoting={togglePollView} id={pollID} />;\n  } else if (view === POLL_VIEWS.RESULTS) {\n    return <LeaderboardSummary pollID={pollID} />;\n  } else {\n    return null;\n  }\n};\n", "import React, { useEffect, useMemo, useRef, useState } from 'react';\nimport {\n  HMSPollState,\n  selectLocalPeerRoleName,\n  selectPermissions,\n  selectPolls,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { QuestionIcon, StatsIcon } from '@100mslive/react-icons';\nimport { Button, Flex, Input, Switch, Text } from '../../../..';\n// @ts-ignore\nimport { Container, ContentHeader, ErrorText } from '../../Streaming/Common';\n// @ts-ignore\nimport { usePollViewToggle } from '../../AppData/useSidepane';\n// @ts-ignore\nimport { usePollViewState } from '../../AppData/useUISettings';\n// @ts-ignore\nimport { isValidTextInput } from '../../../common/utils';\nimport { StatusIndicator } from '../common/StatusIndicator';\nimport { INTERACTION_TYPE, POLL_STATE, POLL_VIEWS } from '../../../common/constants';\n\nexport const PollsQuizMenu = () => {\n  const togglePollView = usePollViewToggle();\n  const permissions = useHMSStore(selectPermissions);\n\n  return (\n    <Container rounded>\n      <ContentHeader content=\"Polls and Quizzes\" onClose={togglePollView} />\n      <Flex direction=\"column\" css={{ px: '$10', pb: '$10', overflowY: 'auto' }}>\n        {permissions?.pollWrite && <AddMenu />}\n        <PrevMenu />\n      </Flex>\n    </Container>\n  );\n};\n\nfunction InteractionSelectionCard({\n  title,\n  icon,\n  active,\n  onClick,\n}: {\n  title: string;\n  icon: React.JSX.Element;\n  active: boolean;\n  onClick: () => void;\n}) {\n  const activeBorderStyle = active ? '$space$px solid $primary_default' : '$space$px solid $border_bright';\n  return (\n    <Flex\n      onClick={onClick}\n      css={{\n        border: activeBorderStyle,\n        p: '$4',\n        r: '$2',\n        w: '100%',\n        cursor: 'pointer',\n      }}\n      align=\"center\"\n    >\n      <Flex\n        css={{\n          border: activeBorderStyle,\n          p: '$4',\n          bg: '$surface_bright',\n          c: '$on_surface_high',\n          r: '$0',\n        }}\n      >\n        {icon}\n      </Flex>\n      <Text variant=\"sub1\" css={{ ml: '$md' }}>\n        {title}\n      </Text>\n    </Flex>\n  );\n}\n\nconst AddMenu = () => {\n  const actions = useHMSActions();\n  const [title, setTitle] = useState('');\n  const localPeerRoleName = useHMSStore(selectLocalPeerRoleName);\n  const [hideVoteCount, setHideVoteCount] = useState(false);\n  const [error, setError] = useState();\n  const [titleError, setTitleError] = useState('');\n  const { setPollState } = usePollViewState();\n  const [interactionType, setInteractionType] = useState(INTERACTION_TYPE.POLL);\n\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.focus();\n    }\n  }, [interactionType]);\n\n  const handleCreate = (id: string) => {\n    setPollState({\n      [POLL_STATE.pollInView]: id,\n      [POLL_STATE.view]: POLL_VIEWS.CREATE_QUESTIONS,\n    });\n  };\n\n  const validateTitle = useMemo(() => {\n    if (!isValidTextInput(title)) {\n      if (title) {\n        setTitleError('The title should have between 2-100 characters');\n      }\n      return true;\n    } else {\n      setTitleError('');\n      return false;\n    }\n  }, [title]);\n\n  return (\n    <>\n      <Text variant=\"caption\" css={{ c: '$on_surface_medium', mb: '$md' }}>\n        Select the type you want to continue with\n      </Text>\n      <Flex css={{ w: '100%', gap: '$10', mb: '$md' }}>\n        <InteractionSelectionCard\n          title={INTERACTION_TYPE.POLL}\n          icon={<StatsIcon width={32} height={32} />}\n          onClick={() => setInteractionType(INTERACTION_TYPE.POLL)}\n          active={interactionType === INTERACTION_TYPE.POLL}\n        />\n        <InteractionSelectionCard\n          title={INTERACTION_TYPE.QUIZ}\n          icon={<QuestionIcon width={32} height={32} />}\n          onClick={() => setInteractionType(INTERACTION_TYPE.QUIZ)}\n          active={interactionType === INTERACTION_TYPE.QUIZ}\n        />\n      </Flex>\n      <Flex direction=\"column\" css={{ mb: '$10' }}>\n        <Text variant=\"body2\" css={{ mb: '$4' }}>{`Name this ${interactionType.toLowerCase()}`}</Text>\n        <Input\n          ref={inputRef}\n          type=\"text\"\n          placeholder=\"Enter a name to continue\"\n          value={title}\n          onChange={event => setTitle(event.target.value.trimStart())}\n          css={{\n            backgroundColor: '$surface_bright',\n            border: '1px solid $border_default',\n          }}\n        />\n        <Flex align=\"center\" css={{ mt: '$10' }}>\n          <Switch onCheckedChange={value => setHideVoteCount(value)} css={{ mr: '$6' }} />\n          <Text variant=\"body2\" css={{ c: '$on_surface_medium' }}>\n            Hide Vote Count\n          </Text>\n        </Flex>\n\n        <Button\n          variant=\"primary\"\n          disabled={validateTitle}\n          css={{ mt: '$10' }}\n          onClick={async () => {\n            const id = Date.now().toString();\n            await actions.interactivityCenter\n              .createPoll({\n                id,\n                title,\n                anonymous: false,\n                rolesThatCanViewResponses: hideVoteCount && localPeerRoleName ? [localPeerRoleName] : undefined,\n                // @ts-ignore\n                type: interactionType.toLowerCase(),\n              })\n              .then(() => handleCreate(id))\n              .catch(err => setError(err.message));\n          }}\n        >\n          Create {interactionType}\n        </Button>\n        <ErrorText error={error || titleError} />\n      </Flex>\n    </>\n  );\n};\n\nconst PrevMenu = () => {\n  const hmsActions = useHMSActions();\n  const polls = useHMSStore(selectPolls);\n  const sortedPolls = useMemo(\n    () =>\n      polls\n        ?.sort((a, b) => (b?.createdAt?.getTime?.() || 0) - (a?.createdAt?.getTime?.() || 0))\n        ?.sort((a, b) => (b?.state === 'started' ? 1 : 0) - (a?.state === 'started' ? 1 : 0)),\n    [polls],\n  );\n  const permissions = useHMSStore(selectPermissions);\n\n  useEffect(() => {\n    const updatePolls = async () => {\n      await hmsActions.interactivityCenter.getPolls();\n    };\n    updatePolls();\n  }, [hmsActions.interactivityCenter]);\n\n  return polls?.length ? (\n    <Flex\n      direction=\"column\"\n      css={{\n        width: '100%',\n        ...(permissions?.pollWrite ? { borderTop: '$space$px solid $border_bright', paddingTop: '$10' } : {}),\n      }}\n    >\n      <Text variant=\"h6\" css={{ c: '$on_surface_high' }}>\n        Previous Polls and Quizzes\n      </Text>\n      <Flex direction=\"column\" css={{ gap: '$10', mt: '$8' }}>\n        {sortedPolls?.map(poll => (\n          <InteractionCard key={poll.id} id={poll.id} title={poll.title} status={poll.state} />\n        ))}\n      </Flex>\n    </Flex>\n  ) : null;\n};\n\nconst InteractionCard = ({ id, title, status }: { id: string; title: string; status?: HMSPollState }) => {\n  const { setPollState } = usePollViewState();\n\n  return (\n    <Flex direction=\"column\" css={{ backgroundColor: '$surface_bright', borderRadius: '$1', p: '$8' }}>\n      <Flex css={{ w: '100%', justifyContent: 'space-between', mb: '$sm' }}>\n        <Text variant=\"sub1\" css={{ c: '$on_surface_high', fontWeight: '$semiBold' }}>\n          {title}\n        </Text>\n        <StatusIndicator status={status} />\n      </Flex>\n      <Flex css={{ w: '100%', gap: '$4' }} justify=\"end\">\n        <Button\n          variant=\"primary\"\n          onClick={() =>\n            setPollState({\n              [POLL_STATE.pollInView]: id,\n              [POLL_STATE.view]: status === 'created' ? POLL_VIEWS.CREATE_QUESTIONS : POLL_VIEWS.VOTE,\n            })\n          }\n        >\n          View\n        </Button>\n      </Flex>\n    </Flex>\n  );\n};\n", "import React from 'react';\nimport { selectPermissions, useHMSStore } from '@100mslive/react-sdk';\nimport { ChevronLeftIcon, ChevronRightIcon, CrossIcon, RecordIcon } from '@100mslive/react-icons';\nimport { Box, Flex, IconButton, slideLeftAndFade, Switch, Text } from '../../../';\n\nexport const StreamCard = ({ title, subtitle, Icon, imgSrc = '', css = {}, onClick, testId }) => {\n  return (\n    <Flex\n      css={{\n        w: '100%',\n        p: '$10',\n        r: '$1',\n        cursor: 'pointer',\n        bg: '$surface_bright',\n        mb: '$10',\n        mt: '$8',\n        ...css,\n      }}\n      data-testid={testId}\n      onClick={onClick}\n    >\n      <Text css={{ alignSelf: 'center', p: '$4' }}>\n        {imgSrc ? <img src={imgSrc} height={40} width={40} alt=\"Streaming\" /> : <Icon width={40} height={40} />}\n      </Text>\n      <Box css={{ flex: '1 1 0', mx: '$8' }}>\n        <Text variant=\"h6\" css={{ mb: '$4' }}>\n          {title}\n        </Text>\n        <Text variant=\"sm\" css={{ color: '$on_surface_medium' }}>\n          {subtitle}\n        </Text>\n      </Box>\n      <Text css={{ alignSelf: 'center' }}>\n        <ChevronRightIcon />\n      </Text>\n    </Flex>\n  );\n};\n\nexport const ContentHeader = ({ onBack, onClose, title = '', content }) => {\n  return (\n    <Flex\n      css={{ w: '100%', py: '$8', px: '$10', cursor: 'pointer', borderBottom: '1px solid $border_bright', mb: '$8' }}\n    >\n      {onBack ? (\n        <Flex\n          align=\"center\"\n          css={{\n            mr: '$8',\n            color: '$on_surface_high',\n          }}\n          onClick={onBack}\n          data-testid=\"go_back\"\n        >\n          <ChevronLeftIcon />\n        </Flex>\n      ) : null}\n      <Box css={{ flex: '1 1 0', display: 'flex', alignItems: 'center' }}>\n        {title ? (\n          <Text\n            variant=\"tiny\"\n            css={{\n              textTransform: 'uppercase',\n              fontWeight: '$semiBold',\n              color: '$on_surface_medium',\n            }}\n          >\n            {title}\n          </Text>\n        ) : null}\n        <Text variant=\"h6\">{content}</Text>\n      </Box>\n      {onClose ? (\n        <IconButton onClick={onClose} css={{ alignSelf: 'flex-start' }} data-testid=\"close_stream_section\">\n          <CrossIcon />\n        </IconButton>\n      ) : null}\n    </Flex>\n  );\n};\nexport const Container = ({ children, rounded = false }) => {\n  return (\n    <Box\n      css={{\n        size: '100%',\n        zIndex: 2,\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        bg: '$surface_dim',\n        transform: 'translateX(10%)',\n        animation: `${slideLeftAndFade('10%')} 100ms ease-out forwards`,\n        display: 'flex',\n        flexDirection: 'column',\n        borderRadius: rounded ? '$2' : '0',\n      }}\n    >\n      {children}\n    </Box>\n  );\n};\n\nexport const ContentBody = ({ Icon, title, removeVerticalPadding = false, children }) => {\n  return (\n    <Box css={{ p: removeVerticalPadding ? '$0 $10' : '$10' }}>\n      <Text css={{ display: 'flex', alignItems: 'center', mb: '$4' }}>\n        <Icon />\n        <Text as=\"span\" css={{ fontWeight: '$semiBold', ml: '$4' }}>\n          {title}\n        </Text>\n      </Text>\n      <Text variant=\"sm\" css={{ color: '$on_surface_medium' }}>\n        {children}\n      </Text>\n    </Box>\n  );\n};\n\nexport const RecordStream = ({ record, setRecord, testId }) => {\n  const permissions = useHMSStore(selectPermissions);\n  return permissions?.browserRecording ? (\n    <Flex align=\"center\" css={{ bg: '$surface_bright', m: '$8 $10', p: '$8', r: '$0' }}>\n      <Text css={{ color: '$alert_error_default' }}>\n        <RecordIcon />\n      </Text>\n      <Text variant=\"sm\" css={{ flex: '1 1 0', mx: '$8' }}>\n        Record the stream\n      </Text>\n      <Switch checked={record} onCheckedChange={setRecord} data-testid={testId} />\n    </Flex>\n  ) : null;\n};\n\nexport const ErrorText = ({ error }) => {\n  if (!error) {\n    return null;\n  }\n  return (\n    <Text variant=\"sm\" css={{ my: '$4', color: '$alert_error_default' }}>\n      {error}\n    </Text>\n  );\n};\n", "import React from 'react';\nimport { HMSPollState } from '@100mslive/react-sdk';\nimport { Flex, Text } from '../../../../';\nimport { PollStage } from './constants';\n\nconst statusMap: Record<HMSPollState, PollStage> = {\n  created: PollStage.DRAFT,\n  started: PollStage.LIVE,\n  stopped: PollStage.ENDED,\n};\n\nexport const StatusIndicator = ({ status }: { status?: HMSPollState }) => {\n  if (!status) return null;\n  return (\n    <Flex align=\"center\">\n      <Flex\n        css={{\n          backgroundColor: statusMap[status] === PollStage.LIVE ? '$alert_error_default' : '$secondary_default',\n          p: '$2 $4',\n          borderRadius: '$0',\n        }}\n      >\n        <Text\n          variant=\"caption\"\n          css={{\n            fontWeight: '$semiBold',\n            color: '$on_primary_high',\n          }}\n        >\n          {statusMap[status]}\n        </Text>\n      </Flex>\n    </Flex>\n  );\n};\n", "// @ts-check\nimport React, { useMemo, useState } from 'react';\nimport { v4 as uuid } from 'uuid';\nimport { selectPollByID, useHMSActions, useHMSStore, useRecordingStreaming } from '@100mslive/react-sdk';\nimport { AddCircleIcon } from '@100mslive/react-icons';\nimport { Button, Flex, Text } from '../../../../';\nimport { Container, ContentHeader } from '../../Streaming/Common';\nimport { isValidQuestion, QuestionForm } from './QuestionForm';\nimport { SavedQuestion } from './SavedQuestion';\nimport { usePollViewToggle } from '../../AppData/useSidepane';\nimport { usePollViewState } from '../../AppData/useUISettings';\nimport { POLL_VIEWS } from '../../../common/constants';\n\nconst getEditableFormat = questions => {\n  const editableQuestions = questions.map(question => {\n    return { ...question, saved: true, draftID: uuid() };\n  });\n  return editableQuestions;\n};\n\nexport function CreateQuestions() {\n  const actions = useHMSActions();\n  const { isHLSRunning } = useRecordingStreaming();\n  const togglePollView = usePollViewToggle();\n  const { pollInView: id, setPollView } = usePollViewState();\n  const interaction = useHMSStore(selectPollByID(id));\n  const [questions, setQuestions] = useState(\n    interaction.questions?.length ? getEditableFormat(interaction.questions) : [{ draftID: uuid() }],\n  );\n\n  const isValidPoll = useMemo(() => questions.length > 0 && questions.every(isValidQuestion), [questions]);\n\n  const launchPoll = async () => {\n    await actions.interactivityCenter.startPoll(id);\n    await sendTimedMetadata(id);\n    setPollView(POLL_VIEWS.VOTE);\n  };\n\n  const sendTimedMetadata = async poll_id => {\n    // send hls timedmetadata when it is running\n    if (poll_id && isHLSRunning) {\n      try {\n        await actions.sendHLSTimedMetadata([\n          {\n            payload: `poll:${poll_id}`,\n            duration: 100,\n          },\n        ]);\n      } catch (e) {\n        console.error(e);\n      }\n    }\n  };\n\n  const headingTitle = interaction?.type\n    ? interaction?.type?.[0]?.toUpperCase() + interaction?.type?.slice(1)\n    : 'Polls and Quizzes';\n  const isQuiz = interaction?.type === 'quiz';\n  return (\n    <Container rounded>\n      <ContentHeader\n        content={headingTitle}\n        onClose={togglePollView}\n        onBack={() => setPollView(POLL_VIEWS.CREATE_POLL_QUIZ)}\n      />\n      <Flex direction=\"column\" css={{ p: '$10', overflowY: 'auto' }}>\n        <Flex direction=\"column\">\n          {questions.map((question, index) => (\n            <QuestionCard\n              key={question.draftID}\n              question={question}\n              index={index}\n              length={questions.length}\n              onSave={async questionParams => {\n                const updatedQuestions = [...questions.slice(0, index), questionParams, ...questions.slice(index + 1)];\n                setQuestions(updatedQuestions);\n                const validQuestions = updatedQuestions.filter(question => isValidQuestion(question));\n                await actions.interactivityCenter.addQuestionsToPoll(id, validQuestions);\n              }}\n              isQuiz={isQuiz}\n              removeQuestion={async questionID => {\n                const updatedQuestions = questions.filter(questionFromSet => questionID !== questionFromSet?.draftID);\n                setQuestions(updatedQuestions);\n                const validQuestions = updatedQuestions.filter(question => isValidQuestion(question));\n                await actions.interactivityCenter.addQuestionsToPoll(id, validQuestions);\n              }}\n              convertToDraft={questionID =>\n                setQuestions(prev => {\n                  const copyOfQuestions = [...prev];\n                  copyOfQuestions.forEach(question => {\n                    if (questionID && question.draftID === questionID) {\n                      question.saved = false;\n                    }\n                  });\n                  return copyOfQuestions;\n                })\n              }\n            />\n          ))}\n        </Flex>\n        <Flex\n          css={{\n            c: '$on_surface_low',\n            my: '$sm',\n            cursor: 'pointer',\n            '&:hover': { c: '$on_surface_medium' },\n          }}\n          onClick={() => setQuestions([...questions, { draftID: uuid() }])}\n        >\n          <AddCircleIcon />\n          <Text variant=\"body1\" css={{ ml: '$md', c: '$inherit' }}>\n            Add another question\n          </Text>\n        </Flex>\n        <Flex css={{ w: '100%' }} justify=\"end\">\n          <Button disabled={!isValidPoll} onClick={async () => launchPoll()}>\n            Launch {interaction?.type}\n          </Button>\n        </Flex>\n      </Flex>\n    </Container>\n  );\n}\n\nconst QuestionCard = ({ question, onSave, index, length, removeQuestion, isQuiz, convertToDraft }) => {\n  return (\n    <Flex direction=\"column\" css={{ p: '$md', bg: '$surface_default', r: '$1', mb: '$sm' }}>\n      {question.saved ? (\n        <SavedQuestion question={question} index={index} length={length} convertToDraft={convertToDraft} />\n      ) : (\n        <QuestionForm\n          question={question}\n          removeQuestion={() => removeQuestion(question.draftID)}\n          onSave={params => onSave(params)}\n          index={index}\n          length={length}\n          isQuiz={isQuiz}\n        />\n      )}\n    </Flex>\n  );\n};\n", "// @ts-check\nimport React, { useCallback, useRef, useState } from 'react';\nimport {\n  HMSPollQuestionCreateParams,\n  HMSPollQuestionOptionCreateParams,\n  HMSPollQuestionType,\n} from '@100mslive/react-sdk';\nimport { AddCircleIcon, TrashIcon } from '@100mslive/react-icons';\n// import { Button, Dropdown, Flex, IconButton, Input, Switch, Text, TextArea, Tooltip } from '../../../..';\nimport { Button, Dropdown, Flex, IconButton, Input, Text, TextArea, Tooltip } from '../../../..';\n// @ts-ignore\nimport { DialogDropdownTrigger } from '../../../primitives/DropdownTrigger';\n// @ts-ignore\nimport { DeleteQuestionModal } from './DeleteQuestionModal';\n// @ts-ignore\nimport { useDropdownSelection } from '../../hooks/useDropdownSelection';\n// @ts-ignore\nimport { isValidTextInput } from '../../../common/utils';\nimport { Line } from '../common/Line';\n// @ts-ignore\nimport { MultipleChoiceOptionInputs } from '../common/MultipleChoiceOptions';\n// @ts-ignore\nimport { SingleChoiceOptionInputs } from '../common/SingleChoiceOptions';\nimport { QUESTION_TYPE, QUESTION_TYPE_TITLE } from '../../../common/constants';\n\nexport const QuestionForm = ({\n  question,\n  index,\n  length,\n  onSave,\n  removeQuestion,\n  isQuiz,\n}: {\n  question: HMSPollQuestionCreateParams & { draftID: number };\n  index: number;\n  length: number;\n  onSave: (optionParams: HMSPollQuestionCreateParams & { draftID: number; saved: boolean }) => void;\n  removeQuestion: () => void;\n  isQuiz: boolean;\n}) => {\n  const ref = useRef(null);\n  const selectionBg = useDropdownSelection();\n  const [openDelete, setOpenDelete] = useState(false);\n  const [open, setOpen] = useState(false);\n  const [type, setType] = useState<HMSPollQuestionType>(question.type || QUESTION_TYPE.SINGLE_CHOICE);\n  const [text, setText] = useState(question.text);\n  const [weight, setWeight] = useState(isQuiz ? 10 : 1);\n  const [options, setOptions] = useState(\n    question?.options || [\n      { text: '', isCorrectAnswer: false },\n      { text: '', isCorrectAnswer: false },\n    ],\n  );\n  // const [skippable, setSkippable] = useState(false);\n  const isValid = isValidQuestion({\n    text,\n    type,\n    options,\n    weight,\n    isQuiz,\n  });\n\n  const handleOptionTextChange = useCallback(\n    (index: number, text: string) => {\n      setOptions(options => [...options.slice(0, index), { ...options[index], text }, ...options.slice(index + 1)]);\n    },\n    [setOptions],\n  );\n\n  const removeOption = useCallback(\n    (index: number) =>\n      setOptions(options => {\n        const newOptions = [...options];\n        newOptions.splice(index, 1);\n        return newOptions;\n      }),\n    [setOptions],\n  );\n\n  const selectSingleChoiceAnswer = useCallback(\n    (answerIndex: number) => {\n      if (!isQuiz) {\n        return;\n      }\n      setOptions(options =>\n        options.map((option, index) => ({\n          ...option,\n          isCorrectAnswer: index === answerIndex,\n        })),\n      );\n    },\n    [setOptions, isQuiz],\n  );\n\n  const selectMultipleChoiceAnswer = useCallback(\n    (checked: boolean, index: number) => {\n      if (!isQuiz) {\n        return;\n      }\n      setOptions(options => [\n        ...options.slice(0, index),\n        { ...options[index], isCorrectAnswer: checked },\n        ...options.slice(index + 1),\n      ]);\n    },\n    [setOptions, isQuiz],\n  );\n\n  return (\n    <>\n      <Text variant=\"overline\" css={{ c: '$on_surface_low', textTransform: 'uppercase' }}>\n        Question {index + 1} of {length}\n      </Text>\n      <Text variant=\"body2\" css={{ mt: '$4', mb: '$md' }}>\n        Question Type\n      </Text>\n      <Dropdown.Root open={open} onOpenChange={setOpen}>\n        <DialogDropdownTrigger\n          ref={ref}\n          // @ts-ignore\n          title={QUESTION_TYPE_TITLE[type]}\n          css={{\n            backgroundColor: '$surface_bright',\n            border: '1px solid $border_bright',\n          }}\n          open={open}\n        />\n        <Dropdown.Portal>\n          {/* @ts-ignore */}\n          <Dropdown.Content align=\"start\" sideOffset={8} css={{ w: ref.current?.clientWidth, zIndex: 1000 }}>\n            {Object.keys(QUESTION_TYPE_TITLE).map(value => {\n              return (\n                <Dropdown.Item\n                  key={value}\n                  // @ts-ignore\n                  onSelect={() => setType(value)}\n                  css={{\n                    px: '$9',\n                    bg: type === value ? selectionBg : undefined,\n                  }}\n                >\n                  {/* @ts-ignore */}\n                  {QUESTION_TYPE_TITLE[value]}\n                </Dropdown.Item>\n              );\n            })}\n          </Dropdown.Content>\n        </Dropdown.Portal>\n      </Dropdown.Root>\n      <TextArea\n        maxLength={1024}\n        placeholder=\"Ask a question\"\n        css={{\n          mt: '$md',\n          backgroundColor: '$surface_bright',\n          border: '1px solid $border_bright',\n          minHeight: '$14',\n          resize: 'vertical',\n          maxHeight: '$32',\n        }}\n        value={text}\n        onChange={event => setText(event.target.value.trimStart())}\n      />\n      <Text variant=\"xs\" css={{ color: '$on_surface_medium', textAlign: 'end', mt: '$4' }}>\n        {text?.length || 0}/1024\n      </Text>\n      <Line />\n      {/* @ts-ignore */}\n      {type === QUESTION_TYPE.SINGLE_CHOICE || type === QUESTION_TYPE.MULTIPLE_CHOICE ? (\n        <>\n          <Text variant=\"body2\" css={{ mb: '$6', c: '$on_surface_medium' }}>\n            Options\n          </Text>\n\n          {isQuiz && (\n            <Text variant=\"xs\" css={{ c: '$on_surface_medium', mb: '$md' }}>\n              {type === QUESTION_TYPE.SINGLE_CHOICE\n                ? 'Use the radio buttons to indicate the correct answer'\n                : 'Use the checkboxes to indicate the correct answer(s)'}\n            </Text>\n          )}\n\n          {type === QUESTION_TYPE.SINGLE_CHOICE && (\n            <SingleChoiceOptionInputs\n              isQuiz={isQuiz}\n              options={options}\n              selectAnswer={selectSingleChoiceAnswer}\n              handleOptionTextChange={handleOptionTextChange}\n              removeOption={removeOption}\n            />\n          )}\n\n          {type === QUESTION_TYPE.MULTIPLE_CHOICE && (\n            <MultipleChoiceOptionInputs\n              isQuiz={isQuiz}\n              options={options}\n              selectAnswer={selectMultipleChoiceAnswer}\n              handleOptionTextChange={handleOptionTextChange}\n              removeOption={removeOption}\n            />\n          )}\n\n          {options?.length < 20 && (\n            <Flex\n              css={{\n                c: '$on_surface_medium',\n                cursor: 'pointer',\n                '&:hover': { c: '$on_surface_high' },\n              }}\n              onClick={() => setOptions([...options, { text: '', isCorrectAnswer: false }])}\n            >\n              <AddCircleIcon style={{ position: 'relative', left: '-2px' }} />\n\n              <Text\n                variant=\"sm\"\n                css={{\n                  ml: '$4',\n                  c: 'inherit',\n                }}\n              >\n                Add an option\n              </Text>\n            </Flex>\n          )}\n          <Line />\n          {isQuiz ? (\n            <>\n              <Flex justify=\"between\" align=\"center\" css={{ gap: '$6', w: '100%' }}>\n                <Text variant=\"sm\" css={{ color: '$on_surface_medium' }}>\n                  Point Weightage\n                </Text>\n                <Input\n                  type=\"number\"\n                  value={weight}\n                  min={1}\n                  max={999}\n                  onChange={e => setWeight(Math.min(Number(e.target.value), 999))}\n                  css={{\n                    backgroundColor: '$surface_bright',\n                    border: '1px solid $border_bright',\n                    maxWidth: '$20',\n                  }}\n                />\n              </Flex>\n              {/* <Flex justify=\"between\" css={{ mt: '$md', gap: '$6', w: '100%' }}>\n                <Text variant=\"sm\" css={{ color: '$on_surface_medium' }}>\n                  Allow to skip\n                </Text>\n                <Switch defaultChecked={skippable} onCheckedChange={checked => setSkippable(checked)} />\n              </Flex> */}\n            </>\n          ) : null}\n        </>\n      ) : null}\n\n      <Flex justify=\"end\" align=\"center\" css={{ mt: '$12', gap: '$8' }}>\n        <IconButton css={{ border: '1px solid $border_bright' }}>\n          <TrashIcon onClick={() => setOpenDelete(!open)} />\n        </IconButton>\n        <Tooltip\n          disabled={isValid}\n          title={\n            options.length < 2\n              ? 'At least two options must be added'\n              : `Please fill all the fields ${isQuiz ? 'and mark the correct answer(s)' : ''} to continue`\n          }\n          boxCss={{ maxWidth: '$40' }}\n        >\n          <Button\n            variant=\"standard\"\n            disabled={!isValid}\n            onClick={() => {\n              onSave({\n                saved: true,\n                text,\n                type,\n                options,\n                skippable: false,\n                draftID: question.draftID,\n                weight,\n              });\n            }}\n          >\n            Save\n          </Button>\n        </Tooltip>\n      </Flex>\n\n      <DeleteQuestionModal open={openDelete} setOpen={setOpenDelete} removeQuestion={removeQuestion} />\n    </>\n  );\n};\n\nexport const isValidQuestion = ({\n  text,\n  type,\n  options,\n  weight,\n  isQuiz = false,\n}: {\n  text: string;\n  type: string;\n  options: HMSPollQuestionOptionCreateParams[];\n  weight: number;\n  isQuiz?: boolean;\n}) => {\n  if (!isValidTextInput(text) || !type) {\n    return false;\n  }\n\n  const everyOptionHasText = options.length > 1 && options.every(option => option && isValidTextInput(option.text, 1));\n  const hasCorrectAnswer = options.some(option => option.isCorrectAnswer);\n\n  if (!isQuiz) {\n    return everyOptionHasText;\n  }\n\n  // The minimum acceptable value of weight is 1\n  if (isQuiz && weight < 1) {\n    return false;\n  }\n\n  return everyOptionHasText && hasCorrectAnswer;\n};\n", "import React from 'react';\nimport { AlertTriangleIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Button } from '../../../../Button';\nimport { Box, Flex } from '../../../../Layout';\nimport { Dialog } from '../../../../Modal';\nimport { Text } from '../../../../Text';\n\nexport const DeleteQuestionModal = ({\n  open,\n  setOpen,\n  removeQuestion,\n}: {\n  open: boolean;\n  setOpen: React.Dispatch<React.SetStateAction<boolean>>;\n  removeQuestion: () => void;\n}) => {\n  return (\n    <Dialog.Root open={open}>\n      <Dialog.Overlay />\n      <Dialog.Portal>\n        <Dialog.Content css={{ p: '$10' }}>\n          <Box>\n            <Flex\n              css={{\n                color: '$alert_error_default',\n                display: 'flex',\n                alignItems: 'center',\n              }}\n            >\n              <AlertTriangleIcon style={{ marginRight: '0.5rem' }} />\n              <Text variant=\"lg\" css={{ color: 'inherit', fontWeight: '$semiBold' }}>\n                Delete Question?\n              </Text>\n\n              <Box\n                css={{\n                  ml: 'auto',\n                  color: '$on_surface_medium',\n                  '&:hover': { color: '$on_surface_high', cursor: 'pointer' },\n                }}\n                onClick={() => setOpen(false)}\n              >\n                <CrossIcon />\n              </Box>\n            </Flex>\n            <Text variant=\"sm\" css={{ color: '$on_surface_medium', mb: '$8', mt: '$4' }}>\n              The question will be deleted. You can't undo this action.\n            </Text>\n            <Flex css={{ w: '100%', mt: '$12', gap: '$md' }}>\n              <Button\n                variant=\"standard\"\n                outlined\n                onClick={() => setOpen(false)}\n                css={{ w: '100%', fontSize: '$md', fontWeight: '$semiBold' }}\n              >\n                Cancel\n              </Button>\n              <Button\n                css={{ w: '100%', fontSize: '$md', fontWeight: '$semiBold' }}\n                variant=\"danger\"\n                onClick={() => {\n                  removeQuestion();\n                  setOpen(false);\n                }}\n              >\n                Delete\n              </Button>\n            </Flex>\n          </Box>\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n};\n", "import React from 'react';\nimport { Flex } from '../../../../Layout';\n\nexport const Line = () => <Flex css={{ w: '100%', borderBottom: '1px solid $border_bright', h: '1px', my: '$8' }} />;\n", "// @ts-check\nimport React from 'react';\nimport { CheckCircleIcon, CheckIcon } from '@100mslive/react-icons';\nimport { Checkbox, Flex, Label, Text } from '../../../../';\nimport { OptionInputWithDelete } from './OptionInputWithDelete';\nimport { VoteCount } from './VoteCount';\nimport { VoteProgress } from './VoteProgress';\n\nexport const MultipleChoiceOptions = ({\n  questionIndex,\n  options,\n  canRespond,\n  totalResponses,\n  selectedOptions,\n  setSelectedOptions,\n  showVoteCount,\n  isQuiz,\n  correctOptionIndexes,\n  localPeerResponse,\n  isStopped,\n}) => {\n  const handleCheckedChange = (checked, index) => {\n    const newSelected = new Set(selectedOptions);\n    if (checked) {\n      newSelected.add(index);\n    } else {\n      newSelected.delete(index);\n    }\n    setSelectedOptions(newSelected);\n  };\n\n  return (\n    <Flex direction=\"column\" css={{ gap: '$md', w: '100%', mb: '$md' }}>\n      {options.map(option => {\n        return (\n          <Flex align=\"center\" key={`${questionIndex}-${option.index}`} css={{ w: '100%', gap: '$4' }}>\n            {!isStopped || !isQuiz ? (\n              <Checkbox.Root\n                id={`${questionIndex}-${option.index}`}\n                disabled={!canRespond}\n                checked={localPeerResponse?.options?.includes(option.index)}\n                onCheckedChange={checked => handleCheckedChange(checked, option.index)}\n                css={{\n                  cursor: canRespond ? 'pointer' : 'not-allowed',\n                  flexShrink: 0,\n                }}\n              >\n                <Checkbox.Indicator>\n                  <CheckIcon width={16} height={16} />\n                </Checkbox.Indicator>\n              </Checkbox.Root>\n            ) : null}\n\n            {isStopped && correctOptionIndexes?.includes(option.index) ? (\n              <Flex align=\"center\" css={{ color: '$on_surface_high' }}>\n                <CheckCircleIcon height={20} width={20} />\n              </Flex>\n            ) : null}\n\n            <Flex direction=\"column\" css={{ flexGrow: '1' }}>\n              <Flex css={{ w: '100%' }}>\n                <Text css={{ display: 'flex', flexGrow: '1' }}>\n                  <Label htmlFor={`${questionIndex}-${option.index}`}>{option.text}</Label>\n                </Text>\n                {showVoteCount && <VoteCount voteCount={option.voteCount} />}\n              </Flex>\n              {showVoteCount && <VoteProgress option={option} totalResponses={totalResponses} />}\n            </Flex>\n\n            {isStopped && isQuiz && localPeerResponse?.options.includes(option.index) ? (\n              <Text variant=\"sm\" css={{ color: '$on_surface_medium', maxWidth: 'max-content' }}>\n                Your Answer\n              </Text>\n            ) : null}\n          </Flex>\n        );\n      })}\n    </Flex>\n  );\n};\n\nexport const MultipleChoiceOptionInputs = ({ isQuiz, options, selectAnswer, handleOptionTextChange, removeOption }) => {\n  return (\n    <Flex direction=\"column\" css={{ gap: '$md', w: '100%', mb: '$md' }}>\n      {options.map((option, index) => {\n        return (\n          <Flex align=\"center\" key={index} css={{ w: '100%', gap: '$4' }}>\n            {isQuiz && (\n              <Checkbox.Root\n                onCheckedChange={checked => selectAnswer(checked, index)}\n                checked={option.isCorrectAnswer}\n                css={{\n                  cursor: 'pointer',\n                  width: '$9',\n                }}\n              >\n                <Checkbox.Indicator>\n                  <CheckIcon width={16} height={16} />\n                </Checkbox.Indicator>\n              </Checkbox.Root>\n            )}\n            <OptionInputWithDelete\n              index={index}\n              option={option}\n              handleOptionTextChange={handleOptionTextChange}\n              removeOption={removeOption}\n            />\n          </Flex>\n        );\n      })}\n    </Flex>\n  );\n};\n", "import React from 'react';\nimport { HMSPollQuestionOption } from '@100mslive/react-sdk';\nimport { TrashIcon } from '@100mslive/react-icons';\nimport { Input } from '../../../../Input';\n// @ts-ignore\nimport IconButton from '../../../IconButton';\n\nexport const OptionInputWithDelete = ({\n  index,\n  option,\n  handleOptionTextChange,\n  removeOption,\n}: {\n  index: number;\n  option: HMSPollQuestionOption;\n  handleOptionTextChange: (index: number, value: string) => void;\n  removeOption: (index: number) => void;\n}) => {\n  return (\n    <>\n      <Input\n        placeholder={`Option ${index + 1}`}\n        css={{\n          w: '100%',\n          backgroundColor: '$surface_bright',\n          border: '1px solid $border_bright',\n        }}\n        value={option?.text || ''}\n        key={index}\n        onChange={event => handleOptionTextChange(index, event.target.value.trimStart())}\n        maxLength={250}\n      />\n      <IconButton onClick={() => removeOption(index)} css={{ bg: 'transparent', border: 'none' }}>\n        <TrashIcon />\n      </IconButton>\n    </>\n  );\n};\n", "import React from 'react';\nimport { Flex, Text } from '../../../../';\n\nexport const VoteCount = ({ voteCount }: { voteCount: number }) => {\n  return (\n    <Flex css={{ alignItems: 'center' }}>\n      {voteCount ? (\n        <Text variant=\"sm\" css={{ color: '$on_surface_medium' }}>\n          {voteCount}&nbsp;\n          {voteCount === 1 ? 'vote' : 'votes'}\n        </Text>\n      ) : null}\n    </Flex>\n  );\n};\n", "import React from 'react';\nimport { HMSPollQuestionOption } from '@100mslive/react-sdk';\nimport { Progress } from '../../../../';\n\nexport const VoteProgress = ({ option, totalResponses }: { option: HMSPollQuestionOption; totalResponses: number }) => {\n  const showProgress = typeof option.voteCount === 'number' && typeof totalResponses === 'number' && totalResponses > 0;\n  const progressValue = (100 * (option.voteCount || 0)) / totalResponses;\n\n  return showProgress ? (\n    <Progress.Root value={progressValue} css={{ mt: '$4' }}>\n      <Progress.Content\n        style={{\n          transform: `translateX(-${100 - progressValue}%)`,\n        }}\n      />\n    </Progress.Root>\n  ) : null;\n};\n", "// @ts-check\nimport React from 'react';\nimport { CheckCircleIcon } from '@100mslive/react-icons';\nimport { Flex, Label, RadioGroup, Text } from '../../../..';\nimport { OptionInputWithDelete } from './OptionInputWithDelete';\nimport { VoteCount } from './VoteCount';\nimport { VoteProgress } from './VoteProgress';\n\nexport const SingleChoiceOptions = ({\n  questionIndex,\n  options,\n  canRespond,\n  setAnswer,\n  totalResponses,\n  showVoteCount,\n  correctOptionIndex,\n  isStopped,\n  isQuiz,\n  localPeerResponse,\n}) => {\n  return (\n    <RadioGroup.Root value={localPeerResponse?.option} onValueChange={value => setAnswer(value)}>\n      <Flex direction=\"column\" css={{ gap: '$md', w: '100%', mb: '$md' }}>\n        {options.map(option => {\n          return (\n            <Flex align=\"center\" key={`${questionIndex}-${option.index}`} css={{ w: '100%', gap: '$4' }}>\n              {!isStopped || !isQuiz ? (\n                <RadioGroup.Item\n                  css={{\n                    background: 'none',\n                    h: '$9',\n                    w: '$9',\n                    border: '2px solid',\n                    borderColor: '$on_surface_high',\n                    display: 'flex',\n                    flexShrink: 0,\n                    pt: '$1',\n                    justifyContent: 'center',\n                    alignItems: 'center',\n                    cursor: canRespond ? 'pointer' : 'not-allowed',\n                    '&[data-state=\"checked\"]': {\n                      borderColor: '$primary_bright',\n                      borderWidth: '2px',\n                    },\n                  }}\n                  disabled={!canRespond}\n                  value={option.index}\n                  id={`${questionIndex}-${option.index}`}\n                >\n                  <RadioGroup.Indicator\n                    css={{\n                      h: '80%',\n                      w: '80%',\n                      background: '$primary_bright',\n                      borderRadius: '$round',\n                    }}\n                  />\n                </RadioGroup.Item>\n              ) : null}\n\n              {isStopped && correctOptionIndex === option.index && isQuiz ? (\n                <Flex css={{ color: '$on_surface_high' }}>\n                  <CheckCircleIcon height={20} width={20} />\n                </Flex>\n              ) : null}\n\n              <Flex direction=\"column\" css={{ flexGrow: '1' }}>\n                <Flex css={{ w: '100%' }}>\n                  <Text css={{ display: 'flex', flexGrow: '1', color: '$on_surface_high' }}>\n                    <Label style={{ color: 'inherit' }} htmlFor={`${questionIndex}-${option.index}`}>\n                      {option.text}\n                    </Label>\n                  </Text>\n                  {showVoteCount && <VoteCount voteCount={option.voteCount} />}\n                </Flex>\n                {showVoteCount && <VoteProgress option={option} totalResponses={totalResponses} />}\n              </Flex>\n              {isStopped && isQuiz && localPeerResponse?.option === option.index ? (\n                <Text variant=\"sm\" css={{ color: '$on_surface_medium', maxWidth: 'max-content' }}>\n                  Your Answer\n                </Text>\n              ) : null}\n            </Flex>\n          );\n        })}\n      </Flex>\n    </RadioGroup.Root>\n  );\n};\n\nexport const SingleChoiceOptionInputs = ({ isQuiz, options, selectAnswer, handleOptionTextChange, removeOption }) => {\n  const correctOptionIndex = options.findIndex(option => option.isCorrectAnswer);\n\n  return (\n    <RadioGroup.Root value={correctOptionIndex} onValueChange={selectAnswer}>\n      <Flex direction=\"column\" css={{ gap: '$md', w: '100%', mb: '$md' }}>\n        {options.map((option, index) => {\n          return (\n            <Flex align=\"center\" key={`option-${index}`} css={{ w: '100%', gap: '$4' }}>\n              {isQuiz && (\n                <RadioGroup.Item\n                  css={{\n                    background: 'none',\n                    w: '$9',\n                    border: '2px solid',\n                    borderColor: '$on_surface_high',\n                    display: 'flex',\n                    justifyContent: 'center',\n                    alignItems: 'center',\n                    cursor: 'pointer',\n                    '&[data-state=\"checked\"]': {\n                      borderColor: '$primary_bright',\n                      borderWidth: '2px',\n                    },\n                  }}\n                  value={index}\n                >\n                  <RadioGroup.Indicator\n                    css={{\n                      h: '80%',\n                      w: '80%',\n                      background: '$primary_bright',\n                      borderRadius: '$round',\n                    }}\n                  />\n                </RadioGroup.Item>\n              )}\n              <OptionInputWithDelete\n                index={index}\n                option={option}\n                handleOptionTextChange={handleOptionTextChange}\n                removeOption={removeOption}\n              />\n            </Flex>\n          );\n        })}\n      </Flex>\n    </RadioGroup.Root>\n  );\n};\n", "import React, { useMemo } from 'react';\nimport { HMSPollQuestion } from '@100mslive/react-sdk';\nimport { CheckCircleIcon } from '@100mslive/react-icons';\nimport { Button, Flex, Text } from '../../../../';\nimport { QUESTION_TYPE_TITLE } from '../../../common/constants';\n\nexport const SavedQuestion = ({\n  question,\n  index,\n  length,\n  convertToDraft,\n}: {\n  question: HMSPollQuestion & { draftID: number };\n  index: number;\n  length: number;\n  convertToDraft: (draftID: number) => void;\n}) => {\n  const answerArray = useMemo(() => {\n    const updatedAnswerArray = [];\n    const { option, options } = question?.answer ?? {};\n    if (option) {\n      updatedAnswerArray.push(option);\n    }\n    if (options) {\n      updatedAnswerArray.push(...options);\n    }\n    return updatedAnswerArray;\n  }, [question?.answer]);\n\n  return (\n    <>\n      <Text variant=\"overline\" css={{ c: '$on_surface_low', textTransform: 'uppercase' }}>\n        {/* @ts-ignore */}\n        Question {index + 1} of {length}: {QUESTION_TYPE_TITLE[question.type]}\n      </Text>\n      <Text variant=\"body2\" css={{ mt: '$4', mb: '$md' }}>\n        {question.text}\n      </Text>\n      {question.options?.map((option, index) => (\n        <Flex key={`${option.text}-${index}`} css={{ alignItems: 'center', my: '$xs' }}>\n          <Text variant=\"body2\" css={{ c: '$on_surface_medium' }}>\n            {option.text}\n          </Text>\n          {/* @ts-ignore */}\n          {(answerArray.includes(index + 1) || option.isCorrectAnswer) && (\n            <Flex css={{ color: '$alert_success', mx: '$xs' }}>\n              <CheckCircleIcon height={24} width={24} />\n            </Flex>\n          )}\n        </Flex>\n      ))}\n      {question.skippable ? (\n        <Text variant=\"sm\" css={{ color: '$on_surface_low', my: '$md' }}>\n          Not required to answer\n        </Text>\n      ) : null}\n      <Flex justify=\"end\" css={{ w: '100%', alignItems: 'center' }}>\n        <Button variant=\"standard\" css={{ fontWeight: '$semiBold' }} onClick={() => convertToDraft(question.draftID)}>\n          Edit\n        </Button>\n      </Flex>\n    </>\n  );\n};\n", "import React, { useState } from 'react';\nimport { selectPollByID, useHMSStore } from '@100mslive/react-sdk';\nimport { ChevronLeftIcon, ChevronRightIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Box, Flex } from '../../../../Layout';\nimport { Loading } from '../../../../Loading';\nimport { Text } from '../../../../Text';\n// @ts-ignore\nimport { Container } from '../../Streaming/Common';\nimport { LeaderboardEntry } from './LeaderboardEntry';\nimport { PeerParticipationSummary } from './PeerParticipationSummary';\n// @ts-ignore\nimport { useSidepaneToggle } from '../../AppData/useSidepane';\n// @ts-ignore\nimport { usePollViewState } from '../../AppData/useUISettings';\nimport { useQuizSummary } from './useQuizSummary';\n// @ts-ignore\nimport { StatusIndicator } from '../common/StatusIndicator';\nimport { POLL_VIEWS } from '../../../common/constants';\n\nexport const LeaderboardSummary = ({ pollID }: { pollID: string }) => {\n  const quiz = useHMSStore(selectPollByID(pollID));\n  const { quizLeaderboard, maxPossibleScore } = useQuizSummary(pollID);\n  const [viewAllEntries, setViewAllEntries] = useState(false);\n  const { setPollView } = usePollViewState();\n  const toggleSidepane = useSidepaneToggle();\n\n  if (!quiz || !quizLeaderboard)\n    return (\n      <Flex align=\"center\" justify=\"center\" css={{ size: '100%' }}>\n        <Loading />\n      </Flex>\n    );\n\n  const questionCount = quiz.questions?.length || 0;\n\n  return (\n    <Container rounded>\n      <Flex direction=\"column\" css={{ size: '100%', p: '$8' }}>\n        <Flex justify=\"between\" align=\"center\" css={{ pb: '$6', borderBottom: '1px solid $border_bright', mb: '$8' }}>\n          <Flex align=\"center\" css={{ gap: '$4' }}>\n            <Flex\n              css={{ color: '$on_surface_medium', '&:hover': { color: '$on_surface_high', cursor: 'pointer' } }}\n              onClick={() => setPollView(POLL_VIEWS.VOTE)}\n            >\n              <ChevronLeftIcon />\n            </Flex>\n            <Text variant=\"lg\" css={{ fontWeight: '$semiBold' }}>\n              {quiz.title}\n            </Text>\n            <StatusIndicator status={quiz.state} />\n          </Flex>\n          <Flex\n            css={{ color: '$on_surface_medium', '&:hover': { color: '$on_surface_high', cursor: 'pointer' } }}\n            onClick={toggleSidepane}\n          >\n            <CrossIcon />\n          </Flex>\n        </Flex>\n        <Box css={{ overflowY: 'auto', mr: '-$4', pr: '$4' }}>\n          {!viewAllEntries ? <PeerParticipationSummary quiz={quiz} /> : null}\n\n          <Text variant=\"sm\" css={{ fontWeight: '$semiBold', mt: '$4' }}>\n            Leaderboard\n          </Text>\n          <Text variant=\"xs\" css={{ color: '$on_surface_medium' }}>\n            Based on score and time taken to cast the correct answer\n          </Text>\n          <Box\n            css={{\n              mt: '$8',\n              overflowY: 'auto',\n              flex: viewAllEntries ? '1 1 0' : 'unset',\n              mr: viewAllEntries ? '-$6' : 'unset',\n              px: viewAllEntries ? '0' : '$4',\n              pr: viewAllEntries ? '$6' : '$4',\n              backgroundColor: viewAllEntries ? '' : '$surface_default',\n              borderRadius: '$1',\n            }}\n          >\n            {quizLeaderboard?.entries &&\n              quizLeaderboard.entries\n                .slice(0, viewAllEntries ? undefined : 5)\n                .map(question => (\n                  <LeaderboardEntry\n                    key={question.position}\n                    position={question.position}\n                    score={question.score}\n                    questionCount={questionCount}\n                    correctResponses={question.correctResponses}\n                    userName={question.peer.username || ''}\n                    maxPossibleScore={maxPossibleScore}\n                    duration={question.duration}\n                  />\n                ))}\n            {quizLeaderboard?.entries?.length > 5 && !viewAllEntries ? (\n              <Flex\n                align=\"center\"\n                justify=\"end\"\n                css={{\n                  w: '100%',\n                  borderTop: '1px solid $border_bright',\n                  cursor: 'pointer',\n                  color: '$on_surface_high',\n                  p: '$6 $2',\n                }}\n                onClick={() => setViewAllEntries(true)}\n              >\n                <Text variant=\"sm\">View All</Text> <ChevronRightIcon />\n              </Flex>\n            ) : null}\n          </Box>\n        </Box>\n      </Flex>\n    </Container>\n  );\n};\n", "import React from 'react';\nimport { CheckCircleIcon, ClockIcon, TrophyFilledIcon } from '@100mslive/react-icons';\nimport { Box, Flex } from '../../../../Layout';\nimport { Text } from '../../../../Text';\nimport { getFormattedTime } from '../common/utils';\n\nconst positionColorMap: Record<number, string> = { 1: '#D69516', 2: '#3E3E3E', 3: '#583B0F' };\n\nexport const LeaderboardEntry = ({\n  position,\n  score,\n  questionCount,\n  correctResponses,\n  userName,\n  maxPossibleScore,\n  duration,\n}: {\n  position: number;\n  score: number;\n  questionCount: number;\n  correctResponses: number;\n  userName: string;\n  maxPossibleScore: number;\n  duration: number;\n}) => {\n  return (\n    <Flex align=\"center\" justify=\"between\" css={{ my: '$8' }}>\n      <Flex align=\"center\" css={{ gap: '$6' }}>\n        <Flex\n          align=\"center\"\n          justify=\"center\"\n          css={{\n            backgroundColor: positionColorMap[position] || '',\n            h: '$10',\n            w: '$10',\n            borderRadius: '$round',\n            color: position > 3 ? '$on_surface_low' : '#FFF',\n            fontSize: '$xs',\n            fontWeight: '$semiBold',\n          }}\n        >\n          {position}\n        </Flex>\n\n        <Box>\n          <Text variant=\"sm\" css={{ fontWeight: '$semiBold', color: '$on_surface_high' }}>\n            {userName}\n          </Text>\n\n          <Text variant=\"sm\" css={{ mt: '$1' }}>\n            {score} / {maxPossibleScore} points\n          </Text>\n        </Box>\n      </Flex>\n\n      <Flex align=\"center\" css={{ gap: '$4', color: '$on_surface_medium' }}>\n        {position === 1 && score ? <TrophyFilledIcon height={16} width={16} /> : null}\n        {questionCount ? (\n          <>\n            <CheckCircleIcon height={16} width={16} />\n            <Text variant=\"xs\">\n              {correctResponses}/{questionCount}\n            </Text>\n          </>\n        ) : null}\n\n        {duration ? (\n          <Flex align=\"center\" css={{ gap: '$2', color: '$on_surface_medium' }}>\n            <ClockIcon height={16} width={16} />\n            <Text variant=\"xs\">{getFormattedTime(duration)}</Text>\n          </Flex>\n        ) : null}\n      </Flex>\n    </Flex>\n  );\n};\n", "export const getFormattedTime = (milliseconds: number | undefined, precise = true) => {\n  if (!milliseconds) return '-';\n\n  const totalSeconds = milliseconds / 1000;\n  const hours = Math.floor(totalSeconds / 3600);\n  const minutes = Math.floor((totalSeconds % 3600) / 60);\n  const seconds = totalSeconds % 60;\n\n  let formattedTime = '';\n  if (hours) {\n    formattedTime += `${hours}h `;\n  }\n  if (minutes || hours) {\n    formattedTime += `${minutes}m `;\n  }\n  if (!precise && (hours || minutes)) {\n    return formattedTime;\n  }\n  formattedTime += `${precise ? seconds.toFixed(3) : Math.floor(seconds)}s`;\n\n  return formattedTime;\n};\n", "import React from 'react';\nimport { HMSPoll, selectLocalPeerID, useHMSStore } from '@100mslive/react-sdk';\nimport { Box } from '../../../../Layout';\nimport { Text } from '../../../../Text';\nimport { StatisticBox } from './StatisticBox';\nimport { useQuizSummary } from './useQuizSummary';\nimport { getFormattedTime } from '../common/utils';\n\nexport const PeerParticipationSummary = ({ quiz }: { quiz: HMSPoll }) => {\n  const localPeerId = useHMSStore(selectLocalPeerID);\n  const { quizLeaderboard, summary } = useQuizSummary(quiz.id);\n  if (quiz.state !== 'stopped') {\n    return <></>;\n  }\n  const isLocalPeerQuizCreator = localPeerId === quiz.startedBy;\n  const peerEntry = quizLeaderboard?.entries.find(entry => entry.peer?.peerid === localPeerId);\n\n  const boxes = isLocalPeerQuizCreator\n    ? [\n        {\n          title: 'Voted',\n          value: `${summary.totalUsers ? ((100 * summary.votedUsers) / summary.totalUsers).toFixed(0) : 0}% (${\n            summary.votedUsers\n          }/${summary.totalUsers})`,\n        },\n        {\n          title: 'Correct Answers',\n          value: `${summary.totalUsers ? ((100 * summary.correctUsers) / summary.totalUsers).toFixed(0) : 0}% (${\n            summary.correctUsers\n          }/${summary.totalUsers})`,\n        },\n        // Time in ms\n        { title: 'Avg. Time Taken', value: getFormattedTime(summary.avgTime) },\n        {\n          title: 'Avg. Score',\n          value: Number.isInteger(summary.avgScore) ? summary.avgScore : summary.avgScore.toFixed(2),\n        },\n      ]\n    : [\n        { title: 'Your rank', value: peerEntry?.position || '-' },\n        { title: 'Points', value: peerEntry?.score || 0 },\n        // Time in ms\n        { title: 'Time Taken', value: getFormattedTime(peerEntry?.duration) },\n        {\n          title: 'Correct Answers',\n          value: peerEntry?.totalResponses ? `${peerEntry?.correctResponses}/${peerEntry.totalResponses}` : '-',\n        },\n      ];\n\n  return (\n    <Box>\n      <Text css={{ fontWeight: '$semiBold', my: '$8' }}>Participation Summary</Text>\n      <Box css={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '$4' }}>\n        {boxes.map(box => (\n          <StatisticBox key={box.title} title={box.title} value={box.value} />\n        ))}\n      </Box>\n    </Box>\n  );\n};\n", "import React from 'react';\nimport { Box } from '../../../../Layout';\nimport { Text } from '../../../../Text';\n\nexport const StatisticBox = ({ title, value = 0 }: { title: string; value: string | number | undefined }) => {\n  if (!value && !(typeof value === 'number')) {\n    return <></>;\n  }\n  return (\n    <Box css={{ p: '$8', background: '$surface_default', borderRadius: '$1', w: '100%' }}>\n      <Text\n        variant=\"tiny\"\n        css={{ textTransform: 'uppercase', color: '$on_surface_medium', fontWeight: '$semiBold', my: '$4' }}\n      >\n        {title}\n      </Text>\n      <Text css={{ fontWeight: '$semiBold' }}>{value}</Text>\n    </Box>\n  );\n};\n", "import { useEffect, useState } from 'react';\nimport {\n  HMSQuizLeaderboardResponse,\n  HMSQuizLeaderboardSummary,\n  selectPollByID,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\n\nexport const useQuizSummary = (quizID: string) => {\n  const hmsActions = useHMSActions();\n  const quiz = useHMSStore(selectPollByID(quizID));\n  const [quizLeaderboard, setQuizLeaderboard] = useState<HMSQuizLeaderboardResponse | undefined>();\n\n  const summary: HMSQuizLeaderboardSummary = quizLeaderboard?.summary || {\n    totalUsers: 0,\n    votedUsers: 0,\n    avgScore: 0,\n    avgTime: 0,\n    correctUsers: 0,\n  };\n  const [calculations, setCalculations] = useState({ maxPossibleScore: 0, totalResponses: 0 });\n\n  useEffect(() => {\n    const fetchLeaderboardData = async () => {\n      if (!quizLeaderboard && quiz && !quiz?.anonymous && quiz.state === 'stopped') {\n        const leaderboardData = await hmsActions.interactivityCenter.fetchLeaderboard(quiz.id, 0, 50);\n\n        const { maxPossibleScore, totalResponses } =\n          quiz?.questions?.reduce((accumulator, question) => {\n            accumulator.maxPossibleScore += question.weight || 0;\n            accumulator.totalResponses += question?.responses?.length || 0;\n            return accumulator;\n          }, calculations) || calculations;\n\n        setQuizLeaderboard(leaderboardData);\n        setCalculations({ maxPossibleScore, totalResponses });\n      }\n    };\n\n    fetchLeaderboardData();\n  }, [quiz, hmsActions.interactivityCenter, quizLeaderboard, calculations]);\n\n  return {\n    quizLeaderboard,\n    summary,\n    maxPossibleScore: calculations.maxPossibleScore,\n    totalResponses: calculations.totalResponses,\n  };\n};\n", "import React, { useEffect, useRef, useState } from 'react';\nimport {\n  selectLocalPeer,\n  selectPeerNameByID,\n  selectPermissions,\n  selectPollByID,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { ChevronLeftIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Box, Button, Flex, Text } from '../../../..';\n// @ts-ignore\nimport { Container } from '../../Streaming/Common';\nimport { StandardView } from './StandardVoting';\nimport { TimedView } from './TimedVoting';\n// @ts-ignore\nimport { usePollViewState } from '../../AppData/useUISettings';\n// @ts-ignore\nimport { getPeerResponses } from '../../../common/utils';\nimport { StatusIndicator } from '../common/StatusIndicator';\nimport { POLL_VIEWS } from '../../../common/constants';\n\nexport const Voting = ({ id, toggleVoting }: { id: string; toggleVoting: () => void }) => {\n  const actions = useHMSActions();\n  const poll = useHMSStore(selectPollByID(id));\n  const pollCreatorName = useHMSStore(selectPeerNameByID(poll?.createdBy));\n  const permissions = useHMSStore(selectPermissions);\n  const canEndActivity = !!permissions?.pollWrite;\n  const { setPollView } = usePollViewState();\n  // Sets view - linear or vertical, toggles timer indicator\n  const showSingleView = poll?.type === 'quiz' && poll.state === 'started';\n  const fetchedInitialResponses = useRef(false);\n  const [savedResponses, setSavedResponses] = useState<Record<any, any>>({});\n  const localPeer = useHMSStore(selectLocalPeer);\n  const localPeerId = localPeer?.id;\n  const customerUserId = localPeer?.customerUserId;\n\n  // To reset whenever a different poll is opened\n  useEffect(() => {\n    fetchedInitialResponses.current = false;\n    setSavedResponses({});\n  }, [id, setSavedResponses]);\n\n  useEffect(() => {\n    const getResponses = async () => {\n      if (poll && actions.interactivityCenter && !fetchedInitialResponses.current) {\n        await actions.interactivityCenter.getPollResponses(poll, true);\n        fetchedInitialResponses.current = true;\n      }\n    };\n    getResponses();\n  }, [poll, actions.interactivityCenter]);\n\n  useEffect(() => {\n    if (poll?.questions) {\n      const localPeerResponses = getPeerResponses(poll.questions, localPeerId, customerUserId);\n      // @ts-ignore\n      localPeerResponses?.forEach(response => {\n        if (response) {\n          setSavedResponses(prev => {\n            const prevCopy = { ...prev };\n            prevCopy[response[0]?.questionIndex] = { option: response[0]?.option, options: response[0]?.options };\n            return prevCopy;\n          });\n        }\n      });\n    }\n  }, [localPeerId, poll?.questions, id, customerUserId]);\n\n  if (!poll) {\n    return null;\n  }\n\n  const canViewLeaderboard = poll.type === 'quiz' && poll.state === 'stopped' && !poll.anonymous;\n\n  return (\n    <Container rounded>\n      <Flex\n        align=\"center\"\n        css={{\n          gap: '$4',\n          py: '$6',\n          px: '$8',\n          my: '$4',\n          w: '100%',\n          color: '$on_surface_high',\n          borderBottom: '1px solid $border_default',\n        }}\n      >\n        <Flex\n          onClick={() => setPollView(POLL_VIEWS.CREATE_POLL_QUIZ)}\n          css={{ cursor: 'pointer', c: '$on_surface_medium', '&:hover': { color: '$on_surface_high' } }}\n        >\n          <ChevronLeftIcon />\n        </Flex>\n        <Text variant=\"h6\">{poll.title}</Text>\n        <StatusIndicator status={poll.state} />\n        <Box\n          css={{\n            marginLeft: 'auto',\n            cursor: 'pointer',\n            '&:hover': { opacity: '0.8' },\n            height: 'fit-content',\n          }}\n        >\n          <CrossIcon onClick={toggleVoting} />\n        </Box>\n      </Flex>\n\n      <Flex direction=\"column\" css={{ p: '$8 $10', flex: '1 1 0', overflowY: 'auto' }}>\n        {poll.state === 'started' ? (\n          <Text css={{ color: '$on_surface_medium', fontWeight: '$semiBold' }}>\n            {pollCreatorName || 'Participant'} started a {poll.type}\n          </Text>\n        ) : null}\n\n        {showSingleView ? (\n          <TimedView poll={poll} localPeerResponses={savedResponses} updateSavedResponses={setSavedResponses} />\n        ) : (\n          <StandardView poll={poll} localPeerResponses={savedResponses} updateSavedResponses={setSavedResponses} />\n        )}\n      </Flex>\n      <Flex\n        css={{ w: '100%', justifyContent: 'end', alignItems: 'center', p: '$8', borderTop: '1px solid $border_bright' }}\n      >\n        {poll.state === 'started' && canEndActivity && (\n          <Button\n            variant=\"danger\"\n            css={{ fontWeight: '$semiBold', w: 'max-content' }}\n            onClick={() => actions.interactivityCenter.stopPoll(id)}\n          >\n            End {poll.type}\n          </Button>\n        )}\n        {canViewLeaderboard ? (\n          <Button css={{ fontWeight: '$semiBold', w: 'max-content' }} onClick={() => setPollView(POLL_VIEWS.RESULTS)}>\n            View Leaderboard\n          </Button>\n        ) : null}\n      </Flex>\n    </Container>\n  );\n};\n", "import React, { Dispatch, SetStateAction } from 'react';\nimport { HMSPoll } from '@100mslive/react-sdk';\nimport { PeerParticipationSummary } from './PeerParticipationSummary';\n// @ts-ignore\nimport { QuestionCard } from './QuestionCard';\n\nexport const StandardView = ({\n  poll,\n  localPeerResponses,\n  updateSavedResponses,\n}: {\n  poll: HMSPoll;\n  localPeerResponses: Record<number, number | number[] | undefined>;\n  updateSavedResponses: Dispatch<SetStateAction<Record<any, any>>>;\n}) => {\n  if (!poll?.questions) {\n    return null;\n  }\n\n  const isQuiz = poll.type === 'quiz';\n  const isStopped = poll.state === 'stopped';\n\n  return (\n    <>\n      {isQuiz && isStopped ? <PeerParticipationSummary quiz={poll} /> : null}\n      {poll.questions?.map((question, index) => (\n        <QuestionCard\n          pollID={poll.id}\n          isQuiz={isQuiz}\n          startedBy={poll.startedBy}\n          pollState={poll.state}\n          key={`${question.text}-${index}`}\n          index={question.index}\n          text={question.text}\n          type={question.type}\n          result={question.result}\n          totalQuestions={poll.questions?.length || 0}\n          options={question.options}\n          localPeerResponse={localPeerResponses?.[question.index]}\n          answer={question.answer}\n          updateSavedResponses={updateSavedResponses}\n          rolesThatCanViewResponses={poll.rolesThatCanViewResponses}\n        />\n      ))}\n    </>\n  );\n};\n", "// @ts-check\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { match } from 'ts-pattern';\nimport { selectLocalPeer, selectLocalPeerRoleName, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { CheckCircleIcon, ChevronDownIcon, CrossCircleIcon } from '@100mslive/react-icons';\nimport { Box, Button, Flex, Text } from '../../../../';\nimport { checkCorrectAnswer } from '../../../common/utils';\nimport { MultipleChoiceOptions } from '../common/MultipleChoiceOptions';\nimport { SingleChoiceOptions } from '../common/SingleChoiceOptions';\nimport { QUESTION_TYPE } from '../../../common/constants';\n\nexport const QuestionCard = ({\n  pollID,\n  isQuiz,\n  startedBy,\n  pollState,\n  index,\n  totalQuestions,\n  result,\n  type,\n  text,\n  options = [],\n  answer,\n  localPeerResponse,\n  updateSavedResponses,\n  rolesThatCanViewResponses,\n}) => {\n  const actions = useHMSActions();\n  const localPeer = useHMSStore(selectLocalPeer);\n\n  const isLocalPeerCreator = localPeer?.id === startedBy;\n  const localPeerRoleName = useHMSStore(selectLocalPeerRoleName);\n  const roleCanViewResponse =\n    !rolesThatCanViewResponses ||\n    rolesThatCanViewResponses.length === 0 ||\n    rolesThatCanViewResponses.includes(localPeerRoleName || '');\n  const [localPeerChoice, setLocalPeerChoice] = useState(localPeerResponse);\n\n  useEffect(() => {\n    setLocalPeerChoice(localPeerResponse);\n  }, [localPeerResponse]);\n\n  const showVoteCount =\n    roleCanViewResponse && (localPeerChoice || (isLocalPeerCreator && pollState === 'stopped')) && !isQuiz;\n\n  const isLive = pollState === 'started';\n  const pollEnded = pollState === 'stopped';\n  const canRespond = isLive && !localPeerChoice;\n  const startTime = useRef(Date.now());\n  const isCorrectAnswer = checkCorrectAnswer(answer, localPeerChoice, type);\n\n  const [singleOptionAnswer, setSingleOptionAnswer] = useState();\n  const [multipleOptionAnswer, setMultipleOptionAnswer] = useState(new Set());\n  const [showOptions, setShowOptions] = useState(true);\n\n  const respondedToQuiz = isQuiz && localPeerChoice && !localPeerChoice.skipped;\n\n  const isValidVote = useMemo(() => {\n    if (type === QUESTION_TYPE.SINGLE_CHOICE) {\n      return singleOptionAnswer !== undefined;\n    } else if (type === QUESTION_TYPE.MULTIPLE_CHOICE) {\n      return multipleOptionAnswer.size > 0;\n    }\n  }, [singleOptionAnswer, multipleOptionAnswer, type]);\n\n  const handleVote = useCallback(async () => {\n    if (!isValidVote) {\n      return;\n    }\n    const submittedResponse = {\n      questionIndex: index,\n      option: singleOptionAnswer,\n      options: Array.from(multipleOptionAnswer),\n      duration: Date.now() - startTime.current,\n    };\n    await actions.interactivityCenter.addResponsesToPoll(pollID, [submittedResponse]);\n    updateSavedResponses(prev => {\n      const prevCopy = { ...prev };\n      prevCopy[index] = { option: singleOptionAnswer, options: Array.from(multipleOptionAnswer) };\n      return prevCopy;\n    });\n    startTime.current = Date.now();\n  }, [\n    isValidVote,\n    index,\n    singleOptionAnswer,\n    multipleOptionAnswer,\n    actions.interactivityCenter,\n    pollID,\n    updateSavedResponses,\n  ]);\n\n  return (\n    <Box\n      css={{\n        backgroundColor: '$surface_bright',\n        borderRadius: '$1',\n        p: '$md',\n        mt: '$md',\n        border:\n          respondedToQuiz && !isLive\n            ? `1px solid ${isCorrectAnswer ? '$alert_success' : '$alert_error_default'}`\n            : 'none',\n      }}\n    >\n      <Flex align=\"center\" justify=\"between\">\n        <Text\n          variant=\"caption\"\n          css={{\n            color: match({ respondedToQuiz, isLive, isCorrectAnswer })\n              .when(\n                ({ respondedToQuiz, isLive }) => respondedToQuiz && !isLive,\n                ({ isCorrectAnswer }) => (isCorrectAnswer ? '$alert_success' : '$alert_error_default'),\n              )\n              .otherwise(() => '$on_surface_low'),\n            fontWeight: '$semiBold',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '$4',\n          }}\n        >\n          {match({ respondedToQuiz, pollEnded, isCorrectAnswer })\n            .when(\n              ({ respondedToQuiz, pollEnded }) => respondedToQuiz && pollEnded,\n              ({ isCorrectAnswer }) => {\n                return isCorrectAnswer ? (\n                  <CheckCircleIcon height={16} width={16} />\n                ) : (\n                  <CrossCircleIcon height={16} width={16} />\n                );\n              },\n            )\n            .otherwise(() => null)}\n          QUESTION {index} OF {totalQuestions}: {type.toUpperCase()}\n        </Text>\n      </Flex>\n\n      <Flex justify=\"between\" css={{ my: '$md' }}>\n        <Text css={{ color: '$on_surface_high' }}>{text}</Text>\n        <Box\n          css={{ color: '$on_surface_medium', '&:hover': { color: '$on_surface_high', cursor: 'pointer' } }}\n          onClick={() => setShowOptions(prev => !prev)}\n        >\n          <ChevronDownIcon\n            style={{ transform: showOptions ? 'rotate(180deg)' : 'rotate(0deg)', transition: 'transform 0.3s ease' }}\n          />\n        </Box>\n      </Flex>\n\n      <Box\n        css={{ maxHeight: showOptions ? '$80' : '0', transition: 'max-height 0.3s ease', overflowY: 'auto', mb: '$4' }}\n      >\n        {type === QUESTION_TYPE.SINGLE_CHOICE ? (\n          <SingleChoiceOptions\n            key={index}\n            questionIndex={index}\n            isQuiz={isQuiz}\n            canRespond={canRespond}\n            correctOptionIndex={answer?.option}\n            options={options}\n            setAnswer={setSingleOptionAnswer}\n            totalResponses={result?.totalResponses}\n            showVoteCount={showVoteCount}\n            localPeerResponse={localPeerChoice}\n            isStopped={pollState === 'stopped'}\n          />\n        ) : null}\n\n        {type === QUESTION_TYPE.MULTIPLE_CHOICE ? (\n          <MultipleChoiceOptions\n            questionIndex={index}\n            isQuiz={isQuiz}\n            canRespond={canRespond}\n            correctOptionIndexes={answer?.options}\n            options={options}\n            selectedOptions={multipleOptionAnswer}\n            setSelectedOptions={setMultipleOptionAnswer}\n            totalResponses={result?.totalResponses}\n            showVoteCount={showVoteCount}\n            localPeerResponse={localPeerChoice}\n            isStopped={pollState === 'stopped'}\n          />\n        ) : null}\n      </Box>\n      {isLive && (\n        <QuestionActions isValidVote={isValidVote} onVote={handleVote} response={localPeerChoice} isQuiz={isQuiz} />\n      )}\n    </Box>\n  );\n};\n\nconst QuestionActions = ({ isValidVote, response, isQuiz, onVote }) => {\n  return (\n    <Flex align=\"center\" justify=\"end\" css={{ gap: '$4', w: '100%' }}>\n      {response ? (\n        <Text css={{ fontWeight: '$semiBold', color: '$on_surface_medium' }}>\n          {response.skipped ? 'Skipped' : null}\n          {isQuiz && !response.skipped ? 'Answered' : null}\n          {!isQuiz && !response.skipped ? 'Voted' : null}\n        </Text>\n      ) : (\n        <Button css={{ p: '$xs $10', fontWeight: '$semiBold' }} disabled={!isValidVote} onClick={onVote}>\n          {isQuiz ? 'Answer' : 'Vote'}\n        </Button>\n      )}\n    </Flex>\n  );\n};\n", "import React, { Dispatch, SetStateAction, useEffect, useState } from 'react';\nimport { HMSPoll } from '@100mslive/react-sdk';\n// @ts-ignore\nimport { QuestionCard } from './QuestionCard';\n// @ts-ignore\nimport { getIndexToShow } from '../../../common/utils';\n\nexport const TimedView = ({\n  poll,\n  localPeerResponses,\n  updateSavedResponses,\n}: {\n  poll: HMSPoll;\n  localPeerResponses?: Record<number, number | number[] | undefined>;\n  updateSavedResponses: Dispatch<SetStateAction<Record<any, any>>>;\n}) => {\n  const [currentIndex, setCurrentIndex] = useState(getIndexToShow(localPeerResponses));\n  const activeQuestion = poll.questions?.find(question => question.index === currentIndex);\n  const attemptedAll = (poll.questions?.length || 0) < currentIndex;\n\n  // Handles increments so only one question is shown at a time in quiz\n  useEffect(() => {\n    setCurrentIndex(getIndexToShow(localPeerResponses));\n  }, [localPeerResponses]);\n\n  if ((!activeQuestion && !attemptedAll) || !poll.questions?.length) {\n    return null;\n  }\n\n  return (\n    <>\n      {poll.questions.map(question => {\n        return attemptedAll || activeQuestion?.index === question.index ? (\n          <QuestionCard\n            key={question.index}\n            pollID={poll.id}\n            isQuiz={poll.type === 'quiz'}\n            startedBy={poll.startedBy}\n            pollState={poll.state}\n            index={question.index}\n            text={question.text}\n            type={question.type}\n            result={question?.result}\n            totalQuestions={poll.questions?.length || 0}\n            options={question.options}\n            localPeerResponse={localPeerResponses?.[question.index]}\n            answer={question.answer}\n            rolesThatCanViewResponses={poll.rolesThatCanViewResponses}\n            updateSavedResponses={updateSavedResponses}\n          />\n        ) : null;\n      })}\n    </>\n  );\n};\n", "import React from 'react';\nimport { CrossIcon } from '@100mslive/react-icons';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\n// @ts-ignore: No implicit any\nimport { Logo } from '../Header/HeaderComponents';\nimport { RoomDetailsRow } from './RoomDetailsRow';\nimport { useRoomLayoutHeader } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore\nimport { useSidepaneToggle } from '../AppData/useSidepane';\nimport { useMobileHLSStream } from '../../common/hooks';\nimport { SIDE_PANE_OPTIONS } from '../../common/constants';\n\nexport const RoomDetailsPane = () => {\n  const { description } = useRoomLayoutHeader();\n  const isMwebHLSStream = useMobileHLSStream();\n  return (\n    <Box css={{ flex: '1 1 0', position: 'relative' }}>\n      {isMwebHLSStream ? (\n        <Flex direction=\"row\" align=\"center\" gap=\"2\">\n          <Logo />\n          <ShowRoomDetailHeader />\n        </Flex>\n      ) : (\n        <ShowRoomDetailHeader />\n      )}\n      <Box css={{ mt: '$10' }}>\n        <Text css={{ color: '$on_surface_high', fontWeight: '$semiBold', display: isMwebHLSStream ? 'none' : '' }}>\n          Description\n        </Text>\n        <Text variant=\"sm\" css={{ c: '$on_surface_medium' }}>\n          {description}\n        </Text>\n      </Box>\n    </Box>\n  );\n};\n\nconst ShowRoomDetailHeader = () => {\n  const { title, details } = useRoomLayoutHeader();\n  const toggleDetailsPane = useSidepaneToggle(SIDE_PANE_OPTIONS.ROOM_DETAILS);\n  const isMwebHLSStream = useMobileHLSStream();\n  return (\n    <Flex direction=\"column\" css={{ position: 'sticky', top: 0, bg: '$surface_dim' }}>\n      <Flex justify=\"between\" align=\"center\" css={{ w: '100%' }}>\n        <Text variant=\"h6\">{title}</Text>\n        {!isMwebHLSStream && (\n          <Flex\n            onClick={toggleDetailsPane}\n            css={{\n              color: '$on_surface_high',\n              cursor: 'pointer',\n              '&:hover': { opacity: '0.8' },\n            }}\n          >\n            <CrossIcon />\n          </Flex>\n        )}\n      </Flex>\n      <RoomDetailsRow details={details} />\n    </Flex>\n  );\n};\n", "import React, { useEffect, useState } from 'react';\nimport { selectDominantSpeaker, useHMSStore } from '@100mslive/react-sdk';\nimport { VolumeOneIcon } from '@100mslive/react-icons';\nimport { Flex, styled, Text, textEllipsis } from '../../../';\nimport { useRoomLayout } from '../../provider/roomLayoutProvider';\n\nexport const SpeakerTag = () => {\n  const dominantSpeaker = useHMSStore(selectDominantSpeaker);\n  return (\n    dominantSpeaker &&\n    dominantSpeaker.name && (\n      <Flex\n        align=\"center\"\n        justify=\"center\"\n        css={{ flex: '1 1 0', color: '$on_surface_high', '@md': { display: 'none' } }}\n      >\n        <VolumeOneIcon />\n        <Text variant=\"sm\" css={{ ...textEllipsis(200), ml: '$2' }} title={dominantSpeaker.name}>\n          {dominantSpeaker.name}\n        </Text>\n      </Flex>\n    )\n  );\n};\n\nconst LogoImg = styled('img', {\n  maxHeight: '$14',\n  w: 'auto',\n  objectFit: 'contain',\n  '@md': {\n    maxHeight: '$12',\n  },\n});\n\nexport const Logo = () => {\n  const roomLayout = useRoomLayout();\n  const logo = roomLayout?.logo?.url;\n  const [hideImage, setHideImage] = useState(false);\n  // Hide logo for now as there is not enough space\n  useEffect(() => {\n    if (hideImage) {\n      setHideImage(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [logo]);\n\n  return logo && !hideImage ? (\n    <LogoImg\n      src={logo}\n      alt=\"Brand Logo\"\n      onError={e => {\n        e.target.onerror = null;\n        setHideImage(true);\n      }}\n    />\n  ) : null;\n};\n", "import React from 'react';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { Duration } from './Duration';\n\nexport const RoomDetailsRow = ({ details }: { details: (string | Date)[] }) => {\n  return (\n    <Flex align=\"center\" css={{ w: '100%' }}>\n      {details.map((detail, index) => (\n        <React.Fragment key={detail.toString()}>\n          {index > 0 && <Box css={{ h: '$2', w: '$2', r: '$round', bg: '$on_surface_medium', m: '0 $2' }} />}\n          {typeof detail !== 'string' ? (\n            <Duration timestamp={detail} />\n          ) : (\n            <Text variant=\"xs\" css={{ c: '$on_surface_medium' }}>\n              {detail}\n            </Text>\n          )}\n        </React.Fragment>\n      ))}\n    </Flex>\n  );\n};\n", "import React, { useEffect, useState } from 'react';\nimport { Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { getFormattedTime } from '../Polls/common/utils';\n\nexport const Duration = ({ timestamp }: { timestamp: Date }) => {\n  const [elapsedTime, setElapsedTime] = useState(getFormattedTime(Date.now() - timestamp.getTime(), false));\n\n  useEffect(() => {\n    const timerAdded = setInterval(() => {\n      setElapsedTime(getFormattedTime(Date.now() - timestamp.getTime(), false));\n    }, 1000);\n\n    return () => {\n      clearInterval(timerAdded);\n    };\n  }, [timestamp]);\n\n  return (\n    <Flex css={{ color: '$on_surface_medium' }}>\n      <Text variant=\"xs\" css={{ color: 'inherit' }}>\n        Started {elapsedTime} ago\n      </Text>\n    </Flex>\n  );\n};\n", "import React, { useEffect, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { DefaultConferencingScreen_Elements } from '@100mslive/types-prebuilt';\nimport { match } from 'ts-pattern';\nimport { selectPeerCount, useHMSStore } from '@100mslive/react-sdk';\nimport { CrossIcon } from '@100mslive/react-icons';\nimport { Chat } from './Chat/Chat';\nimport { PaginatedParticipants } from './Footer/PaginatedParticipants';\nimport { ParticipantList } from './Footer/ParticipantList';\nimport { Box, config as cssConfig, Flex, IconButton, Tabs, Text } from '../..';\nimport { Tooltip } from '../../Tooltip';\nimport { ChatSettings } from './ChatSettings';\nimport { useRoomLayoutConferencingScreen } from '../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { useIsSidepaneTypeOpen, useSidepaneReset, useSidepaneToggle } from './AppData/useSidepane';\n// @ts-ignore: No implicit Any\nimport { getFormattedCount } from '../common/utils';\nimport { SIDE_PANE_OPTIONS } from '../common/constants';\n\nconst tabTriggerCSS = {\n  color: '$on_surface_low',\n  p: '$4',\n  fontWeight: '$semiBold',\n  fontSize: '$sm',\n  w: '100%',\n  justifyContent: 'center',\n  '&[data-state=\"active\"]': {\n    color: '$on_surface_high',\n  },\n};\n\nconst ParticipantCount = ({ count }: { count: number }) => {\n  return count < 1000 ? (\n    <span>({count})</span>\n  ) : (\n    <Tooltip title={count}>\n      <span>({getFormattedCount(count)})</span>\n    </Tooltip>\n  );\n};\n\nexport const SidePaneTabs = React.memo<{\n  active: 'Participants | Chat';\n  hideTab?: boolean;\n}>(({ active = SIDE_PANE_OPTIONS.CHAT, hideTab = false }) => {\n  const toggleChat = useSidepaneToggle(SIDE_PANE_OPTIONS.CHAT);\n  const toggleParticipants = useSidepaneToggle(SIDE_PANE_OPTIONS.PARTICIPANTS);\n  const resetSidePane = useSidepaneReset();\n  const [activeTab, setActiveTab] = useState(active);\n  const [activeRole, setActiveRole] = useState('');\n  const peerCount = useHMSStore(selectPeerCount);\n  const { elements, screenType } = useRoomLayoutConferencingScreen();\n  const chat_title = elements?.chat?.chat_title || 'Chat';\n  const showChat = !!elements?.chat;\n  const showParticipants = !!elements?.participant_list;\n  const hideTabs = !(showChat && showParticipants) || hideTab;\n  const isMobile = useMedia(cssConfig.media.md);\n  const isOverlayChat = !!elements?.chat?.is_overlay && isMobile;\n  const { off_stage_roles = [] } = (elements as DefaultConferencingScreen_Elements)?.on_stage_exp || {};\n  const isChatOpen = useIsSidepaneTypeOpen(SIDE_PANE_OPTIONS.CHAT);\n  const showChatSettings = showChat && isChatOpen && (!isMobile || !isOverlayChat);\n\n  useEffect(() => {\n    match({ activeTab, showChat, showParticipants })\n      .with({ activeTab: SIDE_PANE_OPTIONS.CHAT, showChat: false, showParticipants: true }, () => {\n        setActiveTab(SIDE_PANE_OPTIONS.PARTICIPANTS);\n      })\n      .with({ activeTab: SIDE_PANE_OPTIONS.PARTICIPANTS, showChat: true, showParticipants: false }, () => {\n        setActiveTab(SIDE_PANE_OPTIONS.CHAT);\n      })\n      .with({ showChat: false, showParticipants: false }, () => {\n        resetSidePane();\n      });\n  }, [showChat, activeTab, showParticipants, resetSidePane]);\n\n  useEffect(() => {\n    setActiveTab(active);\n  }, [active]);\n\n  if (activeRole) {\n    return (\n      <Flex\n        direction=\"column\"\n        css={{\n          color: '$on_primary_high',\n          h: '100%',\n          transition: 'margin 0.3s ease-in-out',\n          position: 'relative',\n        }}\n      >\n        <Box css={{ position: 'absolute', left: 0, top: 0, size: '100%', zIndex: 21, bg: '$surface_dim' }}>\n          <PaginatedParticipants roleName={activeRole} onBack={() => setActiveRole('')} />\n        </Box>\n      </Flex>\n    );\n  }\n\n  return (\n    <Flex\n      direction=\"column\"\n      css={{\n        color: '$on_primary_high',\n        h: '100%',\n        transition: 'margin 0.3s ease-in-out',\n      }}\n    >\n      {match({ isOverlayChat, isChatOpen, showChat, hideTabs })\n        .with({ isOverlayChat: true, isChatOpen: true, showChat: true }, () => <Chat />)\n        .with({ hideTabs: true }, () => {\n          return (\n            <>\n              <Flex justify=\"between\" css={{ w: '100%', '&:empty': { display: 'none' } }}>\n                <Text\n                  variant=\"sm\"\n                  css={{\n                    fontWeight: '$semiBold',\n                    p: '$4',\n                    c: '$on_surface_high',\n                    pr: '$12',\n                    '&:empty': { display: 'none' },\n                  }}\n                >\n                  {activeTab === SIDE_PANE_OPTIONS.CHAT ? (\n                    screenType !== 'hls_live_streaming' && chat_title\n                  ) : (\n                    <span>\n                      Participants&nbsp;\n                      <ParticipantCount count={peerCount} />\n                    </span>\n                  )}\n                </Text>\n                <Flex>\n                  {showChatSettings ? <ChatSettings /> : null}\n                  {isOverlayChat && isChatOpen ? null : (\n                    <IconButton\n                      css={{\n                        my: '$1',\n                        color: '$on_surface_medium',\n                        '&:hover': { color: '$on_surface_high' },\n                        '&:empty': { display: 'none' },\n                      }}\n                      onClick={e => {\n                        e.stopPropagation();\n                        if (activeTab === SIDE_PANE_OPTIONS.CHAT) {\n                          toggleChat();\n                        } else {\n                          toggleParticipants();\n                        }\n                      }}\n                      data-testid=\"close_chat\"\n                    >\n                      {screenType === 'hls_live_streaming' && isChatOpen ? null : <CrossIcon />}\n                    </IconButton>\n                  )}\n                </Flex>\n              </Flex>\n              {activeTab === SIDE_PANE_OPTIONS.CHAT ? (\n                <Chat />\n              ) : (\n                <ParticipantList offStageRoles={off_stage_roles} onActive={setActiveRole} />\n              )}\n            </>\n          );\n        })\n        .otherwise(() => {\n          return (\n            <Tabs.Root\n              value={activeTab}\n              onValueChange={setActiveTab}\n              css={{\n                flexDirection: 'column',\n                size: '100%',\n              }}\n            >\n              <Flex css={{ w: '100%' }}>\n                <Tabs.List css={{ flexGrow: 1, borderRadius: '$2', bg: '$surface_default' }}>\n                  <Tabs.Trigger value={SIDE_PANE_OPTIONS.CHAT} onClick={toggleChat} css={tabTriggerCSS}>\n                    {chat_title}\n                  </Tabs.Trigger>\n                  <Tabs.Trigger value={SIDE_PANE_OPTIONS.PARTICIPANTS} onClick={toggleParticipants} css={tabTriggerCSS}>\n                    Participants&nbsp;\n                    <ParticipantCount count={peerCount} />\n                  </Tabs.Trigger>\n                </Tabs.List>\n                {showChatSettings ? <ChatSettings /> : null}\n                {isOverlayChat && isChatOpen ? null : (\n                  <IconButton\n                    css={{ my: '$1', color: '$on_surface_medium', '&:hover': { color: '$on_surface_high' } }}\n                    onClick={e => {\n                      e.stopPropagation();\n                      if (activeTab === SIDE_PANE_OPTIONS.CHAT) {\n                        toggleChat();\n                      } else {\n                        toggleParticipants();\n                      }\n                    }}\n                    data-testid=\"close_chat\"\n                  >\n                    <CrossIcon />\n                  </IconButton>\n                )}\n              </Flex>\n              <Tabs.Content value={SIDE_PANE_OPTIONS.PARTICIPANTS} css={{ p: 0 }}>\n                <ParticipantList offStageRoles={off_stage_roles} onActive={setActiveRole} />\n              </Tabs.Content>\n              <Tabs.Content value={SIDE_PANE_OPTIONS.CHAT} css={{ p: 0 }}>\n                <Chat />\n              </Tabs.Content>\n            </Tabs.Root>\n          );\n        })}\n    </Flex>\n  );\n});\n", "import React, { MutableRefObject, useCallback, useRef } from 'react';\nimport { useMedia } from 'react-use';\nimport { VariableSizeList } from 'react-window';\nimport { selectSessionStore, selectUnreadHMSMessagesCount } from '@100mslive/hms-video-store';\nimport { match } from 'ts-pattern';\nimport { selectHMSMessagesCount, useHMSActions, useHMSStore, useHMSVanillaStore } from '@100mslive/react-sdk';\nimport { ChevronDownIcon } from '@100mslive/react-icons';\nimport { Button } from '../../../Button';\nimport { Box, Flex } from '../../../Layout';\nimport { config as cssConfig } from '../../../Theme';\n// @ts-ignore: No implicit any\nimport { EmojiReaction } from '../EmojiReaction';\nimport { MoreSettings } from '../MoreSettings/MoreSettings';\nimport { RaiseHand } from '../RaiseHand';\nimport { ChatBody } from './ChatBody';\nimport { ChatFooter } from './ChatFooter';\nimport { ChatBlocked, ChatPaused } from './ChatStates';\nimport { PinnedMessage } from './PinnedMessage';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useSidepaneResetOnLayoutUpdate } from '../AppData/useSidepaneResetOnLayoutUpdate';\nimport { useIsPeerBlacklisted } from '../hooks/useChatBlacklist';\nimport { useLandscapeHLSStream, useMobileHLSStream } from '../../common/hooks';\nimport { SESSION_STORE_KEY, SIDE_PANE_OPTIONS } from '../../common/constants';\n\nexport const Chat = () => {\n  const { elements, screenType } = useRoomLayoutConferencingScreen();\n  const listRef = useRef<VariableSizeList | null>(null);\n  const hmsActions = useHMSActions();\n  const vanillaStore = useHMSVanillaStore();\n  const { enabled: isChatEnabled = true } = useHMSStore(selectSessionStore(SESSION_STORE_KEY.CHAT_STATE)) || {};\n  const isMobile = useMedia(cssConfig.media.md);\n  const isMobileHLSStream = useMobileHLSStream();\n  const isLandscapeStream = useLandscapeHLSStream();\n  useSidepaneResetOnLayoutUpdate('chat', SIDE_PANE_OPTIONS.CHAT);\n  const isLocalPeerBlacklisted = useIsPeerBlacklisted({ local: true });\n\n  const scrollToBottom = useCallback(\n    (unreadCount = 0) => {\n      if (listRef.current && listRef.current.scrollToItem && unreadCount > 0) {\n        const messagesCount = vanillaStore.getState(selectHMSMessagesCount);\n        listRef.current?.scrollToItem(messagesCount, 'end');\n        requestAnimationFrame(() => {\n          listRef.current?.scrollToItem(messagesCount, 'end');\n        });\n        hmsActions.setMessageRead(true);\n      }\n    },\n    [hmsActions, vanillaStore],\n  );\n\n  const streaming = isMobileHLSStream || isLandscapeStream;\n\n  return (\n    <Flex\n      direction=\"column\"\n      justify=\"end\"\n      css={{\n        size: '100%',\n        gap: '$4',\n      }}\n    >\n      {isMobile && elements?.chat?.is_overlay && !streaming ? null : <PinnedMessage />}\n      <ChatBody ref={listRef} scrollToBottom={scrollToBottom} />\n      <Flex align=\"center\" css={{ w: '100%', gap: '$2' }}>\n        <ChatPaused />\n        <ChatBlocked />\n        {streaming && (!isChatEnabled || isLocalPeerBlacklisted) && (\n          <>\n            <RaiseHand css={{ bg: '$surface_default' }} />\n            <MoreSettings elements={elements} screenType={screenType} />\n          </>\n        )}\n      </Flex>\n      {isMobile && elements?.chat?.is_overlay && !streaming ? <PinnedMessage /> : null}\n      {isChatEnabled ? (\n        <ChatFooter onSend={scrollToBottom}>\n          <NewMessageIndicator scrollToBottom={scrollToBottom} listRef={listRef} />\n        </ChatFooter>\n      ) : null}\n      {streaming && (\n        <Box\n          css={{\n            position: 'absolute',\n            ...match({ isLandscapeStream, isMobileHLSStream, isChatEnabled, isLocalPeerBlacklisted })\n              .with(\n                {\n                  isLandscapeStream: true,\n                  isChatEnabled: true,\n                },\n                () => ({ bottom: '$19', right: '$10' }),\n              )\n              .with(\n                {\n                  isLandscapeStream: true,\n                  isChatEnabled: false,\n                },\n                () => ({ bottom: '$20', right: '$10' }),\n              )\n              .with(\n                {\n                  isMobileHLSStream: true,\n                  isChatEnabled: false,\n                },\n                () => ({ bottom: '$19', right: '$8' }),\n              )\n              .with(\n                {\n                  isMobileHLSStream: true,\n                  isChatEnabled: true,\n                  isLocalPeerBlacklisted: false,\n                },\n                () => ({ bottom: '$17', right: '$8' }),\n              )\n              .with(\n                {\n                  isLandscapeStream: false,\n                  isChatEnabled: true,\n                  isLocalPeerBlacklisted: true,\n                },\n                () => ({ bottom: '$18', right: '$8' }),\n              )\n              .with(\n                {\n                  isMobileHLSStream: true,\n                  isLocalPeerBlacklisted: true,\n                },\n                () => ({ bottom: '$20', right: '$8' }),\n              )\n              .otherwise(() => ({})),\n          }}\n        >\n          <EmojiReaction />\n        </Box>\n      )}\n    </Flex>\n  );\n};\n\nconst NewMessageIndicator = ({\n  scrollToBottom,\n  listRef,\n}: {\n  scrollToBottom: (count: number) => void;\n  listRef: MutableRefObject<VariableSizeList | null>;\n}) => {\n  const unreadCount = useHMSStore(selectUnreadHMSMessagesCount);\n  if (!unreadCount || !listRef.current) {\n    return null;\n  }\n  // @ts-ignore\n  const outerElement = listRef.current._outerRef;\n  if (\n    outerElement &&\n    outerElement.clientHeight + outerElement.scrollTop + outerElement.offsetTop >= outerElement.scrollHeight\n  ) {\n    return null;\n  }\n\n  return (\n    <Flex\n      justify=\"center\"\n      css={{\n        width: '100%',\n        left: 0,\n        bottom: '$28',\n        position: 'absolute',\n      }}\n    >\n      <Button\n        variant=\"standard\"\n        onClick={() => {\n          scrollToBottom(unreadCount);\n        }}\n        icon\n        css={{\n          p: '$3 $4',\n          pl: '$6',\n          '& > svg': { ml: '$4' },\n          borderRadius: '$round',\n          fontSize: '$xs',\n          fontWeight: '$semiBold',\n          c: '$on_secondary_high',\n        }}\n      >\n        New {unreadCount === 1 ? 'message' : 'messages'}\n        <ChevronDownIcon height={16} width={16} />\n      </Button>\n    </Flex>\n  );\n};\n", "import React, { ReactNode, useCallback, useEffect, useRef, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport data from '@emoji-mart/data';\nimport Picker from '@emoji-mart/react';\nimport { HMSException, selectLocalPeer, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { EmojiIcon, PauseCircleIcon, SendIcon, VerticalMenuIcon } from '@100mslive/react-icons';\nimport { Box, config as cssConfig, Flex, IconButton as BaseIconButton, Popover, styled, Text } from '../../..';\nimport { IconButton } from '../../../IconButton';\nimport { MoreSettings } from '../MoreSettings/MoreSettings';\nimport { RaiseHand } from '../RaiseHand';\n// @ts-ignore: No implicit any\nimport { ToastManager } from '../Toast/ToastManager';\nimport { ChatSelectorContainer } from './ChatSelectorContainer';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit any\nimport { useChatDraftMessage } from '../AppData/useChatState';\n// @ts-ignore: No implicit any\nimport { useSetSubscribedChatSelector, useSubscribeChatSelector } from '../AppData/useUISettings';\nimport { useIsPeerBlacklisted } from '../hooks/useChatBlacklist';\n// @ts-ignore: No implicit any\nimport { useEmojiPickerStyles } from './useEmojiPickerStyles';\nimport { useDefaultChatSelection, useLandscapeHLSStream, useMobileHLSStream } from '../../common/hooks';\nimport { CHAT_MESSAGE_LIMIT } from './utils';\nimport { CHAT_SELECTOR, SESSION_STORE_KEY } from '../../common/constants';\n\nconst TextArea = styled('textarea', {\n  width: '100%',\n  bg: 'transparent',\n  color: '$on_primary_high',\n  resize: 'none',\n  lineHeight: '1rem',\n  position: 'relative',\n  fontFamily: '$sans',\n  fontSize: '100%',\n  margin: 0,\n  padding: 0,\n  top: '$3',\n  '&:focus': {\n    boxShadow: 'none',\n    outline: 'none',\n  },\n});\n\nfunction EmojiPicker({ onSelect }: { onSelect: (emoji: any) => void }) {\n  const [showEmoji, setShowEmoji] = useState(false);\n  const ref = useEmojiPickerStyles(showEmoji);\n  return (\n    <Popover.Root open={showEmoji} onOpenChange={setShowEmoji}>\n      <Popover.Trigger asChild css={{ appearance: 'none' }}>\n        <BaseIconButton as=\"div\">\n          <EmojiIcon />\n        </BaseIconButton>\n      </Popover.Trigger>\n      <Popover.Portal>\n        <Popover.Content\n          alignOffset={-40}\n          sideOffset={16}\n          align=\"end\"\n          css={{\n            p: 0,\n          }}\n        >\n          <Box\n            css={{\n              minWidth: 352,\n              minHeight: 435,\n            }}\n            ref={ref}\n          >\n            <Picker onEmojiSelect={onSelect} data={data} previewPosition=\"none\" skinPosition=\"search\" />\n          </Box>\n        </Popover.Content>\n      </Popover.Portal>\n    </Popover.Root>\n  );\n}\n\nexport const ChatFooter = ({ onSend, children }: { onSend: (count: number) => void; children?: ReactNode }) => {\n  const hmsActions = useHMSActions();\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n  const [draftMessage, setDraftMessage] = useChatDraftMessage();\n  const isMobile = useMedia(cssConfig.media.md);\n  const { elements, screenType } = useRoomLayoutConferencingScreen();\n  const message_placeholder = elements?.chat?.message_placeholder || 'Send a message';\n  const localPeer = useHMSStore(selectLocalPeer);\n  const isOverlayChat = elements?.chat?.is_overlay;\n  const canDisableChat = !!elements?.chat?.real_time_controls?.can_disable_chat;\n  const selectedPeer = useSubscribeChatSelector(CHAT_SELECTOR.PEER);\n  const [selectedRole, setRoleSelector] = useSetSubscribedChatSelector(CHAT_SELECTOR.ROLE);\n  const defaultSelection = useDefaultChatSelection();\n  const selection = selectedPeer.name || selectedRole || defaultSelection;\n  const isLocalPeerBlacklisted = useIsPeerBlacklisted({ local: true });\n  const isMwebHLSStream = useMobileHLSStream();\n  const [messageLengthExceeded, setMessageLengthExceeded] = useState(false);\n  const isLandscapeHLSStream = useLandscapeHLSStream();\n\n  useEffect(() => {\n    if (!selectedPeer.id && !selectedRole && !['Everyone', ''].includes(defaultSelection)) {\n      setRoleSelector(defaultSelection);\n    } else {\n      // @ts-ignore\n      if (!(isMobile || isLandscapeHLSStream) && !elements?.chat?.disable_autofocus) {\n        inputRef.current?.focus();\n      }\n    }\n  }, [defaultSelection, selectedPeer, selectedRole, setRoleSelector, isMobile, isLandscapeHLSStream, elements?.chat]);\n\n  const resetInputHeight = useCallback(() => {\n    if (inputRef.current) {\n      inputRef.current.style.height = `${Math.max(\n        32,\n        inputRef.current.value ? Math.min(inputRef.current.scrollHeight, 24 * 4) : 0,\n      )}px`;\n    }\n  }, []);\n\n  const updateInputHeight = useCallback(() => {\n    if (inputRef.current) {\n      inputRef.current.style.height = `${Math.max(32, Math.min(inputRef.current.scrollHeight, 24 * 4))}px`;\n    }\n  }, []);\n\n  const sendMessage = useCallback(async () => {\n    const message = inputRef?.current?.value;\n    if (!message || !message.trim().length) {\n      return;\n    }\n    try {\n      if (selectedRole) {\n        await hmsActions.sendGroupMessage(message, [selectedRole]);\n      } else if (selectedPeer.id) {\n        await hmsActions.sendDirectMessage(message, selectedPeer.id);\n      } else {\n        await hmsActions.sendBroadcastMessage(message);\n      }\n      inputRef.current.value = '';\n      resetInputHeight();\n      setTimeout(() => {\n        onSend(1);\n      }, 0);\n    } catch (error) {\n      const err = error as HMSException;\n      ToastManager.addToast({\n        title: err.message.startsWith('Invalid peer') ? `${selectedPeer.name} is not in this room` : err.message,\n      });\n    }\n  }, [selectedRole, selectedPeer, hmsActions, onSend]);\n\n  useEffect(() => {\n    const messageElement = inputRef.current;\n    if (messageElement) {\n      messageElement.value = draftMessage;\n      updateInputHeight();\n      setMessageLengthExceeded(draftMessage.length > CHAT_MESSAGE_LIMIT);\n    }\n  }, [draftMessage]);\n\n  useEffect(() => {\n    const messageElement = inputRef.current;\n    return () => {\n      setDraftMessage(messageElement?.value || '');\n    };\n  }, [setDraftMessage]);\n\n  if (isLocalPeerBlacklisted) {\n    return null;\n  }\n\n  return (\n    <Box css={{ position: 'relative' }}>\n      <Flex>\n        <ChatSelectorContainer />\n        {canDisableChat && isMobile && isOverlayChat ? (\n          <Flex align=\"center\" justify=\"end\" css={{ mb: '$4' }} onClick={e => e.stopPropagation()}>\n            <Popover.Root>\n              <Popover.Trigger asChild>\n                <IconButton css={{ border: '1px solid $border_bright' }}>\n                  <VerticalMenuIcon height=\"16\" width=\"16\" />\n                </IconButton>\n              </Popover.Trigger>\n              <Popover.Portal>\n                <Popover.Content\n                  align=\"end\"\n                  side=\"top\"\n                  onClick={() => {\n                    const chatState = {\n                      enabled: false,\n                      updatedBy: {\n                        peerId: localPeer?.id,\n                        userId: localPeer?.customerUserId,\n                        userName: localPeer?.name,\n                      },\n                      updatedAt: Date.now(),\n                    };\n                    hmsActions.sessionStore.set(SESSION_STORE_KEY.CHAT_STATE, chatState);\n                  }}\n                  css={{\n                    backgroundColor: '$surface_default',\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '$4',\n                    borderRadius: '$1',\n                    color: '$on_surface_high',\n                    cursor: 'pointer',\n                    '&:hover': { backgroundColor: '$surface_dim' },\n                  }}\n                >\n                  <PauseCircleIcon />\n                  <Text variant=\"sm\" css={{ fontWeight: '$semiBold' }}>\n                    Pause Chat\n                  </Text>\n                </Popover.Content>\n              </Popover.Portal>\n            </Popover.Root>\n          </Flex>\n        ) : null}\n      </Flex>\n      {selection && (\n        <Flex align={inputRef.current?.scrollHeight === 32 ? 'center' : 'end'} css={{ gap: '$4', w: '100%' }}>\n          <Flex\n            align=\"end\"\n            css={{\n              bg: isOverlayChat && isMobile ? '$surface_dim' : '$surface_default',\n              minHeight: '$16',\n              position: 'relative',\n              py: isOverlayChat && isMobile ? '$2' : '$6',\n              pl: '$8',\n              flexGrow: 1,\n              r: '$1',\n              '@md': {\n                minHeight: '$14',\n                boxSizing: 'border-box',\n              },\n              ...(isLandscapeHLSStream ? { minHeight: '$14', py: 0 } : {}),\n            }}\n          >\n            {children}\n            <TextArea\n              maxLength={CHAT_MESSAGE_LIMIT + 10}\n              css={{\n                c: '$on_surface_high',\n                '&:valid ~ .send-msg': { color: '$on_surface_high' },\n                '& ~ .send-msg': { color: '$on_surface_low' },\n                '&::placeholder': { color: '$on_surface_medium' },\n                border: 'none',\n              }}\n              placeholder={message_placeholder}\n              ref={inputRef}\n              required\n              autoFocus={!(isMobile || isLandscapeHLSStream)}\n              onKeyPress={async event => {\n                if (event.key === 'Enter') {\n                  if (!event.shiftKey && !messageLengthExceeded) {\n                    event.preventDefault();\n                    await sendMessage();\n                  }\n                }\n              }}\n              autoComplete=\"off\"\n              aria-autocomplete=\"none\"\n              onChange={e => {\n                updateInputHeight();\n                setMessageLengthExceeded(e.target.value.length > CHAT_MESSAGE_LIMIT);\n              }}\n              onBlur={resetInputHeight}\n              onPaste={e => e.stopPropagation()}\n              onCut={e => e.stopPropagation()}\n              onCopy={e => e.stopPropagation()}\n            />\n            {!isMobile && !isLandscapeHLSStream ? (\n              <EmojiPicker\n                onSelect={emoji => {\n                  if (inputRef.current) {\n                    inputRef.current.value += ` ${emoji.native} `;\n                  }\n                }}\n              />\n            ) : null}\n            <BaseIconButton\n              className=\"send-msg\"\n              onClick={sendMessage}\n              disabled={messageLengthExceeded}\n              css={{\n                ml: 'auto',\n                height: 'max-content',\n                mr: '$4',\n                '&:hover': { c: isMobile ? '' : '$on_surface_medium' },\n              }}\n              data-testid=\"send_msg_btn\"\n            >\n              <SendIcon />\n            </BaseIconButton>\n          </Flex>\n          {(isMwebHLSStream || isLandscapeHLSStream) && (\n            <>\n              <Flex\n                css={{\n                  alignItems: 'center',\n                }}\n                gap=\"2\"\n              >\n                <RaiseHand css={{ bg: '$surface_default' }} />\n                <MoreSettings elements={elements} screenType={screenType} />\n              </Flex>\n            </>\n          )}\n        </Flex>\n      )}\n      {messageLengthExceeded && (\n        <Text variant=\"xs\" css={{ color: '$alert_error_default', fontWeight: '$semiBold', mt: '$1', ml: '$7' }}>\n          Message cannot exceed 2000 characters\n        </Text>\n      )}\n    </Box>\n  );\n};\n", "import React, { useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { ChevronDownIcon, ChevronUpIcon, CrossIcon, GroupIcon, PersonIcon } from '@100mslive/react-icons';\nimport { Dropdown } from '../../../Dropdown';\nimport { Box, Flex } from '../../../Layout';\nimport { Sheet } from '../../../Sheet';\nimport { Text } from '../../../Text';\nimport { config as cssConfig } from '../../../Theme';\nimport { ChatSelector } from './ChatSelector';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore\nimport { useSubscribeChatSelector } from '../AppData/useUISettings';\nimport { useDefaultChatSelection, useFilteredRoles } from '../../common/hooks';\nimport { CHAT_SELECTOR } from '../../common/constants';\n\nexport const ChatSelectorContainer = () => {\n  const [open, setOpen] = useState(false);\n  const isMobile = useMedia(cssConfig.media.md);\n  const { elements } = useRoomLayoutConferencingScreen();\n  const isPrivateChatEnabled = !!elements?.chat?.private_chat_enabled;\n  const isPublicChatEnabled = !!elements?.chat?.public_chat_enabled;\n  const roles = useFilteredRoles();\n  const selectedPeer = useSubscribeChatSelector(CHAT_SELECTOR.PEER);\n  const selectedRole = useSubscribeChatSelector(CHAT_SELECTOR.ROLE);\n  const defaultSelection = useDefaultChatSelection();\n  const selection = selectedPeer.name || selectedRole || defaultSelection;\n\n  if (!(isPrivateChatEnabled || isPublicChatEnabled || roles.length > 0) && !isPrivateChatEnabled && !selection) {\n    return null;\n  }\n  return (\n    <>\n      <Flex align=\"center\" css={{ mb: '$8', flex: '1 1 0', pl: '$2' }}>\n        <Text variant=\"xs\" css={{ color: '$on_surface_medium' }}>\n          {selection ? 'To' : 'Choose Participant'}\n        </Text>\n\n        {isMobile ? (\n          <Flex\n            align=\"center\"\n            css={{ c: '$on_surface_medium', border: '1px solid $border_bright', r: '$0', p: '$1 $2', ml: '$6' }}\n            gap=\"1\"\n            onClick={e => {\n              setOpen(value => !value);\n              e.stopPropagation();\n            }}\n          >\n            <Text\n              variant=\"caption\"\n              css={{\n                c: '$on_surface_high',\n                pr: '$2',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '$1',\n                textTransform: selection !== selectedPeer.name ? 'capitalize' : undefined,\n              }}\n            >\n              {selection === CHAT_SELECTOR.EVERYONE ? (\n                <GroupIcon width={16} height={16} />\n              ) : (\n                <PersonIcon width={16} height={16} />\n              )}\n              {selection || 'Search'}\n            </Text>\n            {selection &&\n              (open ? <ChevronUpIcon width={16} height={16} /> : <ChevronDownIcon width={16} height={16} />)}\n          </Flex>\n        ) : (\n          <Dropdown.Root open={open} onOpenChange={value => setOpen(value)}>\n            <Dropdown.Trigger\n              asChild\n              data-testid=\"participant_list_filter\"\n              css={{\n                background: '$primary_default',\n                r: '$0',\n                p: '$1 $2',\n                ml: '$6',\n              }}\n              tabIndex={0}\n            >\n              <Flex align=\"center\" css={{ c: '$on_surface_medium' }} gap=\"1\">\n                <Text\n                  variant=\"caption\"\n                  css={{\n                    c: '$on_surface_high',\n                    pr: '$2',\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '$1',\n                    textTransform: selection !== selectedPeer.name ? 'capitalize' : undefined,\n                  }}\n                >\n                  {selection === CHAT_SELECTOR.EVERYONE ? (\n                    <GroupIcon width={16} height={16} />\n                  ) : (\n                    <PersonIcon width={16} height={16} />\n                  )}\n                  {selection || 'Search'}\n                </Text>\n                {selection && (\n                  <ChevronDownIcon\n                    style={{ transform: open ? 'rotate(180deg)' : 'rotate(0deg)', transition: 'transform 150ms ease' }}\n                    width={12}\n                    height={12}\n                  />\n                )}\n              </Flex>\n            </Dropdown.Trigger>\n\n            <Dropdown.Content\n              css={{\n                w: '$64',\n                overflow: 'hidden',\n                maxHeight: 'unset',\n                bg: '$surface_default',\n              }}\n              align=\"start\"\n              sideOffset={8}\n            >\n              <ChatSelector role={selectedRole} peerId={selectedPeer.id} />\n            </Dropdown.Content>\n          </Dropdown.Root>\n        )}\n      </Flex>\n      {isMobile ? (\n        <Sheet.Root open={open} onOpenChange={value => setOpen(value)}>\n          <Sheet.Content css={{ pt: '$8' }}>\n            <Sheet.Title\n              css={{\n                display: 'flex',\n                w: '100%',\n                justifyContent: 'space-between',\n                px: '$10',\n                pb: '$4',\n                mb: '$8',\n                borderBottom: '1px solid $border_bright',\n              }}\n            >\n              <Text css={{ color: '$on_surface_medium', fontWeight: '$semiBold' }}>Chat with</Text>\n              <Sheet.Close css={{ color: '$on_surface_medium' }}>\n                <CrossIcon />\n              </Sheet.Close>\n            </Sheet.Title>\n            <Box\n              onClick={() => {\n                setOpen(false);\n              }}\n            >\n              <ChatSelector role={selectedRole} peerId={selectedPeer.id} />\n            </Box>\n          </Sheet.Content>\n        </Sheet.Root>\n      ) : null}\n    </>\n  );\n};\n", "import React, { useMemo, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport {\n  HMSPeer,\n  HMSPeerType,\n  selectMessagesUnreadCountByPeerID,\n  selectMessagesUnreadCountByRole,\n  selectRemotePeers,\n  selectUnreadHMSMessagesCount,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { CheckIcon, PeopleIcon } from '@100mslive/react-icons';\nimport { Box, CSS, Dropdown, Flex, HorizontalDivider, Text, Tooltip } from '../../..';\nimport { config as cssConfig } from '../../../Theme';\nimport { ParticipantSearch } from '../Footer/ParticipantList';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore\nimport { useSetSubscribedChatSelector } from '../AppData/useUISettings';\nimport { useFilteredRoles } from '../../common/hooks';\nimport { CHAT_SELECTOR } from '../../common/constants';\n\nconst ChatDotIcon = () => {\n  return <Box css={{ size: '$6', bg: '$primary_default', mx: '$2', r: '$round' }} />;\n};\n\nconst SelectorItem = ({\n  value,\n  active,\n  onClick,\n  unreadCount,\n  icon = undefined,\n}: {\n  value: string;\n  active: boolean;\n  onClick: () => void;\n  unreadCount: number;\n  icon?: React.JSX.Element;\n}) => {\n  const isMobile = useMedia(cssConfig.media.md);\n\n  const Root = !isMobile\n    ? Dropdown.Item\n    : ({ children, ...rest }: { children: React.ReactNode; css: CSS }) => (\n        <Flex {...rest} css={{ p: '$6 $8', ...rest.css }}>\n          {children}\n        </Flex>\n      );\n  return (\n    <Root\n      data-testid=\"chat_members\"\n      css={{ align: 'center', px: '$10', py: '$4', bg: '$surface_default' }}\n      onClick={onClick}\n    >\n      <Text\n        variant=\"sm\"\n        css={{ display: 'flex', alignItems: 'center', gap: '$4', fontWeight: '$semiBold', color: '$on_surface_high' }}\n      >\n        {icon}\n        {value}\n      </Text>\n      <Flex align=\"center\" css={{ ml: 'auto', color: '$on_primary_high' }}>\n        {unreadCount > 0 && (\n          <Tooltip title={`${unreadCount} unread`}>\n            <Box css={{ mr: active ? '$3' : 0 }}>\n              <ChatDotIcon />\n            </Box>\n          </Tooltip>\n        )}\n        {active && <CheckIcon width={16} height={16} />}\n      </Flex>\n    </Root>\n  );\n};\n\nconst SelectorHeader = React.memo(\n  ({ isHorizontalDivider = true, children }: { isHorizontalDivider?: boolean; children: React.ReactNode }) => {\n    return (\n      <Box css={{ flexShrink: 0 }}>\n        {isHorizontalDivider && <HorizontalDivider space={4} />}\n        <Text\n          variant=\"overline\"\n          css={{ p: '$4 $10', fontWeight: '$semiBold', textTransform: 'uppercase', color: '$on_surface_medium' }}\n        >\n          {children}\n        </Text>\n      </Box>\n    );\n  },\n);\n\nconst Everyone = React.memo(({ active }: { active: boolean }) => {\n  const unreadCount: number = useHMSStore(selectUnreadHMSMessagesCount);\n  const [, setPeerSelector] = useSetSubscribedChatSelector(CHAT_SELECTOR.PEER);\n  const [, setRoleSelector] = useSetSubscribedChatSelector(CHAT_SELECTOR.ROLE);\n  return (\n    <SelectorItem\n      value=\"Everyone\"\n      icon={<PeopleIcon />}\n      active={active}\n      unreadCount={unreadCount}\n      onClick={() => {\n        setPeerSelector({});\n        setRoleSelector('');\n      }}\n    />\n  );\n});\n\nconst RoleItem = React.memo(({ role, active }: { role: string; active: boolean }) => {\n  const unreadCount: number = useHMSStore(selectMessagesUnreadCountByRole(role));\n  const [, setPeerSelector] = useSetSubscribedChatSelector(CHAT_SELECTOR.PEER);\n  const [, setRoleSelector] = useSetSubscribedChatSelector(CHAT_SELECTOR.ROLE);\n  return (\n    <SelectorItem\n      value={role}\n      active={active}\n      unreadCount={unreadCount}\n      onClick={() => {\n        setPeerSelector({});\n        setRoleSelector(role);\n      }}\n    />\n  );\n});\n\nconst PeerItem = ({ peerId, name, active }: { name: string; peerId: string; active: boolean }) => {\n  const unreadCount: number = useHMSStore(selectMessagesUnreadCountByPeerID(peerId));\n  const [, setPeerSelector] = useSetSubscribedChatSelector(CHAT_SELECTOR.PEER);\n  const [, setRoleSelector] = useSetSubscribedChatSelector(CHAT_SELECTOR.ROLE);\n\n  return (\n    <SelectorItem\n      value={name}\n      active={active}\n      unreadCount={unreadCount}\n      onClick={() => {\n        setPeerSelector({ id: peerId, name });\n        setRoleSelector('');\n      }}\n    />\n  );\n};\n\nconst VirtualizedSelectItemList = ({\n  peers,\n  selectedRole,\n  selectedPeerId,\n  searchValue,\n  isPublicChatEnabled,\n}: {\n  peers: HMSPeer[];\n  selectedRole: string;\n  selectedPeerId: string;\n  searchValue: string;\n  isPublicChatEnabled: boolean;\n}) => {\n  const roles = useFilteredRoles();\n  const filteredPeers = useMemo(\n    () =>\n      peers.filter(\n        // search should be empty or search phrase should be included in name\n        peer =>\n          (!searchValue || peer.name.toLowerCase().includes(searchValue.toLowerCase())) &&\n          peer.type !== HMSPeerType.SIP,\n      ),\n    [peers, searchValue],\n  );\n\n  const listItems = useMemo(() => {\n    let selectItems: React.ReactNode[] = [];\n    if (isPublicChatEnabled && !searchValue) {\n      selectItems = [<Everyone active={!selectedRole && !selectedPeerId} />];\n    }\n    if (roles.length > 0 && !searchValue) {\n      selectItems.push(<SelectorHeader isHorizontalDivider={isPublicChatEnabled}>Roles</SelectorHeader>);\n      roles.forEach(userRole =>\n        selectItems.push(<RoleItem key={userRole} active={selectedRole === userRole} role={userRole} />),\n      );\n    }\n\n    if (filteredPeers.length > 0) {\n      selectItems.push(\n        <SelectorHeader isHorizontalDivider={isPublicChatEnabled || roles.length > 0}>Participants</SelectorHeader>,\n      );\n    }\n    filteredPeers.forEach(peer =>\n      selectItems.push(\n        <PeerItem key={peer.id} name={peer.name} peerId={peer.id} active={peer.id === selectedPeerId} />,\n      ),\n    );\n\n    return selectItems;\n  }, [isPublicChatEnabled, searchValue, selectedRole, selectedPeerId, roles, filteredPeers]);\n\n  return (\n    <Dropdown.Group css={{ overflowY: 'auto', maxHeight: '$64', bg: '$surface_default' }}>\n      {listItems.map((item, index) => (\n        <Box key={index}>{item}</Box>\n      ))}\n    </Dropdown.Group>\n  );\n};\n\nexport const ChatSelector = ({ role, peerId }: { role: string; peerId: string }) => {\n  const { elements } = useRoomLayoutConferencingScreen();\n  const peers = useHMSStore(selectRemotePeers);\n  const [search, setSearch] = useState('');\n\n  const isPrivateChatEnabled = !!elements?.chat?.private_chat_enabled;\n  const isPublicChatEnabled = !!elements?.chat?.public_chat_enabled;\n\n  return (\n    <>\n      {peers.length > 0 && isPrivateChatEnabled && (\n        <Box css={{ px: '$4' }}>\n          <ParticipantSearch onSearch={setSearch} placeholder=\"Search for participants\" />\n        </Box>\n      )}\n      <VirtualizedSelectItemList\n        selectedRole={role}\n        selectedPeerId={peerId}\n        peers={isPrivateChatEnabled ? peers : []}\n        isPublicChatEnabled={isPublicChatEnabled}\n        searchValue={search}\n      />\n    </>\n  );\n};\n", "import { useCallback } from 'react';\nimport { selectAppData, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { APP_DATA } from '../../common/constants';\n\nexport const useChatDraftMessage = () => {\n  const hmsActions = useHMSActions();\n  let chatDraftMessage = useHMSStore(selectAppData(APP_DATA.chatDraft));\n  if (chatDraftMessage === undefined || chatDraftMessage === null) {\n    chatDraftMessage = '';\n  }\n  const setDraftMessage = useCallback(\n    message => {\n      hmsActions.setAppData(APP_DATA.chatDraft, message, true);\n    },\n    [hmsActions],\n  );\n  return [chatDraftMessage, setDraftMessage];\n};\n", "import { useEffect, useRef } from 'react';\n\nexport const useEmojiPickerStyles = showing => {\n  const ref = useRef(null);\n  useEffect(() => {\n    if (showing) {\n      setTimeout(() => {\n        const root = ref.current?.querySelector('em-emoji-picker')?.shadowRoot;\n        const style = document.createElement('style');\n        style.textContent = `\n          #root {\n            --em-rgb-color: var(--hms-ui-colors-on_surface_high);\n            --em-rgb-input: var(--hms-ui-colors-on_primary_high);\n            --em-color-border: var(--hms-ui-colors-surface_bright);\n            --color-b: var(--hms-ui-colors-on_surface_high);\n            --rgb-background: transparent;\n            color: var(--hms-ui-colors-on_surface_high);\n            font-family: var(--hms-ui-fonts-sans);\n          }\n          .sticky {\n            top: 0.25rem;\n            background-color: var(--hms-ui-colors-surface_bright);\n            margin-top: 0.5rem;\n          }\n        `;\n        root?.appendChild(style);\n      }, 0);\n    }\n  }, [showing]);\n\n  return ref;\n};\n", "import React, { useCallback } from 'react';\nimport { selectLocalPeer, selectSessionStore, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { Button } from '../../../Button';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useIsPeerBlacklisted } from '../hooks/useChatBlacklist';\nimport { SESSION_STORE_KEY } from '../../common/constants';\n\nexport const ChatPaused = () => {\n  const hmsActions = useHMSActions();\n  const { elements } = useRoomLayoutConferencingScreen();\n  const can_disable_chat = !!elements?.chat?.real_time_controls?.can_disable_chat;\n  const { enabled: isChatEnabled = true, updatedBy: chatStateUpdatedBy = '' } =\n    useHMSStore(selectSessionStore(SESSION_STORE_KEY.CHAT_STATE)) || {};\n\n  const localPeer = useHMSStore(selectLocalPeer);\n\n  const unPauseChat = useCallback(\n    async () =>\n      await hmsActions.sessionStore.set(SESSION_STORE_KEY.CHAT_STATE, {\n        enabled: true,\n        updatedBy: { userName: localPeer?.name, userId: localPeer?.customerUserId, peerId: localPeer?.id },\n        updatedAt: Date.now(),\n      }),\n    [hmsActions, localPeer],\n  );\n\n  return isChatEnabled ? null : (\n    <Flex\n      align=\"center\"\n      justify=\"between\"\n      css={{ borderRadius: '$1', bg: '$surface_default', p: '$2 $4 $2 $8', w: '100%' }}\n    >\n      <Box>\n        <Text variant=\"sm\" css={{ fontWeight: '$semiBold', color: '$on_surface_high' }}>\n          Chat paused\n        </Text>\n        <Text\n          variant=\"xs\"\n          css={{ color: '$on_surface_medium', maxWidth: '100%', overflow: 'hidden', textOverflow: 'ellipsis' }}\n        >\n          Chat has been paused by {chatStateUpdatedBy?.peerId === localPeer?.id ? 'you' : chatStateUpdatedBy?.userName}\n        </Text>\n      </Box>\n      {can_disable_chat ? (\n        <Button css={{ fontWeight: '$semiBold', fontSize: '$sm', borderRadius: '$2' }} onClick={unPauseChat}>\n          Resume\n        </Button>\n      ) : (\n        <></>\n      )}\n    </Flex>\n  );\n};\n\nexport const ChatBlocked = () => {\n  const isLocalPeerBlacklisted = useIsPeerBlacklisted({ local: true });\n  if (!isLocalPeerBlacklisted) {\n    return null;\n  }\n  return (\n    <Flex\n      align=\"center\"\n      justify=\"between\"\n      css={{ borderRadius: '$1', bg: '$surface_default', p: '$4 $4 $4 $8', w: '100%' }}\n    >\n      <Text variant=\"sm\" css={{ color: '$on_surface_medium', textAlign: 'center', w: '100%' }}>\n        You've been blocked from sending messages\n      </Text>\n    </Flex>\n  );\n};\n", "import React, { useEffect, useState } from 'react';\nimport { useSwipeable } from 'react-swipeable';\nimport { useMedia } from 'react-use';\nimport { selectSessionStore, useHMSStore } from '@100mslive/react-sdk';\nimport { PinIcon, UnpinIcon } from '@100mslive/react-icons';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { config as cssConfig } from '../../../Theme';\nimport { ArrowNavigation } from './ArrowNavigation';\n// @ts-ignore\nimport { AnnotisedMessage } from './ChatBody';\nimport { StickIndicator } from './StickIndicator';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { usePinnedMessages } from '../hooks/usePinnedMessages';\nimport { SESSION_STORE_KEY } from '../../common/constants';\n\nconst PINNED_MESSAGE_LENGTH = 75;\n\nexport const PinnedMessage = () => {\n  const pinnedMessages = useHMSStore(selectSessionStore(SESSION_STORE_KEY.PINNED_MESSAGES));\n  const [pinnedMessageIndex, setPinnedMessageIndex] = useState(0);\n  const { removePinnedMessage } = usePinnedMessages();\n  const isMobile = useMedia(cssConfig.media.md);\n\n  const { elements } = useRoomLayoutConferencingScreen();\n  const canUnpinMessage = !!elements?.chat?.allow_pinning_messages;\n\n  const [hideOverflow, setHideOverflow] = useState(true);\n  const currentPinnedMessage = pinnedMessages?.[pinnedMessageIndex]?.text || '';\n  const canOverflow = currentPinnedMessage.length > PINNED_MESSAGE_LENGTH;\n\n  const showPreviousPinnedMessage = () => {\n    const previousIndex = Math.max(pinnedMessageIndex - 1, 0);\n    setHideOverflow(pinnedMessages[previousIndex].text.length > PINNED_MESSAGE_LENGTH);\n    setPinnedMessageIndex(previousIndex);\n  };\n\n  const showNextPinnedMessage = () => {\n    const nextIndex = Math.min(pinnedMessageIndex + 1, pinnedMessages.length - 1);\n    setHideOverflow(pinnedMessages[nextIndex].text.length > PINNED_MESSAGE_LENGTH);\n    setPinnedMessageIndex(nextIndex);\n  };\n\n  const swipeHandlers = useSwipeable({\n    onSwipedUp: () => showNextPinnedMessage(),\n    onSwipedDown: () => showPreviousPinnedMessage(),\n  });\n\n  // Scenario: User is on a particular index but an earlier message is removed by another peer\n  useEffect(() => {\n    const count = pinnedMessages?.length || 1;\n    if (pinnedMessageIndex >= count) {\n      setPinnedMessageIndex(count - 1);\n    }\n  }, [pinnedMessageIndex, pinnedMessages]);\n\n  if (!pinnedMessages || pinnedMessages.length === 0) {\n    return null;\n  }\n\n  return (\n    <Flex align=\"center\" css={{ w: '100%', gap: '$4' }}>\n      {!isMobile ? (\n        <ArrowNavigation\n          index={pinnedMessageIndex}\n          total={pinnedMessages.length}\n          showPrevious={showPreviousPinnedMessage}\n          showNext={showNextPinnedMessage}\n        />\n      ) : null}\n      <Flex\n        css={{\n          p: '$4',\n          color: '$on_surface_high',\n          bg: isMobile && elements?.chat?.is_overlay ? 'rgba(0, 0, 0, 0.64)' : '$surface_brighter',\n          r: '$1',\n          gap: '$4',\n          mb: '$8',\n          mt: '$8',\n          flexGrow: 1,\n          border: '1px solid $border_bright',\n        }}\n        align=\"center\"\n        justify=\"between\"\n      >\n        {isMobile ? <StickIndicator index={pinnedMessageIndex} total={pinnedMessages.length} /> : null}\n\n        <Box\n          css={{\n            w: '100%',\n            maxHeight: '$18',\n            overflowY: 'auto',\n            overflowX: 'hidden',\n            wordBreak: 'break-word',\n            '& p span': {\n              color: '$primary_default',\n            },\n          }}\n        >\n          <Text\n            variant=\"sm\"\n            css={{ color: '$on_surface_high' }}\n            {...swipeHandlers}\n            title={pinnedMessages[pinnedMessageIndex]?.text}\n          >\n            <AnnotisedMessage\n              message={currentPinnedMessage}\n              length={hideOverflow ? PINNED_MESSAGE_LENGTH : currentPinnedMessage.length}\n            />\n            {canOverflow ? (\n              <span style={{ cursor: 'pointer' }} onClick={() => setHideOverflow(prev => !prev)}>\n                &nbsp;{hideOverflow ? '... See more' : 'Collapse'}\n              </span>\n            ) : null}\n          </Text>\n        </Box>\n\n        {canUnpinMessage ? (\n          <Flex\n            onClick={() => {\n              removePinnedMessage(pinnedMessageIndex);\n              setPinnedMessageIndex(Math.max(0, pinnedMessageIndex - 1));\n            }}\n            css={{\n              cursor: 'pointer',\n              color: '$on_surface_medium',\n              '&:hover': { color: '$on_surface_high' },\n              '&:hover .hide-on-hover': { display: 'none !important' },\n              '&:hover .show-on-hover': { display: 'block !important' },\n            }}\n            title=\"Unpin Message\"\n          >\n            <UnpinIcon className=\"show-on-hover\" style={{ display: 'none' }} height={20} width={20} />\n            <PinIcon className=\"hide-on-hover\" style={{ display: 'block' }} height={20} width={20} />\n          </Flex>\n        ) : null}\n      </Flex>\n    </Flex>\n  );\n};\n", "import React from 'react';\nimport { ChevronDownIcon, ChevronUpIcon } from '@100mslive/react-icons';\nimport { Flex } from '../../../Layout';\n\nexport const ArrowNavigation = ({\n  total,\n  index,\n  showPrevious,\n  showNext,\n}: {\n  total: number;\n  index: number;\n  showPrevious: () => void;\n  showNext: () => void;\n}) => {\n  if (total < 2) {\n    return null;\n  }\n\n  return (\n    <Flex direction=\"column\" css={{ gap: '$1' }}>\n      <Flex\n        onClick={showPrevious}\n        css={\n          index === 0\n            ? { cursor: 'not-allowed', color: '$on_surface_low' }\n            : { cursor: 'pointer', color: '$on_surface_medium' }\n        }\n      >\n        <ChevronUpIcon height={20} width={20} />\n      </Flex>\n      <Flex\n        onClick={showNext}\n        css={\n          index === total - 1\n            ? { cursor: 'not-allowed', color: '$on_surface_low' }\n            : { cursor: 'pointer', color: '$on_surface_medium' }\n        }\n      >\n        <ChevronDownIcon height={20} width={20} />\n      </Flex>\n    </Flex>\n  );\n};\n", "import React from 'react';\nimport { Box, Flex } from '../../../Layout';\n\nexport const StickIndicator = ({ total, index }: { total: number; index: number }) => {\n  const sticksCount = Math.min(3, total);\n\n  if (total < 2) {\n    return null;\n  }\n\n  return (\n    <Flex direction=\"column\" css={{ gap: '$1' }}>\n      {[...Array(sticksCount)].map((_, i) => (\n        <Box\n          css={{\n            borderLeft: '2px solid',\n            height: '$4',\n            borderColor: i === index ? '$on_surface_high' : '$on_surface_low',\n          }}\n        />\n      ))}\n    </Flex>\n  );\n};\n", "import React, { useEffect, useState } from 'react';\nimport { useInView } from 'react-intersection-observer';\nimport { useMeasure } from 'react-use';\nimport { VariableSizeList } from 'react-window';\nimport { selectIsConnectedToRoom, useHMSStore, usePaginatedParticipants } from '@100mslive/react-sdk';\nimport { ChevronLeftIcon, CrossIcon } from '@100mslive/react-icons';\nimport { IconButton } from '../../../IconButton';\nimport { Box, Flex } from '../../../Layout';\nimport { Loading } from '../../../Loading';\nimport { Text } from '../../../Text';\nimport { Participant, ParticipantSearch } from './ParticipantList';\nimport { ItemData, itemKey, ROW_HEIGHT } from './RoleAccordion';\n// @ts-ignore: No implicit Any\nimport { useSidepaneReset } from '../AppData/useSidepane';\n// @ts-ignore: No implicit Any\nimport { getFormattedCount } from '../../common/utils';\n\nconst LoadMoreParticipants = ({\n  hasNext,\n  loadMore,\n  style,\n}: {\n  hasNext: boolean;\n  loadMore: () => Promise<void>;\n  style: React.CSSProperties;\n}) => {\n  const { ref, inView } = useInView();\n  const [inProgress, setInProgress] = useState(false);\n\n  useEffect(() => {\n    if (hasNext && inView && !inProgress) {\n      setInProgress(true);\n      loadMore()\n        .catch(console.error)\n        .finally(() => setInProgress(false));\n    }\n  }, [hasNext, loadMore, inView, inProgress]);\n  return (\n    <Flex ref={ref} style={style} align=\"center\" justify=\"center\">\n      {inProgress ? <Loading size={16} /> : null}\n    </Flex>\n  );\n};\n\nconst VirtualizedParticipantItem = React.memo(\n  ({\n    index,\n    data,\n    style,\n  }: {\n    index: number;\n    data: ItemData & { hasNext: boolean; loadMorePeers: () => Promise<void> };\n    style: React.CSSProperties;\n  }) => {\n    if (!data.peerList[index]) {\n      return <LoadMoreParticipants hasNext={data.hasNext} loadMore={data.loadMorePeers} style={style} />;\n    }\n    return (\n      <Participant\n        key={data.peerList[index].id}\n        peer={data.peerList[index]}\n        isConnected={data.isConnected}\n        style={style}\n      />\n    );\n  },\n);\n\nexport const PaginatedParticipants = ({ roleName, onBack }: { roleName: string; onBack: () => void }) => {\n  const { peers, total, hasNext, loadPeers, loadMorePeers } = usePaginatedParticipants({ role: roleName, limit: 20 });\n  const [search, setSearch] = useState<string>('');\n  const filteredPeers = peers.filter(p => p.name?.toLowerCase().includes(search?.toLowerCase()));\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const [ref, { width }] = useMeasure<HTMLDivElement>();\n  const height = ROW_HEIGHT * (filteredPeers.length + 1);\n  const resetSidePane = useSidepaneReset();\n\n  useEffect(() => {\n    loadPeers();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <Flex ref={ref} direction=\"column\" css={{ size: '100%', gap: '$4' }}>\n      <Flex align=\"center\">\n        <Flex align=\"center\" css={{ flex: '1 1 0', cursor: 'pointer' }} onClick={onBack}>\n          <ChevronLeftIcon />\n          <Text variant=\"lg\" css={{ flex: '1 1 0' }}>\n            Participants\n          </Text>\n        </Flex>\n        <IconButton\n          onClick={e => {\n            e.stopPropagation();\n            resetSidePane();\n          }}\n          data-testid=\"close_sidepane\"\n        >\n          <CrossIcon />\n        </IconButton>\n      </Flex>\n      <ParticipantSearch onSearch={(search: string) => setSearch(search)} placeholder={`Search for ${roleName}`} />\n      <Flex direction=\"column\" css={{ border: '1px solid $border_default', borderRadius: '$1', flex: '1 1 0' }}>\n        <Flex align=\"center\" css={{ height: ROW_HEIGHT, borderBottom: '1px solid $border_default', px: '$8' }}>\n          <Text css={{ fontSize: '$space$7' }}>\n            {roleName}({getFormattedCount(peers.length)}/{getFormattedCount(total)})\n          </Text>\n        </Flex>\n        <Box css={{ flex: '1 1 0', overflowY: 'auto', overflowX: 'hidden', mr: '-$10' }}>\n          <VariableSizeList\n            itemSize={index => (index === filteredPeers.length + 1 ? 16 : ROW_HEIGHT)}\n            itemData={{ peerList: filteredPeers, hasNext: hasNext(), loadMorePeers, isConnected: isConnected === true }}\n            itemKey={itemKey}\n            itemCount={filteredPeers.length + 1}\n            width={width}\n            height={height}\n          >\n            {VirtualizedParticipantItem}\n          </VariableSizeList>\n        </Box>\n      </Flex>\n    </Flex>\n  );\n};\n", "import React from 'react';\nimport { selectLocalPeer, selectSessionStore, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport { PauseCircleIcon, SettingsIcon } from '@100mslive/react-icons';\nimport { Flex } from '../../Layout';\nimport { Popover } from '../../Popover';\nimport { Text } from '../../Text';\nimport { useRoomLayoutConferencingScreen } from '../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { SESSION_STORE_KEY } from '../common/constants';\n\nexport const ChatSettings = () => {\n  const hmsActions = useHMSActions();\n  const localPeer = useHMSStore(selectLocalPeer);\n  const { elements } = useRoomLayoutConferencingScreen();\n  const canPauseChat = !!elements?.chat?.real_time_controls?.can_disable_chat;\n  const { enabled: isChatEnabled = true } = useHMSStore(selectSessionStore(SESSION_STORE_KEY.CHAT_STATE)) || {};\n  const showPause = canPauseChat && isChatEnabled;\n\n  if (!showPause) {\n    return null;\n  }\n\n  return (\n    <Popover.Root>\n      <Popover.Trigger asChild css={{ px: '$4' }}>\n        <Flex\n          align=\"center\"\n          css={{ color: '$on_surface_medium', '&:hover': { color: '$on_surface_high' }, cursor: 'pointer' }}\n        >\n          <SettingsIcon />\n        </Flex>\n      </Popover.Trigger>\n      <Popover.Portal>\n        <Popover.Content\n          align=\"end\"\n          side=\"bottom\"\n          sideOffset={2}\n          onClick={() => {\n            const chatState = {\n              enabled: false,\n              updatedBy: {\n                peerId: localPeer?.id,\n                userId: localPeer?.customerUserId,\n                userName: localPeer?.name,\n              },\n              updatedAt: Date.now(),\n            };\n            hmsActions.sessionStore.set(SESSION_STORE_KEY.CHAT_STATE, chatState);\n          }}\n          css={{\n            backgroundColor: '$surface_default',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '$4',\n            borderRadius: '$1',\n            color: '$on_surface_high',\n            cursor: 'pointer',\n            '&:hover': { backgroundColor: '$surface_dim' },\n          }}\n        >\n          <PauseCircleIcon />\n          <Text variant=\"sm\" css={{ fontWeight: '$semiBold' }}>\n            Pause Chat\n          </Text>\n        </Popover.Content>\n      </Popover.Portal>\n    </Popover.Root>\n  );\n};\n", "import React, { useCallback, useMemo, useState } from 'react';\nimport { useMeasure } from 'react-use';\nimport {\n  selectAudioTrackByPeerID,\n  selectHasPeerHandRaised,\n  selectIsPeerAudioEnabled,\n  selectLocalPeerID,\n  selectPeerMetadata,\n  selectPeerNameByID,\n  selectVideoTrackByID,\n  selectVideoTrackByPeerID,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { BrbTileIcon, HandIcon, MicOffIcon } from '@100mslive/react-icons';\nimport TileConnection from './Connection/TileConnection';\nimport TileMenu, { isSameTile } from './TileMenu/TileMenu';\nimport { AudioLevel } from '../../AudioLevel';\nimport { Avatar } from '../../Avatar';\nimport { VideoTileStats } from '../../Stats';\nimport { CSS } from '../../Theme';\nimport { Video } from '../../Video';\nimport { StyledVideoTile } from '../../VideoTile';\n// @ts-ignore: No implicit Any\nimport { getVideoTileLabel } from './peerTileUtils';\n// @ts-ignore: No implicit Any\nimport { useSetAppDataByKey, useUISettings } from './AppData/useUISettings';\n// @ts-ignore: No implicit Any\nimport { calculateAvatarAndAttribBoxSize } from '../common/utils';\nimport { APP_DATA, UI_SETTINGS } from '../common/constants';\n\nconst PeerMetadata = ({ peerId, size }: { peerId: string; size?: 'medium' | 'small' }) => {\n  const metaData = useHMSStore(selectPeerMetadata(peerId));\n  const isBRB = metaData?.isBRBOn || false;\n  const isHandRaised = useHMSStore(selectHasPeerHandRaised(peerId));\n\n  return (\n    <>\n      {isHandRaised ? (\n        <StyledVideoTile.AttributeBox size={size} data-testid=\"raiseHand_icon_onTile\">\n          <HandIcon width={24} height={24} />\n        </StyledVideoTile.AttributeBox>\n      ) : null}\n      {isBRB ? (\n        <StyledVideoTile.AttributeBox size={size} data-testid=\"brb_icon_onTile\">\n          <BrbTileIcon width={22} height={22} />\n        </StyledVideoTile.AttributeBox>\n      ) : null}\n    </>\n  );\n};\n\nconst Tile = ({\n  peerId = '',\n  trackId = '',\n  width,\n  height,\n  objectFit = 'cover',\n  canMinimise = false,\n  isDragabble = false,\n  rootCSS = {},\n  containerCSS = {},\n  enableSpotlightingPeer = true,\n  hideParticipantNameOnTile = false,\n  roundedVideoTile = true,\n  hideAudioMuteOnTile = false,\n  hideMetadataOnTile = false,\n}: {\n  peerId?: string;\n  trackId?: string;\n  width?: string | number;\n  height?: string | number;\n  objectFit?: string;\n  canMinimise?: boolean;\n  isDragabble?: boolean;\n  rootCSS?: CSS;\n  containerCSS?: CSS;\n  enableSpotlightingPeer?: boolean;\n  hideParticipantNameOnTile?: boolean;\n  roundedVideoTile?: boolean;\n  hideAudioMuteOnTile?: boolean;\n  hideMetadataOnTile?: boolean;\n}) => {\n  const trackSelector = trackId ? selectVideoTrackByID(trackId) : selectVideoTrackByPeerID(peerId);\n  const track = useHMSStore(trackSelector);\n  const peerName = useHMSStore(selectPeerNameByID(peerId));\n  const audioTrack = useHMSStore(selectAudioTrackByPeerID(peerId));\n  const localPeerID = useHMSStore(selectLocalPeerID);\n  const isAudioOnly = useUISettings(UI_SETTINGS.isAudioOnly);\n  const mirrorLocalVideo = useUISettings(UI_SETTINGS.mirrorLocalVideo);\n  const showStatsOnTiles = useUISettings(UI_SETTINGS.showStatsOnTiles);\n  const isAudioMuted = !useHMSStore(selectIsPeerAudioEnabled(peerId));\n  const isVideoMuted = !track?.enabled;\n  const [isMouseHovered, setIsMouseHovered] = useState(false);\n  const isVideoDegraded = track?.degraded;\n  const isLocal = localPeerID === peerId;\n  const [pinnedTrackId] = useSetAppDataByKey(APP_DATA.pinnedTrackId);\n  const pinned = isSameTile({\n    trackId: pinnedTrackId,\n    videoTrackID: track?.id,\n    audioTrackID: audioTrack?.id,\n  });\n  const label = getVideoTileLabel({\n    peerName,\n    track,\n    isLocal,\n  });\n  const onHoverHandler = useCallback((event: React.MouseEvent) => {\n    setIsMouseHovered(event.type === 'mouseenter');\n  }, []);\n\n  const [ref, { width: calculatedWidth, height: calculatedHeight }] = useMeasure<HTMLDivElement>();\n\n  const isTileBigEnoughToShowStats = calculatedHeight >= 180 && calculatedWidth >= 180;\n\n  const [avatarSize, attribBoxSize] = useMemo(\n    () => calculateAvatarAndAttribBoxSize(calculatedWidth, calculatedHeight),\n    [calculatedWidth, calculatedHeight],\n  );\n\n  return (\n    <StyledVideoTile.Root\n      ref={ref}\n      css={{\n        width,\n        height,\n        ...rootCSS,\n      }}\n      data-testid={`participant_tile_${peerName}`}\n    >\n      {peerName !== undefined ? (\n        <StyledVideoTile.Container\n          onMouseEnter={onHoverHandler}\n          onMouseLeave={onHoverHandler}\n          noRadius={!roundedVideoTile}\n          css={containerCSS}\n        >\n          {showStatsOnTiles && isTileBigEnoughToShowStats ? (\n            <VideoTileStats audioTrackID={audioTrack?.id} videoTrackID={track?.id} peerID={peerId} isLocal={isLocal} />\n          ) : null}\n\n          <Video\n            trackId={track?.id}\n            attach={isLocal ? undefined : !isAudioOnly}\n            mirror={\n              mirrorLocalVideo &&\n              peerId === localPeerID &&\n              track?.source === 'regular' &&\n              track?.facingMode !== 'environment'\n            }\n            noRadius={!roundedVideoTile}\n            data-testid=\"participant_video_tile\"\n            css={{\n              objectFit,\n              filter: isVideoDegraded ? 'blur($space$2)' : undefined,\n              bg: 'transparent',\n            }}\n          />\n          {calculatedWidth > 0 && calculatedHeight > 0 ? (\n            <>\n              {isVideoMuted || (!isLocal && isAudioOnly) ? (\n                <StyledVideoTile.AvatarContainer>\n                  <Avatar name={peerName || ''} data-testid=\"participant_avatar_icon\" size={avatarSize} />\n                </StyledVideoTile.AvatarContainer>\n              ) : null}\n              {!hideAudioMuteOnTile && isAudioMuted ? (\n                <StyledVideoTile.AudioIndicator data-testid=\"participant_audio_mute_icon\" size={attribBoxSize}>\n                  <MicOffIcon />\n                </StyledVideoTile.AudioIndicator>\n              ) : null}\n              {!hideAudioMuteOnTile && !isAudioMuted ? (\n                <StyledVideoTile.AudioIndicator size={attribBoxSize}>\n                  <AudioLevel trackId={audioTrack?.id} size={attribBoxSize} />\n                </StyledVideoTile.AudioIndicator>\n              ) : null}\n              {!hideMetadataOnTile && <PeerMetadata peerId={peerId} size={attribBoxSize} />}\n            </>\n          ) : null}\n          {isMouseHovered || (isDragabble && navigator.maxTouchPoints > 0) ? (\n            <TileMenu\n              peerID={peerId}\n              audioTrackID={audioTrack?.id || ''}\n              videoTrackID={track?.id || ''}\n              canMinimise={canMinimise}\n              enableSpotlightingPeer={enableSpotlightingPeer}\n            />\n          ) : null}\n\n          <TileConnection\n            hideLabel={hideParticipantNameOnTile}\n            name={label}\n            peerId={peerId}\n            width={width}\n            pinned={pinned}\n          />\n        </StyledVideoTile.Container>\n      ) : null}\n    </StyledVideoTile.Root>\n  );\n};\n\nconst VideoTile = React.memo(Tile);\n\nexport default VideoTile;\n", "import React from 'react';\nimport {\n  HMSPeerType,\n  selectPeerTypeByID,\n  selectScreenShareByPeerID,\n  selectSessionStore,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { CallIcon, PinIcon, ShareScreenIcon, SpotlightIcon } from '@100mslive/react-icons';\nimport { Flex, styled, Text, textEllipsis } from '../../..';\nimport { ConnectionIndicator } from './ConnectionIndicator';\nimport { SESSION_STORE_KEY } from '../../common/constants';\n\nconst TileConnection = ({\n  name,\n  peerId,\n  hideLabel,\n  width,\n  pinned,\n}: {\n  name: string;\n  peerId: string;\n  hideLabel: boolean;\n  width?: string | number;\n  pinned?: boolean;\n}) => {\n  const spotlighted = useHMSStore(selectSessionStore(SESSION_STORE_KEY.SPOTLIGHT)) === peerId;\n  const isPeerScreenSharing = !!useHMSStore(selectScreenShareByPeerID(peerId));\n  const peerType = useHMSStore(selectPeerTypeByID(peerId));\n  return (\n    <Wrapper>\n      {!hideLabel ? (\n        <>\n          {name ? (\n            <Flex align=\"center\">\n              {peerType === HMSPeerType.SIP && (\n                <IconWrapper>\n                  <CallIcon width=\"15\" height=\"15\" />\n                </IconWrapper>\n              )}\n              {isPeerScreenSharing && (\n                <IconWrapper>\n                  <ShareScreenIcon width=\"15\" height=\"15\" />\n                </IconWrapper>\n              )}\n              {pinned && (\n                <IconWrapper>\n                  <PinIcon width=\"15\" height=\"15\" />\n                </IconWrapper>\n              )}\n              {spotlighted && (\n                <IconWrapper>\n                  <SpotlightIcon width=\"15\" height=\"15\" />\n                </IconWrapper>\n              )}\n              <Text\n                css={{\n                  c: '$on_surface_high',\n                  verticalAlign: 'baseline',\n                  ...(width ? textEllipsis((width as number) - 60) : {}),\n                }}\n                variant=\"xs\"\n              >\n                {name}\n              </Text>\n            </Flex>\n          ) : null}\n          <ConnectionIndicator isTile peerId={peerId} hideBg />\n        </>\n      ) : null}\n    </Wrapper>\n  );\n};\n\nconst IconWrapper = styled('div', { c: '$on_surface_high', ml: '$3', mt: '$1', display: 'flex' });\n\nconst Wrapper = styled('div', {\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'space-between',\n  position: 'absolute',\n  bottom: '$2',\n  left: '$2',\n  backgroundColor: '$background_dim',\n  borderRadius: '$1',\n  maxWidth: '85%',\n  zIndex: 1,\n  '& p,span': {\n    p: '$2 $3',\n  },\n});\n\nexport default TileConnection;\n", "import React, { useState } from 'react';\nimport { useMedia } from 'react-use';\nimport {\n  HMSVideoTrack,\n  selectLocalPeerID,\n  selectPeerByID,\n  selectPermissions,\n  selectTrackByID,\n  selectVideoTrackByPeerID,\n  useHMSStore,\n  useRemoteAVToggle,\n} from '@100mslive/react-sdk';\nimport { CrossIcon, VerticalMenuIcon } from '@100mslive/react-icons';\nimport { Box, Flex } from '../../../Layout';\nimport { Sheet } from '../../../Sheet';\nimport { Text } from '../../../Text';\nimport { config as cssConfig, useTheme } from '../../../Theme';\nimport { StyledMenuTile } from '../../../TileMenu';\nimport { ChangeNameModal } from '../MoreSettings/ChangeNameModal';\nimport { RoleChangeModal } from '../RoleChangeModal';\nimport { TileMenuContent } from './TileMenuContent';\nimport { useDropdownList } from '../hooks/useDropdownList';\nimport { getDragClassName } from './utils';\n\n/**\n * Taking peerID as peer won't necesarilly have tracks\n */\nconst TileMenu = ({\n  audioTrackID,\n  videoTrackID,\n  peerID,\n  isScreenshare = false,\n  canMinimise,\n  enableSpotlightingPeer = true,\n}: {\n  audioTrackID: string;\n  videoTrackID: string;\n  peerID: string;\n  isScreenshare?: boolean;\n  canMinimise?: boolean;\n  enableSpotlightingPeer?: boolean;\n}) => {\n  const [open, setOpen] = useState(false);\n  const { theme } = useTheme();\n\n  const localPeerID = useHMSStore(selectLocalPeerID);\n  const isLocal = localPeerID === peerID;\n  const { removeOthers } = useHMSStore(selectPermissions) || {};\n  const { setVolume, toggleAudio, toggleVideo } = useRemoteAVToggle(audioTrackID, videoTrackID);\n  const showSpotlight = enableSpotlightingPeer;\n\n  const isPrimaryVideoTrack = useHMSStore(selectVideoTrackByPeerID(peerID))?.id === videoTrackID;\n  const showPinAction = !!(audioTrackID || (videoTrackID && isPrimaryVideoTrack));\n\n  const track = useHMSStore(selectTrackByID(videoTrackID)) as HMSVideoTrack;\n  const hideSimulcastLayers = !track?.layerDefinitions?.length || track.degraded || !track.enabled;\n  const isMobile = useMedia(cssConfig.media.md);\n  const peer = useHMSStore(selectPeerByID(peerID));\n  const [showNameChangeModal, setShowNameChangeModal] = useState(false);\n  const [showRoleChangeModal, setShowRoleChangeModal] = useState(false);\n  useDropdownList({ open, name: 'TileMenu' });\n  const dragClassName = getDragClassName();\n\n  if (!(removeOthers || toggleAudio || toggleVideo || setVolume || showPinAction) && hideSimulcastLayers) {\n    return null;\n  }\n\n  const openNameChangeModal = () => setShowNameChangeModal(true);\n  const openRoleChangeModal = () => setShowRoleChangeModal(true);\n\n  const props = {\n    isLocal,\n    isScreenshare,\n    audioTrackID,\n    videoTrackID,\n    peerID,\n    isPrimaryVideoTrack,\n    showSpotlight,\n    showPinAction,\n    canMinimise,\n    openNameChangeModal,\n    openRoleChangeModal,\n  };\n\n  return (\n    <>\n      <StyledMenuTile.Root open={open} onOpenChange={setOpen}>\n        <StyledMenuTile.Trigger\n          data-testid=\"participant_menu_btn\"\n          css={{ bg: `${theme.colors.background_dim.value}A3`, p: '$2', w: 'unset', h: 'unset' }}\n          onClick={e => e.stopPropagation()}\n          className={dragClassName}\n        >\n          <VerticalMenuIcon width={20} height={20} />\n        </StyledMenuTile.Trigger>\n\n        {isMobile ? (\n          <Sheet.Root open={open} onOpenChange={setOpen}>\n            <Sheet.Content css={{ bg: '$surface_dim', pt: '$8' }}>\n              <Flex\n                css={{\n                  color: '$on_surface_high',\n                  display: 'flex',\n                  w: '100%',\n                  justifyContent: 'space-between',\n                  alignItems: 'center',\n                  px: '$10',\n                  pb: '$8',\n                  borderBottom: '1px solid $border_default',\n                }}\n              >\n                <Box>\n                  <Text css={{ color: '$on_surface_high', fontWeight: '$semiBold' }}>\n                    {peer?.name}\n                    {isLocal ? ` (You)` : null}\n                  </Text>\n                  {peer?.roleName ? (\n                    <Text variant=\"xs\" css={{ color: '$on_surface_low', mt: '$2' }}>\n                      {peer.roleName}\n                    </Text>\n                  ) : null}\n                </Box>\n\n                <Sheet.Close css={{ color: 'inherit' }}>\n                  <CrossIcon />\n                </Sheet.Close>\n              </Flex>\n              <Box css={{ px: '$8', pb: '$8', maxHeight: '80vh', overflowY: 'auto' }}>\n                <TileMenuContent {...props} closeSheetOnClick={() => setOpen(false)} />\n              </Box>\n            </Sheet.Content>\n          </Sheet.Root>\n        ) : (\n          <StyledMenuTile.Content side=\"top\" align=\"end\" css={{ maxHeight: '$80', overflowY: 'auto' }}>\n            <TileMenuContent {...props} />\n          </StyledMenuTile.Content>\n        )}\n      </StyledMenuTile.Root>\n      {showNameChangeModal && <ChangeNameModal onOpenChange={setShowNameChangeModal} />}\n      {showRoleChangeModal && <RoleChangeModal peerId={peerID} onOpenChange={setShowRoleChangeModal} />}\n    </>\n  );\n};\n\nexport { isSameTile } from './TileMenuContent';\n\nexport default TileMenu;\n", "import React, { Fragment } from 'react';\nimport { useMedia } from 'react-use';\nimport {\n  HMSException,\n  HMSSimulcastLayerDefinition,\n  HMSTrackID,\n  HMSVideoTrack,\n  selectAvailableRoleNames,\n  selectPermissions,\n  selectSessionStore,\n  selectTrackByID,\n  useCustomEvent,\n  useHMSActions,\n  useHMSStore,\n  useRemoteAVToggle,\n} from '@100mslive/react-sdk';\nimport {\n  MicOffIcon,\n  MicOnIcon,\n  PencilIcon,\n  PersonSettingsIcon,\n  PinIcon,\n  RemoveUserIcon,\n  ShareScreenIcon,\n  ShrinkIcon,\n  SpeakerIcon,\n  StarIcon,\n  VideoOffIcon,\n  VideoOnIcon,\n} from '@100mslive/react-icons';\nimport { Box, Flex } from '../../../Layout';\nimport { Slider } from '../../../Slider';\nimport { Text } from '../../../Text';\nimport { config as cssConfig } from '../../../Theme';\nimport { StyledMenuTile } from '../../../TileMenu';\nimport { useHMSPrebuiltContext } from '../../AppContext';\n// @ts-ignore\nimport { ToastManager } from '../Toast/ToastManager';\n// @ts-ignore\nimport { useSetAppDataByKey } from '../AppData/useUISettings';\n// @ts-ignore\nimport { useDropdownSelection } from '../hooks/useDropdownSelection';\nimport { getDragClassName } from './utils';\nimport { APP_DATA, REMOTE_STOP_SCREENSHARE_TYPE, SESSION_STORE_KEY } from '../../common/constants';\n\nexport const isSameTile = ({\n  trackId,\n  videoTrackID,\n  audioTrackID,\n}: {\n  trackId: HMSTrackID;\n  videoTrackID?: string;\n  audioTrackID?: string;\n}) => !!trackId && ((!!videoTrackID && videoTrackID === trackId) || (!!audioTrackID && audioTrackID === trackId));\n\nconst spacingCSS = { '@md': { my: '$8', fontWeight: '$semiBold', fontSize: 'sm' } };\n\nconst SpotlightActions = ({\n  peerId,\n  onSpotLightClick = () => {\n    return;\n  },\n}: {\n  peerId: string;\n  onSpotLightClick: () => void;\n}) => {\n  const hmsActions = useHMSActions();\n  const spotlightPeerId = useHMSStore(selectSessionStore(SESSION_STORE_KEY.SPOTLIGHT));\n  const isTileSpotlighted = spotlightPeerId === peerId;\n  const dragClassName = getDragClassName();\n\n  const setSpotlightPeerId = (peerIdToSpotlight?: string) =>\n    hmsActions.sessionStore\n      .set(SESSION_STORE_KEY.SPOTLIGHT, peerIdToSpotlight)\n      .catch((err: HMSException) => ToastManager.addToast({ title: err.description }));\n\n  return (\n    <StyledMenuTile.ItemButton\n      className={dragClassName}\n      css={spacingCSS}\n      onClick={() => {\n        if (isTileSpotlighted) {\n          setSpotlightPeerId();\n        } else {\n          setSpotlightPeerId(peerId);\n        }\n        onSpotLightClick();\n      }}\n    >\n      <StarIcon height={20} width={20} />\n      <span>{isTileSpotlighted ? 'Remove from Spotlight' : 'Spotlight Tile for everyone'}</span>\n    </StyledMenuTile.ItemButton>\n  );\n};\n\nconst PinActions = ({ audioTrackID, videoTrackID }: { videoTrackID: string; audioTrackID: string }) => {\n  const [pinnedTrackId, setPinnedTrackId] = useSetAppDataByKey(APP_DATA.pinnedTrackId);\n  const dragClassName = getDragClassName();\n\n  const isTilePinned = isSameTile({\n    trackId: pinnedTrackId,\n    videoTrackID,\n    audioTrackID,\n  });\n\n  return (\n    <>\n      <StyledMenuTile.ItemButton\n        className={dragClassName}\n        css={spacingCSS}\n        onClick={() => (isTilePinned ? setPinnedTrackId() : setPinnedTrackId(videoTrackID || audioTrackID))}\n      >\n        <PinIcon height={20} width={20} />\n        <span>{isTilePinned ? 'Unpin' : 'Pin'} Tile for myself</span>\n      </StyledMenuTile.ItemButton>\n    </>\n  );\n};\n\nconst MinimiseInset = () => {\n  const [minimised, setMinimised] = useSetAppDataByKey(APP_DATA.minimiseInset);\n  const dragClassName = getDragClassName();\n\n  return (\n    <>\n      <StyledMenuTile.ItemButton className={dragClassName} css={spacingCSS} onClick={() => setMinimised(!minimised)}>\n        <ShrinkIcon height={20} width={20} />\n        <span>{minimised ? 'Show' : 'Minimise'} your video</span>\n      </StyledMenuTile.ItemButton>\n    </>\n  );\n};\n\nconst SimulcastLayers = ({ trackId }: { trackId: HMSTrackID }) => {\n  const track: HMSVideoTrack = useHMSStore(selectTrackByID(trackId)) as HMSVideoTrack;\n  const actions = useHMSActions();\n  const bg = useDropdownSelection();\n  if (!track?.layerDefinitions?.length || track.degraded || !track.enabled) {\n    return null;\n  }\n  const currentLayer = track.layerDefinitions.find((layer: HMSSimulcastLayerDefinition) => layer.layer === track.layer);\n  const dragClassName = getDragClassName();\n  return (\n    <Fragment>\n      <StyledMenuTile.ItemButton className={dragClassName} css={{ color: '$on_surface_medium', cursor: 'default' }}>\n        Select maximum resolution\n      </StyledMenuTile.ItemButton>\n      {track.layerDefinitions.map((layer: HMSSimulcastLayerDefinition) => {\n        return (\n          <StyledMenuTile.ItemButton\n            className={dragClassName}\n            key={layer.layer}\n            onClick={async () => {\n              await actions.setPreferredLayer(trackId, layer.layer);\n            }}\n            css={{\n              justifyContent: 'space-between',\n              bg: track.preferredLayer === layer.layer ? bg : undefined,\n              '&:hover': {\n                bg: track.preferredLayer === layer.layer ? bg : undefined,\n              },\n            }}\n          >\n            <Text\n              as=\"span\"\n              css={{\n                textTransform: 'capitalize',\n                mr: '$2',\n                fontWeight: track.preferredLayer === layer.layer ? '$semiBold' : '$regular',\n                color: track.preferredLayer === layer.layer ? '$on_primary_high' : '$on_surface_high',\n              }}\n            >\n              {layer.layer}\n            </Text>\n            <Text\n              as=\"span\"\n              variant=\"xs\"\n              css={{\n                color: track.preferredLayer === layer.layer ? '$on_primary_high' : '$on_surface_high',\n              }}\n            >\n              {layer.resolution.width}x{layer.resolution.height}\n            </Text>\n          </StyledMenuTile.ItemButton>\n        );\n      })}\n      <StyledMenuTile.ItemButton className={dragClassName}>\n        <Text as=\"span\" variant=\"xs\" css={{ color: '$on_surface_medium' }}>\n          Currently streaming:\n          <Text\n            as=\"span\"\n            variant=\"xs\"\n            css={{\n              fontWeight: '$semiBold',\n              textTransform: 'capitalize',\n              color: '$on_surface_medium',\n              ml: '$2',\n            }}\n          >\n            {currentLayer ? (\n              <>\n                {track.layer} ({currentLayer.resolution.width}x{currentLayer.resolution.height})\n              </>\n            ) : (\n              '-'\n            )}\n          </Text>\n        </Text>\n      </StyledMenuTile.ItemButton>\n    </Fragment>\n  );\n};\n\nexport const TileMenuContent = ({\n  videoTrackID,\n  audioTrackID,\n  isLocal,\n  isScreenshare,\n  showSpotlight,\n  showPinAction,\n  peerID,\n  canMinimise,\n  closeSheetOnClick = () => {\n    return;\n  },\n  openNameChangeModal = () => {\n    return;\n  },\n  openRoleChangeModal = () => {\n    return;\n  },\n}: {\n  videoTrackID: string;\n  audioTrackID: string;\n  isLocal: boolean;\n  isScreenshare: boolean;\n  showSpotlight: boolean;\n  showPinAction: boolean;\n  peerID: string;\n  canMinimise?: boolean;\n  closeSheetOnClick?: () => void;\n  openNameChangeModal?: () => void;\n  openRoleChangeModal?: () => void;\n}) => {\n  const actions = useHMSActions();\n  const dragClassName = getDragClassName();\n  const permissions = useHMSStore(selectPermissions);\n  const canChangeRole = !!permissions?.changeRole;\n  const removeOthers = !!permissions?.removeOthers;\n  const { userName } = useHMSPrebuiltContext();\n  const roles = useHMSStore(selectAvailableRoleNames);\n\n  const { isAudioEnabled, isVideoEnabled, setVolume, toggleAudio, toggleVideo, volume } = useRemoteAVToggle(\n    audioTrackID,\n    videoTrackID,\n  );\n\n  const { sendEvent } = useCustomEvent({\n    type: REMOTE_STOP_SCREENSHARE_TYPE,\n  });\n\n  const isMobile = useMedia(cssConfig.media.md);\n\n  if (isLocal) {\n    return showPinAction || canMinimise || !userName || showSpotlight ? (\n      <>\n        {showPinAction && <PinActions audioTrackID={audioTrackID} videoTrackID={videoTrackID} />}\n        {showSpotlight && <SpotlightActions peerId={peerID} onSpotLightClick={() => closeSheetOnClick()} />}\n        {canMinimise && <MinimiseInset />}\n        {!userName && (\n          <StyledMenuTile.ItemButton\n            className={dragClassName}\n            onClick={() => {\n              openNameChangeModal();\n              closeSheetOnClick();\n            }}\n          >\n            <PencilIcon height={20} width={20} />\n            <Text variant=\"sm\" css={{ '@md': { fontWeight: '$semiBold' }, c: '$on_surface_high' }}>\n              Change Name\n            </Text>\n          </StyledMenuTile.ItemButton>\n        )}\n      </>\n    ) : null;\n  }\n\n  return (\n    <>\n      {toggleVideo ? (\n        <StyledMenuTile.ItemButton\n          className={dragClassName}\n          css={spacingCSS}\n          onClick={() => {\n            toggleVideo();\n            closeSheetOnClick();\n          }}\n          data-testid={isVideoEnabled ? 'mute_video_participant_btn' : 'unmute_video_participant_btn'}\n        >\n          {isVideoEnabled ? <VideoOnIcon height={20} width={20} /> : <VideoOffIcon height={20} width={20} />}\n          <span>{isVideoEnabled ? 'Mute Video' : 'Request to Unmute Video'}</span>\n        </StyledMenuTile.ItemButton>\n      ) : null}\n\n      {toggleAudio ? (\n        <StyledMenuTile.ItemButton\n          css={spacingCSS}\n          className={dragClassName}\n          onClick={() => {\n            toggleAudio();\n            closeSheetOnClick();\n          }}\n          data-testid={isAudioEnabled ? 'mute_audio_participant_btn' : 'unmute_audio_participant_btn'}\n        >\n          {isAudioEnabled ? <MicOnIcon height={20} width={20} /> : <MicOffIcon height={20} width={20} />}\n          <span>{isAudioEnabled ? 'Mute Audio' : 'Request to Unmute Audio'}</span>\n        </StyledMenuTile.ItemButton>\n      ) : null}\n\n      {canChangeRole && roles.length > 1 ? (\n        <StyledMenuTile.ItemButton\n          className={dragClassName}\n          css={spacingCSS}\n          onClick={() => {\n            openRoleChangeModal();\n            closeSheetOnClick();\n          }}\n          data-testid=\"change_role_btn\"\n        >\n          <PersonSettingsIcon height={20} width={20} />\n          <span>Switch Role</span>\n        </StyledMenuTile.ItemButton>\n      ) : null}\n\n      {audioTrackID ? (\n        <StyledMenuTile.VolumeItem data-testid=\"participant_volume_slider\" css={{ ...spacingCSS, mb: '$0' }}>\n          <Flex align=\"center\" gap={1}>\n            <SpeakerIcon height={20} width={20} />\n            <Box as=\"span\" css={{ ml: '$4' }}>\n              Volume ({volume})\n            </Box>\n          </Flex>\n          <Slider\n            css={{ my: '0.5rem' }}\n            step={5}\n            value={[typeof volume === 'number' ? volume : 100]}\n            onValueChange={e => setVolume?.(e[0])}\n          />\n        </StyledMenuTile.VolumeItem>\n      ) : null}\n\n      {showPinAction && (\n        <>\n          <PinActions audioTrackID={audioTrackID} videoTrackID={videoTrackID} />\n          {showSpotlight && <SpotlightActions peerId={peerID} onSpotLightClick={() => closeSheetOnClick()} />}\n        </>\n      )}\n\n      {isMobile ? null : <SimulcastLayers trackId={videoTrackID} />}\n\n      {removeOthers ? (\n        <StyledMenuTile.RemoveItem\n          css={{ ...spacingCSS, borderTop: 'none' }}\n          onClick={async () => {\n            try {\n              await actions.removePeer(peerID, '');\n            } catch (error) {\n              // TODO: Toast here\n            }\n            closeSheetOnClick();\n          }}\n          data-testid=\"remove_participant_btn\"\n        >\n          <RemoveUserIcon height={20} width={20} />\n          <span>Remove Participant</span>\n        </StyledMenuTile.RemoveItem>\n      ) : null}\n\n      {removeOthers && isScreenshare ? (\n        <StyledMenuTile.RemoveItem\n          onClick={() => {\n            sendEvent({});\n            closeSheetOnClick();\n          }}\n          css={spacingCSS}\n        >\n          <ShareScreenIcon height={20} width={20} />\n          <span>Stop Screenshare</span>\n        </StyledMenuTile.RemoveItem>\n      ) : null}\n    </>\n  );\n};\n", "/**\n * Add __cancel-drag-event for the menu to open on touch devices on the draggdable element\n *\n */\nexport const getDragClassName = () => {\n  return navigator?.maxTouchPoints > 0 ? '__cancel-drag-event' : '';\n};\n", "const PEER_NAME_PLACEHOLDER = 'peerName';\nconst labelMap = new Map([\n  [[true, 'screen'].toString(), 'Your Screen'],\n  [[true, 'regular'].toString(), `You (${PEER_NAME_PLACEHOLDER})`],\n  [[false, 'screen'].toString(), `${PEER_NAME_PLACEHOLDER}'s Screen`],\n  [[false, 'regular'].toString(), PEER_NAME_PLACEHOLDER],\n  [[true, undefined].toString(), `You (${PEER_NAME_PLACEHOLDER})`],\n  [[false, undefined].toString(), `${PEER_NAME_PLACEHOLDER}`],\n]);\n\nexport const getVideoTileLabel = ({ peerName, isLocal, track }) => {\n  const isPeerPresent = peerName !== undefined;\n  if (!isPeerPresent || !track) {\n    // for peers with only audio track\n    return isPeerPresent ? labelMap.get([isLocal, undefined].toString()).replace(PEER_NAME_PLACEHOLDER, peerName) : '';\n  }\n  const isLocallyMuted = track.volume === 0;\n  // Map [isLocal, videoSource] to the label to be displayed.\n  let label = labelMap.get([isLocal, track.source].toString());\n  if (label) {\n    label = label.replace(PEER_NAME_PLACEHOLDER, peerName);\n  } else {\n    label = `${peerName} ${track.source}`;\n  }\n  // label = `${label}${track.degraded ? '(Degraded)' : ''}`;\n  return `${label}${isLocallyMuted ? ' (Muted for you)' : ''}`;\n};\n", "import React, { useEffect, useRef, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport {\n  HMSMediaStreamPlugin,\n  selectAppData,\n  selectEffectsKey,\n  selectIsEffectsEnabled,\n  selectLocalPeerRole,\n} from '@100mslive/hms-video-store';\n// Open issue with eslint-plugin-import https://github.com/import-js/eslint-plugin-import/issues/1810\n// eslint-disable-next-line\nimport { HMSVBPlugin, HMSVirtualBackgroundTypes } from '@100mslive/hms-virtual-background/hmsvbplugin';\nimport { VirtualBackgroundMedia } from '@100mslive/types-prebuilt/elements/virtual_background';\nimport {\n  HMSRoomState,\n  selectIsLargeRoom,\n  selectIsLocalVideoEnabled,\n  selectIsLocalVideoPluginPresent,\n  selectLocalPeer,\n  selectRoomState,\n  selectVideoTrackByID,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { BlurPersonHighIcon, CrossCircleIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Box, config as cssConfig, Flex, Loading, Slider, Video } from '../../../index';\nimport { Text } from '../../../Text';\nimport { VBCollection } from './VBCollection';\nimport { VBHandler } from './VBHandler';\n// @ts-ignore\nimport { useSidepaneToggle } from '../AppData/useSidepane';\nimport { useSidepaneResetOnLayoutUpdate } from '../AppData/useSidepaneResetOnLayoutUpdate';\n// @ts-ignore\nimport { useSetAppDataByKey, useUISettings } from '../AppData/useUISettings';\nimport { APP_DATA, SIDE_PANE_OPTIONS, UI_SETTINGS } from '../../common/constants';\n\nconst iconDims = { height: '40px', width: '40px' };\n\nexport const VBPicker = ({ backgroundMedia = [] }: { backgroundMedia: VirtualBackgroundMedia[] }) => {\n  const toggleVB = useSidepaneToggle(SIDE_PANE_OPTIONS.VB);\n  const hmsActions = useHMSActions();\n  const localPeer = useHMSStore(selectLocalPeer);\n  const role = useHMSStore(selectLocalPeerRole);\n  const isVideoOn = useHMSStore(selectIsLocalVideoEnabled);\n  const mirrorLocalVideo = useUISettings(UI_SETTINGS.mirrorLocalVideo);\n  const trackSelector = selectVideoTrackByID(localPeer?.videoTrack);\n  const track = useHMSStore(trackSelector);\n  const [blurAmount, setBlurAmount] = useState(VBHandler.getBlurAmount() || 0.5);\n  const roomState = useHMSStore(selectRoomState);\n  const isLargeRoom = useHMSStore(selectIsLargeRoom);\n  const isEffectsSupported = VBHandler.isEffectsSupported();\n  const isEffectsEnabled = useHMSStore(selectIsEffectsEnabled);\n  const effectsKey = useHMSStore(selectEffectsKey);\n  const isMobile = useMedia(cssConfig.media.md);\n  const [loadingEffects, setLoadingEffects] = useSetAppDataByKey(APP_DATA.loadingEffects);\n  const isPluginAdded = useHMSStore(selectIsLocalVideoPluginPresent(VBHandler?.getName() || ''));\n  const background = useHMSStore(selectAppData(APP_DATA.background));\n  const mediaList = backgroundMedia.map((media: VirtualBackgroundMedia) => media.url || '');\n  const pluginLoadingRef = useRef(false);\n\n  const inPreview = roomState === HMSRoomState.Preview;\n  // Hidden in preview as the effect will be visible in the preview tile\n  const showVideoTile = isVideoOn && isLargeRoom && !inPreview;\n\n  useEffect(() => {\n    const addHMSVBPlugin = async () => {\n      setLoadingEffects(false);\n      if (!role) {\n        return;\n      }\n      await VBHandler.initialisePlugin();\n      await hmsActions.addPluginToVideoTrack(\n        VBHandler.getVBObject() as HMSVBPlugin,\n        Math.floor(role.publishParams.video.frameRate / 2),\n      );\n    };\n    const initializeVirtualBackground = async () => {\n      if (!track?.id || pluginLoadingRef.current || isPluginAdded) {\n        return;\n      }\n\n      try {\n        pluginLoadingRef.current = true;\n        if (isEffectsEnabled && isEffectsSupported && effectsKey) {\n          setLoadingEffects(true);\n          await VBHandler.initialisePlugin(effectsKey, () => {\n            setLoadingEffects(false);\n          });\n          const vbInstance = VBHandler.getVBObject();\n          if (vbInstance.getName() === 'HMSEffects') {\n            hmsActions.addPluginsToVideoStream([VBHandler.getVBObject() as HMSMediaStreamPlugin]);\n          } else {\n            await addHMSVBPlugin();\n          }\n        } else {\n          await addHMSVBPlugin();\n        }\n\n        const handleDefaultBackground = async () => {\n          switch (background) {\n            case HMSVirtualBackgroundTypes.NONE:\n              break;\n            case HMSVirtualBackgroundTypes.BLUR:\n              await VBHandler.setBlur(blurAmount);\n              break;\n            default:\n              await VBHandler.setBackground(background);\n          }\n        };\n\n        await handleDefaultBackground();\n      } catch (error) {\n        console.error('Error initializing virtual background:', error);\n        setLoadingEffects(false);\n      }\n    };\n\n    initializeVirtualBackground();\n  }, [\n    hmsActions,\n    role,\n    isPluginAdded,\n    isEffectsEnabled,\n    isEffectsSupported,\n    effectsKey,\n    track?.id,\n    background,\n    blurAmount,\n    setLoadingEffects,\n  ]);\n\n  useEffect(() => {\n    if (!isVideoOn) {\n      toggleVB();\n    }\n    return () => setLoadingEffects(false);\n  }, [isVideoOn, setLoadingEffects, toggleVB]);\n\n  useSidepaneResetOnLayoutUpdate('virtual_background', SIDE_PANE_OPTIONS.VB);\n\n  return (\n    <Flex css={{ pr: '$6', size: '100%' }} direction=\"column\">\n      <Flex align=\"center\" justify=\"between\" css={{ w: '100%', background: '$surface_dim', pb: '$4' }}>\n        <Text variant=\"h6\" css={{ color: '$on_surface_high', display: 'flex', alignItems: 'center' }}>\n          Virtual Background {isMobile && loadingEffects ? <Loading size={18} style={{ marginLeft: '0.5rem' }} /> : ''}\n        </Text>\n        <Box\n          css={{ color: '$on_surface_high', '&:hover': { color: '$on_surface_medium' }, cursor: 'pointer' }}\n          onClick={toggleVB}\n        >\n          <CrossIcon />\n        </Box>\n      </Flex>\n\n      {showVideoTile ? (\n        <Video\n          mirror={track?.facingMode !== 'environment' && mirrorLocalVideo}\n          trackId={localPeer?.videoTrack}\n          data-testid=\"preview_tile\"\n          css={{ width: '100%', height: '16rem' }}\n        />\n      ) : null}\n      <Box\n        css={{\n          mt: '$4',\n          overflowY: 'auto',\n          flex: '1 1 0',\n          mr: '-$10',\n          pr: '$10',\n        }}\n      >\n        <VBCollection\n          title=\"Effects\"\n          options={[\n            {\n              title: 'No effect',\n              icon: <CrossCircleIcon style={iconDims} />,\n              value: HMSVirtualBackgroundTypes.NONE,\n              onClick: async () => {\n                await VBHandler.removeEffects();\n                hmsActions.setAppData(APP_DATA.background, HMSVirtualBackgroundTypes.NONE);\n              },\n              supported: true,\n            },\n            {\n              title: 'Blur',\n              icon: <BlurPersonHighIcon style={iconDims} />,\n              value: HMSVirtualBackgroundTypes.BLUR,\n              onClick: async () => {\n                await VBHandler?.setBlur(blurAmount);\n                hmsActions.setAppData(APP_DATA.background, HMSVirtualBackgroundTypes.BLUR);\n              },\n              supported: isEffectsSupported && isEffectsEnabled,\n            },\n          ]}\n          activeBackground={background}\n        />\n\n        {/* Slider */}\n        <Flex direction=\"column\" css={{ w: '100%', gap: '$8', mt: '$8' }}>\n          {background === HMSVirtualBackgroundTypes.BLUR && isEffectsEnabled && effectsKey ? (\n            <Box>\n              <Text variant=\"sm\" css={{ color: '$on_surface_high', fontWeight: '$semiBold', mb: '$4' }}>\n                Blur intensity\n              </Text>\n              <Flex css={{ w: '100%', justifyContent: 'space-between', alignItems: 'center', gap: '$4' }}>\n                <Text variant=\"caption\" css={{ fontWeight: '$medium', color: '$on_surface_medium' }}>\n                  Low\n                </Text>\n                <Slider\n                  showTooltip={false}\n                  value={[blurAmount]}\n                  onValueChange={async e => {\n                    setBlurAmount(e[0]);\n                    await VBHandler.setBlur(e[0]);\n                  }}\n                  step={0.1}\n                  min={0.1}\n                  max={1}\n                />\n                <Text variant=\"caption\" css={{ fontWeight: '$medium', color: '$on_surface_medium' }}>\n                  High\n                </Text>\n              </Flex>\n            </Box>\n          ) : null}\n        </Flex>\n\n        <VBCollection\n          title=\"Backgrounds\"\n          options={mediaList.map(mediaURL => ({\n            mediaURL,\n            value: mediaURL,\n            onClick: async () => {\n              await VBHandler?.setBackground(mediaURL);\n              hmsActions.setAppData(APP_DATA.background, mediaURL);\n            },\n            supported: true,\n          }))}\n          activeBackground={background}\n        />\n      </Box>\n    </Flex>\n  );\n};\n", "import React from 'react';\n// Open issue with eslint-plugin-import https://github.com/import-js/eslint-plugin-import/issues/1810\n// eslint-disable-next-line\nimport { HMSVirtualBackgroundTypes } from '@100mslive/hms-virtual-background/hmsvbplugin';\nimport { Box } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { VBOption } from './VBOption';\n\nexport const VBCollection = ({\n  options,\n  title,\n  activeBackground = '',\n}: {\n  options: {\n    title?: string;\n    icon?: React.JSX.Element;\n    onClick?: () => Promise<void>;\n    mediaURL?: string;\n    value: string | HMSVirtualBackgroundTypes;\n    supported?: boolean;\n  }[];\n  title: string;\n  activeBackground: string;\n}) => {\n  if (options.length === 0) {\n    return null;\n  }\n  return (\n    <Box css={{ mt: '$10' }}>\n      <Text variant=\"sm\" css={{ color: '$on_surface_high', fontWeight: '$semiBold' }}>\n        {title}\n      </Text>\n      <Box css={{ py: '$4', display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '$8' }}>\n        {options.map((option, index) =>\n          option.supported ? (\n            <VBOption.Root\n              key={option.value}\n              testid={option.value === HMSVirtualBackgroundTypes.IMAGE ? `virtual_bg_option-${index}` : option.value}\n              {...option}\n              isActive={activeBackground === option.value}\n            >\n              <VBOption.Icon>{option?.icon}</VBOption.Icon>\n              <VBOption.Title>{option?.title}</VBOption.Title>\n            </VBOption.Root>\n          ) : (\n            ''\n          ),\n        )}\n      </Box>\n    </Box>\n  );\n};\n", "import React from 'react';\nimport { Box, Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\n\nconst Root = ({\n  onClick,\n  mediaURL,\n  isActive,\n  children,\n  testid = '',\n}: {\n  onClick?: () => Promise<void>;\n  mediaURL?: string;\n  isActive: boolean;\n  children?: React.JSX.Element[];\n  testid: string;\n}) => (\n  <Flex\n    data-testid={testid}\n    direction=\"column\"\n    align=\"center\"\n    css={{\n      p: '$5',\n      borderRadius: '$1',\n      bg: '$surface_bright',\n      border: `4px solid ${isActive ? '$primary_default' : '$surface_dim'}`,\n      cursor: 'pointer',\n      '&:hover': { border: '4px solid $primary_dim' },\n      ...(mediaURL ? { height: '$20', backgroundImage: `url(\"${mediaURL}\")`, backgroundSize: 'cover' } : {}),\n    }}\n    onClick={async () => {\n      await onClick?.();\n    }}\n  >\n    {children}\n  </Flex>\n);\n\nconst Title = ({ children }: { children?: string }) => {\n  return children ? (\n    <Text variant=\"xs\" css={{ color: '$on_surface_medium' }}>\n      {children}\n    </Text>\n  ) : null;\n};\n\nconst Icon = ({ children }: { children?: React.JSX.Element }) => {\n  return children ? <Box css={{ color: '$on_surface_high' }}>{children}</Box> : null;\n};\n\nexport const VBOption = {\n  Root,\n  Title,\n  Icon,\n};\n", "import React from 'react';\nimport { Flex } from '../../Layout';\nimport { Text } from '../../Text';\nimport { CSS } from '../../Theme';\n\nconst Chip = ({\n  icon = <></>,\n  content = '',\n  backgroundColor = '$surface_default',\n  textColor = '$on_surface_high',\n  hideIfNoContent = false,\n  onClick,\n  css = {},\n}: {\n  icon?: React.JSX.Element;\n  content: string;\n  backgroundColor?: string;\n  textColor?: string;\n  hideIfNoContent?: boolean;\n  onClick?: () => void | Promise<void>;\n  css?: CSS;\n}) => {\n  if (hideIfNoContent && !content) {\n    return null;\n  }\n  return (\n    <Flex\n      align=\"center\"\n      css={{ backgroundColor, p: '$4 $6', gap: '$2', borderRadius: '$4', ...css }}\n      onClick={() => onClick?.()}\n    >\n      {icon}\n      <Text variant=\"sm\" css={{ fontWeight: '$semiBold', color: textColor }}>\n        {content}\n      </Text>\n    </Flex>\n  );\n};\n\nexport default Chip;\n", "import React from 'react';\nimport { Flex } from '../../Layout';\nimport { Loading } from '../../Loading';\nimport { Text } from '../../Text';\nimport { CSS } from '../../Theme';\n\nconst FullPageProgress = ({\n  loaderColor = '$primary_default',\n  text = '',\n  css = {},\n}: {\n  loaderColor?: string;\n  text?: string;\n  css?: CSS;\n}) => (\n  <Flex direction=\"column\" justify=\"center\" align=\"center\" css={{ size: '100%', color: loaderColor, ...css }}>\n    <Loading color=\"currentColor\" size={100} />\n    {text ? <Text css={{ mt: '$10', color: '$on_surface_high' }}>{text}</Text> : null}\n  </Flex>\n);\n\nexport default FullPageProgress;\n", "import React from 'react';\nimport { useMedia } from 'react-use';\nimport { JoinForm_JoinBtnType } from '@100mslive/types-prebuilt/elements/join_form';\nimport { useRecordingStreaming } from '@100mslive/react-sdk';\nimport { GoLiveIcon } from '@100mslive/react-icons';\nimport { Button, config as cssConfig, Flex, Input, styled } from '../../..';\nimport { useRoomLayout } from '../../provider/roomLayoutProvider';\n// @ts-ignore: No implicit Any\nimport { PreviewSettings } from './PreviewJoin';\n\nconst PreviewForm = ({\n  name,\n  disabled,\n  onChange,\n  onJoin,\n  enableJoin,\n  cannotPublishVideo = false,\n  cannotPublishAudio = false,\n}: {\n  name: string;\n  disabled?: boolean;\n  onChange: (name: string) => void;\n  onJoin: () => void;\n  enableJoin: boolean;\n  cannotPublishVideo: boolean;\n  cannotPublishAudio: boolean;\n}) => {\n  const formSubmit = (e: React.SyntheticEvent) => {\n    e.preventDefault();\n  };\n  const isMobile = useMedia(cssConfig.media.md);\n  const { isHLSRunning, isRTMPRunning, isHLSRecordingOn, isBrowserRecordingOn } = useRecordingStreaming();\n\n  const layout = useRoomLayout();\n  const { join_form: joinForm = {} } = layout?.screens?.preview?.default?.elements || {};\n\n  const showGoLive =\n    joinForm?.join_btn_type === JoinForm_JoinBtnType.JOIN_BTN_TYPE_JOIN_AND_GO_LIVE &&\n    !isHLSRunning &&\n    !isRTMPRunning &&\n    !isHLSRecordingOn &&\n    !isBrowserRecordingOn;\n\n  return (\n    <Form\n      css={{ flexDirection: cannotPublishVideo ? 'column' : 'row', '@md': { flexDirection: 'row' } }}\n      onSubmit={formSubmit}\n    >\n      <Flex align=\"center\" css={{ gap: '$8', w: '100%' }}>\n        <Input\n          required\n          id=\"name\"\n          disabled={disabled}\n          css={{ w: '100%', boxSizing: 'border-box' }}\n          value={name}\n          onChange={e => onChange(e.target.value.trimStart())}\n          placeholder=\"Enter name\"\n          autoFocus\n          autoComplete=\"name\"\n          onKeyDown={e => {\n            if (e.key === 'Enter' && name.trim().length > 0) {\n              e.preventDefault();\n              if (isMobile) {\n                return;\n              }\n              onJoin();\n            }\n          }}\n        />\n        {cannotPublishAudio && cannotPublishVideo && !isMobile ? <PreviewSettings /> : null}\n      </Flex>\n\n      <Button type=\"submit\" icon disabled={!name || !enableJoin} onClick={onJoin}>\n        {/* Conditions to show go live: The first broadcaster joins a streaming kit that is not live */}\n        {showGoLive ? <GoLiveIcon height={18} width={18} /> : null}\n        {showGoLive ? joinForm.go_live_btn_label : joinForm.join_btn_label}\n      </Button>\n    </Form>\n  );\n};\n\nconst Form = styled('form', {\n  width: '100%',\n  display: 'flex',\n  alignItems: 'center',\n  gap: '$8',\n  mt: '$10',\n  mb: '$10',\n  '@md': {\n    gap: '$4',\n  },\n});\n\nexport default PreviewForm;\n", "import React from 'react';\nimport { useMedia } from 'react-use';\nimport { Box, Button, config as cssConfig, Dialog, Flex, Text } from '../../..';\nimport { Sheet } from '../../../Sheet';\n\nexport const RequestPrompt = ({\n  open = true,\n  onOpenChange,\n  title,\n  body,\n  actionText = 'Accept',\n  onAction,\n  disableActions = false,\n}: {\n  open?: boolean;\n  onOpenChange: (value: boolean) => void;\n  title: string;\n  body: React.ReactNode;\n  actionText?: string;\n  onAction: () => void;\n  disableActions?: boolean;\n}) => {\n  const isMobile = useMedia(cssConfig.media.md);\n\n  if (isMobile) {\n    return (\n      <Sheet.Root open={open} onOpenChange={onOpenChange}>\n        <Sheet.Content css={{ py: '$8' }}>\n          <Text css={{ fontWeight: '$semiBold', c: '$on_surface_high', '@md': { px: '$8' } }}>{title}</Text>\n          {body}\n          <RequestActions actionText={actionText} onAction={onAction} disabled={disableActions} />\n        </Sheet.Content>\n      </Sheet.Root>\n    );\n  }\n\n  return (\n    <Dialog.Root open={open} modal={false} onOpenChange={onOpenChange}>\n      <Dialog.Portal>\n        <Dialog.Content css={{ p: '$10' }} onInteractOutside={e => e.preventDefault()}>\n          <Dialog.Title css={{ p: 0, display: 'flex', flexDirection: 'row', gap: '$md', justifyContent: 'center' }}>\n            <Text variant=\"h6\">{title}</Text>\n          </Dialog.Title>\n          <Box css={{ mt: '$4', mb: '$10' }}>{body}</Box>\n          <RequestActions actionText={actionText} onAction={onAction} disabled={disableActions} />\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n};\n\nconst RequestActions = ({\n  onAction,\n  actionText,\n  disabled = false,\n}: {\n  actionText?: string;\n  onAction: () => void;\n  disabled?: boolean;\n}) => (\n  <Flex justify=\"center\" align=\"center\" css={{ width: '100%', gap: '$md', '@md': { mt: '$8', px: '$8' } }}>\n    <Box css={{ width: '50%' }}>\n      <Dialog.Close css={{ width: '100%', height: '100%' }} asChild>\n        <Button variant=\"standard\" outlined css={{ width: '100%', p: '$4 $8' }} disabled={disabled}>\n          Decline\n        </Button>\n      </Dialog.Close>\n    </Box>\n    <Box css={{ width: '50%' }}>\n      <Button variant=\"primary\" css={{ width: '100%' }} onClick={onAction} disabled={disabled}>\n        {actionText}\n      </Button>\n    </Box>\n  </Flex>\n);\n", "import React, { Suspense, useEffect, useState } from 'react';\nimport { ControlPosition } from 'react-draggable';\nimport { useMedia } from 'react-use';\nimport {\n  ConferencingScreen,\n  DefaultConferencingScreen_Elements,\n  HLSLiveStreamingScreen_Elements,\n} from '@100mslive/types-prebuilt';\nimport { match } from 'ts-pattern';\nimport {\n  selectIsConnectedToRoom,\n  selectIsLocalScreenShared,\n  selectLocalPeerRoleName,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { PeopleAddIcon, ShareScreenIcon } from '@100mslive/react-icons';\nimport FullPageProgress from '../components/FullPageProgress';\nimport { GridLayout } from '../components/VideoLayouts/GridLayout';\nimport { Box, Flex } from '../../Layout';\nimport { config } from '../../Theme';\n// @ts-ignore: No implicit Any\nimport { EmbedView } from './EmbedView';\n// @ts-ignore: No implicit Any\nimport { PDFView } from './PDFView';\nimport SidePane from './SidePane';\n// @ts-ignore: No implicit Any\nimport { WaitingView } from './WaitingView';\nimport { CaptionsViewer } from '../plugins/CaptionsViewer';\n// @ts-ignore: No implicit Any\nimport { usePDFConfig, useUrlToEmbed } from '../components/AppData/useUISettings';\nimport { useCloseScreenshareWhiteboard } from '../components/hooks/useCloseScreenshareWhiteboard';\nimport { useLandscapeHLSStream, useMobileHLSStream, useWaitingRoomInfo } from '../common/hooks';\nimport { SESSION_STORE_KEY } from '../common/constants';\n// @ts-ignore: No implicit Any\nconst HLSView = React.lazy(() => import('./HLSView'));\n\nexport const VideoStreamingSection = ({\n  screenType,\n  elements,\n  hideControls = false,\n}: {\n  screenType: keyof ConferencingScreen;\n  elements: DefaultConferencingScreen_Elements | HLSLiveStreamingScreen_Elements;\n  hideControls: boolean;\n}) => {\n  const localPeerRoleName = useHMSStore(selectLocalPeerRoleName);\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const isSharingScreen = useHMSStore(selectIsLocalScreenShared);\n\n  const hmsActions = useHMSActions();\n  const urlToIframe = useUrlToEmbed();\n  const pdfAnnotatorActive = usePDFConfig();\n  const isMobileHLSStream = useMobileHLSStream();\n  const isLandscapeHLSStream = useLandscapeHLSStream();\n  const isMobile = useMedia(config.media.md);\n  const [captionPosition, setCaptionPosition] = useState<ControlPosition>({ x: isMobile ? 0 : -200, y: 0 });\n  useCloseScreenshareWhiteboard();\n\n  const { isNotAllowedToPublish, isScreenOnlyPublishParams, hasSubscribedRolePublishing } = useWaitingRoomInfo();\n\n  useEffect(() => {\n    if (!isConnected) {\n      return;\n    }\n    hmsActions.sessionStore.observe([\n      SESSION_STORE_KEY.PINNED_MESSAGES,\n      SESSION_STORE_KEY.SPOTLIGHT,\n      SESSION_STORE_KEY.CHAT_STATE,\n      SESSION_STORE_KEY.CHAT_MESSAGE_BLACKLIST,\n      SESSION_STORE_KEY.CHAT_PEER_BLACKLIST,\n    ]);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isConnected, hmsActions]);\n\n  if (!localPeerRoleName) {\n    // we don't know the role yet to decide how to render UI\n    return null;\n  }\n\n  return (\n    <Suspense fallback={<FullPageProgress />}>\n      <Flex\n        css={{\n          size: '100%',\n          position: 'relative',\n          gap: isMobileHLSStream || isLandscapeHLSStream ? '0' : '$4',\n        }}\n        direction={match<Record<string, boolean>, 'row' | 'column'>({ isLandscapeHLSStream, isMobileHLSStream })\n          .with({ isLandscapeHLSStream: true }, () => 'row')\n          .with({ isMobileHLSStream: true }, () => 'column')\n          .otherwise(() => 'row')}\n      >\n        {match({\n          screenType,\n          isNotAllowedToPublish,\n          isScreenOnlyPublishParams,\n          hasSubscribedRolePublishing,\n          isSharingScreen,\n          pdfAnnotatorActive,\n          urlToIframe,\n        })\n          .with(\n            {\n              screenType: 'hls_live_streaming',\n            },\n            () => <HLSView />,\n          )\n          .when(\n            ({ isNotAllowedToPublish, hasSubscribedRolePublishing }) =>\n              isNotAllowedToPublish && !hasSubscribedRolePublishing,\n            () => (\n              <WaitingView\n                title=\"Waiting for Host to join\"\n                subtitle=\"Sit back and relax\"\n                icon={<PeopleAddIcon width=\"56px\" height=\"56px\" style={{ color: 'white' }} />}\n              />\n            ),\n          )\n          .when(\n            ({ isScreenOnlyPublishParams, isSharingScreen, hasSubscribedRolePublishing }) =>\n              isScreenOnlyPublishParams && !isSharingScreen && !hasSubscribedRolePublishing,\n            () => (\n              <WaitingView\n                title=\"Ready to present\"\n                subtitle=\"Select the Screenshare button to start presenting\"\n                icon={<ShareScreenIcon width=\"56px\" height=\"56px\" style={{ color: 'white' }} />}\n              />\n            ),\n          )\n          .when(\n            ({ pdfAnnotatorActive }) => !!pdfAnnotatorActive,\n            () => <PDFView />,\n          )\n          .when(\n            ({ urlToIframe }) => !!urlToIframe,\n            () => <EmbedView />,\n          )\n\n          .otherwise(() => {\n            // @ts-ignore\n            return <GridLayout {...(elements as DefaultConferencingScreen_Elements)?.video_tile_layout?.grid} />;\n          })}\n        <CaptionsViewer setDefaultPosition={setCaptionPosition} defaultPosition={captionPosition} />\n        <Box\n          css={{\n            flex: match({ isLandscapeHLSStream, isMobileHLSStream })\n              .with({ isLandscapeHLSStream: true }, () => '1  1 0')\n              .with({ isMobileHLSStream: true }, () => '2 1 0')\n              .otherwise(() => undefined),\n            position: 'relative',\n            height: !isMobileHLSStream ? '100%' : undefined,\n            maxHeight: '100%',\n            '&:empty': { display: 'none' },\n            overflowY: 'clip',\n          }}\n        >\n          <SidePane\n            screenType={screenType}\n            // @ts-ignore\n            tileProps={(elements as DefaultConferencingScreen_Elements)?.video_tile_layout?.grid}\n            hideControls={hideControls}\n          />\n        </Box>\n      </Flex>\n    </Suspense>\n  );\n};\n", "import React, { useEffect, useMemo, useState } from 'react';\nimport { GridVideoTileLayout } from '@100mslive/types-prebuilt/elements/video_tile_layout';\nimport {\n  selectLocalPeerID,\n  selectLocalPeerRoleName,\n  selectPeers,\n  selectPeerScreenSharing,\n  selectWhiteboard,\n  useHMSStore,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\n// @ts-ignore: No implicit Any\nimport { EqualProminence } from './EqualProminence';\nimport { RoleProminence } from './RoleProminence';\nimport { ScreenshareLayout } from './ScreenshareLayout';\nimport { WhiteboardLayout } from './WhiteboardLayout';\n// @ts-ignore: No implicit Any\nimport { usePinnedTrack, useSetAppDataByKey } from '../AppData/useUISettings';\nimport { VideoTileContext } from '../hooks/useVideoTileLayout';\nimport PeersSorter from '../../common/PeersSorter';\nimport { APP_DATA } from '../../common/constants';\n\nexport type TileCustomisationProps = {\n  hide_participant_name_on_tile: boolean;\n  rounded_video_tile: boolean;\n  hide_audio_mute_on_tile: boolean;\n  video_object_fit: 'contain' | 'cover';\n  edge_to_edge: boolean;\n  hide_metadata_on_tile: boolean;\n};\n\nexport type GridLayoutProps = GridVideoTileLayout & TileCustomisationProps;\n\nexport const GridLayout = ({\n  enable_local_tile_inset: isInsetEnabled = false,\n  prominent_roles: prominentRoles = [],\n  enable_spotlighting_peer = false,\n  hide_participant_name_on_tile = false,\n  rounded_video_tile = true,\n  hide_audio_mute_on_tile = false,\n  video_object_fit = 'contain',\n  edge_to_edge = false,\n  hide_metadata_on_tile = false,\n}: GridLayoutProps) => {\n  const peerSharing = useHMSStore(selectPeerScreenSharing);\n  const whiteboard = useHMSStore(selectWhiteboard);\n  const pinnedTrack = usePinnedTrack();\n  const peers = useHMSStore(selectPeers);\n  const localPeerRole = useHMSStore(selectLocalPeerRoleName);\n  const localPeerID = useHMSStore(selectLocalPeerID);\n\n  const [activeScreensharePeerId] = useSetAppDataByKey(APP_DATA.activeScreensharePeerId);\n  const isRoleProminence =\n    (prominentRoles.length &&\n      peers.some(\n        peer => peer.roleName && prominentRoles.includes(peer.roleName) && (peer.videoTrack || peer.audioTrack),\n      )) ||\n    pinnedTrack;\n  const updatedPeers = useMemo(() => {\n    // remove screenshare/whiteboard peer from active speaker sorting\n    if (activeScreensharePeerId || whiteboard?.open) {\n      return peers.filter(peer => peer.id !== activeScreensharePeerId || peer.customerUserId !== whiteboard?.owner);\n    }\n    if (isInsetEnabled) {\n      const isLocalPeerPinned = localPeerID === pinnedTrack?.peerId;\n      // if localPeer role is prominent role, it shows up in the center or local peer is pinned, so allow it in active speaker sorting\n      if ((localPeerRole && prominentRoles.includes(localPeerRole)) || isLocalPeerPinned) {\n        return peers;\n      } else {\n        return peers.filter(peer => !peer.isLocal);\n      }\n    }\n    return peers;\n  }, [\n    isInsetEnabled,\n    whiteboard,\n    activeScreensharePeerId,\n    localPeerRole,\n    localPeerID,\n    prominentRoles,\n    peers,\n    pinnedTrack,\n  ]);\n  const vanillaStore = useHMSVanillaStore();\n  const [sortedPeers, setSortedPeers] = useState(updatedPeers);\n  const peersSorter = useMemo(() => new PeersSorter(vanillaStore), [vanillaStore]);\n  const [pageSize, setPageSize] = useState(0);\n  const [mainPage, setMainPage] = useState(0);\n  const tileLayout = {\n    enableSpotlightingPeer: enable_spotlighting_peer,\n    hideParticipantNameOnTile: hide_participant_name_on_tile,\n    roundedVideoTile: rounded_video_tile,\n    hideAudioMuteOnTile: hide_audio_mute_on_tile,\n    hideMetadataOnTile: hide_metadata_on_tile,\n    objectFit: video_object_fit,\n  };\n\n  useEffect(() => {\n    if (mainPage !== 0) {\n      return;\n    }\n    peersSorter.setPeersAndTilesPerPage({\n      peers: updatedPeers,\n      tilesPerPage: pageSize,\n    });\n    peersSorter.onUpdate(setSortedPeers);\n  }, [mainPage, peersSorter, updatedPeers, pageSize]);\n\n  if (peerSharing) {\n    return (\n      <VideoTileContext.Provider value={tileLayout}>\n        <ScreenshareLayout\n          peers={sortedPeers}\n          onPageSize={setPageSize}\n          onPageChange={setMainPage}\n          edgeToEdge={edge_to_edge}\n        />\n      </VideoTileContext.Provider>\n    );\n  } else if (whiteboard?.open) {\n    return (\n      <VideoTileContext.Provider value={tileLayout}>\n        <WhiteboardLayout\n          peers={sortedPeers}\n          onPageSize={setPageSize}\n          onPageChange={setMainPage}\n          edgeToEdge={edge_to_edge}\n        />\n      </VideoTileContext.Provider>\n    );\n  } else if (isRoleProminence) {\n    return (\n      <VideoTileContext.Provider value={tileLayout}>\n        <RoleProminence\n          peers={sortedPeers}\n          onPageSize={setPageSize}\n          onPageChange={setMainPage}\n          prominentRoles={prominentRoles}\n          isInsetEnabled={isInsetEnabled}\n          edgeToEdge={edge_to_edge}\n        />\n      </VideoTileContext.Provider>\n    );\n  }\n  return (\n    <VideoTileContext.Provider value={tileLayout}>\n      <EqualProminence\n        peers={sortedPeers}\n        onPageSize={setPageSize}\n        onPageChange={setMainPage}\n        isInsetEnabled={isInsetEnabled}\n        edgeToEdge={edge_to_edge}\n      />\n    </VideoTileContext.Provider>\n  );\n};\n", "import React, { useEffect, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { PeopleAddIcon } from '@100mslive/react-icons';\nimport { Flex } from '../../../Layout';\nimport { config as cssConfig } from '../../../Theme';\nimport { WaitingView } from '../../layouts/WaitingView';\nimport { InsetTile } from '../InsetTile';\nimport { Pagination } from '../Pagination';\nimport { Grid } from './Grid';\nimport { LayoutProps } from './interface';\n// @ts-ignore: No implicit Any\nimport { useUISettings } from '../AppData/useUISettings';\nimport { usePagesWithTiles, useTileLayout } from '../hooks/useTileLayout';\nimport { UI_SETTINGS } from '../../common/constants';\n\nexport function EqualProminence({ isInsetEnabled = false, peers, onPageChange, onPageSize, edgeToEdge }: LayoutProps) {\n  const isMobile = useMedia(cssConfig.media.md);\n  let maxTileCount = useUISettings(UI_SETTINGS.maxTileCount);\n  maxTileCount = isMobile ? Math.min(maxTileCount, 6) : maxTileCount;\n  const pageList = usePagesWithTiles({\n    peers,\n    maxTileCount,\n  });\n\n  const { ref, pagesWithTiles } = useTileLayout({\n    pageList,\n    maxTileCount,\n    edgeToEdge,\n  });\n  const [page, setPage] = useState(0);\n  const pageSize = pagesWithTiles[0]?.length || 0;\n\n  useEffect(() => {\n    if (pageSize > 0) {\n      onPageSize?.(pageSize);\n    }\n  }, [pageSize, onPageSize]);\n\n  return (\n    <Flex direction=\"column\" css={{ flex: '1 1 0', h: '100%', position: 'relative', minWidth: 0 }}>\n      <Grid tiles={pagesWithTiles[page]} ref={ref} edgeToEdge={edgeToEdge} />\n      {!edgeToEdge && (\n        <Pagination\n          page={page}\n          onPageChange={page => {\n            setPage(page);\n            onPageChange?.(page);\n          }}\n          numPages={pagesWithTiles.length}\n        />\n      )}\n      {pageList.length === 0 ? (\n        <WaitingView\n          title=\"You're the first to join\"\n          subtitle=\"Sit back and relax till others join\"\n          icon={<PeopleAddIcon width=\"56px\" height=\"56px\" style={{ color: 'white' }} />}\n        />\n      ) : null}\n      {isInsetEnabled && <InsetTile />}\n    </Flex>\n  );\n}\n", "import React from 'react';\nimport { Box, Flex } from '../../Layout';\nimport { Text } from '../../Text';\n\nexport const WaitingView = React.memo(\n  ({ icon, title, subtitle }: { icon: React.ReactNode; title: string; subtitle: string }) => {\n    return (\n      <Flex\n        align=\"center\"\n        direction=\"column\"\n        css={{\n          textAlign: 'center',\n          margin: 'auto',\n          h: '100%',\n          justifyContent: 'center',\n          gap: '$8',\n        }}\n      >\n        <Box\n          css={{\n            backgroundColor: '$surface_default',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '$4',\n            size: '$20',\n            r: '$round',\n            justifyContent: 'center',\n          }}\n        >\n          {icon}\n        </Box>\n        <Flex\n          direction=\"column\"\n          css={{\n            p: '$1',\n            gap: '$4',\n          }}\n        >\n          <Text variant=\"h4\" css={{ '@md': { fontSize: '$md', color: '$on_surface_high' } }}>\n            {title}\n          </Text>\n          <Text\n            variant=\"body1\"\n            css={{ fontWeight: '$regular', color: '$on_surface_medium', '@md': { fontSize: '$sm' } }}\n          >\n            {subtitle}\n          </Text>\n        </Flex>\n      </Flex>\n    );\n  },\n);\n", "import React, { useEffect, useRef } from 'react';\nimport Draggable from 'react-draggable';\nimport { useMedia } from 'react-use';\nimport {\n  selectIsAllowedToPublish,\n  selectLocalPeer,\n  selectPeerByID,\n  selectVideoTrackByID,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { ExpandIcon } from '@100mslive/react-icons';\nimport { Box, Flex } from '../../Layout';\nimport { Text } from '../../Text';\nimport { config as cssConfig } from '../../Theme';\n// @ts-ignore: No implicit Any\nimport IconButton from '../IconButton';\n// @ts-ignore: No implicit Any\nimport { AudioVideoToggle } from './AudioVideoToggle';\n// @ts-ignore: No implicit Any\nimport VideoTile from './VideoTile';\n// @ts-ignore: No implicit Any\nimport { useSetAppDataByKey } from './AppData/useUISettings';\nimport { useVideoTileContext } from './hooks/useVideoTileLayout';\n// @ts-ignore: No implicit Any\nimport { APP_DATA } from '../common/constants';\n\nconst MinimisedTile = ({ setMinimised }: { setMinimised: (value: boolean) => void }) => {\n  return (\n    <Flex align=\"center\" css={{ gap: '$6', r: '$1', bg: '$surface_default', p: '$4', color: '$on_surface_high' }}>\n      <AudioVideoToggle hideOptions={true} />\n      <Text>You</Text>\n      <IconButton\n        className=\"__cancel-drag-event\"\n        onClick={() => setMinimised(false)}\n        css={{ bg: 'transparent', border: 'transparent' }}\n      >\n        <ExpandIcon />\n      </IconButton>\n    </Flex>\n  );\n};\n\nconst insetHeightPx = 180;\nconst insetMaxWidthPx = 240;\nconst defaultMobileAspectRatio = 9 / 16;\nconst desktopAspectRatio = 1 / defaultMobileAspectRatio;\n\nexport const InsetTile = ({ peerId }: { peerId?: string }) => {\n  const isMobile = useMedia(cssConfig.media.md);\n  const isLandscape = useMedia(cssConfig.media.ls);\n  const selector = peerId ? selectPeerByID(peerId) : selectLocalPeer;\n  const peer = useHMSStore(selector);\n  const [minimised, setMinimised] = useSetAppDataByKey(APP_DATA.minimiseInset);\n  const videoTrack = useHMSStore(selectVideoTrackByID(peer?.videoTrack));\n  const isAllowedToPublish = useHMSStore(selectIsAllowedToPublish);\n  const videoTileProps = useVideoTileContext();\n  let aspectRatio = isMobile ? defaultMobileAspectRatio : desktopAspectRatio;\n  if (videoTrack?.width && videoTrack?.height && !isMobile) {\n    aspectRatio = videoTrack.width / videoTrack.height;\n  }\n  let height = insetHeightPx;\n  let width = height * aspectRatio;\n  // Convert to 16/9 in landscape mode with a max width of 240\n  if (isLandscape && width > insetMaxWidthPx) {\n    width = 240;\n    height = width / aspectRatio;\n  }\n\n  const nodeRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const node = nodeRef.current;\n    if (!node || !window.ResizeObserver) {\n      return;\n    }\n    const resizeObserver = new ResizeObserver(entries => {\n      entries.forEach(entry => {\n        if (entry.target === node.parentElement) {\n          // reset to original position on resize\n          node.style.transform = `translate(0,0)`;\n        }\n      });\n    });\n    node.parentElement && resizeObserver.observe(node.parentElement);\n    return () => {\n      node?.parentElement && resizeObserver?.unobserve(node.parentElement);\n      resizeObserver?.disconnect();\n    };\n  }, []);\n\n  if (!isAllowedToPublish.video && !isAllowedToPublish.audio) {\n    return null;\n  }\n\n  return (\n    <Draggable bounds=\"parent\" nodeRef={nodeRef} cancel=\".__cancel-drag-event\">\n      <Box\n        ref={nodeRef}\n        css={{\n          position: 'absolute',\n          bottom: 0,\n          right: 0,\n          zIndex: 10,\n          boxShadow: '0 0 8px 0 rgba(0,0,0,0.3)',\n          r: '$2',\n          ...(!minimised\n            ? {\n                aspectRatio: aspectRatio,\n                h: height,\n              }\n            : {}),\n        }}\n      >\n        {minimised ? (\n          <MinimisedTile setMinimised={setMinimised} />\n        ) : (\n          <VideoTile\n            peerId={peer?.id}\n            trackId={peer?.videoTrack}\n            rootCSS={{\n              size: '100%',\n              padding: 0,\n            }}\n            width={width}\n            height={height}\n            containerCSS={{ background: '$surface_default' }}\n            canMinimise\n            isDragabble\n            {...videoTileProps}\n            hideParticipantNameOnTile\n          />\n        )}\n      </Box>\n    </Draggable>\n  );\n};\n", "import React, { useContext } from 'react';\n\ntype TileContextType = {\n  enableSpotlightingPeer: boolean;\n  hideParticipantNameOnTile?: boolean;\n  roundedVideoTile?: boolean;\n  hideAudioMuteOnTile?: boolean;\n  hideAudioLevelOnTile?: boolean;\n  objectFit?: 'cover' | 'contain';\n  hideMetadataOnTile?: boolean;\n};\n\nexport const VideoTileContext = React.createContext<TileContextType>({\n  enableSpotlightingPeer: true,\n  hideParticipantNameOnTile: false,\n  roundedVideoTile: true,\n  hideAudioMuteOnTile: false,\n  hideAudioLevelOnTile: false,\n  objectFit: 'contain',\n  hideMetadataOnTile: false,\n});\n\nexport const useVideoTileContext = () => {\n  const context = useContext(VideoTileContext);\n  return context;\n};\n", "import React, { useEffect } from 'react';\nimport { ChevronLeftIcon, ChevronRightIcon } from '@100mslive/react-icons';\nimport { StyledPagination } from '../../Pagination';\n\nexport const Pagination = ({\n  page,\n  onPageChange,\n  numPages,\n}: {\n  page: number;\n  onPageChange: (page: number) => void;\n  numPages: number;\n}) => {\n  const disableLeft = page === 0;\n  const disableRight = page === numPages - 1;\n  const nextPage = (e: React.SyntheticEvent) => {\n    e.stopPropagation();\n    onPageChange(Math.min(page + 1, numPages - 1));\n  };\n  const prevPage = (e: React.SyntheticEvent) => {\n    e.stopPropagation();\n    onPageChange(Math.max(page - 1, 0));\n  };\n\n  useEffect(() => {\n    // currentPageIndex should not exceed pages length\n    if (page >= numPages) {\n      onPageChange(Math.max(0, numPages - 1));\n    }\n  }, [numPages, onPageChange, page]);\n\n  if (numPages <= 1) {\n    return null;\n  }\n\n  return (\n    <StyledPagination.Root css={{ flexShrink: 0 }}>\n      <StyledPagination.Chevron disabled={disableLeft} onClick={prevPage}>\n        <ChevronLeftIcon width={16} height={16} style={{ cursor: disableLeft ? 'not-allowed' : 'pointer' }} />\n      </StyledPagination.Chevron>\n      {numPages <= 5 ? (\n        <StyledPagination.Dots>\n          {[...Array(numPages)].map((_, i) => (\n            <StyledPagination.Dot\n              key={i}\n              active={page === i}\n              onClick={e => {\n                e.stopPropagation();\n                onPageChange(i);\n              }}\n            />\n          ))}\n        </StyledPagination.Dots>\n      ) : null}\n      <StyledPagination.Chevron disabled={disableRight} onClick={nextPage}>\n        <ChevronRightIcon width={16} height={16} style={{ cursor: disableRight ? 'not-allowed' : 'pointer' }} />\n      </StyledPagination.Chevron>\n    </StyledPagination.Root>\n  );\n};\n", "import React from 'react';\nimport { TrackWithPeerAndDimensions } from '@100mslive/react-sdk';\nimport { Box } from '../../../Layout';\n// @ts-ignore: No implicit Any\nimport VideoTile from '../VideoTile';\nimport { useVideoTileContext } from '../hooks/useVideoTileLayout';\n\nexport const Grid = React.forwardRef<HTMLDivElement, { tiles: TrackWithPeerAndDimensions[]; edgeToEdge?: boolean }>(\n  ({ tiles, edgeToEdge }, ref) => {\n    const videoTileProps = useVideoTileContext();\n    return (\n      <Box\n        ref={ref}\n        css={{\n          flex: '1 1 0',\n          gap: '$4',\n          display: 'flex',\n          placeContent: 'center',\n          alignItems: 'center',\n          justifyContent: 'center',\n          flexFlow: 'row wrap',\n          minHeight: 0,\n          '@md': { gap: edgeToEdge ? 0 : '$4' },\n        }}\n      >\n        {tiles?.map(tile => {\n          return (\n            <VideoTile\n              key={tile.track?.id || tile.peer?.id}\n              width={tile.width}\n              height={tile.height}\n              peerId={tile.peer?.id}\n              trackId={tile.track?.id}\n              rootCSS={{ padding: 0 }}\n              objectFit=\"contain\"\n              {...videoTileProps}\n            />\n          );\n        })}\n      </Box>\n    );\n  },\n);\n", "import { useEffect, useMemo, useState } from 'react';\nimport { useMeasure, useMedia } from 'react-use';\nimport {\n  getPeersWithTiles,\n  HMSPeer,\n  selectTracksMap,\n  TrackWithPeerAndDimensions,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\nimport { config as cssConfig } from '../../../Theme';\n\nconst aspectRatioConfig = { default: [1 / 1, 4 / 3, 16 / 9], mobile: [1 / 1, 3 / 4, 9 / 16] };\n\nexport const usePagesWithTiles = ({ peers, maxTileCount }: { peers: HMSPeer[]; maxTileCount: number }) => {\n  const vanillaStore = useHMSVanillaStore();\n  const tracksMap = vanillaStore.getState(selectTracksMap);\n  const peersWithTiles = useMemo(\n    () => getPeersWithTiles(peers, tracksMap, () => false) as TrackWithPeerAndDimensions[],\n    [peers, tracksMap],\n  );\n  const noOfPages = Math.ceil(peersWithTiles.length / maxTileCount);\n  const pagesList = useMemo(() => {\n    let sliceStart = 0;\n    let remaining = peersWithTiles.length;\n    const list = [];\n    // split into pages\n    for (let i = 0; i < noOfPages; i++) {\n      const count = Math.min(remaining, maxTileCount);\n      list.push(peersWithTiles.slice(sliceStart, sliceStart + count));\n      remaining = remaining - count;\n      sliceStart += count;\n    }\n    return list;\n  }, [peersWithTiles, noOfPages, maxTileCount]);\n  return pagesList;\n};\n\nexport const useTileLayout = ({\n  pageList,\n  maxTileCount,\n  edgeToEdge = false,\n}: {\n  pageList: TrackWithPeerAndDimensions[][];\n  maxTileCount: number;\n  edgeToEdge?: boolean;\n}) => {\n  const vanillaStore = useHMSVanillaStore();\n  const [ref, { width, height }] = useMeasure<HTMLDivElement>();\n  const isMobile = useMedia(cssConfig.media.lg);\n  const [pagesWithTiles, setPagesWithTiles] = useState<TrackWithPeerAndDimensions[][]>([]);\n\n  useEffect(() => {\n    if (width === 0 || height === 0) {\n      return;\n    }\n    // calculate dimesions for each page\n    for (const page of pageList) {\n      const noOfTilesInPage = page.length;\n      let maxCols =\n        noOfTilesInPage > 2 && noOfTilesInPage < 9\n          ? Math.ceil(noOfTilesInPage / 2)\n          : Math.ceil(Math.sqrt(noOfTilesInPage));\n      if (isMobile) {\n        maxCols = noOfTilesInPage < 4 ? 1 : Math.min(maxCols, 2);\n      }\n      const maxRows = Math.ceil(noOfTilesInPage / maxCols);\n      let index = 0;\n      // convert the current page to a matrix(grid)\n      const matrix = new Array(maxRows).fill(null).map((_, i) => {\n        const numCols = Math.min(maxCols, noOfTilesInPage - i * maxCols);\n        const rowElements = [];\n        for (let j = 0; j < numCols; j++) {\n          if (index < page.length) {\n            rowElements.push(page[index++]);\n          }\n        }\n        return rowElements;\n      });\n\n      const gap = edgeToEdge && isMobile ? 0 : 8; // gap between flex items\n      const maxHeight = height - (maxRows - 1) * gap;\n      const maxRowHeight = maxHeight / matrix.length;\n      const aspectRatios =\n        isMobile && (noOfTilesInPage === 1 || noOfTilesInPage > 3)\n          ? aspectRatioConfig.mobile\n          : aspectRatioConfig.default;\n      // calculate height and width of each tile in a row\n      for (const row of matrix) {\n        let tileWidth = (width - (row.length - 1) * gap) / row.length;\n        let tileHeight = 0;\n        if (edgeToEdge) {\n          tileHeight = maxRowHeight;\n        } else {\n          const calcHeights = aspectRatios.map(aR => tileWidth / aR);\n          for (const h of calcHeights) {\n            if (h < maxRowHeight) {\n              if (tileHeight < h) {\n                tileHeight = h;\n              }\n            }\n          }\n\n          // tileHeight is not calculated as it could be exceeding the max possible height\n          // find the max possible width instead\n          if (tileHeight === 0) {\n            tileHeight = maxRowHeight;\n            const calcWidths = aspectRatios.map(aR => tileHeight * aR);\n            tileWidth = 0;\n            for (const w of calcWidths) {\n              if (w < width) {\n                if (tileWidth < w) {\n                  tileWidth = w;\n                }\n              }\n            }\n          }\n        }\n        for (let i = 0; i < row.length; i++) {\n          row[i].width = tileWidth;\n          row[i].height = tileHeight;\n        }\n      }\n    }\n    setPagesWithTiles([...pageList]);\n  }, [width, height, maxTileCount, pageList, vanillaStore, isMobile, edgeToEdge]);\n  return { pagesWithTiles, ref };\n};\n", "import React, { useEffect, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { selectLocalPeer, useHMSStore } from '@100mslive/react-sdk';\nimport { config as cssConfig } from '../../../Theme';\nimport { InsetTile } from '../InsetTile';\nimport { Pagination } from '../Pagination';\nimport { SecondaryTiles } from '../SecondaryTiles';\nimport { Grid } from './Grid';\nimport { LayoutProps } from './interface';\nimport { ProminenceLayout } from './ProminenceLayout';\n// @ts-ignore: No implicit Any\nimport { useUISettings } from '../AppData/useUISettings';\nimport { useRoleProminencePeers } from '../hooks/useRoleProminencePeers';\nimport { usePagesWithTiles, useTileLayout } from '../hooks/useTileLayout';\nimport { UI_SETTINGS } from '../../common/constants';\n\nexport function RoleProminence({\n  isInsetEnabled = false,\n  prominentRoles = [],\n  peers,\n  onPageChange,\n  onPageSize,\n  edgeToEdge,\n}: LayoutProps) {\n  const { prominentPeers, secondaryPeers } = useRoleProminencePeers(prominentRoles, peers, isInsetEnabled);\n  const localPeer = useHMSStore(selectLocalPeer);\n  const isMobile = useMedia(cssConfig.media.md);\n  let maxTileCount = useUISettings(UI_SETTINGS.maxTileCount);\n  maxTileCount = isMobile ? 4 : maxTileCount;\n  const pageList = usePagesWithTiles({\n    peers: prominentPeers,\n    maxTileCount,\n  });\n  const { ref, pagesWithTiles } = useTileLayout({\n    pageList,\n    maxTileCount,\n  });\n  const [page, setPage] = useState(0);\n  const pageSize = pagesWithTiles[0]?.length || 0;\n\n  useEffect(() => {\n    if (pageSize > 0) {\n      onPageSize?.(pageSize);\n    }\n  }, [pageSize, onPageSize]);\n\n  return (\n    <ProminenceLayout.Root>\n      <ProminenceLayout.ProminentSection>\n        <Grid ref={ref} tiles={pagesWithTiles[page]} />\n      </ProminenceLayout.ProminentSection>\n      {!edgeToEdge && (\n        <Pagination\n          page={page}\n          onPageChange={page => {\n            setPage(page);\n            onPageChange?.(page);\n          }}\n          numPages={pagesWithTiles.length}\n        />\n      )}\n      <SecondaryTiles peers={secondaryPeers} isInsetEnabled={isInsetEnabled} edgeToEdge={edgeToEdge} />\n      {isInsetEnabled && localPeer && prominentPeers.length > 0 && !prominentPeers.includes(localPeer) && <InsetTile />}\n    </ProminenceLayout.Root>\n  );\n}\n", "import React, { useEffect, useRef, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { selectAppData, selectSessionStore, selectTrackByID, useHMSStore } from '@100mslive/react-sdk';\nimport { LayoutProps } from './VideoLayouts/interface';\nimport { ProminenceLayout } from './VideoLayouts/ProminenceLayout';\nimport { config as cssConfig } from '../../Theme';\nimport { Pagination } from './Pagination';\nimport { usePagesWithTiles } from './hooks/useTileLayout';\nimport { APP_DATA, SESSION_STORE_KEY } from '../common/constants';\n\nexport const SecondaryTiles = ({ peers, onPageChange, onPageSize, edgeToEdge, hasSidebar }: LayoutProps) => {\n  const isMobile = useMedia(cssConfig.media.md);\n  const maxTileCount = isMobile ? 2 : 4;\n  const [page, setPage] = useState(0);\n  const pinnedTrackId = useHMSStore(selectAppData(APP_DATA.pinnedTrackId));\n  const spotlightPeerId = useHMSStore(selectSessionStore(SESSION_STORE_KEY.SPOTLIGHT));\n  const activeScreensharePeerId = useHMSStore(selectAppData(APP_DATA.activeScreensharePeerId));\n  const pinnedPeer = useHMSStore(selectTrackByID(pinnedTrackId))?.peerId;\n  const pageChangedAfterPinning = useRef(false);\n  const pagesWithTiles = usePagesWithTiles({\n    peers:\n      spotlightPeerId || pinnedPeer\n        ? [...peers].sort((p1, p2) => {\n            if (activeScreensharePeerId === p1.id) {\n              return -1;\n            }\n            if (activeScreensharePeerId === p2.id) {\n              return 1;\n            }\n            const peerIdList = [pinnedPeer, spotlightPeerId];\n            // put active screenshare peer, pinned peer, spotlight peer at first\n            if (peerIdList.includes(p1.id)) {\n              return -1;\n            }\n            if (peerIdList.includes(p2.id)) {\n              return 1;\n            }\n            return 0;\n          })\n        : peers,\n    maxTileCount,\n  });\n  const pageSize = pagesWithTiles[0]?.length || 0;\n\n  // Handles final peer leaving from the last page\n  useEffect(() => {\n    if (peers.length > 0 && !pagesWithTiles[page]?.length) {\n      setPage(Math.max(0, page - 1));\n    }\n  }, [peers, page, pagesWithTiles]);\n\n  useEffect(() => {\n    if (pageSize > 0) {\n      onPageSize?.(pageSize);\n    }\n  }, [pageSize, onPageSize]);\n\n  useEffect(() => {\n    if ((pinnedPeer || spotlightPeerId) && page !== 0 && !pageChangedAfterPinning.current) {\n      setPage(0);\n      pageChangedAfterPinning.current = true;\n    } else if (!pinnedPeer && !spotlightPeerId) {\n      pageChangedAfterPinning.current = false;\n    }\n  }, [pinnedPeer, spotlightPeerId, page]);\n\n  return (\n    <ProminenceLayout.SecondarySection tiles={pagesWithTiles[page]} edgeToEdge={edgeToEdge} hasSidebar={hasSidebar}>\n      {!edgeToEdge && (\n        <Pagination\n          page={page}\n          onPageChange={page => {\n            setPage(page);\n            onPageChange?.(page);\n          }}\n          numPages={pagesWithTiles.length}\n        />\n      )}\n    </ProminenceLayout.SecondarySection>\n  );\n};\n", "import React from 'react';\nimport { TrackWithPeerAndDimensions } from '@100mslive/react-sdk';\nimport { Box, Flex } from '../../../Layout';\nimport { CSS } from '../../../Theme';\n// @ts-ignore: No implicit Any\nimport VideoTile from '../VideoTile';\nimport { useVideoTileContext } from '../hooks/useVideoTileLayout';\n\nconst Root = ({\n  children,\n  edgeToEdge,\n  hasSidebar,\n}: React.PropsWithChildren<{ edgeToEdge?: boolean; hasSidebar?: boolean }>) => {\n  return (\n    <Flex\n      direction={hasSidebar ? 'row' : 'column'}\n      css={{ h: '100%', flex: '1 1 0', minWidth: 0, gap: '$6', '@md': { gap: edgeToEdge ? 0 : '$6' } }}\n    >\n      {children}\n    </Flex>\n  );\n};\n\nconst ProminentSection = ({ children, css = {} }: React.PropsWithChildren<{ css?: CSS }>) => {\n  return (\n    <Flex direction=\"column\" css={{ flex: '1 1 0', gap: '$2', minHeight: 0, ...css }}>\n      {children}\n    </Flex>\n  );\n};\n\nconst SecondarySection = ({\n  tiles,\n  children,\n  edgeToEdge,\n  hasSidebar,\n}: React.PropsWithChildren<{ tiles: TrackWithPeerAndDimensions[]; edgeToEdge?: boolean; hasSidebar?: boolean }>) => {\n  const tileLayoutProps = useVideoTileContext();\n  if (!tiles?.length) {\n    return null;\n  }\n  const gridStyles = hasSidebar\n    ? {\n        gridTemplateColumns: '1fr',\n        gridTemplateRows: `repeat(${tiles.length}, minmax(0, 1fr))`,\n        maxHeight: '100%',\n        width: 240,\n      }\n    : {\n        gridTemplateRows: React.Children.count(children) > 0 ? '136px auto' : '154px',\n        gridTemplateColumns: `repeat(${tiles.length}, minmax(0, 1fr))`,\n      };\n  return (\n    <Box\n      css={{\n        display: 'grid',\n        margin: 'auto',\n        gap: hasSidebar ? '$8' : '$2 $4',\n        placeItems: 'center',\n        ...gridStyles,\n        '@md': { gap: edgeToEdge ? 0 : '$4' },\n      }}\n    >\n      {tiles.map(tile => {\n        return (\n          <VideoTile\n            key={tile.track?.id || tile.peer?.id}\n            peerId={tile.peer?.id}\n            trackId={tile.track?.id}\n            rootCSS={{\n              padding: 0,\n              maxWidth: 240,\n              aspectRatio: 16 / 9,\n              ...(hasSidebar ? { w: '100%' } : { h: '100%' }),\n              '@md': { aspectRatio: 1 },\n            }}\n            objectFit=\"contain\"\n            {...tileLayoutProps}\n          />\n        );\n      })}\n      {children && <Box css={{ gridColumn: hasSidebar ? 1 : `1/span ${tiles.length}` }}>{children}</Box>}\n    </Box>\n  );\n};\n\nexport const ProminenceLayout = {\n  Root,\n  ProminentSection,\n  SecondarySection,\n};\n", "import { useMemo } from 'react';\nimport { HMSPeer } from '@100mslive/react-sdk';\n// @ts-ignore: No implicit Any\nimport { usePinnedTrack } from '../AppData/useUISettings';\n\nexport const useRoleProminencePeers = (prominentRoles: string[], peers: HMSPeer[], isInsetEnabled: boolean) => {\n  const pinnedTrack = usePinnedTrack();\n\n  const [prominentPeers, secondaryPeers] = useMemo(() => {\n    return peers.reduce<[HMSPeer[], HMSPeer[]]>(\n      (acc, peer) => {\n        if (pinnedTrack) {\n          if (pinnedTrack.peerId === peer.id) {\n            acc[0].push(peer);\n          } else if (!(isInsetEnabled && peer.isLocal)) {\n            acc[1].push(peer);\n          }\n          return acc;\n        }\n        if (peer.isLocal && isInsetEnabled && !prominentRoles?.includes(peer.roleName || '')) {\n          return acc;\n        }\n        if (prominentRoles?.includes(peer.roleName || '')) {\n          acc[0].push(peer);\n        } else {\n          acc[1].push(peer);\n        }\n\n        return acc;\n      },\n      [[], []],\n    );\n  }, [peers, isInsetEnabled, prominentRoles, pinnedTrack]);\n\n  return {\n    prominentPeers,\n    secondaryPeers,\n  };\n};\n", "import React, { useEffect, useMemo, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { selectPeersScreenSharing, useHMSStore } from '@100mslive/react-sdk';\nimport { config as cssConfig } from '../../../Theme';\nimport { InsetTile } from '../InsetTile';\nimport { Pagination } from '../Pagination';\n// @ts-ignore: No implicit Any\nimport ScreenshareTile from '../ScreenshareTile';\nimport { SecondaryTiles } from '../SecondaryTiles';\nimport { LayoutMode } from '../Settings/LayoutSettings';\nimport { LayoutProps } from './interface';\nimport { ProminenceLayout } from './ProminenceLayout';\n// @ts-ignore: No implicit Any\nimport { useSetAppDataByKey, useSetUiSettings } from '../AppData/useUISettings';\nimport { APP_DATA, UI_SETTINGS } from '../../common/constants';\n\nexport const ScreenshareLayout = ({ peers, onPageChange, onPageSize, edgeToEdge }: LayoutProps) => {\n  const peersSharing = useHMSStore(selectPeersScreenSharing);\n  const [, setActiveScreenSharePeer] = useSetAppDataByKey(APP_DATA.activeScreensharePeerId);\n  const [page, setPage] = useState(0);\n  const [layoutMode, setLayoutMode] = useSetUiSettings(UI_SETTINGS.layoutMode);\n  const activeSharePeer = peersSharing[page];\n  const isMobile = useMedia(cssConfig.media.md);\n  const hasSidebar = !isMobile && layoutMode === LayoutMode.SIDEBAR;\n  const secondaryPeers = useMemo(() => {\n    if (layoutMode === LayoutMode.SPOTLIGHT) {\n      return [];\n    }\n    if (isMobile || layoutMode === LayoutMode.SIDEBAR) {\n      return activeSharePeer\n        ? [activeSharePeer, ...peers.filter(p => p.id !== activeSharePeer?.id)] //keep active sharing peer as first tile\n        : peers;\n    }\n    return peers.filter(p => p.id !== activeSharePeer?.id);\n  }, [activeSharePeer, peers, isMobile, layoutMode]);\n\n  useEffect(() => {\n    if (isMobile) {\n      setLayoutMode(LayoutMode.GALLERY);\n      return;\n    }\n    if (layoutMode === LayoutMode.SIDEBAR) {\n      return;\n    }\n    setLayoutMode(LayoutMode.SIDEBAR);\n    return () => {\n      // reset to gallery once screenshare is stopped\n      setLayoutMode(LayoutMode.GALLERY);\n    };\n  }, [isMobile]); // eslint-disable-line react-hooks/exhaustive-deps\n  useEffect(() => {\n    setActiveScreenSharePeer(activeSharePeer?.id);\n    return () => {\n      setActiveScreenSharePeer('');\n    };\n  }, [activeSharePeer?.id, setActiveScreenSharePeer]);\n\n  return (\n    <ProminenceLayout.Root edgeToEdge={edgeToEdge} hasSidebar={hasSidebar}>\n      <ProminenceLayout.ProminentSection>\n        <ScreenshareTile peerId={peersSharing[page]?.id} />\n        {!edgeToEdge && <Pagination page={page} onPageChange={setPage} numPages={peersSharing.length} />}\n      </ProminenceLayout.ProminentSection>\n      <SecondaryTiles\n        peers={secondaryPeers}\n        onPageChange={onPageChange}\n        onPageSize={onPageSize}\n        edgeToEdge={edgeToEdge}\n        hasSidebar={hasSidebar}\n      />\n      {layoutMode === LayoutMode.SPOTLIGHT && activeSharePeer && <InsetTile peerId={activeSharePeer?.id} />}\n    </ProminenceLayout.Root>\n  );\n};\n", "import React, { useRef, useState } from 'react';\nimport { useFullscreen, useMedia } from 'react-use';\nimport screenfull from 'screenfull';\nimport {\n  selectLocalPeerID,\n  selectPeerByID,\n  selectScreenShareAudioByPeerID,\n  selectScreenShareByPeerID,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { ExpandIcon, ShrinkIcon } from '@100mslive/react-icons';\nimport TileMenu from './TileMenu/TileMenu';\nimport { Box } from '../../Layout';\nimport { VideoTileStats } from '../../Stats';\nimport { config as cssConfig, useTheme } from '../../Theme';\nimport { Video } from '../../Video';\nimport { StyledVideoTile } from '../../VideoTile';\nimport { LayoutModeSelector } from './LayoutModeSelector';\n// @ts-ignore: No implicit Any\nimport { getVideoTileLabel } from './peerTileUtils';\nimport { ScreenshareDisplay } from './ScreenshareDisplay';\n// @ts-ignore: No implicit Any\nimport { useUISettings } from './AppData/useUISettings';\nimport { UI_SETTINGS } from '../common/constants';\n\nconst labelStyles = {\n  position: 'unset',\n  width: '100%',\n  textAlign: 'center',\n  c: '$on_surface_high',\n  transform: 'none',\n  flexShrink: 0,\n};\n\nconst Tile = ({ peerId, width = '100%', height = '100%' }: { peerId: string; width?: string; height?: string }) => {\n  const isLocal = useHMSStore(selectLocalPeerID) === peerId;\n  const track = useHMSStore(selectScreenShareByPeerID(peerId));\n  const { theme } = useTheme();\n  const peer = useHMSStore(selectPeerByID(peerId));\n  const isAudioOnly = useUISettings(UI_SETTINGS.isAudioOnly);\n  const [isMouseHovered, setIsMouseHovered] = useState(false);\n  const isMobile = useMedia(cssConfig.media.md);\n  const showStatsOnTiles = useUISettings(UI_SETTINGS.showStatsOnTiles);\n  const fullscreenRef = useRef<HTMLDivElement | null>(null);\n  // fullscreen is for desired state\n  const [fullscreen, setFullscreen] = useState(false);\n  // isFullscreen is for true state\n  const isFullscreen = useFullscreen(fullscreenRef, fullscreen, {\n    onClose: () => setFullscreen(false),\n  });\n  const isFullScreenSupported = screenfull.isEnabled;\n  const audioTrack = useHMSStore(selectScreenShareAudioByPeerID(peer?.id));\n\n  if (isLocal && track?.displaySurface && !['browser', 'window', 'application'].includes(track.displaySurface)) {\n    return <ScreenshareDisplay />;\n  }\n\n  if (!peer) {\n    return null;\n  }\n\n  const label = getVideoTileLabel({\n    peerName: peer?.name,\n    isLocal: false,\n    track,\n  });\n\n  return (\n    <StyledVideoTile.Root\n      css={{\n        width,\n        height,\n        p: 0,\n        minHeight: 0,\n      }}\n      data-testid=\"screenshare_tile\"\n    >\n      <StyledVideoTile.Container\n        transparentBg\n        ref={fullscreenRef}\n        css={{ flexDirection: 'column', gap: '$2' }}\n        onMouseEnter={() => setIsMouseHovered(true)}\n        onMouseLeave={() => {\n          setIsMouseHovered(false);\n        }}\n      >\n        {showStatsOnTiles ? (\n          <VideoTileStats audioTrackID={audioTrack?.id} videoTrackID={track?.id} peerID={peerId} isLocal={isLocal} />\n        ) : null}\n        {isFullScreenSupported && isMouseHovered ? (\n          <StyledVideoTile.FullScreenButton\n            css={{ bg: `${theme.colors.background_dim.value}A3` }}\n            onClick={() => setFullscreen(!fullscreen)}\n          >\n            {isFullscreen ? <ShrinkIcon /> : <ExpandIcon />}\n          </StyledVideoTile.FullScreenButton>\n        ) : null}\n        {!isMobile && isMouseHovered && !isFullscreen && (\n          <Box\n            css={{\n              position: 'absolute',\n              top: '$2',\n              r: '$1',\n              h: '$14',\n              right: isFullScreenSupported ? '$17' : '$2',\n              zIndex: 5,\n              bg: `${theme.colors.background_dim.value}A3`,\n            }}\n          >\n            <LayoutModeSelector />\n          </Box>\n        )}\n\n        {track ? (\n          <Video screenShare={true} mirror={false} attach={!isAudioOnly} trackId={track.id} css={{ minHeight: 0 }} />\n        ) : null}\n        <StyledVideoTile.Info css={labelStyles}>{label}</StyledVideoTile.Info>\n        {isMouseHovered && !peer.isLocal ? (\n          <TileMenu\n            isScreenshare\n            peerID={peer.id}\n            audioTrackID={audioTrack?.id}\n            videoTrackID={track?.id}\n            enableSpotlightingPeer={false}\n          />\n        ) : null}\n      </StyledVideoTile.Container>\n    </StyledVideoTile.Root>\n  );\n};\n\nconst ScreenshareTile = React.memo(Tile);\n\nexport default ScreenshareTile;\n", "import React, { useCallback, useState } from 'react';\nimport { CheckIcon, ChevronDownIcon, ChevronUpIcon } from '@100mslive/react-icons';\nimport { LayoutMode, LayoutModeIconMapping, LayoutModeKeys } from './Settings/LayoutSettings';\nimport { Flex } from '../../Layout';\nimport { Popover } from '../../Popover';\nimport { Text } from '../../Text';\n// @ts-ignore: No implicit Any\nimport { useSetUiSettings } from '../components/AppData/useUISettings';\nimport { UI_SETTINGS } from '../common/constants';\n\nexport const LayoutModeSelector = () => {\n  const [open, setOpen] = useState(false);\n  const [layoutMode, setLayoutMode] = useSetUiSettings(UI_SETTINGS.layoutMode);\n  const updateLayoutMode = useCallback(\n    (value: string) => {\n      setLayoutMode(value);\n      setOpen(false);\n    },\n    [setLayoutMode, setOpen],\n  );\n  return (\n    <Popover.Root open={open} onOpenChange={setOpen}>\n      <Popover.Trigger asChild>\n        <Flex\n          align=\"center\"\n          css={{\n            gap: '$4',\n            color: open ? '$on_surface_low' : '$on_surface_medium',\n            r: '$1',\n            p: '$2 $4',\n            height: '100%',\n          }}\n        >\n          <Flex\n            align=\"center\"\n            justify=\"center\"\n            css={{\n              color: 'inherit',\n              '& > svg': {\n                w: '$9',\n                h: '$9',\n              },\n            }}\n          >\n            {LayoutModeIconMapping[layoutMode as LayoutModeKeys]}\n          </Flex>\n          <Text variant=\"caption\" css={{ color: 'inherit', lineHeight: '$sm' }}>\n            {layoutMode}\n          </Text>\n          {open ? <ChevronUpIcon width={16} height={16} /> : <ChevronDownIcon width={16} height={16} />}\n        </Flex>\n      </Popover.Trigger>\n      <Popover.Content\n        css={{\n          w: '10.75rem',\n          r: '$1',\n          py: '$4',\n          px: 0,\n          backgroundColor: '$surface_default',\n          overflowY: 'auto',\n          boxShadow: '0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)',\n          fontFamily: '$sans',\n          color: '$on_surface_high',\n        }}\n        side=\"bottom\"\n        sideOffset={8}\n        align=\"end\"\n      >\n        {Object.keys(LayoutMode).map(key => {\n          const value = LayoutMode[key as LayoutModeKeys];\n          return (\n            <Flex\n              key={key}\n              onClick={() => updateLayoutMode(value)}\n              align=\"center\"\n              css={{\n                gap: '$4',\n                borderBottom: '1px solid $border_bright',\n                p: '$8',\n                '&:hover': {\n                  cursor: 'pointer',\n                  bg: '$surface_bright',\n                },\n                '&:focus-visible': {\n                  bg: '$surface_bright',\n                },\n              }}\n            >\n              <Flex\n                align=\"center\"\n                justify=\"center\"\n                css={{\n                  color: '$on_surface_medium',\n                  '& > svg': {\n                    w: '$9',\n                    h: '$9',\n                  },\n                }}\n              >\n                {LayoutModeIconMapping[value]}\n              </Flex>\n              <Text variant=\"caption\" css={{ lineHeight: '$sm' }}>\n                {value}\n              </Text>\n              {value === layoutMode ? <CheckIcon width={20} height={20} style={{ marginLeft: 'auto' }} /> : null}\n            </Flex>\n          );\n        })}\n      </Popover.Content>\n    </Popover.Root>\n  );\n};\n", "import React from 'react';\nimport { useHMSActions } from '@100mslive/react-sdk';\nimport { CrossIcon, ShareScreenIcon } from '@100mslive/react-icons';\nimport { Button } from '../../Button';\nimport { Flex } from '../../Layout';\nimport { Text } from '../../Text';\n\nexport const ScreenshareDisplay = () => {\n  const hmsActions = useHMSActions();\n\n  return (\n    <Flex\n      direction=\"column\"\n      align=\"center\"\n      justify=\"center\"\n      css={{\n        size: '100%',\n        bg: '$background_default',\n        color: '$on_surface_high',\n      }}\n    >\n      <ShareScreenIcon width={48} height={48} />\n      <Text variant=\"h5\" css={{ m: '$8 0' }}>\n        You are sharing your screen\n      </Text>\n      <Button\n        variant=\"danger\"\n        css={{ fontWeight: '$semiBold' }}\n        onClick={async () => {\n          await hmsActions.setScreenShareEnabled(false);\n        }}\n        data-testid=\"stop_screen_share_btn\"\n      >\n        <CrossIcon width={18} height={18} />\n        &nbsp; Stop screen share\n      </Button>\n    </Flex>\n  );\n};\n", "import React, { useEffect, useMemo } from 'react';\nimport { useMedia } from 'react-use';\nimport { Whiteboard } from '@100mslive/hms-whiteboard';\nimport { selectPeerByCondition, selectWhiteboard, useHMSStore, useWhiteboard } from '@100mslive/react-sdk';\nimport { Box } from '../../../Layout';\nimport { config as cssConfig } from '../../../Theme';\nimport { InsetTile } from '../InsetTile';\nimport { SecondaryTiles } from '../SecondaryTiles';\nimport { LayoutMode } from '../Settings/LayoutSettings';\nimport { LayoutProps } from './interface';\nimport { ProminenceLayout } from './ProminenceLayout';\n// @ts-ignore: No implicit Any\nimport { useSetUiSettings } from '../AppData/useUISettings';\nimport { UI_SETTINGS } from '../../common/constants';\n// eslint-disable-next-line import/no-unresolved\nimport '@100mslive/hms-whiteboard/index.css';\n\nconst WhiteboardEmbed = () => {\n  const isMobile = useMedia(cssConfig.media.md);\n  const { token, endpoint, zoomToContent } = useWhiteboard(isMobile);\n\n  if (!token) {\n    return null;\n  }\n\n  return (\n    <Box\n      css={{\n        mx: '$8',\n        flex: '3 1 0',\n        '@lg': {\n          flex: '2 1 0',\n          display: 'flex',\n          alignItems: 'center',\n        },\n      }}\n    >\n      <Box css={{ size: '100%' }}>\n        <Whiteboard token={token} endpoint={`https://${endpoint}`} zoomToContent={zoomToContent} />\n      </Box>\n    </Box>\n  );\n};\n\nexport const WhiteboardLayout = ({ peers, onPageChange, onPageSize, edgeToEdge }: LayoutProps) => {\n  const whiteboard = useHMSStore(selectWhiteboard);\n  const whiteboardOwner = useHMSStore(selectPeerByCondition(peer => peer.customerUserId === whiteboard?.owner));\n  const [layoutMode, setLayoutMode] = useSetUiSettings(UI_SETTINGS.layoutMode);\n  const isMobile = useMedia(cssConfig.media.md);\n  const hasSidebar = !isMobile && layoutMode === LayoutMode.SIDEBAR;\n  const secondaryPeers = useMemo(() => {\n    if (layoutMode === LayoutMode.SPOTLIGHT) {\n      return [];\n    }\n    if (isMobile || layoutMode === LayoutMode.SIDEBAR) {\n      return whiteboardOwner\n        ? [whiteboardOwner, ...peers.filter(p => p.id !== whiteboardOwner?.id)] //keep active sharing peer as first tile\n        : peers;\n    }\n    return peers.filter(p => p.id !== whiteboardOwner?.id);\n  }, [whiteboardOwner, peers, isMobile, layoutMode]);\n\n  useEffect(() => {\n    if (isMobile) {\n      setLayoutMode(LayoutMode.GALLERY);\n      return;\n    }\n    if (layoutMode === LayoutMode.SIDEBAR) {\n      return;\n    }\n    setLayoutMode(LayoutMode.SIDEBAR);\n    return () => {\n      // reset to gallery once whiteboard is stopped\n      setLayoutMode(LayoutMode.GALLERY);\n    };\n  }, [isMobile]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  return (\n    <ProminenceLayout.Root edgeToEdge={edgeToEdge} hasSidebar={hasSidebar}>\n      <ProminenceLayout.ProminentSection>\n        <WhiteboardEmbed />\n      </ProminenceLayout.ProminentSection>\n      <SecondaryTiles\n        peers={secondaryPeers}\n        onPageChange={onPageChange}\n        onPageSize={onPageSize}\n        edgeToEdge={edgeToEdge}\n        hasSidebar={hasSidebar}\n      />\n      {layoutMode === LayoutMode.SPOTLIGHT && whiteboardOwner && <InsetTile peerId={whiteboardOwner?.id} />}\n    </ProminenceLayout.Root>\n  );\n};\n", "import { HMSPeer, HMSPeerID, IStoreReadOnly, selectDominantSpeaker } from '@100mslive/react-sdk';\n\nclass PeersSorter {\n  storeUnsubscribe: undefined | (() => void) = undefined;\n  store: IStoreReadOnly<any>;\n  peers: Map<string, HMSPeer>;\n  lruPeers: Set<HMSPeerID>;\n  tilesPerPage!: number;\n  speaker?: HMSPeer;\n  listeners: Set<(peers: HMSPeer[]) => void>;\n\n  constructor(store: IStoreReadOnly<any>) {\n    this.store = store;\n    this.peers = new Map();\n    this.lruPeers = new Set();\n    this.speaker = undefined;\n    this.listeners = new Set();\n  }\n\n  setPeersAndTilesPerPage = ({ peers, tilesPerPage }: { peers: HMSPeer[]; tilesPerPage: number }) => {\n    this.speaker = undefined;\n    this.tilesPerPage = tilesPerPage;\n    const peerIds = new Set(peers.map(peer => peer.id));\n    // remove existing peers which are no longer provided\n    this.peers.forEach((_, key) => {\n      if (!peerIds.has(key)) {\n        this.peers.delete(key);\n      }\n    });\n    this.lruPeers = new Set([...this.lruPeers].filter(peerId => peerIds.has(peerId)));\n    peers.forEach(peer => {\n      this.peers.set(peer.id, peer);\n      if (this.lruPeers.size < tilesPerPage) {\n        this.lruPeers.add(peer.id);\n      }\n    });\n    if (!this.storeUnsubscribe) {\n      this.storeUnsubscribe = this.store.subscribe(this.onDominantSpeakerChange, selectDominantSpeaker);\n    }\n    this.moveSpeakerToFront(this.speaker);\n  };\n\n  onUpdate = (cb: (peers: HMSPeer[]) => void) => {\n    this.listeners.add(cb);\n  };\n\n  stop = () => {\n    this.updateListeners();\n    this.listeners.clear();\n    this.storeUnsubscribe?.();\n    this.storeUnsubscribe = undefined;\n    this.speaker = undefined;\n  };\n\n  moveSpeakerToFront = (speaker?: HMSPeer) => {\n    if (!speaker) {\n      this.maintainLruSize(this.tilesPerPage);\n      this.updateListeners();\n      return;\n    }\n    if (this.lruPeers.has(speaker.id) && this.lruPeers.size <= this.tilesPerPage) {\n      this.updateListeners();\n      return;\n    }\n    // delete to insert at beginning\n    this.lruPeers.delete(speaker.id);\n    // - 1 as we are going to insert the new speaker\n    this.maintainLruSize(this.tilesPerPage - 1);\n    this.lruPeers = new Set([speaker.id, ...this.lruPeers]);\n    this.updateListeners();\n  };\n\n  onDominantSpeakerChange = (speaker: HMSPeer | null) => {\n    // no speaker or is current speaker do nothing\n    if (!speaker || speaker.id === this.speaker?.id) {\n      return;\n    }\n    // if the active speaker is not from the peers passed ignore\n    if (!this.peers.has(speaker.id)) {\n      return;\n    }\n    this.speaker = speaker;\n    this.moveSpeakerToFront(speaker);\n  };\n\n  updateListeners = () => {\n    const orderedPeers: HMSPeer[] = [];\n    this.lruPeers.forEach(key => {\n      const peer = this.peers.get(key);\n      if (peer) {\n        orderedPeers.push(peer);\n      }\n    });\n    this.peers.forEach(peer => {\n      if (!this.lruPeers.has(peer.id) && peer) {\n        orderedPeers.push(peer);\n      }\n    });\n    this.listeners.forEach(listener => listener?.(orderedPeers));\n  };\n\n  private maintainLruSize = (size: number) => {\n    const lruPeerArray = Array.from(this.lruPeers);\n    while (lruPeerArray.length > size && lruPeerArray.length) {\n      lruPeerArray.pop();\n    }\n    this.lruPeers = new Set(lruPeerArray);\n  };\n}\n\nexport default PeersSorter;\n", "import React, { useEffect, useMemo } from 'react';\nimport { selectAppData, selectPeers, selectPeerScreenSharing, useEmbedShare, useHMSStore } from '@100mslive/react-sdk';\nimport { SecondaryTiles } from '../components/SecondaryTiles';\nimport { ToastManager } from '../components/Toast/ToastManager';\nimport { ProminenceLayout } from '../components/VideoLayouts/ProminenceLayout';\nimport { Box } from '../../Layout';\nimport { useResetEmbedConfig, useSetAppDataByKey } from '../components/AppData/useUISettings';\nimport { APP_DATA } from '../common/constants';\n\nexport const EmbedView = () => {\n  return (\n    <EmbedScreenShareView>\n      <EmbedComponent />\n    </EmbedScreenShareView>\n  );\n};\n\nexport const EmbedScreenShareView = ({ children }) => {\n  const peers = useHMSStore(selectPeers);\n\n  const peerPresenting = useHMSStore(selectPeerScreenSharing);\n  const [, setActiveScreenSharePeer] = useSetAppDataByKey(APP_DATA.activeScreensharePeerId);\n\n  const smallTilePeers = useMemo(() => {\n    const smallTilePeers = peers.filter(peer => peer.id !== peerPresenting?.id);\n    return smallTilePeers;\n  }, [peers, peerPresenting]);\n\n  useEffect(() => {\n    setActiveScreenSharePeer(peerPresenting?.id);\n    return () => {\n      setActiveScreenSharePeer('');\n    };\n  }, [peerPresenting?.id, setActiveScreenSharePeer]);\n  return (\n    <ProminenceLayout.Root>\n      <ProminenceLayout.ProminentSection>{children}</ProminenceLayout.ProminentSection>\n      <SecondaryTiles peers={smallTilePeers} />\n    </ProminenceLayout.Root>\n  );\n};\n/**\n * EmbedView is responsible for rendering the iframe and managing the screen sharing functionality.\n */\nconst EmbedComponent = () => {\n  const embedConfig = useHMSStore(selectAppData(APP_DATA.embedConfig));\n  const resetConfig = useResetEmbedConfig();\n\n  // need to send resetConfig to clear configuration, if stop screenshare occurs.\n  const { iframeRef, startEmbedShare, isEmbedShareInProgress } = useEmbedShare(resetConfig);\n\n  useEffect(() => {\n    (async () => {\n      if (embedConfig && !isEmbedShareInProgress) {\n        try {\n          await startEmbedShare(embedConfig);\n        } catch (err) {\n          resetConfig();\n          ToastManager.addToast({\n            title: `Error while sharing embed url ${err.message || ''}`,\n            variant: 'error',\n          });\n        }\n      }\n    })();\n  }, [isEmbedShareInProgress, embedConfig, startEmbedShare, resetConfig]);\n\n  return (\n    <Box\n      css={{\n        mx: '$8',\n        flex: '3 1 0',\n        '@lg': {\n          flex: '2 1 0',\n          display: 'flex',\n          alignItems: 'center',\n        },\n      }}\n    >\n      <iframe\n        title=\"Embed View\"\n        ref={iframeRef}\n        style={{\n          width: '100%',\n          height: '100%',\n          border: 0,\n          borderRadius: '0.75rem',\n        }}\n        allow=\"autoplay; clipboard-write;\"\n        referrerPolicy=\"no-referrer\"\n      />\n    </Box>\n  );\n};\n", "import React, { useEffect } from 'react';\nimport { usePDFShare } from '@100mslive/react-sdk';\nimport { ToastManager } from '../components/Toast/ToastManager';\nimport { Box } from '../../Layout';\nimport { EmbedScreenShareView } from './EmbedView';\nimport { usePDFConfig, useResetPDFConfig } from '../components/AppData/useUISettings';\n\n/**\n * PDFView is responsible for rendering the PDF iframe and managing the screen sharing functionality.\n */\nexport const PDFView = () => {\n  const pdfConfig = usePDFConfig();\n  const resetConfig = useResetPDFConfig();\n  // need to send resetConfig to clear configuration, if stop screenshare occurs.\n  const { iframeRef, startPDFShare, isPDFShareInProgress } = usePDFShare(resetConfig);\n\n  useEffect(() => {\n    // no working in other useEffect, as return is called multiple time on state change\n    return () => {\n      resetConfig();\n    };\n  }, []);\n  useEffect(() => {\n    (async () => {\n      try {\n        if (!isPDFShareInProgress && pdfConfig) {\n          await startPDFShare(pdfConfig);\n        }\n      } catch (err) {\n        resetConfig();\n        ToastManager.addToast({\n          title: `Error while sharing annotator ${err.message || ''}`,\n          variant: 'error',\n        });\n      }\n    })();\n  }, [isPDFShareInProgress, pdfConfig, resetConfig, startPDFShare]);\n  return (\n    <EmbedScreenShareView>\n      <Box\n        css={{\n          mx: '$8',\n          flex: '3 1 0',\n          '@lg': {\n            flex: '2 1 0',\n            display: 'flex',\n            alignItems: 'center',\n          },\n        }}\n      >\n        <iframe\n          title=\"Embed View\"\n          ref={iframeRef}\n          style={{\n            width: '100%',\n            height: '100%',\n            border: 0,\n            borderRadius: '0.75rem',\n          }}\n          allow=\"autoplay; clipboard-write;\"\n          referrerPolicy=\"no-referrer\"\n        />\n      </Box>\n    </EmbedScreenShareView>\n  );\n};\n", "import React, { useEffect, useRef, useState } from 'react';\nimport Draggable, { ControlPosition } from 'react-draggable';\nimport { useMedia } from 'react-use';\nimport {\n  HMSTranscript,\n  selectIsTranscriptionEnabled,\n  selectPeerNameByID,\n  useHMSStore,\n  useTranscript,\n} from '@100mslive/react-sdk';\nimport { Box, Flex } from '../../Layout';\nimport { Text } from '../../Text';\nimport { config } from '../../Theme';\n// @ts-ignore: No implicit Any\nimport { useIsSidepaneTypeOpen } from '../components/AppData/useSidepane';\n// @ts-ignore: No implicit Any\nimport { useIsCaptionEnabled } from '../components/AppData/useUISettings';\nimport { useRoomLayoutConferencingScreen } from '../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { SIDE_PANE_OPTIONS } from '../common/constants';\ninterface CaptionQueueData extends HMSTranscript {\n  transcriptQueue: SimpleQueue;\n}\n\ninterface TranscriptData extends HMSTranscript {\n  timeout?: NodeJS.Timeout | undefined;\n}\nclass SimpleQueue {\n  private storage: TranscriptData[] = [];\n  constructor(private capacity: number = 3, private MAX_STORAGE_TIME: number = 5000) {}\n  enqueue(data: TranscriptData): void {\n    if (!data.transcript.trim()) {\n      return;\n    }\n    if (this.size() === this.capacity && this.storage[this.size() - 1].final) {\n      this.dequeue(this.storage[this.size() - 1]);\n    }\n    if (this.size() === 0) {\n      this.storage.push(data);\n      this.addTimeout(this.storage[this.size() - 1], data.final);\n      return;\n    }\n    if (this.size() > 0 && this.storage[this.size() - 1]?.final === true) {\n      this.storage.push(data);\n      this.addTimeout(this.storage[this.size() - 1], data.final);\n      return;\n    }\n    this.storage[this.size() - 1].transcript = data.transcript;\n    this.storage[this.size() - 1].final = data.final;\n    this.storage[this.size() - 1].end = data.end;\n    this.addTimeout(this.storage[this.size() - 1], data.final);\n  }\n  addTimeout(item: TranscriptData, isFinal: boolean) {\n    if (!isFinal) {\n      return;\n    }\n    item.timeout = setTimeout(() => {\n      this.dequeue(item);\n    }, this.MAX_STORAGE_TIME);\n  }\n  dequeue(item: TranscriptData): TranscriptData | undefined {\n    const index = this.storage.indexOf(item);\n    if (index === -1) {\n      return undefined;\n    }\n    const removedItem = this.storage.splice(index, 1);\n    if (removedItem.length <= 0) {\n      return undefined;\n    }\n    this.clearTimeout(removedItem[0]);\n    return item;\n  }\n  clearTimeout(item: TranscriptData) {\n    if (!item.timeout) {\n      return;\n    }\n    clearTimeout(item.timeout);\n  }\n  peek(): TranscriptData | undefined {\n    if (this.size() <= 0) {\n      return undefined;\n    }\n    return this.storage[0];\n  }\n  getTranscription(): string {\n    let script = '';\n    this.storage.forEach((value: TranscriptData) => (script += value.transcript + ' '));\n    return script;\n  }\n  reset() {\n    this.storage.length = 0;\n  }\n  size(): number {\n    return this.storage.length;\n  }\n}\nclass Queue {\n  private storage: Record<string, CaptionQueueData> = {};\n  constructor(private capacity: number = 3) {}\n\n  enqueue(data: HMSTranscript): void {\n    if (this.size() === this.capacity) {\n      this.dequeue();\n    }\n    if (!this.storage[data.peer_id]) {\n      this.storage[data.peer_id] = {\n        peer_id: data.peer_id,\n        transcript: data.transcript,\n        final: data.final,\n        transcriptQueue: new SimpleQueue(),\n        start: data.start,\n        end: data.end,\n      };\n      this.storage[data.peer_id].transcriptQueue.enqueue(data as TranscriptData);\n      return;\n    }\n    this.storage[data.peer_id].transcriptQueue.enqueue(data as TranscriptData);\n  }\n  dequeue(): CaptionQueueData {\n    const key: string = Object.keys(this.storage).shift() || '';\n    const captionData = this.storage[key];\n    captionData.transcriptQueue.reset();\n    delete this.storage[key];\n    return captionData;\n  }\n\n  peek(): CaptionQueueData | undefined {\n    if (this.size() <= 0) return undefined;\n    const key: string = Object.keys(this.storage).shift() || '';\n    return this.storage[key];\n  }\n\n  findPeerData(): { [key: string]: string }[] {\n    const keys = Object.keys(this.storage);\n    const data = keys.map((key: string) => {\n      const data = this.storage[key];\n      const word = data.transcriptQueue.getTranscription();\n      return { [key]: word };\n    });\n    return data;\n  }\n  size(): number {\n    return Object.keys(this.storage).length;\n  }\n}\n\nclass CaptionMaintainerQueue {\n  captionData: Queue;\n  constructor() {\n    this.captionData = new Queue();\n  }\n  push(data: HMSTranscript[] = []) {\n    data.forEach((value: HMSTranscript) => {\n      this.captionData.enqueue(value);\n    });\n  }\n}\nconst TranscriptView = ({ peer_id, data }: { peer_id: string; data: string }) => {\n  const peerName = useHMSStore(selectPeerNameByID(peer_id)) || 'Participant';\n  data = data.trim();\n  if (!data) return null;\n  return (\n    <Text\n      variant=\"body2\"\n      css={{\n        fontWeight: '$normal',\n      }}\n    >\n      <b>{peerName}: </b>\n      {data}\n    </Text>\n  );\n};\n\nexport const CaptionsViewer = ({\n  defaultPosition,\n  setDefaultPosition,\n}: {\n  defaultPosition: ControlPosition;\n  setDefaultPosition: (position: ControlPosition) => void;\n}) => {\n  const { elements, screenType } = useRoomLayoutConferencingScreen();\n  const isMobile = useMedia(config.media.md);\n  const isChatOpen = useIsSidepaneTypeOpen(SIDE_PANE_OPTIONS.CHAT);\n\n  const showCaptionAtTop = elements?.chat?.is_overlay && isChatOpen && isMobile;\n\n  const [captionQueue] = useState<CaptionMaintainerQueue>(new CaptionMaintainerQueue());\n  const [currentData, setCurrentData] = useState<{ [key: string]: string }[]>([]);\n\n  const isCaptionEnabled = useIsCaptionEnabled();\n\n  const isTranscriptionEnabled = useHMSStore(selectIsTranscriptionEnabled);\n\n  const nodeRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const timeInterval = setInterval(() => {\n      if (!captionQueue) {\n        return;\n      }\n      const data = captionQueue.captionData?.findPeerData();\n      setCurrentData(data);\n    }, 1000);\n    return () => clearInterval(timeInterval);\n  }, [captionQueue]);\n\n  useTranscript({\n    onTranscript: (data: HMSTranscript[]) => {\n      captionQueue && captionQueue.push(data as HMSTranscript[]);\n    },\n  });\n  const dataToShow = currentData.filter((data: { [key: string]: string }) => {\n    const key = Object.keys(data)[0];\n    if (data[key]) {\n      return true;\n    }\n    return false;\n  });\n  if (dataToShow.length <= 0 || screenType === 'hls_live_streaming' || !isCaptionEnabled || !isTranscriptionEnabled) {\n    return null;\n  }\n  return (\n    <Draggable\n      bounds=\"parent\"\n      nodeRef={nodeRef}\n      defaultPosition={defaultPosition}\n      onStop={(_, data) => {\n        setDefaultPosition({ x: data.lastX, y: data.lastY });\n      }}\n    >\n      <Box\n        ref={nodeRef}\n        css={{\n          position: 'absolute',\n          w: isMobile ? '100%' : '40%',\n          bottom: showCaptionAtTop ? '' : '0',\n          top: showCaptionAtTop ? '0' : '',\n          left: isMobile ? 0 : '50%',\n          transform: isMobile ? '' : 'translateX(-50%)',\n          background: '#000000A3',\n          overflow: 'clip',\n          zIndex: 10,\n          height: 'fit-content',\n          r: '$1',\n          p: '$6',\n          transition: 'bottom 0.3s ease-in-out',\n          '&:empty': { display: 'none' },\n        }}\n      >\n        <Flex direction=\"column\">\n          {dataToShow.map((data: { [key: string]: string }, index: number) => {\n            const key = Object.keys(data)[0];\n            return <TranscriptView key={index} peer_id={key} data={data[key]} />;\n          })}\n        </Flex>\n      </Box>\n    </Draggable>\n  );\n};\n", "import { useEffect } from 'react';\nimport { selectPeerScreenSharing, useHMSStore, useWhiteboard } from '@100mslive/react-sdk';\n\n/**\n * close existing whiteboard when a screen is shared\n */\nexport const useCloseScreenshareWhiteboard = () => {\n  const peerSharing = useHMSStore(selectPeerScreenSharing);\n  const { isOwner: isWhiteboardOwner, toggle: toggleWhiteboard } = useWhiteboard();\n\n  // if both screenshare and whiteboard are open, close the whiteboard\n  useEffect(() => {\n    if (isWhiteboardOwner && peerSharing) {\n      toggleWhiteboard?.();\n    }\n  }, [isWhiteboardOwner, toggleWhiteboard, peerSharing]);\n};\n", "export { Header } from './Header';\n", "import React from 'react';\nimport { useMedia } from 'react-use';\nimport { HMSRoomState, selectRoomState, useHMSStore } from '@100mslive/react-sdk';\nimport { config as cssConfig, Flex } from '../../..';\n// @ts-ignore: No implicit any\nimport { Logo, SpeakerTag } from './HeaderComponents';\n// @ts-ignore: No implicit any\nimport { RoomDetailsHeader } from './RoomDetailsHeader';\nimport { LiveStatus, RecordingPauseStatus, RecordingStatus, StreamActions } from './StreamActions';\n// @ts-ignore: No implicit any\nimport { AudioActions, CamaraFlipActions } from './common';\n\nexport const Header = () => {\n  const roomState = useHMSStore(selectRoomState);\n  const isMobile = useMedia(cssConfig.media.md);\n  // Header should be present only inside the call - not in preview, leave room states\n  if (roomState !== HMSRoomState.Connected) {\n    return <></>;\n  }\n  return (\n    <Flex justify=\"between\" align=\"center\" css={{ position: 'relative', height: '100%' }}>\n      <Flex align=\"center\" gap=\"2\" css={{ position: 'absolute', left: '$10' }}>\n        <Logo />\n        <RoomDetailsHeader />\n        <SpeakerTag />\n        {isMobile && (\n          <Flex align=\"center\" css={{ gap: '$4' }}>\n            <LiveStatus />\n            <RecordingStatus />\n            <RecordingPauseStatus />\n          </Flex>\n        )}\n      </Flex>\n      <Flex\n        align=\"center\"\n        css={{\n          position: 'absolute',\n          right: '$10',\n          gap: '$4',\n        }}\n      >\n        <StreamActions />\n        {isMobile ? (\n          <>\n            <CamaraFlipActions />\n            <AudioActions />\n          </>\n        ) : null}\n      </Flex>\n    </Flex>\n  );\n};\n", "import React from 'react';\nimport { useMedia } from 'react-use';\nimport { ChevronRightIcon } from '@100mslive/react-icons';\nimport { Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { config as cssConfig } from '../../../Theme';\nimport { useRoomLayoutHeader } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useSheetToggle } from '../AppData/useSheet';\n// @ts-ignore\nimport { useSidepaneToggle } from '../AppData/useSidepane';\nimport { SHEET_OPTIONS, SIDE_PANE_OPTIONS } from '../../common/constants';\n\nexport const RoomDetailsHeader = () => {\n  const { title, description } = useRoomLayoutHeader();\n  const isMobile = useMedia(cssConfig.media.md);\n  const clipLength = 30;\n  const toggleDetailsPane = useSidepaneToggle(SIDE_PANE_OPTIONS.ROOM_DETAILS);\n  const toggleDetailsSheet = useSheetToggle(SHEET_OPTIONS.ROOM_DETAILS);\n\n  if ((!title && !description) || (isMobile && !title)) {\n    return null;\n  }\n\n  return (\n    <Flex direction={isMobile ? 'row' : 'column'} css={{ ml: '$8', alignItems: isMobile ? 'center' : 'start' }}>\n      <Text variant=\"sm\" css={{ c: '$on_surface_high', fontWeight: '$semiBold' }}>\n        {title}\n      </Text>\n      {!isMobile && (\n        <Flex align=\"end\" css={{ color: '$on_surface_high' }}>\n          <Text variant=\"xs\" css={{ c: '$on_surface_medium' }}>\n            {description.slice(0, clipLength)}\n          </Text>\n          {description.length > clipLength ? (\n            <span\n              style={{ fontWeight: '600', fontSize: '12px', cursor: 'pointer', lineHeight: '1rem' }}\n              onClick={toggleDetailsPane}\n            >\n              &nbsp;...more\n            </span>\n          ) : null}\n        </Flex>\n      )}\n      {isMobile && description ? (\n        <Flex css={{ color: '$on_surface_medium' }}>\n          <ChevronRightIcon height={16} width={16} onClick={toggleDetailsSheet} />\n        </Flex>\n      ) : null}\n    </Flex>\n  );\n};\n", "import React from 'react';\nimport {\n  DeviceType,\n  selectIsLocalVideoEnabled,\n  selectLocalVideoTrackID,\n  selectVideoTrackByID,\n  useDevices,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport {\n  BluetoothIcon,\n  CameraFlipIcon,\n  CheckIcon,\n  CrossIcon,\n  HeadphonesIcon,\n  SpeakerIcon,\n  TelePhoneIcon,\n} from '@100mslive/react-icons';\nimport { HorizontalDivider } from '../../../Divider';\nimport { Label } from '../../../Label';\nimport { Box, Flex } from '../../../Layout';\nimport { Sheet } from '../../../Sheet';\nimport { Text } from '../../../Text';\nimport IconButton from '../../IconButton';\nimport { ToastManager } from '../Toast/ToastManager';\n\nexport const CamaraFlipActions = () => {\n  const actions = useHMSActions();\n  const { allDevices } = useDevices();\n  const { videoInput } = allDevices;\n  const isVideoOn = useHMSStore(selectIsLocalVideoEnabled);\n\n  const videoTrackId = useHMSStore(selectLocalVideoTrackID);\n  const localVideoTrack = useHMSStore(selectVideoTrackByID(videoTrackId));\n  if (!videoInput || !videoInput?.length || !localVideoTrack?.facingMode) {\n    return null;\n  }\n  return (\n    <Box>\n      <IconButton\n        disabled={!isVideoOn}\n        onClick={async () => {\n          try {\n            await actions.switchCamera();\n          } catch (e) {\n            ToastManager.addToast({\n              title: `Error while flipping camera ${e.message || ''}`,\n              variant: 'error',\n            });\n          }\n        }}\n      >\n        <CameraFlipIcon />\n      </IconButton>\n    </Box>\n  );\n};\n\n// It will handle and show audio input devices in Mweb while audio output devices in desktop\nexport const AudioActions = () => {\n  const { allDevices, selectedDeviceIDs, updateDevice } = useDevices();\n\n  // don't show speaker selector where the API is not supported, and use\n  // a generic word(\"Audio\") for Mic. In some cases(Chrome Android for example) this changes both mic and speaker keeping them in sync.\n  const shouldShowAudioOutput = 'setSinkId' in HTMLMediaElement.prototype;\n  const { audioInput, audioOutput } = allDevices;\n  let availableAudioDevices = audioInput;\n  let selectedAudio = selectedDeviceIDs.audioInput;\n  if (shouldShowAudioOutput) {\n    availableAudioDevices = audioOutput;\n    selectedAudio = selectedDeviceIDs.audioOutput;\n  }\n  const hmsActions = useHMSActions();\n  const audioFiltered = availableAudioDevices?.find(item => !!item.label);\n  const currentSelection = availableAudioDevices?.find(item => item.deviceId === selectedAudio);\n\n  if (!audioFiltered) {\n    return null;\n  }\n  let AudioIcon = <SpeakerIcon />;\n  if (currentSelection && currentSelection.label.toLowerCase().includes('bluetooth')) {\n    AudioIcon = <BluetoothIcon />;\n  } else if (currentSelection && currentSelection.label.toLowerCase().includes('wired')) {\n    AudioIcon = <HeadphonesIcon />;\n  } else if (currentSelection && currentSelection.label.toLowerCase().includes('earpiece')) {\n    AudioIcon = <TelePhoneIcon />;\n  }\n  return (\n    <AudioSelectionSheet\n      audioDevices={availableAudioDevices}\n      audioSelected={selectedAudio}\n      onChange={async deviceId => {\n        try {\n          await updateDevice({\n            deviceId,\n            deviceType: shouldShowAudioOutput ? DeviceType.audioOutput : DeviceType.audioInput,\n          });\n        } catch (e) {\n          ToastManager.addToast({\n            title: `Error while changing audio device ${e.message || ''}`,\n            variant: 'error',\n          });\n        }\n      }}\n    >\n      <Box\n        onClick={async () => {\n          // refresh device as `devicechange` listener won't work in mobile device\n          await hmsActions.refreshDevices();\n        }}\n      >\n        <IconButton>{AudioIcon} </IconButton>\n      </Box>\n    </AudioSelectionSheet>\n  );\n};\n\nconst AudioSelectionSheet = ({ audioDevices, audioSelected, onChange, children }) => {\n  return (\n    <Sheet.Root>\n      <Sheet.Trigger asChild>{children}</Sheet.Trigger>\n      <Sheet.Content>\n        <Sheet.Title css={{ py: '$10', px: '$8', alignItems: 'center' }}>\n          <Flex direction=\"row\" justify=\"between\" css={{ w: '100%' }}>\n            <Text variant=\"h6\" css={{ display: 'flex' }}>\n              Audio\n            </Text>\n            <Sheet.Close>\n              <IconButton as=\"div\" data-testid=\"dialog_cross_icon\">\n                <CrossIcon />\n              </IconButton>\n            </Sheet.Close>\n          </Flex>\n        </Sheet.Title>\n        <HorizontalDivider />\n        <Flex\n          direction=\"column\"\n          css={{\n            px: '$8',\n            maxHeight: '80vh',\n            overflowY: 'auto',\n          }}\n        >\n          {audioDevices.map(audioDevice => {\n            return (\n              <SelectWithLabel\n                key={audioDevice.deviceId}\n                label={audioDevice.label}\n                id={audioDevice.deviceId}\n                checked={audioDevice.deviceId === audioSelected}\n                onChange={() => onChange(audioDevice.deviceId)}\n              />\n            );\n          })}\n        </Flex>\n      </Sheet.Content>\n    </Sheet.Root>\n  );\n};\n\nconst SelectWithLabel = ({ label, icon = <></>, checked, id, onChange }) => {\n  return (\n    <Flex\n      align=\"center\"\n      css={{\n        my: '$2',\n        py: '$8',\n        w: '100%',\n        borderBottom: '1px solid $border_default',\n      }}\n      onClick={onChange}\n    >\n      <Label\n        htmlFor={id}\n        css={{\n          fontSize: '$md',\n          fontWeight: '$semiBold',\n          color: '$on_surface_high',\n          cursor: 'pointer',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '$8',\n          flex: '1 1 0',\n        }}\n      >\n        {icon}\n        {label}\n      </Label>\n      {checked && <CheckIcon width={24} height={24} />}\n    </Flex>\n  );\n};\n", "import { useEffect } from 'react';\nimport { selectLocalPeerRoleName, useHMSVanillaStore } from '@100mslive/react-sdk';\nimport { useMyMetadata } from './hooks/useMetadata';\n\nexport const PreviousRoleInMetadata = () => {\n  const vanillaStore = useHMSVanillaStore();\n  const { updateMetaData } = useMyMetadata();\n\n  useEffect(() => {\n    let previousRole = vanillaStore.getState(selectLocalPeerRoleName);\n    const unsubscribe = vanillaStore.subscribe(currentRole => {\n      if (previousRole !== currentRole && currentRole) {\n        updateMetaData({ prevRole: previousRole });\n        previousRole = currentRole;\n      }\n    }, selectLocalPeerRoleName);\n    return unsubscribe;\n  }, [vanillaStore]); //eslint-disable-line\n  return null;\n};\n", "import React, { Component } from 'react';\nimport { CopyIcon } from '@100mslive/react-icons';\nimport { Button } from '../../Button';\nimport { Box, Flex } from '../../Layout';\nimport { Text } from '../../Text';\nimport { Tooltip } from '../../Tooltip';\n\nexport class ErrorBoundary extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { error: null, errorInfo: null, isErrorCopied: false };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    console.error(`react error boundary - ${error.message}`, error, errorInfo);\n    // Catch errors in any components below and re-render with error message\n    this.setState({\n      error: error?.message,\n      errorInfo: errorInfo,\n    });\n  }\n\n  render() {\n    if (this.state.errorInfo) {\n      return (\n        <Flex\n          align=\"center\"\n          justify=\"center\"\n          css={{\n            size: '100%',\n            height: '100vh',\n            width: '100%',\n            color: '$on_primary_high',\n            backgroundColor: '$background_default',\n          }}\n        >\n          <Box css={{ position: 'relative', overflow: 'hidden', r: '$3', height: '100%', width: '100%' }}>\n            <Flex\n              direction=\"column\"\n              css={{\n                position: 'absolute',\n                size: '100%',\n                top: '33.33%',\n                left: 0,\n              }}\n            >\n              <div style={{ margin: '1.5rem', width: '100%' }}>\n                <Text>Something went wrong</Text>\n                <Text>Message: ${this.state.error}</Text>\n                <br />\n                Please reload to see if it works. If you think this is a mistake on our side, please reach out to us on\n                <a href=\"https://discord.com/invite/kGdmszyzq2\" target=\"_blank\" rel=\"noreferrer\">\n                  Discord\n                </a>\n              </div>\n              <Flex>\n                <Tooltip title=\"Reload page\">\n                  <Button\n                    onClick={() => {\n                      window.location.reload();\n                    }}\n                    css={{ mx: '$8' }}\n                    data-testid=\"join_again_btn\"\n                  >\n                    Reload\n                  </Button>\n                </Tooltip>\n                <Tooltip title=\"Copy error details to clipboard\">\n                  <Button\n                    onClick={() => {\n                      const { error, errorInfo } = this.state;\n                      navigator.clipboard.writeText(\n                        JSON.stringify({\n                          error,\n                          errorInfo,\n                        }),\n                      );\n                      this.setState({ isErrorCopied: true });\n                    }}\n                    css={{ mx: '$8' }}\n                    data-testid=\"join_again_btn\"\n                  >\n                    <CopyIcon /> {this.state.isErrorCopied ? 'Copied' : 'Copy Details'}\n                  </Button>\n                </Tooltip>\n              </Flex>\n\n              <details style={{ whiteSpace: 'pre-wrap', margin: '1.5rem' }}>\n                <Text>{this.state.error && this.state.error.toString()}</Text>\n                <br />\n                <Text>{JSON.stringify(this.state.errorInfo)}</Text>\n              </details>\n            </Flex>\n          </Box>\n        </Flex>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n", "import React, { useEffect } from 'react';\nimport { useTheme } from '../../../';\nimport { FeatureFlagsInit } from '../../services/FeatureFlags';\n\nconst Init = () => {\n  const { toggleTheme } = useTheme();\n\n  useEffect(() => {\n    window.toggleUiTheme = toggleTheme;\n  }, [toggleTheme]);\n\n  useEffect(() => {\n    function resetHeight() {\n      // reset the body height to that of the inner browser\n      // The window.innerHeight property returns integer values. When the actual height is in decimal, window.innerHeight returns a larger value than the actual value. This can cause a scrollbar to appear on some screens.\n      // Hence using window.visualViewport.height which returns a decimal value.\n      document.body.style.height = `${window.visualViewport?.height || window.innerHeight}px`;\n    }\n    // reset the height whenever the window's resized\n    window.addEventListener('resize', resetHeight);\n    // called to initially set the height.\n    resetHeight();\n    return () => {\n      window.removeEventListener('resize', resetHeight);\n    };\n  }, []);\n\n  return <FeatureFlagsInit />;\n};\n\nexport { Init };\n", "import { useEffect } from 'react';\nimport { selectRoomID, useHMSStore } from '@100mslive/react-sdk';\n\nexport class FeatureFlags {\n  static enableTranscription = process.env.REACT_APP_ENABLE_TRANSCRIPTION === 'true';\n  static enableStatsForNerds = process.env.REACT_APP_ENABLE_STATS_FOR_NERDS === 'true';\n  static enableWhiteboard =\n    process.env.REACT_APP_ENABLE_WHITEBOARD &&\n    process.env.REACT_APP_PUSHER_APP_KEY &&\n    process.env.REACT_APP_PUSHER_AUTHENDPOINT;\n\n  static init(roomId) {\n    if (!window.HMS) {\n      window.HMS = {};\n    }\n    // some extra config to hls js to bring down latency\n    window.HMS.OPTIMISE_HLS_LATENCY = false;\n    // ask permissions in preview even if role doesn't have it\n    window.HMS.ALWAYS_REQUEST_PERMISSIONS = false;\n    window.HMS.SHOW_NS = process.env.REACT_APP_ENV !== 'prod';\n\n    this.enableTranscription = process.env.REACT_APP_TRANSCRIPTION_ROOM_ID === roomId;\n  }\n\n  static showNS() {\n    return window.HMS.SHOW_NS;\n  }\n\n  static optimiseHLSLatency() {\n    return window.HMS.OPTIMISE_HLS_LATENCY;\n  }\n\n  static alwaysRequestPermissions() {\n    return window.HMS.ALWAYS_REQUEST_PERMISSIONS;\n  }\n}\n\nexport function FeatureFlagsInit() {\n  const roomId = useHMSStore(selectRoomID);\n  useEffect(() => {\n    if (roomId) {\n      FeatureFlags.init(roomId);\n    }\n  }, [roomId]);\n  return null;\n}\n", "import { useEffect } from 'react';\nimport {\n  selectAppData,\n  selectIsLocalAudioEnabled,\n  selectIsLocalVideoEnabled,\n  useHMSActions,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\nimport { APP_DATA, isMacOS } from '../../common/constants';\n\nlet isEvenListenersAttached = false;\nexport class KeyboardInputManager {\n  #actions;\n  #store;\n  constructor(store, actions) {\n    this.#actions = actions;\n    this.#store = store;\n  }\n  #toggleAudio = async () => {\n    const enabled = this.#store.getState(selectIsLocalAudioEnabled);\n    await this.#actions.setLocalAudioEnabled(!enabled);\n  };\n\n  #toggleVideo = async () => {\n    const enabled = this.#store.getState(selectIsLocalVideoEnabled);\n    await this.#actions.setLocalVideoEnabled(!enabled);\n  };\n\n  #hideSidepane = () => {\n    if (this.#store.getState(selectAppData(APP_DATA.sidePane))) {\n      this.#actions.setAppData(APP_DATA.sidePane, '');\n    }\n  };\n\n  #toggleStatsForNerds = () => {\n    const uiSettings = this.#store.getState(selectAppData(APP_DATA.uiSettings));\n    const statsEnabled = uiSettings.showStatsOnTiles;\n    this.#actions.setAppData(APP_DATA.uiSettings, {\n      ...uiSettings,\n      showStatsOnTiles: !statsEnabled,\n    });\n  };\n\n  #toggleHlsStats = () => {\n    this.#actions.setAppData(APP_DATA.hlsStats, !this.#store.getState(selectAppData(APP_DATA.hlsStats)));\n  };\n\n  // eslint-disable-next-line complexity\n  #keyDownHandler = async e => {\n    const CONTROL_KEY = isMacOS ? e.metaKey : e.ctrlKey;\n    const D_KEY = e.key === 'd' || e.key === 'D';\n    const E_KEY = e.key === 'e' || e.key === 'E';\n    const SNF_KEY = e.key === ']' || e.key === '}';\n\n    const SHORTCUT_TOGGLE_AUDIO = CONTROL_KEY && D_KEY;\n    const SHORTCUT_TOGGLE_VIDEO = CONTROL_KEY && E_KEY;\n    const SHORTCUT_SIDEPANE_CLOSE = e.key === 'Escape';\n    const SHORTCUT_STATS_FOR_NERDS = CONTROL_KEY && SNF_KEY;\n\n    if (SHORTCUT_TOGGLE_AUDIO) {\n      e.preventDefault();\n      await this.#toggleAudio();\n    } else if (SHORTCUT_TOGGLE_VIDEO) {\n      e.preventDefault();\n      await this.#toggleVideo();\n    } else if (SHORTCUT_SIDEPANE_CLOSE) {\n      this.#hideSidepane();\n    } else if (SHORTCUT_STATS_FOR_NERDS) {\n      this.#toggleHlsStats();\n      this.#toggleStatsForNerds();\n    }\n  };\n\n  #bind = () => {\n    document.addEventListener('keydown', this.#keyDownHandler, false);\n  };\n\n  #unbind = () => {\n    document.removeEventListener('keydown', this.#keyDownHandler, false);\n  };\n\n  bindAllShortcuts = () => {\n    if (!isEvenListenersAttached) {\n      this.#bind();\n      isEvenListenersAttached = true;\n    }\n  };\n\n  unbindAllShortcuts = () => {\n    if (isEvenListenersAttached) {\n      this.#unbind();\n      isEvenListenersAttached = false;\n    }\n  };\n}\n\nexport const KeyboardHandler = () => {\n  const store = useHMSVanillaStore();\n  const actions = useHMSActions();\n\n  useEffect(() => {\n    const keyboardManager = new KeyboardInputManager(store, actions);\n    keyboardManager.bindAllShortcuts();\n    return keyboardManager.unbindAllShortcuts;\n  }, [actions, store]);\n  return null;\n};\n", "import React from 'react';\nimport { ExitIcon } from '@100mslive/react-icons';\nimport { Feedback } from './EndCallFeedback/Feedback';\n// @ts-ignore: No implicit Any\nimport { ToastManager } from './Toast/ToastManager';\nimport { Button } from '../../Button';\nimport { Box, Flex } from '../../Layout';\nimport { Text } from '../../Text';\nimport { useHMSAppStateContext } from '../AppStateContext';\nimport { Header } from './Header';\n// @ts-ignore: No implicit Any\nimport { defaultPreviewPreference, UserPreferencesKeys, useUserPreferences } from './hooks/useUserPreferences';\nimport { textEllipsis } from '../../utils';\n\nexport const LeaveScreen = () => {\n  const { rejoin } = useHMSAppStateContext();\n  const [previewPreference] = useUserPreferences(UserPreferencesKeys.PREVIEW, defaultPreviewPreference);\n  return (\n    <Flex direction=\"column\" css={{ size: '100%' }}>\n      <Box css={{ h: '$18', '@md': { h: '$17' } }} data-testid=\"header\">\n        <Header />\n      </Box>\n      <Flex\n        justify=\"center\"\n        direction=\"column\"\n        align=\"center\"\n        css={{ bg: '$background_dim', flex: '1 1 0', position: 'relative' }}\n      >\n        <Text variant=\"h2\" css={{ fontWeight: '$semiBold' }}>\n          \uD83D\uDC4B\n        </Text>\n        <Text variant=\"h4\" css={{ color: '$on_surface_high', fontWeight: '$semiBold', mt: '$12' }}>\n          You left the room\n        </Text>\n        <Text\n          variant=\"body1\"\n          css={{\n            color: '$on_surface_medium',\n            mt: '$8',\n            fontWeight: '$regular',\n            textAlign: 'center',\n          }}\n        >\n          Have a nice day\n          {previewPreference.name && (\n            <Box as=\"span\" css={{ ...textEllipsis(100) }}>\n              , {previewPreference.name}\n            </Box>\n          )}\n          !\n        </Text>\n        <Flex css={{ mt: '$14', gap: '$10', alignItems: 'center' }}>\n          <Text variant=\"body1\" css={{ color: '$on_surface_medium', fontWeight: '$regular' }}>\n            Left by mistake?\n          </Text>\n          <Button\n            onClick={() => {\n              rejoin();\n              ToastManager.clearAllToast();\n            }}\n            data-testid=\"join_again_btn\"\n          >\n            <ExitIcon />\n            <Text css={{ ml: '$3', fontWeight: '$semiBold', color: 'inherit' }}>Rejoin</Text>\n          </Button>\n        </Flex>\n        <Feedback />\n      </Flex>\n    </Flex>\n  );\n};\n", "import React, { useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { Flex } from '../../../Layout';\nimport { config as cssConfig } from '../../../Theme';\nimport { FEEBACK_INDEX, FeedbackHeader, FeedbackModal } from './FeedbackForm';\nimport { ThankyouView } from './ThankyouView';\nimport { useRoomLayoutLeaveScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n\nexport const Feedback = () => {\n  const { feedback } = useRoomLayoutLeaveScreen();\n  const [index, setIndex] = useState(FEEBACK_INDEX.INIT);\n  const isMobile = useMedia(cssConfig.media.md);\n\n  if (!feedback) {\n    return null;\n  }\n  const { ratings } = feedback;\n  if (!ratings) {\n    return null;\n  }\n  ratings.sort((a, b) => {\n    if (!a.value || !b.value) {\n      return 0;\n    }\n    return a.value - b.value;\n  });\n  // TO show thank ypu page\n  if (index === FEEBACK_INDEX.THANK_YOU) {\n    return (\n      <Flex\n        justify=\"center\"\n        css={{\n          pt: '$16',\n        }}\n      >\n        <ThankyouView />\n      </Flex>\n    );\n  }\n  return (\n    <Flex\n      justify=\"center\"\n      css={{\n        pt: '$16',\n        w: isMobile ? '100%' : '528px',\n      }}\n    >\n      {index === FEEBACK_INDEX.INIT ? (\n        <Flex\n          css={{\n            p: isMobile ? '$10' : '$12',\n            border: '1px solid $border_default',\n            bg: '$surface_dim',\n            borderRadius: !isMobile ? '$3' : '$3 $3 0 0',\n            gap: '$10',\n            '@md': {\n              position: 'absolute',\n              bottom: '0',\n              w: '100%',\n            },\n          }}\n          direction=\"column\"\n        >\n          <FeedbackHeader ratings={ratings} onEmojiClicked={setIndex} />\n        </Flex>\n      ) : (\n        <FeedbackModal ratings={ratings} index={index} setIndex={setIndex} />\n      )}\n    </Flex>\n  );\n};\n", "import React, { useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { Rating } from '@100mslive/types-prebuilt/elements/feedback';\nimport { useHMSActions } from '@100mslive/react-sdk';\nimport { CheckIcon, CrossIcon } from '@100mslive/react-icons';\nimport { Button } from '../../../Button';\nimport { Checkbox } from '../../../Checkbox';\nimport { Label } from '../../../Label';\nimport { Flex } from '../../../Layout';\nimport { Dialog } from '../../../Modal';\nimport { Sheet } from '../../../Sheet';\nimport { Text } from '../../../Text';\nimport { TextArea } from '../../../TextArea';\nimport { config as cssConfig } from '../../../Theme';\nimport { useHMSPrebuiltContext } from '../../AppContext';\nimport { useRoomLayoutLeaveScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n\nexport const FEEBACK_INDEX = {\n  THANK_YOU: -10,\n  INIT: -1,\n};\nexport const FeedbackModal = ({\n  ratings,\n  index,\n  setIndex,\n}: {\n  ratings: Rating[];\n  index: number;\n  setIndex: (index: number) => void;\n}) => {\n  const isMobile = useMedia(cssConfig.media.md);\n  const onOpenChange = () => {\n    setIndex(FEEBACK_INDEX.INIT);\n  };\n  const avoidDefaultDomBehavior = (e: Event) => {\n    e.preventDefault();\n  };\n  if (isMobile) {\n    return (\n      <Sheet.Root open={index !== FEEBACK_INDEX.INIT} onOpenChange={onOpenChange}>\n        <Sheet.Content\n          css={{ bg: '$surface_dim', p: '$10', overflowY: 'auto' }}\n          onPointerDownOutside={avoidDefaultDomBehavior}\n          onInteractOutside={avoidDefaultDomBehavior}\n        >\n          <FeedbackContent ratings={ratings} indexSelected={index} setIndex={setIndex} />\n        </Sheet.Content>\n      </Sheet.Root>\n    );\n  }\n  return (\n    <Dialog.Root open={index !== FEEBACK_INDEX.INIT} onOpenChange={onOpenChange}>\n      <Dialog.Portal>\n        <Dialog.Overlay />\n        <Dialog.Content\n          css={{ bg: '$surface_dim', width: '528px', p: '$12' }}\n          onPointerDownOutside={avoidDefaultDomBehavior}\n          onInteractOutside={avoidDefaultDomBehavior}\n        >\n          <FeedbackContent ratings={ratings} indexSelected={index} setIndex={setIndex} />\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n};\n\nexport const FeedbackContent = ({\n  ratings,\n  indexSelected,\n  setIndex,\n}: {\n  ratings: Rating[];\n  indexSelected: number;\n  setIndex: (index: number) => void;\n}) => {\n  const { feedback } = useRoomLayoutLeaveScreen();\n  const { endpoints } = useHMSPrebuiltContext();\n  const isMobile = useMedia(cssConfig.media.md);\n  const hmsActions = useHMSActions();\n  const [comment, setComment] = useState('');\n  const [selectedReasons, setSelectedReasons] = useState(new Set<number>());\n  const handleCheckedChange = (checked: boolean | string, index: number) => {\n    const newSelected = new Set(selectedReasons);\n    if (checked) {\n      newSelected.add(index);\n    } else {\n      newSelected.delete(index);\n    }\n    setSelectedReasons(newSelected);\n  };\n  const submitFeedback = async () => {\n    if (indexSelected < 0 || ratings.length <= indexSelected) {\n      return;\n    }\n    try {\n      const reasons = [...selectedReasons].map((value: number) => ratings[indexSelected]?.reasons?.[value] || '');\n      await hmsActions.submitSessionFeedback(\n        {\n          question: `${feedback?.title} | ${ratings[indexSelected].question || ''}`,\n          rating: ratings[indexSelected].value || 1,\n          min_rating: 1,\n          max_rating: ratings.length,\n          reasons: selectedReasons.size === 0 ? [] : reasons,\n          comment: comment,\n        },\n        endpoints?.event,\n      );\n    } catch (e) {\n      console.error(e);\n    }\n    // always submit and take it to thankyou page\n    setIndex(FEEBACK_INDEX.THANK_YOU);\n  };\n  return (\n    <Flex\n      css={{\n        p: indexSelected === FEEBACK_INDEX.INIT ? '$12 !important' : '0',\n        bg: '$surface_dim',\n        r: '$3',\n        gap: '$10',\n      }}\n      direction=\"column\"\n    >\n      <FeedbackHeader\n        ratings={ratings}\n        indexSelected={indexSelected}\n        onEmojiClicked={(value: number) => {\n          setSelectedReasons(new Set<number>());\n          setIndex(value);\n        }}\n      />\n      <FeedbackForm\n        rating={ratings[indexSelected]}\n        comment={comment}\n        setComment={setComment}\n        selectedReasons={selectedReasons}\n        handleCheckedChange={handleCheckedChange}\n      />\n      <Button\n        type=\"submit\"\n        icon\n        css={{\n          alignSelf: isMobile ? '' : 'end',\n        }}\n        onClick={submitFeedback}\n      >\n        {feedback?.submit_btn_label || 'Submit Feedback'}\n      </Button>\n    </Flex>\n  );\n};\nexport const FeedbackHeader = ({\n  onEmojiClicked,\n  ratings,\n  indexSelected = FEEBACK_INDEX.INIT,\n}: {\n  onEmojiClicked: (index: number) => void;\n  ratings: Rating[];\n  indexSelected?: number;\n}) => {\n  const isMobile = useMedia(cssConfig.media.md);\n  const { feedback } = useRoomLayoutLeaveScreen();\n  return (\n    <>\n      <Flex align=\"center\">\n        <Flex\n          direction=\"column\"\n          css={{\n            flex: '1 1 0',\n          }}\n        >\n          <Text\n            variant={isMobile ? 'h6' : 'h5'}\n            css={{\n              c: '$on_surface_high',\n              fontStyle: 'normal',\n            }}\n          >\n            {feedback?.title || 'How was your experience?'}\n          </Text>\n          <Text\n            variant={isMobile ? 'body2' : 'body1'}\n            css={{\n              c: '$on_surface_medium',\n              opacity: 0.9,\n              fontWeight: '$regular',\n            }}\n          >\n            {feedback?.sub_title || 'Your answers help us improve the quality.'}\n          </Text>\n        </Flex>\n        {indexSelected !== FEEBACK_INDEX.INIT ? (\n          <CrossIcon width=\"24px\" height=\"24px\" color=\"white\" onClick={() => onEmojiClicked(FEEBACK_INDEX.INIT)} />\n        ) : null}\n      </Flex>\n      <Flex\n        justify=\"between\"\n        css={{\n          gap: '$17',\n          c: '$on_surface_high',\n          '@md': {\n            gap: '0',\n          },\n        }}\n      >\n        {ratings.map((element, index) => {\n          return (\n            <Flex\n              align=\"center\"\n              direction=\"column\"\n              css={{\n                c:\n                  indexSelected === index || indexSelected === FEEBACK_INDEX.INIT\n                    ? '$on_surface_high'\n                    : '$on_surface_default',\n                gap: '$4',\n              }}\n              onClick={() => onEmojiClicked(index)}\n              key={`${index}`}\n            >\n              <Text\n                css={{\n                  fontWeight: '$semiBold',\n                  fontSize: '$h4',\n                  pb: '$1',\n                  cursor: 'pointer',\n                  opacity: indexSelected === index || indexSelected === FEEBACK_INDEX.INIT ? 1 : 0.2,\n                  '@md': {\n                    fontSize: '$h5',\n                  },\n                }}\n              >\n                {element.emoji}\n              </Text>\n              <Text\n                variant={isMobile ? 'body2' : 'body1'}\n                css={{\n                  c:\n                    indexSelected === index || indexSelected === FEEBACK_INDEX.INIT\n                      ? '$on_surface_medium'\n                      : '$on_surface_low',\n                  fontWeight: '$regular',\n                }}\n              >\n                {element.label}\n              </Text>\n            </Flex>\n          );\n        })}\n      </Flex>\n    </>\n  );\n};\nexport const FeedbackForm = ({\n  rating,\n  comment,\n  setComment,\n  selectedReasons,\n  handleCheckedChange,\n}: {\n  rating: Rating;\n  comment: string;\n  setComment: (value: string) => void;\n  selectedReasons: Set<number>;\n  handleCheckedChange: (checked: string | boolean, index: number) => void;\n}) => {\n  const { feedback } = useRoomLayoutLeaveScreen();\n  return (\n    <>\n      {rating.reasons && rating.reasons.length > 0 && (\n        <Flex\n          direction=\"column\"\n          css={{\n            gap: '$4',\n          }}\n        >\n          <Text\n            variant=\"sub2\"\n            css={{\n              c: '$on_surface_high',\n              fontWeight: '$semiBold',\n              fontSize: '$sm',\n              px: '$2',\n            }}\n          >\n            {rating.question || 'What do you like/dislike here?'}\n          </Text>\n          <Flex\n            css={{\n              alignItems: 'flex-start',\n              alignSelf: 'stretch',\n              flexWrap: 'wrap',\n              gap: '$6',\n              flex: '1 1 calc(25% - 12px)',\n              '@md': {\n                flex: '1 1 calc(50% - 12px)',\n              },\n              '@sm': {\n                flex: '1 1 100%',\n              },\n            }}\n          >\n            {rating.reasons.map((option: string, index: number) => {\n              return (\n                <Flex\n                  align=\"center\"\n                  gap=\"2\"\n                  key={index}\n                  css={{\n                    border: '1px solid $border_bright',\n                    r: '$1',\n                    p: '$6',\n                  }}\n                >\n                  <Checkbox.Root\n                    id={`${option}-${index}`}\n                    checked={selectedReasons.has(index)}\n                    onCheckedChange={checked => handleCheckedChange(checked, index)}\n                    css={{\n                      cursor: 'pointer',\n                      flexShrink: 0,\n                      bg: '$on_secondary_low',\n                      border: '1px solid $border_bright',\n                    }}\n                  >\n                    <Checkbox.Indicator>\n                      <CheckIcon width={12} height={12} />\n                    </Checkbox.Indicator>\n                  </Checkbox.Root>\n                  <Label\n                    htmlFor={`${option}-${index}`}\n                    css={{\n                      color: '$on_surface_high',\n                      fontSize: '$sm',\n                      fontWeight: '$regular',\n                      lineHeight: '20px' /* 142.857% */,\n                    }}\n                  >\n                    {option}\n                  </Label>\n                </Flex>\n              );\n            })}\n          </Flex>\n        </Flex>\n      )}\n      {feedback?.comment && (\n        <Flex\n          direction=\"column\"\n          css={{\n            gap: '$4',\n          }}\n        >\n          <Text\n            variant=\"body2\"\n            css={{\n              c: '$on_surface_high',\n              fontWeight: '$regular',\n              fontSize: '$sm',\n            }}\n          >\n            {feedback?.comment.label || 'Additional comments (optional)'}\n          </Text>\n          <TextArea\n            maxLength={1024}\n            placeholder={feedback?.comment.placeholder || 'Tell us more...'}\n            css={{\n              backgroundColor: '$surface_bright',\n              border: '1px solid $border_bright',\n              resize: 'none',\n              height: '$36',\n              display: 'flex',\n            }}\n            value={comment}\n            onChange={event => setComment(event.target.value.trimStart())}\n          />\n        </Flex>\n      )}\n    </>\n  );\n};\n", "import React from 'react';\nimport { useMedia } from 'react-use';\nimport { UserMusicIcon } from '@100mslive/react-icons';\nimport { Flex } from '../../../Layout';\nimport { Text } from '../../../Text';\nimport { config as cssConfig } from '../../../Theme';\n\nexport const ThankyouView = () => {\n  const isMobile = useMedia(cssConfig.media.md);\n  return (\n    <Flex\n      direction={isMobile ? 'column' : 'row'}\n      align=\"center\"\n      css={{\n        gap: '$10',\n        border: '1px solid $border_default',\n        borderRadius: !isMobile ? '$3' : '$3 $3 0 0',\n        bg: '$surface_dim',\n        w: !isMobile ? '528px' : '410px',\n        p: '$12',\n        pb: isMobile ? '$16' : '$12',\n        '@md': {\n          position: 'absolute',\n          bottom: '0',\n        },\n      }}\n    >\n      <UserMusicIcon width=\"64px\" height=\"64px\" />\n      <Flex direction=\"column\" align={isMobile ? 'center' : 'start'}>\n        <Text variant=\"h5\">Thank you for your feedback</Text>\n        <Text\n          variant=\"body1\"\n          css={{\n            fontWeight: '$regular',\n            fontSize: '$md',\n            opacity: '0.9',\n          }}\n        >\n          Your answers help us improve.\n        </Text>\n      </Flex>\n    </Flex>\n  );\n};\n", "import React, { useEffect, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { match, P } from 'ts-pattern';\nimport { RefreshIcon } from '@100mslive/react-icons';\nimport { Button } from '../../Button';\nimport { Box, Flex } from '../../Layout';\nimport { Dialog } from '../../Modal';\nimport { Text } from '../../Text';\nimport { config as cssConfig } from '../../Theme';\nimport { useLandscapeHLSStream } from '../common/hooks';\n// @ts-ignore\nimport { isMobileUserAgent } from '../common/utils';\n\nexport const MwebLandscapePrompt = () => {\n  const [showMwebLandscapePrompt, setShowMwebLandscapePrompt] = useState(false);\n  const isLandscape = useMedia(cssConfig.media.ls);\n  const isLandscapeHLSStream = useLandscapeHLSStream();\n\n  useEffect(() => {\n    if (!isMobileUserAgent) {\n      setShowMwebLandscapePrompt(false);\n      return;\n    }\n\n    if (!window.screen?.orientation) {\n      setShowMwebLandscapePrompt(isLandscape && !isLandscapeHLSStream);\n      return;\n    }\n    const handleRotation = () => {\n      const angle = window.screen.orientation.angle;\n      const type = window.screen.orientation.type || '';\n      // Angle check needed to diff bw mobile and desktop\n      setShowMwebLandscapePrompt(\n        match({ angle, isLandscapeHLSStream, isLandscape, type })\n          .with({ isLandscapeHLSStream: true }, () => false)\n          .with({ angle: P.when(angle => angle && angle >= 90) }, ({ type }) => type.includes('landscape'))\n          .otherwise(() => isLandscape),\n      );\n    };\n    handleRotation();\n    window.screen.orientation.addEventListener('change', handleRotation);\n    return () => {\n      window.screen.orientation.removeEventListener('change', handleRotation);\n    };\n  }, [isLandscape, isLandscapeHLSStream]);\n\n  if (isLandscapeHLSStream) {\n    return null;\n  }\n  return (\n    <Dialog.Root open={showMwebLandscapePrompt} onOpenChange={setShowMwebLandscapePrompt}>\n      <Dialog.Portal>\n        <Dialog.Overlay />\n        <Dialog.Content css={{ w: 'min(420px, 90%)', p: '$8', bg: '$surface_dim' }}>\n          <Box>\n            <Flex\n              css={{\n                color: '$primary_default',\n                display: 'flex',\n                alignItems: 'center',\n              }}\n            >\n              <RefreshIcon style={{ marginRight: '0.5rem' }} />\n              <Text variant=\"lg\" css={{ color: '$on_surface_high', fontWeight: '$semiBold' }}>\n                Please rotate your device\n              </Text>\n            </Flex>\n            <Text variant=\"sm\" css={{ color: '$on_surface_medium', mb: '$8', mt: '$4' }}>\n              We do not support landscape mode as of now, please use the app in portrait mode for the best experience.\n            </Text>\n            <Flex align=\"center\" justify=\"between\" css={{ w: '100%', gap: '$8' }}>\n              <Button outlined variant=\"standard\" css={{ w: '100%' }} onClick={() => setShowMwebLandscapePrompt(false)}>\n                Continue anyway\n              </Button>\n            </Flex>\n          </Box>\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  );\n};\n", "export { Notifications } from './Notifications';\n", "/* eslint-disable no-case-declarations */\nimport React, { useCallback, useEffect } from 'react';\nimport {\n  HMSNotificationTypes,\n  HMSRoleChangeRequest,\n  HMSRoomState,\n  selectIsLocalScreenShared,\n  selectLocalPeerID,\n  selectPeerNameByID,\n  selectRoomState,\n  useAwayNotifications,\n  useCustomEvent,\n  useHMSNotifications,\n  useHMSStore,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\nimport { GroupIcon } from '@100mslive/react-icons';\nimport { Box, Button } from '../../..';\nimport { useRoomLayout, useUpdateRoomLayout } from '../../provider/roomLayoutProvider';\n// @ts-ignore: No implicit Any\nimport { ToastManager } from '../Toast/ToastManager';\nimport { AutoplayBlockedModal } from './AutoplayBlockedModal';\nimport { ChatNotifications } from './ChatNotifications';\nimport { HandRaisedNotifications } from './HandRaisedNotifications';\nimport { InitErrorModal } from './InitErrorModal';\nimport { PeerNotifications } from './PeerNotifications';\nimport { PermissionErrorNotificationModal } from './PermissionErrorModal';\nimport { ReconnectNotifications } from './ReconnectNotifications';\nimport { TrackBulkUnmuteModal } from './TrackBulkUnmuteModal';\nimport { TrackNotifications } from './TrackNotifications';\nimport { TrackUnmuteModal } from './TrackUnmuteModal';\nimport { TranscriptionNotifications } from './TranscriptionNotifications';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { usePollViewToggle } from '../AppData/useSidepane';\n// @ts-ignore: No implicit Any\nimport { useIsNotificationDisabled, useSubscribedNotifications } from '../AppData/useUISettings';\nimport { usePIPWindow } from '../PIP/usePIPWindow';\nimport { ROLE_CHANGE_DECLINED } from '../../common/constants';\n\nconst pollToastKey: Record<string, string> = {};\n\nexport function Notifications() {\n  const localPeerID = useHMSStore(selectLocalPeerID);\n  const notification = useHMSNotifications();\n  const subscribedNotifications = useSubscribedNotifications() || {};\n  const roomState = useHMSStore(selectRoomState);\n  const updateRoomLayoutForRole = useUpdateRoomLayout();\n  const isNotificationDisabled = useIsNotificationDisabled();\n  const screenProps = useRoomLayoutConferencingScreen();\n  const vanillaStore = useHMSVanillaStore();\n  const togglePollView = usePollViewToggle();\n  const { showNotification } = useAwayNotifications();\n  const amIScreenSharing = useHMSStore(selectIsLocalScreenShared);\n  const logoURL = useRoomLayout()?.logo?.url;\n  const { pipWindow } = usePIPWindow();\n\n  const handleRoleChangeDenied = useCallback((request: HMSRoleChangeRequest & { peerName: string }) => {\n    ToastManager.addToast({\n      title: `${request.peerName} denied your request to join the ${request.role.name} role`,\n      variant: 'error',\n    });\n  }, []);\n\n  useCustomEvent({ type: ROLE_CHANGE_DECLINED, onEvent: handleRoleChangeDenied });\n\n  useEffect(() => {\n    if (!notification || isNotificationDisabled) {\n      return;\n    }\n    switch (notification.type) {\n      case HMSNotificationTypes.NAME_UPDATED:\n        console.log(notification.data.id + ' changed their name to ' + notification.data.name);\n        break;\n      case HMSNotificationTypes.ERROR:\n        if (notification.data?.isTerminal && notification.data?.action !== 'INIT') {\n          if ([500, 6008].includes(notification.data?.code)) {\n            ToastManager.addToast({\n              title: `Error: ${notification.data?.message}`,\n            });\n          } else if (notification.data?.message === 'role limit reached') {\n            ToastManager.addToast({\n              title: 'The room is currently full, try joining later',\n              close: true,\n              icon: (\n                <Box css={{ color: '$alert_error_default' }}>\n                  <GroupIcon />\n                </Box>\n              ),\n            });\n          } else {\n            ToastManager.addToast({\n              title:\n                notification.data?.message ||\n                'We couldn\u2019t reconnect you. When you\u2019re back online, try joining the room.',\n              close: false,\n            });\n          }\n          return;\n        }\n        // Autoplay error or user denied screen share (cancelled browser pop-up)\n        if (notification.data?.code === 3008 || notification.data?.code === 3001 || notification.data?.code === 3011) {\n          return;\n        }\n        if (notification.data?.action === 'INIT') {\n          return;\n        }\n        if (!subscribedNotifications.ERROR) return;\n        ToastManager.addToast({\n          title: `Error: ${notification.data?.message} - ${notification.data?.description}`,\n        });\n        break;\n      case HMSNotificationTypes.ROLE_UPDATED: {\n        if (notification.data?.isLocal && notification.data?.roleName) {\n          ToastManager.addToast({\n            title: `You are now a ${notification.data.roleName}`,\n          });\n          updateRoomLayoutForRole?.(notification.data.roleName);\n        }\n        break;\n      }\n      case HMSNotificationTypes.CHANGE_TRACK_STATE_REQUEST:\n        const track = notification.data?.track;\n        if (!notification.data.enabled) {\n          ToastManager.addToast({\n            title: `Your ${track.source} ${track.type} was muted by\n                ${notification.data.requestedBy?.name}.`,\n          });\n        }\n        break;\n      case HMSNotificationTypes.REMOVED_FROM_ROOM:\n      case HMSNotificationTypes.ROOM_ENDED:\n        ToastManager.addToast({\n          title: `${notification.message}. \n              ${notification.data.reason && `Reason: ${notification.data.reason}`}`,\n        });\n        break;\n      case HMSNotificationTypes.DEVICE_CHANGE_UPDATE:\n        ToastManager.addToast({\n          title: notification.message,\n        });\n        break;\n\n      case HMSNotificationTypes.POLL_STARTED:\n        if (notification.data.startedBy !== localPeerID && screenProps.screenType !== 'hls_live_streaming') {\n          const pollStartedBy = vanillaStore.getState(selectPeerNameByID(notification.data.startedBy)) || 'Participant';\n\n          const pollToastID = ToastManager.addToast({\n            title: `${pollStartedBy} started a ${notification.data.type}: ${notification.data.title}`,\n            action: (\n              <Button\n                onClick={() => togglePollView(notification.data.id)}\n                variant=\"standard\"\n                css={{\n                  backgroundColor: '$surface_bright',\n                  fontWeight: '$semiBold',\n                  color: '$on_surface_high',\n                  p: '$xs $md',\n                }}\n              >\n                {notification.data.type === 'quiz' ? 'Answer' : 'Vote'}\n              </Button>\n            ),\n            duration: Infinity,\n          });\n          pollToastKey[notification.data.id] = pollToastID;\n        }\n        break;\n      case HMSNotificationTypes.POLL_STOPPED:\n        const pollID = notification?.data.id;\n        if (pollID && pollToastKey?.[pollID]) {\n          ToastManager.removeToast(pollToastKey?.[notification.data.id]);\n          delete pollToastKey[notification?.data.id];\n        }\n        break;\n      case HMSNotificationTypes.NEW_MESSAGE:\n        if (amIScreenSharing && !notification.data?.ignored && !pipWindow) {\n          showNotification(`New message from ${notification.data.senderName}`, {\n            body: notification.data.message,\n            icon: logoURL,\n          });\n        }\n        break;\n      default:\n        break;\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [notification, subscribedNotifications.ERROR, subscribedNotifications.METADATA_UPDATED]);\n\n  if (isNotificationDisabled) {\n    return null;\n  }\n\n  return (\n    <>\n      <TrackUnmuteModal />\n      <TrackBulkUnmuteModal />\n      <TrackNotifications />\n      {roomState === HMSRoomState.Connected ? <PeerNotifications /> : null}\n      <ReconnectNotifications />\n      <AutoplayBlockedModal />\n      <PermissionErrorNotificationModal />\n      <InitErrorModal />\n      <ChatNotifications />\n      <HandRaisedNotifications />\n      <TranscriptionNotifications />\n    </>\n  );\n}\n", "import React from 'react';\nimport { useAutoplayError } from '@100mslive/react-sdk';\nimport { Button, Dialog, Text } from '../../..';\n// @ts-ignore: No implicit Any\nimport { DialogContent, DialogRow } from '../../primitives/DialogContent';\n\nexport function AutoplayBlockedModal() {\n  const { error, resetError, unblockAudio } = useAutoplayError();\n  return (\n    <Dialog.Root\n      open={!!error}\n      onOpenChange={value => {\n        if (!value) {\n          unblockAudio();\n        }\n        resetError();\n      }}\n    >\n      <DialogContent title=\"Permission Error\" closeable={false}>\n        <DialogRow>\n          <Text variant=\"md\">\n            The browser wants us to get a confirmation for playing the Audio. Please allow audio to proceed.\n          </Text>\n        </DialogRow>\n        <DialogRow justify=\"end\">\n          <Button\n            variant=\"primary\"\n            onClick={() => {\n              unblockAudio();\n              resetError();\n            }}\n          >\n            Allow Audio\n          </Button>\n        </DialogRow>\n      </DialogContent>\n    </Dialog.Root>\n  );\n}\n", "import React, { useEffect } from 'react';\nimport { v4 as uuid } from 'uuid';\nimport { selectLocalPeerID, selectSessionStore, useHMSStore } from '@100mslive/react-sdk';\nimport { ChatIcon, ChatUnreadIcon } from '@100mslive/react-icons';\n// @ts-ignore\nimport { ToastManager } from '../Toast/ToastManager';\nimport { SESSION_STORE_KEY } from '../../common/constants';\n\nconst NOTIFICATION_TIME_DIFFERENCE = 5000;\n\nexport const ChatNotifications = () => {\n  const chatState = useHMSStore(selectSessionStore(SESSION_STORE_KEY.CHAT_STATE));\n  const localPeerId = useHMSStore(selectLocalPeerID);\n\n  useEffect(() => {\n    if (!chatState || chatState.updatedBy?.peerId === localPeerId) {\n      return;\n    }\n\n    const showToast = Date.now() - chatState.updatedAt < NOTIFICATION_TIME_DIFFERENCE;\n\n    if (!showToast) {\n      return;\n    }\n\n    const notification = {\n      id: uuid(),\n      icon: chatState.enabled ? <ChatUnreadIcon /> : <ChatIcon />,\n      title: `Chat ${chatState.enabled ? 'resumed' : 'paused'} by ${chatState.updatedBy?.userName}`,\n    };\n    ToastManager.addToast(notification);\n  }, [chatState, localPeerId]);\n  return <></>;\n};\n", "import { useEffect } from 'react';\nimport { useDebounce } from 'react-use';\nimport {\n  HMSNotificationTypes,\n  HMSRoomState,\n  selectHandRaisedPeers,\n  selectHasPeerHandRaised,\n  selectIsLocalScreenShared,\n  selectPeerByID,\n  selectRoomState,\n  useAwayNotifications,\n  useHMSNotifications,\n  useHMSStore,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\nimport { useRoomLayout } from '../../provider/roomLayoutProvider';\n// @ts-ignore: No implicit Any\nimport { ToastBatcher } from '../Toast/ToastBatcher';\nimport { useRoomLayoutConferencingScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { useSubscribedNotifications } from '../AppData/useUISettings';\nimport { SUBSCRIBED_NOTIFICATIONS } from '../../common/constants';\n\nexport const HandRaisedNotifications = () => {\n  const notification = useHMSNotifications(HMSNotificationTypes.HAND_RAISE_CHANGED);\n  const roomState = useHMSStore(selectRoomState);\n  const vanillaStore = useHMSVanillaStore();\n  const { on_stage_exp } = useRoomLayoutConferencingScreen().elements || {};\n  const isSubscribing = !!useSubscribedNotifications(SUBSCRIBED_NOTIFICATIONS.METADATA_UPDATED);\n  const amIScreenSharing = useHMSStore(selectIsLocalScreenShared);\n  const { showNotification } = useAwayNotifications();\n  const logoURL = useRoomLayout()?.logo?.url;\n\n  useEffect(() => {\n    if (!notification?.data) {\n      return;\n    }\n\n    // Don't show toast message in case of local peer.\n    if (roomState !== HMSRoomState.Connected || notification.data.isLocal || !isSubscribing) {\n      return;\n    }\n\n    const hasPeerHandRaised = vanillaStore.getState(selectHasPeerHandRaised(notification.data.id));\n    const peer = vanillaStore.getState(selectPeerByID(notification.data.id));\n    if (hasPeerHandRaised) {\n      const showCTA = peer?.roleName && (on_stage_exp?.off_stage_roles || [])?.includes(peer.roleName);\n      ToastBatcher.showToast({ notification, type: showCTA ? 'RAISE_HAND_HLS' : 'RAISE_HAND' });\n      console.debug('Metadata updated', notification.data);\n    }\n  }, [isSubscribing, notification, on_stage_exp, roomState, vanillaStore]);\n\n  useDebounce(\n    () => {\n      if (!notification?.data) {\n        return;\n      }\n\n      // Don't show toast message in case of local peer.\n      if (roomState !== HMSRoomState.Connected || notification.data.isLocal || !isSubscribing) {\n        return;\n      }\n\n      const hasPeerHandRaised = vanillaStore.getState(selectHasPeerHandRaised(notification.data.id));\n      const peer = vanillaStore.getState(selectPeerByID(notification.data.id));\n      const handRaisedPeers = vanillaStore.getState(selectHandRaisedPeers);\n      if (amIScreenSharing && hasPeerHandRaised) {\n        const title = `${peer?.name} ${\n          handRaisedPeers.length > 1 ? `and ${handRaisedPeers.length - 1} others` : ''\n        } raised hand`;\n        showNotification(title, { icon: logoURL });\n      }\n    },\n    1000,\n    [isSubscribing, notification, roomState, vanillaStore, amIScreenSharing],\n  );\n  return null;\n};\n", "import { ToastConfig } from './ToastConfig';\nimport { ToastManager } from './ToastManager';\n\nexport const ToastBatcher = {\n  toastsType: new Map(),\n  toastCache: {},\n  showToastInternal({ notification, duration, type }) {\n    let notificationType = type;\n    if (!type) {\n      notificationType = notification.type;\n    }\n    const toastType = this.toastsType.has(notificationType);\n    if (toastType) {\n      let { notifications } = this.toastsType.get(notificationType);\n      const { id } = this.toastsType.get(notificationType);\n      notifications.push(notification);\n      const toastObject = ToastConfig[notificationType].multiple(notifications);\n      const toastId = ToastManager.replaceToast(id, {\n        ...toastObject,\n        duration: duration,\n      });\n      this.toastsType.set(notificationType, {\n        id: toastId,\n        notifications: notifications,\n        duration: duration,\n      });\n    } else {\n      const toastObject = ToastConfig[notificationType].single(notification);\n      const toastId = ToastManager.addToast({\n        ...toastObject,\n        duration: duration,\n      });\n      let notifications = [];\n      notifications.push(notification);\n      this.toastsType.set(notificationType, {\n        id: toastId,\n        notifications: [...notifications],\n        duration: duration,\n      });\n    }\n  },\n  showToast({ notification, duration = 3000, type }) {\n    try {\n      if (!this.toastCache[notification.id]) {\n        this.showToastInternal({ notification, duration, type });\n      }\n      this.toastCache[notification.id] = true;\n      if (Object.keys(this.toastCache).length > 100) {\n        this.toastCache = {};\n      }\n    } catch (err) {\n      console.debug('Notifications', err);\n    }\n  },\n  syncUItoast(toastsDisplaying) {\n    for (const [toastType, toastInfo] of this.toastsType.entries()) {\n      if (!toastsDisplaying.find(toast => toast.id === toastInfo.id)) {\n        this.toastsType.delete(toastType);\n      }\n    }\n  },\n};\n\nToastManager.addListener(ToastBatcher.syncUItoast.bind(ToastBatcher));\n", "import React, { useCallback } from 'react';\nimport { selectPeerByID, useHMSActions, useHMSStore } from '@100mslive/react-sdk';\nimport {\n  ChatUnreadIcon,\n  ConnectivityIcon,\n  HandIcon,\n  PeopleAddIcon,\n  PeopleRemoveIcon,\n  PoorConnectivityIcon,\n} from '@100mslive/react-icons';\nimport { Button } from '../../../Button';\nimport { useRoomLayout } from '../../provider/roomLayoutProvider';\nimport { useIsSidepaneTypeOpen, useSidepaneToggle } from '../AppData/useSidepane';\nimport { SIDE_PANE_OPTIONS } from '../../common/constants';\n\nconst ChatAction = React.forwardRef((_, ref) => {\n  const toggleChat = useSidepaneToggle(SIDE_PANE_OPTIONS.CHAT);\n  const isChatOpen = useIsSidepaneTypeOpen(SIDE_PANE_OPTIONS.CHAT);\n\n  if (isChatOpen) {\n    return null;\n  }\n\n  return (\n    <Button outlined as=\"div\" variant=\"standard\" css={{ w: 'max-content' }} onClick={toggleChat} ref={ref}>\n      Open Chat\n    </Button>\n  );\n});\n\nconst HandRaiseAction = React.forwardRef(({ id = '', isSingleHandRaise = true }, ref) => {\n  const hmsActions = useHMSActions();\n  const toggleSidepane = useSidepaneToggle(SIDE_PANE_OPTIONS.PARTICIPANTS);\n  const isParticipantsOpen = useIsSidepaneTypeOpen(SIDE_PANE_OPTIONS.PARTICIPANTS);\n  const peer = useHMSStore(selectPeerByID(id));\n  const layout = useRoomLayout();\n  const {\n    bring_to_stage_label,\n    on_stage_role,\n    off_stage_roles = [],\n    skip_preview_for_role_change = false,\n  } = layout?.screens?.conferencing?.default?.elements.on_stage_exp || {};\n\n  const onClickHandler = useCallback(async () => {\n    if (isSingleHandRaise) {\n      hmsActions.changeRoleOfPeer(id, on_stage_role, skip_preview_for_role_change);\n      if (skip_preview_for_role_change) {\n        await hmsActions.lowerRemotePeerHand(id);\n      }\n    } else {\n      !isParticipantsOpen && toggleSidepane();\n    }\n  }, [\n    hmsActions,\n    id,\n    isParticipantsOpen,\n    isSingleHandRaise,\n    on_stage_role,\n    toggleSidepane,\n    skip_preview_for_role_change,\n  ]);\n\n  // show nothing if handRaise is single and peer role is not hls\n  if (isSingleHandRaise && (!peer || !off_stage_roles.includes(peer.roleName))) {\n    return null;\n  }\n  return (\n    <Button outlined as=\"div\" variant=\"standard\" css={{ w: 'max-content' }} onClick={onClickHandler} ref={ref}>\n      {isSingleHandRaise ? bring_to_stage_label : 'View'}\n    </Button>\n  );\n});\n\nexport const ToastConfig = {\n  PEER_JOINED: {\n    single: function (notification) {\n      return {\n        title: `${notification.data?.name} joined`,\n        icon: <PeopleAddIcon />,\n      };\n    },\n    multiple: function (notifications) {\n      return {\n        title: `${notifications[notifications.length - 1].data.name} and ${notifications.length - 1} others joined`,\n        icon: <PeopleAddIcon />,\n      };\n    },\n  },\n  PEER_LEFT: {\n    single: function (notification) {\n      return {\n        title: `${notification.data?.name} left`,\n        icon: <PeopleRemoveIcon />,\n      };\n    },\n    multiple: function (notifications) {\n      return {\n        title: `${notifications[notifications.length - 1].data.name} and ${notifications.length - 1} others left`,\n        icon: <PeopleRemoveIcon />,\n      };\n    },\n  },\n  RAISE_HAND: {\n    single: notification => {\n      return {\n        title: `${notification.data?.name} raised hand`,\n        icon: <HandIcon />,\n      };\n    },\n    multiple: notifications => {\n      const count = new Set(notifications.map(notification => notification.data?.id)).size;\n      return {\n        title: `${notifications[notifications.length - 1].data?.name} ${\n          count > 1 ? `and ${count} others` : ''\n        } raised hand`,\n        icon: <HandIcon />,\n      };\n    },\n  },\n  RAISE_HAND_HLS: {\n    single: notification => {\n      return {\n        title: `${notification.data?.name} raised hand`,\n        icon: <HandIcon />,\n        action: <HandRaiseAction id={notification.data?.id} />,\n      };\n    },\n    multiple: notifications => {\n      const count = new Set(notifications.map(notification => notification.data?.id)).size;\n      return {\n        title: `${notifications[notifications.length - 1].data?.name} ${\n          count > 1 ? `and ${count} others` : ''\n        } raised hand`,\n        icon: <HandIcon />,\n        action: <HandRaiseAction isSingleHandRaise={false} />,\n      };\n    },\n  },\n  NEW_MESSAGE: {\n    single: notification => {\n      return {\n        title: `New message from ${notification.data?.senderName}`,\n        icon: <ChatUnreadIcon />,\n        action: <ChatAction />,\n      };\n    },\n    multiple: notifications => {\n      return {\n        title: `${notifications.length} new messages`,\n        icon: <ChatUnreadIcon />,\n        action: <ChatAction />,\n      };\n    },\n  },\n  RECONNECTED: {\n    single: online => {\n      return {\n        title: `You are now ${online ? 'online' : 'connected'}`,\n        icon: <ConnectivityIcon />,\n        variant: 'success',\n        duration: 3000,\n      };\n    },\n  },\n  RECONNECTING: {\n    single: message => {\n      return {\n        title: `You are offline for now. while we try to reconnect, please check\n        your internet connection. ${message}.\n      `,\n        icon: <PoorConnectivityIcon />,\n        variant: 'warning',\n        duration: 30000,\n      };\n    },\n  },\n};\n", "import React, { useEffect, useState } from 'react';\nimport { HMSNotificationTypes, useHMSNotifications } from '@100mslive/react-sdk';\nimport { Text } from '../../..';\n// @ts-ignore: No implicit Any\nimport { ErrorDialog } from '../../primitives/DialogContent';\n\nexport const InitErrorModal = () => {\n  const notification = useHMSNotifications(HMSNotificationTypes.ERROR);\n  const [showModal, setShowModal] = useState(false);\n  const [info, setInfo] = useState({ title: 'Init Error', description: '' });\n\n  useEffect(() => {\n    const data = notification?.data;\n    if (!data || data.action !== 'INIT') {\n      return;\n    }\n    let description;\n    let title;\n    if (data.description.includes('role is invalid')) {\n      description = 'This role does not exist for the given room. Try again with a valid role.';\n      title = 'Invalid Role';\n    } else if (data.description.includes('room is not active')) {\n      title = 'Room is disabled';\n      description =\n        'This room is disabled and cannot be joined. To enable the room, use the 100ms dashboard or the API.';\n    } else {\n      description = data.description;\n      title = 'Init Error';\n    }\n    setInfo({ title, description });\n    setShowModal(true);\n  }, [notification]);\n\n  return (\n    <ErrorDialog open={showModal} onOpenChange={setShowModal} title={info.title}>\n      <Text variant=\"sm\" css={{ wordBreak: 'break-word' }}>\n        {info.description} <br />\n        Current URL - {window.location.href}\n      </Text>\n    </ErrorDialog>\n  );\n};\n", "import { useEffect } from 'react';\nimport { HMSNotificationTypes, useHMSNotifications } from '@100mslive/react-sdk';\n// @ts-ignore: No implicit Any\nimport { ToastBatcher } from '../Toast/ToastBatcher';\n// @ts-ignore: No implicit Any\nimport { useSetSubscribedChatSelector, useSubscribedNotifications } from '../AppData/useUISettings';\n// @ts-ignore: No implicit Any\nimport { CHAT_SELECTOR, SUBSCRIBED_NOTIFICATIONS } from '../../common/constants';\n\nconst notificationTypes = [HMSNotificationTypes.PEER_JOINED, HMSNotificationTypes.PEER_LEFT];\n\nexport const PeerNotifications = () => {\n  const notification = useHMSNotifications(notificationTypes);\n  const isPeerJoinSubscribed = useSubscribedNotifications(SUBSCRIBED_NOTIFICATIONS.PEER_JOINED);\n  const isPeerLeftSubscribed = useSubscribedNotifications(SUBSCRIBED_NOTIFICATIONS.PEER_LEFT);\n  const [selectedPeer, setPeerSelector] = useSetSubscribedChatSelector(CHAT_SELECTOR.PEER);\n\n  useEffect(() => {\n    if (!notification?.data) {\n      return;\n    }\n\n    console.debug(`[${notification.type}]`, notification);\n    switch (notification.type) {\n      case HMSNotificationTypes.PEER_JOINED:\n        if (!isPeerJoinSubscribed) {\n          return;\n        }\n        break;\n      case HMSNotificationTypes.PEER_LEFT:\n        if (selectedPeer.id === notification.data.id) {\n          setPeerSelector({});\n        }\n        if (!isPeerLeftSubscribed) {\n          return;\n        }\n        break;\n      default:\n        return;\n    }\n    ToastBatcher.showToast({ notification });\n  }, [notification, isPeerJoinSubscribed, isPeerLeftSubscribed, selectedPeer.id, setPeerSelector]);\n\n  return null;\n};\n", "import React, { useEffect, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport { HMSException, HMSNotificationTypes, useHMSNotifications } from '@100mslive/react-sdk';\nimport { Button, config as cssConfig, Dialog, Flex, Text } from '../../..';\n// @ts-ignore: No implicit Any\nimport androidPermissionAlert from '../../images/android-perm-1.png';\n// @ts-ignore: No implicit Any\nimport iosPermissions from '../../images/ios-perm-0.png';\n// @ts-ignore: No implicit Any\nimport { isAndroid, isIOS } from '../../common/constants';\n\nexport function PermissionErrorNotificationModal() {\n  const notification = useHMSNotifications(HMSNotificationTypes.ERROR);\n  return <PermissionErrorModal error={notification?.data} />;\n}\n\nexport const PermissionErrorModal = ({ error }: { error?: HMSException }) => {\n  const [deviceType, setDeviceType] = useState('');\n  const [isSystemError, setIsSystemError] = useState(false);\n  const isMobile = useMedia(cssConfig.media.md);\n  useEffect(() => {\n    if (\n      !error ||\n      (error?.code !== 3001 && error?.code !== 3011) ||\n      (error?.code === 3001 && error?.message.includes('screen'))\n    ) {\n      return;\n    }\n    const errorMessage = error?.message;\n    const hasAudio = errorMessage.includes('audio');\n    const hasVideo = errorMessage.includes('video');\n    const hasScreen = errorMessage.includes('screen');\n    if (hasAudio && hasVideo) {\n      setDeviceType('camera and microphone');\n    } else if (hasAudio) {\n      setDeviceType('microphone');\n    } else if (hasVideo) {\n      setDeviceType('camera');\n    } else if (hasScreen) {\n      setDeviceType('screen');\n    }\n    setIsSystemError(error.code === 3011);\n  }, [error]);\n\n  return deviceType ? (\n    <Dialog.Root open={!!deviceType}>\n      <Dialog.Portal>\n        <Dialog.Overlay />\n        <Dialog.Content\n          css={{\n            w: 'min(380px, 90%)',\n            p: '$8',\n            // overlay over Sheet.tsx\n            zIndex: 23,\n          }}\n        >\n          <Dialog.Title\n            css={{\n              borderBottom: '1px solid $border_default',\n            }}\n          >\n            {isMobile && isIOS ? (\n              <img style={{ maxWidth: '100%', maxHeight: '100%' }} src={iosPermissions} alt=\"iOS Permission flow\" />\n            ) : null}\n\n            {/* Images for android */}\n            {isMobile && isAndroid ? (\n              <img\n                src={androidPermissionAlert}\n                style={{ maxWidth: '100%', maxHeight: '100%' }}\n                alt=\"Android Permission flow \"\n              />\n            ) : null}\n\n            <Text variant=\"h6\">We can't access your {deviceType}</Text>\n          </Dialog.Title>\n\n          <Text variant=\"sm\" css={{ pt: '$4', pb: '$10', color: '$on_surface_medium' }}>\n            {/* IOS prompt text */}\n            {isMobile && isIOS\n              ? 'Enable permissions by reloading this page and clicking \"Allow\" on the pop-up, or change settings from the address bar.'\n              : null}\n\n            {/* Prompt for android devices */}\n            {isMobile && isAndroid\n              ? `To allow other users to see and hear you, click the blocked camera icon in your browser's address bar.`\n              : null}\n\n            {/* Prompt for desktops */}\n            {!isMobile ? `Access to ${deviceType} is required. ` : null}\n\n            {isSystemError && !isMobile\n              ? `Enable permissions for ${deviceType}${deviceType === 'screen' ? 'share' : ''} from sytem settings`\n              : null}\n            {!isSystemError && !isMobile\n              ? `Enable permissions for ${deviceType}${\n                  deviceType === 'screen' ? 'share' : ''\n                } from address bar or browser settings.`\n              : null}\n          </Text>\n\n          {/* CTA section */}\n          {isMobile && isIOS ? (\n            <>\n              <Button onClick={() => window.location.reload()} css={{ w: '100%', mb: '$6' }}>\n                Reload\n              </Button>\n              <Button outlined variant=\"standard\" onClick={() => setDeviceType('')} css={{ w: '100%' }}>\n                Continue anyway\n              </Button>\n            </>\n          ) : null}\n\n          {isMobile && isAndroid ? (\n            <>\n              <Button onClick={() => setDeviceType('')} css={{ w: '100%', mb: '$6' }}>\n                I've allowed access\n              </Button>\n              <Button outlined variant=\"standard\" onClick={() => setDeviceType('')} css={{ w: '100%' }}>\n                Continue anyway\n              </Button>\n            </>\n          ) : null}\n\n          {!isMobile ? (\n            <Flex justify=\"end\" css={{ w: '100%' }}>\n              <Button outlined variant=\"standard\" onClick={() => setDeviceType('')}>\n                Dismiss\n              </Button>\n            </Flex>\n          ) : null}\n        </Dialog.Content>\n      </Dialog.Portal>\n    </Dialog.Root>\n  ) : null;\n};\n", "import { useEffect, useRef } from 'react';\nimport { HMSNotificationTypes, useHMSNotifications } from '@100mslive/react-sdk';\n// @ts-ignore: No implicit Any\nimport { ToastConfig } from '../Toast/ToastConfig';\n// @ts-ignore: No implicit Any\nimport { ToastManager } from '../Toast/ToastManager';\n\nconst notificationTypes = [\n  HMSNotificationTypes.RECONNECTED,\n  HMSNotificationTypes.RECONNECTING,\n  HMSNotificationTypes.ERROR,\n];\nlet notificationId: string | null = null;\n\nexport const ReconnectNotifications = () => {\n  const notification = useHMSNotifications(notificationTypes);\n  const prevErrorCode = useRef(0);\n  useEffect(() => {\n    if (!notification) {\n      return;\n    }\n    if (notification.type === HMSNotificationTypes.RECONNECTED) {\n      notificationId = ToastManager.replaceToast(\n        notificationId,\n        ToastConfig.RECONNECTED.single([4005, 4006].includes(prevErrorCode.current)),\n      );\n    } else if (notification.type === HMSNotificationTypes.RECONNECTING) {\n      prevErrorCode.current = notification.data?.code || 0;\n      notificationId = ToastManager.replaceToast(\n        notificationId,\n        ToastConfig.RECONNECTING.single(notification.data?.message),\n      );\n    }\n  }, [notification]);\n\n  return null;\n};\n", "import React, { useEffect, useState } from 'react';\nimport {\n  HMSChangeMultiTrackStateRequest,\n  HMSNotificationTypes,\n  useHMSActions,\n  useHMSNotifications,\n} from '@100mslive/react-sdk';\nimport { MicOnIcon } from '@100mslive/react-icons';\n// @ts-ignore: No implicit Any\nimport { RequestDialog } from '../../primitives/DialogContent';\n\nexport const TrackBulkUnmuteModal = () => {\n  const hmsActions = useHMSActions();\n  const [muteNotification, setMuteNotification] = useState<HMSChangeMultiTrackStateRequest | null>(null);\n  const notification = useHMSNotifications([\n    HMSNotificationTypes.CHANGE_MULTI_TRACK_STATE_REQUEST,\n    HMSNotificationTypes.ROOM_ENDED,\n    HMSNotificationTypes.REMOVED_FROM_ROOM,\n  ]);\n\n  useEffect(() => {\n    switch (notification?.type) {\n      case HMSNotificationTypes.REMOVED_FROM_ROOM:\n      case HMSNotificationTypes.ROOM_ENDED:\n        setMuteNotification(null);\n        break;\n      case HMSNotificationTypes.CHANGE_MULTI_TRACK_STATE_REQUEST:\n        if (notification?.data.enabled) {\n          setMuteNotification(notification.data);\n        }\n        break;\n      default:\n        return;\n    }\n  }, [notification]);\n\n  if (!muteNotification) {\n    return null;\n  }\n\n  const { requestedBy: peer, tracks, enabled } = muteNotification;\n\n  const types = new Set(tracks.map(track => track.type));\n\n  return (\n    <RequestDialog\n      title=\"Unmute request\"\n      body={`${peer?.name} is requesting you to unmute your ${Array.from(types).join(',')}`}\n      onOpenChange={(value: boolean) => !value && setMuteNotification(null)}\n      onAction={() => {\n        tracks.forEach(track => {\n          hmsActions.setEnabledTrack(track.id, enabled);\n        });\n        setMuteNotification(null);\n      }}\n      Icon={MicOnIcon}\n    />\n  );\n};\n", "import { useEffect } from 'react';\nimport { HMSNotificationTypes, useHMSNotifications } from '@100mslive/react-sdk';\n\nconst notificationTypes = [\n  HMSNotificationTypes.TRACK_ADDED,\n  HMSNotificationTypes.TRACK_REMOVED,\n  HMSNotificationTypes.TRACK_MUTED,\n  HMSNotificationTypes.TRACK_UNMUTED,\n];\nexport const TrackNotifications = () => {\n  const notification = useHMSNotifications(notificationTypes);\n  useEffect(() => {\n    if (notification) {\n      console.debug(`[${notification.type}]`, notification);\n    }\n  }, [notification]);\n\n  return null;\n};\n", "import React, { useEffect, useState } from 'react';\nimport {\n  HMSChangeTrackStateRequest,\n  HMSNotificationTypes,\n  useHMSActions,\n  useHMSNotifications,\n} from '@100mslive/react-sdk';\nimport { MicOnIcon } from '@100mslive/react-icons';\n// @ts-ignore: No implicit Any\nimport { RequestDialog } from '../../primitives/DialogContent';\n\nexport const TrackUnmuteModal = () => {\n  const hmsActions = useHMSActions();\n  const notification = useHMSNotifications([\n    HMSNotificationTypes.CHANGE_TRACK_STATE_REQUEST,\n    HMSNotificationTypes.ROOM_ENDED,\n    HMSNotificationTypes.REMOVED_FROM_ROOM,\n  ]);\n  const [muteNotification, setMuteNotification] = useState<HMSChangeTrackStateRequest | null>(null);\n\n  useEffect(() => {\n    switch (notification?.type) {\n      case HMSNotificationTypes.REMOVED_FROM_ROOM:\n      case HMSNotificationTypes.ROOM_ENDED:\n        setMuteNotification(null);\n        break;\n      case HMSNotificationTypes.CHANGE_TRACK_STATE_REQUEST:\n        if (notification?.data.enabled) {\n          setMuteNotification(notification.data);\n        }\n        break;\n      default:\n        return;\n    }\n  }, [notification]);\n\n  if (!muteNotification) {\n    return null;\n  }\n\n  const { requestedBy: peer, track, enabled } = muteNotification;\n\n  return (\n    <RequestDialog\n      title={`Unmute your ${track.type}?`}\n      onOpenChange={(value: boolean) => !value && setMuteNotification(null)}\n      body={`${peer?.name}is requesting you to unmute your ${track?.type}.`}\n      onAction={() => {\n        hmsActions.setEnabledTrack(track.id, enabled);\n        setMuteNotification(null);\n      }}\n      Icon={MicOnIcon}\n    />\n  );\n};\n", "import React, { useEffect } from 'react';\nimport { match } from 'ts-pattern';\nimport { HMSNotificationTypes, HMSTranscriptionState, useHMSNotifications } from '@100mslive/react-sdk';\nimport { AlertTriangleIcon, ClosedCaptionIcon, OpenCaptionIcon } from '@100mslive/react-icons';\n// @ts-ignore: No implicit Any\nimport { ToastManager } from '../Toast/ToastManager';\n// @ts-ignore: No implicit Any\nimport { useSetAppDataByKey } from '../AppData/useUISettings';\nimport { CAPTION_TOAST } from '../../common/constants';\n\nexport const TranscriptionNotifications = () => {\n  const notification = useHMSNotifications(HMSNotificationTypes.TRANSCRIPTION_STATE_UPDATED);\n  const [toastId, setToastId] = useSetAppDataByKey(CAPTION_TOAST.captionToast);\n\n  useEffect(() => {\n    if (!notification?.data) {\n      return;\n    }\n\n    console.debug(`[${notification.type}]`, notification);\n    const transcriptionStates = notification.data;\n    if (transcriptionStates.length > 0) {\n      let id = '';\n      match({ state: transcriptionStates[0].state, error: transcriptionStates[0].error })\n        .when(\n          ({ error }) => !!error,\n          () => {\n            id = ToastManager.replaceToast(toastId, {\n              title: `Failed to enable Closed Caption`,\n              variant: 'error',\n              icon: <AlertTriangleIcon style={{ marginRight: '0.5rem' }} />,\n            });\n          },\n        )\n        .with({ state: HMSTranscriptionState.STARTED }, () => {\n          id = ToastManager.replaceToast(toastId, {\n            title: `Closed Captioning enabled for everyone`,\n            variant: 'standard',\n            duration: 2000,\n            icon: <ClosedCaptionIcon style={{ marginRight: '0.5rem' }} />,\n          });\n        })\n        .with({ state: HMSTranscriptionState.STOPPED }, () => {\n          id = ToastManager.replaceToast(toastId, {\n            title: `Closed Captioning disabled for everyone`,\n            variant: 'standard',\n            duration: 2000,\n            icon: <OpenCaptionIcon style={{ marginRight: '0.5rem' }} />,\n          });\n        })\n        .otherwise(() => null);\n      setToastId(id);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [notification, setToastId]);\n\n  return null;\n};\n", "import React, { useCallback, useMemo, useState } from 'react';\nimport { PIPContext } from './context';\n\ntype PIPProviderProps = {\n  children: React.ReactNode;\n};\n\nexport const PIPProvider = ({ children }: PIPProviderProps) => {\n  // Detect if the feature is available.\n  const isSupported = 'documentPictureInPicture' in window;\n\n  // Expose pipWindow that is currently active\n  const [pipWindow, setPipWindow] = useState<Window | null>(null);\n\n  // Close pipWidnow programmatically\n  const closePipWindow = useCallback(() => {\n    if (pipWindow != null) {\n      pipWindow.close();\n      setPipWindow(null);\n    }\n  }, [pipWindow]);\n\n  // Open new pipWindow\n  const requestPipWindow = useCallback(\n    async (width: number, height: number) => {\n      // We don't want to allow multiple requests.\n      if (pipWindow != null) {\n        return;\n      }\n      // @ts-ignore for documentPIP\n      const pip = await window.documentPictureInPicture.requestWindow({\n        width,\n        height,\n      });\n\n      // Detect when window is closed by user\n      pip.addEventListener('pagehide', () => {\n        setPipWindow(null);\n      });\n\n      setPipWindow(pip);\n    },\n    [pipWindow],\n  );\n\n  const value = useMemo(() => {\n    return {\n      isSupported,\n      pipWindow,\n      requestPipWindow,\n      closePipWindow,\n    };\n  }, [closePipWindow, isSupported, pipWindow, requestPipWindow]);\n\n  return <PIPContext.Provider value={value}>{children}</PIPContext.Provider>;\n};\n", "import React from 'react';\nimport { useSearchParam } from 'react-use';\nimport { Flex } from '../../..';\nimport { useHMSPrebuiltContext } from '../../AppContext';\nimport { useRoomLayout } from '../../provider/roomLayoutProvider';\nimport FullPageProgress from '../FullPageProgress';\nimport PreviewJoin from './PreviewJoin';\nimport { useRoomLayoutPreviewScreen } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\n// @ts-ignore: No implicit Any\nimport { useAuthToken } from '../AppData/useUISettings';\nimport { QUERY_PARAM_PREVIEW_AS_ROLE } from '../../common/constants';\n\nexport const PreviewScreen = () => {\n  const { isPreviewScreenEnabled } = useRoomLayoutPreviewScreen();\n  const skipPreview = !isPreviewScreenEnabled;\n  const previewAsRole = useSearchParam(QUERY_PARAM_PREVIEW_AS_ROLE);\n  const { userName } = useHMSPrebuiltContext();\n  const initialName = userName || (skipPreview ? 'Beam' : '');\n  const authToken = useAuthToken();\n  const roomLayout = useRoomLayout();\n  const { preview_header: previewHeader = {} } = roomLayout?.screens?.preview?.default?.elements || {};\n\n  return (\n    <Flex direction=\"column\" css={{ size: '100%' }}>\n      <Flex\n        css={{ flex: '1 1 0', position: 'relative', overflowY: 'auto', color: '$primary_default' }}\n        justify=\"center\"\n        align=\"center\"\n      >\n        {authToken && Object.keys(previewHeader).length > 0 ? (\n          <PreviewJoin initialName={initialName} skipPreview={skipPreview} asRole={previewAsRole ?? undefined} />\n        ) : (\n          <FullPageProgress />\n        )}\n      </Flex>\n    </Flex>\n  );\n};\n", "import React, { useEffect, useState } from 'react';\nimport { selectIsConnectedToRoom, useHMSStore } from '@100mslive/react-sdk';\nimport { Toast as ToastPrimitive } from '../../../Toast';\nimport { Toast } from './Toast';\nimport { ToastManager } from './ToastManager';\nimport { MAX_TOASTS } from '../../common/constants';\n\nexport const ToastContainer = () => {\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const [toasts, setToast] = useState([]);\n  useEffect(() => {\n    ToastManager.addListener(setToast);\n    return () => {\n      ToastManager.removeListener(setToast);\n    };\n  }, []);\n  return (\n    <ToastPrimitive.Provider swipeDirection=\"left\" duration={3000}>\n      {toasts.slice(0, MAX_TOASTS).map(toast => {\n        return <Toast key={toast.id} {...toast} onOpenChange={value => !value && ToastManager.removeToast(toast.id)} />;\n      })}\n      <ToastPrimitive.Viewport\n        css={{\n          position: 'absolute',\n          ...(!isConnected ? {} : { bottom: '$24' }),\n        }}\n      />\n    </ToastPrimitive.Provider>\n  );\n};\n", "import React from 'react';\nimport { Toast as ToastPrimitive } from '../../../Toast';\n\nexport const Toast = ({ title, description, close = true, open, duration, onOpenChange, icon, ...props }) => {\n  return (\n    <ToastPrimitive.HMSToast\n      title={title}\n      description={description}\n      open={open}\n      isClosable={close}\n      onOpenChange={onOpenChange}\n      duration={!close ? 600000 : duration}\n      icon={icon}\n      {...props}\n    />\n  );\n};\n", "import React from 'react';\nimport { selectAppData, useHMSStore } from '@100mslive/react-sdk';\nimport { RoomDetailsSheet } from '../components/RoomDetails/RoomDetailsSheet';\nimport { Box } from '../../Layout';\nimport { APP_DATA, SHEET_OPTIONS } from '../common/constants';\n\nexport const Sheet = () => {\n  const sheet = useHMSStore(selectAppData(APP_DATA.sheet));\n  let ViewComponent;\n  if (sheet === SHEET_OPTIONS.ROOM_DETAILS) {\n    ViewComponent = <RoomDetailsSheet />;\n  }\n  return <Box>{ViewComponent}</Box>;\n};\n", "import React from 'react';\nimport { CrossIcon } from '@100mslive/react-icons';\nimport { Box, Flex } from '../../../Layout';\nimport { Sheet } from '../../../Sheet';\nimport { Text } from '../../../Text';\n// @ts-ignore\nimport { Logo } from '../Header/HeaderComponents';\nimport { RoomDetailsRow } from './RoomDetailsRow';\nimport { useRoomLayoutHeader } from '../../provider/roomLayoutProvider/hooks/useRoomLayoutScreen';\nimport { useIsSheetTypeOpen, useSheetToggle } from '../AppData/useSheet';\nimport { SHEET_OPTIONS } from '../../common/constants';\n\nexport const RoomDetailsSheet = () => {\n  const { title, description, details } = useRoomLayoutHeader();\n  const toggleSheet = useSheetToggle(SHEET_OPTIONS.ROOM_DETAILS);\n  const showRoomDetailsSheet = useIsSheetTypeOpen(SHEET_OPTIONS.ROOM_DETAILS);\n  return (\n    <Sheet.Root open={showRoomDetailsSheet} onOpenChange={toggleSheet}>\n      <Sheet.Content css={{ py: '$8', pb: '$12' }}>\n        <Flex\n          justify=\"between\"\n          align=\"center\"\n          css={{ w: '100%', borderBottom: '1px solid $border_bright', pb: '$4', mb: '$4', px: '$8' }}\n        >\n          <Text css={{ fontWeight: '$semiBold', color: '$on_surface_high' }}>Description</Text>\n          <Sheet.Close css={{ color: '$on_surface_high' }}>\n            <CrossIcon />\n          </Sheet.Close>\n        </Flex>\n        <Flex align=\"center\" css={{ w: '100%', gap: '$4', pb: '$8', px: '$8' }}>\n          <Logo />\n          <Box>\n            <Text variant=\"sm\" css={{ c: '$on_secondary_high', fontWeight: '$semiBold' }}>\n              {title}\n            </Text>\n            <RoomDetailsRow details={details} />\n          </Box>\n        </Flex>\n        <Text variant=\"sm\" css={{ color: '$on_surface_medium', px: '$8' }}>\n          {description}\n        </Text>\n      </Sheet.Content>\n    </Sheet.Root>\n  );\n};\n", "import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useMedia } from 'react-use';\nimport {\n  selectIsLargeRoom,\n  selectLocalPeerID,\n  selectPeerNameByID,\n  useCustomEvent,\n  useHMSActions,\n  useHMSStore,\n  useHMSVanillaStore,\n} from '@100mslive/react-sdk';\nimport { Box, Flex } from '../../Layout';\nimport { Text } from '../../Text';\nimport { config as cssConfig, keyframes } from '../../Theme';\nimport { EMOJI_REACTION_TYPE } from '../common/constants';\n\nlet emojiCount = 1;\n\nconst flyAndFade = keyframes({\n  '20%': { opacity: 1 },\n  '100%': { bottom: '60%', opacity: 0 },\n});\n\nconst wiggleLeftRight = keyframes({\n  '0%': { marginLeft: '-50px' },\n  '100%': { marginLeft: '50px' },\n});\n\nconst wiggleRightLeft = keyframes({\n  '0%': { marginLeft: '50px' },\n  '100%': { marginLeft: '-50px' },\n});\n\nconst getStartingPoints = isMobile => {\n  let arr = [];\n  const min = 5;\n  const max = isMobile ? 30 : 20;\n  const inc = isMobile ? 8 : 5;\n  for (let i = min; i <= max; i += inc) {\n    arr.push(i);\n  }\n  return arr;\n};\n\nexport function FlyingEmoji() {\n  const localPeerId = useHMSStore(selectLocalPeerID);\n  const vanillaStore = useHMSVanillaStore();\n  const hmsActions = useHMSActions();\n  const [emojis, setEmojis] = useState([]);\n  const isMobile = useMedia(cssConfig.media.md);\n  const isLargeRoom = useHMSStore(selectIsLargeRoom);\n\n  const startingPoints = useMemo(() => getStartingPoints(isMobile), [isMobile]);\n\n  const showFlyingEmoji = useCallback(\n    async ({ emojiId, senderId }) => {\n      if (!emojiId || !senderId || document.hidden) {\n        return;\n      }\n      let senderPeerName = vanillaStore.getState(selectPeerNameByID(senderId));\n      if (!senderPeerName && isLargeRoom) {\n        const sender = await hmsActions.getPeer(senderId);\n        senderPeerName = sender?.name;\n      }\n      const nameToShow = localPeerId === senderId ? 'You' : senderPeerName;\n      const startingPoint = startingPoints[emojiCount % startingPoints.length];\n      const id = emojiCount++;\n\n      setEmojis(emojis => {\n        return [\n          ...emojis,\n          {\n            id: id,\n            emojiId: emojiId,\n            senderName: nameToShow,\n            startingPoint: `${startingPoint}%`,\n            wiggleType: Math.random() < 0.5 ? 0 : 1,\n          },\n        ];\n      });\n    },\n    [vanillaStore, isLargeRoom, localPeerId, startingPoints, hmsActions],\n  );\n\n  useCustomEvent({\n    type: EMOJI_REACTION_TYPE,\n    onEvent: showFlyingEmoji,\n  });\n\n  useEffect(() => {\n    window.showFlyingEmoji = showFlyingEmoji;\n  }, [showFlyingEmoji]);\n\n  return (\n    <Box\n      css={{\n        position: 'absolute',\n        top: 0,\n        bottom: 0,\n        left: 0,\n        right: 0,\n        overflow: 'hidden',\n        pointerEvents: 'none',\n        userSelect: 'none',\n        zIndex: 999,\n      }}\n    >\n      {emojis.map(emoji => {\n        return (\n          <Flex\n            key={emoji.id}\n            css={{\n              left: emoji.startingPoint,\n              flexDirection: 'column',\n              alignItems: 'center',\n              position: 'absolute',\n              bottom: 0,\n              animation: `${flyAndFade()} 5s forwards, ${\n                emoji.wiggleType === 0 ? wiggleLeftRight() : wiggleRightLeft()\n              } 1s ease-in-out infinite alternate`,\n            }}\n            onAnimationEnd={() => setEmojis(emojis.filter(item => item.id !== emoji.id))}\n          >\n            <Box>\n              <em-emoji id={emoji.emojiId} size=\"48px\" set=\"apple\" />\n            </Box>\n            {emoji.senderName ? (\n              <Box\n                css={{\n                  width: 'fit-content',\n                  padding: '$2 $4',\n                  background: '$surface_bright',\n                  borderRadius: '$1',\n                }}\n              >\n                <Text\n                  css={{\n                    fontSize: '$space$6',\n                    lineHeight: '$xs',\n                    color: '$on_surface_high',\n                  }}\n                >\n                  {emoji.senderName}\n                </Text>\n              </Box>\n            ) : (\n              ''\n            )}\n          </Flex>\n        );\n      })}\n    </Box>\n  );\n}\n", "import React, { useCallback } from 'react';\nimport { useCustomEvent, useHMSActions } from '@100mslive/react-sdk';\nimport { REMOTE_STOP_SCREENSHARE_TYPE } from '../common/constants';\n\nexport function RemoteStopScreenshare() {\n  const actions = useHMSActions();\n\n  const onRemoteStopScreenshare = useCallback(async () => {\n    await actions.setScreenShareEnabled(false);\n  }, [actions]);\n\n  useCustomEvent({\n    type: REMOTE_STOP_SCREENSHARE_TYPE,\n    onEvent: onRemoteStopScreenshare,\n  });\n\n  return <></>;\n}\n", "import { useCallback, useEffect, useRef } from 'react';\nimport {\n  selectIsConnectedToRoom,\n  selectPermissions,\n  useHMSActions,\n  useHMSStore,\n  useRecordingStreaming,\n} from '@100mslive/react-sdk';\n// @ts-ignore: No implicit Any\nimport { useSetAppDataByKey } from '../AppData/useUISettings';\n// @ts-ignore: No implicit Any\nimport { useShowStreamingUI } from '../../common/hooks';\n// @ts-ignore: No implicit Any\nimport { APP_DATA } from '../../common/constants';\n\nexport const useAutoStartStreaming = () => {\n  const [isHLSStarted, setHLSStarted] = useSetAppDataByKey(APP_DATA.hlsStarted);\n  const permissions = useHMSStore(selectPermissions);\n  const showStreamingUI = useShowStreamingUI();\n  const hmsActions = useHMSActions();\n  const isConnected = useHMSStore(selectIsConnectedToRoom);\n  const { isHLSRunning, isRTMPRunning, isHLSRecordingOn, isBrowserRecordingOn } = useRecordingStreaming();\n  const streamStartedRef = useRef(false);\n\n  const startHLS = useCallback(async () => {\n    try {\n      if (\n        isHLSStarted ||\n        !showStreamingUI ||\n        isHLSRunning ||\n        isRTMPRunning ||\n        isHLSRecordingOn ||\n        isBrowserRecordingOn\n      ) {\n        return;\n      }\n      setHLSStarted(true);\n      streamStartedRef.current = true;\n      await hmsActions.startHLSStreaming();\n    } catch (error) {\n      console.error(error);\n      streamStartedRef.current = false;\n      setHLSStarted(false);\n    }\n  }, [\n    hmsActions,\n    isHLSRunning,\n    isHLSStarted,\n    setHLSStarted,\n    showStreamingUI,\n    isRTMPRunning,\n    isHLSRecordingOn,\n    isBrowserRecordingOn,\n  ]);\n\n  useEffect(() => {\n    if (!isHLSStarted && !isHLSRunning) {\n      streamStartedRef.current = false;\n    }\n  }, [isHLSStarted, isHLSRunning]);\n\n  useEffect(() => {\n    if (!isConnected || streamStartedRef.current || !permissions?.hlsStreaming) {\n      return;\n    }\n    // Is a streaming kit and peer with streaming permissions joins\n    startHLS();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isConnected]);\n};\n", "import { Indicator, Root } from '@radix-ui/react-progress';\nimport { styled } from '../Theme';\n\nconst StyledIndicator = styled(Indicator, { h: '$4', backgroundColor: '$primary_default' });\n\nconst StyledRoot = styled(Root, {\n  w: '100%',\n  h: '$4',\n  borderRadius: '$round',\n  backgroundColor: '$secondary_dim',\n  overflow: 'hidden',\n});\n\nexport const Progress = {\n  Root: StyledRoot,\n  Content: StyledIndicator,\n};\n", "export { Diagnostics } from './Diagnostics';\n", "import React, { useCallback, useRef, useState } from 'react';\nimport { HMSRoomProvider, useHMSActions } from '@100mslive/react-sdk';\nimport {\n  CheckCircleIcon,\n  ConnectivityIcon,\n  CrossCircleIcon,\n  GlobeIcon,\n  MicOnIcon,\n  VideoOnIcon,\n} from '@100mslive/react-icons';\nimport { Box, Flex } from '../Layout';\nimport { Text } from '../Text';\nimport { HMSThemeProvider } from '../Theme';\nimport { AudioTest } from './AudioTest';\nimport { BrowserTest } from './BrowserTest';\nimport { ConnectivityTest } from './ConnectivityTest';\nimport {\n  DiagnosticsContext,\n  DiagnosticsStep,\n  DiagnosticsStepInfo,\n  initialSteps,\n  useDiagnostics,\n} from './DiagnosticsContext';\nimport { VideoTest } from './VideoTest';\n\nconst DiagnosticsStepIcon: Record<DiagnosticsStep, React.ReactNode> = {\n  [DiagnosticsStep.VIDEO]: <VideoOnIcon width=\"2rem\" height=\"2rem\" />,\n  [DiagnosticsStep.AUDIO]: <MicOnIcon width=\"2rem\" height=\"2rem\" />,\n  [DiagnosticsStep.BROWSER]: <GlobeIcon width=\"2rem\" height=\"2rem\" />,\n  [DiagnosticsStep.CONNECTIVITY]: <ConnectivityIcon width=\"2rem\" height=\"2rem\" />,\n};\n\nconst Container = ({ children }: { children: React.ReactNode }) => (\n  <Box\n    css={{\n      px: '120px',\n      pt: '120px',\n      pb: '24px',\n      bg: '$background_dim',\n      lineHeight: '1.5',\n      '-webkit-text-size-adjust': '100%',\n      position: 'relative',\n      h: '100%',\n      '@lg': {\n        p: '$12',\n      },\n      overflowY: 'auto',\n      boxSizing: 'border-box',\n      '& *': {\n        boxSizing: 'border-box',\n      },\n      '::-webkit-scrollbar-track': {\n        WebkitBoxShadow: 'inset 0 0 6px rgba(0, 0, 0, 0.3)',\n        boxShadow: 'inset 0 0 6px rgba(0, 0, 0, 0.3)',\n        backgroundColor: 'transparent',\n      },\n      '::-webkit-scrollbar': {\n        width: '6px',\n        height: '6px',\n        backgroundColor: 'transparent',\n      },\n      '::-webkit-scrollbar-thumb': {\n        backgroundColor: '#657080',\n        borderRadius: '5px',\n      },\n    }}\n  >\n    {children}\n  </Box>\n);\n\nconst DiagnosticsStepTest = () => {\n  const { activeStepIndex } = useDiagnostics();\n\n  let TestComponent = () => <></>;\n\n  if (activeStepIndex === DiagnosticsStep.AUDIO) {\n    TestComponent = AudioTest;\n  } else if (activeStepIndex === DiagnosticsStep.VIDEO) {\n    TestComponent = VideoTest;\n  } else if (activeStepIndex === DiagnosticsStep.BROWSER) {\n    TestComponent = BrowserTest;\n  } else if (activeStepIndex === DiagnosticsStep.CONNECTIVITY) {\n    TestComponent = ConnectivityTest;\n  }\n\n  return <TestComponent key={activeStepIndex} />;\n};\n\nconst DiagnosticsStepHeader = () => {\n  const { activeStepIndex, activeStep } = useDiagnostics();\n  return (\n    <Flex css={{ py: '$8', px: '$10', alignItems: 'center', borderBottom: '1px solid $border_default' }}>\n      <Text css={{ c: '$primary_bright', mt: '$xs' }}>{DiagnosticsStepIcon[activeStepIndex]}</Text>\n      <Text css={{ fontSize: '$h6', ml: '$9' }}>{activeStep.name}</Text>\n    </Flex>\n  );\n};\n\nconst DiagnosticsStepContainer = () => {\n  return (\n    <Box css={{ border: '1px solid $border_default', r: '$1', w: '75%', maxWidth: '65rem', '@lg': { w: '100%' } }}>\n      <DiagnosticsStepHeader />\n      <DiagnosticsStepTest />\n    </Box>\n  );\n};\n\nconst DiagnosticsStepsList = () => {\n  const { activeStepIndex, activeStep, steps } = useDiagnostics();\n\n  return (\n    <Box css={{ w: '25%', '@lg': { display: 'none' } }}>\n      {Object.keys(DiagnosticsStep)\n        .filter(key => !isNaN(Number(key)))\n        .map(key => {\n          const keyIndex = Number(key);\n          const step = steps[keyIndex as DiagnosticsStep];\n          const isStepCompleted = activeStepIndex > keyIndex || activeStep.isCompleted;\n\n          let color = '$on_primary_low';\n          let icon = <Text css={{ c: color, fontSize: '1.75rem' }}>&bull;</Text>;\n\n          if (activeStepIndex === keyIndex) {\n            color = '$on_primary_high';\n            icon = <Text css={{ c: color, fontSize: '1.75rem' }}>&bull;</Text>;\n          }\n          if (isStepCompleted) {\n            color = '$primary_bright';\n            icon = <CheckCircleIcon width=\"1rem\" height=\"1rem\" />;\n          }\n          if (step.hasFailed) {\n            color = '$alert_error_default';\n            icon = <CrossCircleIcon width=\"1rem\" height=\"1rem\" />;\n          }\n\n          return (\n            <Flex key={key} css={{ mb: '$10', c: color, gap: '$4', alignItems: 'center' }}>\n              {icon}\n              <Text css={{ c: color }}>{step.name}</Text>\n            </Flex>\n          );\n        })}\n    </Box>\n  );\n};\n\nconst DiagnosticsProvider = () => {\n  const actions = useHMSActions();\n  const [activeStep, setActiveStep] = useState(0);\n  const [steps, setSteps] = useState(initialSteps);\n  const diagnosticsRef = useRef(actions.initDiagnostics());\n\n  const updateStep = useCallback((step: DiagnosticsStep, value: Omit<DiagnosticsStepInfo, 'name'>) => {\n    setSteps(prevSteps => ({ ...prevSteps, [step]: { ...prevSteps[step], ...value } }));\n  }, []);\n\n  return (\n    <DiagnosticsContext.Provider\n      value={{\n        hmsDiagnostics: diagnosticsRef.current,\n        activeStepIndex: activeStep,\n        setActiveStep,\n        steps,\n        updateStep,\n      }}\n    >\n      <Container>\n        <Text variant=\"h4\">Pre-call Test</Text>\n        <Text variant=\"md\" css={{ c: '$on_primary_medium' }}>\n          Make sure your devices and network are good to go, let's get started.\n        </Text>\n        <Flex css={{ direction: 'column', mt: '$12', justifyItems: 'center' }}>\n          <DiagnosticsStepsList />\n          <DiagnosticsStepContainer />\n        </Flex>\n      </Container>\n    </DiagnosticsContext.Provider>\n  );\n};\n\nexport const Diagnostics = () => {\n  return (\n    <HMSRoomProvider>\n      <HMSThemeProvider themeType=\"default\">\n        <DiagnosticsProvider />\n      </HMSThemeProvider>\n    </HMSRoomProvider>\n  );\n};\n", "/* eslint-disable react/prop-types */\nimport React, { useCallback, useEffect, useState } from 'react';\nimport {\n  HMSException,\n  selectDevices,\n  selectLocalAudioTrackID,\n  selectLocalMediaSettings,\n  selectTrackAudioByID,\n  useHMSActions,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { MicOnIcon, SpeakerIcon, StopIcon } from '@100mslive/react-icons';\nimport { PermissionErrorModal } from '../Prebuilt/components/Notifications/PermissionErrorModal';\nimport { TestContainer, TestFooter } from './components';\nimport { Button } from '../Button';\nimport { Box, Flex } from '../Layout';\nimport { Progress } from '../Progress';\nimport { Text } from '../Text';\n// @ts-ignore: No implicit any\nimport { DeviceSelector } from './DeviceSelector';\nimport { DiagnosticsStep, useDiagnostics } from './DiagnosticsContext';\nimport { useAudioOutputTest } from '../Prebuilt/components/hooks/useAudioOutputTest';\nimport { TEST_AUDIO_URL } from '../Prebuilt/common/constants';\n\nconst SelectContainer = ({ children }: { children: React.ReactNode }) => (\n  <Box css={{ w: 'calc(50% - 0.75rem)', '@lg': { w: '100%' } }}>{children}</Box>\n);\n\nconst MicTest = ({ setError }: { setError: (err?: Error) => void }) => {\n  const { hmsDiagnostics } = useDiagnostics();\n  const devices = useHMSStore(selectDevices);\n  const [isRecording, setIsRecording] = useState(false);\n  const [selectedMic, setSelectedMic] = useState(devices.audioInput[0]?.deviceId || 'default');\n  const trackID = useHMSStore(selectLocalAudioTrackID);\n  const audioLevel = useHMSStore(selectTrackAudioByID(trackID));\n  const { audioOutputDeviceId } = useHMSStore(selectLocalMediaSettings);\n  const { playing, setPlaying, audioRef } = useAudioOutputTest({\n    deviceId: audioOutputDeviceId || devices.audioOutput[0]?.deviceId,\n  });\n\n  return (\n    <SelectContainer>\n      <DeviceSelector\n        title=\"Microphone (Input)\"\n        devices={devices.audioInput}\n        selection={selectedMic}\n        icon={<MicOnIcon />}\n        onChange={(deviceId: string) => {\n          setError(undefined);\n          setSelectedMic(deviceId);\n          hmsDiagnostics?.stopMicCheck();\n        }}\n      />\n      <Flex css={{ gap: '$6', alignItems: 'center' }}>\n        <Button\n          variant=\"standard\"\n          icon\n          onClick={() => {\n            isRecording\n              ? hmsDiagnostics?.stopMicCheck()\n              : hmsDiagnostics\n                  ?.startMicCheck({\n                    inputDevice: selectedMic,\n                    onError: (err: Error) => {\n                      setError(err);\n                    },\n                    onStop: () => {\n                      setIsRecording(false);\n                    },\n                  })\n                  .then(() => {\n                    setIsRecording(true);\n                  });\n          }}\n          disabled={devices.audioInput.length === 0 || playing}\n        >\n          {isRecording ? <StopIcon /> : <MicOnIcon />}\n          {isRecording ? 'Stop Recording' : 'Record'}\n        </Button>\n\n        <Button\n          icon\n          variant=\"standard\"\n          outlined={hmsDiagnostics?.getRecordedAudio() === TEST_AUDIO_URL}\n          onClick={() => {\n            if (audioRef.current) {\n              audioRef.current.src = hmsDiagnostics?.getRecordedAudio() || '';\n              audioRef.current.play();\n            }\n          }}\n          disabled={playing || hmsDiagnostics?.getRecordedAudio() === TEST_AUDIO_URL}\n        >\n          <SpeakerIcon />\n          {playing ? 'Playing...' : 'Playback'}\n        </Button>\n        <audio\n          ref={audioRef}\n          onEnded={() => setPlaying(false)}\n          onPlay={() => setPlaying(true)}\n          style={{ display: 'none' }}\n        />\n      </Flex>\n\n      <Flex align=\"center\" css={{ mt: '$4', maxWidth: '10rem', opacity: isRecording ? '1' : '0', gap: '$4' }}>\n        <Text>\n          <MicOnIcon />\n        </Text>\n        <Progress.Root value={audioLevel} css={{ h: '$2' }}>\n          <Progress.Content\n            style={{\n              transform: `translateX(-${100 - audioLevel}%)`,\n              transition: 'transform 0.3s',\n            }}\n          />\n        </Progress.Root>\n      </Flex>\n    </SelectContainer>\n  );\n};\n\nconst SpeakerTest = () => {\n  const actions = useHMSActions();\n  const devices = useHMSStore(selectDevices);\n  const { audioOutputDeviceId } = useHMSStore(selectLocalMediaSettings);\n\n  if (devices.audioOutput.length === 0) {\n    return <></>;\n  }\n\n  return (\n    <SelectContainer>\n      <DeviceSelector\n        title=\"Speaker (Output)\"\n        devices={devices.audioOutput}\n        selection={audioOutputDeviceId || devices.audioOutput[0]?.deviceId}\n        icon={<SpeakerIcon />}\n        onChange={(deviceId: string) => {\n          actions.setAudioOutputDevice(deviceId);\n        }}\n      />\n    </SelectContainer>\n  );\n};\n\nexport const AudioTest = () => {\n  const { hmsDiagnostics, updateStep } = useDiagnostics();\n  const [error, setErrorAlone] = useState<Error | undefined>();\n\n  const setError = useCallback(\n    (err?: Error) => {\n      updateStep(DiagnosticsStep.AUDIO, { hasFailed: !!err });\n      setErrorAlone(err);\n    },\n    [updateStep, setErrorAlone],\n  );\n\n  useEffect(() => {\n    hmsDiagnostics?.requestPermission({ audio: true }).catch(error => setError(error));\n  }, [hmsDiagnostics, setError]);\n\n  return (\n    <>\n      <TestContainer>\n        <Text variant=\"body2\" css={{ c: '$on_primary_medium' }}>\n          Record a 10 second audio clip and play it back to check that your microphone and speaker are working. If they\n          aren't, make sure your volume is turned up, try a different speaker or microphone, or check your bluetooth\n          settings.\n        </Text>\n\n        <Flex\n          css={{\n            mt: '$10',\n            gap: '$10',\n            '@lg': {\n              flexDirection: 'column',\n              gap: '$8',\n            },\n          }}\n        >\n          <MicTest setError={setError} />\n          <SpeakerTest />\n        </Flex>\n      </TestContainer>\n      <TestFooter error={error} ctaText=\"Does your audio sound good?\" />\n      <PermissionErrorModal error={error as HMSException} />\n    </>\n  );\n};\n", "import React from 'react';\nimport { Button } from '../Button';\nimport { Box, Flex } from '../Layout';\nimport { Text } from '../Text';\nimport { CSS } from '../Theme';\nimport { DiagnosticsStep, useDiagnostics } from './DiagnosticsContext';\n\nexport const TestContainer = ({ css, children }: { css?: CSS; children: React.ReactNode }) => {\n  return <Box css={{ p: '$10', ...css }}>{children}</Box>;\n};\n\nexport const TestFooter = ({\n  error,\n  ctaText,\n  children,\n}: {\n  ctaText?: string;\n  error?: Error;\n  children?: React.ReactNode;\n}) => {\n  const { hmsDiagnostics, activeStepIndex: activeStep, setActiveStep } = useDiagnostics();\n\n  const onNextStep = () => {\n    if (activeStep === DiagnosticsStep.AUDIO) {\n      hmsDiagnostics?.stopMicCheck();\n    } else if (activeStep === DiagnosticsStep.VIDEO) {\n      hmsDiagnostics?.stopCameraCheck();\n    } else if (activeStep === DiagnosticsStep.CONNECTIVITY) {\n      hmsDiagnostics?.stopConnectivityCheck();\n    }\n\n    setActiveStep(step => step + 1);\n  };\n\n  return (\n    <Flex\n      css={{\n        py: '$8',\n        px: '$10',\n        background: '$background_dim',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        borderTop: '1px solid $border_default',\n        fontSize: '$sm',\n        borderBottomLeftRadius: '$1',\n        borderBottomRightRadius: '$1',\n        lineHeight: '$sm',\n        zIndex: 1001,\n        '@lg': { flexDirection: 'column', gap: '$8' },\n      }}\n    >\n      <Box>{error && <Text css={{ c: '$alert_error_default' }}>Error: {error.message}</Text>}</Box>\n      {children ? (\n        children\n      ) : (\n        <Flex align=\"center\" css={{ gap: '$8', '@lg': { flexDirection: 'column' } }}>\n          <Text css={{ c: '$on_primary_medium' }}>{ctaText}</Text>\n          <Flex align=\"center\" gap=\"4\">\n            <Button onClick={onNextStep} variant=\"standard\" outlined={true}>\n              Skip\n            </Button>\n            <Button disabled={!!error} onClick={onNextStep}>\n              Yes\n            </Button>\n          </Flex>\n        </Flex>\n      )}\n    </Flex>\n  );\n};\n", "import React, { useContext } from 'react';\nimport { HMSDiagnosticsInterface } from '@100mslive/react-sdk';\n\nexport enum DiagnosticsStep {\n  BROWSER,\n  VIDEO,\n  AUDIO,\n  CONNECTIVITY,\n}\n\nexport const initialSteps = {\n  [DiagnosticsStep.BROWSER]: { name: 'Browser Support' },\n  [DiagnosticsStep.VIDEO]: { name: 'Test Video' },\n  [DiagnosticsStep.AUDIO]: { name: 'Test Audio' },\n  [DiagnosticsStep.CONNECTIVITY]: { name: 'Connection Quality' },\n};\n\nexport interface DiagnosticsStepInfo {\n  name: string;\n  hasFailed?: boolean;\n  isCompleted?: boolean;\n}\n\nexport const DiagnosticsContext = React.createContext<{\n  hmsDiagnostics?: HMSDiagnosticsInterface;\n  activeStepIndex: DiagnosticsStep;\n  setActiveStep: React.Dispatch<React.SetStateAction<DiagnosticsStep>>;\n  steps: Record<DiagnosticsStep, DiagnosticsStepInfo>;\n  updateStep: (step: DiagnosticsStep, value: Omit<DiagnosticsStepInfo, 'name'>) => void;\n}>({\n  activeStepIndex: 0,\n  setActiveStep: () => {\n    return;\n  },\n  steps: initialSteps,\n  updateStep: () => {\n    return;\n  },\n});\n\nexport const useDiagnostics = () => {\n  const context = useContext(DiagnosticsContext);\n  const activeStep = context.steps[context.activeStepIndex];\n\n  return { ...context, activeStep };\n};\n", "import React, { useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Dropdown } from '../Dropdown';\nimport { Box, Flex } from '../Layout';\nimport { DialogDropdownTrigger } from '../Prebuilt/primitives/DropdownTrigger';\nimport { Text } from '../Text';\n\nexport const DeviceSelector = ({ title, devices, selection, onChange, icon, children = null }) => {\n  const [open, setOpen] = useState(false);\n  const ref = useRef(null);\n  return (\n    <Box css={{ mb: '$6' }}>\n      <Text css={{ mb: '$4' }}>{title}</Text>\n      <Flex\n        align=\"center\"\n        css={{\n          gap: '$4',\n          '@md': {\n            flexDirection: children ? 'column' : 'row',\n            alignItems: children ? 'start' : 'center',\n          },\n        }}\n      >\n        <Dropdown.Root open={open} onOpenChange={setOpen}>\n          <DialogDropdownTrigger\n            ref={ref}\n            icon={icon}\n            title={devices.find(({ deviceId }) => deviceId === selection)?.label || 'Select device from list'}\n            open={open}\n          />\n          <Dropdown.Portal>\n            <Dropdown.Content\n              align=\"start\"\n              sideOffset={8}\n              css={{\n                w:\n                  // @ts-ignore\n                  ref.current?.clientWidth,\n                zIndex: 1001,\n              }}\n            >\n              {devices.map(device => {\n                return (\n                  <Dropdown.Item\n                    key={device.label}\n                    onSelect={() => onChange(device.deviceId)}\n                    css={{\n                      px: '$9',\n                    }}\n                  >\n                    {device.label}\n                  </Dropdown.Item>\n                );\n              })}\n            </Dropdown.Content>\n          </Dropdown.Portal>\n        </Dropdown.Root>\n        {children}\n      </Flex>\n    </Box>\n  );\n};\n\nDeviceSelector.propTypes = {\n  title: PropTypes.string.isRequired,\n  devices: PropTypes.array.isRequired,\n  selection: PropTypes.string,\n  onChange: PropTypes.func.isRequired,\n  icon: PropTypes.node,\n  children: PropTypes.node,\n};\n", "import React, { useEffect, useState } from 'react';\nimport { parsedUserAgent } from '@100mslive/react-sdk';\nimport { TestContainer, TestFooter } from './components';\nimport { Box, Flex } from '../Layout';\nimport { Text } from '../Text';\nimport { DiagnosticsStep, useDiagnostics } from './DiagnosticsContext';\n\nconst CMS_MEDIA_SERVER = 'https://storage.googleapis.com/100ms-cms-prod/';\n\nexport const operatingSystemIconInfo = {\n  tizen: {\n    key: 'tizen',\n    val: 'Tizen',\n    icon: `${CMS_MEDIA_SERVER}cms/Tizen_b99350214e/Tizen_b99350214e.svg`,\n  },\n  'mac os': {\n    key: 'macos',\n    val: 'Mac OS',\n    icon: `${CMS_MEDIA_SERVER}cms/mac_OS_804456afd8/mac_OS_804456afd8.png`,\n  },\n  windows: {\n    key: 'windows',\n    val: 'Windows',\n    icon: `${CMS_MEDIA_SERVER}cms/Windows_fdfe6749b6/Windows_fdfe6749b6.svg`,\n  },\n  linux: {\n    key: 'linux',\n    val: 'Linux',\n    icon: `${CMS_MEDIA_SERVER}cms/Linux_31f8353a2e/Linux_31f8353a2e.svg`,\n  },\n  chromium: {\n    key: 'chromium',\n    val: 'Chromium',\n    icon: `${CMS_MEDIA_SERVER}cms/Chromium_3df17710bd/Chromium_3df17710bd.svg`,\n  },\n  ubuntu: {\n    key: 'ubuntu',\n    val: 'Ubuntu',\n    icon: `${CMS_MEDIA_SERVER}cms/Ubuntu_966dd923c5/Ubuntu_966dd923c5.svg`,\n  },\n  ios: {\n    key: 'ios',\n    val: 'iOS',\n    icon: `${CMS_MEDIA_SERVER}cms/i_OS_3cdc9d9b71/i_OS_3cdc9d9b71.svg`,\n  },\n  android: {\n    key: 'android',\n    val: 'Android',\n    icon: `${CMS_MEDIA_SERVER}cms/Android_49dcfdc934/Android_49dcfdc934.svg`,\n  },\n};\n\nexport const browserTypeIconInfo = {\n  brave: {\n    key: 'brave',\n    val: 'Brave',\n    icon: `${CMS_MEDIA_SERVER}cms/Brave_7e66131f09/Brave_7e66131f09.svg`,\n  },\n  chrome: {\n    key: 'chrome',\n    val: 'Chrome',\n    icon: `${CMS_MEDIA_SERVER}cms/Chrome_7bf77fbdd7/Chrome_7bf77fbdd7.svg`,\n  },\n  firefox: {\n    key: 'firefox',\n    val: 'Firefox',\n    icon: `${CMS_MEDIA_SERVER}cms/Firefox_30f3976fb8/Firefox_30f3976fb8.svg`,\n  },\n  safari: {\n    key: 'safari',\n    val: 'Safari',\n    icon: `${CMS_MEDIA_SERVER}cms/Safari_254e74ed94/Safari_254e74ed94.svg`,\n  },\n  'mobile safari': {\n    key: 'safari',\n    val: 'Safari',\n    icon: `${CMS_MEDIA_SERVER}cms/Safari_254e74ed94/Safari_254e74ed94.svg`,\n  },\n  edge: {\n    key: 'edge',\n    val: 'Edge',\n    icon: `${CMS_MEDIA_SERVER}cms/Edge_23add4a83f/Edge_23add4a83f.svg`,\n  },\n  opera: {\n    key: 'opera',\n    val: 'Opera',\n    icon: `${CMS_MEDIA_SERVER}cms/Opera_0f3bf4eb19/Opera_0f3bf4eb19.svg`,\n  },\n};\n\nconst CheckDetails = ({ title, value, iconURL }: { title: string; value: string; iconURL?: string }) => (\n  <Box css={{ w: '100%', my: '$10', p: '$10', r: '$1', bg: '$surface_default', '@lg': { w: 'auto' } }}>\n    <Text css={{ c: '$on_primary_medium', mb: '$6' }}>{title}</Text>\n    <Flex align=\"center\">\n      {iconURL && (\n        <Box css={{ size: '2rem', r: '$round', bg: '$surface_brighter', mr: '$4' }}>\n          <img style={{ objectFit: 'contain', width: '2rem' }} src={iconURL} alt={value} />\n        </Box>\n      )}\n      <Text>{value}</Text>\n    </Flex>\n  </Box>\n);\n\nexport const BrowserTest = () => {\n  const { hmsDiagnostics, updateStep } = useDiagnostics();\n  const [error, setError] = useState<Error | undefined>();\n  useEffect(() => {\n    try {\n      hmsDiagnostics?.checkBrowserSupport();\n    } catch (err) {\n      updateStep(DiagnosticsStep.BROWSER, { hasFailed: true });\n      setError(err as Error);\n    }\n  }, [hmsDiagnostics, updateStep]);\n  return (\n    <>\n      <TestContainer css={{ display: 'flex', gap: '$8', '@lg': { display: 'block' } }}>\n        <CheckDetails\n          title=\"Browser\"\n          iconURL={\n            parsedUserAgent.getBrowser().name &&\n            browserTypeIconInfo[parsedUserAgent.getBrowser().name?.toLowerCase() as keyof typeof browserTypeIconInfo]\n              ?.icon\n          }\n          value={`${parsedUserAgent.getBrowser().name} ${parsedUserAgent.getBrowser().version}`}\n        />\n        <CheckDetails\n          title=\"Operating system\"\n          iconURL={\n            parsedUserAgent.getOS().name &&\n            operatingSystemIconInfo[parsedUserAgent.getOS().name?.toLowerCase() as keyof typeof operatingSystemIconInfo]\n              ?.icon\n          }\n          value={`${parsedUserAgent.getOS().name} ${parsedUserAgent.getOS().version}`}\n        />\n      </TestContainer>\n      <TestFooter error={error} ctaText=\"Is your device information correct?\" />\n    </>\n  );\n};\n", "import React, { useState } from 'react';\nimport { ConnectivityCheckResult, ConnectivityState, DiagnosticsRTCStats } from '@100mslive/react-sdk';\nimport { CheckCircleIcon, CrossCircleIcon, EyeCloseIcon, EyeOpenIcon, LinkIcon } from '@100mslive/react-icons';\nimport { TestContainer, TestFooter } from './components';\nimport { Button } from '../Button';\nimport { Box, Flex } from '../Layout';\nimport { Loading } from '../Loading';\nimport { formatBytes } from '../Stats';\nimport { Text } from '../Text';\nimport { DiagnosticsStep, useDiagnostics } from './DiagnosticsContext';\n\nconst Regions = {\n  in: 'India',\n  eu: 'Europe',\n  us: 'United States',\n};\n\nconst ConnectivityStateMessage = {\n  [ConnectivityState.STARTING]: 'Fetching Init',\n  [ConnectivityState.INIT_FETCHED]: 'Connecting to signal server',\n  [ConnectivityState.SIGNAL_CONNECTED]: 'Establishing ICE connection',\n  [ConnectivityState.ICE_ESTABLISHED]: 'Capturing Media',\n  [ConnectivityState.MEDIA_CAPTURED]: 'Publishing Media',\n  [ConnectivityState.MEDIA_PUBLISHED]: 'Finishing Up',\n  [ConnectivityState.COMPLETED]: 'Completed',\n};\n\nexport const ConnectivityTestStepResult = ({\n  title,\n  status = 'Connected',\n  success,\n  children,\n}: {\n  title: string;\n  status?: string;\n  success?: boolean;\n  children: React.ReactNode;\n}) => {\n  const [hideDetails, setHideDetails] = useState(true);\n\n  return (\n    <Box css={{ my: '$10', p: '$10', r: '$1', bg: '$surface_bright' }}>\n      <Text css={{ c: '$on_primary_medium', mb: '$6' }}>{title}</Text>\n      {success ? (\n        <Flex>\n          <Text css={{ c: '$alert_success' }}>\n            <CheckCircleIcon width=\"1.5rem\" height=\"1.5rem\" />\n          </Text>\n          <Text variant=\"lg\" css={{ ml: '$4' }}>\n            {status}\n          </Text>\n        </Flex>\n      ) : (\n        <Flex>\n          <Text css={{ c: '$alert_error_bright' }}>\n            <CrossCircleIcon width=\"1.5rem\" height=\"1.5rem\" />\n          </Text>\n          <Text variant=\"lg\" css={{ ml: '$4' }}>\n            Failed\n          </Text>\n        </Flex>\n      )}\n      <Flex\n        onClick={() => setHideDetails(!hideDetails)}\n        align=\"center\"\n        gap=\"2\"\n        css={{\n          color: '$primary_bright',\n        }}\n      >\n        {hideDetails ? <EyeOpenIcon /> : <EyeCloseIcon />}\n        <Text\n          variant=\"caption\"\n          css={{\n            color: '$primary_bright',\n          }}\n        >\n          {hideDetails ? 'View' : 'Hide'} detailed information\n        </Text>\n      </Flex>\n      {!hideDetails ? <Box>{children}</Box> : null}\n    </Box>\n  );\n};\n\nconst DetailedInfo = ({\n  title,\n  value,\n  Icon,\n}: {\n  title: string;\n  value: string;\n  Icon?: (props: React.SVGProps<SVGSVGElement>) => React.JSX.Element;\n}) => {\n  return (\n    <Box css={{ flex: '50%', mt: '$6' }}>\n      <Text variant=\"caption\" css={{ fontWeight: '$semiBold', c: '$on_primary_medium' }}>\n        {title}\n      </Text>\n      <Flex css={{ mt: '$xs', alignItems: 'flex-start' }}>\n        {Icon && (\n          <Text css={{ mr: '$4' }}>\n            <Icon width=\"1rem\" height=\"1rem\" />\n          </Text>\n        )}\n        <Text variant=\"caption\">{value}</Text>\n      </Flex>\n    </Box>\n  );\n};\n\nconst MediaServerResult = ({ result }: { result?: ConnectivityCheckResult['mediaServerReport'] }) => {\n  return (\n    <ConnectivityTestStepResult\n      title=\"Media server connection test\"\n      success={result?.isPublishICEConnected && result.isSubscribeICEConnected}\n    >\n      <Flex css={{ flexWrap: 'wrap' }}>\n        <DetailedInfo\n          title=\"Media Captured\"\n          value={result?.stats?.audio.bytesSent ? 'Yes' : 'No'}\n          Icon={result?.stats?.audio.bytesSent ? CheckCircleIcon : CrossCircleIcon}\n        />\n        <DetailedInfo\n          title=\"Media Published\"\n          value={result?.stats?.audio.bitrateSent ? 'Yes' : 'No'}\n          Icon={result?.stats?.audio.bytesSent ? CheckCircleIcon : CrossCircleIcon}\n        />\n        {result?.connectionQualityScore ? (\n          <DetailedInfo\n            title=\"Connection Quality Score (CQS)\"\n            value={`${result.connectionQualityScore.toFixed(2)} (out of 5)`}\n          />\n        ) : null}\n      </Flex>\n    </ConnectivityTestStepResult>\n  );\n};\n\nconst SignallingResult = ({ result }: { result?: ConnectivityCheckResult['signallingReport'] }) => {\n  return (\n    <ConnectivityTestStepResult title=\"Signalling server connection test\" success={result?.isConnected}>\n      <Flex css={{ flexWrap: 'wrap' }}>\n        <DetailedInfo\n          title=\"Signalling Gateway\"\n          value={result?.isConnected ? 'Reachable' : 'Unreachable'}\n          Icon={result?.isConnected ? CheckCircleIcon : CrossCircleIcon}\n        />\n        <DetailedInfo title=\"Websocket URL\" value={result?.websocketUrl || 'N/A'} Icon={LinkIcon} />\n      </Flex>\n    </ConnectivityTestStepResult>\n  );\n};\n\nconst AudioStats = ({ stats }: { stats: DiagnosticsRTCStats | undefined }) => {\n  return (\n    <ConnectivityTestStepResult title=\"Audio\" status=\"Received\" success={!!stats?.bytesSent}>\n      {stats && (\n        <Flex css={{ flexWrap: 'wrap' }}>\n          <DetailedInfo title=\"Bytes Sent\" value={formatBytes(stats.bytesSent)} />\n          <DetailedInfo title=\"Bytes Received\" value={formatBytes(stats.bytesReceived)} />\n          <DetailedInfo title=\"Packets Received\" value={stats.packetsReceived.toString()} />\n          <DetailedInfo title=\"Packets Lost\" value={stats.packetsLost.toString()} />\n          <DetailedInfo title=\"Bitrate Sent\" value={formatBytes(stats.bitrateSent, 'b/s')} />\n          <DetailedInfo title=\"Bitrate Received\" value={formatBytes(stats.bitrateReceived, 'b/s')} />\n          <DetailedInfo title=\"Round Trip Time\" value={`${stats.roundTripTime} ms`} />\n        </Flex>\n      )}\n    </ConnectivityTestStepResult>\n  );\n};\n\nconst VideoStats = ({ stats }: { stats: DiagnosticsRTCStats | undefined }) => {\n  return (\n    <ConnectivityTestStepResult title=\"Video\" status=\"Received\" success={!!stats?.bytesSent}>\n      {stats && (\n        <Flex css={{ flexWrap: 'wrap' }}>\n          <DetailedInfo title=\"Bytes Sent\" value={formatBytes(stats.bytesSent)} />\n          <DetailedInfo title=\"Bytes Received\" value={formatBytes(stats.bytesReceived)} />\n          <DetailedInfo title=\"Packets Received\" value={stats.packetsReceived.toString()} />\n          <DetailedInfo title=\"Packets Lost\" value={stats.packetsLost.toString()} />\n          <DetailedInfo title=\"Bitrate Sent\" value={formatBytes(stats.bitrateSent, 'b/s')} />\n          <DetailedInfo title=\"Bitrate Received\" value={formatBytes(stats.bitrateReceived, 'b/s')} />\n          <DetailedInfo title=\"Round Trip Time\" value={`${stats.roundTripTime} ms`} />\n        </Flex>\n      )}\n    </ConnectivityTestStepResult>\n  );\n};\n\nconst Footer = ({\n  error,\n  result,\n  restart,\n}: {\n  result?: ConnectivityCheckResult;\n  restart: () => void;\n  error?: Error;\n}) => {\n  return (\n    <TestFooter error={error}>\n      <Flex css={{ gap: '$8', '@lg': { flexDirection: 'column' } }}>\n        <Button variant=\"standard\" onClick={restart}>\n          Restart Test\n        </Button>\n        <Button disabled={!result} onClick={() => result && downloadJson(result, 'hms_diagnostics_results')}>\n          Download Test Report\n        </Button>\n      </Flex>\n    </TestFooter>\n  );\n};\n\nconst ConnectivityTestReport = ({\n  error,\n  result,\n  progress,\n  startTest,\n}: {\n  error?: Error;\n  result?: ConnectivityCheckResult;\n  progress?: ConnectivityState;\n  startTest: () => void;\n}) => {\n  if (error) {\n    return (\n      <>\n        <TestContainer css={{ textAlign: 'center' }}>\n          <Text css={{ c: '$alert_error_default', mb: '$4' }}>\n            <CrossCircleIcon />\n          </Text>\n          <Text variant=\"h6\">Connectivity Test Failed</Text>\n          <Text variant=\"body2\" css={{ c: '$on_primary_medium' }}>\n            {error.message}\n          </Text>\n        </TestContainer>\n        <Footer restart={startTest} error={error} />\n      </>\n    );\n  }\n\n  if (result) {\n    // for debugging and quick view of results\n    console.log(result);\n    return (\n      <>\n        <TestContainer>\n          <Text css={{ c: '$on_primary_medium' }}>Connectivity test has been completed.</Text>\n          <SignallingResult result={result?.signallingReport} />\n          <MediaServerResult result={result?.mediaServerReport} />\n          <AudioStats stats={result?.mediaServerReport?.stats?.audio} />\n          <VideoStats stats={result?.mediaServerReport?.stats?.video} />\n        </TestContainer>\n        <Footer result={result} restart={startTest} error={error} />\n      </>\n    );\n  }\n\n  if (progress !== undefined) {\n    return (\n      <TestContainer css={{ textAlign: 'center' }}>\n        <Text css={{ c: '$primary_bright', display: 'flex', justifyContent: 'center' }}>\n          <Loading size=\"3.5rem\" color=\"currentColor\" />\n        </Text>\n        <Text variant=\"h6\" css={{ mt: '$8' }}>\n          Checking your connection...\n        </Text>\n        <Text\n          variant=\"body2\"\n          css={{ c: '$on_primary_medium', mt: '$4' }}\n        >{`${ConnectivityStateMessage[progress]}...`}</Text>\n      </TestContainer>\n    );\n  }\n\n  return null;\n};\n\nconst RegionSelector = ({\n  region,\n  setRegion,\n  startTest,\n}: {\n  region?: string;\n  startTest?: () => void;\n  setRegion: (region: string) => void;\n}) => {\n  return (\n    <TestContainer css={{ borderBottom: '1px solid $border_default' }}>\n      <Text variant=\"body1\">Select a region</Text>\n      <Text variant=\"body2\" css={{ c: '$on_secondary_low' }}>\n        Select the closest region for best results\n      </Text>\n      <Flex\n        justify=\"between\"\n        css={{\n          mt: '$md',\n          '@lg': {\n            flexDirection: 'column',\n            gap: '$8',\n          },\n        }}\n      >\n        <Flex\n          css={{\n            gap: '$4',\n            '@lg': {\n              flexDirection: 'column',\n            },\n          }}\n        >\n          {Object.entries(Regions).map(([key, value]) => (\n            <Button\n              key={key}\n              outlined={region !== key}\n              variant={region === key ? 'primary' : 'standard'}\n              css={region === key ? { bg: '$primary_dim' } : {}}\n              onClick={() => setRegion(key)}\n            >\n              {value}\n            </Button>\n          ))}\n        </Flex>\n        <Flex css={{ '@lg': { flexDirection: 'column' } }}>\n          <Button variant=\"primary\" onClick={startTest} disabled={!startTest}>\n            {startTest ? 'Start Test' : 'Testing...'}\n          </Button>\n        </Flex>\n      </Flex>\n    </TestContainer>\n  );\n};\n\nexport const ConnectivityTest = () => {\n  const { hmsDiagnostics, updateStep } = useDiagnostics();\n  const [region, setRegion] = useState<string | undefined>(Object.keys(Regions)[0]);\n  const [error, setError] = useState<Error | undefined>();\n  const [progress, setProgress] = useState<ConnectivityState>();\n  const [result, setResult] = useState<ConnectivityCheckResult | undefined>();\n\n  const startTest = () => {\n    updateStep(DiagnosticsStep.CONNECTIVITY, { hasFailed: false, isCompleted: false });\n    setError(undefined);\n    setResult(undefined);\n    hmsDiagnostics\n      ?.startConnectivityCheck(\n        state => {\n          setProgress(state);\n        },\n        result => {\n          updateStep(DiagnosticsStep.CONNECTIVITY, { isCompleted: true });\n          setResult(result);\n        },\n        region,\n      )\n      .catch(error => {\n        updateStep(DiagnosticsStep.CONNECTIVITY, { hasFailed: true });\n        setError(error);\n      });\n  };\n\n  return (\n    <>\n      <RegionSelector\n        region={region}\n        setRegion={setRegion}\n        startTest={progress === undefined || progress === ConnectivityState.COMPLETED ? startTest : undefined}\n      />\n      <ConnectivityTestReport error={error} result={result} progress={progress} startTest={startTest} />\n    </>\n  );\n};\n\nconst downloadJson = (obj: object, fileName: string) => {\n  const a = document.createElement('a');\n  const file = new Blob([JSON.stringify(obj, null, 2)], {\n    type: 'application/json',\n  });\n  a.href = URL.createObjectURL(file);\n  a.download = `${fileName}.json`;\n  a.click();\n};\n", "import React, { useEffect, useState } from 'react';\nimport {\n  HMSException,\n  selectDevices,\n  selectLocalMediaSettings,\n  selectLocalVideoTrackID,\n  useHMSStore,\n} from '@100mslive/react-sdk';\nimport { VideoOnIcon } from '@100mslive/react-icons';\nimport { PermissionErrorModal } from '../Prebuilt/components/Notifications/PermissionErrorModal';\nimport { TestContainer, TestFooter } from './components';\nimport { Flex } from '../Layout';\nimport { Text } from '../Text';\nimport { Video } from '../Video';\nimport { StyledVideoTile } from '../VideoTile';\n// @ts-ignore: No implicit any\nimport { DeviceSelector } from './DeviceSelector';\nimport { DiagnosticsStep, useDiagnostics } from './DiagnosticsContext';\n\nexport const VideoTest = () => {\n  const { hmsDiagnostics, updateStep } = useDiagnostics();\n  const allDevices = useHMSStore(selectDevices);\n  const { videoInput } = allDevices;\n  const trackID = useHMSStore(selectLocalVideoTrackID);\n  const sdkSelectedDevices = useHMSStore(selectLocalMediaSettings);\n  const [error, setError] = useState<HMSException | undefined>();\n\n  useEffect(() => {\n    hmsDiagnostics?.startCameraCheck().catch(err => {\n      updateStep(DiagnosticsStep.VIDEO, { hasFailed: true });\n      setError(err);\n    });\n  }, [hmsDiagnostics, updateStep]);\n\n  return (\n    <>\n      <TestContainer css={{ display: 'flex', '@lg': { flexDirection: 'column', alignItems: 'center' } }}>\n        {trackID && (\n          <StyledVideoTile.Container\n            css={{\n              width: '90%',\n              aspectRatio: '16/9',\n              mr: '$10',\n              '@lg': { mr: 0, mb: '$10', aspectRatio: '1/1' },\n            }}\n          >\n            <Video mirror={true} trackId={trackID} />\n          </StyledVideoTile.Container>\n        )}\n        <Flex direction=\"column\" css={{ w: '100%' }}>\n          <Text variant=\"body2\" css={{ c: '$on_primary_medium', mb: '$10' }}>\n            Move in front of your camera to make sure it's working. If you don't see your video, try changing the\n            selected camera. If the camera isn't part of your computer, check your settings to make sure your system\n            recognizes it.\n          </Text>\n          <DeviceSelector\n            title=\"Video\"\n            devices={videoInput || []}\n            icon={<VideoOnIcon />}\n            selection={sdkSelectedDevices.videoInputDeviceId}\n            onChange={async (deviceId: string) => {\n              hmsDiagnostics?.stopCameraCheck();\n              hmsDiagnostics?.startCameraCheck(deviceId);\n            }}\n          />\n        </Flex>\n      </TestContainer>\n      <TestFooter error={error} ctaText=\"Does your video look good?\" />\n      <PermissionErrorModal error={error} />\n    </>\n  );\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA,mCAAC,cAAe,iGAAgG,qCAAsC,WAAU,yCAA0C,aAAY,iCAAkC,oBAAmB,+BAAgC,uBAAsB,WAAY,QAAO,qBAAsB,eAAc,eAAgB,KAAI,qCAAsC,UAAS,0CAA2C,UAAS,iDAAkD,SAAQ,oDAAqD,UAAS,MAAO,UAAS,kCAAmC,UAAS,iCAAkC,QAAO,uBAAwB,8CAA6C,wBAAyB,IAAG,mBAAoB,uCAAsC,2BAA4B,gCAA+B,IAAK,QAAO,8CAA+C,UAAS,sBAAuB,QAAO,wBAAyB,IAAG,+CAAgD,SAAQ,+CAAgD,WAAU,oBAAqB,iBAAgB,YAAa,8FAA6F,WAAY,aAAY,mBAAoB,kDAAiD,yBAA0B,SAAQ,4CAA6C,UAAS,2CAA4C,UAAS,4DAA6D,WAAU,iBAAkB,oCAAmC,iBAAkB,2BAA0B,OAAQ,KAAI,kDAAmD,SAAQ,kDAAmD,SAAQ,oDAAqD,WAAU,oCAAqC,oBAAmB,oDAAqD,WAAU,qBAAsB,QAAO,MAAO,gBAAe,uDAAwD,UAAS,iDAAkD,SAAQ,iDAAkD,UAAS,qBAAsB,OAAM,kCAAmC,0BAAyB,aAAc,2BAA0B,mBAAoB,uDAAsD,gCAAiC,4CAA2C,0CAA2C,UAAS,kBAAmB,qCAAoC,cAAe,iBAAgB,yBAA0B,aAAY,0BAA2B,QAAO,qDAAsD,WAAU,yBAA0B,OAAM,aAAc,0BAAyB,yBAA0B,gDAA+C,kBAAmB,qCAAoC,YAAa,QAAO,uBAAwB,MAAK,kBAAmB,SAAQ,+BAAgC,KAAI,4BAA6B,YAAW,iCAAkC,2BAA0B,qBAAsB,2BAA0B,iBAAkB,IAAG,8BAA+B,mBAAkB,uBAAwB,kCAAiC,mDAAoD,WAAU,kBAAmB,OAAM,iCAAkC,oCAAmC,mCAAoC,UAAS,oCAAqC,UAAS,wCAAyC,UAAS,gDAAiD,SAAQ,wDAAyD,SAAQ,wBAAyB,aAAY,oBAAqB,kCAAiC,yBAA0B,qIAAoI,wCAAyC,UAAS,qCAAsC,WAAU,0CAA2C,UAAS,wBAAyB,SAAQ,iBAAkB,uCAAsC,SAAU,qBAAoB,4BAA6B,aAAY,mCAAoC,WAAU,+CAAgD,WAAU,wBAAyB,YAAW,mCAAoC,KAAI,iBAAkB,uCAAsC,kBAAmB,qCAAoC,cAAe,gBAAe,sCAAuC,UAAS,wCAAyC,WAAU,yBAA0B,0BAAyB,wBAAyB,WAAU,WAAY,SAAQ,gBAAiB,0BAAyB,iBAAkB,sCAAqC,YAAa,4BAA2B,aAAc,QAAO,gDAAiD,SAAQ,sDAAuD,SAAQ,4DAA6D,SAAQ,sDAAuD,WAAU,+BAAgC,mBAAkB,aAAc,UAAS,YAAa,QAAO,iBAAkB,yCAAwC,gBAAiB,WAAU,iBAAkB,oBAAmB,GAAI,uBAAsB,qCAAsC,UAAS,mCAAoC,UAAS,yCAA0C,WAAU,6DAA8D,WAAU,qBAAsB,QAAO,oDAAqD,SAAQ,iDAAkD,WAAU,oBAAqB,iBAAgB,0BAA2B,qGAAoG,8DAA+D,UAAS,qBAAsB,gCAA+B,uCAAwC,UAAS,gDAAiD,UAAS,iDAAkD,UAAS,4CAA6C,WAAU,qCAAsC,2BAA0B,SAAU,SAAQ,eAAgB,eAAc,YAAa,QAAO,0BAA2B,cAAa,2BAA4B,6CAA4C,yCAA0C,WAAU,qCAAsC,SAAQ,2DAA4D,WAAU,sDAAuD,WAAU,iBAAkB,UAAS,kCAAmC,KAAI,qBAAsB,4CAA2C,iBAAkB,IAAG,SAAU,YAAW,0BAA2B,cAAa,2BAA4B,wCAA2C,2BAA4B,IAAG,cAAe,oEAAmE,8BAA+B,mBAAkB,qBAAsB,oEAAmE,0BAA2B,kBAAiB,0BAA2B,IAAG,8BAA+B,2CAA0C,4CAA6C,UAAS,4CAA6C,UAAS,MAAO,ojEAAmjE,MAAO,kDAAiD,UAAW,kBAAiB,0BAA2B,KAAI,oBAAqB,+CAA8C,eAAgB,oCAAmC,uBAAwB,kCAAiC,mBAAoB,wBAAuB,0BAA2B,cAAa,wCAAyC,UAAS,kBAAmB,4BAA2B,uDAAwD,WAAU,6BAA8B,OAAM,eAAgB,WAAU,mBAAoB,OAAM,yBAA0B,cAAa,aAAc,OAAM,iBAAkB,kBAAiB,sBAAuB,wBAAuB,2CAA4C,UAAS,mDAAoD,UAAS,oBAAqB,4BAA2B,iDAAkD,SAAQ,gCAAiC,SAAQ,6CAA8C,WAAU,MAAO,WAAU,yBAA0B,0BAAyB,gCAAiC,SAAQ,8DAA+D,UAAS,oCAAqC,UAAS,sDAAuD,UAAS,oCAAqC,WAAU,wCAAyC,SAAQ,OAAQ,wBAAuB,aAAc,sBAAqB,iBAAkB,wBAAuB,WAAY,QAAO,iBAAkB,QAAO,mBAAoB,sBAAqB,WAAY,SAAQ,sBAAuB,kDAAiD,gCAAiC,UAAS,sCAAuC,UAAS,oCAAqC,WAAU,iDAAkD,SAAQ,iCAAkC,wBAAuB,kBAAmB,qBAAoB,UAAW,QAAO,kBAAmB,gDAA+C,mBAAoB,IAAG,iBAAkB,kBAAiB,gCAAiC,SAAQ,+BAAgC,8CAA6C,kCAAmC,gBAAe,mCAAoC,gFAA+E,0BAA2B,6CAA4C,0CAA2C,UAAS,gCAAiC,OAAM,mDAAoD,SAAQ,iDAAkD,WAAU,2BAA4B,UAAS,sBAAuB,aAAY,gBAAiB,QAAO,qBAAsB,cAAa,qBAAsB,UAAS,gCAAiC,SAAQ,+BAAgC,0CAAyC,+BAAgC,UAAS,gCAAiC,kDAAiD,0CAA2C,WAAU,yBAA0B,SAAQ,4BAA6B,6CAA4C,oBAAqB,gBAAe,sBAAuB,QAAO,iBAAkB,6DAAwE,gCAAiC,SAAQ,+BAAgC,4CAA2C,2BAA4B,uCAAsC,mCAAoC,UAAS,gCAAiC,WAAU,yCAA0C,WAAU,YAAa,QAAO,+BAAgC,UAAS,uDAAwD,UAAS,uCAAwC,UAAS,qCAAsC,UAAS,kBAAmB,uCAAsC,aAAc,KAAI,YAAa,oBAAmB,gBAAiB,wBAAuB,gCAAiC,UAAS,+BAAgC,wCAAuC,qCAAsC,UAAS,YAAa,4CAA2C,oBAAqB,KAAI,gCAAiC,UAAS,+BAAgC,qDAAoD,4BAA6B,QAAO,6BAA8B,IAAG,uCAAwC,UAAS,YAAa,mBAAkB,cAAe,cAAa,kBAAmB,8BAA6B,qBAAsB,OAAM,+BAAgC,iDAAgD,uBAAwB,QAAO,WAAY,uBAAsB,+BAAgC,0CAAyC,4BAA6B,sBAAqB,oDAAqD,UAAS,qDAAsD,UAAS,wBAAyB,4BAA2B,aAAc,+FAA8F,WAAY,qCAAoC,KAAM,8DAA6D,iBAAkB,WAAU,kBAAmB,8BAA6B,cAAe,gDAA+C,+BAAgC,sCAAqC,0BAA2B,qDAAoD,mDAAoD,SAAQ,qCAAsC,QAAO,WAAY,UAAS,mBAAoB,qBAAoB,yBAA0B,KAAI,cAAe,8BAA6B,mBAAoB,sBAAqB,gBAAiB,iCAAgC,UAAW,qEAAoE,2BAA4B,cAAa,eAAgB,iGAAgG,8BAA+B,mCAAkC,yBAA0B,SAAQ,eAAgB,gCAA+B,WAAY,QAAO,qCAAsC,YAAW,qCAAsC,UAAS,qCAAsC,YAAW,wBAAyB,KAAI,4BAA6B,IAAG,wCAAyC,WAAU,qBAAsB,mBAAkB,aAAc,gDAA+C,eAAgB,KAAI,YAAa,0BAAyB,+BAAgC,kBAAiB,qDAAsD,SAAQ,0CAA2C,UAAS,wDAAyD,SAAQ,wDAAyD,UAAS,yDAA0D,WAAU,mBAAoB,uCAAsC,YAAa,uGAAsG,8BAA+B,uCAAsC,oCAAqC,WAAU,sDAAuD,SAAQ,iDAAkD,UAAS,kCAAmC,WAAU,8CAA+C,WAAU,UAAW,uCAAsC,kBAAmB,gDAA+C,qBAAsB,kGAAiG;AAAA;AAAA;;;ACAz3iB;AAAA;AAAA;AAQC,KAAC,WAAW;AAGX,UAAIA;AAGJ,UAAI,UAAU;AAGd,UAAI,mBAAmB;AAGvB,UAAI,kBAAkB,mEAClB,kBAAkB,uBAClB,+BAA+B;AAGnC,UAAI,iBAAiB;AAGrB,UAAI,mBAAmB;AAGvB,UAAI,cAAc;AAGlB,UAAI,kBAAkB,GAClB,kBAAkB,GAClB,qBAAqB;AAGzB,UAAI,uBAAuB,GACvB,yBAAyB;AAG7B,UAAI,iBAAiB,GACjB,qBAAqB,GACrB,wBAAwB,GACxB,kBAAkB,GAClB,wBAAwB,IACxB,oBAAoB,IACpB,0BAA0B,IAC1B,gBAAgB,KAChB,kBAAkB,KAClB,iBAAiB;AAGrB,UAAI,uBAAuB,IACvB,yBAAyB;AAG7B,UAAI,YAAY,KACZ,WAAW;AAGf,UAAI,mBAAmB,GACnB,gBAAgB,GAChB,kBAAkB;AAGtB,UAAI,WAAW,IAAI,GACf,mBAAmB,kBACnB,cAAc,uBACd,MAAM,IAAI;AAGd,UAAI,mBAAmB,YACnB,kBAAkB,mBAAmB,GACrC,wBAAwB,qBAAqB;AAGjD,UAAI,YAAY;AAAA,QACd,CAAC,OAAO,aAAa;AAAA,QACrB,CAAC,QAAQ,cAAc;AAAA,QACvB,CAAC,WAAW,kBAAkB;AAAA,QAC9B,CAAC,SAAS,eAAe;AAAA,QACzB,CAAC,cAAc,qBAAqB;AAAA,QACpC,CAAC,QAAQ,cAAc;AAAA,QACvB,CAAC,WAAW,iBAAiB;AAAA,QAC7B,CAAC,gBAAgB,uBAAuB;AAAA,QACxC,CAAC,SAAS,eAAe;AAAA,MAC3B;AAGA,UAAI,UAAU,sBACV,WAAW,kBACX,WAAW,0BACX,UAAU,oBACV,UAAU,iBACV,YAAY,yBACZ,WAAW,kBACX,UAAU,qBACV,SAAS,8BACT,SAAS,gBACT,YAAY,mBACZ,UAAU,iBACV,YAAY,mBACZ,aAAa,oBACb,WAAW,kBACX,YAAY,mBACZ,SAAS,gBACT,YAAY,mBACZ,YAAY,mBACZ,eAAe,sBACf,aAAa,oBACb,aAAa;AAEjB,UAAI,iBAAiB,wBACjB,cAAc,qBACd,aAAa,yBACb,aAAa,yBACb,UAAU,sBACV,WAAW,uBACX,WAAW,uBACX,WAAW,uBACX,kBAAkB,8BAClB,YAAY,wBACZ,YAAY;AAGhB,UAAI,uBAAuB,kBACvB,sBAAsB,sBACtB,wBAAwB;AAG5B,UAAI,gBAAgB,6BAChB,kBAAkB,YAClB,mBAAmB,OAAO,cAAc,MAAM,GAC9C,qBAAqB,OAAO,gBAAgB,MAAM;AAGtD,UAAI,WAAW,oBACX,aAAa,mBACb,gBAAgB;AAGpB,UAAI,eAAe,oDACf,gBAAgB,SAChB,aAAa;AAMjB,UAAI,eAAe,uBACf,kBAAkB,OAAO,aAAa,MAAM;AAGhD,UAAI,cAAc;AAGlB,UAAI,eAAe;AAGnB,UAAI,gBAAgB,6CAChB,gBAAgB,qCAChB,iBAAiB;AAGrB,UAAI,cAAc;AAYlB,UAAI,6BAA6B;AAGjC,UAAI,eAAe;AAMnB,UAAI,eAAe;AAGnB,UAAI,UAAU;AAGd,UAAI,aAAa;AAGjB,UAAI,aAAa;AAGjB,UAAI,eAAe;AAGnB,UAAI,YAAY;AAGhB,UAAI,WAAW;AAGf,UAAI,UAAU;AAGd,UAAI,YAAY;AAGhB,UAAI,oBAAoB;AAGxB,UAAI,gBAAgB,mBAChB,oBAAoB,mBACpB,wBAAwB,mBACxB,sBAAsB,mBACtB,eAAe,oBAAoB,wBAAwB,qBAC3D,iBAAiB,mBACjB,eAAe,6BACf,gBAAgB,wBAChB,iBAAiB,gDACjB,qBAAqB,mBACrB,eAAe,gKACf,eAAe,6BACf,aAAa,kBACb,eAAe,gBAAgB,iBAAiB,qBAAqB;AAGzE,UAAI,SAAS,aACT,WAAW,MAAM,gBAAgB,KACjC,UAAU,MAAM,eAAe,KAC/B,UAAU,MAAM,eAAe,KAC/B,WAAW,QACX,YAAY,MAAM,iBAAiB,KACnC,UAAU,MAAM,eAAe,KAC/B,SAAS,OAAO,gBAAgB,eAAe,WAAW,iBAAiB,eAAe,eAAe,KACzG,SAAS,4BACT,aAAa,QAAQ,UAAU,MAAM,SAAS,KAC9C,cAAc,OAAO,gBAAgB,KACrC,aAAa,mCACb,aAAa,sCACb,UAAU,MAAM,eAAe,KAC/B,QAAQ;AAGZ,UAAI,cAAc,QAAQ,UAAU,MAAM,SAAS,KAC/C,cAAc,QAAQ,UAAU,MAAM,SAAS,KAC/C,kBAAkB,QAAQ,SAAS,0BACnC,kBAAkB,QAAQ,SAAS,0BACnC,WAAW,aAAa,KACxB,WAAW,MAAM,aAAa,MAC9B,YAAY,QAAQ,QAAQ,QAAQ,CAAC,aAAa,YAAY,UAAU,EAAE,KAAK,GAAG,IAAI,MAAM,WAAW,WAAW,MAClH,aAAa,oDACb,aAAa,oDACb,QAAQ,WAAW,WAAW,WAC9B,UAAU,QAAQ,CAAC,WAAW,YAAY,UAAU,EAAE,KAAK,GAAG,IAAI,MAAM,OACxE,WAAW,QAAQ,CAAC,cAAc,UAAU,KAAK,SAAS,YAAY,YAAY,QAAQ,EAAE,KAAK,GAAG,IAAI;AAG5G,UAAI,SAAS,OAAO,QAAQ,GAAG;AAM/B,UAAI,cAAc,OAAO,SAAS,GAAG;AAGrC,UAAI,YAAY,OAAO,SAAS,QAAQ,SAAS,OAAO,WAAW,OAAO,GAAG;AAG7E,UAAI,gBAAgB,OAAO;AAAA,QACzB,UAAU,MAAM,UAAU,MAAM,kBAAkB,QAAQ,CAAC,SAAS,SAAS,GAAG,EAAE,KAAK,GAAG,IAAI;AAAA,QAC9F,cAAc,MAAM,kBAAkB,QAAQ,CAAC,SAAS,UAAU,aAAa,GAAG,EAAE,KAAK,GAAG,IAAI;AAAA,QAChG,UAAU,MAAM,cAAc,MAAM;AAAA,QACpC,UAAU,MAAM;AAAA,QAChB;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF,EAAE,KAAK,GAAG,GAAG,GAAG;AAGhB,UAAI,eAAe,OAAO,MAAM,QAAQ,gBAAiB,eAAe,aAAa,GAAG;AAGxF,UAAI,mBAAmB;AAGvB,UAAI,eAAe;AAAA,QACjB;AAAA,QAAS;AAAA,QAAU;AAAA,QAAY;AAAA,QAAQ;AAAA,QAAS;AAAA,QAAgB;AAAA,QAChE;AAAA,QAAY;AAAA,QAAa;AAAA,QAAc;AAAA,QAAc;AAAA,QAAO;AAAA,QAAQ;AAAA,QACpE;AAAA,QAAW;AAAA,QAAU;AAAA,QAAO;AAAA,QAAU;AAAA,QAAU;AAAA,QAAa;AAAA,QAC7D;AAAA,QAAqB;AAAA,QAAe;AAAA,QAAe;AAAA,QACnD;AAAA,QAAK;AAAA,QAAgB;AAAA,QAAY;AAAA,QAAY;AAAA,MAC/C;AAGA,UAAI,kBAAkB;AAGtB,UAAI,iBAAiB,CAAC;AACtB,qBAAe,UAAU,IAAI,eAAe,UAAU,IACtD,eAAe,OAAO,IAAI,eAAe,QAAQ,IACjD,eAAe,QAAQ,IAAI,eAAe,QAAQ,IAClD,eAAe,eAAe,IAAI,eAAe,SAAS,IAC1D,eAAe,SAAS,IAAI;AAC5B,qBAAe,OAAO,IAAI,eAAe,QAAQ,IACjD,eAAe,cAAc,IAAI,eAAe,OAAO,IACvD,eAAe,WAAW,IAAI,eAAe,OAAO,IACpD,eAAe,QAAQ,IAAI,eAAe,OAAO,IACjD,eAAe,MAAM,IAAI,eAAe,SAAS,IACjD,eAAe,SAAS,IAAI,eAAe,SAAS,IACpD,eAAe,MAAM,IAAI,eAAe,SAAS,IACjD,eAAe,UAAU,IAAI;AAG7B,UAAI,gBAAgB,CAAC;AACrB,oBAAc,OAAO,IAAI,cAAc,QAAQ,IAC/C,cAAc,cAAc,IAAI,cAAc,WAAW,IACzD,cAAc,OAAO,IAAI,cAAc,OAAO,IAC9C,cAAc,UAAU,IAAI,cAAc,UAAU,IACpD,cAAc,OAAO,IAAI,cAAc,QAAQ,IAC/C,cAAc,QAAQ,IAAI,cAAc,MAAM,IAC9C,cAAc,SAAS,IAAI,cAAc,SAAS,IAClD,cAAc,SAAS,IAAI,cAAc,MAAM,IAC/C,cAAc,SAAS,IAAI,cAAc,SAAS,IAClD,cAAc,QAAQ,IAAI,cAAc,eAAe,IACvD,cAAc,SAAS,IAAI,cAAc,SAAS,IAAI;AACtD,oBAAc,QAAQ,IAAI,cAAc,OAAO,IAC/C,cAAc,UAAU,IAAI;AAG5B,UAAI,kBAAkB;AAAA;AAAA,QAEpB,QAAQ;AAAA,QAAM,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAC1E,QAAQ;AAAA,QAAM,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAC1E,QAAQ;AAAA,QAAM,QAAQ;AAAA,QACtB,QAAQ;AAAA,QAAM,QAAQ;AAAA,QACtB,QAAQ;AAAA,QAAM,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAChD,QAAQ;AAAA,QAAM,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAChD,QAAQ;AAAA,QAAM,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAChD,QAAQ;AAAA,QAAM,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAChD,QAAQ;AAAA,QAAM,QAAQ;AAAA,QACtB,QAAQ;AAAA,QAAM,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAC1E,QAAQ;AAAA,QAAM,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAC1E,QAAQ;AAAA,QAAM,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAChD,QAAQ;AAAA,QAAM,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAAK,QAAQ;AAAA,QAChD,QAAQ;AAAA,QAAM,QAAQ;AAAA,QAAK,QAAQ;AAAA,QACnC,QAAQ;AAAA,QAAM,QAAQ;AAAA,QACtB,QAAQ;AAAA,QAAM,QAAQ;AAAA,QACtB,QAAQ;AAAA;AAAA,QAER,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACxD,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACxD,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACxD,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACvE,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACvE,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACxD,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACxD,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACxD,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACvE,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACvE,UAAU;AAAA,QAAM,UAAU;AAAA,QAC1B,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACvE,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACvE,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACxD,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACxD,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACxD,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACxD,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACtF,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QAAK,UAAU;AAAA,QACtF,UAAU;AAAA,QAAM,UAAU;AAAA,QAC1B,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAAK,UAAU;AAAA,QACzC,UAAU;AAAA,QAAM,UAAU;AAAA,QAC1B,UAAU;AAAA,QAAM,UAAU;AAAA,QAC1B,UAAU;AAAA,QAAM,UAAU;AAAA,MAC5B;AAGA,UAAI,cAAc;AAAA,QAChB,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,MACP;AAGA,UAAI,gBAAgB;AAAA,QAClB,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,UAAU;AAAA,QACV,SAAS;AAAA,MACX;AAGA,UAAI,gBAAgB;AAAA,QAClB,MAAM;AAAA,QACN,KAAK;AAAA,QACL,MAAM;AAAA,QACN,MAAM;AAAA,QACN,UAAU;AAAA,QACV,UAAU;AAAA,MACZ;AAGA,UAAI,iBAAiB,YACjB,eAAe;AAGnB,UAAI,aAAa,OAAO,UAAU,YAAY,UAAU,OAAO,WAAW,UAAU;AAGpF,UAAI,WAAW,OAAO,QAAQ,YAAY,QAAQ,KAAK,WAAW,UAAU;AAG5E,UAAI,OAAO,cAAc,YAAY,SAAS,aAAa,EAAE;AAG7D,UAAI,cAAc,OAAO,WAAW,YAAY,WAAW,CAAC,QAAQ,YAAY;AAGhF,UAAI,aAAa,eAAe,OAAO,UAAU,YAAY,UAAU,CAAC,OAAO,YAAY;AAG3F,UAAI,gBAAgB,cAAc,WAAW,YAAY;AAGzD,UAAI,cAAc,iBAAiB,WAAW;AAG9C,UAAI,WAAY,WAAW;AACzB,YAAI;AAEF,cAAI,QAAQ,cAAc,WAAW,WAAW,WAAW,QAAQ,MAAM,EAAE;AAE3E,cAAI,OAAO;AACT,mBAAO;AAAA,UACT;AAGA,iBAAO,eAAe,YAAY,WAAW,YAAY,QAAQ,MAAM;AAAA,QACzE,SAAS,GAAG;AAAA,QAAC;AAAA,MACf,EAAE;AAGF,UAAI,oBAAoB,YAAY,SAAS,eACzC,aAAa,YAAY,SAAS,QAClC,YAAY,YAAY,SAAS,OACjC,eAAe,YAAY,SAAS,UACpC,YAAY,YAAY,SAAS,OACjC,mBAAmB,YAAY,SAAS;AAc5C,eAAS,MAAM,MAAM,SAAS,MAAM;AAClC,gBAAQ,KAAK,QAAQ;AAAA,UACnB,KAAK;AAAG,mBAAO,KAAK,KAAK,OAAO;AAAA,UAChC,KAAK;AAAG,mBAAO,KAAK,KAAK,SAAS,KAAK,CAAC,CAAC;AAAA,UACzC,KAAK;AAAG,mBAAO,KAAK,KAAK,SAAS,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,UAClD,KAAK;AAAG,mBAAO,KAAK,KAAK,SAAS,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,QAC7D;AACA,eAAO,KAAK,MAAM,SAAS,IAAI;AAAA,MACjC;AAYA,eAAS,gBAAgB,OAAO,QAAQ,UAAU,aAAa;AAC7D,YAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM;AAEvC,eAAO,EAAE,QAAQ,QAAQ;AACvB,cAAI,QAAQ,MAAM,KAAK;AACvB,iBAAO,aAAa,OAAO,SAAS,KAAK,GAAG,KAAK;AAAA,QACnD;AACA,eAAO;AAAA,MACT;AAWA,eAAS,UAAU,OAAO,UAAU;AAClC,YAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM;AAEvC,eAAO,EAAE,QAAQ,QAAQ;AACvB,cAAI,SAAS,MAAM,KAAK,GAAG,OAAO,KAAK,MAAM,OAAO;AAClD;AAAA,UACF;AAAA,QACF;AACA,eAAO;AAAA,MACT;AAWA,eAAS,eAAe,OAAO,UAAU;AACvC,YAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AAEvC,eAAO,UAAU;AACf,cAAI,SAAS,MAAM,MAAM,GAAG,QAAQ,KAAK,MAAM,OAAO;AACpD;AAAA,UACF;AAAA,QACF;AACA,eAAO;AAAA,MACT;AAYA,eAAS,WAAW,OAAO,WAAW;AACpC,YAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM;AAEvC,eAAO,EAAE,QAAQ,QAAQ;AACvB,cAAI,CAAC,UAAU,MAAM,KAAK,GAAG,OAAO,KAAK,GAAG;AAC1C,mBAAO;AAAA,UACT;AAAA,QACF;AACA,eAAO;AAAA,MACT;AAWA,eAAS,YAAY,OAAO,WAAW;AACrC,YAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM,QACnC,WAAW,GACX,SAAS,CAAC;AAEd,eAAO,EAAE,QAAQ,QAAQ;AACvB,cAAI,QAAQ,MAAM,KAAK;AACvB,cAAI,UAAU,OAAO,OAAO,KAAK,GAAG;AAClC,mBAAO,UAAU,IAAI;AAAA,UACvB;AAAA,QACF;AACA,eAAO;AAAA,MACT;AAWA,eAAS,cAAc,OAAO,OAAO;AACnC,YAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,eAAO,CAAC,CAAC,UAAU,YAAY,OAAO,OAAO,CAAC,IAAI;AAAA,MACpD;AAWA,eAAS,kBAAkB,OAAO,OAAO,YAAY;AACnD,YAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM;AAEvC,eAAO,EAAE,QAAQ,QAAQ;AACvB,cAAI,WAAW,OAAO,MAAM,KAAK,CAAC,GAAG;AACnC,mBAAO;AAAA,UACT;AAAA,QACF;AACA,eAAO;AAAA,MACT;AAWA,eAAS,SAAS,OAAO,UAAU;AACjC,YAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM,QACnC,SAAS,MAAM,MAAM;AAEzB,eAAO,EAAE,QAAQ,QAAQ;AACvB,iBAAO,KAAK,IAAI,SAAS,MAAM,KAAK,GAAG,OAAO,KAAK;AAAA,QACrD;AACA,eAAO;AAAA,MACT;AAUA,eAAS,UAAU,OAAO,QAAQ;AAChC,YAAI,QAAQ,IACR,SAAS,OAAO,QAChB,SAAS,MAAM;AAEnB,eAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAM,SAAS,KAAK,IAAI,OAAO,KAAK;AAAA,QACtC;AACA,eAAO;AAAA,MACT;AAcA,eAAS,YAAY,OAAO,UAAU,aAAa,WAAW;AAC5D,YAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM;AAEvC,YAAI,aAAa,QAAQ;AACvB,wBAAc,MAAM,EAAE,KAAK;AAAA,QAC7B;AACA,eAAO,EAAE,QAAQ,QAAQ;AACvB,wBAAc,SAAS,aAAa,MAAM,KAAK,GAAG,OAAO,KAAK;AAAA,QAChE;AACA,eAAO;AAAA,MACT;AAcA,eAAS,iBAAiB,OAAO,UAAU,aAAa,WAAW;AACjE,YAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,YAAI,aAAa,QAAQ;AACvB,wBAAc,MAAM,EAAE,MAAM;AAAA,QAC9B;AACA,eAAO,UAAU;AACf,wBAAc,SAAS,aAAa,MAAM,MAAM,GAAG,QAAQ,KAAK;AAAA,QAClE;AACA,eAAO;AAAA,MACT;AAYA,eAAS,UAAU,OAAO,WAAW;AACnC,YAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM;AAEvC,eAAO,EAAE,QAAQ,QAAQ;AACvB,cAAI,UAAU,MAAM,KAAK,GAAG,OAAO,KAAK,GAAG;AACzC,mBAAO;AAAA,UACT;AAAA,QACF;AACA,eAAO;AAAA,MACT;AASA,UAAI,YAAY,aAAa,QAAQ;AASrC,eAAS,aAAa,QAAQ;AAC5B,eAAO,OAAO,MAAM,EAAE;AAAA,MACxB;AASA,eAAS,WAAW,QAAQ;AAC1B,eAAO,OAAO,MAAM,WAAW,KAAK,CAAC;AAAA,MACvC;AAaA,eAAS,YAAY,YAAY,WAAW,UAAU;AACpD,YAAI;AACJ,iBAAS,YAAY,SAAS,OAAO,KAAKC,aAAY;AACpD,cAAI,UAAU,OAAO,KAAKA,WAAU,GAAG;AACrC,qBAAS;AACT,mBAAO;AAAA,UACT;AAAA,QACF,CAAC;AACD,eAAO;AAAA,MACT;AAaA,eAAS,cAAc,OAAO,WAAW,WAAW,WAAW;AAC7D,YAAI,SAAS,MAAM,QACf,QAAQ,aAAa,YAAY,IAAI;AAEzC,eAAQ,YAAY,UAAU,EAAE,QAAQ,QAAS;AAC/C,cAAI,UAAU,MAAM,KAAK,GAAG,OAAO,KAAK,GAAG;AACzC,mBAAO;AAAA,UACT;AAAA,QACF;AACA,eAAO;AAAA,MACT;AAWA,eAAS,YAAY,OAAO,OAAO,WAAW;AAC5C,eAAO,UAAU,QACb,cAAc,OAAO,OAAO,SAAS,IACrC,cAAc,OAAO,WAAW,SAAS;AAAA,MAC/C;AAYA,eAAS,gBAAgB,OAAO,OAAO,WAAW,YAAY;AAC5D,YAAI,QAAQ,YAAY,GACpB,SAAS,MAAM;AAEnB,eAAO,EAAE,QAAQ,QAAQ;AACvB,cAAI,WAAW,MAAM,KAAK,GAAG,KAAK,GAAG;AACnC,mBAAO;AAAA,UACT;AAAA,QACF;AACA,eAAO;AAAA,MACT;AASA,eAAS,UAAU,OAAO;AACxB,eAAO,UAAU;AAAA,MACnB;AAWA,eAAS,SAAS,OAAO,UAAU;AACjC,YAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,eAAO,SAAU,QAAQ,OAAO,QAAQ,IAAI,SAAU;AAAA,MACxD;AASA,eAAS,aAAa,KAAK;AACzB,eAAO,SAAS,QAAQ;AACtB,iBAAO,UAAU,OAAOD,aAAY,OAAO,GAAG;AAAA,QAChD;AAAA,MACF;AASA,eAAS,eAAe,QAAQ;AAC9B,eAAO,SAAS,KAAK;AACnB,iBAAO,UAAU,OAAOA,aAAY,OAAO,GAAG;AAAA,QAChD;AAAA,MACF;AAeA,eAAS,WAAW,YAAY,UAAU,aAAa,WAAW,UAAU;AAC1E,iBAAS,YAAY,SAAS,OAAO,OAAOC,aAAY;AACtD,wBAAc,aACT,YAAY,OAAO,SACpB,SAAS,aAAa,OAAO,OAAOA,WAAU;AAAA,QACpD,CAAC;AACD,eAAO;AAAA,MACT;AAYA,eAAS,WAAW,OAAO,UAAU;AACnC,YAAI,SAAS,MAAM;AAEnB,cAAM,KAAK,QAAQ;AACnB,eAAO,UAAU;AACf,gBAAM,MAAM,IAAI,MAAM,MAAM,EAAE;AAAA,QAChC;AACA,eAAO;AAAA,MACT;AAWA,eAAS,QAAQ,OAAO,UAAU;AAChC,YAAI,QACA,QAAQ,IACR,SAAS,MAAM;AAEnB,eAAO,EAAE,QAAQ,QAAQ;AACvB,cAAI,UAAU,SAAS,MAAM,KAAK,CAAC;AACnC,cAAI,YAAYD,YAAW;AACzB,qBAAS,WAAWA,aAAY,UAAW,SAAS;AAAA,UACtD;AAAA,QACF;AACA,eAAO;AAAA,MACT;AAWA,eAAS,UAAU,GAAG,UAAU;AAC9B,YAAI,QAAQ,IACR,SAAS,MAAM,CAAC;AAEpB,eAAO,EAAE,QAAQ,GAAG;AAClB,iBAAO,KAAK,IAAI,SAAS,KAAK;AAAA,QAChC;AACA,eAAO;AAAA,MACT;AAWA,eAAS,YAAY,QAAQ,OAAO;AAClC,eAAO,SAAS,OAAO,SAAS,KAAK;AACnC,iBAAO,CAAC,KAAK,OAAO,GAAG,CAAC;AAAA,QAC1B,CAAC;AAAA,MACH;AASA,eAAS,SAAS,QAAQ;AACxB,eAAO,SACH,OAAO,MAAM,GAAG,gBAAgB,MAAM,IAAI,CAAC,EAAE,QAAQ,aAAa,EAAE,IACpE;AAAA,MACN;AASA,eAAS,UAAU,MAAM;AACvB,eAAO,SAAS,OAAO;AACrB,iBAAO,KAAK,KAAK;AAAA,QACnB;AAAA,MACF;AAYA,eAAS,WAAW,QAAQ,OAAO;AACjC,eAAO,SAAS,OAAO,SAAS,KAAK;AACnC,iBAAO,OAAO,GAAG;AAAA,QACnB,CAAC;AAAA,MACH;AAUA,eAAS,SAAS,OAAO,KAAK;AAC5B,eAAO,MAAM,IAAI,GAAG;AAAA,MACtB;AAWA,eAAS,gBAAgB,YAAY,YAAY;AAC/C,YAAI,QAAQ,IACR,SAAS,WAAW;AAExB,eAAO,EAAE,QAAQ,UAAU,YAAY,YAAY,WAAW,KAAK,GAAG,CAAC,IAAI,IAAI;AAAA,QAAC;AAChF,eAAO;AAAA,MACT;AAWA,eAAS,cAAc,YAAY,YAAY;AAC7C,YAAI,QAAQ,WAAW;AAEvB,eAAO,WAAW,YAAY,YAAY,WAAW,KAAK,GAAG,CAAC,IAAI,IAAI;AAAA,QAAC;AACvE,eAAO;AAAA,MACT;AAUA,eAAS,aAAa,OAAO,aAAa;AACxC,YAAI,SAAS,MAAM,QACf,SAAS;AAEb,eAAO,UAAU;AACf,cAAI,MAAM,MAAM,MAAM,aAAa;AACjC,cAAE;AAAA,UACJ;AAAA,QACF;AACA,eAAO;AAAA,MACT;AAUA,UAAI,eAAe,eAAe,eAAe;AASjD,UAAI,iBAAiB,eAAe,WAAW;AAS/C,eAAS,iBAAiB,KAAK;AAC7B,eAAO,OAAO,cAAc,GAAG;AAAA,MACjC;AAUA,eAAS,SAAS,QAAQ,KAAK;AAC7B,eAAO,UAAU,OAAOA,aAAY,OAAO,GAAG;AAAA,MAChD;AASA,eAAS,WAAW,QAAQ;AAC1B,eAAO,aAAa,KAAK,MAAM;AAAA,MACjC;AASA,eAAS,eAAe,QAAQ;AAC9B,eAAO,iBAAiB,KAAK,MAAM;AAAA,MACrC;AASA,eAAS,gBAAgB,UAAU;AACjC,YAAIE,OACA,SAAS,CAAC;AAEd,eAAO,EAAEA,QAAO,SAAS,KAAK,GAAG,MAAM;AACrC,iBAAO,KAAKA,MAAK,KAAK;AAAA,QACxB;AACA,eAAO;AAAA,MACT;AASA,eAAS,WAAW,KAAK;AACvB,YAAI,QAAQ,IACR,SAAS,MAAM,IAAI,IAAI;AAE3B,YAAI,QAAQ,SAAS,OAAO,KAAK;AAC/B,iBAAO,EAAE,KAAK,IAAI,CAAC,KAAK,KAAK;AAAA,QAC/B,CAAC;AACD,eAAO;AAAA,MACT;AAUA,eAAS,QAAQ,MAAM,WAAW;AAChC,eAAO,SAAS,KAAK;AACnB,iBAAO,KAAK,UAAU,GAAG,CAAC;AAAA,QAC5B;AAAA,MACF;AAWA,eAAS,eAAe,OAAO,aAAa;AAC1C,YAAI,QAAQ,IACR,SAAS,MAAM,QACf,WAAW,GACX,SAAS,CAAC;AAEd,eAAO,EAAE,QAAQ,QAAQ;AACvB,cAAI,QAAQ,MAAM,KAAK;AACvB,cAAI,UAAU,eAAe,UAAU,aAAa;AAClD,kBAAM,KAAK,IAAI;AACf,mBAAO,UAAU,IAAI;AAAA,UACvB;AAAA,QACF;AACA,eAAO;AAAA,MACT;AASA,eAAS,WAAW,KAAK;AACvB,YAAI,QAAQ,IACR,SAAS,MAAM,IAAI,IAAI;AAE3B,YAAI,QAAQ,SAAS,OAAO;AAC1B,iBAAO,EAAE,KAAK,IAAI;AAAA,QACpB,CAAC;AACD,eAAO;AAAA,MACT;AASA,eAAS,WAAW,KAAK;AACvB,YAAI,QAAQ,IACR,SAAS,MAAM,IAAI,IAAI;AAE3B,YAAI,QAAQ,SAAS,OAAO;AAC1B,iBAAO,EAAE,KAAK,IAAI,CAAC,OAAO,KAAK;AAAA,QACjC,CAAC;AACD,eAAO;AAAA,MACT;AAYA,eAAS,cAAc,OAAO,OAAO,WAAW;AAC9C,YAAI,QAAQ,YAAY,GACpB,SAAS,MAAM;AAEnB,eAAO,EAAE,QAAQ,QAAQ;AACvB,cAAI,MAAM,KAAK,MAAM,OAAO;AAC1B,mBAAO;AAAA,UACT;AAAA,QACF;AACA,eAAO;AAAA,MACT;AAYA,eAAS,kBAAkB,OAAO,OAAO,WAAW;AAClD,YAAI,QAAQ,YAAY;AACxB,eAAO,SAAS;AACd,cAAI,MAAM,KAAK,MAAM,OAAO;AAC1B,mBAAO;AAAA,UACT;AAAA,QACF;AACA,eAAO;AAAA,MACT;AASA,eAAS,WAAW,QAAQ;AAC1B,eAAO,WAAW,MAAM,IACpB,YAAY,MAAM,IAClB,UAAU,MAAM;AAAA,MACtB;AASA,eAAS,cAAc,QAAQ;AAC7B,eAAO,WAAW,MAAM,IACpB,eAAe,MAAM,IACrB,aAAa,MAAM;AAAA,MACzB;AAUA,eAAS,gBAAgB,QAAQ;AAC/B,YAAI,QAAQ,OAAO;AAEnB,eAAO,WAAW,aAAa,KAAK,OAAO,OAAO,KAAK,CAAC,GAAG;AAAA,QAAC;AAC5D,eAAO;AAAA,MACT;AASA,UAAI,mBAAmB,eAAe,aAAa;AASnD,eAAS,YAAY,QAAQ;AAC3B,YAAI,SAAS,UAAU,YAAY;AACnC,eAAO,UAAU,KAAK,MAAM,GAAG;AAC7B,YAAE;AAAA,QACJ;AACA,eAAO;AAAA,MACT;AASA,eAAS,eAAe,QAAQ;AAC9B,eAAO,OAAO,MAAM,SAAS,KAAK,CAAC;AAAA,MACrC;AASA,eAAS,aAAa,QAAQ;AAC5B,eAAO,OAAO,MAAM,aAAa,KAAK,CAAC;AAAA,MACzC;AAiCA,UAAI,eAAgB,SAASC,cAAa,SAAS;AACjD,kBAAU,WAAW,OAAO,OAAO,EAAE,SAAS,KAAK,OAAO,GAAG,SAAS,EAAE,KAAK,MAAM,YAAY,CAAC;AAGhG,YAAIC,SAAQ,QAAQ,OAChBC,QAAO,QAAQ,MACfC,SAAQ,QAAQ,OAChBC,YAAW,QAAQ,UACnBC,QAAO,QAAQ,MACfC,UAAS,QAAQ,QACjBC,UAAS,QAAQ,QACjBC,UAAS,QAAQ,QACjBC,aAAY,QAAQ;AAGxB,YAAI,aAAaR,OAAM,WACnB,YAAYG,UAAS,WACrB,cAAcE,QAAO;AAGzB,YAAI,aAAa,QAAQ,oBAAoB;AAG7C,YAAI,eAAe,UAAU;AAG7B,YAAI,iBAAiB,YAAY;AAGjC,YAAI,YAAY;AAGhB,YAAI,aAAc,WAAW;AAC3B,cAAI,MAAM,SAAS,KAAK,cAAc,WAAW,QAAQ,WAAW,KAAK,YAAY,EAAE;AACvF,iBAAO,MAAO,mBAAmB,MAAO;AAAA,QAC1C,EAAE;AAOF,YAAI,uBAAuB,YAAY;AAGvC,YAAI,mBAAmB,aAAa,KAAKA,OAAM;AAG/C,YAAI,UAAU,KAAK;AAGnB,YAAI,aAAaC;AAAA,UAAO,MACtB,aAAa,KAAK,cAAc,EAAE,QAAQ,cAAc,MAAM,EAC7D,QAAQ,0DAA0D,OAAO,IAAI;AAAA,QAChF;AAGA,YAAIG,UAAS,gBAAgB,QAAQ,SAASb,YAC1Cc,UAAS,QAAQ,QACjBC,cAAa,QAAQ,YACrB,cAAcF,UAASA,QAAO,cAAcb,YAC5C,eAAe,QAAQS,QAAO,gBAAgBA,OAAM,GACpD,eAAeA,QAAO,QACtB,uBAAuB,YAAY,sBACnC,SAAS,WAAW,QACpB,mBAAmBK,UAASA,QAAO,qBAAqBd,YACxD,cAAcc,UAASA,QAAO,WAAWd,YACzC,iBAAiBc,UAASA,QAAO,cAAcd;AAEnD,YAAI,iBAAkB,WAAW;AAC/B,cAAI;AACF,gBAAI,OAAO,UAAUS,SAAQ,gBAAgB;AAC7C,iBAAK,CAAC,GAAG,IAAI,CAAC,CAAC;AACf,mBAAO;AAAA,UACT,SAAS,GAAG;AAAA,UAAC;AAAA,QACf,EAAE;AAGF,YAAI,kBAAkB,QAAQ,iBAAiB,KAAK,gBAAgB,QAAQ,cACxE,SAASJ,SAAQA,MAAK,QAAQ,KAAK,KAAK,OAAOA,MAAK,KACpD,gBAAgB,QAAQ,eAAe,KAAK,cAAc,QAAQ;AAGtE,YAAI,aAAaG,MAAK,MAClB,cAAcA,MAAK,OACnB,mBAAmBC,QAAO,uBAC1B,iBAAiBI,UAASA,QAAO,WAAWb,YAC5C,iBAAiB,QAAQ,UACzB,aAAa,WAAW,MACxB,aAAa,QAAQS,QAAO,MAAMA,OAAM,GACxC,YAAYD,MAAK,KACjB,YAAYA,MAAK,KACjB,YAAYH,MAAK,KACjB,iBAAiB,QAAQ,UACzB,eAAeG,MAAK,QACpB,gBAAgB,WAAW;AAG/B,YAAI,WAAW,UAAU,SAAS,UAAU,GACxCQ,OAAM,UAAU,SAAS,KAAK,GAC9BC,WAAU,UAAU,SAAS,SAAS,GACtCC,OAAM,UAAU,SAAS,KAAK,GAC9BC,WAAU,UAAU,SAAS,SAAS,GACtC,eAAe,UAAUV,SAAQ,QAAQ;AAG7C,YAAI,UAAUU,YAAW,IAAIA;AAG7B,YAAI,YAAY,CAAC;AAGjB,YAAI,qBAAqB,SAAS,QAAQ,GACtC,gBAAgB,SAASH,IAAG,GAC5B,oBAAoB,SAASC,QAAO,GACpC,gBAAgB,SAASC,IAAG,GAC5B,oBAAoB,SAASC,QAAO;AAGxC,YAAI,cAAcL,UAASA,QAAO,YAAYd,YAC1C,gBAAgB,cAAc,YAAY,UAAUA,YACpD,iBAAiB,cAAc,YAAY,WAAWA;AAyH1D,iBAAS,OAAO,OAAO;AACrB,cAAI,aAAa,KAAK,KAAK,CAACoB,SAAQ,KAAK,KAAK,EAAE,iBAAiB,cAAc;AAC7E,gBAAI,iBAAiB,eAAe;AAClC,qBAAO;AAAA,YACT;AACA,gBAAI,eAAe,KAAK,OAAO,aAAa,GAAG;AAC7C,qBAAO,aAAa,KAAK;AAAA,YAC3B;AAAA,UACF;AACA,iBAAO,IAAI,cAAc,KAAK;AAAA,QAChC;AAUA,YAAI,aAAc,WAAW;AAC3B,mBAAS,SAAS;AAAA,UAAC;AACnB,iBAAO,SAAS,OAAO;AACrB,gBAAI,CAACC,UAAS,KAAK,GAAG;AACpB,qBAAO,CAAC;AAAA,YACV;AACA,gBAAI,cAAc;AAChB,qBAAO,aAAa,KAAK;AAAA,YAC3B;AACA,mBAAO,YAAY;AACnB,gBAAIC,UAAS,IAAI;AACjB,mBAAO,YAAYtB;AACnB,mBAAOsB;AAAA,UACT;AAAA,QACF,EAAE;AAOF,iBAAS,aAAa;AAAA,QAEtB;AASA,iBAAS,cAAc,OAAO,UAAU;AACtC,eAAK,cAAc;AACnB,eAAK,cAAc,CAAC;AACpB,eAAK,YAAY,CAAC,CAAC;AACnB,eAAK,YAAY;AACjB,eAAK,aAAatB;AAAA,QACpB;AAWA,eAAO,mBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAQxB,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAQV,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAQZ,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAQf,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAQZ,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAQT,KAAK;AAAA,UACP;AAAA,QACF;AAGA,eAAO,YAAY,WAAW;AAC9B,eAAO,UAAU,cAAc;AAE/B,sBAAc,YAAY,WAAW,WAAW,SAAS;AACzD,sBAAc,UAAU,cAAc;AAWtC,iBAAS,YAAY,OAAO;AAC1B,eAAK,cAAc;AACnB,eAAK,cAAc,CAAC;AACpB,eAAK,UAAU;AACf,eAAK,eAAe;AACpB,eAAK,gBAAgB,CAAC;AACtB,eAAK,gBAAgB;AACrB,eAAK,YAAY,CAAC;AAAA,QACpB;AAUA,iBAAS,YAAY;AACnB,cAAIsB,UAAS,IAAI,YAAY,KAAK,WAAW;AAC7C,UAAAA,QAAO,cAAc,UAAU,KAAK,WAAW;AAC/C,UAAAA,QAAO,UAAU,KAAK;AACtB,UAAAA,QAAO,eAAe,KAAK;AAC3B,UAAAA,QAAO,gBAAgB,UAAU,KAAK,aAAa;AACnD,UAAAA,QAAO,gBAAgB,KAAK;AAC5B,UAAAA,QAAO,YAAY,UAAU,KAAK,SAAS;AAC3C,iBAAOA;AAAA,QACT;AAUA,iBAAS,cAAc;AACrB,cAAI,KAAK,cAAc;AACrB,gBAAIA,UAAS,IAAI,YAAY,IAAI;AACjC,YAAAA,QAAO,UAAU;AACjB,YAAAA,QAAO,eAAe;AAAA,UACxB,OAAO;AACL,YAAAA,UAAS,KAAK,MAAM;AACpB,YAAAA,QAAO,WAAW;AAAA,UACpB;AACA,iBAAOA;AAAA,QACT;AAUA,iBAAS,YAAY;AACnB,cAAI,QAAQ,KAAK,YAAY,MAAM,GAC/B,MAAM,KAAK,SACX,QAAQF,SAAQ,KAAK,GACrB,UAAU,MAAM,GAChB,YAAY,QAAQ,MAAM,SAAS,GACnC,OAAO,QAAQ,GAAG,WAAW,KAAK,SAAS,GAC3C,QAAQ,KAAK,OACb,MAAM,KAAK,KACX,SAAS,MAAM,OACf,QAAQ,UAAU,MAAO,QAAQ,GACjC,YAAY,KAAK,eACjB,aAAa,UAAU,QACvB,WAAW,GACX,YAAY,UAAU,QAAQ,KAAK,aAAa;AAEpD,cAAI,CAAC,SAAU,CAAC,WAAW,aAAa,UAAU,aAAa,QAAS;AACtE,mBAAO,iBAAiB,OAAO,KAAK,WAAW;AAAA,UACjD;AACA,cAAIE,UAAS,CAAC;AAEd;AACA,mBAAO,YAAY,WAAW,WAAW;AACvC,uBAAS;AAET,kBAAI,YAAY,IACZ,QAAQ,MAAM,KAAK;AAEvB,qBAAO,EAAE,YAAY,YAAY;AAC/B,oBAAIpB,QAAO,UAAU,SAAS,GAC1BqB,YAAWrB,MAAK,UAChB,OAAOA,MAAK,MACZ,WAAWqB,UAAS,KAAK;AAE7B,oBAAI,QAAQ,eAAe;AACzB,0BAAQ;AAAA,gBACV,WAAW,CAAC,UAAU;AACpB,sBAAI,QAAQ,kBAAkB;AAC5B,6BAAS;AAAA,kBACX,OAAO;AACL,0BAAM;AAAA,kBACR;AAAA,gBACF;AAAA,cACF;AACA,cAAAD,QAAO,UAAU,IAAI;AAAA,YACvB;AACA,iBAAOA;AAAA,QACT;AAGA,oBAAY,YAAY,WAAW,WAAW,SAAS;AACvD,oBAAY,UAAU,cAAc;AAWpC,iBAAS,KAAK,SAAS;AACrB,cAAI,QAAQ,IACR,SAAS,WAAW,OAAO,IAAI,QAAQ;AAE3C,eAAK,MAAM;AACX,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,QAAQ,QAAQ,KAAK;AACzB,iBAAK,IAAI,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC;AAAA,UAC7B;AAAA,QACF;AASA,iBAAS,YAAY;AACnB,eAAK,WAAW,eAAe,aAAa,IAAI,IAAI,CAAC;AACrD,eAAK,OAAO;AAAA,QACd;AAYA,iBAAS,WAAW,KAAK;AACvB,cAAIA,UAAS,KAAK,IAAI,GAAG,KAAK,OAAO,KAAK,SAAS,GAAG;AACtD,eAAK,QAAQA,UAAS,IAAI;AAC1B,iBAAOA;AAAA,QACT;AAWA,iBAAS,QAAQ,KAAK;AACpB,cAAIpB,QAAO,KAAK;AAChB,cAAI,cAAc;AAChB,gBAAIoB,UAASpB,MAAK,GAAG;AACrB,mBAAOoB,YAAW,iBAAiBtB,aAAYsB;AAAA,UACjD;AACA,iBAAO,eAAe,KAAKpB,OAAM,GAAG,IAAIA,MAAK,GAAG,IAAIF;AAAA,QACtD;AAWA,iBAAS,QAAQ,KAAK;AACpB,cAAIE,QAAO,KAAK;AAChB,iBAAO,eAAgBA,MAAK,GAAG,MAAMF,aAAa,eAAe,KAAKE,OAAM,GAAG;AAAA,QACjF;AAYA,iBAAS,QAAQ,KAAK,OAAO;AAC3B,cAAIA,QAAO,KAAK;AAChB,eAAK,QAAQ,KAAK,IAAI,GAAG,IAAI,IAAI;AACjC,UAAAA,MAAK,GAAG,IAAK,gBAAgB,UAAUF,aAAa,iBAAiB;AACrE,iBAAO;AAAA,QACT;AAGA,aAAK,UAAU,QAAQ;AACvB,aAAK,UAAU,QAAQ,IAAI;AAC3B,aAAK,UAAU,MAAM;AACrB,aAAK,UAAU,MAAM;AACrB,aAAK,UAAU,MAAM;AAWrB,iBAAS,UAAU,SAAS;AAC1B,cAAI,QAAQ,IACR,SAAS,WAAW,OAAO,IAAI,QAAQ;AAE3C,eAAK,MAAM;AACX,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,QAAQ,QAAQ,KAAK;AACzB,iBAAK,IAAI,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC;AAAA,UAC7B;AAAA,QACF;AASA,iBAAS,iBAAiB;AACxB,eAAK,WAAW,CAAC;AACjB,eAAK,OAAO;AAAA,QACd;AAWA,iBAAS,gBAAgB,KAAK;AAC5B,cAAIE,QAAO,KAAK,UACZ,QAAQ,aAAaA,OAAM,GAAG;AAElC,cAAI,QAAQ,GAAG;AACb,mBAAO;AAAA,UACT;AACA,cAAI,YAAYA,MAAK,SAAS;AAC9B,cAAI,SAAS,WAAW;AACtB,YAAAA,MAAK,IAAI;AAAA,UACX,OAAO;AACL,mBAAO,KAAKA,OAAM,OAAO,CAAC;AAAA,UAC5B;AACA,YAAE,KAAK;AACP,iBAAO;AAAA,QACT;AAWA,iBAAS,aAAa,KAAK;AACzB,cAAIA,QAAO,KAAK,UACZ,QAAQ,aAAaA,OAAM,GAAG;AAElC,iBAAO,QAAQ,IAAIF,aAAYE,MAAK,KAAK,EAAE,CAAC;AAAA,QAC9C;AAWA,iBAAS,aAAa,KAAK;AACzB,iBAAO,aAAa,KAAK,UAAU,GAAG,IAAI;AAAA,QAC5C;AAYA,iBAAS,aAAa,KAAK,OAAO;AAChC,cAAIA,QAAO,KAAK,UACZ,QAAQ,aAAaA,OAAM,GAAG;AAElC,cAAI,QAAQ,GAAG;AACb,cAAE,KAAK;AACP,YAAAA,MAAK,KAAK,CAAC,KAAK,KAAK,CAAC;AAAA,UACxB,OAAO;AACL,YAAAA,MAAK,KAAK,EAAE,CAAC,IAAI;AAAA,UACnB;AACA,iBAAO;AAAA,QACT;AAGA,kBAAU,UAAU,QAAQ;AAC5B,kBAAU,UAAU,QAAQ,IAAI;AAChC,kBAAU,UAAU,MAAM;AAC1B,kBAAU,UAAU,MAAM;AAC1B,kBAAU,UAAU,MAAM;AAW1B,iBAAS,SAAS,SAAS;AACzB,cAAI,QAAQ,IACR,SAAS,WAAW,OAAO,IAAI,QAAQ;AAE3C,eAAK,MAAM;AACX,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,QAAQ,QAAQ,KAAK;AACzB,iBAAK,IAAI,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC;AAAA,UAC7B;AAAA,QACF;AASA,iBAAS,gBAAgB;AACvB,eAAK,OAAO;AACZ,eAAK,WAAW;AAAA,YACd,QAAQ,IAAI;AAAA,YACZ,OAAO,KAAKc,QAAO;AAAA,YACnB,UAAU,IAAI;AAAA,UAChB;AAAA,QACF;AAWA,iBAAS,eAAe,KAAK;AAC3B,cAAIM,UAAS,WAAW,MAAM,GAAG,EAAE,QAAQ,EAAE,GAAG;AAChD,eAAK,QAAQA,UAAS,IAAI;AAC1B,iBAAOA;AAAA,QACT;AAWA,iBAAS,YAAY,KAAK;AACxB,iBAAO,WAAW,MAAM,GAAG,EAAE,IAAI,GAAG;AAAA,QACtC;AAWA,iBAAS,YAAY,KAAK;AACxB,iBAAO,WAAW,MAAM,GAAG,EAAE,IAAI,GAAG;AAAA,QACtC;AAYA,iBAAS,YAAY,KAAK,OAAO;AAC/B,cAAIpB,QAAO,WAAW,MAAM,GAAG,GAC3BsB,QAAOtB,MAAK;AAEhB,UAAAA,MAAK,IAAI,KAAK,KAAK;AACnB,eAAK,QAAQA,MAAK,QAAQsB,QAAO,IAAI;AACrC,iBAAO;AAAA,QACT;AAGA,iBAAS,UAAU,QAAQ;AAC3B,iBAAS,UAAU,QAAQ,IAAI;AAC/B,iBAAS,UAAU,MAAM;AACzB,iBAAS,UAAU,MAAM;AACzB,iBAAS,UAAU,MAAM;AAYzB,iBAAS,SAASC,SAAQ;AACxB,cAAI,QAAQ,IACR,SAASA,WAAU,OAAO,IAAIA,QAAO;AAEzC,eAAK,WAAW,IAAI;AACpB,iBAAO,EAAE,QAAQ,QAAQ;AACvB,iBAAK,IAAIA,QAAO,KAAK,CAAC;AAAA,UACxB;AAAA,QACF;AAYA,iBAAS,YAAY,OAAO;AAC1B,eAAK,SAAS,IAAI,OAAO,cAAc;AACvC,iBAAO;AAAA,QACT;AAWA,iBAAS,YAAY,OAAO;AAC1B,iBAAO,KAAK,SAAS,IAAI,KAAK;AAAA,QAChC;AAGA,iBAAS,UAAU,MAAM,SAAS,UAAU,OAAO;AACnD,iBAAS,UAAU,MAAM;AAWzB,iBAAS,MAAM,SAAS;AACtB,cAAIvB,QAAO,KAAK,WAAW,IAAI,UAAU,OAAO;AAChD,eAAK,OAAOA,MAAK;AAAA,QACnB;AASA,iBAAS,aAAa;AACpB,eAAK,WAAW,IAAI;AACpB,eAAK,OAAO;AAAA,QACd;AAWA,iBAAS,YAAY,KAAK;AACxB,cAAIA,QAAO,KAAK,UACZoB,UAASpB,MAAK,QAAQ,EAAE,GAAG;AAE/B,eAAK,OAAOA,MAAK;AACjB,iBAAOoB;AAAA,QACT;AAWA,iBAAS,SAAS,KAAK;AACrB,iBAAO,KAAK,SAAS,IAAI,GAAG;AAAA,QAC9B;AAWA,iBAAS,SAAS,KAAK;AACrB,iBAAO,KAAK,SAAS,IAAI,GAAG;AAAA,QAC9B;AAYA,iBAAS,SAAS,KAAK,OAAO;AAC5B,cAAIpB,QAAO,KAAK;AAChB,cAAIA,iBAAgB,WAAW;AAC7B,gBAAI,QAAQA,MAAK;AACjB,gBAAI,CAACc,QAAQ,MAAM,SAAS,mBAAmB,GAAI;AACjD,oBAAM,KAAK,CAAC,KAAK,KAAK,CAAC;AACvB,mBAAK,OAAO,EAAEd,MAAK;AACnB,qBAAO;AAAA,YACT;AACA,YAAAA,QAAO,KAAK,WAAW,IAAI,SAAS,KAAK;AAAA,UAC3C;AACA,UAAAA,MAAK,IAAI,KAAK,KAAK;AACnB,eAAK,OAAOA,MAAK;AACjB,iBAAO;AAAA,QACT;AAGA,cAAM,UAAU,QAAQ;AACxB,cAAM,UAAU,QAAQ,IAAI;AAC5B,cAAM,UAAU,MAAM;AACtB,cAAM,UAAU,MAAM;AACtB,cAAM,UAAU,MAAM;AAYtB,iBAAS,cAAc,OAAO,WAAW;AACvC,cAAI,QAAQkB,SAAQ,KAAK,GACrB,QAAQ,CAAC,SAAS,YAAY,KAAK,GACnC,SAAS,CAAC,SAAS,CAAC,SAAS,SAAS,KAAK,GAC3C,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,UAAU,aAAa,KAAK,GAC1D,cAAc,SAAS,SAAS,UAAU,QAC1CE,UAAS,cAAc,UAAU,MAAM,QAAQX,OAAM,IAAI,CAAC,GAC1D,SAASW,QAAO;AAEpB,mBAAS,OAAO,OAAO;AACrB,iBAAK,aAAa,eAAe,KAAK,OAAO,GAAG,MAC5C,EAAE;AAAA,aAEC,OAAO;AAAA,YAEN,WAAW,OAAO,YAAY,OAAO;AAAA,YAErC,WAAW,OAAO,YAAY,OAAO,gBAAgB,OAAO;AAAA,YAE7D,QAAQ,KAAK,MAAM,KAClB;AACN,cAAAA,QAAO,KAAK,GAAG;AAAA,YACjB;AAAA,UACF;AACA,iBAAOA;AAAA,QACT;AASA,iBAAS,YAAY,OAAO;AAC1B,cAAI,SAAS,MAAM;AACnB,iBAAO,SAAS,MAAM,WAAW,GAAG,SAAS,CAAC,CAAC,IAAItB;AAAA,QACrD;AAUA,iBAAS,gBAAgB,OAAO,GAAG;AACjC,iBAAO,YAAY,UAAU,KAAK,GAAG,UAAU,GAAG,GAAG,MAAM,MAAM,CAAC;AAAA,QACpE;AASA,iBAAS,aAAa,OAAO;AAC3B,iBAAO,YAAY,UAAU,KAAK,CAAC;AAAA,QACrC;AAWA,iBAAS,iBAAiB,QAAQ,KAAK,OAAO;AAC5C,cAAK,UAAUA,cAAa,CAAC,GAAG,OAAO,GAAG,GAAG,KAAK,KAC7C,UAAUA,cAAa,EAAE,OAAO,SAAU;AAC7C,4BAAgB,QAAQ,KAAK,KAAK;AAAA,UACpC;AAAA,QACF;AAYA,iBAAS,YAAY,QAAQ,KAAK,OAAO;AACvC,cAAI,WAAW,OAAO,GAAG;AACzB,cAAI,EAAE,eAAe,KAAK,QAAQ,GAAG,KAAK,GAAG,UAAU,KAAK,MACvD,UAAUA,cAAa,EAAE,OAAO,SAAU;AAC7C,4BAAgB,QAAQ,KAAK,KAAK;AAAA,UACpC;AAAA,QACF;AAUA,iBAAS,aAAa,OAAO,KAAK;AAChC,cAAI,SAAS,MAAM;AACnB,iBAAO,UAAU;AACf,gBAAI,GAAG,MAAM,MAAM,EAAE,CAAC,GAAG,GAAG,GAAG;AAC7B,qBAAO;AAAA,YACT;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAaA,iBAAS,eAAe,YAAY,QAAQuB,WAAU,aAAa;AACjE,mBAAS,YAAY,SAAS,OAAO,KAAKtB,aAAY;AACpD,mBAAO,aAAa,OAAOsB,UAAS,KAAK,GAAGtB,WAAU;AAAA,UACxD,CAAC;AACD,iBAAO;AAAA,QACT;AAWA,iBAAS,WAAW,QAAQ,QAAQ;AAClC,iBAAO,UAAU,WAAW,QAAQ,KAAK,MAAM,GAAG,MAAM;AAAA,QAC1D;AAWA,iBAAS,aAAa,QAAQ,QAAQ;AACpC,iBAAO,UAAU,WAAW,QAAQ,OAAO,MAAM,GAAG,MAAM;AAAA,QAC5D;AAWA,iBAAS,gBAAgB,QAAQ,KAAK,OAAO;AAC3C,cAAI,OAAO,eAAe,gBAAgB;AACxC,2BAAe,QAAQ,KAAK;AAAA,cAC1B,gBAAgB;AAAA,cAChB,cAAc;AAAA,cACd,SAAS;AAAA,cACT,YAAY;AAAA,YACd,CAAC;AAAA,UACH,OAAO;AACL,mBAAO,GAAG,IAAI;AAAA,UAChB;AAAA,QACF;AAUA,iBAAS,OAAO,QAAQ,OAAO;AAC7B,cAAI,QAAQ,IACR,SAAS,MAAM,QACfqB,UAASlB,OAAM,MAAM,GACrB,OAAO,UAAU;AAErB,iBAAO,EAAE,QAAQ,QAAQ;AACvB,YAAAkB,QAAO,KAAK,IAAI,OAAOtB,aAAY,IAAI,QAAQ,MAAM,KAAK,CAAC;AAAA,UAC7D;AACA,iBAAOsB;AAAA,QACT;AAWA,iBAAS,UAAU,QAAQ,OAAO,OAAO;AACvC,cAAI,WAAW,QAAQ;AACrB,gBAAI,UAAUtB,YAAW;AACvB,uBAAS,UAAU,QAAQ,SAAS;AAAA,YACtC;AACA,gBAAI,UAAUA,YAAW;AACvB,uBAAS,UAAU,QAAQ,SAAS;AAAA,YACtC;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAkBA,iBAAS,UAAU,OAAO,SAAS0B,aAAY,KAAK,QAAQ,OAAO;AACjE,cAAIJ,SACA,SAAS,UAAU,iBACnB,SAAS,UAAU,iBACnB,SAAS,UAAU;AAEvB,cAAII,aAAY;AACd,YAAAJ,UAAS,SAASI,YAAW,OAAO,KAAK,QAAQ,KAAK,IAAIA,YAAW,KAAK;AAAA,UAC5E;AACA,cAAIJ,YAAWtB,YAAW;AACxB,mBAAOsB;AAAA,UACT;AACA,cAAI,CAACD,UAAS,KAAK,GAAG;AACpB,mBAAO;AAAA,UACT;AACA,cAAI,QAAQD,SAAQ,KAAK;AACzB,cAAI,OAAO;AACT,YAAAE,UAAS,eAAe,KAAK;AAC7B,gBAAI,CAAC,QAAQ;AACX,qBAAO,UAAU,OAAOA,OAAM;AAAA,YAChC;AAAA,UACF,OAAO;AACL,gBAAI,MAAM,OAAO,KAAK,GAClB,SAAS,OAAO,WAAW,OAAO;AAEtC,gBAAI,SAAS,KAAK,GAAG;AACnB,qBAAO,YAAY,OAAO,MAAM;AAAA,YAClC;AACA,gBAAI,OAAO,aAAa,OAAO,WAAY,UAAU,CAAC,QAAS;AAC7D,cAAAA,UAAU,UAAU,SAAU,CAAC,IAAI,gBAAgB,KAAK;AACxD,kBAAI,CAAC,QAAQ;AACX,uBAAO,SACH,cAAc,OAAO,aAAaA,SAAQ,KAAK,CAAC,IAChD,YAAY,OAAO,WAAWA,SAAQ,KAAK,CAAC;AAAA,cAClD;AAAA,YACF,OAAO;AACL,kBAAI,CAAC,cAAc,GAAG,GAAG;AACvB,uBAAO,SAAS,QAAQ,CAAC;AAAA,cAC3B;AACA,cAAAA,UAAS,eAAe,OAAO,KAAK,MAAM;AAAA,YAC5C;AAAA,UACF;AAEA,oBAAU,QAAQ,IAAI;AACtB,cAAI,UAAU,MAAM,IAAI,KAAK;AAC7B,cAAI,SAAS;AACX,mBAAO;AAAA,UACT;AACA,gBAAM,IAAI,OAAOA,OAAM;AAEvB,cAAI,MAAM,KAAK,GAAG;AAChB,kBAAM,QAAQ,SAAS,UAAU;AAC/B,cAAAA,QAAO,IAAI,UAAU,UAAU,SAASI,aAAY,UAAU,OAAO,KAAK,CAAC;AAAA,YAC7E,CAAC;AAAA,UACH,WAAW,MAAM,KAAK,GAAG;AACvB,kBAAM,QAAQ,SAAS,UAAUC,MAAK;AACpC,cAAAL,QAAO,IAAIK,MAAK,UAAU,UAAU,SAASD,aAAYC,MAAK,OAAO,KAAK,CAAC;AAAA,YAC7E,CAAC;AAAA,UACH;AAEA,cAAI,WAAW,SACV,SAAS,eAAe,aACxB,SAAS,SAAS;AAEvB,cAAI,QAAQ,QAAQ3B,aAAY,SAAS,KAAK;AAC9C,oBAAU,SAAS,OAAO,SAAS,UAAU2B,MAAK;AAChD,gBAAI,OAAO;AACT,cAAAA,OAAM;AACN,yBAAW,MAAMA,IAAG;AAAA,YACtB;AAEA,wBAAYL,SAAQK,MAAK,UAAU,UAAU,SAASD,aAAYC,MAAK,OAAO,KAAK,CAAC;AAAA,UACtF,CAAC;AACD,iBAAOL;AAAA,QACT;AASA,iBAAS,aAAa,QAAQ;AAC5B,cAAI,QAAQ,KAAK,MAAM;AACvB,iBAAO,SAAS,QAAQ;AACtB,mBAAO,eAAe,QAAQ,QAAQ,KAAK;AAAA,UAC7C;AAAA,QACF;AAUA,iBAAS,eAAe,QAAQ,QAAQ,OAAO;AAC7C,cAAI,SAAS,MAAM;AACnB,cAAI,UAAU,MAAM;AAClB,mBAAO,CAAC;AAAA,UACV;AACA,mBAASb,QAAO,MAAM;AACtB,iBAAO,UAAU;AACf,gBAAI,MAAM,MAAM,MAAM,GAClB,YAAY,OAAO,GAAG,GACtB,QAAQ,OAAO,GAAG;AAEtB,gBAAK,UAAUT,cAAa,EAAE,OAAO,WAAY,CAAC,UAAU,KAAK,GAAG;AAClE,qBAAO;AAAA,YACT;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAYA,iBAAS,UAAU,MAAM,MAAM,MAAM;AACnC,cAAI,OAAO,QAAQ,YAAY;AAC7B,kBAAM,IAAIY,WAAU,eAAe;AAAA,UACrC;AACA,iBAAOgB,YAAW,WAAW;AAAE,iBAAK,MAAM5B,YAAW,IAAI;AAAA,UAAG,GAAG,IAAI;AAAA,QACrE;AAaA,iBAAS,eAAe,OAAOyB,SAAQF,WAAU,YAAY;AAC3D,cAAI,QAAQ,IACRM,YAAW,eACX,WAAW,MACX,SAAS,MAAM,QACfP,UAAS,CAAC,GACV,eAAeG,QAAO;AAE1B,cAAI,CAAC,QAAQ;AACX,mBAAOH;AAAA,UACT;AACA,cAAIC,WAAU;AACZ,YAAAE,UAAS,SAASA,SAAQ,UAAUF,SAAQ,CAAC;AAAA,UAC/C;AACA,cAAI,YAAY;AACd,YAAAM,YAAW;AACX,uBAAW;AAAA,UACb,WACSJ,QAAO,UAAU,kBAAkB;AAC1C,YAAAI,YAAW;AACX,uBAAW;AACX,YAAAJ,UAAS,IAAI,SAASA,OAAM;AAAA,UAC9B;AACA;AACA,mBAAO,EAAE,QAAQ,QAAQ;AACvB,kBAAI,QAAQ,MAAM,KAAK,GACnB,WAAWF,aAAY,OAAO,QAAQA,UAAS,KAAK;AAExD,sBAAS,cAAc,UAAU,IAAK,QAAQ;AAC9C,kBAAI,YAAY,aAAa,UAAU;AACrC,oBAAI,cAAc;AAClB,uBAAO,eAAe;AACpB,sBAAIE,QAAO,WAAW,MAAM,UAAU;AACpC,6BAAS;AAAA,kBACX;AAAA,gBACF;AACA,gBAAAH,QAAO,KAAK,KAAK;AAAA,cACnB,WACS,CAACO,UAASJ,SAAQ,UAAU,UAAU,GAAG;AAChD,gBAAAH,QAAO,KAAK,KAAK;AAAA,cACnB;AAAA,YACF;AACA,iBAAOA;AAAA,QACT;AAUA,YAAI,WAAW,eAAe,UAAU;AAUxC,YAAI,gBAAgB,eAAe,iBAAiB,IAAI;AAWxD,iBAAS,UAAU,YAAY,WAAW;AACxC,cAAIA,UAAS;AACb,mBAAS,YAAY,SAAS,OAAO,OAAOrB,aAAY;AACtD,YAAAqB,UAAS,CAAC,CAAC,UAAU,OAAO,OAAOrB,WAAU;AAC7C,mBAAOqB;AAAA,UACT,CAAC;AACD,iBAAOA;AAAA,QACT;AAYA,iBAAS,aAAa,OAAOC,WAAU,YAAY;AACjD,cAAI,QAAQ,IACR,SAAS,MAAM;AAEnB,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,QAAQ,MAAM,KAAK,GACnB,UAAUA,UAAS,KAAK;AAE5B,gBAAI,WAAW,SAAS,aAAavB,aAC5B,YAAY,WAAW,CAAC,SAAS,OAAO,IACzC,WAAW,SAAS,QAAQ,IAC7B;AACL,kBAAI,WAAW,SACXsB,UAAS;AAAA,YACf;AAAA,UACF;AACA,iBAAOA;AAAA,QACT;AAYA,iBAAS,SAAS,OAAO,OAAO,OAAO,KAAK;AAC1C,cAAI,SAAS,MAAM;AAEnB,kBAAQ,UAAU,KAAK;AACvB,cAAI,QAAQ,GAAG;AACb,oBAAQ,CAAC,QAAQ,SAAS,IAAK,SAAS;AAAA,UAC1C;AACA,gBAAO,QAAQtB,cAAa,MAAM,SAAU,SAAS,UAAU,GAAG;AAClE,cAAI,MAAM,GAAG;AACX,mBAAO;AAAA,UACT;AACA,gBAAM,QAAQ,MAAM,IAAI,SAAS,GAAG;AACpC,iBAAO,QAAQ,KAAK;AAClB,kBAAM,OAAO,IAAI;AAAA,UACnB;AACA,iBAAO;AAAA,QACT;AAUA,iBAAS,WAAW,YAAY,WAAW;AACzC,cAAIsB,UAAS,CAAC;AACd,mBAAS,YAAY,SAAS,OAAO,OAAOrB,aAAY;AACtD,gBAAI,UAAU,OAAO,OAAOA,WAAU,GAAG;AACvC,cAAAqB,QAAO,KAAK,KAAK;AAAA,YACnB;AAAA,UACF,CAAC;AACD,iBAAOA;AAAA,QACT;AAaA,iBAAS,YAAY,OAAO,OAAO,WAAW,UAAUA,SAAQ;AAC9D,cAAI,QAAQ,IACR,SAAS,MAAM;AAEnB,wBAAc,YAAY;AAC1B,UAAAA,YAAWA,UAAS,CAAC;AAErB,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,QAAQ,MAAM,KAAK;AACvB,gBAAI,QAAQ,KAAK,UAAU,KAAK,GAAG;AACjC,kBAAI,QAAQ,GAAG;AAEb,4BAAY,OAAO,QAAQ,GAAG,WAAW,UAAUA,OAAM;AAAA,cAC3D,OAAO;AACL,0BAAUA,SAAQ,KAAK;AAAA,cACzB;AAAA,YACF,WAAW,CAAC,UAAU;AACpB,cAAAA,QAAOA,QAAO,MAAM,IAAI;AAAA,YAC1B;AAAA,UACF;AACA,iBAAOA;AAAA,QACT;AAaA,YAAI,UAAU,cAAc;AAY5B,YAAI,eAAe,cAAc,IAAI;AAUrC,iBAAS,WAAW,QAAQC,WAAU;AACpC,iBAAO,UAAU,QAAQ,QAAQA,WAAU,IAAI;AAAA,QACjD;AAUA,iBAAS,gBAAgB,QAAQA,WAAU;AACzC,iBAAO,UAAU,aAAa,QAAQA,WAAU,IAAI;AAAA,QACtD;AAWA,iBAAS,cAAc,QAAQ,OAAO;AACpC,iBAAO,YAAY,OAAO,SAAS,KAAK;AACtC,mBAAO,WAAW,OAAO,GAAG,CAAC;AAAA,UAC/B,CAAC;AAAA,QACH;AAUA,iBAAS,QAAQ,QAAQ,MAAM;AAC7B,iBAAO,SAAS,MAAM,MAAM;AAE5B,cAAI,QAAQ,GACR,SAAS,KAAK;AAElB,iBAAO,UAAU,QAAQ,QAAQ,QAAQ;AACvC,qBAAS,OAAO,MAAM,KAAK,OAAO,CAAC,CAAC;AAAA,UACtC;AACA,iBAAQ,SAAS,SAAS,SAAU,SAASvB;AAAA,QAC/C;AAaA,iBAAS,eAAe,QAAQ,UAAU,aAAa;AACrD,cAAIsB,UAAS,SAAS,MAAM;AAC5B,iBAAOF,SAAQ,MAAM,IAAIE,UAAS,UAAUA,SAAQ,YAAY,MAAM,CAAC;AAAA,QACzE;AASA,iBAAS,WAAW,OAAO;AACzB,cAAI,SAAS,MAAM;AACjB,mBAAO,UAAUtB,aAAY,eAAe;AAAA,UAC9C;AACA,iBAAQ,kBAAkB,kBAAkBS,QAAO,KAAK,IACpD,UAAU,KAAK,IACf,eAAe,KAAK;AAAA,QAC1B;AAWA,iBAAS,OAAO,OAAO,OAAO;AAC5B,iBAAO,QAAQ;AAAA,QACjB;AAUA,iBAAS,QAAQ,QAAQ,KAAK;AAC5B,iBAAO,UAAU,QAAQ,eAAe,KAAK,QAAQ,GAAG;AAAA,QAC1D;AAUA,iBAAS,UAAU,QAAQ,KAAK;AAC9B,iBAAO,UAAU,QAAQ,OAAOA,QAAO,MAAM;AAAA,QAC/C;AAWA,iBAAS,YAAY,QAAQ,OAAO,KAAK;AACvC,iBAAO,UAAU,UAAU,OAAO,GAAG,KAAK,SAAS,UAAU,OAAO,GAAG;AAAA,QACzE;AAYA,iBAAS,iBAAiB,QAAQc,WAAU,YAAY;AACtD,cAAIM,YAAW,aAAa,oBAAoB,eAC5C,SAAS,OAAO,CAAC,EAAE,QACnB,YAAY,OAAO,QACnB,WAAW,WACX,SAASzB,OAAM,SAAS,GACxB,YAAY,UACZkB,UAAS,CAAC;AAEd,iBAAO,YAAY;AACjB,gBAAI,QAAQ,OAAO,QAAQ;AAC3B,gBAAI,YAAYC,WAAU;AACxB,sBAAQ,SAAS,OAAO,UAAUA,SAAQ,CAAC;AAAA,YAC7C;AACA,wBAAY,UAAU,MAAM,QAAQ,SAAS;AAC7C,mBAAO,QAAQ,IAAI,CAAC,eAAeA,aAAa,UAAU,OAAO,MAAM,UAAU,OAC7E,IAAI,SAAS,YAAY,KAAK,IAC9BvB;AAAA,UACN;AACA,kBAAQ,OAAO,CAAC;AAEhB,cAAI,QAAQ,IACR,OAAO,OAAO,CAAC;AAEnB;AACA,mBAAO,EAAE,QAAQ,UAAUsB,QAAO,SAAS,WAAW;AACpD,kBAAI,QAAQ,MAAM,KAAK,GACnB,WAAWC,YAAWA,UAAS,KAAK,IAAI;AAE5C,sBAAS,cAAc,UAAU,IAAK,QAAQ;AAC9C,kBAAI,EAAE,OACE,SAAS,MAAM,QAAQ,IACvBM,UAASP,SAAQ,UAAU,UAAU,IACtC;AACL,2BAAW;AACX,uBAAO,EAAE,UAAU;AACjB,sBAAI,QAAQ,OAAO,QAAQ;AAC3B,sBAAI,EAAE,QACE,SAAS,OAAO,QAAQ,IACxBO,UAAS,OAAO,QAAQ,GAAG,UAAU,UAAU,IACjD;AACJ,6BAAS;AAAA,kBACX;AAAA,gBACF;AACA,oBAAI,MAAM;AACR,uBAAK,KAAK,QAAQ;AAAA,gBACpB;AACA,gBAAAP,QAAO,KAAK,KAAK;AAAA,cACnB;AAAA,YACF;AACA,iBAAOA;AAAA,QACT;AAaA,iBAAS,aAAa,QAAQ,QAAQC,WAAU,aAAa;AAC3D,qBAAW,QAAQ,SAAS,OAAO,KAAKO,SAAQ;AAC9C,mBAAO,aAAaP,UAAS,KAAK,GAAG,KAAKO,OAAM;AAAA,UAClD,CAAC;AACD,iBAAO;AAAA,QACT;AAYA,iBAAS,WAAW,QAAQ,MAAM,MAAM;AACtC,iBAAO,SAAS,MAAM,MAAM;AAC5B,mBAAS,OAAO,QAAQ,IAAI;AAC5B,cAAI,OAAO,UAAU,OAAO,SAAS,OAAO,MAAM,KAAK,IAAI,CAAC,CAAC;AAC7D,iBAAO,QAAQ,OAAO9B,aAAY,MAAM,MAAM,QAAQ,IAAI;AAAA,QAC5D;AASA,iBAAS,gBAAgB,OAAO;AAC9B,iBAAO,aAAa,KAAK,KAAK,WAAW,KAAK,KAAK;AAAA,QACrD;AASA,iBAAS,kBAAkB,OAAO;AAChC,iBAAO,aAAa,KAAK,KAAK,WAAW,KAAK,KAAK;AAAA,QACrD;AASA,iBAAS,WAAW,OAAO;AACzB,iBAAO,aAAa,KAAK,KAAK,WAAW,KAAK,KAAK;AAAA,QACrD;AAgBA,iBAAS,YAAY,OAAO,OAAO,SAAS0B,aAAY,OAAO;AAC7D,cAAI,UAAU,OAAO;AACnB,mBAAO;AAAA,UACT;AACA,cAAI,SAAS,QAAQ,SAAS,QAAS,CAAC,aAAa,KAAK,KAAK,CAAC,aAAa,KAAK,GAAI;AACpF,mBAAO,UAAU,SAAS,UAAU;AAAA,UACtC;AACA,iBAAO,gBAAgB,OAAO,OAAO,SAASA,aAAY,aAAa,KAAK;AAAA,QAC9E;AAgBA,iBAAS,gBAAgB,QAAQ,OAAO,SAASA,aAAY,WAAW,OAAO;AAC7E,cAAI,WAAWN,SAAQ,MAAM,GACzB,WAAWA,SAAQ,KAAK,GACxB,SAAS,WAAW,WAAW,OAAO,MAAM,GAC5C,SAAS,WAAW,WAAW,OAAO,KAAK;AAE/C,mBAAS,UAAU,UAAU,YAAY;AACzC,mBAAS,UAAU,UAAU,YAAY;AAEzC,cAAI,WAAW,UAAU,WACrB,WAAW,UAAU,WACrB,YAAY,UAAU;AAE1B,cAAI,aAAa,SAAS,MAAM,GAAG;AACjC,gBAAI,CAAC,SAAS,KAAK,GAAG;AACpB,qBAAO;AAAA,YACT;AACA,uBAAW;AACX,uBAAW;AAAA,UACb;AACA,cAAI,aAAa,CAAC,UAAU;AAC1B,sBAAU,QAAQ,IAAI;AACtB,mBAAQ,YAAY,aAAa,MAAM,IACnC,YAAY,QAAQ,OAAO,SAASM,aAAY,WAAW,KAAK,IAChE,WAAW,QAAQ,OAAO,QAAQ,SAASA,aAAY,WAAW,KAAK;AAAA,UAC7E;AACA,cAAI,EAAE,UAAU,uBAAuB;AACrC,gBAAI,eAAe,YAAY,eAAe,KAAK,QAAQ,aAAa,GACpE,eAAe,YAAY,eAAe,KAAK,OAAO,aAAa;AAEvE,gBAAI,gBAAgB,cAAc;AAChC,kBAAI,eAAe,eAAe,OAAO,MAAM,IAAI,QAC/C,eAAe,eAAe,MAAM,MAAM,IAAI;AAElD,wBAAU,QAAQ,IAAI;AACtB,qBAAO,UAAU,cAAc,cAAc,SAASA,aAAY,KAAK;AAAA,YACzE;AAAA,UACF;AACA,cAAI,CAAC,WAAW;AACd,mBAAO;AAAA,UACT;AACA,oBAAU,QAAQ,IAAI;AACtB,iBAAO,aAAa,QAAQ,OAAO,SAASA,aAAY,WAAW,KAAK;AAAA,QAC1E;AASA,iBAAS,UAAU,OAAO;AACxB,iBAAO,aAAa,KAAK,KAAK,OAAO,KAAK,KAAK;AAAA,QACjD;AAYA,iBAAS,YAAY,QAAQ,QAAQ,WAAWA,aAAY;AAC1D,cAAI,QAAQ,UAAU,QAClB,SAAS,OACT,eAAe,CAACA;AAEpB,cAAI,UAAU,MAAM;AAClB,mBAAO,CAAC;AAAA,UACV;AACA,mBAASjB,QAAO,MAAM;AACtB,iBAAO,SAAS;AACd,gBAAIP,QAAO,UAAU,KAAK;AAC1B,gBAAK,gBAAgBA,MAAK,CAAC,IACnBA,MAAK,CAAC,MAAM,OAAOA,MAAK,CAAC,CAAC,IAC1B,EAAEA,MAAK,CAAC,KAAK,SACf;AACJ,qBAAO;AAAA,YACT;AAAA,UACF;AACA,iBAAO,EAAE,QAAQ,QAAQ;AACvB,YAAAA,QAAO,UAAU,KAAK;AACtB,gBAAI,MAAMA,MAAK,CAAC,GACZ,WAAW,OAAO,GAAG,GACrB,WAAWA,MAAK,CAAC;AAErB,gBAAI,gBAAgBA,MAAK,CAAC,GAAG;AAC3B,kBAAI,aAAaF,cAAa,EAAE,OAAO,SAAS;AAC9C,uBAAO;AAAA,cACT;AAAA,YACF,OAAO;AACL,kBAAI,QAAQ,IAAI;AAChB,kBAAI0B,aAAY;AACd,oBAAIJ,UAASI,YAAW,UAAU,UAAU,KAAK,QAAQ,QAAQ,KAAK;AAAA,cACxE;AACA,kBAAI,EAAEJ,YAAWtB,aACT,YAAY,UAAU,UAAU,uBAAuB,wBAAwB0B,aAAY,KAAK,IAChGJ,UACD;AACL,uBAAO;AAAA,cACT;AAAA,YACF;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAUA,iBAAS,aAAa,OAAO;AAC3B,cAAI,CAACD,UAAS,KAAK,KAAK,SAAS,KAAK,GAAG;AACvC,mBAAO;AAAA,UACT;AACA,cAAI,UAAU,WAAW,KAAK,IAAI,aAAa;AAC/C,iBAAO,QAAQ,KAAK,SAAS,KAAK,CAAC;AAAA,QACrC;AASA,iBAAS,aAAa,OAAO;AAC3B,iBAAO,aAAa,KAAK,KAAK,WAAW,KAAK,KAAK;AAAA,QACrD;AASA,iBAAS,UAAU,OAAO;AACxB,iBAAO,aAAa,KAAK,KAAK,OAAO,KAAK,KAAK;AAAA,QACjD;AASA,iBAAS,iBAAiB,OAAO;AAC/B,iBAAO,aAAa,KAAK,KACvB,SAAS,MAAM,MAAM,KAAK,CAAC,CAAC,eAAe,WAAW,KAAK,CAAC;AAAA,QAChE;AASA,iBAAS,aAAa,OAAO;AAG3B,cAAI,OAAO,SAAS,YAAY;AAC9B,mBAAO;AAAA,UACT;AACA,cAAI,SAAS,MAAM;AACjB,mBAAO;AAAA,UACT;AACA,cAAI,OAAO,SAAS,UAAU;AAC5B,mBAAOD,SAAQ,KAAK,IAChB,oBAAoB,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC,IACtC,YAAY,KAAK;AAAA,UACvB;AACA,iBAAO,SAAS,KAAK;AAAA,QACvB;AASA,iBAAS,SAAS,QAAQ;AACxB,cAAI,CAAC,YAAY,MAAM,GAAG;AACxB,mBAAO,WAAW,MAAM;AAAA,UAC1B;AACA,cAAIE,UAAS,CAAC;AACd,mBAAS,OAAOb,QAAO,MAAM,GAAG;AAC9B,gBAAI,eAAe,KAAK,QAAQ,GAAG,KAAK,OAAO,eAAe;AAC5D,cAAAa,QAAO,KAAK,GAAG;AAAA,YACjB;AAAA,UACF;AACA,iBAAOA;AAAA,QACT;AASA,iBAAS,WAAW,QAAQ;AAC1B,cAAI,CAACD,UAAS,MAAM,GAAG;AACrB,mBAAO,aAAa,MAAM;AAAA,UAC5B;AACA,cAAI,UAAU,YAAY,MAAM,GAC5BC,UAAS,CAAC;AAEd,mBAAS,OAAO,QAAQ;AACtB,gBAAI,EAAE,OAAO,kBAAkB,WAAW,CAAC,eAAe,KAAK,QAAQ,GAAG,KAAK;AAC7E,cAAAA,QAAO,KAAK,GAAG;AAAA,YACjB;AAAA,UACF;AACA,iBAAOA;AAAA,QACT;AAWA,iBAAS,OAAO,OAAO,OAAO;AAC5B,iBAAO,QAAQ;AAAA,QACjB;AAUA,iBAAS,QAAQ,YAAYC,WAAU;AACrC,cAAI,QAAQ,IACRD,UAAS,YAAY,UAAU,IAAIlB,OAAM,WAAW,MAAM,IAAI,CAAC;AAEnE,mBAAS,YAAY,SAAS,OAAO,KAAKH,aAAY;AACpD,YAAAqB,QAAO,EAAE,KAAK,IAAIC,UAAS,OAAO,KAAKtB,WAAU;AAAA,UACnD,CAAC;AACD,iBAAOqB;AAAA,QACT;AASA,iBAAS,YAAY,QAAQ;AAC3B,cAAI,YAAY,aAAa,MAAM;AACnC,cAAI,UAAU,UAAU,KAAK,UAAU,CAAC,EAAE,CAAC,GAAG;AAC5C,mBAAO,wBAAwB,UAAU,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,EAAE,CAAC,CAAC;AAAA,UACjE;AACA,iBAAO,SAAS,QAAQ;AACtB,mBAAO,WAAW,UAAU,YAAY,QAAQ,QAAQ,SAAS;AAAA,UACnE;AAAA,QACF;AAUA,iBAAS,oBAAoB,MAAM,UAAU;AAC3C,cAAI,MAAM,IAAI,KAAK,mBAAmB,QAAQ,GAAG;AAC/C,mBAAO,wBAAwB,MAAM,IAAI,GAAG,QAAQ;AAAA,UACtD;AACA,iBAAO,SAAS,QAAQ;AACtB,gBAAI,WAAW,IAAI,QAAQ,IAAI;AAC/B,mBAAQ,aAAatB,cAAa,aAAa,WAC3C,MAAM,QAAQ,IAAI,IAClB,YAAY,UAAU,UAAU,uBAAuB,sBAAsB;AAAA,UACnF;AAAA,QACF;AAaA,iBAAS,UAAU,QAAQ,QAAQ,UAAU0B,aAAY,OAAO;AAC9D,cAAI,WAAW,QAAQ;AACrB;AAAA,UACF;AACA,kBAAQ,QAAQ,SAAS,UAAU,KAAK;AACtC,sBAAU,QAAQ,IAAI;AACtB,gBAAIL,UAAS,QAAQ,GAAG;AACtB,4BAAc,QAAQ,QAAQ,KAAK,UAAU,WAAWK,aAAY,KAAK;AAAA,YAC3E,OACK;AACH,kBAAI,WAAWA,cACXA,YAAW,QAAQ,QAAQ,GAAG,GAAG,UAAW,MAAM,IAAK,QAAQ,QAAQ,KAAK,IAC5E1B;AAEJ,kBAAI,aAAaA,YAAW;AAC1B,2BAAW;AAAA,cACb;AACA,+BAAiB,QAAQ,KAAK,QAAQ;AAAA,YACxC;AAAA,UACF,GAAG,MAAM;AAAA,QACX;AAiBA,iBAAS,cAAc,QAAQ,QAAQ,KAAK,UAAU,WAAW0B,aAAY,OAAO;AAClF,cAAI,WAAW,QAAQ,QAAQ,GAAG,GAC9B,WAAW,QAAQ,QAAQ,GAAG,GAC9B,UAAU,MAAM,IAAI,QAAQ;AAEhC,cAAI,SAAS;AACX,6BAAiB,QAAQ,KAAK,OAAO;AACrC;AAAA,UACF;AACA,cAAI,WAAWA,cACXA,YAAW,UAAU,UAAW,MAAM,IAAK,QAAQ,QAAQ,KAAK,IAChE1B;AAEJ,cAAI,WAAW,aAAaA;AAE5B,cAAI,UAAU;AACZ,gBAAI,QAAQoB,SAAQ,QAAQ,GACxB,SAAS,CAAC,SAAS,SAAS,QAAQ,GACpC,UAAU,CAAC,SAAS,CAAC,UAAU,aAAa,QAAQ;AAExD,uBAAW;AACX,gBAAI,SAAS,UAAU,SAAS;AAC9B,kBAAIA,SAAQ,QAAQ,GAAG;AACrB,2BAAW;AAAA,cACb,WACS,kBAAkB,QAAQ,GAAG;AACpC,2BAAW,UAAU,QAAQ;AAAA,cAC/B,WACS,QAAQ;AACf,2BAAW;AACX,2BAAW,YAAY,UAAU,IAAI;AAAA,cACvC,WACS,SAAS;AAChB,2BAAW;AACX,2BAAW,gBAAgB,UAAU,IAAI;AAAA,cAC3C,OACK;AACH,2BAAW,CAAC;AAAA,cACd;AAAA,YACF,WACS,cAAc,QAAQ,KAAK,YAAY,QAAQ,GAAG;AACzD,yBAAW;AACX,kBAAI,YAAY,QAAQ,GAAG;AACzB,2BAAW,cAAc,QAAQ;AAAA,cACnC,WACS,CAACC,UAAS,QAAQ,KAAK,WAAW,QAAQ,GAAG;AACpD,2BAAW,gBAAgB,QAAQ;AAAA,cACrC;AAAA,YACF,OACK;AACH,yBAAW;AAAA,YACb;AAAA,UACF;AACA,cAAI,UAAU;AAEZ,kBAAM,IAAI,UAAU,QAAQ;AAC5B,sBAAU,UAAU,UAAU,UAAUK,aAAY,KAAK;AACzD,kBAAM,QAAQ,EAAE,QAAQ;AAAA,UAC1B;AACA,2BAAiB,QAAQ,KAAK,QAAQ;AAAA,QACxC;AAUA,iBAAS,QAAQ,OAAO,GAAG;AACzB,cAAI,SAAS,MAAM;AACnB,cAAI,CAAC,QAAQ;AACX;AAAA,UACF;AACA,eAAK,IAAI,IAAI,SAAS;AACtB,iBAAO,QAAQ,GAAG,MAAM,IAAI,MAAM,CAAC,IAAI1B;AAAA,QACzC;AAWA,iBAAS,YAAY,YAAY,WAAW,QAAQ;AAClD,cAAI,UAAU,QAAQ;AACpB,wBAAY,SAAS,WAAW,SAASuB,WAAU;AACjD,kBAAIH,SAAQG,SAAQ,GAAG;AACrB,uBAAO,SAAS,OAAO;AACrB,yBAAO,QAAQ,OAAOA,UAAS,WAAW,IAAIA,UAAS,CAAC,IAAIA,SAAQ;AAAA,gBACtE;AAAA,cACF;AACA,qBAAOA;AAAA,YACT,CAAC;AAAA,UACH,OAAO;AACL,wBAAY,CAAC,QAAQ;AAAA,UACvB;AAEA,cAAI,QAAQ;AACZ,sBAAY,SAAS,WAAW,UAAU,YAAY,CAAC,CAAC;AAExD,cAAID,UAAS,QAAQ,YAAY,SAAS,OAAO,KAAKrB,aAAY;AAChE,gBAAI,WAAW,SAAS,WAAW,SAASsB,WAAU;AACpD,qBAAOA,UAAS,KAAK;AAAA,YACvB,CAAC;AACD,mBAAO,EAAE,YAAY,UAAU,SAAS,EAAE,OAAO,SAAS,MAAM;AAAA,UAClE,CAAC;AAED,iBAAO,WAAWD,SAAQ,SAAS,QAAQ,OAAO;AAChD,mBAAO,gBAAgB,QAAQ,OAAO,MAAM;AAAA,UAC9C,CAAC;AAAA,QACH;AAWA,iBAAS,SAAS,QAAQ,OAAO;AAC/B,iBAAO,WAAW,QAAQ,OAAO,SAAS,OAAO,MAAM;AACrD,mBAAO,MAAM,QAAQ,IAAI;AAAA,UAC3B,CAAC;AAAA,QACH;AAWA,iBAAS,WAAW,QAAQ,OAAO,WAAW;AAC5C,cAAI,QAAQ,IACR,SAAS,MAAM,QACfA,UAAS,CAAC;AAEd,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,OAAO,MAAM,KAAK,GAClB,QAAQ,QAAQ,QAAQ,IAAI;AAEhC,gBAAI,UAAU,OAAO,IAAI,GAAG;AAC1B,sBAAQA,SAAQ,SAAS,MAAM,MAAM,GAAG,KAAK;AAAA,YAC/C;AAAA,UACF;AACA,iBAAOA;AAAA,QACT;AASA,iBAAS,iBAAiB,MAAM;AAC9B,iBAAO,SAAS,QAAQ;AACtB,mBAAO,QAAQ,QAAQ,IAAI;AAAA,UAC7B;AAAA,QACF;AAaA,iBAAS,YAAY,OAAOG,SAAQF,WAAU,YAAY;AACxD,cAAIQ,WAAU,aAAa,kBAAkB,aACzC,QAAQ,IACR,SAASN,QAAO,QAChB,OAAO;AAEX,cAAI,UAAUA,SAAQ;AACpB,YAAAA,UAAS,UAAUA,OAAM;AAAA,UAC3B;AACA,cAAIF,WAAU;AACZ,mBAAO,SAAS,OAAO,UAAUA,SAAQ,CAAC;AAAA,UAC5C;AACA,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,YAAY,GACZ,QAAQE,QAAO,KAAK,GACpB,WAAWF,YAAWA,UAAS,KAAK,IAAI;AAE5C,oBAAQ,YAAYQ,SAAQ,MAAM,UAAU,WAAW,UAAU,KAAK,IAAI;AACxE,kBAAI,SAAS,OAAO;AAClB,uBAAO,KAAK,MAAM,WAAW,CAAC;AAAA,cAChC;AACA,qBAAO,KAAK,OAAO,WAAW,CAAC;AAAA,YACjC;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAWA,iBAAS,WAAW,OAAO,SAAS;AAClC,cAAI,SAAS,QAAQ,QAAQ,SAAS,GAClC,YAAY,SAAS;AAEzB,iBAAO,UAAU;AACf,gBAAI,QAAQ,QAAQ,MAAM;AAC1B,gBAAI,UAAU,aAAa,UAAU,UAAU;AAC7C,kBAAI,WAAW;AACf,kBAAI,QAAQ,KAAK,GAAG;AAClB,uBAAO,KAAK,OAAO,OAAO,CAAC;AAAA,cAC7B,OAAO;AACL,0BAAU,OAAO,KAAK;AAAA,cACxB;AAAA,YACF;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAWA,iBAAS,WAAW,OAAO,OAAO;AAChC,iBAAO,QAAQ,YAAY,aAAa,KAAK,QAAQ,QAAQ,EAAE;AAAA,QACjE;AAaA,iBAAS,UAAU,OAAO,KAAK,MAAM,WAAW;AAC9C,cAAI,QAAQ,IACR,SAAS,UAAU,YAAY,MAAM,UAAU,QAAQ,EAAE,GAAG,CAAC,GAC7DT,UAASlB,OAAM,MAAM;AAEzB,iBAAO,UAAU;AACf,YAAAkB,QAAO,YAAY,SAAS,EAAE,KAAK,IAAI;AACvC,qBAAS;AAAA,UACX;AACA,iBAAOA;AAAA,QACT;AAUA,iBAAS,WAAW,QAAQ,GAAG;AAC7B,cAAIA,UAAS;AACb,cAAI,CAAC,UAAU,IAAI,KAAK,IAAI,kBAAkB;AAC5C,mBAAOA;AAAA,UACT;AAGA,aAAG;AACD,gBAAI,IAAI,GAAG;AACT,cAAAA,WAAU;AAAA,YACZ;AACA,gBAAI,YAAY,IAAI,CAAC;AACrB,gBAAI,GAAG;AACL,wBAAU;AAAA,YACZ;AAAA,UACF,SAAS;AAET,iBAAOA;AAAA,QACT;AAUA,iBAAS,SAAS,MAAM,OAAO;AAC7B,iBAAO,YAAY,SAAS,MAAM,OAAO,QAAQ,GAAG,OAAO,EAAE;AAAA,QAC/D;AASA,iBAAS,WAAW,YAAY;AAC9B,iBAAO,YAAY,OAAO,UAAU,CAAC;AAAA,QACvC;AAUA,iBAAS,eAAe,YAAY,GAAG;AACrC,cAAI,QAAQ,OAAO,UAAU;AAC7B,iBAAO,YAAY,OAAO,UAAU,GAAG,GAAG,MAAM,MAAM,CAAC;AAAA,QACzD;AAYA,iBAAS,QAAQ,QAAQ,MAAM,OAAOI,aAAY;AAChD,cAAI,CAACL,UAAS,MAAM,GAAG;AACrB,mBAAO;AAAA,UACT;AACA,iBAAO,SAAS,MAAM,MAAM;AAE5B,cAAI,QAAQ,IACR,SAAS,KAAK,QACd,YAAY,SAAS,GACrB,SAAS;AAEb,iBAAO,UAAU,QAAQ,EAAE,QAAQ,QAAQ;AACzC,gBAAI,MAAM,MAAM,KAAK,KAAK,CAAC,GACvB,WAAW;AAEf,gBAAI,QAAQ,eAAe,QAAQ,iBAAiB,QAAQ,aAAa;AACvE,qBAAO;AAAA,YACT;AAEA,gBAAI,SAAS,WAAW;AACtB,kBAAI,WAAW,OAAO,GAAG;AACzB,yBAAWK,cAAaA,YAAW,UAAU,KAAK,MAAM,IAAI1B;AAC5D,kBAAI,aAAaA,YAAW;AAC1B,2BAAWqB,UAAS,QAAQ,IACxB,WACC,QAAQ,KAAK,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;AAAA,cACxC;AAAA,YACF;AACA,wBAAY,QAAQ,KAAK,QAAQ;AACjC,qBAAS,OAAO,GAAG;AAAA,UACrB;AACA,iBAAO;AAAA,QACT;AAUA,YAAI,cAAc,CAAC,UAAU,WAAW,SAAS,MAAMnB,OAAM;AAC3D,kBAAQ,IAAI,MAAMA,KAAI;AACtB,iBAAO;AAAA,QACT;AAUA,YAAI,kBAAkB,CAAC,iBAAiB,WAAW,SAAS,MAAM,QAAQ;AACxE,iBAAO,eAAe,MAAM,YAAY;AAAA,YACtC,gBAAgB;AAAA,YAChB,cAAc;AAAA,YACd,SAAS,SAAS,MAAM;AAAA,YACxB,YAAY;AAAA,UACd,CAAC;AAAA,QACH;AASA,iBAAS,YAAY,YAAY;AAC/B,iBAAO,YAAY,OAAO,UAAU,CAAC;AAAA,QACvC;AAWA,iBAAS,UAAU,OAAO,OAAO,KAAK;AACpC,cAAI,QAAQ,IACR,SAAS,MAAM;AAEnB,cAAI,QAAQ,GAAG;AACb,oBAAQ,CAAC,QAAQ,SAAS,IAAK,SAAS;AAAA,UAC1C;AACA,gBAAM,MAAM,SAAS,SAAS;AAC9B,cAAI,MAAM,GAAG;AACX,mBAAO;AAAA,UACT;AACA,mBAAS,QAAQ,MAAM,IAAM,MAAM,UAAW;AAC9C,qBAAW;AAEX,cAAIoB,UAASlB,OAAM,MAAM;AACzB,iBAAO,EAAE,QAAQ,QAAQ;AACvB,YAAAkB,QAAO,KAAK,IAAI,MAAM,QAAQ,KAAK;AAAA,UACrC;AACA,iBAAOA;AAAA,QACT;AAWA,iBAAS,SAAS,YAAY,WAAW;AACvC,cAAIA;AAEJ,mBAAS,YAAY,SAAS,OAAO,OAAOrB,aAAY;AACtD,YAAAqB,UAAS,UAAU,OAAO,OAAOrB,WAAU;AAC3C,mBAAO,CAACqB;AAAA,UACV,CAAC;AACD,iBAAO,CAAC,CAACA;AAAA,QACX;AAcA,iBAAS,gBAAgB,OAAO,OAAO,YAAY;AACjD,cAAI,MAAM,GACN,OAAO,SAAS,OAAO,MAAM,MAAM;AAEvC,cAAI,OAAO,SAAS,YAAY,UAAU,SAAS,QAAQ,uBAAuB;AAChF,mBAAO,MAAM,MAAM;AACjB,kBAAI,MAAO,MAAM,SAAU,GACvB,WAAW,MAAM,GAAG;AAExB,kBAAI,aAAa,QAAQ,CAAC,SAAS,QAAQ,MACtC,aAAc,YAAY,QAAU,WAAW,QAAS;AAC3D,sBAAM,MAAM;AAAA,cACd,OAAO;AACL,uBAAO;AAAA,cACT;AAAA,YACF;AACA,mBAAO;AAAA,UACT;AACA,iBAAO,kBAAkB,OAAO,OAAO,UAAU,UAAU;AAAA,QAC7D;AAeA,iBAAS,kBAAkB,OAAO,OAAOC,WAAU,YAAY;AAC7D,cAAI,MAAM,GACN,OAAO,SAAS,OAAO,IAAI,MAAM;AACrC,cAAI,SAAS,GAAG;AACd,mBAAO;AAAA,UACT;AAEA,kBAAQA,UAAS,KAAK;AACtB,cAAI,WAAW,UAAU,OACrB,YAAY,UAAU,MACtB,cAAc,SAAS,KAAK,GAC5B,iBAAiB,UAAUvB;AAE/B,iBAAO,MAAM,MAAM;AACjB,gBAAI,MAAM,aAAa,MAAM,QAAQ,CAAC,GAClC,WAAWuB,UAAS,MAAM,GAAG,CAAC,GAC9B,eAAe,aAAavB,YAC5B,YAAY,aAAa,MACzB,iBAAiB,aAAa,UAC9B,cAAc,SAAS,QAAQ;AAEnC,gBAAI,UAAU;AACZ,kBAAI,SAAS,cAAc;AAAA,YAC7B,WAAW,gBAAgB;AACzB,uBAAS,mBAAmB,cAAc;AAAA,YAC5C,WAAW,WAAW;AACpB,uBAAS,kBAAkB,iBAAiB,cAAc,CAAC;AAAA,YAC7D,WAAW,aAAa;AACtB,uBAAS,kBAAkB,gBAAgB,CAAC,cAAc,cAAc,CAAC;AAAA,YAC3E,WAAW,aAAa,aAAa;AACnC,uBAAS;AAAA,YACX,OAAO;AACL,uBAAS,aAAc,YAAY,QAAU,WAAW;AAAA,YAC1D;AACA,gBAAI,QAAQ;AACV,oBAAM,MAAM;AAAA,YACd,OAAO;AACL,qBAAO;AAAA,YACT;AAAA,UACF;AACA,iBAAO,UAAU,MAAM,eAAe;AAAA,QACxC;AAWA,iBAAS,eAAe,OAAOuB,WAAU;AACvC,cAAI,QAAQ,IACR,SAAS,MAAM,QACf,WAAW,GACXD,UAAS,CAAC;AAEd,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,QAAQ,MAAM,KAAK,GACnB,WAAWC,YAAWA,UAAS,KAAK,IAAI;AAE5C,gBAAI,CAAC,SAAS,CAAC,GAAG,UAAU,IAAI,GAAG;AACjC,kBAAI,OAAO;AACX,cAAAD,QAAO,UAAU,IAAI,UAAU,IAAI,IAAI;AAAA,YACzC;AAAA,UACF;AACA,iBAAOA;AAAA,QACT;AAUA,iBAAS,aAAa,OAAO;AAC3B,cAAI,OAAO,SAAS,UAAU;AAC5B,mBAAO;AAAA,UACT;AACA,cAAI,SAAS,KAAK,GAAG;AACnB,mBAAO;AAAA,UACT;AACA,iBAAO,CAAC;AAAA,QACV;AAUA,iBAAS,aAAa,OAAO;AAE3B,cAAI,OAAO,SAAS,UAAU;AAC5B,mBAAO;AAAA,UACT;AACA,cAAIF,SAAQ,KAAK,GAAG;AAElB,mBAAO,SAAS,OAAO,YAAY,IAAI;AAAA,UACzC;AACA,cAAI,SAAS,KAAK,GAAG;AACnB,mBAAO,iBAAiB,eAAe,KAAK,KAAK,IAAI;AAAA,UACvD;AACA,cAAIE,UAAU,QAAQ;AACtB,iBAAQA,WAAU,OAAQ,IAAI,SAAU,CAAC,WAAY,OAAOA;AAAA,QAC9D;AAWA,iBAAS,SAAS,OAAOC,WAAU,YAAY;AAC7C,cAAI,QAAQ,IACRM,YAAW,eACX,SAAS,MAAM,QACf,WAAW,MACXP,UAAS,CAAC,GACV,OAAOA;AAEX,cAAI,YAAY;AACd,uBAAW;AACX,YAAAO,YAAW;AAAA,UACb,WACS,UAAU,kBAAkB;AACnC,gBAAIG,OAAMT,YAAW,OAAO,UAAU,KAAK;AAC3C,gBAAIS,MAAK;AACP,qBAAO,WAAWA,IAAG;AAAA,YACvB;AACA,uBAAW;AACX,YAAAH,YAAW;AACX,mBAAO,IAAI;AAAA,UACb,OACK;AACH,mBAAON,YAAW,CAAC,IAAID;AAAA,UACzB;AACA;AACA,mBAAO,EAAE,QAAQ,QAAQ;AACvB,kBAAI,QAAQ,MAAM,KAAK,GACnB,WAAWC,YAAWA,UAAS,KAAK,IAAI;AAE5C,sBAAS,cAAc,UAAU,IAAK,QAAQ;AAC9C,kBAAI,YAAY,aAAa,UAAU;AACrC,oBAAI,YAAY,KAAK;AACrB,uBAAO,aAAa;AAClB,sBAAI,KAAK,SAAS,MAAM,UAAU;AAChC,6BAAS;AAAA,kBACX;AAAA,gBACF;AACA,oBAAIA,WAAU;AACZ,uBAAK,KAAK,QAAQ;AAAA,gBACpB;AACA,gBAAAD,QAAO,KAAK,KAAK;AAAA,cACnB,WACS,CAACO,UAAS,MAAM,UAAU,UAAU,GAAG;AAC9C,oBAAI,SAASP,SAAQ;AACnB,uBAAK,KAAK,QAAQ;AAAA,gBACpB;AACA,gBAAAA,QAAO,KAAK,KAAK;AAAA,cACnB;AAAA,YACF;AACA,iBAAOA;AAAA,QACT;AAUA,iBAAS,UAAU,QAAQ,MAAM;AAC/B,iBAAO,SAAS,MAAM,MAAM;AAC5B,mBAAS,OAAO,QAAQ,IAAI;AAC5B,iBAAO,UAAU,QAAQ,OAAO,OAAO,MAAM,KAAK,IAAI,CAAC,CAAC;AAAA,QAC1D;AAYA,iBAAS,WAAW,QAAQ,MAAM,SAASI,aAAY;AACrD,iBAAO,QAAQ,QAAQ,MAAM,QAAQ,QAAQ,QAAQ,IAAI,CAAC,GAAGA,WAAU;AAAA,QACzE;AAaA,iBAAS,UAAU,OAAO,WAAW,QAAQ,WAAW;AACtD,cAAI,SAAS,MAAM,QACf,QAAQ,YAAY,SAAS;AAEjC,kBAAQ,YAAY,UAAU,EAAE,QAAQ,WACtC,UAAU,MAAM,KAAK,GAAG,OAAO,KAAK,GAAG;AAAA,UAAC;AAE1C,iBAAO,SACH,UAAU,OAAQ,YAAY,IAAI,OAAS,YAAY,QAAQ,IAAI,MAAO,IAC1E,UAAU,OAAQ,YAAY,QAAQ,IAAI,GAAK,YAAY,SAAS,KAAM;AAAA,QAChF;AAYA,iBAAS,iBAAiB,OAAO,SAAS;AACxC,cAAIJ,UAAS;AACb,cAAIA,mBAAkB,aAAa;AACjC,YAAAA,UAASA,QAAO,MAAM;AAAA,UACxB;AACA,iBAAO,YAAY,SAAS,SAASA,SAAQ,QAAQ;AACnD,mBAAO,OAAO,KAAK,MAAM,OAAO,SAAS,UAAU,CAACA,OAAM,GAAG,OAAO,IAAI,CAAC;AAAA,UAC3E,GAAGA,OAAM;AAAA,QACX;AAYA,iBAAS,QAAQ,QAAQC,WAAU,YAAY;AAC7C,cAAI,SAAS,OAAO;AACpB,cAAI,SAAS,GAAG;AACd,mBAAO,SAAS,SAAS,OAAO,CAAC,CAAC,IAAI,CAAC;AAAA,UACzC;AACA,cAAI,QAAQ,IACRD,UAASlB,OAAM,MAAM;AAEzB,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,QAAQ,OAAO,KAAK,GACpB,WAAW;AAEf,mBAAO,EAAE,WAAW,QAAQ;AAC1B,kBAAI,YAAY,OAAO;AACrB,gBAAAkB,QAAO,KAAK,IAAI,eAAeA,QAAO,KAAK,KAAK,OAAO,OAAO,QAAQ,GAAGC,WAAU,UAAU;AAAA,cAC/F;AAAA,YACF;AAAA,UACF;AACA,iBAAO,SAAS,YAAYD,SAAQ,CAAC,GAAGC,WAAU,UAAU;AAAA,QAC9D;AAWA,iBAAS,cAAc,OAAOE,SAAQ,YAAY;AAChD,cAAI,QAAQ,IACR,SAAS,MAAM,QACf,aAAaA,QAAO,QACpBH,UAAS,CAAC;AAEd,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,QAAQ,QAAQ,aAAaG,QAAO,KAAK,IAAIzB;AACjD,uBAAWsB,SAAQ,MAAM,KAAK,GAAG,KAAK;AAAA,UACxC;AACA,iBAAOA;AAAA,QACT;AASA,iBAAS,oBAAoB,OAAO;AAClC,iBAAO,kBAAkB,KAAK,IAAI,QAAQ,CAAC;AAAA,QAC7C;AASA,iBAAS,aAAa,OAAO;AAC3B,iBAAO,OAAO,SAAS,aAAa,QAAQ;AAAA,QAC9C;AAUA,iBAAS,SAAS,OAAO,QAAQ;AAC/B,cAAIF,SAAQ,KAAK,GAAG;AAClB,mBAAO;AAAA,UACT;AACA,iBAAO,MAAM,OAAO,MAAM,IAAI,CAAC,KAAK,IAAI,aAAa,SAAS,KAAK,CAAC;AAAA,QACtE;AAWA,YAAI,WAAW;AAWf,iBAAS,UAAU,OAAO,OAAO,KAAK;AACpC,cAAI,SAAS,MAAM;AACnB,gBAAM,QAAQpB,aAAY,SAAS;AACnC,iBAAQ,CAAC,SAAS,OAAO,SAAU,QAAQ,UAAU,OAAO,OAAO,GAAG;AAAA,QACxE;AAQA,YAAIiC,gBAAe,mBAAmB,SAAS,IAAI;AACjD,iBAAO,KAAK,aAAa,EAAE;AAAA,QAC7B;AAUA,iBAAS,YAAY,QAAQ,QAAQ;AACnC,cAAI,QAAQ;AACV,mBAAO,OAAO,MAAM;AAAA,UACtB;AACA,cAAI,SAAS,OAAO,QAChBX,UAAS,cAAc,YAAY,MAAM,IAAI,IAAI,OAAO,YAAY,MAAM;AAE9E,iBAAO,KAAKA,OAAM;AAClB,iBAAOA;AAAA,QACT;AASA,iBAAS,iBAAiB,aAAa;AACrC,cAAIA,UAAS,IAAI,YAAY,YAAY,YAAY,UAAU;AAC/D,cAAIP,YAAWO,OAAM,EAAE,IAAI,IAAIP,YAAW,WAAW,CAAC;AACtD,iBAAOO;AAAA,QACT;AAUA,iBAAS,cAAc,UAAU,QAAQ;AACvC,cAAI,SAAS,SAAS,iBAAiB,SAAS,MAAM,IAAI,SAAS;AACnE,iBAAO,IAAI,SAAS,YAAY,QAAQ,SAAS,YAAY,SAAS,UAAU;AAAA,QAClF;AASA,iBAAS,YAAY,QAAQ;AAC3B,cAAIA,UAAS,IAAI,OAAO,YAAY,OAAO,QAAQ,QAAQ,KAAK,MAAM,CAAC;AACvE,UAAAA,QAAO,YAAY,OAAO;AAC1B,iBAAOA;AAAA,QACT;AASA,iBAAS,YAAY,QAAQ;AAC3B,iBAAO,gBAAgBb,QAAO,cAAc,KAAK,MAAM,CAAC,IAAI,CAAC;AAAA,QAC/D;AAUA,iBAAS,gBAAgB,YAAY,QAAQ;AAC3C,cAAI,SAAS,SAAS,iBAAiB,WAAW,MAAM,IAAI,WAAW;AACvE,iBAAO,IAAI,WAAW,YAAY,QAAQ,WAAW,YAAY,WAAW,MAAM;AAAA,QACpF;AAUA,iBAAS,iBAAiB,OAAO,OAAO;AACtC,cAAI,UAAU,OAAO;AACnB,gBAAI,eAAe,UAAUT,YACzB,YAAY,UAAU,MACtB,iBAAiB,UAAU,OAC3B,cAAc,SAAS,KAAK;AAEhC,gBAAI,eAAe,UAAUA,YACzB,YAAY,UAAU,MACtB,iBAAiB,UAAU,OAC3B,cAAc,SAAS,KAAK;AAEhC,gBAAK,CAAC,aAAa,CAAC,eAAe,CAAC,eAAe,QAAQ,SACtD,eAAe,gBAAgB,kBAAkB,CAAC,aAAa,CAAC,eAChE,aAAa,gBAAgB,kBAC7B,CAAC,gBAAgB,kBAClB,CAAC,gBAAgB;AACnB,qBAAO;AAAA,YACT;AACA,gBAAK,CAAC,aAAa,CAAC,eAAe,CAAC,eAAe,QAAQ,SACtD,eAAe,gBAAgB,kBAAkB,CAAC,aAAa,CAAC,eAChE,aAAa,gBAAgB,kBAC7B,CAAC,gBAAgB,kBAClB,CAAC,gBAAgB;AACnB,qBAAO;AAAA,YACT;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAgBA,iBAAS,gBAAgB,QAAQ,OAAO,QAAQ;AAC9C,cAAI,QAAQ,IACR,cAAc,OAAO,UACrB,cAAc,MAAM,UACpB,SAAS,YAAY,QACrB,eAAe,OAAO;AAE1B,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAIsB,UAAS,iBAAiB,YAAY,KAAK,GAAG,YAAY,KAAK,CAAC;AACpE,gBAAIA,SAAQ;AACV,kBAAI,SAAS,cAAc;AACzB,uBAAOA;AAAA,cACT;AACA,kBAAI,QAAQ,OAAO,KAAK;AACxB,qBAAOA,WAAU,SAAS,SAAS,KAAK;AAAA,YAC1C;AAAA,UACF;AAQA,iBAAO,OAAO,QAAQ,MAAM;AAAA,QAC9B;AAaA,iBAAS,YAAY,MAAM,UAAU,SAAS,WAAW;AACvD,cAAI,YAAY,IACZ,aAAa,KAAK,QAClB,gBAAgB,QAAQ,QACxB,YAAY,IACZ,aAAa,SAAS,QACtB,cAAc,UAAU,aAAa,eAAe,CAAC,GACrDA,UAASlB,OAAM,aAAa,WAAW,GACvC,cAAc,CAAC;AAEnB,iBAAO,EAAE,YAAY,YAAY;AAC/B,YAAAkB,QAAO,SAAS,IAAI,SAAS,SAAS;AAAA,UACxC;AACA,iBAAO,EAAE,YAAY,eAAe;AAClC,gBAAI,eAAe,YAAY,YAAY;AACzC,cAAAA,QAAO,QAAQ,SAAS,CAAC,IAAI,KAAK,SAAS;AAAA,YAC7C;AAAA,UACF;AACA,iBAAO,eAAe;AACpB,YAAAA,QAAO,WAAW,IAAI,KAAK,WAAW;AAAA,UACxC;AACA,iBAAOA;AAAA,QACT;AAaA,iBAAS,iBAAiB,MAAM,UAAU,SAAS,WAAW;AAC5D,cAAI,YAAY,IACZ,aAAa,KAAK,QAClB,eAAe,IACf,gBAAgB,QAAQ,QACxB,aAAa,IACb,cAAc,SAAS,QACvB,cAAc,UAAU,aAAa,eAAe,CAAC,GACrDA,UAASlB,OAAM,cAAc,WAAW,GACxC,cAAc,CAAC;AAEnB,iBAAO,EAAE,YAAY,aAAa;AAChC,YAAAkB,QAAO,SAAS,IAAI,KAAK,SAAS;AAAA,UACpC;AACA,cAAI,SAAS;AACb,iBAAO,EAAE,aAAa,aAAa;AACjC,YAAAA,QAAO,SAAS,UAAU,IAAI,SAAS,UAAU;AAAA,UACnD;AACA,iBAAO,EAAE,eAAe,eAAe;AACrC,gBAAI,eAAe,YAAY,YAAY;AACzC,cAAAA,QAAO,SAAS,QAAQ,YAAY,CAAC,IAAI,KAAK,WAAW;AAAA,YAC3D;AAAA,UACF;AACA,iBAAOA;AAAA,QACT;AAUA,iBAAS,UAAU,QAAQ,OAAO;AAChC,cAAI,QAAQ,IACR,SAAS,OAAO;AAEpB,oBAAU,QAAQlB,OAAM,MAAM;AAC9B,iBAAO,EAAE,QAAQ,QAAQ;AACvB,kBAAM,KAAK,IAAI,OAAO,KAAK;AAAA,UAC7B;AACA,iBAAO;AAAA,QACT;AAYA,iBAAS,WAAW,QAAQ,OAAO,QAAQsB,aAAY;AACrD,cAAI,QAAQ,CAAC;AACb,qBAAW,SAAS,CAAC;AAErB,cAAI,QAAQ,IACR,SAAS,MAAM;AAEnB,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,MAAM,MAAM,KAAK;AAErB,gBAAI,WAAWA,cACXA,YAAW,OAAO,GAAG,GAAG,OAAO,GAAG,GAAG,KAAK,QAAQ,MAAM,IACxD1B;AAEJ,gBAAI,aAAaA,YAAW;AAC1B,yBAAW,OAAO,GAAG;AAAA,YACvB;AACA,gBAAI,OAAO;AACT,8BAAgB,QAAQ,KAAK,QAAQ;AAAA,YACvC,OAAO;AACL,0BAAY,QAAQ,KAAK,QAAQ;AAAA,YACnC;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAUA,iBAAS,YAAY,QAAQ,QAAQ;AACnC,iBAAO,WAAW,QAAQ,WAAW,MAAM,GAAG,MAAM;AAAA,QACtD;AAUA,iBAAS,cAAc,QAAQ,QAAQ;AACrC,iBAAO,WAAW,QAAQ,aAAa,MAAM,GAAG,MAAM;AAAA,QACxD;AAUA,iBAAS,iBAAiB,QAAQ,aAAa;AAC7C,iBAAO,SAAS,YAAYuB,WAAU;AACpC,gBAAI,OAAOH,SAAQ,UAAU,IAAI,kBAAkB,gBAC/C,cAAc,cAAc,YAAY,IAAI,CAAC;AAEjD,mBAAO,KAAK,YAAY,QAAQ,YAAYG,WAAU,CAAC,GAAG,WAAW;AAAA,UACvE;AAAA,QACF;AASA,iBAAS,eAAe,UAAU;AAChC,iBAAO,SAAS,SAAS,QAAQ,SAAS;AACxC,gBAAI,QAAQ,IACR,SAAS,QAAQ,QACjBG,cAAa,SAAS,IAAI,QAAQ,SAAS,CAAC,IAAI1B,YAChD,QAAQ,SAAS,IAAI,QAAQ,CAAC,IAAIA;AAEtC,YAAA0B,cAAc,SAAS,SAAS,KAAK,OAAOA,eAAc,cACrD,UAAUA,eACX1B;AAEJ,gBAAI,SAAS,eAAe,QAAQ,CAAC,GAAG,QAAQ,CAAC,GAAG,KAAK,GAAG;AAC1D,cAAA0B,cAAa,SAAS,IAAI1B,aAAY0B;AACtC,uBAAS;AAAA,YACX;AACA,qBAASjB,QAAO,MAAM;AACtB,mBAAO,EAAE,QAAQ,QAAQ;AACvB,kBAAI,SAAS,QAAQ,KAAK;AAC1B,kBAAI,QAAQ;AACV,yBAAS,QAAQ,QAAQ,OAAOiB,WAAU;AAAA,cAC5C;AAAA,YACF;AACA,mBAAO;AAAA,UACT,CAAC;AAAA,QACH;AAUA,iBAAS,eAAe,UAAU,WAAW;AAC3C,iBAAO,SAAS,YAAYH,WAAU;AACpC,gBAAI,cAAc,MAAM;AACtB,qBAAO;AAAA,YACT;AACA,gBAAI,CAAC,YAAY,UAAU,GAAG;AAC5B,qBAAO,SAAS,YAAYA,SAAQ;AAAA,YACtC;AACA,gBAAI,SAAS,WAAW,QACpB,QAAQ,YAAY,SAAS,IAC7B,WAAWd,QAAO,UAAU;AAEhC,mBAAQ,YAAY,UAAU,EAAE,QAAQ,QAAS;AAC/C,kBAAIc,UAAS,SAAS,KAAK,GAAG,OAAO,QAAQ,MAAM,OAAO;AACxD;AAAA,cACF;AAAA,YACF;AACA,mBAAO;AAAA,UACT;AAAA,QACF;AASA,iBAAS,cAAc,WAAW;AAChC,iBAAO,SAAS,QAAQA,WAAU,UAAU;AAC1C,gBAAI,QAAQ,IACR,WAAWd,QAAO,MAAM,GACxB,QAAQ,SAAS,MAAM,GACvB,SAAS,MAAM;AAEnB,mBAAO,UAAU;AACf,kBAAI,MAAM,MAAM,YAAY,SAAS,EAAE,KAAK;AAC5C,kBAAIc,UAAS,SAAS,GAAG,GAAG,KAAK,QAAQ,MAAM,OAAO;AACpD;AAAA,cACF;AAAA,YACF;AACA,mBAAO;AAAA,UACT;AAAA,QACF;AAYA,iBAAS,WAAW,MAAM,SAAS,SAAS;AAC1C,cAAI,SAAS,UAAU,gBACnB,OAAO,WAAW,IAAI;AAE1B,mBAAS,UAAU;AACjB,gBAAI,KAAM,QAAQ,SAAS,QAAQ,gBAAgB,UAAW,OAAO;AACrE,mBAAO,GAAG,MAAM,SAAS,UAAU,MAAM,SAAS;AAAA,UACpD;AACA,iBAAO;AAAA,QACT;AASA,iBAAS,gBAAgB,YAAY;AACnC,iBAAO,SAAS,QAAQ;AACtB,qBAAS,SAAS,MAAM;AAExB,gBAAI,aAAa,WAAW,MAAM,IAC9B,cAAc,MAAM,IACpBvB;AAEJ,gBAAI,MAAM,aACN,WAAW,CAAC,IACZ,OAAO,OAAO,CAAC;AAEnB,gBAAI,WAAW,aACX,UAAU,YAAY,CAAC,EAAE,KAAK,EAAE,IAChC,OAAO,MAAM,CAAC;AAElB,mBAAO,IAAI,UAAU,EAAE,IAAI;AAAA,UAC7B;AAAA,QACF;AASA,iBAAS,iBAAiB,UAAU;AAClC,iBAAO,SAAS,QAAQ;AACtB,mBAAO,YAAY,MAAM,OAAO,MAAM,EAAE,QAAQ,QAAQ,EAAE,CAAC,GAAG,UAAU,EAAE;AAAA,UAC5E;AAAA,QACF;AAUA,iBAAS,WAAW,MAAM;AACxB,iBAAO,WAAW;AAIhB,gBAAI,OAAO;AACX,oBAAQ,KAAK,QAAQ;AAAA,cACnB,KAAK;AAAG,uBAAO,IAAI;AAAA,cACnB,KAAK;AAAG,uBAAO,IAAI,KAAK,KAAK,CAAC,CAAC;AAAA,cAC/B,KAAK;AAAG,uBAAO,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,cACxC,KAAK;AAAG,uBAAO,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,cACjD,KAAK;AAAG,uBAAO,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,cAC1D,KAAK;AAAG,uBAAO,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,cACnE,KAAK;AAAG,uBAAO,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,cAC5E,KAAK;AAAG,uBAAO,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,YACvF;AACA,gBAAI,cAAc,WAAW,KAAK,SAAS,GACvCsB,UAAS,KAAK,MAAM,aAAa,IAAI;AAIzC,mBAAOD,UAASC,OAAM,IAAIA,UAAS;AAAA,UACrC;AAAA,QACF;AAWA,iBAAS,YAAY,MAAM,SAAS,OAAO;AACzC,cAAI,OAAO,WAAW,IAAI;AAE1B,mBAAS,UAAU;AACjB,gBAAI,SAAS,UAAU,QACnB,OAAOlB,OAAM,MAAM,GACnB,QAAQ,QACR,cAAc,UAAU,OAAO;AAEnC,mBAAO,SAAS;AACd,mBAAK,KAAK,IAAI,UAAU,KAAK;AAAA,YAC/B;AACA,gBAAI,UAAW,SAAS,KAAK,KAAK,CAAC,MAAM,eAAe,KAAK,SAAS,CAAC,MAAM,cACzE,CAAC,IACD,eAAe,MAAM,WAAW;AAEpC,sBAAU,QAAQ;AAClB,gBAAI,SAAS,OAAO;AAClB,qBAAO;AAAA,gBACL;AAAA,gBAAM;AAAA,gBAAS;AAAA,gBAAc,QAAQ;AAAA,gBAAaJ;AAAA,gBAClD;AAAA,gBAAM;AAAA,gBAASA;AAAA,gBAAWA;AAAA,gBAAW,QAAQ;AAAA,cAAM;AAAA,YACvD;AACA,gBAAI,KAAM,QAAQ,SAAS,QAAQ,gBAAgB,UAAW,OAAO;AACrE,mBAAO,MAAM,IAAI,MAAM,IAAI;AAAA,UAC7B;AACA,iBAAO;AAAA,QACT;AASA,iBAAS,WAAW,eAAe;AACjC,iBAAO,SAAS,YAAY,WAAW,WAAW;AAChD,gBAAI,WAAWS,QAAO,UAAU;AAChC,gBAAI,CAAC,YAAY,UAAU,GAAG;AAC5B,kBAAIc,YAAW,YAAY,WAAW,CAAC;AACvC,2BAAa,KAAK,UAAU;AAC5B,0BAAY,SAAS,KAAK;AAAE,uBAAOA,UAAS,SAAS,GAAG,GAAG,KAAK,QAAQ;AAAA,cAAG;AAAA,YAC7E;AACA,gBAAI,QAAQ,cAAc,YAAY,WAAW,SAAS;AAC1D,mBAAO,QAAQ,KAAK,SAASA,YAAW,WAAW,KAAK,IAAI,KAAK,IAAIvB;AAAA,UACvE;AAAA,QACF;AASA,iBAAS,WAAW,WAAW;AAC7B,iBAAO,SAAS,SAAS,OAAO;AAC9B,gBAAI,SAAS,MAAM,QACf,QAAQ,QACR,SAAS,cAAc,UAAU;AAErC,gBAAI,WAAW;AACb,oBAAM,QAAQ;AAAA,YAChB;AACA,mBAAO,SAAS;AACd,kBAAI,OAAO,MAAM,KAAK;AACtB,kBAAI,OAAO,QAAQ,YAAY;AAC7B,sBAAM,IAAIY,WAAU,eAAe;AAAA,cACrC;AACA,kBAAI,UAAU,CAAC,WAAW,YAAY,IAAI,KAAK,WAAW;AACxD,oBAAI,UAAU,IAAI,cAAc,CAAC,GAAG,IAAI;AAAA,cAC1C;AAAA,YACF;AACA,oBAAQ,UAAU,QAAQ;AAC1B,mBAAO,EAAE,QAAQ,QAAQ;AACvB,qBAAO,MAAM,KAAK;AAElB,kBAAI,WAAW,YAAY,IAAI,GAC3BV,QAAO,YAAY,YAAY,QAAQ,IAAI,IAAIF;AAEnD,kBAAIE,SAAQ,WAAWA,MAAK,CAAC,CAAC,KACxBA,MAAK,CAAC,MAAM,gBAAgB,kBAAkB,oBAAoB,oBAClE,CAACA,MAAK,CAAC,EAAE,UAAUA,MAAK,CAAC,KAAK,GAC9B;AACJ,0BAAU,QAAQ,YAAYA,MAAK,CAAC,CAAC,CAAC,EAAE,MAAM,SAASA,MAAK,CAAC,CAAC;AAAA,cAChE,OAAO;AACL,0BAAW,KAAK,UAAU,KAAK,WAAW,IAAI,IAC1C,QAAQ,QAAQ,EAAE,IAClB,QAAQ,KAAK,IAAI;AAAA,cACvB;AAAA,YACF;AACA,mBAAO,WAAW;AAChB,kBAAI,OAAO,WACP,QAAQ,KAAK,CAAC;AAElB,kBAAI,WAAW,KAAK,UAAU,KAAKkB,SAAQ,KAAK,GAAG;AACjD,uBAAO,QAAQ,MAAM,KAAK,EAAE,MAAM;AAAA,cACpC;AACA,kBAAIc,SAAQ,GACRZ,UAAS,SAAS,MAAMY,MAAK,EAAE,MAAM,MAAM,IAAI,IAAI;AAEvD,qBAAO,EAAEA,SAAQ,QAAQ;AACvB,gBAAAZ,UAAS,MAAMY,MAAK,EAAE,KAAK,MAAMZ,OAAM;AAAA,cACzC;AACA,qBAAOA;AAAA,YACT;AAAA,UACF,CAAC;AAAA,QACH;AAqBA,iBAAS,aAAa,MAAM,SAAS,SAAS,UAAU,SAAS,eAAe,cAAc,QAAQa,MAAK,OAAO;AAChH,cAAI,QAAQ,UAAU,eAClB,SAAS,UAAU,gBACnB,YAAY,UAAU,oBACtB,YAAY,WAAW,kBAAkB,wBACzC,SAAS,UAAU,gBACnB,OAAO,YAAYnC,aAAY,WAAW,IAAI;AAElD,mBAAS,UAAU;AACjB,gBAAI,SAAS,UAAU,QACnB,OAAOI,OAAM,MAAM,GACnB,QAAQ;AAEZ,mBAAO,SAAS;AACd,mBAAK,KAAK,IAAI,UAAU,KAAK;AAAA,YAC/B;AACA,gBAAI,WAAW;AACb,kBAAI,cAAc,UAAU,OAAO,GAC/B,eAAe,aAAa,MAAM,WAAW;AAAA,YACnD;AACA,gBAAI,UAAU;AACZ,qBAAO,YAAY,MAAM,UAAU,SAAS,SAAS;AAAA,YACvD;AACA,gBAAI,eAAe;AACjB,qBAAO,iBAAiB,MAAM,eAAe,cAAc,SAAS;AAAA,YACtE;AACA,sBAAU;AACV,gBAAI,aAAa,SAAS,OAAO;AAC/B,kBAAI,aAAa,eAAe,MAAM,WAAW;AACjD,qBAAO;AAAA,gBACL;AAAA,gBAAM;AAAA,gBAAS;AAAA,gBAAc,QAAQ;AAAA,gBAAa;AAAA,gBAClD;AAAA,gBAAM;AAAA,gBAAY;AAAA,gBAAQ+B;AAAA,gBAAK,QAAQ;AAAA,cACzC;AAAA,YACF;AACA,gBAAI,cAAc,SAAS,UAAU,MACjC,KAAK,YAAY,YAAY,IAAI,IAAI;AAEzC,qBAAS,KAAK;AACd,gBAAI,QAAQ;AACV,qBAAO,QAAQ,MAAM,MAAM;AAAA,YAC7B,WAAW,UAAU,SAAS,GAAG;AAC/B,mBAAK,QAAQ;AAAA,YACf;AACA,gBAAI,SAASA,OAAM,QAAQ;AACzB,mBAAK,SAASA;AAAA,YAChB;AACA,gBAAI,QAAQ,SAAS,QAAQ,gBAAgB,SAAS;AACpD,mBAAK,QAAQ,WAAW,EAAE;AAAA,YAC5B;AACA,mBAAO,GAAG,MAAM,aAAa,IAAI;AAAA,UACnC;AACA,iBAAO;AAAA,QACT;AAUA,iBAAS,eAAe,QAAQ,YAAY;AAC1C,iBAAO,SAAS,QAAQZ,WAAU;AAChC,mBAAO,aAAa,QAAQ,QAAQ,WAAWA,SAAQ,GAAG,CAAC,CAAC;AAAA,UAC9D;AAAA,QACF;AAUA,iBAAS,oBAAoB,UAAU,cAAc;AACnD,iBAAO,SAAS,OAAO,OAAO;AAC5B,gBAAID;AACJ,gBAAI,UAAUtB,cAAa,UAAUA,YAAW;AAC9C,qBAAO;AAAA,YACT;AACA,gBAAI,UAAUA,YAAW;AACvB,cAAAsB,UAAS;AAAA,YACX;AACA,gBAAI,UAAUtB,YAAW;AACvB,kBAAIsB,YAAWtB,YAAW;AACxB,uBAAO;AAAA,cACT;AACA,kBAAI,OAAO,SAAS,YAAY,OAAO,SAAS,UAAU;AACxD,wBAAQ,aAAa,KAAK;AAC1B,wBAAQ,aAAa,KAAK;AAAA,cAC5B,OAAO;AACL,wBAAQ,aAAa,KAAK;AAC1B,wBAAQ,aAAa,KAAK;AAAA,cAC5B;AACA,cAAAsB,UAAS,SAAS,OAAO,KAAK;AAAA,YAChC;AACA,mBAAOA;AAAA,UACT;AAAA,QACF;AASA,iBAAS,WAAW,WAAW;AAC7B,iBAAO,SAAS,SAAS,WAAW;AAClC,wBAAY,SAAS,WAAW,UAAU,YAAY,CAAC,CAAC;AACxD,mBAAO,SAAS,SAAS,MAAM;AAC7B,kBAAI,UAAU;AACd,qBAAO,UAAU,WAAW,SAASC,WAAU;AAC7C,uBAAO,MAAMA,WAAU,SAAS,IAAI;AAAA,cACtC,CAAC;AAAA,YACH,CAAC;AAAA,UACH,CAAC;AAAA,QACH;AAWA,iBAAS,cAAc,QAAQ,OAAO;AACpC,kBAAQ,UAAUvB,aAAY,MAAM,aAAa,KAAK;AAEtD,cAAI,cAAc,MAAM;AACxB,cAAI,cAAc,GAAG;AACnB,mBAAO,cAAc,WAAW,OAAO,MAAM,IAAI;AAAA,UACnD;AACA,cAAIsB,UAAS,WAAW,OAAO,WAAW,SAAS,WAAW,KAAK,CAAC,CAAC;AACrE,iBAAO,WAAW,KAAK,IACnB,UAAU,cAAcA,OAAM,GAAG,GAAG,MAAM,EAAE,KAAK,EAAE,IACnDA,QAAO,MAAM,GAAG,MAAM;AAAA,QAC5B;AAcA,iBAAS,cAAc,MAAM,SAAS,SAAS,UAAU;AACvD,cAAI,SAAS,UAAU,gBACnB,OAAO,WAAW,IAAI;AAE1B,mBAAS,UAAU;AACjB,gBAAI,YAAY,IACZ,aAAa,UAAU,QACvB,YAAY,IACZ,aAAa,SAAS,QACtB,OAAOlB,OAAM,aAAa,UAAU,GACpC,KAAM,QAAQ,SAAS,QAAQ,gBAAgB,UAAW,OAAO;AAErE,mBAAO,EAAE,YAAY,YAAY;AAC/B,mBAAK,SAAS,IAAI,SAAS,SAAS;AAAA,YACtC;AACA,mBAAO,cAAc;AACnB,mBAAK,WAAW,IAAI,UAAU,EAAE,SAAS;AAAA,YAC3C;AACA,mBAAO,MAAM,IAAI,SAAS,UAAU,MAAM,IAAI;AAAA,UAChD;AACA,iBAAO;AAAA,QACT;AASA,iBAAS,YAAY,WAAW;AAC9B,iBAAO,SAAS,OAAO,KAAK,MAAM;AAChC,gBAAI,QAAQ,OAAO,QAAQ,YAAY,eAAe,OAAO,KAAK,IAAI,GAAG;AACvE,oBAAM,OAAOJ;AAAA,YACf;AAEA,oBAAQ,SAAS,KAAK;AACtB,gBAAI,QAAQA,YAAW;AACrB,oBAAM;AACN,sBAAQ;AAAA,YACV,OAAO;AACL,oBAAM,SAAS,GAAG;AAAA,YACpB;AACA,mBAAO,SAASA,aAAa,QAAQ,MAAM,IAAI,KAAM,SAAS,IAAI;AAClE,mBAAO,UAAU,OAAO,KAAK,MAAM,SAAS;AAAA,UAC9C;AAAA,QACF;AASA,iBAAS,0BAA0B,UAAU;AAC3C,iBAAO,SAAS,OAAO,OAAO;AAC5B,gBAAI,EAAE,OAAO,SAAS,YAAY,OAAO,SAAS,WAAW;AAC3D,sBAAQ,SAAS,KAAK;AACtB,sBAAQ,SAAS,KAAK;AAAA,YACxB;AACA,mBAAO,SAAS,OAAO,KAAK;AAAA,UAC9B;AAAA,QACF;AAmBA,iBAAS,cAAc,MAAM,SAAS,UAAU,aAAa,SAAS,UAAU,SAAS,QAAQmC,MAAK,OAAO;AAC3G,cAAI,UAAU,UAAU,iBACpB,aAAa,UAAU,UAAUnC,YACjC,kBAAkB,UAAUA,aAAY,SACxC,cAAc,UAAU,WAAWA,YACnC,mBAAmB,UAAUA,aAAY;AAE7C,qBAAY,UAAU,oBAAoB;AAC1C,qBAAW,EAAE,UAAU,0BAA0B;AAEjD,cAAI,EAAE,UAAU,wBAAwB;AACtC,uBAAW,EAAE,iBAAiB;AAAA,UAChC;AACA,cAAI,UAAU;AAAA,YACZ;AAAA,YAAM;AAAA,YAAS;AAAA,YAAS;AAAA,YAAa;AAAA,YAAY;AAAA,YACjD;AAAA,YAAiB;AAAA,YAAQmC;AAAA,YAAK;AAAA,UAChC;AAEA,cAAIb,UAAS,SAAS,MAAMtB,YAAW,OAAO;AAC9C,cAAI,WAAW,IAAI,GAAG;AACpB,oBAAQsB,SAAQ,OAAO;AAAA,UACzB;AACA,UAAAA,QAAO,cAAc;AACrB,iBAAO,gBAAgBA,SAAQ,MAAM,OAAO;AAAA,QAC9C;AASA,iBAAS,YAAY,YAAY;AAC/B,cAAI,OAAOd,MAAK,UAAU;AAC1B,iBAAO,SAAS,QAAQ,WAAW;AACjC,qBAAS,SAAS,MAAM;AACxB,wBAAY,aAAa,OAAO,IAAI,UAAU,UAAU,SAAS,GAAG,GAAG;AACvE,gBAAI,aAAa,eAAe,MAAM,GAAG;AAGvC,kBAAI,QAAQ,SAAS,MAAM,IAAI,KAAK,MAAM,GAAG,GACzC,QAAQ,KAAK,KAAK,CAAC,IAAI,OAAO,CAAC,KAAK,CAAC,IAAI,UAAU;AAEvD,sBAAQ,SAAS,KAAK,IAAI,KAAK,MAAM,GAAG;AACxC,qBAAO,EAAE,KAAK,CAAC,IAAI,OAAO,CAAC,KAAK,CAAC,IAAI;AAAA,YACvC;AACA,mBAAO,KAAK,MAAM;AAAA,UACpB;AAAA,QACF;AASA,YAAI,YAAY,EAAEU,QAAQ,IAAI,WAAW,IAAIA,KAAI,CAAC,EAAC,EAAE,CAAC,CAAC,EAAE,CAAC,KAAM,YAAY,OAAO,SAASO,SAAQ;AAClG,iBAAO,IAAIP,KAAIO,OAAM;AAAA,QACvB;AASA,iBAAS,cAAc,UAAU;AAC/B,iBAAO,SAAS,QAAQ;AACtB,gBAAI,MAAM,OAAO,MAAM;AACvB,gBAAI,OAAO,QAAQ;AACjB,qBAAO,WAAW,MAAM;AAAA,YAC1B;AACA,gBAAI,OAAO,QAAQ;AACjB,qBAAO,WAAW,MAAM;AAAA,YAC1B;AACA,mBAAO,YAAY,QAAQ,SAAS,MAAM,CAAC;AAAA,UAC7C;AAAA,QACF;AA2BA,iBAAS,WAAW,MAAM,SAAS,SAAS,UAAU,SAAS,QAAQU,MAAK,OAAO;AACjF,cAAI,YAAY,UAAU;AAC1B,cAAI,CAAC,aAAa,OAAO,QAAQ,YAAY;AAC3C,kBAAM,IAAIvB,WAAU,eAAe;AAAA,UACrC;AACA,cAAI,SAAS,WAAW,SAAS,SAAS;AAC1C,cAAI,CAAC,QAAQ;AACX,uBAAW,EAAE,oBAAoB;AACjC,uBAAW,UAAUZ;AAAA,UACvB;AACA,UAAAmC,OAAMA,SAAQnC,aAAYmC,OAAM,UAAU,UAAUA,IAAG,GAAG,CAAC;AAC3D,kBAAQ,UAAUnC,aAAY,QAAQ,UAAU,KAAK;AACrD,oBAAU,UAAU,QAAQ,SAAS;AAErC,cAAI,UAAU,yBAAyB;AACrC,gBAAI,gBAAgB,UAChB,eAAe;AAEnB,uBAAW,UAAUA;AAAA,UACvB;AACA,cAAIE,QAAO,YAAYF,aAAY,QAAQ,IAAI;AAE/C,cAAI,UAAU;AAAA,YACZ;AAAA,YAAM;AAAA,YAAS;AAAA,YAAS;AAAA,YAAU;AAAA,YAAS;AAAA,YAAe;AAAA,YAC1D;AAAA,YAAQmC;AAAA,YAAK;AAAA,UACf;AAEA,cAAIjC,OAAM;AACR,sBAAU,SAASA,KAAI;AAAA,UACzB;AACA,iBAAO,QAAQ,CAAC;AAChB,oBAAU,QAAQ,CAAC;AACnB,oBAAU,QAAQ,CAAC;AACnB,qBAAW,QAAQ,CAAC;AACpB,oBAAU,QAAQ,CAAC;AACnB,kBAAQ,QAAQ,CAAC,IAAI,QAAQ,CAAC,MAAMF,aAC/B,YAAY,IAAI,KAAK,SACtB,UAAU,QAAQ,CAAC,IAAI,QAAQ,CAAC;AAEpC,cAAI,CAAC,SAAS,WAAW,kBAAkB,wBAAwB;AACjE,uBAAW,EAAE,kBAAkB;AAAA,UACjC;AACA,cAAI,CAAC,WAAW,WAAW,gBAAgB;AACzC,gBAAIsB,UAAS,WAAW,MAAM,SAAS,OAAO;AAAA,UAChD,WAAW,WAAW,mBAAmB,WAAW,uBAAuB;AACzE,YAAAA,UAAS,YAAY,MAAM,SAAS,KAAK;AAAA,UAC3C,YAAY,WAAW,qBAAqB,YAAY,iBAAiB,uBAAuB,CAAC,QAAQ,QAAQ;AAC/G,YAAAA,UAAS,cAAc,MAAM,SAAS,SAAS,QAAQ;AAAA,UACzD,OAAO;AACL,YAAAA,UAAS,aAAa,MAAMtB,YAAW,OAAO;AAAA,UAChD;AACA,cAAI,SAASE,QAAO,cAAc;AAClC,iBAAO,gBAAgB,OAAOoB,SAAQ,OAAO,GAAG,MAAM,OAAO;AAAA,QAC/D;AAcA,iBAAS,uBAAuB,UAAU,UAAU,KAAK,QAAQ;AAC/D,cAAI,aAAatB,cACZ,GAAG,UAAU,YAAY,GAAG,CAAC,KAAK,CAAC,eAAe,KAAK,QAAQ,GAAG,GAAI;AACzE,mBAAO;AAAA,UACT;AACA,iBAAO;AAAA,QACT;AAgBA,iBAAS,oBAAoB,UAAU,UAAU,KAAK,QAAQ,QAAQ,OAAO;AAC3E,cAAIqB,UAAS,QAAQ,KAAKA,UAAS,QAAQ,GAAG;AAE5C,kBAAM,IAAI,UAAU,QAAQ;AAC5B,sBAAU,UAAU,UAAUrB,YAAW,qBAAqB,KAAK;AACnE,kBAAM,QAAQ,EAAE,QAAQ;AAAA,UAC1B;AACA,iBAAO;AAAA,QACT;AAWA,iBAAS,gBAAgB,OAAO;AAC9B,iBAAO,cAAc,KAAK,IAAIA,aAAY;AAAA,QAC5C;AAeA,iBAAS,YAAY,OAAO,OAAO,SAAS0B,aAAY,WAAW,OAAO;AACxE,cAAI,YAAY,UAAU,sBACtB,YAAY,MAAM,QAClB,YAAY,MAAM;AAEtB,cAAI,aAAa,aAAa,EAAE,aAAa,YAAY,YAAY;AACnE,mBAAO;AAAA,UACT;AAEA,cAAI,aAAa,MAAM,IAAI,KAAK;AAChC,cAAI,aAAa,MAAM,IAAI,KAAK;AAChC,cAAI,cAAc,YAAY;AAC5B,mBAAO,cAAc,SAAS,cAAc;AAAA,UAC9C;AACA,cAAI,QAAQ,IACRJ,UAAS,MACT,OAAQ,UAAU,yBAA0B,IAAI,aAAWtB;AAE/D,gBAAM,IAAI,OAAO,KAAK;AACtB,gBAAM,IAAI,OAAO,KAAK;AAGtB,iBAAO,EAAE,QAAQ,WAAW;AAC1B,gBAAI,WAAW,MAAM,KAAK,GACtB,WAAW,MAAM,KAAK;AAE1B,gBAAI0B,aAAY;AACd,kBAAI,WAAW,YACXA,YAAW,UAAU,UAAU,OAAO,OAAO,OAAO,KAAK,IACzDA,YAAW,UAAU,UAAU,OAAO,OAAO,OAAO,KAAK;AAAA,YAC/D;AACA,gBAAI,aAAa1B,YAAW;AAC1B,kBAAI,UAAU;AACZ;AAAA,cACF;AACA,cAAAsB,UAAS;AACT;AAAA,YACF;AAEA,gBAAI,MAAM;AACR,kBAAI,CAAC,UAAU,OAAO,SAASc,WAAU,UAAU;AAC7C,oBAAI,CAAC,SAAS,MAAM,QAAQ,MACvB,aAAaA,aAAY,UAAU,UAAUA,WAAU,SAASV,aAAY,KAAK,IAAI;AACxF,yBAAO,KAAK,KAAK,QAAQ;AAAA,gBAC3B;AAAA,cACF,CAAC,GAAG;AACN,gBAAAJ,UAAS;AACT;AAAA,cACF;AAAA,YACF,WAAW,EACL,aAAa,YACX,UAAU,UAAU,UAAU,SAASI,aAAY,KAAK,IACzD;AACL,cAAAJ,UAAS;AACT;AAAA,YACF;AAAA,UACF;AACA,gBAAM,QAAQ,EAAE,KAAK;AACrB,gBAAM,QAAQ,EAAE,KAAK;AACrB,iBAAOA;AAAA,QACT;AAmBA,iBAAS,WAAW,QAAQ,OAAO,KAAK,SAASI,aAAY,WAAW,OAAO;AAC7E,kBAAQ,KAAK;AAAA,YACX,KAAK;AACH,kBAAK,OAAO,cAAc,MAAM,cAC3B,OAAO,cAAc,MAAM,YAAa;AAC3C,uBAAO;AAAA,cACT;AACA,uBAAS,OAAO;AAChB,sBAAQ,MAAM;AAAA,YAEhB,KAAK;AACH,kBAAK,OAAO,cAAc,MAAM,cAC5B,CAAC,UAAU,IAAIX,YAAW,MAAM,GAAG,IAAIA,YAAW,KAAK,CAAC,GAAG;AAC7D,uBAAO;AAAA,cACT;AACA,qBAAO;AAAA,YAET,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAGH,qBAAO,GAAG,CAAC,QAAQ,CAAC,KAAK;AAAA,YAE3B,KAAK;AACH,qBAAO,OAAO,QAAQ,MAAM,QAAQ,OAAO,WAAW,MAAM;AAAA,YAE9D,KAAK;AAAA,YACL,KAAK;AAIH,qBAAO,UAAW,QAAQ;AAAA,YAE5B,KAAK;AACH,kBAAI,UAAU;AAAA,YAEhB,KAAK;AACH,kBAAI,YAAY,UAAU;AAC1B,0BAAY,UAAU;AAEtB,kBAAI,OAAO,QAAQ,MAAM,QAAQ,CAAC,WAAW;AAC3C,uBAAO;AAAA,cACT;AAEA,kBAAI,UAAU,MAAM,IAAI,MAAM;AAC9B,kBAAI,SAAS;AACX,uBAAO,WAAW;AAAA,cACpB;AACA,yBAAW;AAGX,oBAAM,IAAI,QAAQ,KAAK;AACvB,kBAAIO,UAAS,YAAY,QAAQ,MAAM,GAAG,QAAQ,KAAK,GAAG,SAASI,aAAY,WAAW,KAAK;AAC/F,oBAAM,QAAQ,EAAE,MAAM;AACtB,qBAAOJ;AAAA,YAET,KAAK;AACH,kBAAI,eAAe;AACjB,uBAAO,cAAc,KAAK,MAAM,KAAK,cAAc,KAAK,KAAK;AAAA,cAC/D;AAAA,UACJ;AACA,iBAAO;AAAA,QACT;AAeA,iBAAS,aAAa,QAAQ,OAAO,SAASI,aAAY,WAAW,OAAO;AAC1E,cAAI,YAAY,UAAU,sBACtB,WAAW,WAAW,MAAM,GAC5B,YAAY,SAAS,QACrB,WAAW,WAAW,KAAK,GAC3B,YAAY,SAAS;AAEzB,cAAI,aAAa,aAAa,CAAC,WAAW;AACxC,mBAAO;AAAA,UACT;AACA,cAAI,QAAQ;AACZ,iBAAO,SAAS;AACd,gBAAI,MAAM,SAAS,KAAK;AACxB,gBAAI,EAAE,YAAY,OAAO,QAAQ,eAAe,KAAK,OAAO,GAAG,IAAI;AACjE,qBAAO;AAAA,YACT;AAAA,UACF;AAEA,cAAI,aAAa,MAAM,IAAI,MAAM;AACjC,cAAI,aAAa,MAAM,IAAI,KAAK;AAChC,cAAI,cAAc,YAAY;AAC5B,mBAAO,cAAc,SAAS,cAAc;AAAA,UAC9C;AACA,cAAIJ,UAAS;AACb,gBAAM,IAAI,QAAQ,KAAK;AACvB,gBAAM,IAAI,OAAO,MAAM;AAEvB,cAAI,WAAW;AACf,iBAAO,EAAE,QAAQ,WAAW;AAC1B,kBAAM,SAAS,KAAK;AACpB,gBAAI,WAAW,OAAO,GAAG,GACrB,WAAW,MAAM,GAAG;AAExB,gBAAII,aAAY;AACd,kBAAI,WAAW,YACXA,YAAW,UAAU,UAAU,KAAK,OAAO,QAAQ,KAAK,IACxDA,YAAW,UAAU,UAAU,KAAK,QAAQ,OAAO,KAAK;AAAA,YAC9D;AAEA,gBAAI,EAAE,aAAa1B,aACV,aAAa,YAAY,UAAU,UAAU,UAAU,SAAS0B,aAAY,KAAK,IAClF,WACD;AACL,cAAAJ,UAAS;AACT;AAAA,YACF;AACA,yBAAa,WAAW,OAAO;AAAA,UACjC;AACA,cAAIA,WAAU,CAAC,UAAU;AACvB,gBAAI,UAAU,OAAO,aACjB,UAAU,MAAM;AAGpB,gBAAI,WAAW,YACV,iBAAiB,UAAU,iBAAiB,UAC7C,EAAE,OAAO,WAAW,cAAc,mBAAmB,WACnD,OAAO,WAAW,cAAc,mBAAmB,UAAU;AACjE,cAAAA,UAAS;AAAA,YACX;AAAA,UACF;AACA,gBAAM,QAAQ,EAAE,MAAM;AACtB,gBAAM,QAAQ,EAAE,KAAK;AACrB,iBAAOA;AAAA,QACT;AASA,iBAAS,SAAS,MAAM;AACtB,iBAAO,YAAY,SAAS,MAAMtB,YAAW,OAAO,GAAG,OAAO,EAAE;AAAA,QAClE;AASA,iBAAS,WAAW,QAAQ;AAC1B,iBAAO,eAAe,QAAQ,MAAM,UAAU;AAAA,QAChD;AAUA,iBAAS,aAAa,QAAQ;AAC5B,iBAAO,eAAe,QAAQ,QAAQ,YAAY;AAAA,QACpD;AASA,YAAI,UAAU,CAAC,UAAU,OAAO,SAAS,MAAM;AAC7C,iBAAO,QAAQ,IAAI,IAAI;AAAA,QACzB;AASA,iBAAS,YAAY,MAAM;AACzB,cAAIsB,UAAU,KAAK,OAAO,IACtB,QAAQ,UAAUA,OAAM,GACxB,SAAS,eAAe,KAAK,WAAWA,OAAM,IAAI,MAAM,SAAS;AAErE,iBAAO,UAAU;AACf,gBAAIpB,QAAO,MAAM,MAAM,GACnB,YAAYA,MAAK;AACrB,gBAAI,aAAa,QAAQ,aAAa,MAAM;AAC1C,qBAAOA,MAAK;AAAA,YACd;AAAA,UACF;AACA,iBAAOoB;AAAA,QACT;AASA,iBAAS,UAAU,MAAM;AACvB,cAAI,SAAS,eAAe,KAAK,QAAQ,aAAa,IAAI,SAAS;AACnE,iBAAO,OAAO;AAAA,QAChB;AAaA,iBAAS,cAAc;AACrB,cAAIA,UAAS,OAAO,YAAY;AAChC,UAAAA,UAASA,YAAW,WAAW,eAAeA;AAC9C,iBAAO,UAAU,SAASA,QAAO,UAAU,CAAC,GAAG,UAAU,CAAC,CAAC,IAAIA;AAAA,QACjE;AAUA,iBAAS,WAAWe,MAAK,KAAK;AAC5B,cAAInC,QAAOmC,KAAI;AACf,iBAAO,UAAU,GAAG,IAChBnC,MAAK,OAAO,OAAO,WAAW,WAAW,MAAM,IAC/CA,MAAK;AAAA,QACX;AASA,iBAAS,aAAa,QAAQ;AAC5B,cAAIoB,UAAS,KAAK,MAAM,GACpB,SAASA,QAAO;AAEpB,iBAAO,UAAU;AACf,gBAAI,MAAMA,QAAO,MAAM,GACnB,QAAQ,OAAO,GAAG;AAEtB,YAAAA,QAAO,MAAM,IAAI,CAAC,KAAK,OAAO,mBAAmB,KAAK,CAAC;AAAA,UACzD;AACA,iBAAOA;AAAA,QACT;AAUA,iBAAS,UAAU,QAAQ,KAAK;AAC9B,cAAI,QAAQ,SAAS,QAAQ,GAAG;AAChC,iBAAO,aAAa,KAAK,IAAI,QAAQtB;AAAA,QACvC;AASA,iBAAS,UAAU,OAAO;AACxB,cAAI,QAAQ,eAAe,KAAK,OAAO,cAAc,GACjD,MAAM,MAAM,cAAc;AAE9B,cAAI;AACF,kBAAM,cAAc,IAAIA;AACxB,gBAAI,WAAW;AAAA,UACjB,SAAS,GAAG;AAAA,UAAC;AAEb,cAAIsB,UAAS,qBAAqB,KAAK,KAAK;AAC5C,cAAI,UAAU;AACZ,gBAAI,OAAO;AACT,oBAAM,cAAc,IAAI;AAAA,YAC1B,OAAO;AACL,qBAAO,MAAM,cAAc;AAAA,YAC7B;AAAA,UACF;AACA,iBAAOA;AAAA,QACT;AASA,YAAI,aAAa,CAAC,mBAAmB,YAAY,SAAS,QAAQ;AAChE,cAAI,UAAU,MAAM;AAClB,mBAAO,CAAC;AAAA,UACV;AACA,mBAASb,QAAO,MAAM;AACtB,iBAAO,YAAY,iBAAiB,MAAM,GAAG,SAAS,QAAQ;AAC5D,mBAAO,qBAAqB,KAAK,QAAQ,MAAM;AAAA,UACjD,CAAC;AAAA,QACH;AASA,YAAI,eAAe,CAAC,mBAAmB,YAAY,SAAS,QAAQ;AAClE,cAAIa,UAAS,CAAC;AACd,iBAAO,QAAQ;AACb,sBAAUA,SAAQ,WAAW,MAAM,CAAC;AACpC,qBAAS,aAAa,MAAM;AAAA,UAC9B;AACA,iBAAOA;AAAA,QACT;AASA,YAAI,SAAS;AAGb,YAAK,YAAY,OAAO,IAAI,SAAS,IAAI,YAAY,CAAC,CAAC,CAAC,KAAK,eACxDN,QAAO,OAAO,IAAIA,MAAG,KAAK,UAC1BC,YAAW,OAAOA,SAAQ,QAAQ,CAAC,KAAK,cACxCC,QAAO,OAAO,IAAIA,MAAG,KAAK,UAC1BC,YAAW,OAAO,IAAIA,UAAO,KAAK,YAAa;AAClD,mBAAS,SAAS,OAAO;AACvB,gBAAIG,UAAS,WAAW,KAAK,GACzB,OAAOA,WAAU,YAAY,MAAM,cAActB,YACjD,aAAa,OAAO,SAAS,IAAI,IAAI;AAEzC,gBAAI,YAAY;AACd,sBAAQ,YAAY;AAAA,gBAClB,KAAK;AAAoB,yBAAO;AAAA,gBAChC,KAAK;AAAe,yBAAO;AAAA,gBAC3B,KAAK;AAAmB,yBAAO;AAAA,gBAC/B,KAAK;AAAe,yBAAO;AAAA,gBAC3B,KAAK;AAAmB,yBAAO;AAAA,cACjC;AAAA,YACF;AACA,mBAAOsB;AAAA,UACT;AAAA,QACF;AAYA,iBAAS,QAAQ,OAAO,KAAK,YAAY;AACvC,cAAI,QAAQ,IACR,SAAS,WAAW;AAExB,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAIpB,QAAO,WAAW,KAAK,GACvBsB,QAAOtB,MAAK;AAEhB,oBAAQA,MAAK,MAAM;AAAA,cACjB,KAAK;AAAa,yBAASsB;AAAM;AAAA,cACjC,KAAK;AAAa,uBAAOA;AAAM;AAAA,cAC/B,KAAK;AAAa,sBAAM,UAAU,KAAK,QAAQA,KAAI;AAAG;AAAA,cACtD,KAAK;AAAa,wBAAQ,UAAU,OAAO,MAAMA,KAAI;AAAG;AAAA,YAC1D;AAAA,UACF;AACA,iBAAO,EAAE,SAAS,OAAO,OAAO,IAAI;AAAA,QACtC;AASA,iBAAS,eAAe,QAAQ;AAC9B,cAAIc,UAAQ,OAAO,MAAM,aAAa;AACtC,iBAAOA,UAAQA,QAAM,CAAC,EAAE,MAAM,cAAc,IAAI,CAAC;AAAA,QACnD;AAWA,iBAAS,QAAQ,QAAQ,MAAM,SAAS;AACtC,iBAAO,SAAS,MAAM,MAAM;AAE5B,cAAI,QAAQ,IACR,SAAS,KAAK,QACdhB,UAAS;AAEb,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,MAAM,MAAM,KAAK,KAAK,CAAC;AAC3B,gBAAI,EAAEA,UAAS,UAAU,QAAQ,QAAQ,QAAQ,GAAG,IAAI;AACtD;AAAA,YACF;AACA,qBAAS,OAAO,GAAG;AAAA,UACrB;AACA,cAAIA,WAAU,EAAE,SAAS,QAAQ;AAC/B,mBAAOA;AAAA,UACT;AACA,mBAAS,UAAU,OAAO,IAAI,OAAO;AACrC,iBAAO,CAAC,CAAC,UAAU,SAAS,MAAM,KAAK,QAAQ,KAAK,MAAM,MACvDF,SAAQ,MAAM,KAAK,YAAY,MAAM;AAAA,QAC1C;AASA,iBAAS,eAAe,OAAO;AAC7B,cAAI,SAAS,MAAM,QACfE,UAAS,IAAI,MAAM,YAAY,MAAM;AAGzC,cAAI,UAAU,OAAO,MAAM,CAAC,KAAK,YAAY,eAAe,KAAK,OAAO,OAAO,GAAG;AAChF,YAAAA,QAAO,QAAQ,MAAM;AACrB,YAAAA,QAAO,QAAQ,MAAM;AAAA,UACvB;AACA,iBAAOA;AAAA,QACT;AASA,iBAAS,gBAAgB,QAAQ;AAC/B,iBAAQ,OAAO,OAAO,eAAe,cAAc,CAAC,YAAY,MAAM,IAClE,WAAW,aAAa,MAAM,CAAC,IAC/B,CAAC;AAAA,QACP;AAcA,iBAAS,eAAe,QAAQ,KAAK,QAAQ;AAC3C,cAAI,OAAO,OAAO;AAClB,kBAAQ,KAAK;AAAA,YACX,KAAK;AACH,qBAAO,iBAAiB,MAAM;AAAA,YAEhC,KAAK;AAAA,YACL,KAAK;AACH,qBAAO,IAAI,KAAK,CAAC,MAAM;AAAA,YAEzB,KAAK;AACH,qBAAO,cAAc,QAAQ,MAAM;AAAA,YAErC,KAAK;AAAA,YAAY,KAAK;AAAA,YACtB,KAAK;AAAA,YAAS,KAAK;AAAA,YAAU,KAAK;AAAA,YAClC,KAAK;AAAA,YAAU,KAAK;AAAA,YAAiB,KAAK;AAAA,YAAW,KAAK;AACxD,qBAAO,gBAAgB,QAAQ,MAAM;AAAA,YAEvC,KAAK;AACH,qBAAO,IAAI;AAAA,YAEb,KAAK;AAAA,YACL,KAAK;AACH,qBAAO,IAAI,KAAK,MAAM;AAAA,YAExB,KAAK;AACH,qBAAO,YAAY,MAAM;AAAA,YAE3B,KAAK;AACH,qBAAO,IAAI;AAAA,YAEb,KAAK;AACH,qBAAO,YAAY,MAAM;AAAA,UAC7B;AAAA,QACF;AAUA,iBAAS,kBAAkB,QAAQ,SAAS;AAC1C,cAAI,SAAS,QAAQ;AACrB,cAAI,CAAC,QAAQ;AACX,mBAAO;AAAA,UACT;AACA,cAAI,YAAY,SAAS;AACzB,kBAAQ,SAAS,KAAK,SAAS,IAAI,OAAO,MAAM,QAAQ,SAAS;AACjE,oBAAU,QAAQ,KAAK,SAAS,IAAI,OAAO,GAAG;AAC9C,iBAAO,OAAO,QAAQ,eAAe,yBAAyB,UAAU,QAAQ;AAAA,QAClF;AASA,iBAAS,cAAc,OAAO;AAC5B,iBAAOF,SAAQ,KAAK,KAAK,YAAY,KAAK,KACxC,CAAC,EAAE,oBAAoB,SAAS,MAAM,gBAAgB;AAAA,QAC1D;AAUA,iBAAS,QAAQ,OAAO,QAAQ;AAC9B,cAAI,OAAO,OAAO;AAClB,mBAAS,UAAU,OAAO,mBAAmB;AAE7C,iBAAO,CAAC,CAAC,WACN,QAAQ,YACN,QAAQ,YAAY,SAAS,KAAK,KAAK,OACrC,QAAQ,MAAM,QAAQ,KAAK,KAAK,QAAQ;AAAA,QACjD;AAYA,iBAAS,eAAe,OAAO,OAAO,QAAQ;AAC5C,cAAI,CAACC,UAAS,MAAM,GAAG;AACrB,mBAAO;AAAA,UACT;AACA,cAAI,OAAO,OAAO;AAClB,cAAI,QAAQ,WACH,YAAY,MAAM,KAAK,QAAQ,OAAO,OAAO,MAAM,IACnD,QAAQ,YAAY,SAAS,QAChC;AACJ,mBAAO,GAAG,OAAO,KAAK,GAAG,KAAK;AAAA,UAChC;AACA,iBAAO;AAAA,QACT;AAUA,iBAAS,MAAM,OAAO,QAAQ;AAC5B,cAAID,SAAQ,KAAK,GAAG;AAClB,mBAAO;AAAA,UACT;AACA,cAAI,OAAO,OAAO;AAClB,cAAI,QAAQ,YAAY,QAAQ,YAAY,QAAQ,aAChD,SAAS,QAAQ,SAAS,KAAK,GAAG;AACpC,mBAAO;AAAA,UACT;AACA,iBAAO,cAAc,KAAK,KAAK,KAAK,CAAC,aAAa,KAAK,KAAK,KACzD,UAAU,QAAQ,SAASX,QAAO,MAAM;AAAA,QAC7C;AASA,iBAAS,UAAU,OAAO;AACxB,cAAI,OAAO,OAAO;AAClB,iBAAQ,QAAQ,YAAY,QAAQ,YAAY,QAAQ,YAAY,QAAQ,YACvE,UAAU,cACV,UAAU;AAAA,QACjB;AAUA,iBAAS,WAAW,MAAM;AACxB,cAAI,WAAW,YAAY,IAAI,GAC3B,QAAQ,OAAO,QAAQ;AAE3B,cAAI,OAAO,SAAS,cAAc,EAAE,YAAY,YAAY,YAAY;AACtE,mBAAO;AAAA,UACT;AACA,cAAI,SAAS,OAAO;AAClB,mBAAO;AAAA,UACT;AACA,cAAIP,QAAO,QAAQ,KAAK;AACxB,iBAAO,CAAC,CAACA,SAAQ,SAASA,MAAK,CAAC;AAAA,QAClC;AASA,iBAAS,SAAS,MAAM;AACtB,iBAAO,CAAC,CAAC,cAAe,cAAc;AAAA,QACxC;AASA,YAAI,aAAa,aAAa,aAAa;AAS3C,iBAAS,YAAY,OAAO;AAC1B,cAAI,OAAO,SAAS,MAAM,aACtB,QAAS,OAAO,QAAQ,cAAc,KAAK,aAAc;AAE7D,iBAAO,UAAU;AAAA,QACnB;AAUA,iBAAS,mBAAmB,OAAO;AACjC,iBAAO,UAAU,SAAS,CAACmB,UAAS,KAAK;AAAA,QAC3C;AAWA,iBAAS,wBAAwB,KAAK,UAAU;AAC9C,iBAAO,SAAS,QAAQ;AACtB,gBAAI,UAAU,MAAM;AAClB,qBAAO;AAAA,YACT;AACA,mBAAO,OAAO,GAAG,MAAM,aACpB,aAAarB,cAAc,OAAOS,QAAO,MAAM;AAAA,UACpD;AAAA,QACF;AAUA,iBAAS,cAAc,MAAM;AAC3B,cAAIa,UAAS,QAAQ,MAAM,SAAS,KAAK;AACvC,gBAAI,MAAM,SAAS,kBAAkB;AACnC,oBAAM,MAAM;AAAA,YACd;AACA,mBAAO;AAAA,UACT,CAAC;AAED,cAAI,QAAQA,QAAO;AACnB,iBAAOA;AAAA,QACT;AAkBA,iBAAS,UAAUpB,OAAM,QAAQ;AAC/B,cAAI,UAAUA,MAAK,CAAC,GAChB,aAAa,OAAO,CAAC,GACrB,aAAa,UAAU,YACvB,WAAW,cAAc,iBAAiB,qBAAqB;AAEnE,cAAI,UACA,cAAc,iBAAmB,WAAW,mBAC5C,cAAc,iBAAmB,WAAW,mBAAqBA,MAAK,CAAC,EAAE,UAAU,OAAO,CAAC,KAC3F,eAAe,gBAAgB,oBAAsB,OAAO,CAAC,EAAE,UAAU,OAAO,CAAC,KAAO,WAAW;AAGvG,cAAI,EAAE,YAAY,UAAU;AAC1B,mBAAOA;AAAA,UACT;AAEA,cAAI,aAAa,gBAAgB;AAC/B,YAAAA,MAAK,CAAC,IAAI,OAAO,CAAC;AAElB,0BAAc,UAAU,iBAAiB,IAAI;AAAA,UAC/C;AAEA,cAAI,QAAQ,OAAO,CAAC;AACpB,cAAI,OAAO;AACT,gBAAI,WAAWA,MAAK,CAAC;AACrB,YAAAA,MAAK,CAAC,IAAI,WAAW,YAAY,UAAU,OAAO,OAAO,CAAC,CAAC,IAAI;AAC/D,YAAAA,MAAK,CAAC,IAAI,WAAW,eAAeA,MAAK,CAAC,GAAG,WAAW,IAAI,OAAO,CAAC;AAAA,UACtE;AAEA,kBAAQ,OAAO,CAAC;AAChB,cAAI,OAAO;AACT,uBAAWA,MAAK,CAAC;AACjB,YAAAA,MAAK,CAAC,IAAI,WAAW,iBAAiB,UAAU,OAAO,OAAO,CAAC,CAAC,IAAI;AACpE,YAAAA,MAAK,CAAC,IAAI,WAAW,eAAeA,MAAK,CAAC,GAAG,WAAW,IAAI,OAAO,CAAC;AAAA,UACtE;AAEA,kBAAQ,OAAO,CAAC;AAChB,cAAI,OAAO;AACT,YAAAA,MAAK,CAAC,IAAI;AAAA,UACZ;AAEA,cAAI,aAAa,eAAe;AAC9B,YAAAA,MAAK,CAAC,IAAIA,MAAK,CAAC,KAAK,OAAO,OAAO,CAAC,IAAI,UAAUA,MAAK,CAAC,GAAG,OAAO,CAAC,CAAC;AAAA,UACtE;AAEA,cAAIA,MAAK,CAAC,KAAK,MAAM;AACnB,YAAAA,MAAK,CAAC,IAAI,OAAO,CAAC;AAAA,UACpB;AAEA,UAAAA,MAAK,CAAC,IAAI,OAAO,CAAC;AAClB,UAAAA,MAAK,CAAC,IAAI;AAEV,iBAAOA;AAAA,QACT;AAWA,iBAAS,aAAa,QAAQ;AAC5B,cAAIoB,UAAS,CAAC;AACd,cAAI,UAAU,MAAM;AAClB,qBAAS,OAAOb,QAAO,MAAM,GAAG;AAC9B,cAAAa,QAAO,KAAK,GAAG;AAAA,YACjB;AAAA,UACF;AACA,iBAAOA;AAAA,QACT;AASA,iBAAS,eAAe,OAAO;AAC7B,iBAAO,qBAAqB,KAAK,KAAK;AAAA,QACxC;AAWA,iBAAS,SAAS,MAAM,OAAOiB,YAAW;AACxC,kBAAQ,UAAU,UAAUvC,aAAa,KAAK,SAAS,IAAK,OAAO,CAAC;AACpE,iBAAO,WAAW;AAChB,gBAAI,OAAO,WACP,QAAQ,IACR,SAAS,UAAU,KAAK,SAAS,OAAO,CAAC,GACzC,QAAQI,OAAM,MAAM;AAExB,mBAAO,EAAE,QAAQ,QAAQ;AACvB,oBAAM,KAAK,IAAI,KAAK,QAAQ,KAAK;AAAA,YACnC;AACA,oBAAQ;AACR,gBAAI,YAAYA,OAAM,QAAQ,CAAC;AAC/B,mBAAO,EAAE,QAAQ,OAAO;AACtB,wBAAU,KAAK,IAAI,KAAK,KAAK;AAAA,YAC/B;AACA,sBAAU,KAAK,IAAImC,WAAU,KAAK;AAClC,mBAAO,MAAM,MAAM,MAAM,SAAS;AAAA,UACpC;AAAA,QACF;AAUA,iBAAS,OAAO,QAAQ,MAAM;AAC5B,iBAAO,KAAK,SAAS,IAAI,SAAS,QAAQ,QAAQ,UAAU,MAAM,GAAG,EAAE,CAAC;AAAA,QAC1E;AAYA,iBAAS,QAAQ,OAAO,SAAS;AAC/B,cAAI,YAAY,MAAM,QAClB,SAAS,UAAU,QAAQ,QAAQ,SAAS,GAC5C,WAAW,UAAU,KAAK;AAE9B,iBAAO,UAAU;AACf,gBAAI,QAAQ,QAAQ,MAAM;AAC1B,kBAAM,MAAM,IAAI,QAAQ,OAAO,SAAS,IAAI,SAAS,KAAK,IAAIvC;AAAA,UAChE;AACA,iBAAO;AAAA,QACT;AAUA,iBAAS,QAAQ,QAAQ,KAAK;AAC5B,cAAI,QAAQ,iBAAiB,OAAO,OAAO,GAAG,MAAM,YAAY;AAC9D;AAAA,UACF;AAEA,cAAI,OAAO,aAAa;AACtB;AAAA,UACF;AAEA,iBAAO,OAAO,GAAG;AAAA,QACnB;AAgBA,YAAI,UAAU,SAAS,WAAW;AAUlC,YAAI4B,cAAa,iBAAiB,SAAS,MAAM,MAAM;AACrD,iBAAO,KAAK,WAAW,MAAM,IAAI;AAAA,QACnC;AAUA,YAAI,cAAc,SAAS,eAAe;AAY1C,iBAAS,gBAAgB,SAAS,WAAW,SAAS;AACpD,cAAI,SAAU,YAAY;AAC1B,iBAAO,YAAY,SAAS,kBAAkB,QAAQ,kBAAkB,eAAe,MAAM,GAAG,OAAO,CAAC,CAAC;AAAA,QAC3G;AAWA,iBAAS,SAAS,MAAM;AACtB,cAAI,QAAQ,GACR,aAAa;AAEjB,iBAAO,WAAW;AAChB,gBAAI,QAAQ,UAAU,GAClB,YAAY,YAAY,QAAQ;AAEpC,yBAAa;AACb,gBAAI,YAAY,GAAG;AACjB,kBAAI,EAAE,SAAS,WAAW;AACxB,uBAAO,UAAU,CAAC;AAAA,cACpB;AAAA,YACF,OAAO;AACL,sBAAQ;AAAA,YACV;AACA,mBAAO,KAAK,MAAM5B,YAAW,SAAS;AAAA,UACxC;AAAA,QACF;AAUA,iBAAS,YAAY,OAAOwB,OAAM;AAChC,cAAI,QAAQ,IACR,SAAS,MAAM,QACf,YAAY,SAAS;AAEzB,UAAAA,QAAOA,UAASxB,aAAY,SAASwB;AACrC,iBAAO,EAAE,QAAQA,OAAM;AACrB,gBAAI,OAAO,WAAW,OAAO,SAAS,GAClC,QAAQ,MAAM,IAAI;AAEtB,kBAAM,IAAI,IAAI,MAAM,KAAK;AACzB,kBAAM,KAAK,IAAI;AAAA,UACjB;AACA,gBAAM,SAASA;AACf,iBAAO;AAAA,QACT;AASA,YAAI,eAAe,cAAc,SAAS,QAAQ;AAChD,cAAIF,UAAS,CAAC;AACd,cAAI,OAAO,WAAW,CAAC,MAAM,IAAY;AACvC,YAAAA,QAAO,KAAK,EAAE;AAAA,UAChB;AACA,iBAAO,QAAQ,YAAY,SAASgB,SAAO,QAAQ,OAAO,WAAW;AACnE,YAAAhB,QAAO,KAAK,QAAQ,UAAU,QAAQ,cAAc,IAAI,IAAK,UAAUgB,OAAM;AAAA,UAC/E,CAAC;AACD,iBAAOhB;AAAA,QACT,CAAC;AASD,iBAAS,MAAM,OAAO;AACpB,cAAI,OAAO,SAAS,YAAY,SAAS,KAAK,GAAG;AAC/C,mBAAO;AAAA,UACT;AACA,cAAIA,UAAU,QAAQ;AACtB,iBAAQA,WAAU,OAAQ,IAAI,SAAU,CAAC,WAAY,OAAOA;AAAA,QAC9D;AASA,iBAAS,SAAS,MAAM;AACtB,cAAI,QAAQ,MAAM;AAChB,gBAAI;AACF,qBAAO,aAAa,KAAK,IAAI;AAAA,YAC/B,SAAS,GAAG;AAAA,YAAC;AACb,gBAAI;AACF,qBAAQ,OAAO;AAAA,YACjB,SAAS,GAAG;AAAA,YAAC;AAAA,UACf;AACA,iBAAO;AAAA,QACT;AAUA,iBAAS,kBAAkB,SAAS,SAAS;AAC3C,oBAAU,WAAW,SAAS,MAAM;AAClC,gBAAI,QAAQ,OAAO,KAAK,CAAC;AACzB,gBAAK,UAAU,KAAK,CAAC,KAAM,CAAC,cAAc,SAAS,KAAK,GAAG;AACzD,sBAAQ,KAAK,KAAK;AAAA,YACpB;AAAA,UACF,CAAC;AACD,iBAAO,QAAQ,KAAK;AAAA,QACtB;AASA,iBAAS,aAAa,SAAS;AAC7B,cAAI,mBAAmB,aAAa;AAClC,mBAAO,QAAQ,MAAM;AAAA,UACvB;AACA,cAAIA,UAAS,IAAI,cAAc,QAAQ,aAAa,QAAQ,SAAS;AACrE,UAAAA,QAAO,cAAc,UAAU,QAAQ,WAAW;AAClD,UAAAA,QAAO,YAAa,QAAQ;AAC5B,UAAAA,QAAO,aAAa,QAAQ;AAC5B,iBAAOA;AAAA,QACT;AAyBA,iBAAS,MAAM,OAAOE,OAAM,OAAO;AACjC,cAAK,QAAQ,eAAe,OAAOA,OAAM,KAAK,IAAIA,UAASxB,YAAY;AACrE,YAAAwB,QAAO;AAAA,UACT,OAAO;AACL,YAAAA,QAAO,UAAU,UAAUA,KAAI,GAAG,CAAC;AAAA,UACrC;AACA,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,CAAC,UAAUA,QAAO,GAAG;AACvB,mBAAO,CAAC;AAAA,UACV;AACA,cAAI,QAAQ,GACR,WAAW,GACXF,UAASlB,OAAM,WAAW,SAASoB,KAAI,CAAC;AAE5C,iBAAO,QAAQ,QAAQ;AACrB,YAAAF,QAAO,UAAU,IAAI,UAAU,OAAO,OAAQ,SAASE,KAAK;AAAA,UAC9D;AACA,iBAAOF;AAAA,QACT;AAiBA,iBAAS,QAAQ,OAAO;AACtB,cAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM,QACnC,WAAW,GACXA,UAAS,CAAC;AAEd,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,QAAQ,MAAM,KAAK;AACvB,gBAAI,OAAO;AACT,cAAAA,QAAO,UAAU,IAAI;AAAA,YACvB;AAAA,UACF;AACA,iBAAOA;AAAA,QACT;AAwBA,iBAAS,SAAS;AAChB,cAAI,SAAS,UAAU;AACvB,cAAI,CAAC,QAAQ;AACX,mBAAO,CAAC;AAAA,UACV;AACA,cAAI,OAAOlB,OAAM,SAAS,CAAC,GACvB,QAAQ,UAAU,CAAC,GACnB,QAAQ;AAEZ,iBAAO,SAAS;AACd,iBAAK,QAAQ,CAAC,IAAI,UAAU,KAAK;AAAA,UACnC;AACA,iBAAO,UAAUgB,SAAQ,KAAK,IAAI,UAAU,KAAK,IAAI,CAAC,KAAK,GAAG,YAAY,MAAM,CAAC,CAAC;AAAA,QACpF;AAuBA,YAAI,aAAa,SAAS,SAAS,OAAOK,SAAQ;AAChD,iBAAO,kBAAkB,KAAK,IAC1B,eAAe,OAAO,YAAYA,SAAQ,GAAG,mBAAmB,IAAI,CAAC,IACrE,CAAC;AAAA,QACP,CAAC;AA4BD,YAAI,eAAe,SAAS,SAAS,OAAOA,SAAQ;AAClD,cAAIF,YAAW,KAAKE,OAAM;AAC1B,cAAI,kBAAkBF,SAAQ,GAAG;AAC/B,YAAAA,YAAWvB;AAAA,UACb;AACA,iBAAO,kBAAkB,KAAK,IAC1B,eAAe,OAAO,YAAYyB,SAAQ,GAAG,mBAAmB,IAAI,GAAG,YAAYF,WAAU,CAAC,CAAC,IAC/F,CAAC;AAAA,QACP,CAAC;AAyBD,YAAI,iBAAiB,SAAS,SAAS,OAAOE,SAAQ;AACpD,cAAI,aAAa,KAAKA,OAAM;AAC5B,cAAI,kBAAkB,UAAU,GAAG;AACjC,yBAAazB;AAAA,UACf;AACA,iBAAO,kBAAkB,KAAK,IAC1B,eAAe,OAAO,YAAYyB,SAAQ,GAAG,mBAAmB,IAAI,GAAGzB,YAAW,UAAU,IAC5F,CAAC;AAAA,QACP,CAAC;AA2BD,iBAAS,KAAK,OAAO,GAAG,OAAO;AAC7B,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,CAAC,QAAQ;AACX,mBAAO,CAAC;AAAA,UACV;AACA,cAAK,SAAS,MAAMA,aAAa,IAAI,UAAU,CAAC;AAChD,iBAAO,UAAU,OAAO,IAAI,IAAI,IAAI,GAAG,MAAM;AAAA,QAC/C;AA2BA,iBAAS,UAAU,OAAO,GAAG,OAAO;AAClC,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,CAAC,QAAQ;AACX,mBAAO,CAAC;AAAA,UACV;AACA,cAAK,SAAS,MAAMA,aAAa,IAAI,UAAU,CAAC;AAChD,cAAI,SAAS;AACb,iBAAO,UAAU,OAAO,GAAG,IAAI,IAAI,IAAI,CAAC;AAAA,QAC1C;AAqCA,iBAAS,eAAe,OAAO,WAAW;AACxC,iBAAQ,SAAS,MAAM,SACnB,UAAU,OAAO,YAAY,WAAW,CAAC,GAAG,MAAM,IAAI,IACtD,CAAC;AAAA,QACP;AAqCA,iBAAS,UAAU,OAAO,WAAW;AACnC,iBAAQ,SAAS,MAAM,SACnB,UAAU,OAAO,YAAY,WAAW,CAAC,GAAG,IAAI,IAChD,CAAC;AAAA,QACP;AA+BA,iBAAS,KAAK,OAAO,OAAO,OAAO,KAAK;AACtC,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,CAAC,QAAQ;AACX,mBAAO,CAAC;AAAA,UACV;AACA,cAAI,SAAS,OAAO,SAAS,YAAY,eAAe,OAAO,OAAO,KAAK,GAAG;AAC5E,oBAAQ;AACR,kBAAM;AAAA,UACR;AACA,iBAAO,SAAS,OAAO,OAAO,OAAO,GAAG;AAAA,QAC1C;AAqCA,iBAAS,UAAU,OAAO,WAAW,WAAW;AAC9C,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,CAAC,QAAQ;AACX,mBAAO;AAAA,UACT;AACA,cAAI,QAAQ,aAAa,OAAO,IAAI,UAAU,SAAS;AACvD,cAAI,QAAQ,GAAG;AACb,oBAAQ,UAAU,SAAS,OAAO,CAAC;AAAA,UACrC;AACA,iBAAO,cAAc,OAAO,YAAY,WAAW,CAAC,GAAG,KAAK;AAAA,QAC9D;AAqCA,iBAAS,cAAc,OAAO,WAAW,WAAW;AAClD,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,CAAC,QAAQ;AACX,mBAAO;AAAA,UACT;AACA,cAAI,QAAQ,SAAS;AACrB,cAAI,cAAcA,YAAW;AAC3B,oBAAQ,UAAU,SAAS;AAC3B,oBAAQ,YAAY,IAChB,UAAU,SAAS,OAAO,CAAC,IAC3B,UAAU,OAAO,SAAS,CAAC;AAAA,UACjC;AACA,iBAAO,cAAc,OAAO,YAAY,WAAW,CAAC,GAAG,OAAO,IAAI;AAAA,QACpE;AAgBA,iBAAS,QAAQ,OAAO;AACtB,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,iBAAO,SAAS,YAAY,OAAO,CAAC,IAAI,CAAC;AAAA,QAC3C;AAgBA,iBAAS,YAAY,OAAO;AAC1B,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,iBAAO,SAAS,YAAY,OAAO,QAAQ,IAAI,CAAC;AAAA,QAClD;AAsBA,iBAAS,aAAa,OAAO,OAAO;AAClC,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,CAAC,QAAQ;AACX,mBAAO,CAAC;AAAA,UACV;AACA,kBAAQ,UAAUA,aAAY,IAAI,UAAU,KAAK;AACjD,iBAAO,YAAY,OAAO,KAAK;AAAA,QACjC;AAiBA,iBAAS,UAAU,OAAO;AACxB,cAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM,QACnCsB,UAAS,CAAC;AAEd,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,OAAO,MAAM,KAAK;AACtB,YAAAA,QAAO,KAAK,CAAC,CAAC,IAAI,KAAK,CAAC;AAAA,UAC1B;AACA,iBAAOA;AAAA,QACT;AAoBA,iBAAS,KAAK,OAAO;AACnB,iBAAQ,SAAS,MAAM,SAAU,MAAM,CAAC,IAAItB;AAAA,QAC9C;AAyBA,iBAAS,QAAQ,OAAO,OAAO,WAAW;AACxC,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,CAAC,QAAQ;AACX,mBAAO;AAAA,UACT;AACA,cAAI,QAAQ,aAAa,OAAO,IAAI,UAAU,SAAS;AACvD,cAAI,QAAQ,GAAG;AACb,oBAAQ,UAAU,SAAS,OAAO,CAAC;AAAA,UACrC;AACA,iBAAO,YAAY,OAAO,OAAO,KAAK;AAAA,QACxC;AAgBA,iBAAS,QAAQ,OAAO;AACtB,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,iBAAO,SAAS,UAAU,OAAO,GAAG,EAAE,IAAI,CAAC;AAAA,QAC7C;AAmBA,YAAI,eAAe,SAAS,SAAS,QAAQ;AAC3C,cAAI,SAAS,SAAS,QAAQ,mBAAmB;AACjD,iBAAQ,OAAO,UAAU,OAAO,CAAC,MAAM,OAAO,CAAC,IAC3C,iBAAiB,MAAM,IACvB,CAAC;AAAA,QACP,CAAC;AAyBD,YAAI,iBAAiB,SAAS,SAAS,QAAQ;AAC7C,cAAIuB,YAAW,KAAK,MAAM,GACtB,SAAS,SAAS,QAAQ,mBAAmB;AAEjD,cAAIA,cAAa,KAAK,MAAM,GAAG;AAC7B,YAAAA,YAAWvB;AAAA,UACb,OAAO;AACL,mBAAO,IAAI;AAAA,UACb;AACA,iBAAQ,OAAO,UAAU,OAAO,CAAC,MAAM,OAAO,CAAC,IAC3C,iBAAiB,QAAQ,YAAYuB,WAAU,CAAC,CAAC,IACjD,CAAC;AAAA,QACP,CAAC;AAuBD,YAAI,mBAAmB,SAAS,SAAS,QAAQ;AAC/C,cAAI,aAAa,KAAK,MAAM,GACxB,SAAS,SAAS,QAAQ,mBAAmB;AAEjD,uBAAa,OAAO,cAAc,aAAa,aAAavB;AAC5D,cAAI,YAAY;AACd,mBAAO,IAAI;AAAA,UACb;AACA,iBAAQ,OAAO,UAAU,OAAO,CAAC,MAAM,OAAO,CAAC,IAC3C,iBAAiB,QAAQA,YAAW,UAAU,IAC9C,CAAC;AAAA,QACP,CAAC;AAiBD,iBAAS,KAAK,OAAO,WAAW;AAC9B,iBAAO,SAAS,OAAO,KAAK,WAAW,KAAK,OAAO,SAAS;AAAA,QAC9D;AAgBA,iBAAS,KAAK,OAAO;AACnB,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,iBAAO,SAAS,MAAM,SAAS,CAAC,IAAIA;AAAA,QACtC;AAuBA,iBAAS,YAAY,OAAO,OAAO,WAAW;AAC5C,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,CAAC,QAAQ;AACX,mBAAO;AAAA,UACT;AACA,cAAI,QAAQ;AACZ,cAAI,cAAcA,YAAW;AAC3B,oBAAQ,UAAU,SAAS;AAC3B,oBAAQ,QAAQ,IAAI,UAAU,SAAS,OAAO,CAAC,IAAI,UAAU,OAAO,SAAS,CAAC;AAAA,UAChF;AACA,iBAAO,UAAU,QACb,kBAAkB,OAAO,OAAO,KAAK,IACrC,cAAc,OAAO,WAAW,OAAO,IAAI;AAAA,QACjD;AAuBA,iBAAS,IAAI,OAAO,GAAG;AACrB,iBAAQ,SAAS,MAAM,SAAU,QAAQ,OAAO,UAAU,CAAC,CAAC,IAAIA;AAAA,QAClE;AAyBA,YAAI,OAAO,SAAS,OAAO;AAsB3B,iBAAS,QAAQ,OAAOyB,SAAQ;AAC9B,iBAAQ,SAAS,MAAM,UAAUA,WAAUA,QAAO,SAC9C,YAAY,OAAOA,OAAM,IACzB;AAAA,QACN;AAyBA,iBAAS,UAAU,OAAOA,SAAQF,WAAU;AAC1C,iBAAQ,SAAS,MAAM,UAAUE,WAAUA,QAAO,SAC9C,YAAY,OAAOA,SAAQ,YAAYF,WAAU,CAAC,CAAC,IACnD;AAAA,QACN;AAyBA,iBAAS,YAAY,OAAOE,SAAQ,YAAY;AAC9C,iBAAQ,SAAS,MAAM,UAAUA,WAAUA,QAAO,SAC9C,YAAY,OAAOA,SAAQzB,YAAW,UAAU,IAChD;AAAA,QACN;AA0BA,YAAI,SAAS,SAAS,SAAS,OAAO,SAAS;AAC7C,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM,QACnCsB,UAAS,OAAO,OAAO,OAAO;AAElC,qBAAW,OAAO,SAAS,SAAS,SAAS,OAAO;AAClD,mBAAO,QAAQ,OAAO,MAAM,IAAI,CAAC,QAAQ;AAAA,UAC3C,CAAC,EAAE,KAAK,gBAAgB,CAAC;AAEzB,iBAAOA;AAAA,QACT,CAAC;AA8BD,iBAAS,OAAO,OAAO,WAAW;AAChC,cAAIA,UAAS,CAAC;AACd,cAAI,EAAE,SAAS,MAAM,SAAS;AAC5B,mBAAOA;AAAA,UACT;AACA,cAAI,QAAQ,IACR,UAAU,CAAC,GACX,SAAS,MAAM;AAEnB,sBAAY,YAAY,WAAW,CAAC;AACpC,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,QAAQ,MAAM,KAAK;AACvB,gBAAI,UAAU,OAAO,OAAO,KAAK,GAAG;AAClC,cAAAA,QAAO,KAAK,KAAK;AACjB,sBAAQ,KAAK,KAAK;AAAA,YACpB;AAAA,UACF;AACA,qBAAW,OAAO,OAAO;AACzB,iBAAOA;AAAA,QACT;AAyBA,iBAAS,QAAQ,OAAO;AACtB,iBAAO,SAAS,OAAO,QAAQ,cAAc,KAAK,KAAK;AAAA,QACzD;AAkBA,iBAAS,MAAM,OAAO,OAAO,KAAK;AAChC,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,CAAC,QAAQ;AACX,mBAAO,CAAC;AAAA,UACV;AACA,cAAI,OAAO,OAAO,OAAO,YAAY,eAAe,OAAO,OAAO,GAAG,GAAG;AACtE,oBAAQ;AACR,kBAAM;AAAA,UACR,OACK;AACH,oBAAQ,SAAS,OAAO,IAAI,UAAU,KAAK;AAC3C,kBAAM,QAAQtB,aAAY,SAAS,UAAU,GAAG;AAAA,UAClD;AACA,iBAAO,UAAU,OAAO,OAAO,GAAG;AAAA,QACpC;AAmBA,iBAAS,YAAY,OAAO,OAAO;AACjC,iBAAO,gBAAgB,OAAO,KAAK;AAAA,QACrC;AA2BA,iBAAS,cAAc,OAAO,OAAOuB,WAAU;AAC7C,iBAAO,kBAAkB,OAAO,OAAO,YAAYA,WAAU,CAAC,CAAC;AAAA,QACjE;AAkBA,iBAAS,cAAc,OAAO,OAAO;AACnC,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,QAAQ;AACV,gBAAI,QAAQ,gBAAgB,OAAO,KAAK;AACxC,gBAAI,QAAQ,UAAU,GAAG,MAAM,KAAK,GAAG,KAAK,GAAG;AAC7C,qBAAO;AAAA,YACT;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAoBA,iBAAS,gBAAgB,OAAO,OAAO;AACrC,iBAAO,gBAAgB,OAAO,OAAO,IAAI;AAAA,QAC3C;AA2BA,iBAAS,kBAAkB,OAAO,OAAOA,WAAU;AACjD,iBAAO,kBAAkB,OAAO,OAAO,YAAYA,WAAU,CAAC,GAAG,IAAI;AAAA,QACvE;AAkBA,iBAAS,kBAAkB,OAAO,OAAO;AACvC,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,QAAQ;AACV,gBAAI,QAAQ,gBAAgB,OAAO,OAAO,IAAI,IAAI;AAClD,gBAAI,GAAG,MAAM,KAAK,GAAG,KAAK,GAAG;AAC3B,qBAAO;AAAA,YACT;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAiBA,iBAAS,WAAW,OAAO;AACzB,iBAAQ,SAAS,MAAM,SACnB,eAAe,KAAK,IACpB,CAAC;AAAA,QACP;AAkBA,iBAAS,aAAa,OAAOA,WAAU;AACrC,iBAAQ,SAAS,MAAM,SACnB,eAAe,OAAO,YAAYA,WAAU,CAAC,CAAC,IAC9C,CAAC;AAAA,QACP;AAgBA,iBAAS,KAAK,OAAO;AACnB,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,iBAAO,SAAS,UAAU,OAAO,GAAG,MAAM,IAAI,CAAC;AAAA,QACjD;AA2BA,iBAAS,KAAK,OAAO,GAAG,OAAO;AAC7B,cAAI,EAAE,SAAS,MAAM,SAAS;AAC5B,mBAAO,CAAC;AAAA,UACV;AACA,cAAK,SAAS,MAAMvB,aAAa,IAAI,UAAU,CAAC;AAChD,iBAAO,UAAU,OAAO,GAAG,IAAI,IAAI,IAAI,CAAC;AAAA,QAC1C;AA2BA,iBAAS,UAAU,OAAO,GAAG,OAAO;AAClC,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM;AACvC,cAAI,CAAC,QAAQ;AACX,mBAAO,CAAC;AAAA,UACV;AACA,cAAK,SAAS,MAAMA,aAAa,IAAI,UAAU,CAAC;AAChD,cAAI,SAAS;AACb,iBAAO,UAAU,OAAO,IAAI,IAAI,IAAI,GAAG,MAAM;AAAA,QAC/C;AAqCA,iBAAS,eAAe,OAAO,WAAW;AACxC,iBAAQ,SAAS,MAAM,SACnB,UAAU,OAAO,YAAY,WAAW,CAAC,GAAG,OAAO,IAAI,IACvD,CAAC;AAAA,QACP;AAqCA,iBAAS,UAAU,OAAO,WAAW;AACnC,iBAAQ,SAAS,MAAM,SACnB,UAAU,OAAO,YAAY,WAAW,CAAC,CAAC,IAC1C,CAAC;AAAA,QACP;AAkBA,YAAI,QAAQ,SAAS,SAAS,QAAQ;AACpC,iBAAO,SAAS,YAAY,QAAQ,GAAG,mBAAmB,IAAI,CAAC;AAAA,QACjE,CAAC;AAyBD,YAAI,UAAU,SAAS,SAAS,QAAQ;AACtC,cAAIuB,YAAW,KAAK,MAAM;AAC1B,cAAI,kBAAkBA,SAAQ,GAAG;AAC/B,YAAAA,YAAWvB;AAAA,UACb;AACA,iBAAO,SAAS,YAAY,QAAQ,GAAG,mBAAmB,IAAI,GAAG,YAAYuB,WAAU,CAAC,CAAC;AAAA,QAC3F,CAAC;AAuBD,YAAI,YAAY,SAAS,SAAS,QAAQ;AACxC,cAAI,aAAa,KAAK,MAAM;AAC5B,uBAAa,OAAO,cAAc,aAAa,aAAavB;AAC5D,iBAAO,SAAS,YAAY,QAAQ,GAAG,mBAAmB,IAAI,GAAGA,YAAW,UAAU;AAAA,QACxF,CAAC;AAoBD,iBAAS,KAAK,OAAO;AACnB,iBAAQ,SAAS,MAAM,SAAU,SAAS,KAAK,IAAI,CAAC;AAAA,QACtD;AAyBA,iBAAS,OAAO,OAAOuB,WAAU;AAC/B,iBAAQ,SAAS,MAAM,SAAU,SAAS,OAAO,YAAYA,WAAU,CAAC,CAAC,IAAI,CAAC;AAAA,QAChF;AAsBA,iBAAS,SAAS,OAAO,YAAY;AACnC,uBAAa,OAAO,cAAc,aAAa,aAAavB;AAC5D,iBAAQ,SAAS,MAAM,SAAU,SAAS,OAAOA,YAAW,UAAU,IAAI,CAAC;AAAA,QAC7E;AAqBA,iBAAS,MAAM,OAAO;AACpB,cAAI,EAAE,SAAS,MAAM,SAAS;AAC5B,mBAAO,CAAC;AAAA,UACV;AACA,cAAI,SAAS;AACb,kBAAQ,YAAY,OAAO,SAAS,OAAO;AACzC,gBAAI,kBAAkB,KAAK,GAAG;AAC5B,uBAAS,UAAU,MAAM,QAAQ,MAAM;AACvC,qBAAO;AAAA,YACT;AAAA,UACF,CAAC;AACD,iBAAO,UAAU,QAAQ,SAAS,OAAO;AACvC,mBAAO,SAAS,OAAO,aAAa,KAAK,CAAC;AAAA,UAC5C,CAAC;AAAA,QACH;AAuBA,iBAAS,UAAU,OAAOuB,WAAU;AAClC,cAAI,EAAE,SAAS,MAAM,SAAS;AAC5B,mBAAO,CAAC;AAAA,UACV;AACA,cAAID,UAAS,MAAM,KAAK;AACxB,cAAIC,aAAY,MAAM;AACpB,mBAAOD;AAAA,UACT;AACA,iBAAO,SAASA,SAAQ,SAAS,OAAO;AACtC,mBAAO,MAAMC,WAAUvB,YAAW,KAAK;AAAA,UACzC,CAAC;AAAA,QACH;AAsBA,YAAI,UAAU,SAAS,SAAS,OAAOyB,SAAQ;AAC7C,iBAAO,kBAAkB,KAAK,IAC1B,eAAe,OAAOA,OAAM,IAC5B,CAAC;AAAA,QACP,CAAC;AAoBD,YAAI,MAAM,SAAS,SAAS,QAAQ;AAClC,iBAAO,QAAQ,YAAY,QAAQ,iBAAiB,CAAC;AAAA,QACvD,CAAC;AAyBD,YAAI,QAAQ,SAAS,SAAS,QAAQ;AACpC,cAAIF,YAAW,KAAK,MAAM;AAC1B,cAAI,kBAAkBA,SAAQ,GAAG;AAC/B,YAAAA,YAAWvB;AAAA,UACb;AACA,iBAAO,QAAQ,YAAY,QAAQ,iBAAiB,GAAG,YAAYuB,WAAU,CAAC,CAAC;AAAA,QACjF,CAAC;AAuBD,YAAI,UAAU,SAAS,SAAS,QAAQ;AACtC,cAAI,aAAa,KAAK,MAAM;AAC5B,uBAAa,OAAO,cAAc,aAAa,aAAavB;AAC5D,iBAAO,QAAQ,YAAY,QAAQ,iBAAiB,GAAGA,YAAW,UAAU;AAAA,QAC9E,CAAC;AAkBD,YAAI,MAAM,SAAS,KAAK;AAkBxB,iBAAS,UAAU,OAAOyB,SAAQ;AAChC,iBAAO,cAAc,SAAS,CAAC,GAAGA,WAAU,CAAC,GAAG,WAAW;AAAA,QAC7D;AAiBA,iBAAS,cAAc,OAAOA,SAAQ;AACpC,iBAAO,cAAc,SAAS,CAAC,GAAGA,WAAU,CAAC,GAAG,OAAO;AAAA,QACzD;AAsBA,YAAI,UAAU,SAAS,SAAS,QAAQ;AACtC,cAAI,SAAS,OAAO,QAChBF,YAAW,SAAS,IAAI,OAAO,SAAS,CAAC,IAAIvB;AAEjD,UAAAuB,YAAW,OAAOA,aAAY,cAAc,OAAO,IAAI,GAAGA,aAAYvB;AACtE,iBAAO,UAAU,QAAQuB,SAAQ;AAAA,QACnC,CAAC;AAiCD,iBAAS,MAAM,OAAO;AACpB,cAAID,UAAS,OAAO,KAAK;AACzB,UAAAA,QAAO,YAAY;AACnB,iBAAOA;AAAA,QACT;AAyBA,iBAAS,IAAI,OAAO,aAAa;AAC/B,sBAAY,KAAK;AACjB,iBAAO;AAAA,QACT;AAyBA,iBAAS,KAAK,OAAO,aAAa;AAChC,iBAAO,YAAY,KAAK;AAAA,QAC1B;AAkBA,YAAI,YAAY,SAAS,SAAS,OAAO;AACvC,cAAI,SAAS,MAAM,QACf,QAAQ,SAAS,MAAM,CAAC,IAAI,GAC5B,QAAQ,KAAK,aACb,cAAc,SAAS,QAAQ;AAAE,mBAAO,OAAO,QAAQ,KAAK;AAAA,UAAG;AAEnE,cAAI,SAAS,KAAK,KAAK,YAAY,UAC/B,EAAE,iBAAiB,gBAAgB,CAAC,QAAQ,KAAK,GAAG;AACtD,mBAAO,KAAK,KAAK,WAAW;AAAA,UAC9B;AACA,kBAAQ,MAAM,MAAM,OAAO,CAAC,SAAS,SAAS,IAAI,EAAE;AACpD,gBAAM,YAAY,KAAK;AAAA,YACrB,QAAQ;AAAA,YACR,QAAQ,CAAC,WAAW;AAAA,YACpB,WAAWtB;AAAA,UACb,CAAC;AACD,iBAAO,IAAI,cAAc,OAAO,KAAK,SAAS,EAAE,KAAK,SAAS,OAAO;AACnE,gBAAI,UAAU,CAAC,MAAM,QAAQ;AAC3B,oBAAM,KAAKA,UAAS;AAAA,YACtB;AACA,mBAAO;AAAA,UACT,CAAC;AAAA,QACH,CAAC;AA6BD,iBAAS,eAAe;AACtB,iBAAO,MAAM,IAAI;AAAA,QACnB;AA4BA,iBAAS,gBAAgB;AACvB,iBAAO,IAAI,cAAc,KAAK,MAAM,GAAG,KAAK,SAAS;AAAA,QACvD;AAwBA,iBAAS,cAAc;AACrB,cAAI,KAAK,eAAeA,YAAW;AACjC,iBAAK,aAAa,QAAQ,KAAK,MAAM,CAAC;AAAA,UACxC;AACA,cAAI,OAAO,KAAK,aAAa,KAAK,WAAW,QACzC,QAAQ,OAAOA,aAAY,KAAK,WAAW,KAAK,WAAW;AAE/D,iBAAO,EAAE,QAAQ,MAAM,SAAS,MAAM;AAAA,QACxC;AAoBA,iBAAS,oBAAoB;AAC3B,iBAAO;AAAA,QACT;AA0BA,iBAAS,aAAa,OAAO;AAC3B,cAAIsB,SACAkB,UAAS;AAEb,iBAAOA,mBAAkB,YAAY;AACnC,gBAAIC,SAAQ,aAAaD,OAAM;AAC/B,YAAAC,OAAM,YAAY;AAClB,YAAAA,OAAM,aAAazC;AACnB,gBAAIsB,SAAQ;AACV,uBAAS,cAAcmB;AAAA,YACzB,OAAO;AACL,cAAAnB,UAASmB;AAAA,YACX;AACA,gBAAI,WAAWA;AACf,YAAAD,UAASA,QAAO;AAAA,UAClB;AACA,mBAAS,cAAc;AACvB,iBAAOlB;AAAA,QACT;AAsBA,iBAAS,iBAAiB;AACxB,cAAI,QAAQ,KAAK;AACjB,cAAI,iBAAiB,aAAa;AAChC,gBAAI,UAAU;AACd,gBAAI,KAAK,YAAY,QAAQ;AAC3B,wBAAU,IAAI,YAAY,IAAI;AAAA,YAChC;AACA,sBAAU,QAAQ,QAAQ;AAC1B,oBAAQ,YAAY,KAAK;AAAA,cACvB,QAAQ;AAAA,cACR,QAAQ,CAAC,OAAO;AAAA,cAChB,WAAWtB;AAAA,YACb,CAAC;AACD,mBAAO,IAAI,cAAc,SAAS,KAAK,SAAS;AAAA,UAClD;AACA,iBAAO,KAAK,KAAK,OAAO;AAAA,QAC1B;AAgBA,iBAAS,eAAe;AACtB,iBAAO,iBAAiB,KAAK,aAAa,KAAK,WAAW;AAAA,QAC5D;AA0BA,YAAI,UAAU,iBAAiB,SAASsB,SAAQ,OAAO,KAAK;AAC1D,cAAI,eAAe,KAAKA,SAAQ,GAAG,GAAG;AACpC,cAAEA,QAAO,GAAG;AAAA,UACd,OAAO;AACL,4BAAgBA,SAAQ,KAAK,CAAC;AAAA,UAChC;AAAA,QACF,CAAC;AA2CD,iBAAS,MAAM,YAAY,WAAW,OAAO;AAC3C,cAAI,OAAOF,SAAQ,UAAU,IAAI,aAAa;AAC9C,cAAI,SAAS,eAAe,YAAY,WAAW,KAAK,GAAG;AACzD,wBAAYpB;AAAA,UACd;AACA,iBAAO,KAAK,YAAY,YAAY,WAAW,CAAC,CAAC;AAAA,QACnD;AA2CA,iBAAS,OAAO,YAAY,WAAW;AACrC,cAAI,OAAOoB,SAAQ,UAAU,IAAI,cAAc;AAC/C,iBAAO,KAAK,YAAY,YAAY,WAAW,CAAC,CAAC;AAAA,QACnD;AAsCA,YAAI,OAAO,WAAW,SAAS;AAqB/B,YAAI,WAAW,WAAW,aAAa;AAuBvC,iBAAS,QAAQ,YAAYG,WAAU;AACrC,iBAAO,YAAY,IAAI,YAAYA,SAAQ,GAAG,CAAC;AAAA,QACjD;AAsBA,iBAAS,YAAY,YAAYA,WAAU;AACzC,iBAAO,YAAY,IAAI,YAAYA,SAAQ,GAAG,QAAQ;AAAA,QACxD;AAuBA,iBAAS,aAAa,YAAYA,WAAU,OAAO;AACjD,kBAAQ,UAAUvB,aAAY,IAAI,UAAU,KAAK;AACjD,iBAAO,YAAY,IAAI,YAAYuB,SAAQ,GAAG,KAAK;AAAA,QACrD;AAgCA,iBAAS,QAAQ,YAAYA,WAAU;AACrC,cAAI,OAAOH,SAAQ,UAAU,IAAI,YAAY;AAC7C,iBAAO,KAAK,YAAY,YAAYG,WAAU,CAAC,CAAC;AAAA,QAClD;AAsBA,iBAAS,aAAa,YAAYA,WAAU;AAC1C,cAAI,OAAOH,SAAQ,UAAU,IAAI,iBAAiB;AAClD,iBAAO,KAAK,YAAY,YAAYG,WAAU,CAAC,CAAC;AAAA,QAClD;AAyBA,YAAI,UAAU,iBAAiB,SAASD,SAAQ,OAAO,KAAK;AAC1D,cAAI,eAAe,KAAKA,SAAQ,GAAG,GAAG;AACpC,YAAAA,QAAO,GAAG,EAAE,KAAK,KAAK;AAAA,UACxB,OAAO;AACL,4BAAgBA,SAAQ,KAAK,CAAC,KAAK,CAAC;AAAA,UACtC;AAAA,QACF,CAAC;AAgCD,iBAAS,SAAS,YAAY,OAAO,WAAW,OAAO;AACrD,uBAAa,YAAY,UAAU,IAAI,aAAa,OAAO,UAAU;AACrE,sBAAa,aAAa,CAAC,QAAS,UAAU,SAAS,IAAI;AAE3D,cAAI,SAAS,WAAW;AACxB,cAAI,YAAY,GAAG;AACjB,wBAAY,UAAU,SAAS,WAAW,CAAC;AAAA,UAC7C;AACA,iBAAO,SAAS,UAAU,IACrB,aAAa,UAAU,WAAW,QAAQ,OAAO,SAAS,IAAI,KAC9D,CAAC,CAAC,UAAU,YAAY,YAAY,OAAO,SAAS,IAAI;AAAA,QAC/D;AAyBA,YAAI,YAAY,SAAS,SAAS,YAAY,MAAM,MAAM;AACxD,cAAI,QAAQ,IACR,SAAS,OAAO,QAAQ,YACxBA,UAAS,YAAY,UAAU,IAAIlB,OAAM,WAAW,MAAM,IAAI,CAAC;AAEnE,mBAAS,YAAY,SAAS,OAAO;AACnC,YAAAkB,QAAO,EAAE,KAAK,IAAI,SAAS,MAAM,MAAM,OAAO,IAAI,IAAI,WAAW,OAAO,MAAM,IAAI;AAAA,UACpF,CAAC;AACD,iBAAOA;AAAA,QACT,CAAC;AA8BD,YAAI,QAAQ,iBAAiB,SAASA,SAAQ,OAAO,KAAK;AACxD,0BAAgBA,SAAQ,KAAK,KAAK;AAAA,QACpC,CAAC;AA4CD,iBAAS,IAAI,YAAYC,WAAU;AACjC,cAAI,OAAOH,SAAQ,UAAU,IAAI,WAAW;AAC5C,iBAAO,KAAK,YAAY,YAAYG,WAAU,CAAC,CAAC;AAAA,QAClD;AA+BA,iBAAS,QAAQ,YAAY,WAAW,QAAQ,OAAO;AACrD,cAAI,cAAc,MAAM;AACtB,mBAAO,CAAC;AAAA,UACV;AACA,cAAI,CAACH,SAAQ,SAAS,GAAG;AACvB,wBAAY,aAAa,OAAO,CAAC,IAAI,CAAC,SAAS;AAAA,UACjD;AACA,mBAAS,QAAQpB,aAAY;AAC7B,cAAI,CAACoB,SAAQ,MAAM,GAAG;AACpB,qBAAS,UAAU,OAAO,CAAC,IAAI,CAAC,MAAM;AAAA,UACxC;AACA,iBAAO,YAAY,YAAY,WAAW,MAAM;AAAA,QAClD;AAsCA,YAAI,YAAY,iBAAiB,SAASE,SAAQ,OAAO,KAAK;AAC5D,UAAAA,QAAO,MAAM,IAAI,CAAC,EAAE,KAAK,KAAK;AAAA,QAChC,GAAG,WAAW;AAAE,iBAAO,CAAC,CAAC,GAAG,CAAC,CAAC;AAAA,QAAG,CAAC;AAuClC,iBAAS,OAAO,YAAYC,WAAU,aAAa;AACjD,cAAI,OAAOH,SAAQ,UAAU,IAAI,cAAc,YAC3C,YAAY,UAAU,SAAS;AAEnC,iBAAO,KAAK,YAAY,YAAYG,WAAU,CAAC,GAAG,aAAa,WAAW,QAAQ;AAAA,QACpF;AAwBA,iBAAS,YAAY,YAAYA,WAAU,aAAa;AACtD,cAAI,OAAOH,SAAQ,UAAU,IAAI,mBAAmB,YAChD,YAAY,UAAU,SAAS;AAEnC,iBAAO,KAAK,YAAY,YAAYG,WAAU,CAAC,GAAG,aAAa,WAAW,aAAa;AAAA,QACzF;AAoCA,iBAAS,OAAO,YAAY,WAAW;AACrC,cAAI,OAAOH,SAAQ,UAAU,IAAI,cAAc;AAC/C,iBAAO,KAAK,YAAY,OAAO,YAAY,WAAW,CAAC,CAAC,CAAC;AAAA,QAC3D;AAgBA,iBAAS,OAAO,YAAY;AAC1B,cAAI,OAAOA,SAAQ,UAAU,IAAI,cAAc;AAC/C,iBAAO,KAAK,UAAU;AAAA,QACxB;AAsBA,iBAAS,WAAW,YAAY,GAAG,OAAO;AACxC,cAAK,QAAQ,eAAe,YAAY,GAAG,KAAK,IAAI,MAAMpB,YAAY;AACpE,gBAAI;AAAA,UACN,OAAO;AACL,gBAAI,UAAU,CAAC;AAAA,UACjB;AACA,cAAI,OAAOoB,SAAQ,UAAU,IAAI,kBAAkB;AACnD,iBAAO,KAAK,YAAY,CAAC;AAAA,QAC3B;AAiBA,iBAAS,QAAQ,YAAY;AAC3B,cAAI,OAAOA,SAAQ,UAAU,IAAI,eAAe;AAChD,iBAAO,KAAK,UAAU;AAAA,QACxB;AAuBA,iBAAS,KAAK,YAAY;AACxB,cAAI,cAAc,MAAM;AACtB,mBAAO;AAAA,UACT;AACA,cAAI,YAAY,UAAU,GAAG;AAC3B,mBAAO,SAAS,UAAU,IAAI,WAAW,UAAU,IAAI,WAAW;AAAA,UACpE;AACA,cAAI,MAAM,OAAO,UAAU;AAC3B,cAAI,OAAO,UAAU,OAAO,QAAQ;AAClC,mBAAO,WAAW;AAAA,UACpB;AACA,iBAAO,SAAS,UAAU,EAAE;AAAA,QAC9B;AAsCA,iBAAS,KAAK,YAAY,WAAW,OAAO;AAC1C,cAAI,OAAOA,SAAQ,UAAU,IAAI,YAAY;AAC7C,cAAI,SAAS,eAAe,YAAY,WAAW,KAAK,GAAG;AACzD,wBAAYpB;AAAA,UACd;AACA,iBAAO,KAAK,YAAY,YAAY,WAAW,CAAC,CAAC;AAAA,QACnD;AA+BA,YAAI,SAAS,SAAS,SAAS,YAAY,WAAW;AACpD,cAAI,cAAc,MAAM;AACtB,mBAAO,CAAC;AAAA,UACV;AACA,cAAI,SAAS,UAAU;AACvB,cAAI,SAAS,KAAK,eAAe,YAAY,UAAU,CAAC,GAAG,UAAU,CAAC,CAAC,GAAG;AACxE,wBAAY,CAAC;AAAA,UACf,WAAW,SAAS,KAAK,eAAe,UAAU,CAAC,GAAG,UAAU,CAAC,GAAG,UAAU,CAAC,CAAC,GAAG;AACjF,wBAAY,CAAC,UAAU,CAAC,CAAC;AAAA,UAC3B;AACA,iBAAO,YAAY,YAAY,YAAY,WAAW,CAAC,GAAG,CAAC,CAAC;AAAA,QAC9D,CAAC;AAoBD,YAAI,MAAM,UAAU,WAAW;AAC7B,iBAAO,KAAK,KAAK,IAAI;AAAA,QACvB;AA4BA,iBAAS,MAAM,GAAG,MAAM;AACtB,cAAI,OAAO,QAAQ,YAAY;AAC7B,kBAAM,IAAIY,WAAU,eAAe;AAAA,UACrC;AACA,cAAI,UAAU,CAAC;AACf,iBAAO,WAAW;AAChB,gBAAI,EAAE,IAAI,GAAG;AACX,qBAAO,KAAK,MAAM,MAAM,SAAS;AAAA,YACnC;AAAA,UACF;AAAA,QACF;AAmBA,iBAAS,IAAI,MAAM,GAAG,OAAO;AAC3B,cAAI,QAAQZ,aAAY;AACxB,cAAK,QAAQ,KAAK,OAAQ,KAAK,SAAS;AACxC,iBAAO,WAAW,MAAM,eAAeA,YAAWA,YAAWA,YAAWA,YAAW,CAAC;AAAA,QACtF;AAmBA,iBAAS,OAAO,GAAG,MAAM;AACvB,cAAIsB;AACJ,cAAI,OAAO,QAAQ,YAAY;AAC7B,kBAAM,IAAIV,WAAU,eAAe;AAAA,UACrC;AACA,cAAI,UAAU,CAAC;AACf,iBAAO,WAAW;AAChB,gBAAI,EAAE,IAAI,GAAG;AACX,cAAAU,UAAS,KAAK,MAAM,MAAM,SAAS;AAAA,YACrC;AACA,gBAAI,KAAK,GAAG;AACV,qBAAOtB;AAAA,YACT;AACA,mBAAOsB;AAAA,UACT;AAAA,QACF;AAqCA,YAAI,OAAO,SAAS,SAAS,MAAM,SAAS,UAAU;AACpD,cAAI,UAAU;AACd,cAAI,SAAS,QAAQ;AACnB,gBAAI,UAAU,eAAe,UAAU,UAAU,IAAI,CAAC;AACtD,uBAAW;AAAA,UACb;AACA,iBAAO,WAAW,MAAM,SAAS,SAAS,UAAU,OAAO;AAAA,QAC7D,CAAC;AA+CD,YAAI,UAAU,SAAS,SAAS,QAAQ,KAAK,UAAU;AACrD,cAAI,UAAU,iBAAiB;AAC/B,cAAI,SAAS,QAAQ;AACnB,gBAAI,UAAU,eAAe,UAAU,UAAU,OAAO,CAAC;AACzD,uBAAW;AAAA,UACb;AACA,iBAAO,WAAW,KAAK,SAAS,QAAQ,UAAU,OAAO;AAAA,QAC3D,CAAC;AA2CD,iBAAS,MAAM,MAAM,OAAO,OAAO;AACjC,kBAAQ,QAAQtB,aAAY;AAC5B,cAAIsB,UAAS,WAAW,MAAM,iBAAiBtB,YAAWA,YAAWA,YAAWA,YAAWA,YAAW,KAAK;AAC3G,UAAAsB,QAAO,cAAc,MAAM;AAC3B,iBAAOA;AAAA,QACT;AAwCA,iBAAS,WAAW,MAAM,OAAO,OAAO;AACtC,kBAAQ,QAAQtB,aAAY;AAC5B,cAAIsB,UAAS,WAAW,MAAM,uBAAuBtB,YAAWA,YAAWA,YAAWA,YAAWA,YAAW,KAAK;AACjH,UAAAsB,QAAO,cAAc,WAAW;AAChC,iBAAOA;AAAA,QACT;AAwDA,iBAAS,SAAS,MAAM,MAAM,SAAS;AACrC,cAAI,UACA,UACA,SACAA,SACA,SACA,cACA,iBAAiB,GACjB,UAAU,OACV,SAAS,OACT,WAAW;AAEf,cAAI,OAAO,QAAQ,YAAY;AAC7B,kBAAM,IAAIV,WAAU,eAAe;AAAA,UACrC;AACA,iBAAO,SAAS,IAAI,KAAK;AACzB,cAAIS,UAAS,OAAO,GAAG;AACrB,sBAAU,CAAC,CAAC,QAAQ;AACpB,qBAAS,aAAa;AACtB,sBAAU,SAAS,UAAU,SAAS,QAAQ,OAAO,KAAK,GAAG,IAAI,IAAI;AACrE,uBAAW,cAAc,UAAU,CAAC,CAAC,QAAQ,WAAW;AAAA,UAC1D;AAEA,mBAAS,WAAW,MAAM;AACxB,gBAAI,OAAO,UACP,UAAU;AAEd,uBAAW,WAAWrB;AACtB,6BAAiB;AACjB,YAAAsB,UAAS,KAAK,MAAM,SAAS,IAAI;AACjC,mBAAOA;AAAA,UACT;AAEA,mBAAS,YAAY,MAAM;AAEzB,6BAAiB;AAEjB,sBAAUM,YAAW,cAAc,IAAI;AAEvC,mBAAO,UAAU,WAAW,IAAI,IAAIN;AAAA,UACtC;AAEA,mBAAS,cAAc,MAAM;AAC3B,gBAAI,oBAAoB,OAAO,cAC3B,sBAAsB,OAAO,gBAC7B,cAAc,OAAO;AAEzB,mBAAO,SACH,UAAU,aAAa,UAAU,mBAAmB,IACpD;AAAA,UACN;AAEA,mBAAS,aAAa,MAAM;AAC1B,gBAAI,oBAAoB,OAAO,cAC3B,sBAAsB,OAAO;AAKjC,mBAAQ,iBAAiBtB,cAAc,qBAAqB,QACzD,oBAAoB,KAAO,UAAU,uBAAuB;AAAA,UACjE;AAEA,mBAAS,eAAe;AACtB,gBAAI,OAAO,IAAI;AACf,gBAAI,aAAa,IAAI,GAAG;AACtB,qBAAO,aAAa,IAAI;AAAA,YAC1B;AAEA,sBAAU4B,YAAW,cAAc,cAAc,IAAI,CAAC;AAAA,UACxD;AAEA,mBAAS,aAAa,MAAM;AAC1B,sBAAU5B;AAIV,gBAAI,YAAY,UAAU;AACxB,qBAAO,WAAW,IAAI;AAAA,YACxB;AACA,uBAAW,WAAWA;AACtB,mBAAOsB;AAAA,UACT;AAEA,mBAAS,SAAS;AAChB,gBAAI,YAAYtB,YAAW;AACzB,cAAAiC,cAAa,OAAO;AAAA,YACtB;AACA,6BAAiB;AACjB,uBAAW,eAAe,WAAW,UAAUjC;AAAA,UACjD;AAEA,mBAAS,QAAQ;AACf,mBAAO,YAAYA,aAAYsB,UAAS,aAAa,IAAI,CAAC;AAAA,UAC5D;AAEA,mBAAS,YAAY;AACnB,gBAAI,OAAO,IAAI,GACX,aAAa,aAAa,IAAI;AAElC,uBAAW;AACX,uBAAW;AACX,2BAAe;AAEf,gBAAI,YAAY;AACd,kBAAI,YAAYtB,YAAW;AACzB,uBAAO,YAAY,YAAY;AAAA,cACjC;AACA,kBAAI,QAAQ;AAEV,gBAAAiC,cAAa,OAAO;AACpB,0BAAUL,YAAW,cAAc,IAAI;AACvC,uBAAO,WAAW,YAAY;AAAA,cAChC;AAAA,YACF;AACA,gBAAI,YAAY5B,YAAW;AACzB,wBAAU4B,YAAW,cAAc,IAAI;AAAA,YACzC;AACA,mBAAON;AAAA,UACT;AACA,oBAAU,SAAS;AACnB,oBAAU,QAAQ;AAClB,iBAAO;AAAA,QACT;AAoBA,YAAI,QAAQ,SAAS,SAAS,MAAM,MAAM;AACxC,iBAAO,UAAU,MAAM,GAAG,IAAI;AAAA,QAChC,CAAC;AAqBD,YAAI,QAAQ,SAAS,SAAS,MAAM,MAAM,MAAM;AAC9C,iBAAO,UAAU,MAAM,SAAS,IAAI,KAAK,GAAG,IAAI;AAAA,QAClD,CAAC;AAoBD,iBAAS,KAAK,MAAM;AAClB,iBAAO,WAAW,MAAM,cAAc;AAAA,QACxC;AA8CA,iBAAS,QAAQ,MAAM,UAAU;AAC/B,cAAI,OAAO,QAAQ,cAAe,YAAY,QAAQ,OAAO,YAAY,YAAa;AACpF,kBAAM,IAAIV,WAAU,eAAe;AAAA,UACrC;AACA,cAAI,WAAW,WAAW;AACxB,gBAAI,OAAO,WACP,MAAM,WAAW,SAAS,MAAM,MAAM,IAAI,IAAI,KAAK,CAAC,GACpD,QAAQ,SAAS;AAErB,gBAAI,MAAM,IAAI,GAAG,GAAG;AAClB,qBAAO,MAAM,IAAI,GAAG;AAAA,YACtB;AACA,gBAAIU,UAAS,KAAK,MAAM,MAAM,IAAI;AAClC,qBAAS,QAAQ,MAAM,IAAI,KAAKA,OAAM,KAAK;AAC3C,mBAAOA;AAAA,UACT;AACA,mBAAS,QAAQ,KAAK,QAAQ,SAAS;AACvC,iBAAO;AAAA,QACT;AAGA,gBAAQ,QAAQ;AAsBhB,iBAAS,OAAO,WAAW;AACzB,cAAI,OAAO,aAAa,YAAY;AAClC,kBAAM,IAAIV,WAAU,eAAe;AAAA,UACrC;AACA,iBAAO,WAAW;AAChB,gBAAI,OAAO;AACX,oBAAQ,KAAK,QAAQ;AAAA,cACnB,KAAK;AAAG,uBAAO,CAAC,UAAU,KAAK,IAAI;AAAA,cACnC,KAAK;AAAG,uBAAO,CAAC,UAAU,KAAK,MAAM,KAAK,CAAC,CAAC;AAAA,cAC5C,KAAK;AAAG,uBAAO,CAAC,UAAU,KAAK,MAAM,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,cACrD,KAAK;AAAG,uBAAO,CAAC,UAAU,KAAK,MAAM,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,YAChE;AACA,mBAAO,CAAC,UAAU,MAAM,MAAM,IAAI;AAAA,UACpC;AAAA,QACF;AAoBA,iBAAS,KAAK,MAAM;AAClB,iBAAO,OAAO,GAAG,IAAI;AAAA,QACvB;AAiCA,YAAI,WAAW,SAAS,SAAS,MAAM,YAAY;AACjD,uBAAc,WAAW,UAAU,KAAKQ,SAAQ,WAAW,CAAC,CAAC,IACzD,SAAS,WAAW,CAAC,GAAG,UAAU,YAAY,CAAC,CAAC,IAChD,SAAS,YAAY,YAAY,CAAC,GAAG,UAAU,YAAY,CAAC,CAAC;AAEjE,cAAI,cAAc,WAAW;AAC7B,iBAAO,SAAS,SAAS,MAAM;AAC7B,gBAAI,QAAQ,IACR,SAAS,UAAU,KAAK,QAAQ,WAAW;AAE/C,mBAAO,EAAE,QAAQ,QAAQ;AACvB,mBAAK,KAAK,IAAI,WAAW,KAAK,EAAE,KAAK,MAAM,KAAK,KAAK,CAAC;AAAA,YACxD;AACA,mBAAO,MAAM,MAAM,MAAM,IAAI;AAAA,UAC/B,CAAC;AAAA,QACH,CAAC;AAmCD,YAAI,UAAU,SAAS,SAAS,MAAM,UAAU;AAC9C,cAAI,UAAU,eAAe,UAAU,UAAU,OAAO,CAAC;AACzD,iBAAO,WAAW,MAAM,mBAAmBpB,YAAW,UAAU,OAAO;AAAA,QACzE,CAAC;AAkCD,YAAI,eAAe,SAAS,SAAS,MAAM,UAAU;AACnD,cAAI,UAAU,eAAe,UAAU,UAAU,YAAY,CAAC;AAC9D,iBAAO,WAAW,MAAM,yBAAyBA,YAAW,UAAU,OAAO;AAAA,QAC/E,CAAC;AAwBD,YAAI,QAAQ,SAAS,SAAS,MAAM,SAAS;AAC3C,iBAAO,WAAW,MAAM,iBAAiBA,YAAWA,YAAWA,YAAW,OAAO;AAAA,QACnF,CAAC;AA2BD,iBAAS,KAAK,MAAM,OAAO;AACzB,cAAI,OAAO,QAAQ,YAAY;AAC7B,kBAAM,IAAIY,WAAU,eAAe;AAAA,UACrC;AACA,kBAAQ,UAAUZ,aAAY,QAAQ,UAAU,KAAK;AACrD,iBAAO,SAAS,MAAM,KAAK;AAAA,QAC7B;AAoCA,iBAAS,OAAO,MAAM,OAAO;AAC3B,cAAI,OAAO,QAAQ,YAAY;AAC7B,kBAAM,IAAIY,WAAU,eAAe;AAAA,UACrC;AACA,kBAAQ,SAAS,OAAO,IAAI,UAAU,UAAU,KAAK,GAAG,CAAC;AACzD,iBAAO,SAAS,SAAS,MAAM;AAC7B,gBAAI,QAAQ,KAAK,KAAK,GAClB,YAAY,UAAU,MAAM,GAAG,KAAK;AAExC,gBAAI,OAAO;AACT,wBAAU,WAAW,KAAK;AAAA,YAC5B;AACA,mBAAO,MAAM,MAAM,MAAM,SAAS;AAAA,UACpC,CAAC;AAAA,QACH;AA8CA,iBAAS,SAAS,MAAM,MAAM,SAAS;AACrC,cAAI,UAAU,MACV,WAAW;AAEf,cAAI,OAAO,QAAQ,YAAY;AAC7B,kBAAM,IAAIA,WAAU,eAAe;AAAA,UACrC;AACA,cAAIS,UAAS,OAAO,GAAG;AACrB,sBAAU,aAAa,UAAU,CAAC,CAAC,QAAQ,UAAU;AACrD,uBAAW,cAAc,UAAU,CAAC,CAAC,QAAQ,WAAW;AAAA,UAC1D;AACA,iBAAO,SAAS,MAAM,MAAM;AAAA,YAC1B,WAAW;AAAA,YACX,WAAW;AAAA,YACX,YAAY;AAAA,UACd,CAAC;AAAA,QACH;AAiBA,iBAAS,MAAM,MAAM;AACnB,iBAAO,IAAI,MAAM,CAAC;AAAA,QACpB;AAwBA,iBAAS,KAAK,OAAO,SAAS;AAC5B,iBAAO,QAAQ,aAAa,OAAO,GAAG,KAAK;AAAA,QAC7C;AAqCA,iBAAS,YAAY;AACnB,cAAI,CAAC,UAAU,QAAQ;AACrB,mBAAO,CAAC;AAAA,UACV;AACA,cAAI,QAAQ,UAAU,CAAC;AACvB,iBAAOD,SAAQ,KAAK,IAAI,QAAQ,CAAC,KAAK;AAAA,QACxC;AA4BA,iBAAS,MAAM,OAAO;AACpB,iBAAO,UAAU,OAAO,kBAAkB;AAAA,QAC5C;AAiCA,iBAAS,UAAU,OAAOM,aAAY;AACpC,UAAAA,cAAa,OAAOA,eAAc,aAAaA,cAAa1B;AAC5D,iBAAO,UAAU,OAAO,oBAAoB0B,WAAU;AAAA,QACxD;AAoBA,iBAAS,UAAU,OAAO;AACxB,iBAAO,UAAU,OAAO,kBAAkB,kBAAkB;AAAA,QAC9D;AA8BA,iBAAS,cAAc,OAAOA,aAAY;AACxC,UAAAA,cAAa,OAAOA,eAAc,aAAaA,cAAa1B;AAC5D,iBAAO,UAAU,OAAO,kBAAkB,oBAAoB0B,WAAU;AAAA,QAC1E;AA0BA,iBAAS,WAAW,QAAQ,QAAQ;AAClC,iBAAO,UAAU,QAAQ,eAAe,QAAQ,QAAQ,KAAK,MAAM,CAAC;AAAA,QACtE;AAkCA,iBAAS,GAAG,OAAO,OAAO;AACxB,iBAAO,UAAU,SAAU,UAAU,SAAS,UAAU;AAAA,QAC1D;AAyBA,YAAI,KAAK,0BAA0B,MAAM;AAyBzC,YAAI,MAAM,0BAA0B,SAAS,OAAO,OAAO;AACzD,iBAAO,SAAS;AAAA,QAClB,CAAC;AAoBD,YAAI,cAAc,gBAAgB,WAAW;AAAE,iBAAO;AAAA,QAAW,EAAE,CAAC,IAAI,kBAAkB,SAAS,OAAO;AACxG,iBAAO,aAAa,KAAK,KAAK,eAAe,KAAK,OAAO,QAAQ,KAC/D,CAAC,qBAAqB,KAAK,OAAO,QAAQ;AAAA,QAC9C;AAyBA,YAAIN,WAAUhB,OAAM;AAmBpB,YAAI,gBAAgB,oBAAoB,UAAU,iBAAiB,IAAI;AA2BvE,iBAAS,YAAY,OAAO;AAC1B,iBAAO,SAAS,QAAQ,SAAS,MAAM,MAAM,KAAK,CAAC,WAAW,KAAK;AAAA,QACrE;AA2BA,iBAAS,kBAAkB,OAAO;AAChC,iBAAO,aAAa,KAAK,KAAK,YAAY,KAAK;AAAA,QACjD;AAmBA,iBAAS,UAAU,OAAO;AACxB,iBAAO,UAAU,QAAQ,UAAU,SAChC,aAAa,KAAK,KAAK,WAAW,KAAK,KAAK;AAAA,QACjD;AAmBA,YAAI,WAAW,kBAAkB;AAmBjC,YAAI,SAAS,aAAa,UAAU,UAAU,IAAI;AAmBlD,iBAAS,UAAU,OAAO;AACxB,iBAAO,aAAa,KAAK,KAAK,MAAM,aAAa,KAAK,CAAC,cAAc,KAAK;AAAA,QAC5E;AAmCA,iBAAS,QAAQ,OAAO;AACtB,cAAI,SAAS,MAAM;AACjB,mBAAO;AAAA,UACT;AACA,cAAI,YAAY,KAAK,MAChBgB,SAAQ,KAAK,KAAK,OAAO,SAAS,YAAY,OAAO,MAAM,UAAU,cACpE,SAAS,KAAK,KAAK,aAAa,KAAK,KAAK,YAAY,KAAK,IAAI;AACnE,mBAAO,CAAC,MAAM;AAAA,UAChB;AACA,cAAI,MAAM,OAAO,KAAK;AACtB,cAAI,OAAO,UAAU,OAAO,QAAQ;AAClC,mBAAO,CAAC,MAAM;AAAA,UAChB;AACA,cAAI,YAAY,KAAK,GAAG;AACtB,mBAAO,CAAC,SAAS,KAAK,EAAE;AAAA,UAC1B;AACA,mBAAS,OAAO,OAAO;AACrB,gBAAI,eAAe,KAAK,OAAO,GAAG,GAAG;AACnC,qBAAO;AAAA,YACT;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AA8BA,iBAAS,QAAQ,OAAO,OAAO;AAC7B,iBAAO,YAAY,OAAO,KAAK;AAAA,QACjC;AAkCA,iBAAS,YAAY,OAAO,OAAOM,aAAY;AAC7C,UAAAA,cAAa,OAAOA,eAAc,aAAaA,cAAa1B;AAC5D,cAAIsB,UAASI,cAAaA,YAAW,OAAO,KAAK,IAAI1B;AACrD,iBAAOsB,YAAWtB,aAAY,YAAY,OAAO,OAAOA,YAAW0B,WAAU,IAAI,CAAC,CAACJ;AAAA,QACrF;AAoBA,iBAAS,QAAQ,OAAO;AACtB,cAAI,CAAC,aAAa,KAAK,GAAG;AACxB,mBAAO;AAAA,UACT;AACA,cAAI,MAAM,WAAW,KAAK;AAC1B,iBAAO,OAAO,YAAY,OAAO,aAC9B,OAAO,MAAM,WAAW,YAAY,OAAO,MAAM,QAAQ,YAAY,CAAC,cAAc,KAAK;AAAA,QAC9F;AA4BA,iBAAS,SAAS,OAAO;AACvB,iBAAO,OAAO,SAAS,YAAY,eAAe,KAAK;AAAA,QACzD;AAmBA,iBAAS,WAAW,OAAO;AACzB,cAAI,CAACD,UAAS,KAAK,GAAG;AACpB,mBAAO;AAAA,UACT;AAGA,cAAI,MAAM,WAAW,KAAK;AAC1B,iBAAO,OAAO,WAAW,OAAO,UAAU,OAAO,YAAY,OAAO;AAAA,QACtE;AA4BA,iBAAS,UAAU,OAAO;AACxB,iBAAO,OAAO,SAAS,YAAY,SAAS,UAAU,KAAK;AAAA,QAC7D;AA4BA,iBAAS,SAAS,OAAO;AACvB,iBAAO,OAAO,SAAS,YACrB,QAAQ,MAAM,QAAQ,KAAK,KAAK,SAAS;AAAA,QAC7C;AA2BA,iBAASA,UAAS,OAAO;AACvB,cAAI,OAAO,OAAO;AAClB,iBAAO,SAAS,SAAS,QAAQ,YAAY,QAAQ;AAAA,QACvD;AA0BA,iBAAS,aAAa,OAAO;AAC3B,iBAAO,SAAS,QAAQ,OAAO,SAAS;AAAA,QAC1C;AAmBA,YAAI,QAAQ,YAAY,UAAU,SAAS,IAAI;AA8B/C,iBAAS,QAAQ,QAAQ,QAAQ;AAC/B,iBAAO,WAAW,UAAU,YAAY,QAAQ,QAAQ,aAAa,MAAM,CAAC;AAAA,QAC9E;AAkCA,iBAAS,YAAY,QAAQ,QAAQK,aAAY;AAC/C,UAAAA,cAAa,OAAOA,eAAc,aAAaA,cAAa1B;AAC5D,iBAAO,YAAY,QAAQ,QAAQ,aAAa,MAAM,GAAG0B,WAAU;AAAA,QACrE;AA8BA,iBAASgB,OAAM,OAAO;AAIpB,iBAAO,SAAS,KAAK,KAAK,SAAS,CAAC;AAAA,QACtC;AA4BA,iBAAS,SAAS,OAAO;AACvB,cAAI,WAAW,KAAK,GAAG;AACrB,kBAAM,IAAIpC,OAAM,eAAe;AAAA,UACjC;AACA,iBAAO,aAAa,KAAK;AAAA,QAC3B;AAmBA,iBAAS,OAAO,OAAO;AACrB,iBAAO,UAAU;AAAA,QACnB;AAsBA,iBAAS,MAAM,OAAO;AACpB,iBAAO,SAAS;AAAA,QAClB;AA4BA,iBAAS,SAAS,OAAO;AACvB,iBAAO,OAAO,SAAS,YACpB,aAAa,KAAK,KAAK,WAAW,KAAK,KAAK;AAAA,QACjD;AA8BA,iBAAS,cAAc,OAAO;AAC5B,cAAI,CAAC,aAAa,KAAK,KAAK,WAAW,KAAK,KAAK,WAAW;AAC1D,mBAAO;AAAA,UACT;AACA,cAAI,QAAQ,aAAa,KAAK;AAC9B,cAAI,UAAU,MAAM;AAClB,mBAAO;AAAA,UACT;AACA,cAAI,OAAO,eAAe,KAAK,OAAO,aAAa,KAAK,MAAM;AAC9D,iBAAO,OAAO,QAAQ,cAAc,gBAAgB,QAClD,aAAa,KAAK,IAAI,KAAK;AAAA,QAC/B;AAmBA,YAAI,WAAW,eAAe,UAAU,YAAY,IAAI;AA6BxD,iBAAS,cAAc,OAAO;AAC5B,iBAAO,UAAU,KAAK,KAAK,SAAS,CAAC,oBAAoB,SAAS;AAAA,QACpE;AAmBA,YAAI,QAAQ,YAAY,UAAU,SAAS,IAAI;AAmB/C,iBAAS,SAAS,OAAO;AACvB,iBAAO,OAAO,SAAS,YACpB,CAACc,SAAQ,KAAK,KAAK,aAAa,KAAK,KAAK,WAAW,KAAK,KAAK;AAAA,QACpE;AAmBA,iBAAS,SAAS,OAAO;AACvB,iBAAO,OAAO,SAAS,YACpB,aAAa,KAAK,KAAK,WAAW,KAAK,KAAK;AAAA,QACjD;AAmBA,YAAI,eAAe,mBAAmB,UAAU,gBAAgB,IAAI;AAmBpE,iBAAS,YAAY,OAAO;AAC1B,iBAAO,UAAUpB;AAAA,QACnB;AAmBA,iBAAS,UAAU,OAAO;AACxB,iBAAO,aAAa,KAAK,KAAK,OAAO,KAAK,KAAK;AAAA,QACjD;AAmBA,iBAAS,UAAU,OAAO;AACxB,iBAAO,aAAa,KAAK,KAAK,WAAW,KAAK,KAAK;AAAA,QACrD;AAyBA,YAAI2C,MAAK,0BAA0B,MAAM;AAyBzC,YAAI,MAAM,0BAA0B,SAAS,OAAO,OAAO;AACzD,iBAAO,SAAS;AAAA,QAClB,CAAC;AAyBD,iBAAS,QAAQ,OAAO;AACtB,cAAI,CAAC,OAAO;AACV,mBAAO,CAAC;AAAA,UACV;AACA,cAAI,YAAY,KAAK,GAAG;AACtB,mBAAO,SAAS,KAAK,IAAI,cAAc,KAAK,IAAI,UAAU,KAAK;AAAA,UACjE;AACA,cAAI,eAAe,MAAM,WAAW,GAAG;AACrC,mBAAO,gBAAgB,MAAM,WAAW,EAAE,CAAC;AAAA,UAC7C;AACA,cAAI,MAAM,OAAO,KAAK,GAClB,OAAO,OAAO,SAAS,aAAc,OAAO,SAAS,aAAa;AAEtE,iBAAO,KAAK,KAAK;AAAA,QACnB;AAyBA,iBAAS,SAAS,OAAO;AACvB,cAAI,CAAC,OAAO;AACV,mBAAO,UAAU,IAAI,QAAQ;AAAA,UAC/B;AACA,kBAAQ,SAAS,KAAK;AACtB,cAAI,UAAU,YAAY,UAAU,CAAC,UAAU;AAC7C,gBAAI,OAAQ,QAAQ,IAAI,KAAK;AAC7B,mBAAO,OAAO;AAAA,UAChB;AACA,iBAAO,UAAU,QAAQ,QAAQ;AAAA,QACnC;AA4BA,iBAAS,UAAU,OAAO;AACxB,cAAIrB,UAAS,SAAS,KAAK,GACvB,YAAYA,UAAS;AAEzB,iBAAOA,YAAWA,UAAU,YAAYA,UAAS,YAAYA,UAAU;AAAA,QACzE;AA6BA,iBAAS,SAAS,OAAO;AACvB,iBAAO,QAAQ,UAAU,UAAU,KAAK,GAAG,GAAG,gBAAgB,IAAI;AAAA,QACpE;AAyBA,iBAAS,SAAS,OAAO;AACvB,cAAI,OAAO,SAAS,UAAU;AAC5B,mBAAO;AAAA,UACT;AACA,cAAI,SAAS,KAAK,GAAG;AACnB,mBAAO;AAAA,UACT;AACA,cAAID,UAAS,KAAK,GAAG;AACnB,gBAAI,QAAQ,OAAO,MAAM,WAAW,aAAa,MAAM,QAAQ,IAAI;AACnE,oBAAQA,UAAS,KAAK,IAAK,QAAQ,KAAM;AAAA,UAC3C;AACA,cAAI,OAAO,SAAS,UAAU;AAC5B,mBAAO,UAAU,IAAI,QAAQ,CAAC;AAAA,UAChC;AACA,kBAAQ,SAAS,KAAK;AACtB,cAAI,WAAW,WAAW,KAAK,KAAK;AACpC,iBAAQ,YAAY,UAAU,KAAK,KAAK,IACpC,aAAa,MAAM,MAAM,CAAC,GAAG,WAAW,IAAI,CAAC,IAC5C,WAAW,KAAK,KAAK,IAAI,MAAM,CAAC;AAAA,QACvC;AA0BA,iBAAS,cAAc,OAAO;AAC5B,iBAAO,WAAW,OAAO,OAAO,KAAK,CAAC;AAAA,QACxC;AA0BA,iBAAS,cAAc,OAAO;AAC5B,iBAAO,QACH,UAAU,UAAU,KAAK,GAAG,CAAC,kBAAkB,gBAAgB,IAC9D,UAAU,IAAI,QAAQ;AAAA,QAC7B;AAuBA,iBAAS,SAAS,OAAO;AACvB,iBAAO,SAAS,OAAO,KAAK,aAAa,KAAK;AAAA,QAChD;AAoCA,YAAI,SAAS,eAAe,SAAS,QAAQ,QAAQ;AACnD,cAAI,YAAY,MAAM,KAAK,YAAY,MAAM,GAAG;AAC9C,uBAAW,QAAQ,KAAK,MAAM,GAAG,MAAM;AACvC;AAAA,UACF;AACA,mBAAS,OAAO,QAAQ;AACtB,gBAAI,eAAe,KAAK,QAAQ,GAAG,GAAG;AACpC,0BAAY,QAAQ,KAAK,OAAO,GAAG,CAAC;AAAA,YACtC;AAAA,UACF;AAAA,QACF,CAAC;AAiCD,YAAI,WAAW,eAAe,SAAS,QAAQ,QAAQ;AACrD,qBAAW,QAAQ,OAAO,MAAM,GAAG,MAAM;AAAA,QAC3C,CAAC;AA+BD,YAAI,eAAe,eAAe,SAAS,QAAQ,QAAQ,UAAUK,aAAY;AAC/E,qBAAW,QAAQ,OAAO,MAAM,GAAG,QAAQA,WAAU;AAAA,QACvD,CAAC;AA8BD,YAAI,aAAa,eAAe,SAAS,QAAQ,QAAQ,UAAUA,aAAY;AAC7E,qBAAW,QAAQ,KAAK,MAAM,GAAG,QAAQA,WAAU;AAAA,QACrD,CAAC;AAmBD,YAAIkB,MAAK,SAAS,MAAM;AAoCxB,iBAAS,OAAO,WAAW,YAAY;AACrC,cAAItB,UAAS,WAAW,SAAS;AACjC,iBAAO,cAAc,OAAOA,UAAS,WAAWA,SAAQ,UAAU;AAAA,QACpE;AAuBA,YAAI,WAAW,SAAS,SAAS,QAAQ,SAAS;AAChD,mBAASb,QAAO,MAAM;AAEtB,cAAI,QAAQ;AACZ,cAAI,SAAS,QAAQ;AACrB,cAAI,QAAQ,SAAS,IAAI,QAAQ,CAAC,IAAIT;AAEtC,cAAI,SAAS,eAAe,QAAQ,CAAC,GAAG,QAAQ,CAAC,GAAG,KAAK,GAAG;AAC1D,qBAAS;AAAA,UACX;AAEA,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,SAAS,QAAQ,KAAK;AAC1B,gBAAI,QAAQ,OAAO,MAAM;AACzB,gBAAI,aAAa;AACjB,gBAAI,cAAc,MAAM;AAExB,mBAAO,EAAE,aAAa,aAAa;AACjC,kBAAI,MAAM,MAAM,UAAU;AAC1B,kBAAI,QAAQ,OAAO,GAAG;AAEtB,kBAAI,UAAUA,cACT,GAAG,OAAO,YAAY,GAAG,CAAC,KAAK,CAAC,eAAe,KAAK,QAAQ,GAAG,GAAI;AACtE,uBAAO,GAAG,IAAI,OAAO,GAAG;AAAA,cAC1B;AAAA,YACF;AAAA,UACF;AAEA,iBAAO;AAAA,QACT,CAAC;AAqBD,YAAI,eAAe,SAAS,SAAS,MAAM;AACzC,eAAK,KAAKA,YAAW,mBAAmB;AACxC,iBAAO,MAAM6C,YAAW7C,YAAW,IAAI;AAAA,QACzC,CAAC;AAqCD,iBAAS,QAAQ,QAAQ,WAAW;AAClC,iBAAO,YAAY,QAAQ,YAAY,WAAW,CAAC,GAAG,UAAU;AAAA,QAClE;AAqCA,iBAAS,YAAY,QAAQ,WAAW;AACtC,iBAAO,YAAY,QAAQ,YAAY,WAAW,CAAC,GAAG,eAAe;AAAA,QACvE;AA8BA,iBAAS,MAAM,QAAQuB,WAAU;AAC/B,iBAAO,UAAU,OACb,SACA,QAAQ,QAAQ,YAAYA,WAAU,CAAC,GAAG,MAAM;AAAA,QACtD;AA4BA,iBAAS,WAAW,QAAQA,WAAU;AACpC,iBAAO,UAAU,OACb,SACA,aAAa,QAAQ,YAAYA,WAAU,CAAC,GAAG,MAAM;AAAA,QAC3D;AA8BA,iBAAS,OAAO,QAAQA,WAAU;AAChC,iBAAO,UAAU,WAAW,QAAQ,YAAYA,WAAU,CAAC,CAAC;AAAA,QAC9D;AA4BA,iBAAS,YAAY,QAAQA,WAAU;AACrC,iBAAO,UAAU,gBAAgB,QAAQ,YAAYA,WAAU,CAAC,CAAC;AAAA,QACnE;AAyBA,iBAAS,UAAU,QAAQ;AACzB,iBAAO,UAAU,OAAO,CAAC,IAAI,cAAc,QAAQ,KAAK,MAAM,CAAC;AAAA,QACjE;AAyBA,iBAAS,YAAY,QAAQ;AAC3B,iBAAO,UAAU,OAAO,CAAC,IAAI,cAAc,QAAQ,OAAO,MAAM,CAAC;AAAA,QACnE;AA2BA,iBAAS,IAAI,QAAQ,MAAM,cAAc;AACvC,cAAID,UAAS,UAAU,OAAOtB,aAAY,QAAQ,QAAQ,IAAI;AAC9D,iBAAOsB,YAAWtB,aAAY,eAAesB;AAAA,QAC/C;AA6BA,iBAAS,IAAI,QAAQ,MAAM;AACzB,iBAAO,UAAU,QAAQ,QAAQ,QAAQ,MAAM,OAAO;AAAA,QACxD;AA4BA,iBAAS,MAAM,QAAQ,MAAM;AAC3B,iBAAO,UAAU,QAAQ,QAAQ,QAAQ,MAAM,SAAS;AAAA,QAC1D;AAoBA,YAAI,SAAS,eAAe,SAASA,SAAQ,OAAO,KAAK;AACvD,cAAI,SAAS,QACT,OAAO,MAAM,YAAY,YAAY;AACvC,oBAAQ,qBAAqB,KAAK,KAAK;AAAA,UACzC;AAEA,UAAAA,QAAO,KAAK,IAAI;AAAA,QAClB,GAAG,SAAS,QAAQ,CAAC;AA4BrB,YAAI,WAAW,eAAe,SAASA,SAAQ,OAAO,KAAK;AACzD,cAAI,SAAS,QACT,OAAO,MAAM,YAAY,YAAY;AACvC,oBAAQ,qBAAqB,KAAK,KAAK;AAAA,UACzC;AAEA,cAAI,eAAe,KAAKA,SAAQ,KAAK,GAAG;AACtC,YAAAA,QAAO,KAAK,EAAE,KAAK,GAAG;AAAA,UACxB,OAAO;AACL,YAAAA,QAAO,KAAK,IAAI,CAAC,GAAG;AAAA,UACtB;AAAA,QACF,GAAG,WAAW;AAoBd,YAAI,SAAS,SAAS,UAAU;AA8BhC,iBAAS,KAAK,QAAQ;AACpB,iBAAO,YAAY,MAAM,IAAI,cAAc,MAAM,IAAI,SAAS,MAAM;AAAA,QACtE;AAyBA,iBAAS,OAAO,QAAQ;AACtB,iBAAO,YAAY,MAAM,IAAI,cAAc,QAAQ,IAAI,IAAI,WAAW,MAAM;AAAA,QAC9E;AAuBA,iBAAS,QAAQ,QAAQC,WAAU;AACjC,cAAID,UAAS,CAAC;AACd,UAAAC,YAAW,YAAYA,WAAU,CAAC;AAElC,qBAAW,QAAQ,SAAS,OAAO,KAAKO,SAAQ;AAC9C,4BAAgBR,SAAQC,UAAS,OAAO,KAAKO,OAAM,GAAG,KAAK;AAAA,UAC7D,CAAC;AACD,iBAAOR;AAAA,QACT;AA8BA,iBAAS,UAAU,QAAQC,WAAU;AACnC,cAAID,UAAS,CAAC;AACd,UAAAC,YAAW,YAAYA,WAAU,CAAC;AAElC,qBAAW,QAAQ,SAAS,OAAO,KAAKO,SAAQ;AAC9C,4BAAgBR,SAAQ,KAAKC,UAAS,OAAO,KAAKO,OAAM,CAAC;AAAA,UAC3D,CAAC;AACD,iBAAOR;AAAA,QACT;AAiCA,YAAIwB,SAAQ,eAAe,SAAS,QAAQ,QAAQ,UAAU;AAC5D,oBAAU,QAAQ,QAAQ,QAAQ;AAAA,QACpC,CAAC;AAiCD,YAAID,aAAY,eAAe,SAAS,QAAQ,QAAQ,UAAUnB,aAAY;AAC5E,oBAAU,QAAQ,QAAQ,UAAUA,WAAU;AAAA,QAChD,CAAC;AAsBD,YAAI,OAAO,SAAS,SAAS,QAAQ,OAAO;AAC1C,cAAIJ,UAAS,CAAC;AACd,cAAI,UAAU,MAAM;AAClB,mBAAOA;AAAA,UACT;AACA,cAAI,SAAS;AACb,kBAAQ,SAAS,OAAO,SAAS,MAAM;AACrC,mBAAO,SAAS,MAAM,MAAM;AAC5B,uBAAW,SAAS,KAAK,SAAS;AAClC,mBAAO;AAAA,UACT,CAAC;AACD,qBAAW,QAAQ,aAAa,MAAM,GAAGA,OAAM;AAC/C,cAAI,QAAQ;AACV,YAAAA,UAAS,UAAUA,SAAQ,kBAAkB,kBAAkB,oBAAoB,eAAe;AAAA,UACpG;AACA,cAAI,SAAS,MAAM;AACnB,iBAAO,UAAU;AACf,sBAAUA,SAAQ,MAAM,MAAM,CAAC;AAAA,UACjC;AACA,iBAAOA;AAAA,QACT,CAAC;AAsBD,iBAAS,OAAO,QAAQ,WAAW;AACjC,iBAAO,OAAO,QAAQ,OAAO,YAAY,SAAS,CAAC,CAAC;AAAA,QACtD;AAmBA,YAAI,OAAO,SAAS,SAAS,QAAQ,OAAO;AAC1C,iBAAO,UAAU,OAAO,CAAC,IAAI,SAAS,QAAQ,KAAK;AAAA,QACrD,CAAC;AAoBD,iBAAS,OAAO,QAAQ,WAAW;AACjC,cAAI,UAAU,MAAM;AAClB,mBAAO,CAAC;AAAA,UACV;AACA,cAAI,QAAQ,SAAS,aAAa,MAAM,GAAG,SAAS,MAAM;AACxD,mBAAO,CAAC,IAAI;AAAA,UACd,CAAC;AACD,sBAAY,YAAY,SAAS;AACjC,iBAAO,WAAW,QAAQ,OAAO,SAAS,OAAO,MAAM;AACrD,mBAAO,UAAU,OAAO,KAAK,CAAC,CAAC;AAAA,UACjC,CAAC;AAAA,QACH;AA+BA,iBAAS,OAAO,QAAQ,MAAM,cAAc;AAC1C,iBAAO,SAAS,MAAM,MAAM;AAE5B,cAAI,QAAQ,IACR,SAAS,KAAK;AAGlB,cAAI,CAAC,QAAQ;AACX,qBAAS;AACT,qBAAStB;AAAA,UACX;AACA,iBAAO,EAAE,QAAQ,QAAQ;AACvB,gBAAI,QAAQ,UAAU,OAAOA,aAAY,OAAO,MAAM,KAAK,KAAK,CAAC,CAAC;AAClE,gBAAI,UAAUA,YAAW;AACvB,sBAAQ;AACR,sBAAQ;AAAA,YACV;AACA,qBAAS,WAAW,KAAK,IAAI,MAAM,KAAK,MAAM,IAAI;AAAA,UACpD;AACA,iBAAO;AAAA,QACT;AA8BA,iBAAS,IAAI,QAAQ,MAAM,OAAO;AAChC,iBAAO,UAAU,OAAO,SAAS,QAAQ,QAAQ,MAAM,KAAK;AAAA,QAC9D;AA0BA,iBAAS,QAAQ,QAAQ,MAAM,OAAO0B,aAAY;AAChD,UAAAA,cAAa,OAAOA,eAAc,aAAaA,cAAa1B;AAC5D,iBAAO,UAAU,OAAO,SAAS,QAAQ,QAAQ,MAAM,OAAO0B,WAAU;AAAA,QAC1E;AA0BA,YAAI,UAAU,cAAc,IAAI;AA0BhC,YAAI,YAAY,cAAc,MAAM;AAgCpC,iBAAS,UAAU,QAAQH,WAAU,aAAa;AAChD,cAAI,QAAQH,SAAQ,MAAM,GACtB,YAAY,SAAS,SAAS,MAAM,KAAK,aAAa,MAAM;AAEhE,UAAAG,YAAW,YAAYA,WAAU,CAAC;AAClC,cAAI,eAAe,MAAM;AACvB,gBAAI,OAAO,UAAU,OAAO;AAC5B,gBAAI,WAAW;AACb,4BAAc,QAAQ,IAAI,SAAO,CAAC;AAAA,YACpC,WACSF,UAAS,MAAM,GAAG;AACzB,4BAAc,WAAW,IAAI,IAAI,WAAW,aAAa,MAAM,CAAC,IAAI,CAAC;AAAA,YACvE,OACK;AACH,4BAAc,CAAC;AAAA,YACjB;AAAA,UACF;AACA,WAAC,YAAY,YAAY,YAAY,QAAQ,SAAS,OAAO,OAAOS,SAAQ;AAC1E,mBAAOP,UAAS,aAAa,OAAO,OAAOO,OAAM;AAAA,UACnD,CAAC;AACD,iBAAO;AAAA,QACT;AA6BA,iBAAS,MAAM,QAAQ,MAAM;AAC3B,iBAAO,UAAU,OAAO,OAAO,UAAU,QAAQ,IAAI;AAAA,QACvD;AA6BA,iBAAS,OAAO,QAAQ,MAAM,SAAS;AACrC,iBAAO,UAAU,OAAO,SAAS,WAAW,QAAQ,MAAM,aAAa,OAAO,CAAC;AAAA,QACjF;AA0BA,iBAAS,WAAW,QAAQ,MAAM,SAASJ,aAAY;AACrD,UAAAA,cAAa,OAAOA,eAAc,aAAaA,cAAa1B;AAC5D,iBAAO,UAAU,OAAO,SAAS,WAAW,QAAQ,MAAM,aAAa,OAAO,GAAG0B,WAAU;AAAA,QAC7F;AA4BA,iBAAS,OAAO,QAAQ;AACtB,iBAAO,UAAU,OAAO,CAAC,IAAI,WAAW,QAAQ,KAAK,MAAM,CAAC;AAAA,QAC9D;AA0BA,iBAAS,SAAS,QAAQ;AACxB,iBAAO,UAAU,OAAO,CAAC,IAAI,WAAW,QAAQ,OAAO,MAAM,CAAC;AAAA,QAChE;AAuBA,iBAAS,MAAM,QAAQ,OAAO,OAAO;AACnC,cAAI,UAAU1B,YAAW;AACvB,oBAAQ;AACR,oBAAQA;AAAA,UACV;AACA,cAAI,UAAUA,YAAW;AACvB,oBAAQ,SAAS,KAAK;AACtB,oBAAQ,UAAU,QAAQ,QAAQ;AAAA,UACpC;AACA,cAAI,UAAUA,YAAW;AACvB,oBAAQ,SAAS,KAAK;AACtB,oBAAQ,UAAU,QAAQ,QAAQ;AAAA,UACpC;AACA,iBAAO,UAAU,SAAS,MAAM,GAAG,OAAO,KAAK;AAAA,QACjD;AAwCA,iBAAS,QAAQ,QAAQ,OAAO,KAAK;AACnC,kBAAQ,SAAS,KAAK;AACtB,cAAI,QAAQA,YAAW;AACrB,kBAAM;AACN,oBAAQ;AAAA,UACV,OAAO;AACL,kBAAM,SAAS,GAAG;AAAA,UACpB;AACA,mBAAS,SAAS,MAAM;AACxB,iBAAO,YAAY,QAAQ,OAAO,GAAG;AAAA,QACvC;AAiCA,iBAAS,OAAO,OAAO,OAAO,UAAU;AACtC,cAAI,YAAY,OAAO,YAAY,aAAa,eAAe,OAAO,OAAO,QAAQ,GAAG;AACtF,oBAAQ,WAAWA;AAAA,UACrB;AACA,cAAI,aAAaA,YAAW;AAC1B,gBAAI,OAAO,SAAS,WAAW;AAC7B,yBAAW;AACX,sBAAQA;AAAA,YACV,WACS,OAAO,SAAS,WAAW;AAClC,yBAAW;AACX,sBAAQA;AAAA,YACV;AAAA,UACF;AACA,cAAI,UAAUA,cAAa,UAAUA,YAAW;AAC9C,oBAAQ;AACR,oBAAQ;AAAA,UACV,OACK;AACH,oBAAQ,SAAS,KAAK;AACtB,gBAAI,UAAUA,YAAW;AACvB,sBAAQ;AACR,sBAAQ;AAAA,YACV,OAAO;AACL,sBAAQ,SAAS,KAAK;AAAA,YACxB;AAAA,UACF;AACA,cAAI,QAAQ,OAAO;AACjB,gBAAI,OAAO;AACX,oBAAQ;AACR,oBAAQ;AAAA,UACV;AACA,cAAI,YAAY,QAAQ,KAAK,QAAQ,GAAG;AACtC,gBAAI,OAAO,aAAa;AACxB,mBAAO,UAAU,QAAS,QAAQ,QAAQ,QAAQ,eAAe,UAAU,OAAO,IAAI,SAAS,EAAE,IAAK,KAAK;AAAA,UAC7G;AACA,iBAAO,WAAW,OAAO,KAAK;AAAA,QAChC;AAwBA,YAAI,YAAY,iBAAiB,SAASsB,SAAQ,MAAM,OAAO;AAC7D,iBAAO,KAAK,YAAY;AACxB,iBAAOA,WAAU,QAAQ,WAAW,IAAI,IAAI;AAAA,QAC9C,CAAC;AAiBD,iBAAS,WAAW,QAAQ;AAC1B,iBAAO,WAAW,SAAS,MAAM,EAAE,YAAY,CAAC;AAAA,QAClD;AAoBA,iBAAS,OAAO,QAAQ;AACtB,mBAAS,SAAS,MAAM;AACxB,iBAAO,UAAU,OAAO,QAAQ,SAAS,YAAY,EAAE,QAAQ,aAAa,EAAE;AAAA,QAChF;AAyBA,iBAAS,SAAS,QAAQ,QAAQ,UAAU;AAC1C,mBAAS,SAAS,MAAM;AACxB,mBAAS,aAAa,MAAM;AAE5B,cAAI,SAAS,OAAO;AACpB,qBAAW,aAAatB,aACpB,SACA,UAAU,UAAU,QAAQ,GAAG,GAAG,MAAM;AAE5C,cAAI,MAAM;AACV,sBAAY,OAAO;AACnB,iBAAO,YAAY,KAAK,OAAO,MAAM,UAAU,GAAG,KAAK;AAAA,QACzD;AA8BA,iBAAS,OAAO,QAAQ;AACtB,mBAAS,SAAS,MAAM;AACxB,iBAAQ,UAAU,mBAAmB,KAAK,MAAM,IAC5C,OAAO,QAAQ,iBAAiB,cAAc,IAC9C;AAAA,QACN;AAiBA,iBAAS,aAAa,QAAQ;AAC5B,mBAAS,SAAS,MAAM;AACxB,iBAAQ,UAAU,gBAAgB,KAAK,MAAM,IACzC,OAAO,QAAQ,cAAc,MAAM,IACnC;AAAA,QACN;AAuBA,YAAI,YAAY,iBAAiB,SAASsB,SAAQ,MAAM,OAAO;AAC7D,iBAAOA,WAAU,QAAQ,MAAM,MAAM,KAAK,YAAY;AAAA,QACxD,CAAC;AAsBD,YAAI,YAAY,iBAAiB,SAASA,SAAQ,MAAM,OAAO;AAC7D,iBAAOA,WAAU,QAAQ,MAAM,MAAM,KAAK,YAAY;AAAA,QACxD,CAAC;AAmBD,YAAI,aAAa,gBAAgB,aAAa;AAyB9C,iBAAS,IAAI,QAAQ,QAAQ,OAAO;AAClC,mBAAS,SAAS,MAAM;AACxB,mBAAS,UAAU,MAAM;AAEzB,cAAI,YAAY,SAAS,WAAW,MAAM,IAAI;AAC9C,cAAI,CAAC,UAAU,aAAa,QAAQ;AAClC,mBAAO;AAAA,UACT;AACA,cAAI,OAAO,SAAS,aAAa;AACjC,iBACE,cAAc,YAAY,GAAG,GAAG,KAAK,IACrC,SACA,cAAc,WAAW,GAAG,GAAG,KAAK;AAAA,QAExC;AAyBA,iBAAS,OAAO,QAAQ,QAAQ,OAAO;AACrC,mBAAS,SAAS,MAAM;AACxB,mBAAS,UAAU,MAAM;AAEzB,cAAI,YAAY,SAAS,WAAW,MAAM,IAAI;AAC9C,iBAAQ,UAAU,YAAY,SACzB,SAAS,cAAc,SAAS,WAAW,KAAK,IACjD;AAAA,QACN;AAyBA,iBAAS,SAAS,QAAQ,QAAQ,OAAO;AACvC,mBAAS,SAAS,MAAM;AACxB,mBAAS,UAAU,MAAM;AAEzB,cAAI,YAAY,SAAS,WAAW,MAAM,IAAI;AAC9C,iBAAQ,UAAU,YAAY,SACzB,cAAc,SAAS,WAAW,KAAK,IAAI,SAC5C;AAAA,QACN;AA0BA,iBAASyB,UAAS,QAAQ,OAAO,OAAO;AACtC,cAAI,SAAS,SAAS,MAAM;AAC1B,oBAAQ;AAAA,UACV,WAAW,OAAO;AAChB,oBAAQ,CAAC;AAAA,UACX;AACA,iBAAO,eAAe,SAAS,MAAM,EAAE,QAAQ,aAAa,EAAE,GAAG,SAAS,CAAC;AAAA,QAC7E;AAwBA,iBAAS,OAAO,QAAQ,GAAG,OAAO;AAChC,cAAK,QAAQ,eAAe,QAAQ,GAAG,KAAK,IAAI,MAAM/C,YAAY;AAChE,gBAAI;AAAA,UACN,OAAO;AACL,gBAAI,UAAU,CAAC;AAAA,UACjB;AACA,iBAAO,WAAW,SAAS,MAAM,GAAG,CAAC;AAAA,QACvC;AAqBA,iBAAS,UAAU;AACjB,cAAI,OAAO,WACP,SAAS,SAAS,KAAK,CAAC,CAAC;AAE7B,iBAAO,KAAK,SAAS,IAAI,SAAS,OAAO,QAAQ,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,QACnE;AAuBA,YAAI,YAAY,iBAAiB,SAASsB,SAAQ,MAAM,OAAO;AAC7D,iBAAOA,WAAU,QAAQ,MAAM,MAAM,KAAK,YAAY;AAAA,QACxD,CAAC;AAqBD,iBAAS,MAAM,QAAQ,WAAW,OAAO;AACvC,cAAI,SAAS,OAAO,SAAS,YAAY,eAAe,QAAQ,WAAW,KAAK,GAAG;AACjF,wBAAY,QAAQtB;AAAA,UACtB;AACA,kBAAQ,UAAUA,aAAY,mBAAmB,UAAU;AAC3D,cAAI,CAAC,OAAO;AACV,mBAAO,CAAC;AAAA,UACV;AACA,mBAAS,SAAS,MAAM;AACxB,cAAI,WACE,OAAO,aAAa,YACnB,aAAa,QAAQ,CAAC,SAAS,SAAS,IACxC;AACL,wBAAY,aAAa,SAAS;AAClC,gBAAI,CAAC,aAAa,WAAW,MAAM,GAAG;AACpC,qBAAO,UAAU,cAAc,MAAM,GAAG,GAAG,KAAK;AAAA,YAClD;AAAA,UACF;AACA,iBAAO,OAAO,MAAM,WAAW,KAAK;AAAA,QACtC;AAuBA,YAAI,YAAY,iBAAiB,SAASsB,SAAQ,MAAM,OAAO;AAC7D,iBAAOA,WAAU,QAAQ,MAAM,MAAM,WAAW,IAAI;AAAA,QACtD,CAAC;AAyBD,iBAAS,WAAW,QAAQ,QAAQ,UAAU;AAC5C,mBAAS,SAAS,MAAM;AACxB,qBAAW,YAAY,OACnB,IACA,UAAU,UAAU,QAAQ,GAAG,GAAG,OAAO,MAAM;AAEnD,mBAAS,aAAa,MAAM;AAC5B,iBAAO,OAAO,MAAM,UAAU,WAAW,OAAO,MAAM,KAAK;AAAA,QAC7D;AA0GA,iBAAS,SAAS,QAAQ,SAAS,OAAO;AAIxC,cAAI,WAAW,OAAO;AAEtB,cAAI,SAAS,eAAe,QAAQ,SAAS,KAAK,GAAG;AACnD,sBAAUtB;AAAA,UACZ;AACA,mBAAS,SAAS,MAAM;AACxB,oBAAU,aAAa,CAAC,GAAG,SAAS,UAAU,sBAAsB;AAEpE,cAAI,UAAU,aAAa,CAAC,GAAG,QAAQ,SAAS,SAAS,SAAS,sBAAsB,GACpF,cAAc,KAAK,OAAO,GAC1B,gBAAgB,WAAW,SAAS,WAAW;AAEnD,cAAI,YACA,cACA,QAAQ,GACR,cAAc,QAAQ,eAAe,WACrC,SAAS;AAGb,cAAI,eAAeU;AAAA,aAChB,QAAQ,UAAU,WAAW,SAAS,MACvC,YAAY,SAAS,OACpB,gBAAgB,gBAAgB,eAAe,WAAW,SAAS,OACnE,QAAQ,YAAY,WAAW,SAAS;AAAA,YACzC;AAAA,UAAG;AAML,cAAI,YAAY,oBACb,eAAe,KAAK,SAAS,WAAW,KACpC,QAAQ,YAAY,IAAI,QAAQ,OAAO,GAAG,IAC1C,4BAA6B,EAAE,kBAAmB,OACnD;AAEN,iBAAO,QAAQ,cAAc,SAAS4B,SAAO,aAAa,kBAAkB,iBAAiB,eAAe,QAAQ;AAClH,iCAAqB,mBAAmB;AAGxC,sBAAU,OAAO,MAAM,OAAO,MAAM,EAAE,QAAQ,mBAAmB,gBAAgB;AAGjF,gBAAI,aAAa;AACf,2BAAa;AACb,wBAAU,cAAc,cAAc;AAAA,YACxC;AACA,gBAAI,eAAe;AACjB,6BAAe;AACf,wBAAU,SAAS,gBAAgB;AAAA,YACrC;AACA,gBAAI,kBAAkB;AACpB,wBAAU,mBAAmB,mBAAmB;AAAA,YAClD;AACA,oBAAQ,SAASA,QAAM;AAIvB,mBAAOA;AAAA,UACT,CAAC;AAED,oBAAU;AAIV,cAAI,WAAW,eAAe,KAAK,SAAS,UAAU,KAAK,QAAQ;AACnE,cAAI,CAAC,UAAU;AACb,qBAAS,mBAAmB,SAAS;AAAA,UACvC,WAGS,2BAA2B,KAAK,QAAQ,GAAG;AAClD,kBAAM,IAAIhC,OAAM,4BAA4B;AAAA,UAC9C;AAGA,oBAAU,eAAe,OAAO,QAAQ,sBAAsB,EAAE,IAAI,QACjE,QAAQ,qBAAqB,IAAI,EACjC,QAAQ,uBAAuB,KAAK;AAGvC,mBAAS,eAAe,YAAY,SAAS,WAC1C,WACG,KACA,0BAEJ,uBACC,aACI,qBACA,OAEJ,eACG,yFAEA,SAEJ,SACA;AAEF,cAAIgB,UAAS,QAAQ,WAAW;AAC9B,mBAAOf,UAAS,aAAa,YAAY,YAAY,MAAM,EACxD,MAAMP,YAAW,aAAa;AAAA,UACnC,CAAC;AAID,UAAAsB,QAAO,SAAS;AAChB,cAAI,QAAQA,OAAM,GAAG;AACnB,kBAAMA;AAAA,UACR;AACA,iBAAOA;AAAA,QACT;AAuBA,iBAAS,QAAQ,OAAO;AACtB,iBAAO,SAAS,KAAK,EAAE,YAAY;AAAA,QACrC;AAuBA,iBAAS,QAAQ,OAAO;AACtB,iBAAO,SAAS,KAAK,EAAE,YAAY;AAAA,QACrC;AAwBA,iBAAS,KAAK,QAAQ,OAAO,OAAO;AAClC,mBAAS,SAAS,MAAM;AACxB,cAAI,WAAW,SAAS,UAAUtB,aAAY;AAC5C,mBAAO,SAAS,MAAM;AAAA,UACxB;AACA,cAAI,CAAC,UAAU,EAAE,QAAQ,aAAa,KAAK,IAAI;AAC7C,mBAAO;AAAA,UACT;AACA,cAAI,aAAa,cAAc,MAAM,GACjC,aAAa,cAAc,KAAK,GAChC,QAAQ,gBAAgB,YAAY,UAAU,GAC9C,MAAM,cAAc,YAAY,UAAU,IAAI;AAElD,iBAAO,UAAU,YAAY,OAAO,GAAG,EAAE,KAAK,EAAE;AAAA,QAClD;AAqBA,iBAAS,QAAQ,QAAQ,OAAO,OAAO;AACrC,mBAAS,SAAS,MAAM;AACxB,cAAI,WAAW,SAAS,UAAUA,aAAY;AAC5C,mBAAO,OAAO,MAAM,GAAG,gBAAgB,MAAM,IAAI,CAAC;AAAA,UACpD;AACA,cAAI,CAAC,UAAU,EAAE,QAAQ,aAAa,KAAK,IAAI;AAC7C,mBAAO;AAAA,UACT;AACA,cAAI,aAAa,cAAc,MAAM,GACjC,MAAM,cAAc,YAAY,cAAc,KAAK,CAAC,IAAI;AAE5D,iBAAO,UAAU,YAAY,GAAG,GAAG,EAAE,KAAK,EAAE;AAAA,QAC9C;AAqBA,iBAAS,UAAU,QAAQ,OAAO,OAAO;AACvC,mBAAS,SAAS,MAAM;AACxB,cAAI,WAAW,SAAS,UAAUA,aAAY;AAC5C,mBAAO,OAAO,QAAQ,aAAa,EAAE;AAAA,UACvC;AACA,cAAI,CAAC,UAAU,EAAE,QAAQ,aAAa,KAAK,IAAI;AAC7C,mBAAO;AAAA,UACT;AACA,cAAI,aAAa,cAAc,MAAM,GACjC,QAAQ,gBAAgB,YAAY,cAAc,KAAK,CAAC;AAE5D,iBAAO,UAAU,YAAY,KAAK,EAAE,KAAK,EAAE;AAAA,QAC7C;AAuCA,iBAAS,SAAS,QAAQ,SAAS;AACjC,cAAI,SAAS,sBACT,WAAW;AAEf,cAAIqB,UAAS,OAAO,GAAG;AACrB,gBAAI,YAAY,eAAe,UAAU,QAAQ,YAAY;AAC7D,qBAAS,YAAY,UAAU,UAAU,QAAQ,MAAM,IAAI;AAC3D,uBAAW,cAAc,UAAU,aAAa,QAAQ,QAAQ,IAAI;AAAA,UACtE;AACA,mBAAS,SAAS,MAAM;AAExB,cAAI,YAAY,OAAO;AACvB,cAAI,WAAW,MAAM,GAAG;AACtB,gBAAI,aAAa,cAAc,MAAM;AACrC,wBAAY,WAAW;AAAA,UACzB;AACA,cAAI,UAAU,WAAW;AACvB,mBAAO;AAAA,UACT;AACA,cAAI,MAAM,SAAS,WAAW,QAAQ;AACtC,cAAI,MAAM,GAAG;AACX,mBAAO;AAAA,UACT;AACA,cAAIC,UAAS,aACT,UAAU,YAAY,GAAG,GAAG,EAAE,KAAK,EAAE,IACrC,OAAO,MAAM,GAAG,GAAG;AAEvB,cAAI,cAActB,YAAW;AAC3B,mBAAOsB,UAAS;AAAA,UAClB;AACA,cAAI,YAAY;AACd,mBAAQA,QAAO,SAAS;AAAA,UAC1B;AACA,cAAI,SAAS,SAAS,GAAG;AACvB,gBAAI,OAAO,MAAM,GAAG,EAAE,OAAO,SAAS,GAAG;AACvC,kBAAIgB,SACA,YAAYhB;AAEhB,kBAAI,CAAC,UAAU,QAAQ;AACrB,4BAAYZ,QAAO,UAAU,QAAQ,SAAS,QAAQ,KAAK,SAAS,CAAC,IAAI,GAAG;AAAA,cAC9E;AACA,wBAAU,YAAY;AACtB,qBAAQ4B,UAAQ,UAAU,KAAK,SAAS,GAAI;AAC1C,oBAAI,SAASA,QAAM;AAAA,cACrB;AACA,cAAAhB,UAASA,QAAO,MAAM,GAAG,WAAWtB,aAAY,MAAM,MAAM;AAAA,YAC9D;AAAA,UACF,WAAW,OAAO,QAAQ,aAAa,SAAS,GAAG,GAAG,KAAK,KAAK;AAC9D,gBAAI,QAAQsB,QAAO,YAAY,SAAS;AACxC,gBAAI,QAAQ,IAAI;AACd,cAAAA,UAASA,QAAO,MAAM,GAAG,KAAK;AAAA,YAChC;AAAA,UACF;AACA,iBAAOA,UAAS;AAAA,QAClB;AAqBA,iBAAS,SAAS,QAAQ;AACxB,mBAAS,SAAS,MAAM;AACxB,iBAAQ,UAAU,iBAAiB,KAAK,MAAM,IAC1C,OAAO,QAAQ,eAAe,gBAAgB,IAC9C;AAAA,QACN;AAsBA,YAAI,YAAY,iBAAiB,SAASA,SAAQ,MAAM,OAAO;AAC7D,iBAAOA,WAAU,QAAQ,MAAM,MAAM,KAAK,YAAY;AAAA,QACxD,CAAC;AAmBD,YAAI,aAAa,gBAAgB,aAAa;AAqB9C,iBAAS,MAAM,QAAQ,SAAS,OAAO;AACrC,mBAAS,SAAS,MAAM;AACxB,oBAAU,QAAQtB,aAAY;AAE9B,cAAI,YAAYA,YAAW;AACzB,mBAAO,eAAe,MAAM,IAAI,aAAa,MAAM,IAAI,WAAW,MAAM;AAAA,UAC1E;AACA,iBAAO,OAAO,MAAM,OAAO,KAAK,CAAC;AAAA,QACnC;AA0BA,YAAI,UAAU,SAAS,SAAS,MAAM,MAAM;AAC1C,cAAI;AACF,mBAAO,MAAM,MAAMA,YAAW,IAAI;AAAA,UACpC,SAAS,GAAG;AACV,mBAAO,QAAQ,CAAC,IAAI,IAAI,IAAIM,OAAM,CAAC;AAAA,UACrC;AAAA,QACF,CAAC;AA4BD,YAAI,UAAU,SAAS,SAAS,QAAQ,aAAa;AACnD,oBAAU,aAAa,SAAS,KAAK;AACnC,kBAAM,MAAM,GAAG;AACf,4BAAgB,QAAQ,KAAK,KAAK,OAAO,GAAG,GAAG,MAAM,CAAC;AAAA,UACxD,CAAC;AACD,iBAAO;AAAA,QACT,CAAC;AA+BD,iBAAS,KAAK,OAAO;AACnB,cAAI,SAAS,SAAS,OAAO,IAAI,MAAM,QACnC,aAAa,YAAY;AAE7B,kBAAQ,CAAC,SAAS,CAAC,IAAI,SAAS,OAAO,SAAS,MAAM;AACpD,gBAAI,OAAO,KAAK,CAAC,KAAK,YAAY;AAChC,oBAAM,IAAIM,WAAU,eAAe;AAAA,YACrC;AACA,mBAAO,CAAC,WAAW,KAAK,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC;AAAA,UACtC,CAAC;AAED,iBAAO,SAAS,SAAS,MAAM;AAC7B,gBAAI,QAAQ;AACZ,mBAAO,EAAE,QAAQ,QAAQ;AACvB,kBAAI,OAAO,MAAM,KAAK;AACtB,kBAAI,MAAM,KAAK,CAAC,GAAG,MAAM,IAAI,GAAG;AAC9B,uBAAO,MAAM,KAAK,CAAC,GAAG,MAAM,IAAI;AAAA,cAClC;AAAA,YACF;AAAA,UACF,CAAC;AAAA,QACH;AA0BA,iBAAS,SAAS,QAAQ;AACxB,iBAAO,aAAa,UAAU,QAAQ,eAAe,CAAC;AAAA,QACxD;AAqBA,iBAAS,SAAS,OAAO;AACvB,iBAAO,WAAW;AAChB,mBAAO;AAAA,UACT;AAAA,QACF;AAsBA,iBAAS,UAAU,OAAO,cAAc;AACtC,iBAAQ,SAAS,QAAQ,UAAU,QAAS,eAAe;AAAA,QAC7D;AAwBA,YAAI,OAAO,WAAW;AAuBtB,YAAI,YAAY,WAAW,IAAI;AAkB/B,iBAAS,SAAS,OAAO;AACvB,iBAAO;AAAA,QACT;AA4CA,iBAAS,SAAS,MAAM;AACtB,iBAAO,aAAa,OAAO,QAAQ,aAAa,OAAO,UAAU,MAAM,eAAe,CAAC;AAAA,QACzF;AAqCA,iBAAS,QAAQ,QAAQ;AACvB,iBAAO,YAAY,UAAU,QAAQ,eAAe,CAAC;AAAA,QACvD;AAmCA,iBAAS,gBAAgB,MAAM,UAAU;AACvC,iBAAO,oBAAoB,MAAM,UAAU,UAAU,eAAe,CAAC;AAAA,QACvE;AA0BA,YAAI,SAAS,SAAS,SAAS,MAAM,MAAM;AACzC,iBAAO,SAAS,QAAQ;AACtB,mBAAO,WAAW,QAAQ,MAAM,IAAI;AAAA,UACtC;AAAA,QACF,CAAC;AAyBD,YAAI,WAAW,SAAS,SAAS,QAAQ,MAAM;AAC7C,iBAAO,SAAS,MAAM;AACpB,mBAAO,WAAW,QAAQ,MAAM,IAAI;AAAA,UACtC;AAAA,QACF,CAAC;AAsCD,iBAAS,MAAM,QAAQ,QAAQ,SAAS;AACtC,cAAI,QAAQ,KAAK,MAAM,GACnB,cAAc,cAAc,QAAQ,KAAK;AAE7C,cAAI,WAAW,QACX,EAAES,UAAS,MAAM,MAAM,YAAY,UAAU,CAAC,MAAM,UAAU;AAChE,sBAAU;AACV,qBAAS;AACT,qBAAS;AACT,0BAAc,cAAc,QAAQ,KAAK,MAAM,CAAC;AAAA,UAClD;AACA,cAAI2B,SAAQ,EAAE3B,UAAS,OAAO,KAAK,WAAW,YAAY,CAAC,CAAC,QAAQ,OAChE,SAAS,WAAW,MAAM;AAE9B,oBAAU,aAAa,SAAS,YAAY;AAC1C,gBAAI,OAAO,OAAO,UAAU;AAC5B,mBAAO,UAAU,IAAI;AACrB,gBAAI,QAAQ;AACV,qBAAO,UAAU,UAAU,IAAI,WAAW;AACxC,oBAAI,WAAW,KAAK;AACpB,oBAAI2B,UAAS,UAAU;AACrB,sBAAI1B,UAAS,OAAO,KAAK,WAAW,GAChC,UAAUA,QAAO,cAAc,UAAU,KAAK,WAAW;AAE7D,0BAAQ,KAAK,EAAE,QAAQ,MAAM,QAAQ,WAAW,WAAW,OAAO,CAAC;AACnE,kBAAAA,QAAO,YAAY;AACnB,yBAAOA;AAAA,gBACT;AACA,uBAAO,KAAK,MAAM,QAAQ,UAAU,CAAC,KAAK,MAAM,CAAC,GAAG,SAAS,CAAC;AAAA,cAChE;AAAA,YACF;AAAA,UACF,CAAC;AAED,iBAAO;AAAA,QACT;AAeA,iBAAS,aAAa;AACpB,cAAI,KAAK,MAAM,MAAM;AACnB,iBAAK,IAAI;AAAA,UACX;AACA,iBAAO;AAAA,QACT;AAcA,iBAAS,OAAO;AAAA,QAEhB;AAsBA,iBAAS,OAAO,GAAG;AACjB,cAAI,UAAU,CAAC;AACf,iBAAO,SAAS,SAAS,MAAM;AAC7B,mBAAO,QAAQ,MAAM,CAAC;AAAA,UACxB,CAAC;AAAA,QACH;AAoBA,YAAI,OAAO,WAAW,QAAQ;AA8B9B,YAAI,YAAY,WAAW,UAAU;AAiCrC,YAAI,WAAW,WAAW,SAAS;AAwBnC,iBAAS,SAAS,MAAM;AACtB,iBAAO,MAAM,IAAI,IAAI,aAAa,MAAM,IAAI,CAAC,IAAI,iBAAiB,IAAI;AAAA,QACxE;AAuBA,iBAAS,WAAW,QAAQ;AAC1B,iBAAO,SAAS,MAAM;AACpB,mBAAO,UAAU,OAAOtB,aAAY,QAAQ,QAAQ,IAAI;AAAA,UAC1D;AAAA,QACF;AA2CA,YAAI,QAAQ,YAAY;AAsCxB,YAAI,aAAa,YAAY,IAAI;AAoBjC,iBAAS,YAAY;AACnB,iBAAO,CAAC;AAAA,QACV;AAeA,iBAAS,YAAY;AACnB,iBAAO;AAAA,QACT;AAoBA,iBAAS,aAAa;AACpB,iBAAO,CAAC;AAAA,QACV;AAeA,iBAAS,aAAa;AACpB,iBAAO;AAAA,QACT;AAeA,iBAAS,WAAW;AAClB,iBAAO;AAAA,QACT;AAqBA,iBAAS,MAAM,GAAGuB,WAAU;AAC1B,cAAI,UAAU,CAAC;AACf,cAAI,IAAI,KAAK,IAAI,kBAAkB;AACjC,mBAAO,CAAC;AAAA,UACV;AACA,cAAI,QAAQ,kBACR,SAAS,UAAU,GAAG,gBAAgB;AAE1C,UAAAA,YAAW,YAAYA,SAAQ;AAC/B,eAAK;AAEL,cAAID,UAAS,UAAU,QAAQC,SAAQ;AACvC,iBAAO,EAAE,QAAQ,GAAG;AAClB,YAAAA,UAAS,KAAK;AAAA,UAChB;AACA,iBAAOD;AAAA,QACT;AAmBA,iBAAS,OAAO,OAAO;AACrB,cAAIF,SAAQ,KAAK,GAAG;AAClB,mBAAO,SAAS,OAAO,KAAK;AAAA,UAC9B;AACA,iBAAO,SAAS,KAAK,IAAI,CAAC,KAAK,IAAI,UAAU,aAAa,SAAS,KAAK,CAAC,CAAC;AAAA,QAC5E;AAmBA,iBAAS,SAAS,QAAQ;AACxB,cAAI,KAAK,EAAE;AACX,iBAAO,SAAS,MAAM,IAAI;AAAA,QAC5B;AAmBA,YAAI,MAAM,oBAAoB,SAAS,QAAQ,QAAQ;AACrD,iBAAO,SAAS;AAAA,QAClB,GAAG,CAAC;AAuBJ,YAAI,OAAO,YAAY,MAAM;AAiB7B,YAAI,SAAS,oBAAoB,SAAS,UAAU,SAAS;AAC3D,iBAAO,WAAW;AAAA,QACpB,GAAG,CAAC;AAuBJ,YAAI,QAAQ,YAAY,OAAO;AAoB/B,iBAAS,IAAI,OAAO;AAClB,iBAAQ,SAAS,MAAM,SACnB,aAAa,OAAO,UAAU,MAAM,IACpCpB;AAAA,QACN;AAyBA,iBAAS,MAAM,OAAOuB,WAAU;AAC9B,iBAAQ,SAAS,MAAM,SACnB,aAAa,OAAO,YAAYA,WAAU,CAAC,GAAG,MAAM,IACpDvB;AAAA,QACN;AAgBA,iBAAS,KAAK,OAAO;AACnB,iBAAO,SAAS,OAAO,QAAQ;AAAA,QACjC;AAyBA,iBAAS,OAAO,OAAOuB,WAAU;AAC/B,iBAAO,SAAS,OAAO,YAAYA,WAAU,CAAC,CAAC;AAAA,QACjD;AAoBA,iBAAS,IAAI,OAAO;AAClB,iBAAQ,SAAS,MAAM,SACnB,aAAa,OAAO,UAAU,MAAM,IACpCvB;AAAA,QACN;AAyBA,iBAAS,MAAM,OAAOuB,WAAU;AAC9B,iBAAQ,SAAS,MAAM,SACnB,aAAa,OAAO,YAAYA,WAAU,CAAC,GAAG,MAAM,IACpDvB;AAAA,QACN;AAiBA,YAAI,WAAW,oBAAoB,SAAS,YAAY,cAAc;AACpE,iBAAO,aAAa;AAAA,QACtB,GAAG,CAAC;AAuBJ,YAAI,QAAQ,YAAY,OAAO;AAiB/B,YAAI,WAAW,oBAAoB,SAAS,SAAS,YAAY;AAC/D,iBAAO,UAAU;AAAA,QACnB,GAAG,CAAC;AAgBJ,iBAAS,IAAI,OAAO;AAClB,iBAAQ,SAAS,MAAM,SACnB,QAAQ,OAAO,QAAQ,IACvB;AAAA,QACN;AAyBA,iBAAS,MAAM,OAAOuB,WAAU;AAC9B,iBAAQ,SAAS,MAAM,SACnB,QAAQ,OAAO,YAAYA,WAAU,CAAC,CAAC,IACvC;AAAA,QACN;AAKA,eAAO,QAAQ;AACf,eAAO,MAAM;AACb,eAAO,SAAS;AAChB,eAAO,WAAW;AAClB,eAAO,eAAe;AACtB,eAAO,aAAa;AACpB,eAAO,KAAKqB;AACZ,eAAO,SAAS;AAChB,eAAO,OAAO;AACd,eAAO,UAAU;AACjB,eAAO,UAAU;AACjB,eAAO,YAAY;AACnB,eAAO,QAAQ;AACf,eAAO,QAAQ;AACf,eAAO,UAAU;AACjB,eAAO,SAAS;AAChB,eAAO,OAAO;AACd,eAAO,WAAW;AAClB,eAAO,WAAW;AAClB,eAAO,UAAU;AACjB,eAAO,SAAS;AAChB,eAAO,QAAQ;AACf,eAAO,aAAa;AACpB,eAAO,WAAW;AAClB,eAAO,WAAW;AAClB,eAAO,eAAe;AACtB,eAAO,QAAQ;AACf,eAAO,QAAQ;AACf,eAAO,aAAa;AACpB,eAAO,eAAe;AACtB,eAAO,iBAAiB;AACxB,eAAO,OAAO;AACd,eAAO,YAAY;AACnB,eAAO,iBAAiB;AACxB,eAAO,YAAY;AACnB,eAAO,OAAO;AACd,eAAO,SAAS;AAChB,eAAO,UAAU;AACjB,eAAO,cAAc;AACrB,eAAO,eAAe;AACtB,eAAO,UAAU;AACjB,eAAO,cAAc;AACrB,eAAO,eAAe;AACtB,eAAO,OAAO;AACd,eAAO,OAAO;AACd,eAAO,YAAY;AACnB,eAAO,YAAY;AACnB,eAAO,YAAY;AACnB,eAAO,cAAc;AACrB,eAAO,UAAU;AACjB,eAAO,UAAU;AACjB,eAAO,eAAe;AACtB,eAAO,iBAAiB;AACxB,eAAO,mBAAmB;AAC1B,eAAO,SAAS;AAChB,eAAO,WAAW;AAClB,eAAO,YAAY;AACnB,eAAO,WAAW;AAClB,eAAO,QAAQ;AACf,eAAO,OAAO;AACd,eAAO,SAAS;AAChB,eAAO,MAAM;AACb,eAAO,UAAU;AACjB,eAAO,YAAY;AACnB,eAAO,UAAU;AACjB,eAAO,kBAAkB;AACzB,eAAO,UAAU;AACjB,eAAO,QAAQE;AACf,eAAO,YAAYD;AACnB,eAAO,SAAS;AAChB,eAAO,WAAW;AAClB,eAAO,QAAQ;AACf,eAAO,SAAS;AAChB,eAAO,SAAS;AAChB,eAAO,OAAO;AACd,eAAO,SAAS;AAChB,eAAO,OAAO;AACd,eAAO,UAAU;AACjB,eAAO,OAAO;AACd,eAAO,WAAW;AAClB,eAAO,YAAY;AACnB,eAAO,WAAW;AAClB,eAAO,UAAU;AACjB,eAAO,eAAe;AACtB,eAAO,YAAY;AACnB,eAAO,OAAO;AACd,eAAO,SAAS;AAChB,eAAO,WAAW;AAClB,eAAO,aAAa;AACpB,eAAO,OAAO;AACd,eAAO,UAAU;AACjB,eAAO,YAAY;AACnB,eAAO,cAAc;AACrB,eAAO,SAAS;AAChB,eAAO,QAAQ;AACf,eAAO,aAAa;AACpB,eAAO,QAAQ;AACf,eAAO,SAAS;AAChB,eAAO,SAAS;AAChB,eAAO,OAAO;AACd,eAAO,UAAU;AACjB,eAAO,aAAa;AACpB,eAAO,MAAM;AACb,eAAO,UAAU;AACjB,eAAO,UAAU;AACjB,eAAO,QAAQ;AACf,eAAO,SAAS;AAChB,eAAO,aAAa;AACpB,eAAO,eAAe;AACtB,eAAO,QAAQ;AACf,eAAO,SAAS;AAChB,eAAO,OAAO;AACd,eAAO,OAAO;AACd,eAAO,YAAY;AACnB,eAAO,iBAAiB;AACxB,eAAO,YAAY;AACnB,eAAO,MAAM;AACb,eAAO,WAAW;AAClB,eAAO,OAAO;AACd,eAAO,UAAU;AACjB,eAAO,UAAU;AACjB,eAAO,YAAY;AACnB,eAAO,SAAS;AAChB,eAAO,gBAAgB;AACvB,eAAO,YAAY;AACnB,eAAO,QAAQ;AACf,eAAO,QAAQ;AACf,eAAO,UAAU;AACjB,eAAO,YAAY;AACnB,eAAO,OAAO;AACd,eAAO,SAAS;AAChB,eAAO,WAAW;AAClB,eAAO,QAAQ;AACf,eAAO,QAAQ;AACf,eAAO,YAAY;AACnB,eAAO,SAAS;AAChB,eAAO,aAAa;AACpB,eAAO,SAAS;AAChB,eAAO,WAAW;AAClB,eAAO,UAAU;AACjB,eAAO,QAAQ;AACf,eAAO,OAAO;AACd,eAAO,MAAM;AACb,eAAO,QAAQ;AACf,eAAO,UAAU;AACjB,eAAO,MAAM;AACb,eAAO,YAAY;AACnB,eAAO,gBAAgB;AACvB,eAAO,UAAU;AAGjB,eAAO,UAAU;AACjB,eAAO,YAAY;AACnB,eAAO,SAAS;AAChB,eAAO,aAAa;AAGpB,cAAM,QAAQ,MAAM;AAKpB,eAAO,MAAM;AACb,eAAO,UAAU;AACjB,eAAO,YAAY;AACnB,eAAO,aAAa;AACpB,eAAO,OAAO;AACd,eAAO,QAAQ;AACf,eAAO,QAAQ;AACf,eAAO,YAAY;AACnB,eAAO,gBAAgB;AACvB,eAAO,YAAY;AACnB,eAAO,aAAa;AACpB,eAAO,SAAS;AAChB,eAAO,YAAY;AACnB,eAAO,SAAS;AAChB,eAAO,WAAW;AAClB,eAAO,KAAK;AACZ,eAAO,SAAS;AAChB,eAAO,eAAe;AACtB,eAAO,QAAQ;AACf,eAAO,OAAO;AACd,eAAO,YAAY;AACnB,eAAO,UAAU;AACjB,eAAO,WAAW;AAClB,eAAO,gBAAgB;AACvB,eAAO,cAAc;AACrB,eAAO,QAAQ;AACf,eAAO,UAAU;AACjB,eAAO,eAAe;AACtB,eAAO,QAAQ;AACf,eAAO,aAAa;AACpB,eAAO,SAAS;AAChB,eAAO,cAAc;AACrB,eAAO,MAAM;AACb,eAAO,KAAK;AACZ,eAAO,MAAM;AACb,eAAO,MAAM;AACb,eAAO,QAAQ;AACf,eAAO,OAAO;AACd,eAAO,WAAW;AAClB,eAAO,WAAW;AAClB,eAAO,UAAU;AACjB,eAAO,UAAU;AACjB,eAAO,SAAS;AAChB,eAAO,cAAc;AACrB,eAAO,UAAUzB;AACjB,eAAO,gBAAgB;AACvB,eAAO,cAAc;AACrB,eAAO,oBAAoB;AAC3B,eAAO,YAAY;AACnB,eAAO,WAAW;AAClB,eAAO,SAAS;AAChB,eAAO,YAAY;AACnB,eAAO,UAAU;AACjB,eAAO,UAAU;AACjB,eAAO,cAAc;AACrB,eAAO,UAAU;AACjB,eAAO,WAAW;AAClB,eAAO,aAAa;AACpB,eAAO,YAAY;AACnB,eAAO,WAAW;AAClB,eAAO,QAAQ;AACf,eAAO,UAAU;AACjB,eAAO,cAAc;AACrB,eAAO,QAAQsB;AACf,eAAO,WAAW;AAClB,eAAO,QAAQ;AACf,eAAO,SAAS;AAChB,eAAO,WAAW;AAClB,eAAO,WAAWrB;AAClB,eAAO,eAAe;AACtB,eAAO,gBAAgB;AACvB,eAAO,WAAW;AAClB,eAAO,gBAAgB;AACvB,eAAO,QAAQ;AACf,eAAO,WAAW;AAClB,eAAO,WAAW;AAClB,eAAO,eAAe;AACtB,eAAO,cAAc;AACrB,eAAO,YAAY;AACnB,eAAO,YAAY;AACnB,eAAO,OAAO;AACd,eAAO,YAAY;AACnB,eAAO,OAAO;AACd,eAAO,cAAc;AACrB,eAAO,YAAY;AACnB,eAAO,aAAa;AACpB,eAAO,KAAKsB;AACZ,eAAO,MAAM;AACb,eAAO,MAAM;AACb,eAAO,QAAQ;AACf,eAAO,OAAO;AACd,eAAO,SAAS;AAChB,eAAO,MAAM;AACb,eAAO,QAAQ;AACf,eAAO,YAAY;AACnB,eAAO,YAAY;AACnB,eAAO,aAAa;AACpB,eAAO,aAAa;AACpB,eAAO,WAAW;AAClB,eAAO,WAAW;AAClB,eAAO,MAAM;AACb,eAAO,aAAa;AACpB,eAAO,OAAO;AACd,eAAO,MAAM;AACb,eAAO,MAAM;AACb,eAAO,SAAS;AAChB,eAAO,WAAW;AAClB,eAAO,WAAWI;AAClB,eAAO,SAAS;AAChB,eAAO,SAAS;AAChB,eAAO,cAAc;AACrB,eAAO,SAAS;AAChB,eAAO,UAAU;AACjB,eAAO,SAAS;AAChB,eAAO,QAAQ;AACf,eAAO,eAAe5C;AACtB,eAAO,SAAS;AAChB,eAAO,OAAO;AACd,eAAO,YAAY;AACnB,eAAO,OAAO;AACd,eAAO,cAAc;AACrB,eAAO,gBAAgB;AACvB,eAAO,gBAAgB;AACvB,eAAO,kBAAkB;AACzB,eAAO,oBAAoB;AAC3B,eAAO,oBAAoB;AAC3B,eAAO,YAAY;AACnB,eAAO,aAAa;AACpB,eAAO,WAAW;AAClB,eAAO,MAAM;AACb,eAAO,QAAQ;AACf,eAAO,WAAW;AAClB,eAAO,QAAQ;AACf,eAAO,WAAW;AAClB,eAAO,YAAY;AACnB,eAAO,WAAW;AAClB,eAAO,UAAU;AACjB,eAAO,WAAW;AAClB,eAAO,gBAAgB;AACvB,eAAO,WAAW;AAClB,eAAO,UAAU;AACjB,eAAO,OAAO;AACd,eAAO,UAAU;AACjB,eAAO,YAAY;AACnB,eAAO,WAAW;AAClB,eAAO,WAAW;AAClB,eAAO,WAAW;AAClB,eAAO,YAAY;AACnB,eAAO,aAAa;AAGpB,eAAO,OAAO;AACd,eAAO,YAAY;AACnB,eAAO,QAAQ;AAEf,cAAM,QAAS,WAAW;AACxB,cAAI,SAAS,CAAC;AACd,qBAAW,QAAQ,SAAS,MAAM,YAAY;AAC5C,gBAAI,CAAC,eAAe,KAAK,OAAO,WAAW,UAAU,GAAG;AACtD,qBAAO,UAAU,IAAI;AAAA,YACvB;AAAA,UACF,CAAC;AACD,iBAAO;AAAA,QACT,EAAE,GAAI,EAAE,SAAS,MAAM,CAAC;AAWxB,eAAO,UAAU;AAGjB,kBAAU,CAAC,QAAQ,WAAW,SAAS,cAAc,WAAW,cAAc,GAAG,SAAS,YAAY;AACpG,iBAAO,UAAU,EAAE,cAAc;AAAA,QACnC,CAAC;AAGD,kBAAU,CAAC,QAAQ,MAAM,GAAG,SAAS,YAAY,OAAO;AACtD,sBAAY,UAAU,UAAU,IAAI,SAAS,GAAG;AAC9C,gBAAI,MAAMH,aAAY,IAAI,UAAU,UAAU,CAAC,GAAG,CAAC;AAEnD,gBAAIsB,UAAU,KAAK,gBAAgB,CAAC,QAChC,IAAI,YAAY,IAAI,IACpB,KAAK,MAAM;AAEf,gBAAIA,QAAO,cAAc;AACvB,cAAAA,QAAO,gBAAgB,UAAU,GAAGA,QAAO,aAAa;AAAA,YAC1D,OAAO;AACL,cAAAA,QAAO,UAAU,KAAK;AAAA,gBACpB,QAAQ,UAAU,GAAG,gBAAgB;AAAA,gBACrC,QAAQ,cAAcA,QAAO,UAAU,IAAI,UAAU;AAAA,cACvD,CAAC;AAAA,YACH;AACA,mBAAOA;AAAA,UACT;AAEA,sBAAY,UAAU,aAAa,OAAO,IAAI,SAAS,GAAG;AACxD,mBAAO,KAAK,QAAQ,EAAE,UAAU,EAAE,CAAC,EAAE,QAAQ;AAAA,UAC/C;AAAA,QACF,CAAC;AAGD,kBAAU,CAAC,UAAU,OAAO,WAAW,GAAG,SAAS,YAAY,OAAO;AACpE,cAAI,OAAO,QAAQ,GACf,WAAW,QAAQ,oBAAoB,QAAQ;AAEnD,sBAAY,UAAU,UAAU,IAAI,SAASC,WAAU;AACrD,gBAAID,UAAS,KAAK,MAAM;AACxB,YAAAA,QAAO,cAAc,KAAK;AAAA,cACxB,YAAY,YAAYC,WAAU,CAAC;AAAA,cACnC,QAAQ;AAAA,YACV,CAAC;AACD,YAAAD,QAAO,eAAeA,QAAO,gBAAgB;AAC7C,mBAAOA;AAAA,UACT;AAAA,QACF,CAAC;AAGD,kBAAU,CAAC,QAAQ,MAAM,GAAG,SAAS,YAAY,OAAO;AACtD,cAAI,WAAW,UAAU,QAAQ,UAAU;AAE3C,sBAAY,UAAU,UAAU,IAAI,WAAW;AAC7C,mBAAO,KAAK,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC;AAAA,UACpC;AAAA,QACF,CAAC;AAGD,kBAAU,CAAC,WAAW,MAAM,GAAG,SAAS,YAAY,OAAO;AACzD,cAAI,WAAW,UAAU,QAAQ,KAAK;AAEtC,sBAAY,UAAU,UAAU,IAAI,WAAW;AAC7C,mBAAO,KAAK,eAAe,IAAI,YAAY,IAAI,IAAI,KAAK,QAAQ,EAAE,CAAC;AAAA,UACrE;AAAA,QACF,CAAC;AAED,oBAAY,UAAU,UAAU,WAAW;AACzC,iBAAO,KAAK,OAAO,QAAQ;AAAA,QAC7B;AAEA,oBAAY,UAAU,OAAO,SAAS,WAAW;AAC/C,iBAAO,KAAK,OAAO,SAAS,EAAE,KAAK;AAAA,QACrC;AAEA,oBAAY,UAAU,WAAW,SAAS,WAAW;AACnD,iBAAO,KAAK,QAAQ,EAAE,KAAK,SAAS;AAAA,QACtC;AAEA,oBAAY,UAAU,YAAY,SAAS,SAAS,MAAM,MAAM;AAC9D,cAAI,OAAO,QAAQ,YAAY;AAC7B,mBAAO,IAAI,YAAY,IAAI;AAAA,UAC7B;AACA,iBAAO,KAAK,IAAI,SAAS,OAAO;AAC9B,mBAAO,WAAW,OAAO,MAAM,IAAI;AAAA,UACrC,CAAC;AAAA,QACH,CAAC;AAED,oBAAY,UAAU,SAAS,SAAS,WAAW;AACjD,iBAAO,KAAK,OAAO,OAAO,YAAY,SAAS,CAAC,CAAC;AAAA,QACnD;AAEA,oBAAY,UAAU,QAAQ,SAAS,OAAO,KAAK;AACjD,kBAAQ,UAAU,KAAK;AAEvB,cAAIA,UAAS;AACb,cAAIA,QAAO,iBAAiB,QAAQ,KAAK,MAAM,IAAI;AACjD,mBAAO,IAAI,YAAYA,OAAM;AAAA,UAC/B;AACA,cAAI,QAAQ,GAAG;AACb,YAAAA,UAASA,QAAO,UAAU,CAAC,KAAK;AAAA,UAClC,WAAW,OAAO;AAChB,YAAAA,UAASA,QAAO,KAAK,KAAK;AAAA,UAC5B;AACA,cAAI,QAAQtB,YAAW;AACrB,kBAAM,UAAU,GAAG;AACnB,YAAAsB,UAAS,MAAM,IAAIA,QAAO,UAAU,CAAC,GAAG,IAAIA,QAAO,KAAK,MAAM,KAAK;AAAA,UACrE;AACA,iBAAOA;AAAA,QACT;AAEA,oBAAY,UAAU,iBAAiB,SAAS,WAAW;AACzD,iBAAO,KAAK,QAAQ,EAAE,UAAU,SAAS,EAAE,QAAQ;AAAA,QACrD;AAEA,oBAAY,UAAU,UAAU,WAAW;AACzC,iBAAO,KAAK,KAAK,gBAAgB;AAAA,QACnC;AAGA,mBAAW,YAAY,WAAW,SAAS,MAAM,YAAY;AAC3D,cAAI,gBAAgB,qCAAqC,KAAK,UAAU,GACpE,UAAU,kBAAkB,KAAK,UAAU,GAC3C,aAAa,OAAO,UAAW,UAAU,cAAc,SAAS,UAAU,MAAO,UAAU,GAC3F,eAAe,WAAW,QAAQ,KAAK,UAAU;AAErD,cAAI,CAAC,YAAY;AACf;AAAA,UACF;AACA,iBAAO,UAAU,UAAU,IAAI,WAAW;AACxC,gBAAI,QAAQ,KAAK,aACb,OAAO,UAAU,CAAC,CAAC,IAAI,WACvB,SAAS,iBAAiB,aAC1BC,YAAW,KAAK,CAAC,GACjB,UAAU,UAAUH,SAAQ,KAAK;AAErC,gBAAI,cAAc,SAAS6B,QAAO;AAChC,kBAAI3B,UAAS,WAAW,MAAM,QAAQ,UAAU,CAAC2B,MAAK,GAAG,IAAI,CAAC;AAC9D,qBAAQ,WAAW,WAAY3B,QAAO,CAAC,IAAIA;AAAA,YAC7C;AAEA,gBAAI,WAAW,iBAAiB,OAAOC,aAAY,cAAcA,UAAS,UAAU,GAAG;AAErF,uBAAS,UAAU;AAAA,YACrB;AACA,gBAAI,WAAW,KAAK,WAChB,WAAW,CAAC,CAAC,KAAK,YAAY,QAC9B,cAAc,gBAAgB,CAAC,UAC/B,WAAW,UAAU,CAAC;AAE1B,gBAAI,CAAC,gBAAgB,SAAS;AAC5B,sBAAQ,WAAW,QAAQ,IAAI,YAAY,IAAI;AAC/C,kBAAID,UAAS,KAAK,MAAM,OAAO,IAAI;AACnC,cAAAA,QAAO,YAAY,KAAK,EAAE,QAAQ,MAAM,QAAQ,CAAC,WAAW,GAAG,WAAWtB,WAAU,CAAC;AACrF,qBAAO,IAAI,cAAcsB,SAAQ,QAAQ;AAAA,YAC3C;AACA,gBAAI,eAAe,UAAU;AAC3B,qBAAO,KAAK,MAAM,MAAM,IAAI;AAAA,YAC9B;AACA,YAAAA,UAAS,KAAK,KAAK,WAAW;AAC9B,mBAAO,cAAe,UAAUA,QAAO,MAAM,EAAE,CAAC,IAAIA,QAAO,MAAM,IAAKA;AAAA,UACxE;AAAA,QACF,CAAC;AAGD,kBAAU,CAAC,OAAO,QAAQ,SAAS,QAAQ,UAAU,SAAS,GAAG,SAAS,YAAY;AACpF,cAAI,OAAO,WAAW,UAAU,GAC5B,YAAY,0BAA0B,KAAK,UAAU,IAAI,QAAQ,QACjE,eAAe,kBAAkB,KAAK,UAAU;AAEpD,iBAAO,UAAU,UAAU,IAAI,WAAW;AACxC,gBAAI,OAAO;AACX,gBAAI,gBAAgB,CAAC,KAAK,WAAW;AACnC,kBAAI,QAAQ,KAAK,MAAM;AACvB,qBAAO,KAAK,MAAMF,SAAQ,KAAK,IAAI,QAAQ,CAAC,GAAG,IAAI;AAAA,YACrD;AACA,mBAAO,KAAK,SAAS,EAAE,SAAS6B,QAAO;AACrC,qBAAO,KAAK,MAAM7B,SAAQ6B,MAAK,IAAIA,SAAQ,CAAC,GAAG,IAAI;AAAA,YACrD,CAAC;AAAA,UACH;AAAA,QACF,CAAC;AAGD,mBAAW,YAAY,WAAW,SAAS,MAAM,YAAY;AAC3D,cAAI,aAAa,OAAO,UAAU;AAClC,cAAI,YAAY;AACd,gBAAI,MAAM,WAAW,OAAO;AAC5B,gBAAI,CAAC,eAAe,KAAK,WAAW,GAAG,GAAG;AACxC,wBAAU,GAAG,IAAI,CAAC;AAAA,YACpB;AACA,sBAAU,GAAG,EAAE,KAAK,EAAE,QAAQ,YAAY,QAAQ,WAAW,CAAC;AAAA,UAChE;AAAA,QACF,CAAC;AAED,kBAAU,aAAajD,YAAW,kBAAkB,EAAE,IAAI,IAAI,CAAC;AAAA,UAC7D,QAAQ;AAAA,UACR,QAAQA;AAAA,QACV,CAAC;AAGD,oBAAY,UAAU,QAAQ;AAC9B,oBAAY,UAAU,UAAU;AAChC,oBAAY,UAAU,QAAQ;AAG9B,eAAO,UAAU,KAAK;AACtB,eAAO,UAAU,QAAQ;AACzB,eAAO,UAAU,SAAS;AAC1B,eAAO,UAAU,OAAO;AACxB,eAAO,UAAU,QAAQ;AACzB,eAAO,UAAU,UAAU;AAC3B,eAAO,UAAU,SAAS,OAAO,UAAU,UAAU,OAAO,UAAU,QAAQ;AAG9E,eAAO,UAAU,QAAQ,OAAO,UAAU;AAE1C,YAAI,aAAa;AACf,iBAAO,UAAU,WAAW,IAAI;AAAA,QAClC;AACA,eAAO;AAAA,MACT;AAKA,UAAI,IAAI,aAAa;AAGrB,UAAI,OAAO,UAAU,cAAc,OAAO,OAAO,OAAO,YAAY,OAAO,KAAK;AAK9E,aAAK,IAAI;AAIT,eAAO,WAAW;AAChB,iBAAO;AAAA,QACT,CAAC;AAAA,MACH,WAES,YAAY;AAEnB,SAAC,WAAW,UAAU,GAAG,IAAI;AAE7B,oBAAY,IAAI;AAAA,MAClB,OACK;AAEH,aAAK,IAAI;AAAA,MACX;AAAA,IACF,GAAE,KAAK,OAAI;AAAA;AAAA;;;ACxzhBX;AAAA;AAAA;AAUA,KAAC,SAAUkD,SAAQC,YAAW;AAE1B;AAOA,UAAI,aAAc,UACd,QAAc,IACd,UAAc,KACd,YAAc,YACd,aAAc,aACd,WAAc,UACd,WAAc,UACd,QAAc,SACd,QAAc,SACd,OAAc,QACd,OAAc,QACd,SAAc,UACd,UAAc,WACd,eAAc,gBACd,UAAc,WACd,SAAc,UACd,SAAc,UACd,UAAc,WACd,WAAc,YACd,WAAc,YACd,gBAAgB;AAEpB,UAAI,SAAU,UACV,QAAU,SACV,OAAU,QACV,aAAa,cACb,UAAU,WACV,SAAU,UACV,OAAU,QACV,UAAU,WACV,SAAU,UACV,SAAU,UACV,KAAU,MACV,YAAY,aACZ,WAAY,YACZ,QAAU,SACV,UAAU,WACV,QAAU,SACV,OAAU,QACV,QAAU,SACV,SAAU,UACV,QAAU,SACV,WAAc,YACd,cAAc,eACd,SAAU;AAMd,UAAI,SAAS,SAAUC,UAAS,YAAY;AACpC,YAAI,gBAAgB,CAAC;AACrB,iBAAS,KAAKA,UAAS;AACnB,cAAI,WAAW,CAAC,KAAK,WAAW,CAAC,EAAE,SAAS,MAAM,GAAG;AACjD,0BAAc,CAAC,IAAI,WAAW,CAAC,EAAE,OAAOA,SAAQ,CAAC,CAAC;AAAA,UACtD,OAAO;AACH,0BAAc,CAAC,IAAIA,SAAQ,CAAC;AAAA,UAChC;AAAA,QACJ;AACA,eAAO;AAAA,MACX,GACA,YAAY,SAAU,KAAK;AACvB,YAAI,QAAQ,CAAC;AACb,iBAAS,IAAE,GAAG,IAAE,IAAI,QAAQ,KAAK;AAC7B,gBAAM,IAAI,CAAC,EAAE,YAAY,CAAC,IAAI,IAAI,CAAC;AAAA,QACvC;AACA,eAAO;AAAA,MACX,GACA,MAAM,SAAU,MAAM,MAAM;AACxB,eAAO,OAAO,SAAS,WAAW,SAAS,IAAI,EAAE,QAAQ,SAAS,IAAI,CAAC,MAAM,KAAK;AAAA,MACtF,GACA,WAAW,SAAU,KAAK;AACtB,eAAO,IAAI,YAAY;AAAA,MAC3B,GACA,WAAW,SAAU,SAAS;AAC1B,eAAO,OAAO,YAAa,WAAW,QAAQ,QAAQ,YAAY,KAAK,EAAE,MAAM,GAAG,EAAE,CAAC,IAAID;AAAA,MAC7F,GACA,OAAO,SAAU,KAAK,KAAK;AACvB,YAAI,OAAO,QAAS,UAAU;AAC1B,gBAAM,IAAI,QAAQ,UAAU,KAAK;AACjC,iBAAO,OAAO,QAAS,aAAa,MAAM,IAAI,UAAU,GAAG,aAAa;AAAA,QAC5E;AAAA,MACR;AAMA,UAAI,YAAY,SAAUE,KAAI,QAAQ;AAE9B,YAAI,IAAI,GAAGC,IAAG,GAAG,GAAG,GAAG,SAASC;AAGhC,eAAO,IAAI,OAAO,UAAU,CAAC,SAAS;AAElC,cAAI,QAAQ,OAAO,CAAC,GAChB,QAAQ,OAAO,IAAI,CAAC;AACxB,UAAAD,KAAI,IAAI;AAGR,iBAAOA,KAAI,MAAM,UAAU,CAAC,SAAS;AAEjC,gBAAI,CAAC,MAAMA,EAAC,GAAG;AAAE;AAAA,YAAO;AACxB,sBAAU,MAAMA,IAAG,EAAE,KAAKD,GAAE;AAE5B,gBAAI,CAAC,CAAC,SAAS;AACX,mBAAK,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AAC/B,gBAAAE,UAAQ,QAAQ,EAAE,CAAC;AACnB,oBAAI,MAAM,CAAC;AAEX,oBAAI,OAAO,MAAM,YAAY,EAAE,SAAS,GAAG;AACvC,sBAAI,EAAE,WAAW,GAAG;AAChB,wBAAI,OAAO,EAAE,CAAC,KAAK,WAAW;AAE1B,2BAAK,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC,EAAE,KAAK,MAAMA,OAAK;AAAA,oBACtC,OAAO;AAEH,2BAAK,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;AAAA,oBACpB;AAAA,kBACJ,WAAW,EAAE,WAAW,GAAG;AAEvB,wBAAI,OAAO,EAAE,CAAC,MAAM,aAAa,EAAE,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,OAAO;AAExD,2BAAK,EAAE,CAAC,CAAC,IAAIA,UAAQ,EAAE,CAAC,EAAE,KAAK,MAAMA,SAAO,EAAE,CAAC,CAAC,IAAIJ;AAAA,oBACxD,OAAO;AAEH,2BAAK,EAAE,CAAC,CAAC,IAAII,UAAQA,QAAM,QAAQ,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,IAAIJ;AAAA,oBACrD;AAAA,kBACJ,WAAW,EAAE,WAAW,GAAG;AACnB,yBAAK,EAAE,CAAC,CAAC,IAAII,UAAQ,EAAE,CAAC,EAAE,KAAK,MAAMA,QAAM,QAAQ,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,IAAIJ;AAAA,kBAC1E;AAAA,gBACJ,OAAO;AACH,uBAAK,CAAC,IAAII,UAAQA,UAAQJ;AAAA,gBAC9B;AAAA,cACJ;AAAA,YACJ;AAAA,UACJ;AACA,eAAK;AAAA,QACT;AAAA,MACJ,GAEA,YAAY,SAAU,KAAK,KAAK;AAE5B,iBAAS,KAAK,KAAK;AAEf,cAAI,OAAO,IAAI,CAAC,MAAM,YAAY,IAAI,CAAC,EAAE,SAAS,GAAG;AACjD,qBAASG,KAAI,GAAGA,KAAI,IAAI,CAAC,EAAE,QAAQA,MAAK;AACpC,kBAAI,IAAI,IAAI,CAAC,EAAEA,EAAC,GAAG,GAAG,GAAG;AACrB,uBAAQ,MAAM,UAAWH,aAAY;AAAA,cACzC;AAAA,YACJ;AAAA,UACJ,WAAW,IAAI,IAAI,CAAC,GAAG,GAAG,GAAG;AACzB,mBAAQ,MAAM,UAAWA,aAAY;AAAA,UACzC;AAAA,QACJ;AACA,eAAO;AAAA,MACf;AAOA,UAAI,eAAe;AAAA,QACX,OAAU;AAAA,QACV,OAAU;AAAA,QACV,OAAU;AAAA,QACV,OAAU;AAAA,QACV,SAAU;AAAA,QACV,SAAU;AAAA,QACV,SAAU;AAAA,QACV,KAAU;AAAA,MACd,GACA,oBAAoB;AAAA,QAChB,MAAc;AAAA,QACd,WAAc;AAAA,QACd,UAAc;AAAA,QACd,QAAc;AAAA,QACd,MAAc,CAAC,UAAU,QAAQ;AAAA,QACjC,SAAc;AAAA,QACd,KAAc;AAAA,QACd,KAAc;AAAA,QACd,OAAc;AAAA,QACd,MAAc,CAAC,UAAU,SAAS;AAAA,QAClC,MAAc;AAAA,MACtB;AAMA,UAAI,UAAU;AAAA,QAEV,SAAU;AAAA,UAAC;AAAA,YAEP;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,QAAQ,CAAC;AAAA,UAAG;AAAA,YAChC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG9B;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,UAAG;AAAA,YACpB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,QAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YACrC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,KAAK,CAAC;AAAA,UAAG;AAAA;AAAA,YAG7B;AAAA;AAAA,YACA;AAAA;AAAA;AAAA,YAEA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA;AAAA,YAGA;AAAA;AAAA,YAEA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,UAAG;AAAA,YACpB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,OAAK,OAAO,CAAC;AAAA,UAAG;AAAA,YACpC;AAAA;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,qBAAqB,CAAC;AAAA,UAAG;AAAA,YAC7C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,QAAQ,CAAC;AAAA,UAAG;AAAA,YAChC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,WAAW,CAAC;AAAA,UAAG;AAAA,YACnC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC;AAAA,UAAG;AAAA,YAC5B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,QAAQ,CAAC;AAAA,UAAG;AAAA,YAChC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,QAAQ,eAAa,OAAO,GAAG,OAAO;AAAA,UAAG;AAAA,YACpD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,UAAQ,QAAQ,CAAC;AAAA,UAAG;AAAA,YACxC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,QAAM,QAAQ,CAAC;AAAA,UAAG;AAAA,YACtC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,SAAS,CAAC;AAAA,UAAG;AAAA,YACjC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,SAAS,CAAC;AAAA,UAAG;AAAA,YACjC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,QAAM,QAAQ,CAAC;AAAA,UAAG;AAAA,YACtC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,UAAQ,OAAO,CAAC;AAAA,UAAG;AAAA,YACvC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YAC/B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,SAAO,OAAO,CAAC;AAAA,UAAG;AAAA,YAC7B;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,QAAQ,QAAM,OAAO,GAAG,OAAO;AAAA,UAAG;AAAA;AAAA,YAC7C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,MAAM,GAAG,GAAG,OAAO;AAAA,UAAG;AAAA,YACjC;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,UAAG;AAAA,YACpB;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,IAAI;AAAA,UAAG;AAAA;AAAA,YAGX;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,QAAQ,GAAG,OAAO;AAAA,UAAG;AAAA,YAChC;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,UAAG;AAAA,YACpB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,KAAK,CAAC;AAAA,UAAG;AAAA,YAC7B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,QAAQ,CAAC;AAAA,UAAG;AAAA,YAEhC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,SAAO,WAAW,CAAC;AAAA,UAAG;AAAA,YAE1C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,SAAO,UAAU,GAAG,OAAO;AAAA,UAAG;AAAA,YAEzC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,aAAW,OAAO,CAAC;AAAA,UAAG;AAAA,YAE1C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,UAAG;AAAA,YAEpB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,eAAe,CAAC;AAAA,UAAG;AAAA,YACvC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,IAAI;AAAA,UAAG;AAAA,YACpB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,CAAC,SAAS,WAAW,YAAY,CAAC;AAAA,UAAG;AAAA,YAE/C;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,UAAG;AAAA;AAAA,YAGpB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,UAAU,GAAG,OAAO;AAAA,UAAG;AAAA,YAClC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,UAAQ,UAAU,CAAC;AAAA,UAAG;AAAA,YAC1C;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YAEA;AAAA;AAAA,YAEA;AAAA;AAAA,YACA;AAAA;AAAA;AAAA,YAGA;AAAA;AAAA,YAEA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,UAAG;AAAA,YAEpB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,CAAC,SAAS,gBAAgB,EAAE,CAAC;AAAA,QAC3C;AAAA,QAEA,KAAM;AAAA,UAAC;AAAA,YAEH;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,cAAc,OAAO,CAAC;AAAA,UAAG;AAAA,YAE9B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,cAAc,QAAQ,CAAC;AAAA,UAAG;AAAA,YAE/B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,cAAc,MAAM,CAAC;AAAA,UAAG;AAAA,YAE7B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,cAAc,OAAO,CAAC;AAAA,UAAG;AAAA,YAE9B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,cAAc,OAAO,CAAC;AAAA,UAAG;AAAA;AAAA,YAG9B;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,cAAc,KAAK,CAAC;AAAA,UAAG;AAAA,YAE5B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,cAAc,QAAQ,OAAO,QAAQ,CAAC;AAAA,UAAG;AAAA,YAE9C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,cAAc,OAAO,CAAC;AAAA,UAAG;AAAA,YAE9B;AAAA;AAAA,UAEA;AAAA,UAAG,CAAC,CAAC,cAAc,QAAQ,CAAC;AAAA,QAChC;AAAA,QAEA,QAAS;AAAA,UAAC;AAAA;AAAA;AAAA;AAAA;AAAA,YAON;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,OAAO,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC/C;AAAA,YACA;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,OAAO,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG/C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC7C;AAAA;AAAA,YACA;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC7C;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,CAAC;AAAA,UAAG;AAAA;AAAA,YAG7B;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG7C;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC9C;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG9C;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,OAAO,MAAM,GAAG,GAAG,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC3D;AAAA;AAAA,UACA;AAAA,UAAE,CAAC,CAAC,OAAO,MAAM,GAAG,GAAG,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG1D;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG9C;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG9C;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,QAAQ,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAGhD;AAAA,YACA;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,QAAQ,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAChD;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,QAAQ,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAGhD;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC1C;AAAA,YACA;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG1C;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,QAAQ,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAGhD;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,OAAO,MAAM,GAAG,GAAG,CAAC,QAAQ,OAAO,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG5D;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC9C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG9C;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,IAAI,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC5C;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,OAAO,eAAe,GAAG,CAAC,QAAQ,IAAI,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG/D;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,SAAS,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAGjD;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC9C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,OAAO,SAAS,eAAe,GAAG,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG1E;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,QAAQ,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACpC;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,UAAU,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAGlD;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,IAAI,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC5C;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,IAAI,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG5C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC7C;AAAA;AAAA;AAAA,YAGA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,QAAQ,CAAC,OAAO,MAAM,GAAG,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAGjD;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG9C;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,OAAO,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA,YAG/C;AAAA;AAAA,YAEA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,QAAQ,OAAO,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAEpC;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,QAAQ,OAAO,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAEpC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,SAAS,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACjD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,WAAW,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACnD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC9C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,SAAS,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACjD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC7C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC9C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,SAAS,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACjD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,gBAAgB,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACxD;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,UAAU,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAClD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC7C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC7C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,OAAO,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC/C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,OAAO,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC/C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC9C;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,QAAQ,cAAc,GAAG,OAAO,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACtD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,UAAU,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAClD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,UAAU,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAClD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,QAAQ,OAAO,GAAG,OAAO,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC/C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,QAAQ,OAAO,GAAG,OAAO,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC/C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,WAAW,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACnD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,SAAS,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACjD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,WAAW,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACnD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,OAAO,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC/C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,QAAQ,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAChD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,QAAQ,OAAO,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACpC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,OAAO,OAAO,GAAG,GAAG,CAAC,QAAQ,SAAS,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC/D;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC7C;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA;AAAA;AAAA;AAAA,YAM7C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,QAAQ,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YAC9B;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,OAAO,KAAK,SAAS,GAAG,CAAC,QAAQ,OAAO,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YAClE;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,QAAQ,EAAE,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YACpC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,QAAQ,CAAC,OAAO,QAAM,KAAK,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YACpD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,OAAO,SAAO,MAAM,GAAG,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YAChE;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YAC/C;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAE;AAAA,YAC7C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,IAAI,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YAC7C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YAC/C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,QAAQ,OAAO,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YACrC;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,QAAQ,IAAI,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YACrD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA;AAAA;AAAA;AAAA,YAMtB;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,QAAQ,OAAO,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YACrC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,QAAQ,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YACjD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,IAAI,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YAC7C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,SAAS,GAAG,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA;AAAA;AAAA;AAAA,YAMlD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,QAAQ,OAAO,CAAC,MAAM,QAAQ,CAAC;AAAA,UAAG;AAAA,YACtC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,QAAQ,CAAC;AAAA,UAAG;AAAA,YAC/C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,QAAQ,CAAC;AAAA,UAAG;AAAA,YAChD;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,KAAK,GAAG,CAAC,MAAM,QAAQ,CAAC;AAAA,UAAG;AAAA,YAC/C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,QAAQ,GAAG,CAAC,MAAM,QAAQ,CAAC;AAAA,UAAG;AAAA;AAAA;AAAA;AAAA,YAMlD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,QAAQ,CAAC,MAAM,QAAQ,CAAC;AAAA,UAAG;AAAA,YAC/B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,MAAM,GAAG,CAAC,MAAM,QAAQ,CAAC;AAAA,UAAG;AAAA;AAAA;AAAA;AAAA,YAMhD;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC5B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YAC5B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACrB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,MAAM,CAAC;AAAA,UAAG;AAAA,YACrB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,OAAO,CAAC,QAAQ,SAAS,CAAC;AAAA,QAClC;AAAA,QAEA,QAAS;AAAA,UAAC;AAAA,YAEN;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,OAAK,MAAM,CAAC;AAAA,UAAG;AAAA,YAEnC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YAE/B;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,UAAG;AAAA,YAEpB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,IAAI;AAAA,QACrB;AAAA,QAEA,IAAK;AAAA,UAAC;AAAA;AAAA,YAGF;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,UAAG;AAAA,YACpB;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,CAAC,SAAS,WAAW,iBAAiB,CAAC;AAAA,UAAG;AAAA,YACpD;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,SAAS,GAAG,CAAC,SAAS,WAAW,iBAAiB,CAAC;AAAA,UAAG;AAAA;AAAA,YAGjE;AAAA;AAAA,YACA;AAAA,YACA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,SAAS,MAAM,GAAG,GAAG,CAAC,MAAM,KAAK,CAAC;AAAA,UAAG;AAAA,YAC1C;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,MAAM,GAAG,CAAC,SAAS,MAAM,GAAG,CAAC;AAAA,UAAG;AAAA;AAAA,YAG3C;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,IAAI;AAAA,UAAG;AAAA;AAAA,YACpB;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,UAAG;AAAA,YACpB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,UAAU,CAAC;AAAA,UAAG;AAAA,YAClC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,SAAS,CAAC;AAAA,UAAG;AAAA,YACjC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,UAAQ,KAAK,CAAC;AAAA,UAAG;AAAA,YACrC;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,OAAO,CAAC;AAAA,UAAG;AAAA,YAC/B;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,SAAS,CAAC;AAAA,UAAG;AAAA;AAAA,YAGjC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,SAAS,CAAC,MAAM,SAAO,MAAM,CAAC;AAAA,UAAG;AAAA,YACrC;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,WAAW,GAAG,OAAO;AAAA,UAAE;AAAA;AAAA,YAGlC;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA;AAAA,YAGA;AAAA;AAAA,YACA;AAAA;AAAA;AAAA,YAGA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YAEA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,UAAG;AAAA,YACpB;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,CAAC,MAAM,SAAS,GAAG,OAAO;AAAA,UAAG;AAAA,YACjC;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACA;AAAA,UAAG,CAAC,MAAM,OAAO;AAAA,QACrB;AAAA,MACJ;AAMA,UAAI,WAAW,SAAUE,KAAI,YAAY;AAErC,YAAI,OAAOA,QAAO,UAAU;AACxB,uBAAaA;AACb,UAAAA,MAAKF;AAAA,QACT;AAEA,YAAI,EAAE,gBAAgB,WAAW;AAC7B,iBAAO,IAAI,SAASE,KAAI,UAAU,EAAE,UAAU;AAAA,QAClD;AAEA,YAAI,aAAc,OAAOH,YAAW,cAAcA,QAAO,YAAaA,QAAO,YAAYC;AACzF,YAAI,MAAME,QAAQ,cAAc,WAAW,YAAa,WAAW,YAAY;AAC/E,YAAI,QAAS,cAAc,WAAW,gBAAiB,WAAW,gBAAgBF;AAClF,YAAI,UAAU,aAAa,OAAO,SAAS,UAAU,IAAI;AACzD,YAAI,aAAa,cAAc,WAAW,aAAa;AAEvD,aAAK,aAAa,WAAY;AAC1B,cAAI,WAAW,CAAC;AAChB,mBAAS,IAAI,IAAIA;AACjB,mBAAS,OAAO,IAAIA;AACpB,oBAAU,KAAK,UAAU,KAAK,QAAQ,OAAO;AAC7C,mBAAS,KAAK,IAAI,SAAS,SAAS,OAAO,CAAC;AAE5C,cAAI,cAAc,cAAc,WAAW,SAAS,OAAO,WAAW,MAAM,WAAW,WAAW;AAC9F,qBAAS,IAAI,IAAI;AAAA,UACrB;AACA,iBAAO;AAAA,QACX;AACA,aAAK,SAAS,WAAY;AACtB,cAAI,OAAO,CAAC;AACZ,eAAK,YAAY,IAAIA;AACrB,oBAAU,KAAK,MAAM,KAAK,QAAQ,GAAG;AACrC,iBAAO;AAAA,QACX;AACA,aAAK,YAAY,WAAY;AACzB,cAAI,UAAU,CAAC;AACf,kBAAQ,MAAM,IAAIA;AAClB,kBAAQ,KAAK,IAAIA;AACjB,kBAAQ,IAAI,IAAIA;AAChB,oBAAU,KAAK,SAAS,KAAK,QAAQ,MAAM;AAC3C,cAAI,cAAc,CAAC,QAAQ,IAAI,KAAK,SAAS,MAAM,QAAQ;AACvD,oBAAQ,IAAI,IAAI;AAAA,UACpB;AAEA,cAAI,cAAc,QAAQ,KAAK,KAAK,eAAe,cAAc,OAAO,WAAW,eAAe,cAAc,WAAW,kBAAkB,WAAW,iBAAiB,GAAG;AACxK,oBAAQ,KAAK,IAAI;AACjB,oBAAQ,IAAI,IAAI;AAAA,UACpB;AACA,iBAAO;AAAA,QACX;AACA,aAAK,YAAY,WAAY;AACzB,cAAI,UAAU,CAAC;AACf,kBAAQ,IAAI,IAAIA;AAChB,kBAAQ,OAAO,IAAIA;AACnB,oBAAU,KAAK,SAAS,KAAK,QAAQ,MAAM;AAC3C,iBAAO;AAAA,QACX;AACA,aAAK,QAAQ,WAAY;AACrB,cAAI,MAAM,CAAC;AACX,cAAI,IAAI,IAAIA;AACZ,cAAI,OAAO,IAAIA;AACf,oBAAU,KAAK,KAAK,KAAK,QAAQ,EAAE;AACnC,cAAI,cAAc,CAAC,IAAI,IAAI,KAAK,SAAS,MAAM,YAAY,WAAW;AAClE,gBAAI,IAAI,IAAI,MAAM,SACG,QAAQ,cAAc,WAAW,EACjC,QAAQ,UAAU,MAAM;AAAA,UACjD;AACA,iBAAO;AAAA,QACX;AACA,aAAK,YAAY,WAAY;AACzB,iBAAO;AAAA,YACH,IAAU,KAAK,MAAM;AAAA,YACrB,SAAU,KAAK,WAAW;AAAA,YAC1B,QAAU,KAAK,UAAU;AAAA,YACzB,IAAU,KAAK,MAAM;AAAA,YACrB,QAAU,KAAK,UAAU;AAAA,YACzB,KAAU,KAAK,OAAO;AAAA,UAC1B;AAAA,QACJ;AACA,aAAK,QAAQ,WAAY;AACrB,iBAAO;AAAA,QACX;AACA,aAAK,QAAQ,SAAUE,KAAI;AACvB,gBAAO,OAAOA,QAAO,YAAYA,IAAG,SAAS,gBAAiB,KAAKA,KAAI,aAAa,IAAIA;AACxF,iBAAO;AAAA,QACX;AACA,aAAK,MAAM,GAAG;AACd,eAAO;AAAA,MACX;AAEA,eAAS,UAAU;AACnB,eAAS,UAAW,UAAU,CAAC,MAAM,SAAS,KAAK,CAAC;AACpD,eAAS,MAAM,UAAU,CAAC,YAAY,CAAC;AACvC,eAAS,SAAS,UAAU,CAAC,OAAO,QAAQ,MAAM,SAAS,QAAQ,SAAS,QAAQ,UAAU,QAAQ,CAAC;AACvG,eAAS,SAAS,SAAS,KAAK,UAAU,CAAC,MAAM,OAAO,CAAC;AAOzD,UAAI,OAAO,YAAa,YAAY;AAEhC,YAAI,OAAO,WAAW,cAAc,OAAO,SAAS;AAChD,oBAAU,OAAO,UAAU;AAAA,QAC/B;AACA,gBAAQ,WAAW;AAAA,MACvB,OAAO;AAEH,YAAI,OAAO,WAAY,aAAa,OAAO,KAAK;AAC5C,iBAAO,WAAY;AACf,mBAAO;AAAA,UACX,CAAC;AAAA,QACL,WAAW,OAAOH,YAAW,YAAY;AAErC,UAAAA,QAAO,WAAW;AAAA,QACtB;AAAA,MACJ;AAOA,UAAI,IAAI,OAAOA,YAAW,eAAeA,QAAO,UAAUA,QAAO;AACjE,UAAI,KAAK,CAAC,EAAE,IAAI;AACZ,YAAI,SAAS,IAAI,SAAS;AAC1B,UAAE,KAAK,OAAO,UAAU;AACxB,UAAE,GAAG,MAAM,WAAY;AACnB,iBAAO,OAAO,MAAM;AAAA,QACxB;AACA,UAAE,GAAG,MAAM,SAAUG,KAAI;AACrB,iBAAO,MAAMA,GAAE;AACf,cAAI,SAAS,OAAO,UAAU;AAC9B,mBAAS,QAAQ,QAAQ;AACrB,cAAE,GAAG,IAAI,IAAI,OAAO,IAAI;AAAA,UAC5B;AAAA,QACJ;AAAA,MACJ;AAAA,IAEJ,GAAG,OAAO,WAAW,WAAW,SAAS,OAAI;AAAA;AAAA;;;ACn6B7C,IAAAG,kBAAA;AAAA;AAAA;AAUA,QAAI,mBAAmB;AAGvB,QAAI,iBAAiB;AAGrB,QAAI,uBAAuB;AAA3B,QACI,yBAAyB;AAG7B,QAAI,mBAAmB;AAGvB,QAAI,UAAU;AAAd,QACI,WAAW;AADf,QAEI,WAAW;AAFf,QAGI,UAAU;AAHd,QAII,UAAU;AAJd,QAKI,WAAW;AALf,QAMI,UAAU;AANd,QAOI,SAAS;AAPb,QAQI,SAAS;AARb,QASI,YAAY;AAThB,QAUI,UAAU;AAVd,QAWI,YAAY;AAXhB,QAYI,aAAa;AAZjB,QAaI,WAAW;AAbf,QAcI,YAAY;AAdhB,QAeI,SAAS;AAfb,QAgBI,YAAY;AAhBhB,QAiBI,YAAY;AAjBhB,QAkBI,eAAe;AAlBnB,QAmBI,aAAa;AAEjB,QAAI,iBAAiB;AAArB,QACI,cAAc;AADlB,QAEI,aAAa;AAFjB,QAGI,aAAa;AAHjB,QAII,UAAU;AAJd,QAKI,WAAW;AALf,QAMI,WAAW;AANf,QAOI,WAAW;AAPf,QAQI,kBAAkB;AARtB,QASI,YAAY;AAThB,QAUI,YAAY;AAMhB,QAAI,eAAe;AAGnB,QAAI,eAAe;AAGnB,QAAI,WAAW;AAGf,QAAI,iBAAiB,CAAC;AACtB,mBAAe,UAAU,IAAI,eAAe,UAAU,IACtD,eAAe,OAAO,IAAI,eAAe,QAAQ,IACjD,eAAe,QAAQ,IAAI,eAAe,QAAQ,IAClD,eAAe,eAAe,IAAI,eAAe,SAAS,IAC1D,eAAe,SAAS,IAAI;AAC5B,mBAAe,OAAO,IAAI,eAAe,QAAQ,IACjD,eAAe,cAAc,IAAI,eAAe,OAAO,IACvD,eAAe,WAAW,IAAI,eAAe,OAAO,IACpD,eAAe,QAAQ,IAAI,eAAe,OAAO,IACjD,eAAe,MAAM,IAAI,eAAe,SAAS,IACjD,eAAe,SAAS,IAAI,eAAe,SAAS,IACpD,eAAe,MAAM,IAAI,eAAe,SAAS,IACjD,eAAe,UAAU,IAAI;AAG7B,QAAI,aAAa,OAAO,UAAU,YAAY,UAAU,OAAO,WAAW,UAAU;AAGpF,QAAI,WAAW,OAAO,QAAQ,YAAY,QAAQ,KAAK,WAAW,UAAU;AAG5E,QAAI,OAAO,cAAc,YAAY,SAAS,aAAa,EAAE;AAG7D,QAAI,cAAc,OAAO,WAAW,YAAY,WAAW,CAAC,QAAQ,YAAY;AAGhF,QAAI,aAAa,eAAe,OAAO,UAAU,YAAY,UAAU,CAAC,OAAO,YAAY;AAG3F,QAAI,gBAAgB,cAAc,WAAW,YAAY;AAGzD,QAAI,cAAc,iBAAiB,WAAW;AAG9C,QAAI,WAAY,WAAW;AACzB,UAAI;AACF,eAAO,eAAe,YAAY,WAAW,YAAY,QAAQ,MAAM;AAAA,MACzE,SAAS,GAAG;AAAA,MAAC;AAAA,IACf,EAAE;AAGF,QAAI,mBAAmB,YAAY,SAAS;AAW5C,aAAS,YAAY,OAAO,WAAW;AACrC,UAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM,QACnC,WAAW,GACX,SAAS,CAAC;AAEd,aAAO,EAAE,QAAQ,QAAQ;AACvB,YAAI,QAAQ,MAAM,KAAK;AACvB,YAAI,UAAU,OAAO,OAAO,KAAK,GAAG;AAClC,iBAAO,UAAU,IAAI;AAAA,QACvB;AAAA,MACF;AACA,aAAO;AAAA,IACT;AAUA,aAAS,UAAU,OAAO,QAAQ;AAChC,UAAI,QAAQ,IACR,SAAS,OAAO,QAChB,SAAS,MAAM;AAEnB,aAAO,EAAE,QAAQ,QAAQ;AACvB,cAAM,SAAS,KAAK,IAAI,OAAO,KAAK;AAAA,MACtC;AACA,aAAO;AAAA,IACT;AAYA,aAAS,UAAU,OAAO,WAAW;AACnC,UAAI,QAAQ,IACR,SAAS,SAAS,OAAO,IAAI,MAAM;AAEvC,aAAO,EAAE,QAAQ,QAAQ;AACvB,YAAI,UAAU,MAAM,KAAK,GAAG,OAAO,KAAK,GAAG;AACzC,iBAAO;AAAA,QACT;AAAA,MACF;AACA,aAAO;AAAA,IACT;AAWA,aAAS,UAAU,GAAG,UAAU;AAC9B,UAAI,QAAQ,IACR,SAAS,MAAM,CAAC;AAEpB,aAAO,EAAE,QAAQ,GAAG;AAClB,eAAO,KAAK,IAAI,SAAS,KAAK;AAAA,MAChC;AACA,aAAO;AAAA,IACT;AASA,aAAS,UAAU,MAAM;AACvB,aAAO,SAAS,OAAO;AACrB,eAAO,KAAK,KAAK;AAAA,MACnB;AAAA,IACF;AAUA,aAAS,SAAS,OAAO,KAAK;AAC5B,aAAO,MAAM,IAAI,GAAG;AAAA,IACtB;AAUA,aAAS,SAAS,QAAQ,KAAK;AAC7B,aAAO,UAAU,OAAO,SAAY,OAAO,GAAG;AAAA,IAChD;AASA,aAAS,WAAW,KAAK;AACvB,UAAI,QAAQ,IACR,SAAS,MAAM,IAAI,IAAI;AAE3B,UAAI,QAAQ,SAAS,OAAO,KAAK;AAC/B,eAAO,EAAE,KAAK,IAAI,CAAC,KAAK,KAAK;AAAA,MAC/B,CAAC;AACD,aAAO;AAAA,IACT;AAUA,aAAS,QAAQ,MAAM,WAAW;AAChC,aAAO,SAAS,KAAK;AACnB,eAAO,KAAK,UAAU,GAAG,CAAC;AAAA,MAC5B;AAAA,IACF;AASA,aAAS,WAAW,KAAK;AACvB,UAAI,QAAQ,IACR,SAAS,MAAM,IAAI,IAAI;AAE3B,UAAI,QAAQ,SAAS,OAAO;AAC1B,eAAO,EAAE,KAAK,IAAI;AAAA,MACpB,CAAC;AACD,aAAO;AAAA,IACT;AAGA,QAAI,aAAa,MAAM;AAAvB,QACI,YAAY,SAAS;AADzB,QAEI,cAAc,OAAO;AAGzB,QAAI,aAAa,KAAK,oBAAoB;AAG1C,QAAI,eAAe,UAAU;AAG7B,QAAI,iBAAiB,YAAY;AAGjC,QAAI,aAAc,WAAW;AAC3B,UAAI,MAAM,SAAS,KAAK,cAAc,WAAW,QAAQ,WAAW,KAAK,YAAY,EAAE;AACvF,aAAO,MAAO,mBAAmB,MAAO;AAAA,IAC1C,EAAE;AAOF,QAAI,uBAAuB,YAAY;AAGvC,QAAI,aAAa;AAAA,MAAO,MACtB,aAAa,KAAK,cAAc,EAAE,QAAQ,cAAc,MAAM,EAC7D,QAAQ,0DAA0D,OAAO,IAAI;AAAA,IAChF;AAGA,QAAIC,UAAS,gBAAgB,KAAK,SAAS;AAA3C,QACIC,UAAS,KAAK;AADlB,QAEIC,cAAa,KAAK;AAFtB,QAGI,uBAAuB,YAAY;AAHvC,QAII,SAAS,WAAW;AAJxB,QAKI,iBAAiBD,UAASA,QAAO,cAAc;AAGnD,QAAI,mBAAmB,OAAO;AAA9B,QACI,iBAAiBD,UAASA,QAAO,WAAW;AADhD,QAEI,aAAa,QAAQ,OAAO,MAAM,MAAM;AAG5C,QAAI,WAAW,UAAU,MAAM,UAAU;AAAzC,QACIG,OAAM,UAAU,MAAM,KAAK;AAD/B,QAEIC,WAAU,UAAU,MAAM,SAAS;AAFvC,QAGIC,OAAM,UAAU,MAAM,KAAK;AAH/B,QAIIC,WAAU,UAAU,MAAM,SAAS;AAJvC,QAKI,eAAe,UAAU,QAAQ,QAAQ;AAG7C,QAAI,qBAAqB,SAAS,QAAQ;AAA1C,QACI,gBAAgB,SAASH,IAAG;AADhC,QAEI,oBAAoB,SAASC,QAAO;AAFxC,QAGI,gBAAgB,SAASC,IAAG;AAHhC,QAII,oBAAoB,SAASC,QAAO;AAGxC,QAAI,cAAcL,UAASA,QAAO,YAAY;AAA9C,QACI,gBAAgB,cAAc,YAAY,UAAU;AASxD,aAAS,KAAK,SAAS;AACrB,UAAI,QAAQ,IACR,SAAS,WAAW,OAAO,IAAI,QAAQ;AAE3C,WAAK,MAAM;AACX,aAAO,EAAE,QAAQ,QAAQ;AACvB,YAAI,QAAQ,QAAQ,KAAK;AACzB,aAAK,IAAI,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC;AAAA,MAC7B;AAAA,IACF;AASA,aAAS,YAAY;AACnB,WAAK,WAAW,eAAe,aAAa,IAAI,IAAI,CAAC;AACrD,WAAK,OAAO;AAAA,IACd;AAYA,aAAS,WAAW,KAAK;AACvB,UAAI,SAAS,KAAK,IAAI,GAAG,KAAK,OAAO,KAAK,SAAS,GAAG;AACtD,WAAK,QAAQ,SAAS,IAAI;AAC1B,aAAO;AAAA,IACT;AAWA,aAAS,QAAQ,KAAK;AACpB,UAAIM,QAAO,KAAK;AAChB,UAAI,cAAc;AAChB,YAAI,SAASA,MAAK,GAAG;AACrB,eAAO,WAAW,iBAAiB,SAAY;AAAA,MACjD;AACA,aAAO,eAAe,KAAKA,OAAM,GAAG,IAAIA,MAAK,GAAG,IAAI;AAAA,IACtD;AAWA,aAAS,QAAQ,KAAK;AACpB,UAAIA,QAAO,KAAK;AAChB,aAAO,eAAgBA,MAAK,GAAG,MAAM,SAAa,eAAe,KAAKA,OAAM,GAAG;AAAA,IACjF;AAYA,aAAS,QAAQ,KAAK,OAAO;AAC3B,UAAIA,QAAO,KAAK;AAChB,WAAK,QAAQ,KAAK,IAAI,GAAG,IAAI,IAAI;AACjC,MAAAA,MAAK,GAAG,IAAK,gBAAgB,UAAU,SAAa,iBAAiB;AACrE,aAAO;AAAA,IACT;AAGA,SAAK,UAAU,QAAQ;AACvB,SAAK,UAAU,QAAQ,IAAI;AAC3B,SAAK,UAAU,MAAM;AACrB,SAAK,UAAU,MAAM;AACrB,SAAK,UAAU,MAAM;AASrB,aAAS,UAAU,SAAS;AAC1B,UAAI,QAAQ,IACR,SAAS,WAAW,OAAO,IAAI,QAAQ;AAE3C,WAAK,MAAM;AACX,aAAO,EAAE,QAAQ,QAAQ;AACvB,YAAI,QAAQ,QAAQ,KAAK;AACzB,aAAK,IAAI,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC;AAAA,MAC7B;AAAA,IACF;AASA,aAAS,iBAAiB;AACxB,WAAK,WAAW,CAAC;AACjB,WAAK,OAAO;AAAA,IACd;AAWA,aAAS,gBAAgB,KAAK;AAC5B,UAAIA,QAAO,KAAK,UACZ,QAAQ,aAAaA,OAAM,GAAG;AAElC,UAAI,QAAQ,GAAG;AACb,eAAO;AAAA,MACT;AACA,UAAI,YAAYA,MAAK,SAAS;AAC9B,UAAI,SAAS,WAAW;AACtB,QAAAA,MAAK,IAAI;AAAA,MACX,OAAO;AACL,eAAO,KAAKA,OAAM,OAAO,CAAC;AAAA,MAC5B;AACA,QAAE,KAAK;AACP,aAAO;AAAA,IACT;AAWA,aAAS,aAAa,KAAK;AACzB,UAAIA,QAAO,KAAK,UACZ,QAAQ,aAAaA,OAAM,GAAG;AAElC,aAAO,QAAQ,IAAI,SAAYA,MAAK,KAAK,EAAE,CAAC;AAAA,IAC9C;AAWA,aAAS,aAAa,KAAK;AACzB,aAAO,aAAa,KAAK,UAAU,GAAG,IAAI;AAAA,IAC5C;AAYA,aAAS,aAAa,KAAK,OAAO;AAChC,UAAIA,QAAO,KAAK,UACZ,QAAQ,aAAaA,OAAM,GAAG;AAElC,UAAI,QAAQ,GAAG;AACb,UAAE,KAAK;AACP,QAAAA,MAAK,KAAK,CAAC,KAAK,KAAK,CAAC;AAAA,MACxB,OAAO;AACL,QAAAA,MAAK,KAAK,EAAE,CAAC,IAAI;AAAA,MACnB;AACA,aAAO;AAAA,IACT;AAGA,cAAU,UAAU,QAAQ;AAC5B,cAAU,UAAU,QAAQ,IAAI;AAChC,cAAU,UAAU,MAAM;AAC1B,cAAU,UAAU,MAAM;AAC1B,cAAU,UAAU,MAAM;AAS1B,aAAS,SAAS,SAAS;AACzB,UAAI,QAAQ,IACR,SAAS,WAAW,OAAO,IAAI,QAAQ;AAE3C,WAAK,MAAM;AACX,aAAO,EAAE,QAAQ,QAAQ;AACvB,YAAI,QAAQ,QAAQ,KAAK;AACzB,aAAK,IAAI,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC;AAAA,MAC7B;AAAA,IACF;AASA,aAAS,gBAAgB;AACvB,WAAK,OAAO;AACZ,WAAK,WAAW;AAAA,QACd,QAAQ,IAAI;AAAA,QACZ,OAAO,KAAKJ,QAAO;AAAA,QACnB,UAAU,IAAI;AAAA,MAChB;AAAA,IACF;AAWA,aAAS,eAAe,KAAK;AAC3B,UAAI,SAAS,WAAW,MAAM,GAAG,EAAE,QAAQ,EAAE,GAAG;AAChD,WAAK,QAAQ,SAAS,IAAI;AAC1B,aAAO;AAAA,IACT;AAWA,aAAS,YAAY,KAAK;AACxB,aAAO,WAAW,MAAM,GAAG,EAAE,IAAI,GAAG;AAAA,IACtC;AAWA,aAAS,YAAY,KAAK;AACxB,aAAO,WAAW,MAAM,GAAG,EAAE,IAAI,GAAG;AAAA,IACtC;AAYA,aAAS,YAAY,KAAK,OAAO;AAC/B,UAAII,QAAO,WAAW,MAAM,GAAG,GAC3B,OAAOA,MAAK;AAEhB,MAAAA,MAAK,IAAI,KAAK,KAAK;AACnB,WAAK,QAAQA,MAAK,QAAQ,OAAO,IAAI;AACrC,aAAO;AAAA,IACT;AAGA,aAAS,UAAU,QAAQ;AAC3B,aAAS,UAAU,QAAQ,IAAI;AAC/B,aAAS,UAAU,MAAM;AACzB,aAAS,UAAU,MAAM;AACzB,aAAS,UAAU,MAAM;AAUzB,aAAS,SAAS,QAAQ;AACxB,UAAI,QAAQ,IACR,SAAS,UAAU,OAAO,IAAI,OAAO;AAEzC,WAAK,WAAW,IAAI;AACpB,aAAO,EAAE,QAAQ,QAAQ;AACvB,aAAK,IAAI,OAAO,KAAK,CAAC;AAAA,MACxB;AAAA,IACF;AAYA,aAAS,YAAY,OAAO;AAC1B,WAAK,SAAS,IAAI,OAAO,cAAc;AACvC,aAAO;AAAA,IACT;AAWA,aAAS,YAAY,OAAO;AAC1B,aAAO,KAAK,SAAS,IAAI,KAAK;AAAA,IAChC;AAGA,aAAS,UAAU,MAAM,SAAS,UAAU,OAAO;AACnD,aAAS,UAAU,MAAM;AASzB,aAAS,MAAM,SAAS;AACtB,UAAIA,QAAO,KAAK,WAAW,IAAI,UAAU,OAAO;AAChD,WAAK,OAAOA,MAAK;AAAA,IACnB;AASA,aAAS,aAAa;AACpB,WAAK,WAAW,IAAI;AACpB,WAAK,OAAO;AAAA,IACd;AAWA,aAAS,YAAY,KAAK;AACxB,UAAIA,QAAO,KAAK,UACZ,SAASA,MAAK,QAAQ,EAAE,GAAG;AAE/B,WAAK,OAAOA,MAAK;AACjB,aAAO;AAAA,IACT;AAWA,aAAS,SAAS,KAAK;AACrB,aAAO,KAAK,SAAS,IAAI,GAAG;AAAA,IAC9B;AAWA,aAAS,SAAS,KAAK;AACrB,aAAO,KAAK,SAAS,IAAI,GAAG;AAAA,IAC9B;AAYA,aAAS,SAAS,KAAK,OAAO;AAC5B,UAAIA,QAAO,KAAK;AAChB,UAAIA,iBAAgB,WAAW;AAC7B,YAAI,QAAQA,MAAK;AACjB,YAAI,CAACJ,QAAQ,MAAM,SAAS,mBAAmB,GAAI;AACjD,gBAAM,KAAK,CAAC,KAAK,KAAK,CAAC;AACvB,eAAK,OAAO,EAAEI,MAAK;AACnB,iBAAO;AAAA,QACT;AACA,QAAAA,QAAO,KAAK,WAAW,IAAI,SAAS,KAAK;AAAA,MAC3C;AACA,MAAAA,MAAK,IAAI,KAAK,KAAK;AACnB,WAAK,OAAOA,MAAK;AACjB,aAAO;AAAA,IACT;AAGA,UAAM,UAAU,QAAQ;AACxB,UAAM,UAAU,QAAQ,IAAI;AAC5B,UAAM,UAAU,MAAM;AACtB,UAAM,UAAU,MAAM;AACtB,UAAM,UAAU,MAAM;AAUtB,aAAS,cAAc,OAAO,WAAW;AACvC,UAAI,QAAQC,SAAQ,KAAK,GACrB,QAAQ,CAAC,SAAS,YAAY,KAAK,GACnC,SAAS,CAAC,SAAS,CAAC,SAAS,SAAS,KAAK,GAC3C,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,UAAU,aAAa,KAAK,GAC1D,cAAc,SAAS,SAAS,UAAU,QAC1C,SAAS,cAAc,UAAU,MAAM,QAAQ,MAAM,IAAI,CAAC,GAC1D,SAAS,OAAO;AAEpB,eAAS,OAAO,OAAO;AACrB,aAAK,aAAa,eAAe,KAAK,OAAO,GAAG,MAC5C,EAAE;AAAA,SAEC,OAAO;AAAA,QAEN,WAAW,OAAO,YAAY,OAAO;AAAA,QAErC,WAAW,OAAO,YAAY,OAAO,gBAAgB,OAAO;AAAA,QAE7D,QAAQ,KAAK,MAAM,KAClB;AACN,iBAAO,KAAK,GAAG;AAAA,QACjB;AAAA,MACF;AACA,aAAO;AAAA,IACT;AAUA,aAAS,aAAa,OAAO,KAAK;AAChC,UAAI,SAAS,MAAM;AACnB,aAAO,UAAU;AACf,YAAI,GAAG,MAAM,MAAM,EAAE,CAAC,GAAG,GAAG,GAAG;AAC7B,iBAAO;AAAA,QACT;AAAA,MACF;AACA,aAAO;AAAA,IACT;AAaA,aAAS,eAAe,QAAQ,UAAU,aAAa;AACrD,UAAI,SAAS,SAAS,MAAM;AAC5B,aAAOA,SAAQ,MAAM,IAAI,SAAS,UAAU,QAAQ,YAAY,MAAM,CAAC;AAAA,IACzE;AASA,aAAS,WAAW,OAAO;AACzB,UAAI,SAAS,MAAM;AACjB,eAAO,UAAU,SAAY,eAAe;AAAA,MAC9C;AACA,aAAQ,kBAAkB,kBAAkB,OAAO,KAAK,IACpD,UAAU,KAAK,IACf,eAAe,KAAK;AAAA,IAC1B;AASA,aAAS,gBAAgB,OAAO;AAC9B,aAAO,aAAa,KAAK,KAAK,WAAW,KAAK,KAAK;AAAA,IACrD;AAgBA,aAAS,YAAY,OAAO,OAAO,SAASC,aAAY,OAAO;AAC7D,UAAI,UAAU,OAAO;AACnB,eAAO;AAAA,MACT;AACA,UAAI,SAAS,QAAQ,SAAS,QAAS,CAAC,aAAa,KAAK,KAAK,CAAC,aAAa,KAAK,GAAI;AACpF,eAAO,UAAU,SAAS,UAAU;AAAA,MACtC;AACA,aAAO,gBAAgB,OAAO,OAAO,SAASA,aAAY,aAAa,KAAK;AAAA,IAC9E;AAgBA,aAAS,gBAAgB,QAAQ,OAAO,SAASA,aAAY,WAAW,OAAO;AAC7E,UAAI,WAAWD,SAAQ,MAAM,GACzB,WAAWA,SAAQ,KAAK,GACxB,SAAS,WAAW,WAAW,OAAO,MAAM,GAC5C,SAAS,WAAW,WAAW,OAAO,KAAK;AAE/C,eAAS,UAAU,UAAU,YAAY;AACzC,eAAS,UAAU,UAAU,YAAY;AAEzC,UAAI,WAAW,UAAU,WACrB,WAAW,UAAU,WACrB,YAAY,UAAU;AAE1B,UAAI,aAAa,SAAS,MAAM,GAAG;AACjC,YAAI,CAAC,SAAS,KAAK,GAAG;AACpB,iBAAO;AAAA,QACT;AACA,mBAAW;AACX,mBAAW;AAAA,MACb;AACA,UAAI,aAAa,CAAC,UAAU;AAC1B,kBAAU,QAAQ,IAAI;AACtB,eAAQ,YAAY,aAAa,MAAM,IACnC,YAAY,QAAQ,OAAO,SAASC,aAAY,WAAW,KAAK,IAChE,WAAW,QAAQ,OAAO,QAAQ,SAASA,aAAY,WAAW,KAAK;AAAA,MAC7E;AACA,UAAI,EAAE,UAAU,uBAAuB;AACrC,YAAI,eAAe,YAAY,eAAe,KAAK,QAAQ,aAAa,GACpE,eAAe,YAAY,eAAe,KAAK,OAAO,aAAa;AAEvE,YAAI,gBAAgB,cAAc;AAChC,cAAI,eAAe,eAAe,OAAO,MAAM,IAAI,QAC/C,eAAe,eAAe,MAAM,MAAM,IAAI;AAElD,oBAAU,QAAQ,IAAI;AACtB,iBAAO,UAAU,cAAc,cAAc,SAASA,aAAY,KAAK;AAAA,QACzE;AAAA,MACF;AACA,UAAI,CAAC,WAAW;AACd,eAAO;AAAA,MACT;AACA,gBAAU,QAAQ,IAAI;AACtB,aAAO,aAAa,QAAQ,OAAO,SAASA,aAAY,WAAW,KAAK;AAAA,IAC1E;AAUA,aAAS,aAAa,OAAO;AAC3B,UAAI,CAACC,UAAS,KAAK,KAAK,SAAS,KAAK,GAAG;AACvC,eAAO;AAAA,MACT;AACA,UAAI,UAAU,WAAW,KAAK,IAAI,aAAa;AAC/C,aAAO,QAAQ,KAAK,SAAS,KAAK,CAAC;AAAA,IACrC;AASA,aAAS,iBAAiB,OAAO;AAC/B,aAAO,aAAa,KAAK,KACvB,SAAS,MAAM,MAAM,KAAK,CAAC,CAAC,eAAe,WAAW,KAAK,CAAC;AAAA,IAChE;AASA,aAAS,SAAS,QAAQ;AACxB,UAAI,CAAC,YAAY,MAAM,GAAG;AACxB,eAAO,WAAW,MAAM;AAAA,MAC1B;AACA,UAAI,SAAS,CAAC;AACd,eAAS,OAAO,OAAO,MAAM,GAAG;AAC9B,YAAI,eAAe,KAAK,QAAQ,GAAG,KAAK,OAAO,eAAe;AAC5D,iBAAO,KAAK,GAAG;AAAA,QACjB;AAAA,MACF;AACA,aAAO;AAAA,IACT;AAeA,aAAS,YAAY,OAAO,OAAO,SAASD,aAAY,WAAW,OAAO;AACxE,UAAI,YAAY,UAAU,sBACtB,YAAY,MAAM,QAClB,YAAY,MAAM;AAEtB,UAAI,aAAa,aAAa,EAAE,aAAa,YAAY,YAAY;AACnE,eAAO;AAAA,MACT;AAEA,UAAI,UAAU,MAAM,IAAI,KAAK;AAC7B,UAAI,WAAW,MAAM,IAAI,KAAK,GAAG;AAC/B,eAAO,WAAW;AAAA,MACpB;AACA,UAAI,QAAQ,IACR,SAAS,MACT,OAAQ,UAAU,yBAA0B,IAAI,aAAW;AAE/D,YAAM,IAAI,OAAO,KAAK;AACtB,YAAM,IAAI,OAAO,KAAK;AAGtB,aAAO,EAAE,QAAQ,WAAW;AAC1B,YAAI,WAAW,MAAM,KAAK,GACtB,WAAW,MAAM,KAAK;AAE1B,YAAIA,aAAY;AACd,cAAI,WAAW,YACXA,YAAW,UAAU,UAAU,OAAO,OAAO,OAAO,KAAK,IACzDA,YAAW,UAAU,UAAU,OAAO,OAAO,OAAO,KAAK;AAAA,QAC/D;AACA,YAAI,aAAa,QAAW;AAC1B,cAAI,UAAU;AACZ;AAAA,UACF;AACA,mBAAS;AACT;AAAA,QACF;AAEA,YAAI,MAAM;AACR,cAAI,CAAC,UAAU,OAAO,SAASE,WAAU,UAAU;AAC7C,gBAAI,CAAC,SAAS,MAAM,QAAQ,MACvB,aAAaA,aAAY,UAAU,UAAUA,WAAU,SAASF,aAAY,KAAK,IAAI;AACxF,qBAAO,KAAK,KAAK,QAAQ;AAAA,YAC3B;AAAA,UACF,CAAC,GAAG;AACN,qBAAS;AACT;AAAA,UACF;AAAA,QACF,WAAW,EACL,aAAa,YACX,UAAU,UAAU,UAAU,SAASA,aAAY,KAAK,IACzD;AACL,mBAAS;AACT;AAAA,QACF;AAAA,MACF;AACA,YAAM,QAAQ,EAAE,KAAK;AACrB,YAAM,QAAQ,EAAE,KAAK;AACrB,aAAO;AAAA,IACT;AAmBA,aAAS,WAAW,QAAQ,OAAO,KAAK,SAASA,aAAY,WAAW,OAAO;AAC7E,cAAQ,KAAK;AAAA,QACX,KAAK;AACH,cAAK,OAAO,cAAc,MAAM,cAC3B,OAAO,cAAc,MAAM,YAAa;AAC3C,mBAAO;AAAA,UACT;AACA,mBAAS,OAAO;AAChB,kBAAQ,MAAM;AAAA,QAEhB,KAAK;AACH,cAAK,OAAO,cAAc,MAAM,cAC5B,CAAC,UAAU,IAAIP,YAAW,MAAM,GAAG,IAAIA,YAAW,KAAK,CAAC,GAAG;AAC7D,mBAAO;AAAA,UACT;AACA,iBAAO;AAAA,QAET,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAGH,iBAAO,GAAG,CAAC,QAAQ,CAAC,KAAK;AAAA,QAE3B,KAAK;AACH,iBAAO,OAAO,QAAQ,MAAM,QAAQ,OAAO,WAAW,MAAM;AAAA,QAE9D,KAAK;AAAA,QACL,KAAK;AAIH,iBAAO,UAAW,QAAQ;AAAA,QAE5B,KAAK;AACH,cAAI,UAAU;AAAA,QAEhB,KAAK;AACH,cAAI,YAAY,UAAU;AAC1B,sBAAY,UAAU;AAEtB,cAAI,OAAO,QAAQ,MAAM,QAAQ,CAAC,WAAW;AAC3C,mBAAO;AAAA,UACT;AAEA,cAAI,UAAU,MAAM,IAAI,MAAM;AAC9B,cAAI,SAAS;AACX,mBAAO,WAAW;AAAA,UACpB;AACA,qBAAW;AAGX,gBAAM,IAAI,QAAQ,KAAK;AACvB,cAAI,SAAS,YAAY,QAAQ,MAAM,GAAG,QAAQ,KAAK,GAAG,SAASO,aAAY,WAAW,KAAK;AAC/F,gBAAM,QAAQ,EAAE,MAAM;AACtB,iBAAO;AAAA,QAET,KAAK;AACH,cAAI,eAAe;AACjB,mBAAO,cAAc,KAAK,MAAM,KAAK,cAAc,KAAK,KAAK;AAAA,UAC/D;AAAA,MACJ;AACA,aAAO;AAAA,IACT;AAeA,aAAS,aAAa,QAAQ,OAAO,SAASA,aAAY,WAAW,OAAO;AAC1E,UAAI,YAAY,UAAU,sBACtB,WAAW,WAAW,MAAM,GAC5B,YAAY,SAAS,QACrB,WAAW,WAAW,KAAK,GAC3B,YAAY,SAAS;AAEzB,UAAI,aAAa,aAAa,CAAC,WAAW;AACxC,eAAO;AAAA,MACT;AACA,UAAI,QAAQ;AACZ,aAAO,SAAS;AACd,YAAI,MAAM,SAAS,KAAK;AACxB,YAAI,EAAE,YAAY,OAAO,QAAQ,eAAe,KAAK,OAAO,GAAG,IAAI;AACjE,iBAAO;AAAA,QACT;AAAA,MACF;AAEA,UAAI,UAAU,MAAM,IAAI,MAAM;AAC9B,UAAI,WAAW,MAAM,IAAI,KAAK,GAAG;AAC/B,eAAO,WAAW;AAAA,MACpB;AACA,UAAI,SAAS;AACb,YAAM,IAAI,QAAQ,KAAK;AACvB,YAAM,IAAI,OAAO,MAAM;AAEvB,UAAI,WAAW;AACf,aAAO,EAAE,QAAQ,WAAW;AAC1B,cAAM,SAAS,KAAK;AACpB,YAAI,WAAW,OAAO,GAAG,GACrB,WAAW,MAAM,GAAG;AAExB,YAAIA,aAAY;AACd,cAAI,WAAW,YACXA,YAAW,UAAU,UAAU,KAAK,OAAO,QAAQ,KAAK,IACxDA,YAAW,UAAU,UAAU,KAAK,QAAQ,OAAO,KAAK;AAAA,QAC9D;AAEA,YAAI,EAAE,aAAa,SACV,aAAa,YAAY,UAAU,UAAU,UAAU,SAASA,aAAY,KAAK,IAClF,WACD;AACL,mBAAS;AACT;AAAA,QACF;AACA,qBAAa,WAAW,OAAO;AAAA,MACjC;AACA,UAAI,UAAU,CAAC,UAAU;AACvB,YAAI,UAAU,OAAO,aACjB,UAAU,MAAM;AAGpB,YAAI,WAAW,YACV,iBAAiB,UAAU,iBAAiB,UAC7C,EAAE,OAAO,WAAW,cAAc,mBAAmB,WACnD,OAAO,WAAW,cAAc,mBAAmB,UAAU;AACjE,mBAAS;AAAA,QACX;AAAA,MACF;AACA,YAAM,QAAQ,EAAE,MAAM;AACtB,YAAM,QAAQ,EAAE,KAAK;AACrB,aAAO;AAAA,IACT;AASA,aAAS,WAAW,QAAQ;AAC1B,aAAO,eAAe,QAAQ,MAAM,UAAU;AAAA,IAChD;AAUA,aAAS,WAAW,KAAK,KAAK;AAC5B,UAAIF,QAAO,IAAI;AACf,aAAO,UAAU,GAAG,IAChBA,MAAK,OAAO,OAAO,WAAW,WAAW,MAAM,IAC/CA,MAAK;AAAA,IACX;AAUA,aAAS,UAAU,QAAQ,KAAK;AAC9B,UAAI,QAAQ,SAAS,QAAQ,GAAG;AAChC,aAAO,aAAa,KAAK,IAAI,QAAQ;AAAA,IACvC;AASA,aAAS,UAAU,OAAO;AACxB,UAAI,QAAQ,eAAe,KAAK,OAAO,cAAc,GACjD,MAAM,MAAM,cAAc;AAE9B,UAAI;AACF,cAAM,cAAc,IAAI;AACxB,YAAI,WAAW;AAAA,MACjB,SAAS,GAAG;AAAA,MAAC;AAEb,UAAI,SAAS,qBAAqB,KAAK,KAAK;AAC5C,UAAI,UAAU;AACZ,YAAI,OAAO;AACT,gBAAM,cAAc,IAAI;AAAA,QAC1B,OAAO;AACL,iBAAO,MAAM,cAAc;AAAA,QAC7B;AAAA,MACF;AACA,aAAO;AAAA,IACT;AASA,QAAI,aAAa,CAAC,mBAAmB,YAAY,SAAS,QAAQ;AAChE,UAAI,UAAU,MAAM;AAClB,eAAO,CAAC;AAAA,MACV;AACA,eAAS,OAAO,MAAM;AACtB,aAAO,YAAY,iBAAiB,MAAM,GAAG,SAAS,QAAQ;AAC5D,eAAO,qBAAqB,KAAK,QAAQ,MAAM;AAAA,MACjD,CAAC;AAAA,IACH;AASA,QAAI,SAAS;AAGb,QAAK,YAAY,OAAO,IAAI,SAAS,IAAI,YAAY,CAAC,CAAC,CAAC,KAAK,eACxDJ,QAAO,OAAO,IAAIA,MAAG,KAAK,UAC1BC,YAAW,OAAOA,SAAQ,QAAQ,CAAC,KAAK,cACxCC,QAAO,OAAO,IAAIA,MAAG,KAAK,UAC1BC,YAAW,OAAO,IAAIA,UAAO,KAAK,YAAa;AAClD,eAAS,SAAS,OAAO;AACvB,YAAI,SAAS,WAAW,KAAK,GACzB,OAAO,UAAU,YAAY,MAAM,cAAc,QACjD,aAAa,OAAO,SAAS,IAAI,IAAI;AAEzC,YAAI,YAAY;AACd,kBAAQ,YAAY;AAAA,YAClB,KAAK;AAAoB,qBAAO;AAAA,YAChC,KAAK;AAAe,qBAAO;AAAA,YAC3B,KAAK;AAAmB,qBAAO;AAAA,YAC/B,KAAK;AAAe,qBAAO;AAAA,YAC3B,KAAK;AAAmB,qBAAO;AAAA,UACjC;AAAA,QACF;AACA,eAAO;AAAA,MACT;AAAA,IACF;AAUA,aAAS,QAAQ,OAAO,QAAQ;AAC9B,eAAS,UAAU,OAAO,mBAAmB;AAC7C,aAAO,CAAC,CAAC,WACN,OAAO,SAAS,YAAY,SAAS,KAAK,KAAK,OAC/C,QAAQ,MAAM,QAAQ,KAAK,KAAK,QAAQ;AAAA,IAC7C;AASA,aAAS,UAAU,OAAO;AACxB,UAAI,OAAO,OAAO;AAClB,aAAQ,QAAQ,YAAY,QAAQ,YAAY,QAAQ,YAAY,QAAQ,YACvE,UAAU,cACV,UAAU;AAAA,IACjB;AASA,aAAS,SAAS,MAAM;AACtB,aAAO,CAAC,CAAC,cAAe,cAAc;AAAA,IACxC;AASA,aAAS,YAAY,OAAO;AAC1B,UAAI,OAAO,SAAS,MAAM,aACtB,QAAS,OAAO,QAAQ,cAAc,KAAK,aAAc;AAE7D,aAAO,UAAU;AAAA,IACnB;AASA,aAAS,eAAe,OAAO;AAC7B,aAAO,qBAAqB,KAAK,KAAK;AAAA,IACxC;AASA,aAAS,SAAS,MAAM;AACtB,UAAI,QAAQ,MAAM;AAChB,YAAI;AACF,iBAAO,aAAa,KAAK,IAAI;AAAA,QAC/B,SAAS,GAAG;AAAA,QAAC;AACb,YAAI;AACF,iBAAQ,OAAO;AAAA,QACjB,SAAS,GAAG;AAAA,QAAC;AAAA,MACf;AACA,aAAO;AAAA,IACT;AAkCA,aAAS,GAAG,OAAO,OAAO;AACxB,aAAO,UAAU,SAAU,UAAU,SAAS,UAAU;AAAA,IAC1D;AAoBA,QAAI,cAAc,gBAAgB,WAAW;AAAE,aAAO;AAAA,IAAW,EAAE,CAAC,IAAI,kBAAkB,SAAS,OAAO;AACxG,aAAO,aAAa,KAAK,KAAK,eAAe,KAAK,OAAO,QAAQ,KAC/D,CAAC,qBAAqB,KAAK,OAAO,QAAQ;AAAA,IAC9C;AAyBA,QAAIE,WAAU,MAAM;AA2BpB,aAAS,YAAY,OAAO;AAC1B,aAAO,SAAS,QAAQ,SAAS,MAAM,MAAM,KAAK,CAAC,WAAW,KAAK;AAAA,IACrE;AAmBA,QAAI,WAAW,kBAAkB;AA8BjC,aAAS,QAAQ,OAAO,OAAO;AAC7B,aAAO,YAAY,OAAO,KAAK;AAAA,IACjC;AAmBA,aAAS,WAAW,OAAO;AACzB,UAAI,CAACE,UAAS,KAAK,GAAG;AACpB,eAAO;AAAA,MACT;AAGA,UAAI,MAAM,WAAW,KAAK;AAC1B,aAAO,OAAO,WAAW,OAAO,UAAU,OAAO,YAAY,OAAO;AAAA,IACtE;AA4BA,aAAS,SAAS,OAAO;AACvB,aAAO,OAAO,SAAS,YACrB,QAAQ,MAAM,QAAQ,KAAK,KAAK,SAAS;AAAA,IAC7C;AA2BA,aAASA,UAAS,OAAO;AACvB,UAAI,OAAO,OAAO;AAClB,aAAO,SAAS,SAAS,QAAQ,YAAY,QAAQ;AAAA,IACvD;AA0BA,aAAS,aAAa,OAAO;AAC3B,aAAO,SAAS,QAAQ,OAAO,SAAS;AAAA,IAC1C;AAmBA,QAAI,eAAe,mBAAmB,UAAU,gBAAgB,IAAI;AA8BpE,aAAS,KAAK,QAAQ;AACpB,aAAO,YAAY,MAAM,IAAI,cAAc,MAAM,IAAI,SAAS,MAAM;AAAA,IACtE;AAoBA,aAAS,YAAY;AACnB,aAAO,CAAC;AAAA,IACV;AAeA,aAAS,YAAY;AACnB,aAAO;AAAA,IACT;AAEA,WAAO,UAAU;AAAA;AAAA;;;ACvzDjB;AAAA;AAAA;AAAA;AAIA,QAAME,YAAW,CAAC;AAIlB,IAAAA,UAAS,qBAAqB,WAAW;AACvC,aAAO,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,GAAG,EAAE;AAAA,IACnD;AAGA,IAAAA,UAAS,aAAaA,UAAS,mBAAmB;AAGlD,IAAAA,UAAS,aAAa,SAAS,MAAM;AACnC,aAAO,KAAK,KAAK,EAAE,MAAM,IAAI,EAAE,IAAI,UAAQ,KAAK,KAAK,CAAC;AAAA,IACxD;AAEA,IAAAA,UAAS,gBAAgB,SAAS,MAAM;AACtC,YAAM,QAAQ,KAAK,MAAM,MAAM;AAC/B,aAAO,MAAM,IAAI,CAAC,MAAM,WAAW,QAAQ,IACzC,OAAO,OAAO,MAAM,KAAK,IAAI,MAAM;AAAA,IACvC;AAGA,IAAAA,UAAS,iBAAiB,SAAS,MAAM;AACvC,YAAM,WAAWA,UAAS,cAAc,IAAI;AAC5C,aAAO,YAAY,SAAS,CAAC;AAAA,IAC/B;AAGA,IAAAA,UAAS,mBAAmB,SAAS,MAAM;AACzC,YAAM,WAAWA,UAAS,cAAc,IAAI;AAC5C,eAAS,MAAM;AACf,aAAO;AAAA,IACT;AAGA,IAAAA,UAAS,cAAc,SAAS,MAAM,QAAQ;AAC5C,aAAOA,UAAS,WAAW,IAAI,EAAE,OAAO,UAAQ,KAAK,QAAQ,MAAM,MAAM,CAAC;AAAA,IAC5E;AAMA,IAAAA,UAAS,iBAAiB,SAAS,MAAM;AACvC,UAAI;AAEJ,UAAI,KAAK,QAAQ,cAAc,MAAM,GAAG;AACtC,gBAAQ,KAAK,UAAU,EAAE,EAAE,MAAM,GAAG;AAAA,MACtC,OAAO;AACL,gBAAQ,KAAK,UAAU,EAAE,EAAE,MAAM,GAAG;AAAA,MACtC;AAEA,YAAM,YAAY;AAAA,QAChB,YAAY,MAAM,CAAC;AAAA,QACnB,WAAW,EAAC,GAAG,OAAO,GAAG,OAAM,EAAE,MAAM,CAAC,CAAC,KAAK,MAAM,CAAC;AAAA,QACrD,UAAU,MAAM,CAAC,EAAE,YAAY;AAAA,QAC/B,UAAU,SAAS,MAAM,CAAC,GAAG,EAAE;AAAA,QAC/B,IAAI,MAAM,CAAC;AAAA,QACX,SAAS,MAAM,CAAC;AAAA;AAAA,QAChB,MAAM,SAAS,MAAM,CAAC,GAAG,EAAE;AAAA;AAAA,QAE3B,MAAM,MAAM,CAAC;AAAA,MACf;AAEA,eAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK,GAAG;AACxC,gBAAQ,MAAM,CAAC,GAAG;AAAA,UAChB,KAAK;AACH,sBAAU,iBAAiB,MAAM,IAAI,CAAC;AACtC;AAAA,UACF,KAAK;AACH,sBAAU,cAAc,SAAS,MAAM,IAAI,CAAC,GAAG,EAAE;AACjD;AAAA,UACF,KAAK;AACH,sBAAU,UAAU,MAAM,IAAI,CAAC;AAC/B;AAAA,UACF,KAAK;AACH,sBAAU,QAAQ,MAAM,IAAI,CAAC;AAC7B,sBAAU,mBAAmB,MAAM,IAAI,CAAC;AACxC;AAAA,UACF;AACE,gBAAI,UAAU,MAAM,CAAC,CAAC,MAAM,QAAW;AACrC,wBAAU,MAAM,CAAC,CAAC,IAAI,MAAM,IAAI,CAAC;AAAA,YACnC;AACA;AAAA,QACJ;AAAA,MACF;AACA,aAAO;AAAA,IACT;AAIA,IAAAA,UAAS,iBAAiB,SAAS,WAAW;AAC5C,YAAMC,OAAM,CAAC;AACb,MAAAA,KAAI,KAAK,UAAU,UAAU;AAE7B,YAAM,YAAY,UAAU;AAC5B,UAAI,cAAc,OAAO;AACvB,QAAAA,KAAI,KAAK,CAAC;AAAA,MACZ,WAAW,cAAc,QAAQ;AAC/B,QAAAA,KAAI,KAAK,CAAC;AAAA,MACZ,OAAO;AACL,QAAAA,KAAI,KAAK,SAAS;AAAA,MACpB;AACA,MAAAA,KAAI,KAAK,UAAU,SAAS,YAAY,CAAC;AACzC,MAAAA,KAAI,KAAK,UAAU,QAAQ;AAC3B,MAAAA,KAAI,KAAK,UAAU,WAAW,UAAU,EAAE;AAC1C,MAAAA,KAAI,KAAK,UAAU,IAAI;AAEvB,YAAM,OAAO,UAAU;AACvB,MAAAA,KAAI,KAAK,KAAK;AACd,MAAAA,KAAI,KAAK,IAAI;AACb,UAAI,SAAS,UAAU,UAAU,kBAC7B,UAAU,aAAa;AACzB,QAAAA,KAAI,KAAK,OAAO;AAChB,QAAAA,KAAI,KAAK,UAAU,cAAc;AACjC,QAAAA,KAAI,KAAK,OAAO;AAChB,QAAAA,KAAI,KAAK,UAAU,WAAW;AAAA,MAChC;AACA,UAAI,UAAU,WAAW,UAAU,SAAS,YAAY,MAAM,OAAO;AACnE,QAAAA,KAAI,KAAK,SAAS;AAClB,QAAAA,KAAI,KAAK,UAAU,OAAO;AAAA,MAC5B;AACA,UAAI,UAAU,oBAAoB,UAAU,OAAO;AACjD,QAAAA,KAAI,KAAK,OAAO;AAChB,QAAAA,KAAI,KAAK,UAAU,oBAAoB,UAAU,KAAK;AAAA,MACxD;AACA,aAAO,eAAeA,KAAI,KAAK,GAAG;AAAA,IACpC;AAKA,IAAAD,UAAS,kBAAkB,SAAS,MAAM;AACxC,aAAO,KAAK,UAAU,EAAE,EAAE,MAAM,GAAG;AAAA,IACrC;AAIA,IAAAA,UAAS,cAAc,SAAS,MAAM;AACpC,UAAI,QAAQ,KAAK,UAAU,CAAC,EAAE,MAAM,GAAG;AACvC,YAAM,SAAS;AAAA,QACb,aAAa,SAAS,MAAM,MAAM,GAAG,EAAE;AAAA;AAAA,MACzC;AAEA,cAAQ,MAAM,CAAC,EAAE,MAAM,GAAG;AAE1B,aAAO,OAAO,MAAM,CAAC;AACrB,aAAO,YAAY,SAAS,MAAM,CAAC,GAAG,EAAE;AACxC,aAAO,WAAW,MAAM,WAAW,IAAI,SAAS,MAAM,CAAC,GAAG,EAAE,IAAI;AAEhE,aAAO,cAAc,OAAO;AAC5B,aAAO;AAAA,IACT;AAIA,IAAAA,UAAS,cAAc,SAAS,OAAO;AACrC,UAAIE,MAAK,MAAM;AACf,UAAI,MAAM,yBAAyB,QAAW;AAC5C,QAAAA,MAAK,MAAM;AAAA,MACb;AACA,YAAM,WAAW,MAAM,YAAY,MAAM,eAAe;AACxD,aAAO,cAAcA,MAAK,MAAM,MAAM,OAAO,MAAM,MAAM,aACpD,aAAa,IAAI,MAAM,WAAW,MAAM;AAAA,IAC/C;AAKA,IAAAF,UAAS,cAAc,SAAS,MAAM;AACpC,YAAM,QAAQ,KAAK,UAAU,CAAC,EAAE,MAAM,GAAG;AACzC,aAAO;AAAA,QACL,IAAI,SAAS,MAAM,CAAC,GAAG,EAAE;AAAA,QACzB,WAAW,MAAM,CAAC,EAAE,QAAQ,GAAG,IAAI,IAAI,MAAM,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,IAAI;AAAA,QAChE,KAAK,MAAM,CAAC;AAAA,QACZ,YAAY,MAAM,MAAM,CAAC,EAAE,KAAK,GAAG;AAAA,MACrC;AAAA,IACF;AAIA,IAAAA,UAAS,cAAc,SAAS,iBAAiB;AAC/C,aAAO,eAAe,gBAAgB,MAAM,gBAAgB,gBACvD,gBAAgB,aAAa,gBAAgB,cAAc,aACxD,MAAM,gBAAgB,YACtB,MACJ,MAAM,gBAAgB,OACrB,gBAAgB,aAAa,MAAM,gBAAgB,aAAa,MACjE;AAAA,IACN;AAKA,IAAAA,UAAS,YAAY,SAAS,MAAM;AAClC,YAAM,SAAS,CAAC;AAChB,UAAI;AACJ,YAAM,QAAQ,KAAK,UAAU,KAAK,QAAQ,GAAG,IAAI,CAAC,EAAE,MAAM,GAAG;AAC7D,eAASG,KAAI,GAAGA,KAAI,MAAM,QAAQA,MAAK;AACrC,aAAK,MAAMA,EAAC,EAAE,KAAK,EAAE,MAAM,GAAG;AAC9B,eAAO,GAAG,CAAC,EAAE,KAAK,CAAC,IAAI,GAAG,CAAC;AAAA,MAC7B;AACA,aAAO;AAAA,IACT;AAGA,IAAAH,UAAS,YAAY,SAAS,OAAO;AACnC,UAAI,OAAO;AACX,UAAIE,MAAK,MAAM;AACf,UAAI,MAAM,yBAAyB,QAAW;AAC5C,QAAAA,MAAK,MAAM;AAAA,MACb;AACA,UAAI,MAAM,cAAc,OAAO,KAAK,MAAM,UAAU,EAAE,QAAQ;AAC5D,cAAM,SAAS,CAAC;AAChB,eAAO,KAAK,MAAM,UAAU,EAAE,QAAQ,WAAS;AAC7C,cAAI,MAAM,WAAW,KAAK,MAAM,QAAW;AACzC,mBAAO,KAAK,QAAQ,MAAM,MAAM,WAAW,KAAK,CAAC;AAAA,UACnD,OAAO;AACL,mBAAO,KAAK,KAAK;AAAA,UACnB;AAAA,QACF,CAAC;AACD,gBAAQ,YAAYA,MAAK,MAAM,OAAO,KAAK,GAAG,IAAI;AAAA,MACpD;AACA,aAAO;AAAA,IACT;AAIA,IAAAF,UAAS,cAAc,SAAS,MAAM;AACpC,YAAM,QAAQ,KAAK,UAAU,KAAK,QAAQ,GAAG,IAAI,CAAC,EAAE,MAAM,GAAG;AAC7D,aAAO;AAAA,QACL,MAAM,MAAM,MAAM;AAAA,QAClB,WAAW,MAAM,KAAK,GAAG;AAAA,MAC3B;AAAA,IACF;AAGA,IAAAA,UAAS,cAAc,SAAS,OAAO;AACrC,UAAI,QAAQ;AACZ,UAAIE,MAAK,MAAM;AACf,UAAI,MAAM,yBAAyB,QAAW;AAC5C,QAAAA,MAAK,MAAM;AAAA,MACb;AACA,UAAI,MAAM,gBAAgB,MAAM,aAAa,QAAQ;AAEnD,cAAM,aAAa,QAAQ,QAAM;AAC/B,mBAAS,eAAeA,MAAK,MAAM,GAAG,QACrC,GAAG,aAAa,GAAG,UAAU,SAAS,MAAM,GAAG,YAAY,MACxD;AAAA,QACN,CAAC;AAAA,MACH;AACA,aAAO;AAAA,IACT;AAIA,IAAAF,UAAS,iBAAiB,SAAS,MAAM;AACvC,YAAM,KAAK,KAAK,QAAQ,GAAG;AAC3B,YAAM,QAAQ;AAAA,QACZ,MAAM,SAAS,KAAK,UAAU,GAAG,EAAE,GAAG,EAAE;AAAA,MAC1C;AACA,YAAM,QAAQ,KAAK,QAAQ,KAAK,EAAE;AAClC,UAAI,QAAQ,IAAI;AACd,cAAM,YAAY,KAAK,UAAU,KAAK,GAAG,KAAK;AAC9C,cAAM,QAAQ,KAAK,UAAU,QAAQ,CAAC;AAAA,MACxC,OAAO;AACL,cAAM,YAAY,KAAK,UAAU,KAAK,CAAC;AAAA,MACzC;AACA,aAAO;AAAA,IACT;AAIA,IAAAA,UAAS,iBAAiB,SAAS,MAAM;AACvC,YAAM,QAAQ,KAAK,UAAU,EAAE,EAAE,MAAM,GAAG;AAC1C,aAAO;AAAA,QACL,WAAW,MAAM,MAAM;AAAA,QACvB,OAAO,MAAM,IAAI,UAAQ,SAAS,MAAM,EAAE,CAAC;AAAA,MAC7C;AAAA,IACF;AAIA,IAAAA,UAAS,SAAS,SAAS,cAAc;AACvC,YAAM,MAAMA,UAAS,YAAY,cAAc,QAAQ,EAAE,CAAC;AAC1D,UAAI,KAAK;AACP,eAAO,IAAI,UAAU,CAAC;AAAA,MACxB;AAAA,IACF;AAGA,IAAAA,UAAS,mBAAmB,SAAS,MAAM;AACzC,YAAM,QAAQ,KAAK,UAAU,EAAE,EAAE,MAAM,GAAG;AAC1C,aAAO;AAAA,QACL,WAAW,MAAM,CAAC,EAAE,YAAY;AAAA;AAAA,QAChC,OAAO,MAAM,CAAC,EAAE,YAAY;AAAA;AAAA,MAC9B;AAAA,IACF;AAKA,IAAAA,UAAS,oBAAoB,SAAS,cAAc,aAAa;AAC/D,YAAM,QAAQA,UAAS;AAAA,QAAY,eAAe;AAAA,QAChD;AAAA,MAAgB;AAElB,aAAO;AAAA,QACL,MAAM;AAAA,QACN,cAAc,MAAM,IAAIA,UAAS,gBAAgB;AAAA,MACnD;AAAA,IACF;AAGA,IAAAA,UAAS,sBAAsB,SAAS,QAAQ,WAAW;AACzD,UAAIC,OAAM,aAAa,YAAY;AACnC,aAAO,aAAa,QAAQ,QAAM;AAChC,QAAAA,QAAO,mBAAmB,GAAG,YAAY,MAAM,GAAG,QAAQ;AAAA,MAC5D,CAAC;AACD,aAAOA;AAAA,IACT;AAIA,IAAAD,UAAS,kBAAkB,SAAS,MAAM;AACxC,YAAM,QAAQ,KAAK,UAAU,CAAC,EAAE,MAAM,GAAG;AACzC,aAAO;AAAA,QACL,KAAK,SAAS,MAAM,CAAC,GAAG,EAAE;AAAA,QAC1B,aAAa,MAAM,CAAC;AAAA,QACpB,WAAW,MAAM,CAAC;AAAA,QAClB,eAAe,MAAM,MAAM,CAAC;AAAA,MAC9B;AAAA,IACF;AAEA,IAAAA,UAAS,kBAAkB,SAAS,YAAY;AAC9C,aAAO,cAAc,WAAW,MAAM,MACpC,WAAW,cAAc,OACxB,OAAO,WAAW,cAAc,WAC7BA,UAAS,qBAAqB,WAAW,SAAS,IAClD,WAAW,cACd,WAAW,gBAAgB,MAAM,WAAW,cAAc,KAAK,GAAG,IAAI,MACvE;AAAA,IACJ;AAIA,IAAAA,UAAS,uBAAuB,SAAS,WAAW;AAClD,UAAI,UAAU,QAAQ,SAAS,MAAM,GAAG;AACtC,eAAO;AAAA,MACT;AACA,YAAM,QAAQ,UAAU,UAAU,CAAC,EAAE,MAAM,GAAG;AAC9C,aAAO;AAAA,QACL,WAAW;AAAA,QACX,SAAS,MAAM,CAAC;AAAA,QAChB,UAAU,MAAM,CAAC;AAAA,QACjB,UAAU,MAAM,CAAC,IAAI,MAAM,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,IAAI;AAAA,QAC9C,WAAW,MAAM,CAAC,IAAI,MAAM,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,IAAI;AAAA,MACjD;AAAA,IACF;AAEA,IAAAA,UAAS,uBAAuB,SAAS,WAAW;AAClD,aAAO,UAAU,YAAY,MACzB,UAAU,WACX,UAAU,WAAW,MAAM,UAAU,WAAW,OAChD,UAAU,YAAY,UAAU,YAC7B,MAAM,UAAU,WAAW,MAAM,UAAU,YAC3C;AAAA,IACR;AAGA,IAAAA,UAAS,sBAAsB,SAAS,cAAc,aAAa;AACjE,YAAM,QAAQA,UAAS;AAAA,QAAY,eAAe;AAAA,QAChD;AAAA,MAAW;AACb,aAAO,MAAM,IAAIA,UAAS,eAAe;AAAA,IAC3C;AAKA,IAAAA,UAAS,mBAAmB,SAAS,cAAc,aAAa;AAC9D,YAAM,QAAQA,UAAS;AAAA,QAAY,eAAe;AAAA,QAChD;AAAA,MAAc,EAAE,CAAC;AACnB,YAAM,MAAMA,UAAS;AAAA,QAAY,eAAe;AAAA,QAC9C;AAAA,MAAY,EAAE,CAAC;AACjB,UAAI,EAAE,SAAS,MAAM;AACnB,eAAO;AAAA,MACT;AACA,aAAO;AAAA,QACL,kBAAkB,MAAM,UAAU,EAAE;AAAA,QACpC,UAAU,IAAI,UAAU,EAAE;AAAA,MAC5B;AAAA,IACF;AAGA,IAAAA,UAAS,qBAAqB,SAAS,QAAQ;AAC7C,UAAIC,OAAM,iBAAiB,OAAO,mBAAmB,mBAClC,OAAO,WAAW;AACrC,UAAI,OAAO,SAAS;AAClB,QAAAA,QAAO;AAAA,MACT;AACA,aAAOA;AAAA,IACT;AAGA,IAAAD,UAAS,qBAAqB,SAAS,cAAc;AACnD,YAAM,cAAc;AAAA,QAClB,QAAQ,CAAC;AAAA,QACT,kBAAkB,CAAC;AAAA,QACnB,eAAe,CAAC;AAAA,QAChB,MAAM,CAAC;AAAA,MACT;AACA,YAAM,QAAQA,UAAS,WAAW,YAAY;AAC9C,YAAM,QAAQ,MAAM,CAAC,EAAE,MAAM,GAAG;AAChC,kBAAY,UAAU,MAAM,CAAC;AAC7B,eAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACrC,cAAME,MAAK,MAAM,CAAC;AAClB,cAAM,aAAaF,UAAS;AAAA,UAC1B;AAAA,UAAc,cAAcE,MAAK;AAAA,QAAG,EAAE,CAAC;AACzC,YAAI,YAAY;AACd,gBAAM,QAAQF,UAAS,YAAY,UAAU;AAC7C,gBAAM,QAAQA,UAAS;AAAA,YACrB;AAAA,YAAc,YAAYE,MAAK;AAAA,UAAG;AAEpC,gBAAM,aAAa,MAAM,SAASF,UAAS,UAAU,MAAM,CAAC,CAAC,IAAI,CAAC;AAClE,gBAAM,eAAeA,UAAS;AAAA,YAC5B;AAAA,YAAc,eAAeE,MAAK;AAAA,UAAG,EACpC,IAAIF,UAAS,WAAW;AAC3B,sBAAY,OAAO,KAAK,KAAK;AAE7B,kBAAQ,MAAM,KAAK,YAAY,GAAG;AAAA,YAChC,KAAK;AAAA,YACL,KAAK;AACH,0BAAY,cAAc,KAAK,MAAM,KAAK,YAAY,CAAC;AACvD;AAAA,YACF;AACE;AAAA,UACJ;AAAA,QACF;AAAA,MACF;AACA,MAAAA,UAAS,YAAY,cAAc,WAAW,EAAE,QAAQ,UAAQ;AAC9D,oBAAY,iBAAiB,KAAKA,UAAS,YAAY,IAAI,CAAC;AAAA,MAC9D,CAAC;AACD,YAAM,iBAAiBA,UAAS,YAAY,cAAc,cAAc,EACrE,IAAIA,UAAS,WAAW;AAC3B,kBAAY,OAAO,QAAQ,WAAS;AAClC,uBAAe,QAAQ,QAAK;AAC1B,gBAAM,YAAY,MAAM,aAAa,KAAK,sBAAoB;AAC5D,mBAAO,iBAAiB,SAAS,GAAG,QAClC,iBAAiB,cAAc,GAAG;AAAA,UACtC,CAAC;AACD,cAAI,CAAC,WAAW;AACd,kBAAM,aAAa,KAAK,EAAE;AAAA,UAC5B;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAED,aAAO;AAAA,IACT;AAIA,IAAAA,UAAS,sBAAsB,SAAS,MAAM,MAAM;AAClD,UAAIC,OAAM;AAGV,MAAAA,QAAO,OAAO,OAAO;AACrB,MAAAA,QAAO,KAAK,OAAO,SAAS,IAAI,MAAM;AACtC,MAAAA,QAAO,OAAO,KAAK,WAAW,uBAAuB;AACrD,MAAAA,QAAO,KAAK,OAAO,IAAI,WAAS;AAC9B,YAAI,MAAM,yBAAyB,QAAW;AAC5C,iBAAO,MAAM;AAAA,QACf;AACA,eAAO,MAAM;AAAA,MACf,CAAC,EAAE,KAAK,GAAG,IAAI;AAEf,MAAAA,QAAO;AACP,MAAAA,QAAO;AAGP,WAAK,OAAO,QAAQ,WAAS;AAC3B,QAAAA,QAAOD,UAAS,YAAY,KAAK;AACjC,QAAAC,QAAOD,UAAS,UAAU,KAAK;AAC/B,QAAAC,QAAOD,UAAS,YAAY,KAAK;AAAA,MACnC,CAAC;AACD,UAAI,WAAW;AACf,WAAK,OAAO,QAAQ,WAAS;AAC3B,YAAI,MAAM,WAAW,UAAU;AAC7B,qBAAW,MAAM;AAAA,QACnB;AAAA,MACF,CAAC;AACD,UAAI,WAAW,GAAG;AAChB,QAAAC,QAAO,gBAAgB,WAAW;AAAA,MACpC;AAEA,UAAI,KAAK,kBAAkB;AACzB,aAAK,iBAAiB,QAAQ,eAAa;AACzC,UAAAA,QAAOD,UAAS,YAAY,SAAS;AAAA,QACvC,CAAC;AAAA,MACH;AAEA,aAAOC;AAAA,IACT;AAIA,IAAAD,UAAS,6BAA6B,SAAS,cAAc;AAC3D,YAAM,qBAAqB,CAAC;AAC5B,YAAM,cAAcA,UAAS,mBAAmB,YAAY;AAC5D,YAAM,SAAS,YAAY,cAAc,QAAQ,KAAK,MAAM;AAC5D,YAAM,YAAY,YAAY,cAAc,QAAQ,QAAQ,MAAM;AAGlE,YAAM,QAAQA,UAAS,YAAY,cAAc,SAAS,EACvD,IAAI,UAAQA,UAAS,eAAe,IAAI,CAAC,EACzC,OAAO,WAAS,MAAM,cAAc,OAAO;AAC9C,YAAM,cAAc,MAAM,SAAS,KAAK,MAAM,CAAC,EAAE;AACjD,UAAI;AAEJ,YAAM,QAAQA,UAAS,YAAY,cAAc,kBAAkB,EAChE,IAAI,UAAQ;AACX,cAAM,QAAQ,KAAK,UAAU,EAAE,EAAE,MAAM,GAAG;AAC1C,eAAO,MAAM,IAAI,UAAQ,SAAS,MAAM,EAAE,CAAC;AAAA,MAC7C,CAAC;AACH,UAAI,MAAM,SAAS,KAAK,MAAM,CAAC,EAAE,SAAS,KAAK,MAAM,CAAC,EAAE,CAAC,MAAM,aAAa;AAC1E,wBAAgB,MAAM,CAAC,EAAE,CAAC;AAAA,MAC5B;AAEA,kBAAY,OAAO,QAAQ,WAAS;AAClC,YAAI,MAAM,KAAK,YAAY,MAAM,SAAS,MAAM,WAAW,KAAK;AAC9D,cAAI,WAAW;AAAA,YACb,MAAM;AAAA,YACN,kBAAkB,SAAS,MAAM,WAAW,KAAK,EAAE;AAAA,UACrD;AACA,cAAI,eAAe,eAAe;AAChC,qBAAS,MAAM,EAAC,MAAM,cAAa;AAAA,UACrC;AACA,6BAAmB,KAAK,QAAQ;AAChC,cAAI,QAAQ;AACV,uBAAW,KAAK,MAAM,KAAK,UAAU,QAAQ,CAAC;AAC9C,qBAAS,MAAM;AAAA,cACb,MAAM;AAAA,cACN,WAAW,YAAY,eAAe;AAAA,YACxC;AACA,+BAAmB,KAAK,QAAQ;AAAA,UAClC;AAAA,QACF;AAAA,MACF,CAAC;AACD,UAAI,mBAAmB,WAAW,KAAK,aAAa;AAClD,2BAAmB,KAAK;AAAA,UACtB,MAAM;AAAA,QACR,CAAC;AAAA,MACH;AAGA,UAAI,YAAYA,UAAS,YAAY,cAAc,IAAI;AACvD,UAAI,UAAU,QAAQ;AACpB,YAAI,UAAU,CAAC,EAAE,QAAQ,SAAS,MAAM,GAAG;AACzC,sBAAY,SAAS,UAAU,CAAC,EAAE,UAAU,CAAC,GAAG,EAAE;AAAA,QACpD,WAAW,UAAU,CAAC,EAAE,QAAQ,OAAO,MAAM,GAAG;AAE9C,sBAAY,SAAS,UAAU,CAAC,EAAE,UAAU,CAAC,GAAG,EAAE,IAAI,MAAO,OACtD,KAAK,KAAK;AAAA,QACnB,OAAO;AACL,sBAAY;AAAA,QACd;AACA,2BAAmB,QAAQ,YAAU;AACnC,iBAAO,aAAa;AAAA,QACtB,CAAC;AAAA,MACH;AACA,aAAO;AAAA,IACT;AAGA,IAAAA,UAAS,sBAAsB,SAAS,cAAc;AACpD,YAAM,iBAAiB,CAAC;AAIxB,YAAM,aAAaA,UAAS,YAAY,cAAc,SAAS,EAC5D,IAAI,UAAQA,UAAS,eAAe,IAAI,CAAC,EACzC,OAAO,SAAO,IAAI,cAAc,OAAO,EAAE,CAAC;AAC7C,UAAI,YAAY;AACd,uBAAe,QAAQ,WAAW;AAClC,uBAAe,OAAO,WAAW;AAAA,MACnC;AAIA,YAAM,QAAQA,UAAS,YAAY,cAAc,cAAc;AAC/D,qBAAe,cAAc,MAAM,SAAS;AAC5C,qBAAe,WAAW,MAAM,WAAW;AAI3C,YAAM,MAAMA,UAAS,YAAY,cAAc,YAAY;AAC3D,qBAAe,MAAM,IAAI,SAAS;AAElC,aAAO;AAAA,IACT;AAEA,IAAAA,UAAS,sBAAsB,SAAS,gBAAgB;AACtD,UAAIC,OAAM;AACV,UAAI,eAAe,aAAa;AAC9B,QAAAA,QAAO;AAAA,MACT;AACA,UAAI,eAAe,KAAK;AACtB,QAAAA,QAAO;AAAA,MACT;AACA,UAAI,eAAe,SAAS,UAAa,eAAe,OAAO;AAC7D,QAAAA,QAAO,YAAY,eAAe,OAChC,YAAY,eAAe,QAAQ;AAAA,MACvC;AACA,aAAOA;AAAA,IACT;AAKA,IAAAD,UAAS,YAAY,SAAS,cAAc;AAC1C,UAAI;AACJ,YAAM,OAAOA,UAAS,YAAY,cAAc,SAAS;AACzD,UAAI,KAAK,WAAW,GAAG;AACrB,gBAAQ,KAAK,CAAC,EAAE,UAAU,CAAC,EAAE,MAAM,GAAG;AACtC,eAAO,EAAC,QAAQ,MAAM,CAAC,GAAG,OAAO,MAAM,CAAC,EAAC;AAAA,MAC3C;AACA,YAAM,QAAQA,UAAS,YAAY,cAAc,SAAS,EACvD,IAAI,UAAQA,UAAS,eAAe,IAAI,CAAC,EACzC,OAAO,eAAa,UAAU,cAAc,MAAM;AACrD,UAAI,MAAM,SAAS,GAAG;AACpB,gBAAQ,MAAM,CAAC,EAAE,MAAM,MAAM,GAAG;AAChC,eAAO,EAAC,QAAQ,MAAM,CAAC,GAAG,OAAO,MAAM,CAAC,EAAC;AAAA,MAC3C;AAAA,IACF;AAKA,IAAAA,UAAS,uBAAuB,SAAS,cAAc;AACrD,YAAM,QAAQA,UAAS,WAAW,YAAY;AAC9C,YAAM,cAAcA,UAAS,YAAY,cAAc,qBAAqB;AAC5E,UAAI;AACJ,UAAI,YAAY,SAAS,GAAG;AAC1B,yBAAiB,SAAS,YAAY,CAAC,EAAE,UAAU,EAAE,GAAG,EAAE;AAAA,MAC5D;AACA,UAAI,MAAM,cAAc,GAAG;AACzB,yBAAiB;AAAA,MACnB;AACA,YAAM,WAAWA,UAAS,YAAY,cAAc,cAAc;AAClE,UAAI,SAAS,SAAS,GAAG;AACvB,eAAO;AAAA,UACL,MAAM,SAAS,SAAS,CAAC,EAAE,UAAU,EAAE,GAAG,EAAE;AAAA,UAC5C,UAAU,MAAM;AAAA,UAChB;AAAA,QACF;AAAA,MACF;AACA,YAAM,eAAeA,UAAS,YAAY,cAAc,YAAY;AACpE,UAAI,aAAa,SAAS,GAAG;AAC3B,cAAM,QAAQ,aAAa,CAAC,EACzB,UAAU,EAAE,EACZ,MAAM,GAAG;AACZ,eAAO;AAAA,UACL,MAAM,SAAS,MAAM,CAAC,GAAG,EAAE;AAAA,UAC3B,UAAU,MAAM,CAAC;AAAA,UACjB;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAOA,IAAAA,UAAS,uBAAuB,SAAS,OAAO,MAAM;AACpD,UAAI,SAAS,CAAC;AACd,UAAI,MAAM,aAAa,aAAa;AAClC,iBAAS;AAAA,UACP,OAAO,MAAM,OAAO,QAAQ,MAAM,WAAW,MAAM,KAAK,WAAW;AAAA,UACnE;AAAA,UACA,iBAAiB,KAAK,OAAO;AAAA,QAC/B;AAAA,MACF,OAAO;AACL,iBAAS;AAAA,UACP,OAAO,MAAM,OAAO,QAAQ,MAAM,WAAW,MAAM,KAAK,OAAO;AAAA,UAC/D;AAAA,UACA,eAAe,KAAK,OAAO,MAAM,KAAK,WAAW;AAAA,QACnD;AAAA,MACF;AACA,UAAI,KAAK,mBAAmB,QAAW;AACrC,eAAO,KAAK,wBAAwB,KAAK,iBAAiB,MAAM;AAAA,MAClE;AACA,aAAO,OAAO,KAAK,EAAE;AAAA,IACvB;AAMA,IAAAA,UAAS,oBAAoB,WAAW;AACtC,aAAO,KAAK,OAAO,EAAE,SAAS,EAAE,OAAO,GAAG,EAAE;AAAA,IAC9C;AAOA,IAAAA,UAAS,0BAA0B,SAAS,QAAQ,SAAS,UAAU;AACrE,UAAI;AACJ,YAAM,UAAU,YAAY,SAAY,UAAU;AAClD,UAAI,QAAQ;AACV,oBAAY;AAAA,MACd,OAAO;AACL,oBAAYA,UAAS,kBAAkB;AAAA,MACzC;AACA,YAAM,OAAO,YAAY;AAEzB,aAAO,cACI,OAAO,MAAM,YAAY,MAAM,UACpC;AAAA,IAGR;AAGA,IAAAA,UAAS,eAAe,SAAS,cAAc,aAAa;AAE1D,YAAM,QAAQA,UAAS,WAAW,YAAY;AAC9C,eAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACrC,gBAAQ,MAAM,CAAC,GAAG;AAAA,UAChB,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AACH,mBAAO,MAAM,CAAC,EAAE,UAAU,CAAC;AAAA,UAC7B;AAAA,QAEF;AAAA,MACF;AACA,UAAI,aAAa;AACf,eAAOA,UAAS,aAAa,WAAW;AAAA,MAC1C;AACA,aAAO;AAAA,IACT;AAEA,IAAAA,UAAS,UAAU,SAAS,cAAc;AACxC,YAAM,QAAQA,UAAS,WAAW,YAAY;AAC9C,YAAM,QAAQ,MAAM,CAAC,EAAE,MAAM,GAAG;AAChC,aAAO,MAAM,CAAC,EAAE,UAAU,CAAC;AAAA,IAC7B;AAEA,IAAAA,UAAS,aAAa,SAAS,cAAc;AAC3C,aAAO,aAAa,MAAM,KAAK,CAAC,EAAE,CAAC,MAAM;AAAA,IAC3C;AAEA,IAAAA,UAAS,aAAa,SAAS,cAAc;AAC3C,YAAM,QAAQA,UAAS,WAAW,YAAY;AAC9C,YAAM,QAAQ,MAAM,CAAC,EAAE,UAAU,CAAC,EAAE,MAAM,GAAG;AAC7C,aAAO;AAAA,QACL,MAAM,MAAM,CAAC;AAAA,QACb,MAAM,SAAS,MAAM,CAAC,GAAG,EAAE;AAAA,QAC3B,UAAU,MAAM,CAAC;AAAA,QACjB,KAAK,MAAM,MAAM,CAAC,EAAE,KAAK,GAAG;AAAA,MAC9B;AAAA,IACF;AAEA,IAAAA,UAAS,aAAa,SAAS,cAAc;AAC3C,YAAM,OAAOA,UAAS,YAAY,cAAc,IAAI,EAAE,CAAC;AACvD,YAAM,QAAQ,KAAK,UAAU,CAAC,EAAE,MAAM,GAAG;AACzC,aAAO;AAAA,QACL,UAAU,MAAM,CAAC;AAAA,QACjB,WAAW,MAAM,CAAC;AAAA,QAClB,gBAAgB,SAAS,MAAM,CAAC,GAAG,EAAE;AAAA,QACrC,SAAS,MAAM,CAAC;AAAA,QAChB,aAAa,MAAM,CAAC;AAAA,QACpB,SAAS,MAAM,CAAC;AAAA,MAClB;AAAA,IACF;AAGA,IAAAA,UAAS,aAAa,SAAS,MAAM;AACnC,UAAI,OAAO,SAAS,YAAY,KAAK,WAAW,GAAG;AACjD,eAAO;AAAA,MACT;AACA,YAAM,QAAQA,UAAS,WAAW,IAAI;AACtC,eAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACrC,YAAI,MAAM,CAAC,EAAE,SAAS,KAAK,MAAM,CAAC,EAAE,OAAO,CAAC,MAAM,KAAK;AACrD,iBAAO;AAAA,QACT;AAAA,MAEF;AACA,aAAO;AAAA,IACT;AAGA,QAAI,OAAO,WAAW,UAAU;AAC9B,aAAO,UAAUA;AAAA,IACnB;AAAA;AAAA;;;ACjyBA;AAAA;AAAA;AAAA,QAAI,UAAU,OAAO,UAAU;AAAA,MAC7B,GAAG,CAAC;AAAA,QACF,MAAM;AAAA,QACN,KAAK;AAAA,MACP,CAAC;AAAA,MACD,GAAG,CAAC;AAAA;AAAA;AAAA,QAGF,MAAM;AAAA,QACN,KAAK;AAAA,QACL,OAAO,CAAC,YAAY,aAAa,kBAAkB,WAAW,SAAS,SAAS;AAAA,QAChF,QAAQ;AAAA,MACV,CAAC;AAAA;AAAA,MAED,GAAG,CAAC,EAAE,MAAM,OAAO,CAAC;AAAA,MACpB,GAAG,CAAC,EAAE,MAAM,cAAc,CAAC;AAAA,MAC3B,GAAG,CAAC,EAAE,MAAM,MAAM,CAAC;AAAA,MACnB,GAAG,CAAC,EAAE,MAAM,QAAQ,CAAC;AAAA,MACrB,GAAG,CAAC,EAAE,MAAM,QAAQ,CAAC;AAAA,MACrB,GAAG,CAAC,EAAE,MAAM,YAAY,CAAC;AAAA;AAAA,MACzB,GAAG,CAAC,EAAE,MAAM,UAAU,CAAC;AAAA;AAAA;AAAA,MAEvB,GAAG,CAAC;AAAA;AAAA,QAEF,MAAM;AAAA,QACN,KAAK;AAAA,QACL,OAAO,CAAC,SAAS,MAAM;AAAA,QACvB,QAAQ;AAAA,MACV,CAAC;AAAA,MACD,GAAG,CAAC;AAAA;AAAA,QAEF,MAAM;AAAA,QACN,KAAK;AAAA,QACL,OAAO,CAAC,WAAW,IAAI;AAAA,QACvB,QAAQ;AAAA,MACV,CAAC;AAAA,MACD,GAAG,CAAC;AAAA;AAAA,QAEF,MAAM;AAAA,QACN,KAAK;AAAA,QACL,OAAO,CAAC,QAAQ,OAAO;AAAA,QACvB,QAAQ;AAAA,MACV,CAAC;AAAA,MACD,GAAG,CAAC;AAAA;AAAA;AAAA;AAAA,QAIF,KAAK;AAAA,QACL,OAAO,CAAC,QAAQ,QAAQ,YAAY,UAAU;AAAA,QAC9C,QAAQ;AAAA,MACV,CAAC;AAAA,MACD,GAAG;AAAA,QACD;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,WAAW,SAAS,QAAQ,UAAU;AAAA,UAC9C,QAAQ,SAAU,GAAG;AACnB,mBAAQ,EAAE,WACN,uBACA,EAAE,OACA,oBACA;AAAA,UACR;AAAA,QACF;AAAA,QACA;AAAA;AAAA;AAAA,UAGE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,WAAW,QAAQ;AAAA,UAC3B,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,QAAQ,WAAW,SAAS,SAAS;AAAA,UAC7C,QAAQ,SAAU,GAAG;AACnB,mBAAQ,EAAE,WAAW,OACjB,uBACA;AAAA,UACN;AAAA,QACF;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,WAAW,OAAO;AAAA,UAC1B,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,WAAW,QAAQ,SAAS;AAAA,UACpC,QAAQ,SAAU,GAAG;AACnB,mBAAQ,EAAE,WAAW,OACjB,qBACA;AAAA,UACN;AAAA,QACF;AAAA,QACA;AAAA;AAAA;AAAA;AAAA,UAIE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,SAAS,aAAa,eAAe,OAAO,QAAQ;AAAA,UAC5D,QAAQ,SAAU,GAAG;AACnB,mBACE,eACC,EAAE,YAAY,QAAQ,SACtB,EAAE,aAAa,IAAI,QAAQ,QAC5B,SACC,EAAE,SAAS,QAAQ;AAAA,UAExB;AAAA,QACF;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,QACP;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,MAAM,SAAS,UAAU,eAAe;AAAA,UAChD,QAAQ,SAAU,GAAG;AACnB,mBAAQ,EAAE,iBAAiB,OACvB,uBACA;AAAA,UACN;AAAA,QACF;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,QACP;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,QACP;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,QAAQ,MAAM;AAAA,UACtB,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAME,MAAK;AAAA,UACL,KAAK;AAAA,UACL,OAAO,CAAC,cAAc,aAAa,aAAa,YAAY,MAAM,QAAQ,QAAQ,SAAS,SAAS,WAAW,cAAc,cAAc,cAAc;AAAA,UACzJ,QAAQ,SAAU,GAAG;AACnB,gBAAI,MAAM;AAEV,mBAAQ,EAAE,SAAS,OAAQ,uBAAuB;AAGlD,mBAAQ,EAAE,WAAW,OAAQ,gBAAgB;AAE7C,gBAAI,EAAE,cAAc,MAAM;AACxB,qBAAO;AAAA,YACT;AAEA,mBAAQ,EAAE,YAAY,KAAK,OAAQ,mBAAmB;AACtD,mBAAQ,EAAE,cAAc,KAAK,OAAQ,qBAAqB;AAC1D,mBAAO;AAAA,UACT;AAAA,QACF;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,QACP;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,MAAM,aAAa,OAAO;AAAA,UAClC,QAAQ,SAAU,GAAG;AACnB,gBAAI,MAAM;AACV,gBAAI,EAAE,aAAa,MAAM;AACvB,qBAAO;AACP,kBAAI,EAAE,SAAS,MAAM;AACnB,uBAAO;AAAA,cACT;AAAA,YACF;AACA,mBAAO;AAAA,UACT;AAAA,QACF;AAAA,QACA;AAAA;AAAA;AAAA,UAGE,MAAM;AAAA;AAAA,UAEN,KAAK;AAAA,UACL,OAAO,CAAC,aAAa,OAAO;AAAA,UAC5B,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,YAAY,OAAO;AAAA,UAC3B,QAAQ;AAAA;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,QAAQ,MAAM;AAAA,UACtB,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,QACP;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,QACP;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,iBAAiB,OAAO,gBAAgB;AAAA,UAChD,QAAQ,SAAU,GAAG;AACnB,mBAAQ,EAAE,kBAAkB,OACxB,qBACA;AAAA,UACN;AAAA,QACF;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,MAAM,aAAa,QAAQ;AAAA,UACnC,QAAQ,SAAU,GAAG;AACnB,mBAAQ,EAAE,SAAU,iBAAiB;AAAA,UACvC;AAAA,QACF;AAAA,QACA;AAAA;AAAA;AAAA;AAAA,UAIE,MAAM;AAAA,UACN,KAAK,IAAI;AAAA;AAAA,YAEP;AAAA,UAKF;AAAA,UACA,OAAO,CAAC,MAAM,QAAQ,UAAU,QAAQ,QAAQ;AAAA,UAChD,QAAQ,SAAU,GAAG;AACnB,mBAAO,wBAAwB,EAAE,OAAO,WAAW;AAAA,UACrD;AAAA,QACF;AAAA,QACA;AAAA;AAAA;AAAA,UAGE,MAAM;AAAA,UACN,KAAK,IAAI;AAAA;AAAA,YAEP;AAAA,UAOF;AAAA,UACA,OAAO,CAAC,QAAQ,SAAS,QAAQ,OAAO;AAAA,UACxC,QAAQ,SAAU,GAAG;AACnB,mBAAO,qBAAqB,EAAE,OAAO,WAAW;AAAA,UAClD;AAAA,QACF;AAAA,QACA;AAAA;AAAA;AAAA;AAAA;AAAA,UAKE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,OAAO;AAAA,UACf,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA;AAAA,UAGE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA;AAAA,UAGE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,cAAc,WAAW,gBAAgB,eAAe,SAAS;AAAA,UACzE,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,QACP;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA;AAAA,UAGE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA;AAAA,UAGE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA;AAAA,UAGE,MAAK;AAAA,UACL,KAAK;AAAA,UACL,OAAO,CAAC,UAAU,WAAW;AAAA,UAC7B,QAAQ,SAAU,GAAG;AACnB,mBAAO,kBAAkB,EAAE,aAAa,OAAO,QAAQ;AAAA,UACzD;AAAA,QACF;AAAA,QACA;AAAA;AAAA;AAAA,UAGE,MAAK;AAAA,UACL,KAAK;AAAA,UACL,OAAO,CAAC,MAAM,kBAAkB,mBAAmB,iBAAiB,iBAAiB;AAAA,UACrF,QAAQ,SAAU,GAAG;AACnB,gBAAI,MAAM;AACV,mBAAQ,EAAE,MAAM,OAAO,aAAa;AACpC,mBAAQ,EAAE,mBAAmB,OAAO,QAAQ;AAC5C,mBAAQ,EAAE,iBAAiB,OAAO,aAAa;AAC/C,mBAAQ,EAAE,mBAAmB,OAAO,QAAQ;AAC5C,mBAAO;AAAA,UACT;AAAA,QACF;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA;AAAA,QAEA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,KAAK;AAAA,UACL,OAAO,CAAC,MAAM,SAAS;AAAA,UACvB,QAAQ;AAAA,QACV;AAAA,QACA;AAAA;AAAA,UAEE,MAAM;AAAA,UACN,OAAO,CAAC,OAAO;AAAA,QACjB;AAAA,MACF;AAAA,IACF;AAGA,WAAO,KAAK,OAAO,EAAE,QAAQ,SAAU,KAAK;AAC1C,UAAI,OAAO,QAAQ,GAAG;AACtB,WAAK,QAAQ,SAAU,KAAK;AAC1B,YAAI,CAAC,IAAI,KAAK;AACZ,cAAI,MAAM;AAAA,QACZ;AACA,YAAI,CAAC,IAAI,QAAQ;AACf,cAAI,SAAS;AAAA,QACf;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAAA;AAAA;;;AC7eD;AAAA;AAAA;AAAA,QAAI,aAAa,SAAU,GAAG;AAC5B,aAAO,OAAO,OAAO,CAAC,CAAC,MAAM,IAAI,OAAO,CAAC,IAAI;AAAA,IAC/C;AAEA,QAAI,mBAAmB,SAAUI,SAAO,UAAU,OAAO,SAAS;AAChE,UAAI,WAAW,CAAC,OAAO;AACrB,iBAAS,OAAO,IAAI,WAAWA,QAAM,CAAC,CAAC;AAAA,MACzC,OACK;AACH,iBAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK,GAAG;AACxC,cAAIA,QAAM,IAAE,CAAC,KAAK,MAAM;AACtB,qBAAS,MAAM,CAAC,CAAC,IAAI,WAAWA,QAAM,IAAE,CAAC,CAAC;AAAA,UAC5C;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAEA,QAAI,WAAW,SAAU,KAAK,UAAU,SAAS;AAC/C,UAAI,aAAa,IAAI,QAAQ,IAAI;AACjC,UAAI,IAAI,QAAQ,CAAC,SAAS,IAAI,IAAI,GAAG;AACnC,iBAAS,IAAI,IAAI,IAAI,CAAC;AAAA,MACxB,WACS,cAAc,CAAC,SAAS,IAAI,IAAI,GAAG;AAC1C,iBAAS,IAAI,IAAI,IAAI,CAAC;AAAA,MACxB;AACA,UAAI,cAAc,IAAI,OACpB,CAAC;AAAA;AAAA,QACD,aAAa,SAAS,IAAI,IAAI,IAAI;AAAA;AAEpC,uBAAiB,QAAQ,MAAM,IAAI,GAAG,GAAG,aAAa,IAAI,OAAO,IAAI,IAAI;AAEzE,UAAI,IAAI,MAAM;AACZ,iBAAS,IAAI,IAAI,EAAE,KAAK,WAAW;AAAA,MACrC;AAAA,IACF;AAEA,QAAI,UAAU;AACd,QAAI,YAAY,OAAO,UAAU,KAAK,KAAK,eAAe;AAE1D,YAAQ,QAAQ,SAAUC,MAAK;AAC7B,UAAI,UAAU,CAAC,GACX,QAAQ,CAAC,GACT,WAAW;AAGf,MAAAA,KAAI,MAAM,cAAc,EAAE,OAAO,SAAS,EAAE,QAAQ,SAAUC,IAAG;AAC/D,YAAI,OAAOA,GAAE,CAAC;AACd,YAAI,UAAUA,GAAE,MAAM,CAAC;AACvB,YAAI,SAAS,KAAK;AAChB,gBAAM,KAAK,EAAC,KAAK,CAAC,GAAG,MAAM,CAAC,EAAC,CAAC;AAC9B,qBAAW,MAAM,MAAM,SAAO,CAAC;AAAA,QACjC;AAEA,iBAASC,KAAI,GAAGA,MAAK,QAAQ,IAAI,KAAK,CAAC,GAAG,QAAQA,MAAK,GAAG;AACxD,cAAI,MAAM,QAAQ,IAAI,EAAEA,EAAC;AACzB,cAAI,IAAI,IAAI,KAAK,OAAO,GAAG;AACzB,mBAAO,SAAS,KAAK,UAAU,OAAO;AAAA,UACxC;AAAA,QACF;AAAA,MACF,CAAC;AAED,cAAQ,QAAQ;AAChB,aAAO;AAAA,IACT;AAEA,QAAI,eAAe,SAAU,KAAK,MAAM;AACtC,UAAI,IAAI,KAAK,MAAM,SAAS,CAAC;AAC7B,UAAI,EAAE,WAAW,GAAG;AAClB,YAAI,EAAE,CAAC,CAAC,IAAI,WAAW,EAAE,CAAC,CAAC;AAAA,MAC7B,WAAW,EAAE,WAAW,KAAK,KAAK,SAAS,GAAG;AAC5C,YAAI,EAAE,CAAC,CAAC,IAAI;AAAA,MACd;AACA,aAAO;AAAA,IACT;AAEA,YAAQ,cAAc,SAAU,KAAK;AACnC,aAAO,IAAI,MAAM,MAAM,EAAE,OAAO,cAAc,CAAC,CAAC;AAAA,IAClD;AAGA,YAAQ,kBAAkB,QAAQ;AAElC,YAAQ,gBAAgB,SAAU,KAAK;AACrC,aAAO,IAAI,SAAS,EAAE,MAAM,GAAG,EAAE,IAAI,MAAM;AAAA,IAC7C;AAEA,YAAQ,wBAAwB,SAAU,KAAK;AAC7C,UAAI,aAAa,CAAC;AAClB,UAAI,QAAQ,IAAI,MAAM,GAAG,EAAE,IAAI,UAAU;AACzC,eAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK,GAAG;AACxC,mBAAW,KAAK;AAAA,UACd,WAAW,MAAM,CAAC;AAAA,UAClB,IAAI,MAAM,IAAI,CAAC;AAAA,UACf,MAAM,MAAM,IAAI,CAAC;AAAA,QACnB,CAAC;AAAA,MACH;AACA,aAAO;AAAA,IACT;AAEA,YAAQ,uBAAuB,SAAU,KAAK;AAC5C,aAAO,IAAI,MAAM,GAAG,EAAE,IAAI,SAAU,MAAM;AACxC,eAAO,KAAK,UAAU,GAAG,KAAK,SAAO,CAAC,EAAE,MAAM,GAAG,EAAE,OAAO,cAAc,CAAC,CAAC;AAAA,MAC5E,CAAC;AAAA,IACH;AAEA,YAAQ,2BAA2B,SAAU,KAAK;AAChD,aAAO,IAAI,MAAM,GAAG,EAAE,IAAI,SAAU,QAAQ;AAC1C,eAAO,OAAO,MAAM,GAAG,EAAE,IAAI,SAAU,QAAQ;AAC7C,cAAI,MAAM,SAAS;AAEnB,cAAI,OAAO,CAAC,MAAM,KAAK;AACrB,mBAAO,WAAW,MAAM;AAAA,UAC1B,OAAO;AACL,mBAAO,WAAW,OAAO,UAAU,GAAG,OAAO,MAAM,CAAC;AACpD,qBAAS;AAAA,UACX;AAEA,iBAAO;AAAA,YACL;AAAA,YACA;AAAA,UACF;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAAA,IACH;AAAA;AAAA;;;AC3HA;AAAA;AAAA;AAAA,QAAI,UAAU;AAGd,QAAI,eAAe;AACnB,QAAI,SAAS,SAAU,WAAW;AAChC,UAAI,IAAI;AACR,UAAI,OAAO;AACX,UAAI,MAAM,KAAK;AACf,aAAO,UAAU,QAAQ,cAAc,SAAU,GAAG;AAClD,YAAI,KAAK,KAAK;AACZ,iBAAO;AAAA,QACT;AACA,YAAI,MAAM,KAAK,CAAC;AAChB,aAAK;AACL,gBAAQ,GAAG;AAAA,UACX,KAAK;AACH,mBAAO;AAAA,UACT,KAAK;AACH,mBAAO,OAAO,GAAG;AAAA,UACnB,KAAK;AACH,mBAAO,OAAO,GAAG;AAAA,UACnB,KAAK;AACH,mBAAO;AAAA,QACT;AAAA,MACF,CAAC;AAAA,IAEH;AAEA,QAAI,WAAW,SAAU,MAAM,KAAK,UAAU;AAC5C,UAAI,MAAM,IAAI,kBAAkB,WAC7B,IAAI,OAAO,IAAI,OAAO,WAAW,SAAS,IAAI,IAAI,CAAC,IACpD,IAAI;AAEN,UAAI,OAAO,CAAC,OAAO,MAAM,GAAG;AAC5B,UAAI,IAAI,OAAO;AACb,iBAAS,IAAI,GAAG,IAAI,IAAI,MAAM,QAAQ,KAAK,GAAG;AAC5C,cAAI,IAAI,IAAI,MAAM,CAAC;AACnB,cAAI,IAAI,MAAM;AACZ,iBAAK,KAAK,SAAS,IAAI,IAAI,EAAE,CAAC,CAAC;AAAA,UACjC,OACK;AACH,iBAAK,KAAK,SAAS,IAAI,MAAM,CAAC,CAAC,CAAC;AAAA,UAClC;AAAA,QACF;AAAA,MACF,OACK;AACH,aAAK,KAAK,SAAS,IAAI,IAAI,CAAC;AAAA,MAC9B;AACA,aAAO,OAAO,MAAM,MAAM,IAAI;AAAA,IAChC;AAIA,QAAI,oBAAoB;AAAA,MACtB;AAAA,MAAK;AAAA,MAAK;AAAA,MAAK;AAAA,MACf;AAAA,MAAK;AAAA,MAAK;AAAA,MAAK;AAAA,MACf;AAAA,MAAK;AAAA,MAAK;AAAA,MAAK;AAAA,MAAK;AAAA,IACtB;AACA,QAAI,oBAAoB,CAAC,KAAK,KAAK,KAAK,GAAG;AAG3C,WAAO,UAAU,SAAU,SAAS,MAAM;AACxC,aAAO,QAAQ,CAAC;AAEhB,UAAI,QAAQ,WAAW,MAAM;AAC3B,gBAAQ,UAAU;AAAA,MACpB;AACA,UAAI,QAAQ,QAAQ,MAAM;AACxB,gBAAQ,OAAO;AAAA,MACjB;AACA,cAAQ,MAAM,QAAQ,SAAU,OAAO;AACrC,YAAI,MAAM,YAAY,MAAM;AAC1B,gBAAM,WAAW;AAAA,QACnB;AAAA,MACF,CAAC;AAED,UAAI,aAAa,KAAK,cAAc;AACpC,UAAI,aAAa,KAAK,cAAc;AACpC,UAAIC,OAAM,CAAC;AAGX,iBAAW,QAAQ,SAAU,MAAM;AACjC,gBAAQ,IAAI,EAAE,QAAQ,SAAU,KAAK;AACnC,cAAI,IAAI,QAAQ,WAAW,QAAQ,IAAI,IAAI,KAAK,MAAM;AACpD,YAAAA,KAAI,KAAK,SAAS,MAAM,KAAK,OAAO,CAAC;AAAA,UACvC,WACS,IAAI,QAAQ,WAAW,QAAQ,IAAI,IAAI,KAAK,MAAM;AACzD,oBAAQ,IAAI,IAAI,EAAE,QAAQ,SAAU,IAAI;AACtC,cAAAA,KAAI,KAAK,SAAS,MAAM,KAAK,EAAE,CAAC;AAAA,YAClC,CAAC;AAAA,UACH;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAGD,cAAQ,MAAM,QAAQ,SAAU,OAAO;AACrC,QAAAA,KAAI,KAAK,SAAS,KAAK,QAAQ,EAAE,CAAC,GAAG,KAAK,CAAC;AAE3C,mBAAW,QAAQ,SAAU,MAAM;AACjC,kBAAQ,IAAI,EAAE,QAAQ,SAAU,KAAK;AACnC,gBAAI,IAAI,QAAQ,SAAS,MAAM,IAAI,IAAI,KAAK,MAAM;AAChD,cAAAA,KAAI,KAAK,SAAS,MAAM,KAAK,KAAK,CAAC;AAAA,YACrC,WACS,IAAI,QAAQ,SAAS,MAAM,IAAI,IAAI,KAAK,MAAM;AACrD,oBAAM,IAAI,IAAI,EAAE,QAAQ,SAAU,IAAI;AACpC,gBAAAA,KAAI,KAAK,SAAS,MAAM,KAAK,EAAE,CAAC;AAAA,cAClC,CAAC;AAAA,YACH;AAAA,UACF,CAAC;AAAA,QACH,CAAC;AAAA,MACH,CAAC;AAED,aAAOA,KAAI,KAAK,MAAM,IAAI;AAAA,IAC5B;AAAA;AAAA;;;ACjHA;AAAA;AAAA;AAAA,QAAI,SAAS;AACb,QAAI,SAAS;AAEb,YAAQ,QAAQ;AAChB,YAAQ,QAAQ,OAAO;AACvB,YAAQ,cAAc,OAAO;AAC7B,YAAQ,kBAAkB,OAAO;AACjC,YAAQ,gBAAgB,OAAO;AAC/B,YAAQ,wBAAwB,OAAO;AACvC,YAAQ,uBAAuB,OAAO;AACtC,YAAQ,2BAA2B,OAAO;AAAA;AAAA;;;ACV1C;AAAA;AAAA;AAAA;AASa,QAAIC,KAAE,eAAa,OAAO,UAAQ,OAAO;AAAzC,QAA6CC,KAAED,KAAE,OAAO,IAAI,eAAe,IAAE;AAA7E,QAAmF,IAAEA,KAAE,OAAO,IAAI,cAAc,IAAE;AAAlH,QAAwH,IAAEA,KAAE,OAAO,IAAI,gBAAgB,IAAE;AAAzJ,QAA+JE,KAAEF,KAAE,OAAO,IAAI,mBAAmB,IAAE;AAAnM,QAAyM,IAAEA,KAAE,OAAO,IAAI,gBAAgB,IAAE;AAA1O,QAAgPG,KAAEH,KAAE,OAAO,IAAI,gBAAgB,IAAE;AAAjR,QAAuR,IAAEA,KAAE,OAAO,IAAI,eAAe,IAAE;AAAvT,QAA6TI,KAAEJ,KAAE,OAAO,IAAI,kBAAkB,IAAE;AAAhW,QAAsW,IAAEA,KAAE,OAAO,IAAI,uBAAuB,IAAE;AAA9Y,QAAoZ,IAAEA,KAAE,OAAO,IAAI,mBAAmB,IAAE;AAAxb,QAA8b,IAAEA,KAAE,OAAO,IAAI,gBAAgB,IAAE;AAA/d,QAAqe,IAAEA,KACpf,OAAO,IAAI,qBAAqB,IAAE;AADrB,QAC2B,IAAEA,KAAE,OAAO,IAAI,YAAY,IAAE;AADxD,QAC8D,IAAEA,KAAE,OAAO,IAAI,YAAY,IAAE;AAD3F,QACiG,IAAEA,KAAE,OAAO,IAAI,aAAa,IAAE;AAD/H,QACqI,IAAEA,KAAE,OAAO,IAAI,mBAAmB,IAAE;AADzK,QAC+K,IAAEA,KAAE,OAAO,IAAI,iBAAiB,IAAE;AADjN,QACuNK,KAAEL,KAAE,OAAO,IAAI,aAAa,IAAE;AAClQ,aAASM,GAAEC,IAAE;AAAC,UAAG,aAAW,OAAOA,MAAG,SAAOA,IAAE;AAAC,YAAI,IAAEA,GAAE;AAAS,gBAAO,GAAE;AAAA,UAAC,KAAKN;AAAE,oBAAOM,KAAEA,GAAE,MAAKA,IAAE;AAAA,cAAC,KAAKH;AAAA,cAAE,KAAK;AAAA,cAAE,KAAK;AAAA,cAAE,KAAK;AAAA,cAAE,KAAKF;AAAA,cAAE,KAAK;AAAE,uBAAOK;AAAA,cAAE;AAAQ,wBAAOA,KAAEA,MAAGA,GAAE,UAASA,IAAE;AAAA,kBAAC,KAAK;AAAA,kBAAE,KAAK;AAAA,kBAAE,KAAK;AAAA,kBAAE,KAAK;AAAA,kBAAE,KAAKJ;AAAE,2BAAOI;AAAA,kBAAE;AAAQ,2BAAO;AAAA,gBAAC;AAAA,YAAC;AAAA,UAAC,KAAK;AAAE,mBAAO;AAAA,QAAC;AAAA,MAAC;AAAA,IAAC;AAAC,aAAS,EAAEA,IAAE;AAAC,aAAOD,GAAEC,EAAC,MAAI;AAAA,IAAC;AAAC,YAAQ,YAAUH;AAAE,YAAQ,iBAAe;AAAE,YAAQ,kBAAgB;AAAE,YAAQ,kBAAgBD;AAAE,YAAQ,UAAQF;AAAE,YAAQ,aAAW;AAAE,YAAQ,WAAS;AAAE,YAAQ,OAAK;AAAE,YAAQ,OAAK;AAAE,YAAQ,SAAO;AAChf,YAAQ,WAAS;AAAE,YAAQ,aAAWC;AAAE,YAAQ,WAAS;AAAE,YAAQ,cAAY,SAASK,IAAE;AAAC,aAAO,EAAEA,EAAC,KAAGD,GAAEC,EAAC,MAAIH;AAAA,IAAC;AAAE,YAAQ,mBAAiB;AAAE,YAAQ,oBAAkB,SAASG,IAAE;AAAC,aAAOD,GAAEC,EAAC,MAAI;AAAA,IAAC;AAAE,YAAQ,oBAAkB,SAASA,IAAE;AAAC,aAAOD,GAAEC,EAAC,MAAIJ;AAAA,IAAC;AAAE,YAAQ,YAAU,SAASI,IAAE;AAAC,aAAM,aAAW,OAAOA,MAAG,SAAOA,MAAGA,GAAE,aAAWN;AAAA,IAAC;AAAE,YAAQ,eAAa,SAASM,IAAE;AAAC,aAAOD,GAAEC,EAAC,MAAI;AAAA,IAAC;AAAE,YAAQ,aAAW,SAASA,IAAE;AAAC,aAAOD,GAAEC,EAAC,MAAI;AAAA,IAAC;AAAE,YAAQ,SAAO,SAASA,IAAE;AAAC,aAAOD,GAAEC,EAAC,MAAI;AAAA,IAAC;AAC1d,YAAQ,SAAO,SAASA,IAAE;AAAC,aAAOD,GAAEC,EAAC,MAAI;AAAA,IAAC;AAAE,YAAQ,WAAS,SAASA,IAAE;AAAC,aAAOD,GAAEC,EAAC,MAAI;AAAA,IAAC;AAAE,YAAQ,aAAW,SAASA,IAAE;AAAC,aAAOD,GAAEC,EAAC,MAAI;AAAA,IAAC;AAAE,YAAQ,eAAa,SAASA,IAAE;AAAC,aAAOD,GAAEC,EAAC,MAAIL;AAAA,IAAC;AAAE,YAAQ,aAAW,SAASK,IAAE;AAAC,aAAOD,GAAEC,EAAC,MAAI;AAAA,IAAC;AAC1O,YAAQ,qBAAmB,SAASA,IAAE;AAAC,aAAM,aAAW,OAAOA,MAAG,eAAa,OAAOA,MAAGA,OAAI,KAAGA,OAAI,KAAGA,OAAI,KAAGA,OAAIL,MAAGK,OAAI,KAAGA,OAAI,KAAG,aAAW,OAAOA,MAAG,SAAOA,OAAIA,GAAE,aAAW,KAAGA,GAAE,aAAW,KAAGA,GAAE,aAAWJ,MAAGI,GAAE,aAAW,KAAGA,GAAE,aAAW,KAAGA,GAAE,aAAW,KAAGA,GAAE,aAAW,KAAGA,GAAE,aAAWF,MAAGE,GAAE,aAAW;AAAA,IAAE;AAAE,YAAQ,SAAOD;AAAA;AAAA;;;ACdnU;AAAA;AAAA;AAAA;AAaA,QAAI,2BAAY,aAAa,cAAc;AACzC,OAAC,WAAW;AACd;AAIA,YAAI,YAAY,OAAO,WAAW,cAAc,OAAO;AACvD,YAAI,qBAAqB,YAAY,OAAO,IAAI,eAAe,IAAI;AACnE,YAAI,oBAAoB,YAAY,OAAO,IAAI,cAAc,IAAI;AACjE,YAAI,sBAAsB,YAAY,OAAO,IAAI,gBAAgB,IAAI;AACrE,YAAI,yBAAyB,YAAY,OAAO,IAAI,mBAAmB,IAAI;AAC3E,YAAI,sBAAsB,YAAY,OAAO,IAAI,gBAAgB,IAAI;AACrE,YAAI,sBAAsB,YAAY,OAAO,IAAI,gBAAgB,IAAI;AACrE,YAAI,qBAAqB,YAAY,OAAO,IAAI,eAAe,IAAI;AAGnE,YAAI,wBAAwB,YAAY,OAAO,IAAI,kBAAkB,IAAI;AACzE,YAAI,6BAA6B,YAAY,OAAO,IAAI,uBAAuB,IAAI;AACnF,YAAI,yBAAyB,YAAY,OAAO,IAAI,mBAAmB,IAAI;AAC3E,YAAI,sBAAsB,YAAY,OAAO,IAAI,gBAAgB,IAAI;AACrE,YAAI,2BAA2B,YAAY,OAAO,IAAI,qBAAqB,IAAI;AAC/E,YAAI,kBAAkB,YAAY,OAAO,IAAI,YAAY,IAAI;AAC7D,YAAI,kBAAkB,YAAY,OAAO,IAAI,YAAY,IAAI;AAC7D,YAAI,mBAAmB,YAAY,OAAO,IAAI,aAAa,IAAI;AAC/D,YAAI,yBAAyB,YAAY,OAAO,IAAI,mBAAmB,IAAI;AAC3E,YAAI,uBAAuB,YAAY,OAAO,IAAI,iBAAiB,IAAI;AACvE,YAAI,mBAAmB,YAAY,OAAO,IAAI,aAAa,IAAI;AAE/D,iBAAS,mBAAmB,MAAM;AAChC,iBAAO,OAAO,SAAS,YAAY,OAAO,SAAS;AAAA,UACnD,SAAS,uBAAuB,SAAS,8BAA8B,SAAS,uBAAuB,SAAS,0BAA0B,SAAS,uBAAuB,SAAS,4BAA4B,OAAO,SAAS,YAAY,SAAS,SAAS,KAAK,aAAa,mBAAmB,KAAK,aAAa,mBAAmB,KAAK,aAAa,uBAAuB,KAAK,aAAa,sBAAsB,KAAK,aAAa,0BAA0B,KAAK,aAAa,0BAA0B,KAAK,aAAa,wBAAwB,KAAK,aAAa,oBAAoB,KAAK,aAAa;AAAA,QACplB;AAEA,iBAAS,OAAO,QAAQ;AACtB,cAAI,OAAO,WAAW,YAAY,WAAW,MAAM;AACjD,gBAAI,WAAW,OAAO;AAEtB,oBAAQ,UAAU;AAAA,cAChB,KAAK;AACH,oBAAI,OAAO,OAAO;AAElB,wBAAQ,MAAM;AAAA,kBACZ,KAAK;AAAA,kBACL,KAAK;AAAA,kBACL,KAAK;AAAA,kBACL,KAAK;AAAA,kBACL,KAAK;AAAA,kBACL,KAAK;AACH,2BAAO;AAAA,kBAET;AACE,wBAAI,eAAe,QAAQ,KAAK;AAEhC,4BAAQ,cAAc;AAAA,sBACpB,KAAK;AAAA,sBACL,KAAK;AAAA,sBACL,KAAK;AAAA,sBACL,KAAK;AAAA,sBACL,KAAK;AACH,+BAAO;AAAA,sBAET;AACE,+BAAO;AAAA,oBACX;AAAA,gBAEJ;AAAA,cAEF,KAAK;AACH,uBAAO;AAAA,YACX;AAAA,UACF;AAEA,iBAAO;AAAA,QACT;AAEA,YAAI,YAAY;AAChB,YAAI,iBAAiB;AACrB,YAAI,kBAAkB;AACtB,YAAI,kBAAkB;AACtB,YAAI,UAAU;AACd,YAAI,aAAa;AACjB,YAAIE,aAAW;AACf,YAAI,OAAO;AACX,YAAI,OAAO;AACX,YAAIC,UAAS;AACb,YAAI,WAAW;AACf,YAAI,aAAa;AACjB,YAAIC,YAAW;AACf,YAAI,sCAAsC;AAE1C,iBAAS,YAAY,QAAQ;AAC3B;AACE,gBAAI,CAAC,qCAAqC;AACxC,oDAAsC;AAEtC,sBAAQ,MAAM,EAAE,+KAAyL;AAAA,YAC3M;AAAA,UACF;AAEA,iBAAO,iBAAiB,MAAM,KAAK,OAAO,MAAM,MAAM;AAAA,QACxD;AACA,iBAAS,iBAAiB,QAAQ;AAChC,iBAAO,OAAO,MAAM,MAAM;AAAA,QAC5B;AACA,iBAAS,kBAAkB,QAAQ;AACjC,iBAAO,OAAO,MAAM,MAAM;AAAA,QAC5B;AACA,iBAAS,kBAAkB,QAAQ;AACjC,iBAAO,OAAO,MAAM,MAAM;AAAA,QAC5B;AACA,iBAAS,UAAU,QAAQ;AACzB,iBAAO,OAAO,WAAW,YAAY,WAAW,QAAQ,OAAO,aAAa;AAAA,QAC9E;AACA,iBAAS,aAAa,QAAQ;AAC5B,iBAAO,OAAO,MAAM,MAAM;AAAA,QAC5B;AACA,iBAAS,WAAW,QAAQ;AAC1B,iBAAO,OAAO,MAAM,MAAM;AAAA,QAC5B;AACA,iBAAS,OAAO,QAAQ;AACtB,iBAAO,OAAO,MAAM,MAAM;AAAA,QAC5B;AACA,iBAAS,OAAO,QAAQ;AACtB,iBAAO,OAAO,MAAM,MAAM;AAAA,QAC5B;AACA,iBAAS,SAAS,QAAQ;AACxB,iBAAO,OAAO,MAAM,MAAM;AAAA,QAC5B;AACA,iBAAS,WAAW,QAAQ;AAC1B,iBAAO,OAAO,MAAM,MAAM;AAAA,QAC5B;AACA,iBAAS,aAAa,QAAQ;AAC5B,iBAAO,OAAO,MAAM,MAAM;AAAA,QAC5B;AACA,iBAAS,WAAW,QAAQ;AAC1B,iBAAO,OAAO,MAAM,MAAM;AAAA,QAC5B;AAEA,gBAAQ,YAAY;AACpB,gBAAQ,iBAAiB;AACzB,gBAAQ,kBAAkB;AAC1B,gBAAQ,kBAAkB;AAC1B,gBAAQ,UAAU;AAClB,gBAAQ,aAAa;AACrB,gBAAQ,WAAWF;AACnB,gBAAQ,OAAO;AACf,gBAAQ,OAAO;AACf,gBAAQ,SAASC;AACjB,gBAAQ,WAAW;AACnB,gBAAQ,aAAa;AACrB,gBAAQ,WAAWC;AACnB,gBAAQ,cAAc;AACtB,gBAAQ,mBAAmB;AAC3B,gBAAQ,oBAAoB;AAC5B,gBAAQ,oBAAoB;AAC5B,gBAAQ,YAAY;AACpB,gBAAQ,eAAe;AACvB,gBAAQ,aAAa;AACrB,gBAAQ,SAAS;AACjB,gBAAQ,SAAS;AACjB,gBAAQ,WAAW;AACnB,gBAAQ,aAAa;AACrB,gBAAQ,eAAe;AACvB,gBAAQ,aAAa;AACrB,gBAAQ,qBAAqB;AAC7B,gBAAQ,SAAS;AAAA,MACf,GAAG;AAAA,IACL;AAAA;AAAA;;;ACpLA;AAAA;AAAA;AAAA;AAEA,QAAI,2BAAY,aAAa,cAAc;AACzC,aAAO,UAAU;AAAA,IACnB,OAAO;AACL,aAAO,UAAU;AAAA,IACnB;AAAA;AAAA;;;ACNA;AAAA;AAAA;AAAA;AAQA,QAAI,wBAAwB,OAAO;AACnC,QAAI,iBAAiB,OAAO,UAAU;AACtC,QAAI,mBAAmB,OAAO,UAAU;AAExC,aAAS,SAAS,KAAK;AACtB,UAAI,QAAQ,QAAQ,QAAQ,QAAW;AACtC,cAAM,IAAI,UAAU,uDAAuD;AAAA,MAC5E;AAEA,aAAO,OAAO,GAAG;AAAA,IAClB;AAEA,aAAS,kBAAkB;AAC1B,UAAI;AACH,YAAI,CAAC,OAAO,QAAQ;AACnB,iBAAO;AAAA,QACR;AAKA,YAAI,QAAQ,IAAI,OAAO,KAAK;AAC5B,cAAM,CAAC,IAAI;AACX,YAAI,OAAO,oBAAoB,KAAK,EAAE,CAAC,MAAM,KAAK;AACjD,iBAAO;AAAA,QACR;AAGA,YAAI,QAAQ,CAAC;AACb,iBAAS,IAAI,GAAG,IAAI,IAAI,KAAK;AAC5B,gBAAM,MAAM,OAAO,aAAa,CAAC,CAAC,IAAI;AAAA,QACvC;AACA,YAAI,SAAS,OAAO,oBAAoB,KAAK,EAAE,IAAI,SAAU,GAAG;AAC/D,iBAAO,MAAM,CAAC;AAAA,QACf,CAAC;AACD,YAAI,OAAO,KAAK,EAAE,MAAM,cAAc;AACrC,iBAAO;AAAA,QACR;AAGA,YAAI,QAAQ,CAAC;AACb,+BAAuB,MAAM,EAAE,EAAE,QAAQ,SAAU,QAAQ;AAC1D,gBAAM,MAAM,IAAI;AAAA,QACjB,CAAC;AACD,YAAI,OAAO,KAAK,OAAO,OAAO,CAAC,GAAG,KAAK,CAAC,EAAE,KAAK,EAAE,MAC/C,wBAAwB;AACzB,iBAAO;AAAA,QACR;AAEA,eAAO;AAAA,MACR,SAAS,KAAK;AAEb,eAAO;AAAA,MACR;AAAA,IACD;AAEA,WAAO,UAAU,gBAAgB,IAAI,OAAO,SAAS,SAAU,QAAQ,QAAQ;AAC9E,UAAI;AACJ,UAAIC,MAAK,SAAS,MAAM;AACxB,UAAI;AAEJ,eAAS,IAAI,GAAG,IAAI,UAAU,QAAQ,KAAK;AAC1C,eAAO,OAAO,UAAU,CAAC,CAAC;AAE1B,iBAAS,OAAO,MAAM;AACrB,cAAI,eAAe,KAAK,MAAM,GAAG,GAAG;AACnC,YAAAA,IAAG,GAAG,IAAI,KAAK,GAAG;AAAA,UACnB;AAAA,QACD;AAEA,YAAI,uBAAuB;AAC1B,oBAAU,sBAAsB,IAAI;AACpC,mBAAS,IAAI,GAAG,IAAI,QAAQ,QAAQ,KAAK;AACxC,gBAAI,iBAAiB,KAAK,MAAM,QAAQ,CAAC,CAAC,GAAG;AAC5C,cAAAA,IAAG,QAAQ,CAAC,CAAC,IAAI,KAAK,QAAQ,CAAC,CAAC;AAAA,YACjC;AAAA,UACD;AAAA,QACD;AAAA,MACD;AAEA,aAAOA;AAAA,IACR;AAAA;AAAA;;;ACzFA;AAAA;AAAA;AAAA;AASA,QAAI,uBAAuB;AAE3B,WAAO,UAAU;AAAA;AAAA;;;ACXjB;AAAA;AAAA;AAAA,WAAO,UAAU,SAAS,KAAK,KAAK,OAAO,UAAU,cAAc;AAAA;AAAA;;;ACAnE;AAAA;AAAA;AAAA;AASA,QAAI,eAAe,WAAW;AAAA,IAAC;AAE/B,QAAI,2BAAY,aAAa,cAAc;AACrC,6BAAuB;AACvB,2BAAqB,CAAC;AACtB,YAAM;AAEV,qBAAe,SAAS,MAAM;AAC5B,YAAI,UAAU,cAAc;AAC5B,YAAI,OAAO,YAAY,aAAa;AAClC,kBAAQ,MAAM,OAAO;AAAA,QACvB;AACA,YAAI;AAIF,gBAAM,IAAI,MAAM,OAAO;AAAA,QACzB,SAAS,GAAG;AAAA,QAAO;AAAA,MACrB;AAAA,IACF;AAhBM;AACA;AACA;AA2BN,aAAS,eAAe,WAAW,QAAQ,UAAU,eAAe,UAAU;AAC5E,UAAI,2BAAY,aAAa,cAAc;AACzC,iBAAS,gBAAgB,WAAW;AAClC,cAAI,IAAI,WAAW,YAAY,GAAG;AAChC,gBAAI;AAIJ,gBAAI;AAGF,kBAAI,OAAO,UAAU,YAAY,MAAM,YAAY;AACjD,oBAAI,MAAM;AAAA,mBACP,iBAAiB,iBAAiB,OAAO,WAAW,YAAY,eAAe,+FACC,OAAO,UAAU,YAAY,IAAI;AAAA,gBAEpH;AACA,oBAAI,OAAO;AACX,sBAAM;AAAA,cACR;AACA,sBAAQ,UAAU,YAAY,EAAE,QAAQ,cAAc,eAAe,UAAU,MAAM,oBAAoB;AAAA,YAC3G,SAAS,IAAI;AACX,sBAAQ;AAAA,YACV;AACA,gBAAI,SAAS,EAAE,iBAAiB,QAAQ;AACtC;AAAA,iBACG,iBAAiB,iBAAiB,6BACnC,WAAW,OAAO,eAAe,6FAC6B,OAAO,QAAQ;AAAA,cAI/E;AAAA,YACF;AACA,gBAAI,iBAAiB,SAAS,EAAE,MAAM,WAAW,qBAAqB;AAGpE,iCAAmB,MAAM,OAAO,IAAI;AAEpC,kBAAI,QAAQ,WAAW,SAAS,IAAI;AAEpC;AAAA,gBACE,YAAY,WAAW,YAAY,MAAM,WAAW,SAAS,OAAO,QAAQ;AAAA,cAC9E;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAOA,mBAAe,oBAAoB,WAAW;AAC5C,UAAI,2BAAY,aAAa,cAAc;AACzC,6BAAqB,CAAC;AAAA,MACxB;AAAA,IACF;AAEA,WAAO,UAAU;AAAA;AAAA;;;ACtGjB;AAAA;AAAA;AAAA;AASA,QAAI,UAAU;AACd,QAAI,SAAS;AAEb,QAAI,uBAAuB;AAC3B,QAAI,MAAM;AACV,QAAI,iBAAiB;AAErB,QAAI,eAAe,WAAW;AAAA,IAAC;AAE/B,QAAI,2BAAY,aAAa,cAAc;AACzC,qBAAe,SAAS,MAAM;AAC5B,YAAI,UAAU,cAAc;AAC5B,YAAI,OAAO,YAAY,aAAa;AAClC,kBAAQ,MAAM,OAAO;AAAA,QACvB;AACA,YAAI;AAIF,gBAAM,IAAI,MAAM,OAAO;AAAA,QACzB,SAAS,GAAG;AAAA,QAAC;AAAA,MACf;AAAA,IACF;AAEA,aAAS,+BAA+B;AACtC,aAAO;AAAA,IACT;AAEA,WAAO,UAAU,SAAS,gBAAgB,qBAAqB;AAE7D,UAAI,kBAAkB,OAAO,WAAW,cAAc,OAAO;AAC7D,UAAI,uBAAuB;AAgB3B,eAAS,cAAc,eAAe;AACpC,YAAI,aAAa,kBAAkB,mBAAmB,cAAc,eAAe,KAAK,cAAc,oBAAoB;AAC1H,YAAI,OAAO,eAAe,YAAY;AACpC,iBAAO;AAAA,QACT;AAAA,MACF;AAiDA,UAAI,YAAY;AAIhB,UAAI,iBAAiB;AAAA,QACnB,OAAO,2BAA2B,OAAO;AAAA,QACzC,QAAQ,2BAA2B,QAAQ;AAAA,QAC3C,MAAM,2BAA2B,SAAS;AAAA,QAC1C,MAAM,2BAA2B,UAAU;AAAA,QAC3C,QAAQ,2BAA2B,QAAQ;AAAA,QAC3C,QAAQ,2BAA2B,QAAQ;AAAA,QAC3C,QAAQ,2BAA2B,QAAQ;AAAA,QAC3C,QAAQ,2BAA2B,QAAQ;AAAA,QAE3C,KAAK,qBAAqB;AAAA,QAC1B,SAAS;AAAA,QACT,SAAS,yBAAyB;AAAA,QAClC,aAAa,6BAA6B;AAAA,QAC1C,YAAY;AAAA,QACZ,MAAM,kBAAkB;AAAA,QACxB,UAAU;AAAA,QACV,OAAO;AAAA,QACP,WAAW;AAAA,QACX,OAAO;AAAA,QACP,OAAO;AAAA,MACT;AAOA,eAAS,GAAG,GAAGC,IAAG;AAEhB,YAAI,MAAMA,IAAG;AAGX,iBAAO,MAAM,KAAK,IAAI,MAAM,IAAIA;AAAA,QAClC,OAAO;AAEL,iBAAO,MAAM,KAAKA,OAAMA;AAAA,QAC1B;AAAA,MACF;AAUA,eAAS,cAAc,SAASC,OAAM;AACpC,aAAK,UAAU;AACf,aAAK,OAAOA,SAAQ,OAAOA,UAAS,WAAWA,QAAM,CAAC;AACtD,aAAK,QAAQ;AAAA,MACf;AAEA,oBAAc,YAAY,MAAM;AAEhC,eAAS,2BAA2B,UAAU;AAC5C,YAAI,2BAAY,aAAa,cAAc;AACzC,cAAI,0BAA0B,CAAC;AAC/B,cAAI,6BAA6B;AAAA,QACnC;AACA,iBAAS,UAAU,YAAY,OAAO,UAAU,eAAe,UAAU,cAAc,QAAQ;AAC7F,0BAAgB,iBAAiB;AACjC,yBAAe,gBAAgB;AAE/B,cAAI,WAAW,sBAAsB;AACnC,gBAAI,qBAAqB;AAEvB,kBAAI,MAAM,IAAI;AAAA,gBACZ;AAAA,cAGF;AACA,kBAAI,OAAO;AACX,oBAAM;AAAA,YACR,WAAW,2BAAY,aAAa,gBAAgB,OAAO,YAAY,aAAa;AAElF,kBAAI,WAAW,gBAAgB,MAAM;AACrC,kBACE,CAAC,wBAAwB,QAAQ;AAAA,cAEjC,6BAA6B,GAC7B;AACA;AAAA,kBACE,6EACuB,eAAe,gBAAgB,gBAAgB;AAAA,gBAIxE;AACA,wCAAwB,QAAQ,IAAI;AACpC;AAAA,cACF;AAAA,YACF;AAAA,UACF;AACA,cAAI,MAAM,QAAQ,KAAK,MAAM;AAC3B,gBAAI,YAAY;AACd,kBAAI,MAAM,QAAQ,MAAM,MAAM;AAC5B,uBAAO,IAAI,cAAc,SAAS,WAAW,OAAO,eAAe,8BAA8B,SAAS,gBAAgB,8BAA8B;AAAA,cAC1J;AACA,qBAAO,IAAI,cAAc,SAAS,WAAW,OAAO,eAAe,iCAAiC,MAAM,gBAAgB,mCAAmC;AAAA,YAC/J;AACA,mBAAO;AAAA,UACT,OAAO;AACL,mBAAO,SAAS,OAAO,UAAU,eAAe,UAAU,YAAY;AAAA,UACxE;AAAA,QACF;AAEA,YAAI,mBAAmB,UAAU,KAAK,MAAM,KAAK;AACjD,yBAAiB,aAAa,UAAU,KAAK,MAAM,IAAI;AAEvD,eAAO;AAAA,MACT;AAEA,eAAS,2BAA2B,cAAc;AAChD,iBAAS,SAAS,OAAO,UAAU,eAAe,UAAU,cAAc,QAAQ;AAChF,cAAI,YAAY,MAAM,QAAQ;AAC9B,cAAI,WAAW,YAAY,SAAS;AACpC,cAAI,aAAa,cAAc;AAI7B,gBAAI,cAAc,eAAe,SAAS;AAE1C,mBAAO,IAAI;AAAA,cACT,aAAa,WAAW,OAAO,eAAe,gBAAgB,MAAM,cAAc,oBAAoB,gBAAgB,mBAAmB,MAAM,eAAe;AAAA,cAC9J,EAAC,aAA0B;AAAA,YAC7B;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AACA,eAAO,2BAA2B,QAAQ;AAAA,MAC5C;AAEA,eAAS,uBAAuB;AAC9B,eAAO,2BAA2B,4BAA4B;AAAA,MAChE;AAEA,eAAS,yBAAyB,aAAa;AAC7C,iBAAS,SAAS,OAAO,UAAU,eAAe,UAAU,cAAc;AACxE,cAAI,OAAO,gBAAgB,YAAY;AACrC,mBAAO,IAAI,cAAc,eAAe,eAAe,qBAAqB,gBAAgB,iDAAiD;AAAA,UAC/I;AACA,cAAI,YAAY,MAAM,QAAQ;AAC9B,cAAI,CAAC,MAAM,QAAQ,SAAS,GAAG;AAC7B,gBAAI,WAAW,YAAY,SAAS;AACpC,mBAAO,IAAI,cAAc,aAAa,WAAW,OAAO,eAAe,gBAAgB,MAAM,WAAW,oBAAoB,gBAAgB,wBAAwB;AAAA,UACtK;AACA,mBAAS,IAAI,GAAG,IAAI,UAAU,QAAQ,KAAK;AACzC,gBAAI,QAAQ,YAAY,WAAW,GAAG,eAAe,UAAU,eAAe,MAAM,IAAI,KAAK,oBAAoB;AACjH,gBAAI,iBAAiB,OAAO;AAC1B,qBAAO;AAAA,YACT;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AACA,eAAO,2BAA2B,QAAQ;AAAA,MAC5C;AAEA,eAAS,2BAA2B;AAClC,iBAAS,SAAS,OAAO,UAAU,eAAe,UAAU,cAAc;AACxE,cAAI,YAAY,MAAM,QAAQ;AAC9B,cAAI,CAAC,eAAe,SAAS,GAAG;AAC9B,gBAAI,WAAW,YAAY,SAAS;AACpC,mBAAO,IAAI,cAAc,aAAa,WAAW,OAAO,eAAe,gBAAgB,MAAM,WAAW,oBAAoB,gBAAgB,qCAAqC;AAAA,UACnL;AACA,iBAAO;AAAA,QACT;AACA,eAAO,2BAA2B,QAAQ;AAAA,MAC5C;AAEA,eAAS,+BAA+B;AACtC,iBAAS,SAAS,OAAO,UAAU,eAAe,UAAU,cAAc;AACxE,cAAI,YAAY,MAAM,QAAQ;AAC9B,cAAI,CAAC,QAAQ,mBAAmB,SAAS,GAAG;AAC1C,gBAAI,WAAW,YAAY,SAAS;AACpC,mBAAO,IAAI,cAAc,aAAa,WAAW,OAAO,eAAe,gBAAgB,MAAM,WAAW,oBAAoB,gBAAgB,0CAA0C;AAAA,UACxL;AACA,iBAAO;AAAA,QACT;AACA,eAAO,2BAA2B,QAAQ;AAAA,MAC5C;AAEA,eAAS,0BAA0B,eAAe;AAChD,iBAAS,SAAS,OAAO,UAAU,eAAe,UAAU,cAAc;AACxE,cAAI,EAAE,MAAM,QAAQ,aAAa,gBAAgB;AAC/C,gBAAI,oBAAoB,cAAc,QAAQ;AAC9C,gBAAI,kBAAkB,aAAa,MAAM,QAAQ,CAAC;AAClD,mBAAO,IAAI,cAAc,aAAa,WAAW,OAAO,eAAe,gBAAgB,MAAM,kBAAkB,oBAAoB,gBAAgB,mBAAmB,kBAAkB,oBAAoB,KAAK;AAAA,UACnN;AACA,iBAAO;AAAA,QACT;AACA,eAAO,2BAA2B,QAAQ;AAAA,MAC5C;AAEA,eAAS,sBAAsB,gBAAgB;AAC7C,YAAI,CAAC,MAAM,QAAQ,cAAc,GAAG;AAClC,cAAI,2BAAY,aAAa,cAAc;AACzC,gBAAI,UAAU,SAAS,GAAG;AACxB;AAAA,gBACE,iEAAiE,UAAU,SAAS;AAAA,cAEtF;AAAA,YACF,OAAO;AACL,2BAAa,wDAAwD;AAAA,YACvE;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAEA,iBAAS,SAAS,OAAO,UAAU,eAAe,UAAU,cAAc;AACxE,cAAI,YAAY,MAAM,QAAQ;AAC9B,mBAAS,IAAI,GAAG,IAAI,eAAe,QAAQ,KAAK;AAC9C,gBAAI,GAAG,WAAW,eAAe,CAAC,CAAC,GAAG;AACpC,qBAAO;AAAA,YACT;AAAA,UACF;AAEA,cAAI,eAAe,KAAK,UAAU,gBAAgB,SAAS,SAAS,KAAK,OAAO;AAC9E,gBAAI,OAAO,eAAe,KAAK;AAC/B,gBAAI,SAAS,UAAU;AACrB,qBAAO,OAAO,KAAK;AAAA,YACrB;AACA,mBAAO;AAAA,UACT,CAAC;AACD,iBAAO,IAAI,cAAc,aAAa,WAAW,OAAO,eAAe,iBAAiB,OAAO,SAAS,IAAI,QAAQ,kBAAkB,gBAAgB,wBAAwB,eAAe,IAAI;AAAA,QACnM;AACA,eAAO,2BAA2B,QAAQ;AAAA,MAC5C;AAEA,eAAS,0BAA0B,aAAa;AAC9C,iBAAS,SAAS,OAAO,UAAU,eAAe,UAAU,cAAc;AACxE,cAAI,OAAO,gBAAgB,YAAY;AACrC,mBAAO,IAAI,cAAc,eAAe,eAAe,qBAAqB,gBAAgB,kDAAkD;AAAA,UAChJ;AACA,cAAI,YAAY,MAAM,QAAQ;AAC9B,cAAI,WAAW,YAAY,SAAS;AACpC,cAAI,aAAa,UAAU;AACzB,mBAAO,IAAI,cAAc,aAAa,WAAW,OAAO,eAAe,gBAAgB,MAAM,WAAW,oBAAoB,gBAAgB,yBAAyB;AAAA,UACvK;AACA,mBAAS,OAAO,WAAW;AACzB,gBAAI,IAAI,WAAW,GAAG,GAAG;AACvB,kBAAI,QAAQ,YAAY,WAAW,KAAK,eAAe,UAAU,eAAe,MAAM,KAAK,oBAAoB;AAC/G,kBAAI,iBAAiB,OAAO;AAC1B,uBAAO;AAAA,cACT;AAAA,YACF;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AACA,eAAO,2BAA2B,QAAQ;AAAA,MAC5C;AAEA,eAAS,uBAAuB,qBAAqB;AACnD,YAAI,CAAC,MAAM,QAAQ,mBAAmB,GAAG;AACvC,qCAAY,aAAa,eAAe,aAAa,wEAAwE,IAAI;AACjI,iBAAO;AAAA,QACT;AAEA,iBAAS,IAAI,GAAG,IAAI,oBAAoB,QAAQ,KAAK;AACnD,cAAI,UAAU,oBAAoB,CAAC;AACnC,cAAI,OAAO,YAAY,YAAY;AACjC;AAAA,cACE,gGACc,yBAAyB,OAAO,IAAI,eAAe,IAAI;AAAA,YACvE;AACA,mBAAO;AAAA,UACT;AAAA,QACF;AAEA,iBAAS,SAAS,OAAO,UAAU,eAAe,UAAU,cAAc;AACxE,cAAI,gBAAgB,CAAC;AACrB,mBAASC,KAAI,GAAGA,KAAI,oBAAoB,QAAQA,MAAK;AACnD,gBAAIC,WAAU,oBAAoBD,EAAC;AACnC,gBAAI,gBAAgBC,SAAQ,OAAO,UAAU,eAAe,UAAU,cAAc,oBAAoB;AACxG,gBAAI,iBAAiB,MAAM;AACzB,qBAAO;AAAA,YACT;AACA,gBAAI,cAAc,QAAQ,IAAI,cAAc,MAAM,cAAc,GAAG;AACjE,4BAAc,KAAK,cAAc,KAAK,YAAY;AAAA,YACpD;AAAA,UACF;AACA,cAAI,uBAAwB,cAAc,SAAS,IAAK,6BAA6B,cAAc,KAAK,IAAI,IAAI,MAAK;AACrH,iBAAO,IAAI,cAAc,aAAa,WAAW,OAAO,eAAe,oBAAoB,MAAM,gBAAgB,MAAM,uBAAuB,IAAI;AAAA,QACpJ;AACA,eAAO,2BAA2B,QAAQ;AAAA,MAC5C;AAEA,eAAS,oBAAoB;AAC3B,iBAAS,SAAS,OAAO,UAAU,eAAe,UAAU,cAAc;AACxE,cAAI,CAAC,OAAO,MAAM,QAAQ,CAAC,GAAG;AAC5B,mBAAO,IAAI,cAAc,aAAa,WAAW,OAAO,eAAe,oBAAoB,MAAM,gBAAgB,2BAA2B;AAAA,UAC9I;AACA,iBAAO;AAAA,QACT;AACA,eAAO,2BAA2B,QAAQ;AAAA,MAC5C;AAEA,eAAS,sBAAsB,eAAe,UAAU,cAAc,KAAK,MAAM;AAC/E,eAAO,IAAI;AAAA,WACR,iBAAiB,iBAAiB,OAAO,WAAW,YAAY,eAAe,MAAM,MAAM,+FACX,OAAO;AAAA,QAC1F;AAAA,MACF;AAEA,eAAS,uBAAuB,YAAY;AAC1C,iBAAS,SAAS,OAAO,UAAU,eAAe,UAAU,cAAc;AACxE,cAAI,YAAY,MAAM,QAAQ;AAC9B,cAAI,WAAW,YAAY,SAAS;AACpC,cAAI,aAAa,UAAU;AACzB,mBAAO,IAAI,cAAc,aAAa,WAAW,OAAO,eAAe,gBAAgB,WAAW,QAAQ,kBAAkB,gBAAgB,wBAAwB;AAAA,UACtK;AACA,mBAAS,OAAO,YAAY;AAC1B,gBAAI,UAAU,WAAW,GAAG;AAC5B,gBAAI,OAAO,YAAY,YAAY;AACjC,qBAAO,sBAAsB,eAAe,UAAU,cAAc,KAAK,eAAe,OAAO,CAAC;AAAA,YAClG;AACA,gBAAI,QAAQ,QAAQ,WAAW,KAAK,eAAe,UAAU,eAAe,MAAM,KAAK,oBAAoB;AAC3G,gBAAI,OAAO;AACT,qBAAO;AAAA,YACT;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AACA,eAAO,2BAA2B,QAAQ;AAAA,MAC5C;AAEA,eAAS,6BAA6B,YAAY;AAChD,iBAAS,SAAS,OAAO,UAAU,eAAe,UAAU,cAAc;AACxE,cAAI,YAAY,MAAM,QAAQ;AAC9B,cAAI,WAAW,YAAY,SAAS;AACpC,cAAI,aAAa,UAAU;AACzB,mBAAO,IAAI,cAAc,aAAa,WAAW,OAAO,eAAe,gBAAgB,WAAW,QAAQ,kBAAkB,gBAAgB,wBAAwB;AAAA,UACtK;AAEA,cAAI,UAAU,OAAO,CAAC,GAAG,MAAM,QAAQ,GAAG,UAAU;AACpD,mBAAS,OAAO,SAAS;AACvB,gBAAI,UAAU,WAAW,GAAG;AAC5B,gBAAI,IAAI,YAAY,GAAG,KAAK,OAAO,YAAY,YAAY;AACzD,qBAAO,sBAAsB,eAAe,UAAU,cAAc,KAAK,eAAe,OAAO,CAAC;AAAA,YAClG;AACA,gBAAI,CAAC,SAAS;AACZ,qBAAO,IAAI;AAAA,gBACT,aAAa,WAAW,OAAO,eAAe,YAAY,MAAM,oBAAoB,gBAAgB,qBACjF,KAAK,UAAU,MAAM,QAAQ,GAAG,MAAM,IAAI,IAC7D,mBAAmB,KAAK,UAAU,OAAO,KAAK,UAAU,GAAG,MAAM,IAAI;AAAA,cACvE;AAAA,YACF;AACA,gBAAI,QAAQ,QAAQ,WAAW,KAAK,eAAe,UAAU,eAAe,MAAM,KAAK,oBAAoB;AAC3G,gBAAI,OAAO;AACT,qBAAO;AAAA,YACT;AAAA,UACF;AACA,iBAAO;AAAA,QACT;AAEA,eAAO,2BAA2B,QAAQ;AAAA,MAC5C;AAEA,eAAS,OAAO,WAAW;AACzB,gBAAQ,OAAO,WAAW;AAAA,UACxB,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AACH,mBAAO;AAAA,UACT,KAAK;AACH,mBAAO,CAAC;AAAA,UACV,KAAK;AACH,gBAAI,MAAM,QAAQ,SAAS,GAAG;AAC5B,qBAAO,UAAU,MAAM,MAAM;AAAA,YAC/B;AACA,gBAAI,cAAc,QAAQ,eAAe,SAAS,GAAG;AACnD,qBAAO;AAAA,YACT;AAEA,gBAAI,aAAa,cAAc,SAAS;AACxC,gBAAI,YAAY;AACd,kBAAI,WAAW,WAAW,KAAK,SAAS;AACxC,kBAAI;AACJ,kBAAI,eAAe,UAAU,SAAS;AACpC,uBAAO,EAAE,OAAO,SAAS,KAAK,GAAG,MAAM;AACrC,sBAAI,CAAC,OAAO,KAAK,KAAK,GAAG;AACvB,2BAAO;AAAA,kBACT;AAAA,gBACF;AAAA,cACF,OAAO;AAEL,uBAAO,EAAE,OAAO,SAAS,KAAK,GAAG,MAAM;AACrC,sBAAI,QAAQ,KAAK;AACjB,sBAAI,OAAO;AACT,wBAAI,CAAC,OAAO,MAAM,CAAC,CAAC,GAAG;AACrB,6BAAO;AAAA,oBACT;AAAA,kBACF;AAAA,gBACF;AAAA,cACF;AAAA,YACF,OAAO;AACL,qBAAO;AAAA,YACT;AAEA,mBAAO;AAAA,UACT;AACE,mBAAO;AAAA,QACX;AAAA,MACF;AAEA,eAAS,SAAS,UAAU,WAAW;AAErC,YAAI,aAAa,UAAU;AACzB,iBAAO;AAAA,QACT;AAGA,YAAI,CAAC,WAAW;AACd,iBAAO;AAAA,QACT;AAGA,YAAI,UAAU,eAAe,MAAM,UAAU;AAC3C,iBAAO;AAAA,QACT;AAGA,YAAI,OAAO,WAAW,cAAc,qBAAqB,QAAQ;AAC/D,iBAAO;AAAA,QACT;AAEA,eAAO;AAAA,MACT;AAGA,eAAS,YAAY,WAAW;AAC9B,YAAI,WAAW,OAAO;AACtB,YAAI,MAAM,QAAQ,SAAS,GAAG;AAC5B,iBAAO;AAAA,QACT;AACA,YAAI,qBAAqB,QAAQ;AAI/B,iBAAO;AAAA,QACT;AACA,YAAI,SAAS,UAAU,SAAS,GAAG;AACjC,iBAAO;AAAA,QACT;AACA,eAAO;AAAA,MACT;AAIA,eAAS,eAAe,WAAW;AACjC,YAAI,OAAO,cAAc,eAAe,cAAc,MAAM;AAC1D,iBAAO,KAAK;AAAA,QACd;AACA,YAAI,WAAW,YAAY,SAAS;AACpC,YAAI,aAAa,UAAU;AACzB,cAAI,qBAAqB,MAAM;AAC7B,mBAAO;AAAA,UACT,WAAW,qBAAqB,QAAQ;AACtC,mBAAO;AAAA,UACT;AAAA,QACF;AACA,eAAO;AAAA,MACT;AAIA,eAAS,yBAAyB,OAAO;AACvC,YAAI,OAAO,eAAe,KAAK;AAC/B,gBAAQ,MAAM;AAAA,UACZ,KAAK;AAAA,UACL,KAAK;AACH,mBAAO,QAAQ;AAAA,UACjB,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AACH,mBAAO,OAAO;AAAA,UAChB;AACE,mBAAO;AAAA,QACX;AAAA,MACF;AAGA,eAAS,aAAa,WAAW;AAC/B,YAAI,CAAC,UAAU,eAAe,CAAC,UAAU,YAAY,MAAM;AACzD,iBAAO;AAAA,QACT;AACA,eAAO,UAAU,YAAY;AAAA,MAC/B;AAEA,qBAAe,iBAAiB;AAChC,qBAAe,oBAAoB,eAAe;AAClD,qBAAe,YAAY;AAE3B,aAAO;AAAA,IACT;AAAA;AAAA;;;ACjmBA;AAAA;AAAA;AAAA;AASA,QAAI,uBAAuB;AAE3B,aAAS,gBAAgB;AAAA,IAAC;AAC1B,aAAS,yBAAyB;AAAA,IAAC;AACnC,2BAAuB,oBAAoB;AAE3C,WAAO,UAAU,WAAW;AAC1B,eAAS,KAAK,OAAO,UAAU,eAAe,UAAU,cAAc,QAAQ;AAC5E,YAAI,WAAW,sBAAsB;AAEnC;AAAA,QACF;AACA,YAAI,MAAM,IAAI;AAAA,UACZ;AAAA,QAGF;AACA,YAAI,OAAO;AACX,cAAM;AAAA,MACR;AAAC;AACD,WAAK,aAAa;AAClB,eAAS,UAAU;AACjB,eAAO;AAAA,MACT;AAAC;AAGD,UAAI,iBAAiB;AAAA,QACnB,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,MAAM;AAAA,QACN,MAAM;AAAA,QACN,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,QAAQ;AAAA,QAER,KAAK;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,aAAa;AAAA,QACb,YAAY;AAAA,QACZ,MAAM;AAAA,QACN,UAAU;AAAA,QACV,OAAO;AAAA,QACP,WAAW;AAAA,QACX,OAAO;AAAA,QACP,OAAO;AAAA,QAEP,gBAAgB;AAAA,QAChB,mBAAmB;AAAA,MACrB;AAEA,qBAAe,YAAY;AAE3B,aAAO;AAAA,IACT;AAAA;AAAA;;;AChEA;AAAA;AAAA;AAOA,QAAI,2BAAY,aAAa,cAAc;AACrC,gBAAU;AAIV,4BAAsB;AAC1B,aAAO,UAAU,kCAAqC,QAAQ,WAAW,mBAAmB;AAAA,IAC9F,OAAO;AAGL,aAAO,UAAU,mCAAsC;AAAA,IACzD;AAVM;AAIA;AAAA;AAAA;;;ACZN;;;ACAA;;;ACAA;AAAA,OAAOC,YAAyD;;;ACAhE;;;ACAA;;;ACAA;AACA,SAAS,sBAAsB;AAC/B,OAAO,WAAW;;;ACFlB;AACA,SAAS,mBAAmB,+BAA+B;AAEpD,IAAM,aAAa;AAAA,EACxB,OAAO;AAAA,IACL,QAAQ;AAAA,MACN,iBAAiB;AAAA,MACjB,gBAAgB;AAAA,MAChB,aAAa;AAAA,MACb,kBAAkB;AAAA,MAClB,iBAAiB;AAAA,MACjB,mBAAmB;AAAA,MACnB,gBAAgB;AAAA,MAChB,mBAAmB;AAAA,MACnB,kBAAkB;AAAA,MAClB,eAAe;AAAA,MACf,oBAAoB;AAAA,MACpB,mBAAmB;AAAA,MACnB,qBAAqB;AAAA,MACrB,kBAAkB;AAAA,MAClB,oBAAoB;AAAA,MACpB,gBAAgB;AAAA,MAChB,iBAAiB;AAAA,MACjB,gBAAgB;AAAA,MAChB,kBAAkB;AAAA,MAClB,aAAa;AAAA,MACb,iBAAiB;AAAA,MACjB,mBAAmB;AAAA,MACnB,gBAAgB;AAAA,MAChB,gBAAgB;AAAA,MAChB,eAAe;AAAA,MACf,eAAe;AAAA,MACf,eAAe;AAAA,MACf,qBAAqB;AAAA,MACrB,oBAAoB;AAAA,MACpB,sBAAsB;AAAA,MACtB,iBAAiB;AAAA,IACnB;AAAA,IACA,SAAS;AAAA,MACP,IAAI;AAAA,MACJ,IAAI;AAAA,IACN;AAAA,IACA,OAAO;AAAA,MACL,MAAM;AAAA,IACR;AAAA,IACA,WAAW;AAAA,MACT,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,MAAM;AAAA,MACN,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,IACN;AAAA,IACA,aAAa;AAAA,MACX,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,SAAS;AAAA,IACX;AAAA,IACA,aAAa;AAAA,MACX,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,MAAM;AAAA,MACN,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,IACN;AAAA,IACA,OAAO;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,OAAO;AAAA,IACT;AAAA,IACA,OAAO;AAAA,MACL,GAAG;AAAA,MACH,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,GAAG;AAAA,MACH,GAAG;AAAA,MACH,GAAG;AAAA,MACH,GAAG;AAAA,MACH,GAAG;AAAA,MACH,GAAG;AAAA,MACH,GAAG;AAAA,MACH,GAAG;AAAA,MACH,GAAG;AAAA,MACH,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,KAAK;AAAA,IACP;AAAA,IACA,cAAc;AAAA,MACZ,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,MAAM;AAAA,MACN,WAAW;AAAA,MACX,OAAO;AAAA,IACT;AAAA,EACF;AACF;AAEO,IAAM,eAAe;AAAA,EAC1B,IAAI,CAAC,WAAsD;AAAA,IACzD,iBAAiB;AAAA,EACnB;AAAA,EACA,GAAG,CAAC,WAA4C;AAAA,IAC9C,OAAO;AAAA,EACT;AAAA,EACA,GAAG,CAAC,WAAyC;AAAA,IAC3C,cAAc;AAAA,EAChB;AAAA,EACA,IAAI,CAAC,WAAiE;AAAA,IACpE,UAAU;AAAA,EACZ;AAAA,EACA,MAAM,CAAC,WAA2D;AAAA,IAChE,QAAQ;AAAA,IACR,OAAO;AAAA,EACT;AAAA,EACA,GAAG,CAAC,WAA2D;AAAA,IAC7D,OAAO;AAAA,EACT;AAAA,EACA,GAAG,CAAC,WAA2D;AAAA,IAC7D,QAAQ;AAAA,EACV;AAAA,EACA,GAAG,CAAC,WAA2D;AAAA,IAC7D,SAAS;AAAA,EACX;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,YAAY;AAAA,EACd;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,cAAc;AAAA,EAChB;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,eAAe;AAAA,EACjB;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,aAAa;AAAA,EACf;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,aAAa;AAAA,IACb,cAAc;AAAA,EAChB;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,YAAY;AAAA,IACZ,eAAe;AAAA,EACjB;AAAA,EACA,GAAG,CAAC,WAA2D;AAAA,IAC7D,QAAQ;AAAA,EACV;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,WAAW;AAAA,EACb;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,aAAa;AAAA,EACf;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,cAAc;AAAA,EAChB;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,YAAY;AAAA,EACd;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,YAAY;AAAA,IACZ,aAAa;AAAA,EACf;AAAA,EACA,IAAI,CAAC,WAA2D;AAAA,IAC9D,WAAW;AAAA,IACX,cAAc;AAAA,EAChB;AACF;AAEO,IAAM,eAAe;AAAA,EAC1B,aAAa;AAAA,EACb,IAAI;AAAA,EACJ,IAAI;AAAA,EACJ,IAAI;AAAA,EACJ,IAAI;AAAA,EACJ,OAAO;AAAA,EACP,IAAI;AACN;AAEO,IAAM,kBAAkB,iCAC1B,0BAD0B;AAAA,EAE7B,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,UAAU;AAAA,EACV,UAAU;AAAA,EACV,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,qBAAqB;AAAA,EACrB,kBAAkB;AAAA,EAClB,WAAW;AAAA,EACX,cAAc;AAAA,EACd,cAAc;AAAA,EACd,YAAY;AAAA,EACZ,eAAe;AAAA,EACf,eAAe;AACjB;;;AC3OA;AAAA,SAAS,uBAAuB;AAMzB,IAAM,8BAA8B;AACpC,IAAM,eAAe;AACrB,IAAM,aAAa;AACnB,IAAM,6BAA6B;AACnC,IAAM,6BAA6B;AACnC,IAAM,iCAAiC;AAAA,EAC5C,OAAO;AAAA,EACP,QAAQ;AACV;AACO,IAAM,sBAAsB;AAE5B,IAAM,gBAAgB;AAAA,EAC3B,MAAM;AAAA,EACN,MAAM;AAAA,EACN,UAAU;AACZ;AAEO,IAAM,WAAW;AAAA,EACtB,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,cAAc;AAAA,EACd,WAAW;AAAA,EACX,WAAW;AAAA,EACX,UAAU;AAAA,EACV,UAAU;AAAA,EACV,yBAAyB;AAAA,EACzB,MAAM;AAAA,EACN,YAAY;AAAA,EACZ,aAAa;AAAA,EACb,kBAAkB;AAAA,EAClB,aAAa;AAAA,EACb,eAAe;AAAA,EACf,cAAc;AAAA,EACd,WAAW;AAAA,EACX,WAAW;AAAA,EACX,eAAe;AAAA,EACf,yBAAyB;AAAA,EACzB,sBAAsB;AAAA,EACtB,WAAW;AAAA,EACX,YAAY;AAAA,EACZ,OAAO;AAAA,EACP,SAAS;AAAA,EACT,gBAAgB;AAAA,EAChB,mBAAmB;AACrB;AAEO,IAAM,cAAc;AAAA,EACzB,aAAa;AAAA,EACb,cAAc;AAAA,EACd,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,kBAAkB;AAAA,EAClB,oBAAoB;AAAA,EACpB,kBAAkB;AACpB;AAEO,IAAM,oBAAoB;AAAA,EAC/B,cAAc;AAAA,EACd,MAAM;AAAA,EACN,WAAW;AAAA,EACX,OAAO;AAAA,EACP,IAAI;AAAA,EACJ,cAAc;AAChB;AAIO,IAAM,gBAAgB;AAAA,EAC3B,cAAc;AAChB;AAEO,IAAM,aAAa;AAAA,EACxB,YAAY;AAAA,EACZ,MAAM;AACR;AAEO,IAAM,aAAa;AAAA,EACxB,kBAAkB;AAAA,EAClB,kBAAkB;AAAA,EAClB,MAAM;AAAA,EACN,SAAS;AACX;AAEO,IAAM,gBAAgB;AAAA,EAC3B,cAAc;AAChB;AACO,IAAM,2BAA2B;AAAA,EACtC,aAAa;AAAA,EACb,WAAW;AAAA,EACX,kBAAkB;AAAA,EAClB,aAAa;AAAA,EACb,OAAO;AACT;AAMO,IAAM,+BAA+B;AAxG5C;AA0GO,IAAM,aAAW,2BAAgB,WAAW,MAA3B,mBAA8B,SAA9B,mBAAoC,mBAAkB;AA1G9E,IAAAC,KAAAC;AA2GO,IAAM,cAAYA,OAAAD,MAAA,gBAAgB,WAAW,MAA3B,gBAAAA,IAA8B,SAA9B,gBAAAC,IAAoC,mBAAkB;AA3G/E,IAAAD,KAAAC;AA4GO,IAAM,aAAWA,OAAAD,MAAA,gBAAgB,WAAW,MAA3B,gBAAAA,IAA8B,SAA9B,gBAAAC,IAAoC,mBAAkB;AA5G9E,IAAAD,KAAAC;AA6GO,IAAM,UAAQA,OAAAD,MAAA,gBAAgB,MAAM,MAAtB,gBAAAA,IAAyB,SAAzB,gBAAAC,IAA+B,mBAAkB;AA7GtE,IAAAD,KAAAC;AA8GO,IAAM,YAAUA,OAAAD,MAAA,gBAAgB,MAAM,MAAtB,gBAAAA,IAAyB,SAAzB,gBAAAC,IAA+B,mBAAkB;AA9GxE,IAAAD,KAAAC;AA+GO,IAAM,cAAYA,OAAAD,MAAA,gBAAgB,MAAM,MAAtB,gBAAAA,IAAyB,SAAzB,gBAAAC,IAA+B,mBAAkB;AACnE,IAAM,WAAW;AAoBjB,IAAK,sBAAL,kBAAKC,yBAAL;AACL,EAAAA,qBAAA,mBAAkB;AAClB,EAAAA,qBAAA,qBAAoB;AAFV,SAAAA;AAAA,GAAA;AAcL,IAAM,uBAAuB;AAE7B,IAAM,2BAA2B;AAEjC,IAAM,iBAAiB;;;AFhJ9B,IAAM,cAAc,eAAe;AAAA,EACjC,QAAQ;AAAA,EACR,OAAO,iCACF,WAAW,QADT;AAAA,IAEL,QAAQ,mBACH,WAAW,MAAM;AAAA,EAExB;AAAA,EACA,OAAO;AAAA,EACP,OAAO;AAAA,EACP,UAAU;AACZ,CAAC;AAEM,IAAM;AAAA,EACX;AAAA,EACA,aAAa;AAAA,EACb;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,IAAI;AAEG,IAAM,eAAe,UAAU;AAAA,EACpC,CAAC,GAAG,wBAAwB,IAAI,GAAG;AAAA,IACjC,YAAY;AAAA,IACZ,WAAW;AAAA,EACb;AAAA,EACA,6BAA6B;AAAA,IAC3B,iBAAiB;AAAA,IACjB,WAAW;AAAA,IACX,iBAAiB;AAAA,EACnB;AAAA,EACA,uBAAuB;AAAA,IACrB,OAAO;AAAA,IACP,QAAQ;AAAA,IACR,iBAAiB;AAAA,EACnB;AAAA,EACA,6BAA6B;AAAA,IAC3B,iBAAiB;AAAA,IACjB,cAAc;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,+BAA+B;AAAA,IAC7B,iBAAiB;AAAA,EACnB;AAAA,EAEA,gCAAgC;AAAA,IAC9B,iBAAiB;AAAA,EACnB;AACF,CAAC;AAUM,IAAM,cAAc,CAAC;AAAA,EAC1B;AAAA,EACA,OAAAC;AAAA,EACA;AACF,MAIM;AACJ,MAAI,CAAC,WAAW;AACd,UAAM,IAAI,MAAM,wBAAwB;AAAA,EAC1C;AACA,QAAM,cAAc,MAAM,WAAW,OAAOA,UAAS,CAAC,CAAC;AACvD,SAAO,gBAAgB,aAAa,GAAG,SAAS,UAAU,WAAW;AACvE;;;AGrFA;AAAA,OAAO,SAAS,aAAa,aAAAC,YAAW,SAAS,QAAQ,YAAAC,iBAAgB;;;ACAzE;AAAA,SAAS,WAAW,gBAAgB;AAEpC,IAAM,YAAY,MAAe;AAC/B,SAAO,QAAQ,OAAO,WAAW,eAAe,OAAO,YAAY,OAAO,SAAS,aAAa;AAClG;AAOA,IAAM,SAAS,MAAgB;AAC7B,QAAM,CAAC,SAAS,UAAU,IAAI,SAAkB,KAAK;AACrD,YAAU,MAAM;AACd,eAAW,UAAU,CAAC;AAAA,EACxB,GAAG,CAAC,CAAC;AAEL,SAAO;AAAA,IACL,WAAW;AAAA,IACX,UAAU,CAAC;AAAA,EACb;AACF;AAEA,IAAO,iBAAQ;;;ADlBf,IAAM,qBAAqB;AAAA,EACzB,OAAO;AAAA,EACP,QAAQ;AACV;AAEO,IAAK,aAAL,kBAAKC,gBAAL;AAEL,EAAAA,YAAA,aAAU;AAFA,SAAAA;AAAA,GAAA;AAwBZ,IAAM,iBAAiB;AAAA,EACrB,WAAW;AAAA,EACX;AAAA,EACA,aAAa,EAAE,OAAO,GAAG,QAAQ,EAAE;AAAA,EACnC,aAAa,CAAC,qBAAkC;AAC9C;AAAA,EACF;AACF;AACO,IAAM,eAAe,MAAM,cAAiC,cAAc;AAS1E,IAAM,mBAA0E,CAAC;AAAA,EACtF;AAAA,EACA,OAAO;AAAA,EACP,cAAc;AAAA,EACd;AACF,MAAM;AACJ,QAAM,cAAc;AACpB,QAAM,CAAC,cAAc,eAAe,IAAIC,UAAS,aAAa,WAAW;AACzE,QAAM,oBAAoB,OAAO,EAAE;AACnC,QAAM,EAAE,WAAAC,WAAU,IAAI,eAAO;AAC7B,QAAM,eAAe,QAAQ,MAAM;AACjC,UAAMC,gBAAe,YAAY,EAAE,WAAW,cAAc,OAAO,aAAa,CAAC,EAAE,CAAC;AACpF,QAAI,CAACD,YAAW;AACd,aAAOC;AAAA,IACT;AACA,QAAI,kBAAkB,SAAS;AAC7B,eAAS,gBAAgB,UAAU,OAAO,kBAAkB,OAAO;AAAA,IACrE;AACA,sBAAkB,UAAUA,cAAa;AACzC,aAAS,gBAAgB,UAAU,IAAIA,aAAY;AACnD,WAAOA;AAAA,EACT,GAAG,CAAC,WAAW,cAAcD,UAAS,CAAC;AAEvC,QAAM,cAAc,YAAY,CAAC,oBAAiC;AAChE,QAAI,iBAAiB;AACnB,sBAAgB,eAAe;AAC/B;AAAA,IACF;AACA,oBAAgB,uBAAkB;AAAA,EACpC,GAAG,CAAC,CAAC;AAEL,EAAAE,WAAU,MAAM;AACd,QAAI,WAAW;AACb,sBAAgB,SAAS;AAAA,IAC3B;AAAA,EACF,GAAG,CAAC,SAAS,CAAC;AAEd,SACE;AAAA,IAAC,aAAa;AAAA,IAAb;AAAA,MACC,OAAO,EAAE,WAAW,cAAc,OAAO,cAAkC,aAAa,YAAY;AAAA;AAAA,IAEnG;AAAA,EACH;AAEJ;AAEO,IAAM,WAAW,MAAM,MAAM,WAAW,YAAY;;;AJ5F3D,IAAM,YAAY,CAAC,UAAkB;AACnC,SAAO;AAAA,IACL,aAAa;AAAA,MACX,aAAa;AAAA,MACb,YAAY,GAAG,OAAO,KAAK;AAAA,IAC7B;AAAA,EACF;AACF;AAEO,IAAM,OAAO,OAAO,OAAO;AAAA,EAChC,SAAS;AAAA,EACT,UAAU;AAAA,IACR,SAAS;AAAA,MACP,OAAO;AAAA,QACL,gBAAgB;AAAA,MAClB;AAAA,MACA,KAAK;AAAA,QACH,gBAAgB;AAAA,MAClB;AAAA,MACA,QAAQ;AAAA,QACN,gBAAgB;AAAA,MAClB;AAAA,MACA,SAAS;AAAA,QACP,gBAAgB;AAAA,MAClB;AAAA,MACA,QAAQ;AAAA,QACN,gBAAgB;AAAA,MAClB;AAAA,MACA,QAAQ;AAAA,QACN,gBAAgB;AAAA,MAClB;AAAA,IACF;AAAA,IACA,OAAO;AAAA,MACL,OAAO;AAAA,QACL,YAAY;AAAA,MACd;AAAA,MACA,KAAK;AAAA,QACH,YAAY;AAAA,MACd;AAAA,MACA,QAAQ;AAAA,QACN,YAAY;AAAA,MACd;AAAA,MACA,UAAU;AAAA,QACR,YAAY;AAAA,MACd;AAAA,MACA,QAAQ;AAAA,QACN,YAAY;AAAA,MACd;AAAA,IACF;AAAA,IACA,WAAW;AAAA,MACT,KAAK;AAAA,QACH,eAAe;AAAA,MACjB;AAAA,MACA,QAAQ;AAAA,QACN,eAAe;AAAA,MACjB;AAAA,MACA,YAAY;AAAA,QACV,eAAe;AAAA,MACjB;AAAA,MACA,eAAe;AAAA,QACb,eAAe;AAAA,MACjB;AAAA,IACF;AAAA,IACA,KAAK;AAAA,MACH,GAAG,UAAU,CAAC;AAAA,MACd,GAAG,UAAU,CAAC;AAAA,MACd,GAAG,UAAU,CAAC;AAAA,MACd,GAAG,UAAU,CAAC;AAAA,IAChB;AAAA,EACF;AACF,CAAC;;;AM3ED;AAEO,IAAM,MAAM,OAAO,OAAO,CAAC,CAAC;;;ACFnC;;;ACAA;AAAA,OAAOC,YAAW;AAeX,IAAM,UAAU,CAACC,QAAwD;AAAxD,MAAAC,MAAAD,KAAE,SAAO,IAAI,QAAQ,QAf7C,IAewBC,KAAiC,kBAAjCA,KAAiC,CAA/B,QAAW;AACnC,yBAAAC,OAAA,cAAC,wBAAI,OAAO,MAAM,QAAQ,MAAM,SAAQ,aAAY,MAAM,OAAO,OAAM,gCAAiC,QACtG,gBAAAA,OAAA,cAAC,YAAO,IAAG,MAAK,IAAG,MAAK,GAAE,MAAK,QAAQ,OAAO,aAAY,KAAI,iBAAgB,SAAQ,MAAK,UACzF,gBAAAA,OAAA;AAAA,IAAC;AAAA;AAAA,MACC,eAAc;AAAA,MACd,eAAc;AAAA,MACd,MAAK;AAAA,MACL,MAAK;AAAA,MACL,IAAG;AAAA,MACH,KAAI;AAAA,MACJ,aAAY;AAAA;AAAA,EACd,CACF,CACF;AAAA;;;AC5BF;AAGO,IAAM,aAAa;AAAA,EACxB,SAAS;AAAA,EACT,gBAAgB;AAAA,EAChB,YAAY;AACd;AAQO,IAAM,eAAe,CAAC,WAA4B;AAAA,EACvD,UAAU;AAAA,EACV,UAAU;AAAA,EACV,cAAc;AAAA,EACd,YAAY;AAAA,EACZ,UAAU;AACZ;;;AXRA,IAAM,sBAAsB,CAC1B,MACA,OACA,QACA,UACA,MACA,iBACG;AACH,SAAO;AAAA,IACL,IAAI;AAAA,IACJ,QAAQ,0BAA0B,IAAI;AAAA,IACtC,GAAG;AAAA,IACH,eAAe;AAAA,MACb,GAAG;AAAA,MACH,IAAI;AAAA,MACJ,QAAQ,0BAA0B,QAAQ;AAAA,MAC1C,QAAQ;AAAA,IACV;AAAA,IACA,2BAA2B;AAAA,MACzB,QAAQ,0BAA0B,KAAK;AAAA,MACvC,IAAI;AAAA,IACN;AAAA,IACA,4BAA4B;AAAA,MAC1B,QAAQ,0BAA0B,MAAM;AAAA,MACxC,IAAI;AAAA,IACN;AAAA,IACA,mCAAmC;AAAA,MACjC,WAAW,oBAAoB,IAAI;AAAA,IACrC;AAAA,EACF;AACF;AAEA,IAAM,oBAAoB,CACxB,MACA,OACA,QACA,UACA,MACA,iBACG;AACH,SAAO;AAAA,IACL,IAAI;AAAA,IACJ,QAAQ,aAAa,IAAI;AAAA,IACzB,GAAG;AAAA,IACH,eAAe;AAAA,MACb,GAAG;AAAA,MACH,QAAQ;AAAA,MACR,IAAI;AAAA,MACJ,QAAQ,aAAa,QAAQ;AAAA,IAC/B;AAAA,IACA,2BAA2B;AAAA,MACzB,IAAI;AAAA,MACJ,QAAQ,aAAa,KAAK;AAAA,IAC5B;AAAA,IACA,4BAA4B;AAAA,MAC1B,IAAI;AAAA,MACJ,QAAQ,aAAa,MAAM;AAAA,IAC7B;AAAA,IACA,mCAAmC;AAAA,MACjC,WAAW,aAAa,IAAI;AAAA,IAC9B;AAAA,EACF;AACF;AAEA,IAAM,eAAe,OAAO,UAAU,iCACjC,aADiC;AAAA,EAEpC,QAAQ;AAAA,EACR,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,eAAe;AAAA,EACf,UAAU;AAAA,EACV,SAAS;AAAA,EACT,QAAQ;AAAA,EACR,IAAI;AAAA,EACJ,GAAG;AAAA,EACH,iBAAiB;AAAA,EACjB,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,GAAG;AAAA,EACH,sBAAsB;AAAA,EACtB,WAAW;AAAA,IACT,SAAS;AAAA,EACX;AAAA,EACA,mCAAmC;AAAA,IACjC,WAAW;AAAA,EACb;AAAA,EACA,YAAY;AAAA,EACZ,kBAAkB;AAAA,IAChB;AAAA,MACE,SAAS;AAAA,MACT,UAAU;AAAA,MACV,KAAK;AAAA,QACH;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAAA,IACA;AAAA,MACE,SAAS;AAAA,MACT,UAAU;AAAA,MACV,KAAK;AAAA,QACH;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAAA,IACA;AAAA,MACE,SAAS;AAAA,MACT,UAAU;AAAA,MACV,KAAK;AAAA,QACH;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EACA,UAAU;AAAA,IACR,SAAS;AAAA,MACP,UAAU;AAAA,QACR;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,MACA,QAAQ;AAAA,QACN;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,MACA,SAAS;AAAA,QACP;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAAA,IACA,UAAU;AAAA,MACR,MAAM,CAAC;AAAA,IACT;AAAA,IACA,MAAM;AAAA,MACJ,MAAM,CAAC;AAAA,IACT;AAAA,EACF;AAAA,EACA,iBAAiB;AAAA,IACf,SAAS;AAAA,EACX;AACF,EAAC;AAEM,IAAM,SAASC,OAAM,WAG1B,CAACC,KAAqD,QAAQ;AAA7D,MAAAC,MAAAD,KAAE,YAAU,UAAU,OAAO,KApLhC,IAoLGC,KAAsC,wBAAtCA,KAAsC,CAApC,YAAU,WAAiB;AAC9B,SACE,gBAAAF,OAAA,cAAC,+CAAiB,cAAjB,EAA8B,QAC7B,gBAAAA,OAAA,cAAAA,OAAA,gBACG,WACC,gBAAAA,OAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,KAAK,EAAE,GAAG,QAAQ,UAAU,YAAY,MAAM,KAAK,OAAO,kBAAkB;AAAA;AAAA,IAE5E,gBAAAA,OAAA,cAAC,WAAQ,OAAM,gBAAe;AAAA,EAChC,GAEF,gBAAAA,OAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,KAAK,EAAE,YAAY,UAAU,WAAW,WAAW,KAAK,OAAO,OAAO,IAAI;AAAA;AAAA,IAEzE;AAAA,EACH,CACF,CACF;AAEJ,CAAC;;;AY3MD;;;ACAA;AAEO,IAAM,eAAe;AAAA,EAC1B,IAAI;AAAA,IACF,YAAY;AAAA,IACZ,eAAe;AAAA,IACf,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,OAAO;AAAA,MACL,UAAU;AAAA,MACV,YAAY;AAAA,IACd;AAAA,EACF;AAAA,EACA,IAAI;AAAA,IACF,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,eAAe;AAAA,IACf,OAAO;AAAA,MACL,UAAU;AAAA,MACV,YAAY;AAAA,IACd;AAAA,EACF;AAAA,EACA,IAAI;AAAA,IACF,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,OAAO;AAAA,MACL,UAAU;AAAA,MACV,YAAY;AAAA,IACd;AAAA,EACF;AAAA,EACA,IAAI;AAAA,IACF,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,eAAe;AAAA,IACf,OAAO;AAAA,MACL,UAAU;AAAA,MACV,YAAY;AAAA,IACd;AAAA,EACF;AAAA,EACA,IAAI;AAAA,IACF,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,OAAO;AAAA,MACL,UAAU;AAAA,MACV,YAAY;AAAA,IACd;AAAA,EACF;AAAA,EACA,IAAI;AAAA,IACF,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,eAAe;AAAA,IACf,OAAO;AAAA,MACL,UAAU;AAAA,MACV,YAAY;AAAA,IACd;AAAA,EACF;AAAA,EACA,MAAM;AAAA,IACJ,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,eAAe;AAAA,EACjB;AAAA,EACA,MAAM;AAAA,IACJ,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,eAAe;AAAA,EACjB;AAAA,EACA,OAAO;AAAA,IACL,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,eAAe;AAAA,EACjB;AAAA,EACA,OAAO;AAAA,IACL,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,eAAe;AAAA,EACjB;AAAA,EACA,QAAQ;AAAA,IACN,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,eAAe;AAAA,EACjB;AAAA,EACA,SAAS;AAAA,IACP,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,eAAe;AAAA,IACf,YAAY;AAAA,EACd;AAAA,EACA,UAAU;AAAA,IACR,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,eAAe;AAAA,IACf,YAAY;AAAA,EACd;AAAA,EACA,MAAM;AAAA,IACJ,UAAU;AAAA,IACV,YAAY;AAAA,EACd;AAAA,EACA,IAAI;AAAA,IACF,UAAU;AAAA,IACV,YAAY;AAAA,EACd;AAAA,EACA,IAAI;AAAA,IACF,UAAU;AAAA,IACV,YAAY;AAAA,EACd;AAAA,EACA,IAAI;AAAA,IACF,UAAU;AAAA,IACV,YAAY;AAAA,EACd;AAAA,EACA,IAAI;AAAA,IACF,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,eAAe;AAAA,EACjB;AACF;AAEO,IAAM,OAAO,OAAO,KAAK;AAAA,EAC9B,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,UAAU;AAAA,IACR,SAAS;AAAA,IACT,OAAO;AAAA,MACL,OAAO;AAAA,QACL,OAAO;AAAA,MACT;AAAA,IACF;AAAA,IACA,QAAQ;AAAA,MACN,MAAM;AAAA,QACJ,SAAS;AAAA,MACX;AAAA,IACF;AAAA,EACF;AAAA,EACA,iBAAiB;AAAA,IACf,SAAS;AAAA,EACX;AACF,CAAC;;;ACpJD;;;ACAA;AAGO,IAAM,aAAa,OAAO,UAAU,iCACtC,aADsC;AAAA,EAEzC,YAAY;AAAA,EACZ,SAAS;AAAA,EACT,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,GAAG;AAAA,EACH,QAAQ;AAAA,EACR,iBAAiB;AAAA,EACjB,OAAO;AAAA,EACP,mCAAmC;AAAA,IACjC,WAAW;AAAA,EACb;AAAA,EACA,2BAA2B;AAAA,IACzB,SAAS;AAAA,EACX;AAAA,EACA,yBAAyB;AAAA,IACvB,2BAA2B;AAAA,MACzB,iBAAiB;AAAA,IACnB;AAAA,EACF;AAAA,EACA,eAAe;AAAA,IACb,SAAS;AAAA,IACT,QAAQ;AAAA,IACR,iBAAiB;AAAA,IACjB,OAAO;AAAA,EACT;AAAA,EACA,WAAW;AAAA,IACT,SAAS;AAAA,EACX;AAAA,EACA,UAAU;AAAA,IACR,QAAQ;AAAA,MACN,MAAM;AAAA,QACJ,2BAA2B;AAAA,UACzB,iBAAiB;AAAA,QACnB;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF,EAAC;;;AC1CD;;;ACAA;AAAA,OAAOG,YAAW;AAElB,SAAS,kBAAkB;;;ACF3B;AAAA,IAAM,cAAc,CAAC,SAA6B;AAAlD,MAAAC,KAAAC,KAAA;AACE,MAAI,CAAC,MAAM;AACT,WAAO;AAAA,EACT,OAAO;AACL,YACE,MAAAA,OAAAD,MAAA,KACG,KAAK,EAEL,QAAQ,iBAAiB,EAAE,EAC3B,MAAM,iBAAiB,MAJ1B,gBAAAA,IAKI,KAAK,QALT,gBAAAC,IAMI,MAAM,mBANV,mBAOI,KAAK,IACN;AAAA,EAEP;AACF;AAKO,IAAM,cAAc,CAAC,SAAsD;AAChF,QAAM,WAAW,YAAY,IAAI;AACjC,QAAM,cAAc;AACpB,QAAM,eAAe,qCAAU,YAAY,OAAM,KAAK,cAAe;AACrE,SAAO,EAAE,UAAU,YAAY,IAAI,OAAO,WAAW,aAAa,CAAC,EAAE;AACvE;AAEA,IAAM,aAAa;AAAA,EACjB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;;;AD1CA,IAAM,iBAAiB,CAAC,WAAmB;AAAA,EACzC,cAAc;AAChB;AAEO,IAAM,eAAe,OAAO,OAAO,iCACrC,aADqC;AAAA,EAExC,OAAO;AAAA,EACP,YAAY;AAAA,EACZ,aAAa;AAAA,EACb,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,UAAU;AAAA,IACR,OAAO;AAAA,MACL,QAAQ,eAAe,QAAQ;AAAA,MAC/B,QAAQ,eAAe,IAAI;AAAA,IAC7B;AAAA,IACA,MAAM;AAAA,MACJ,OAAO;AAAA,QACL,QAAQ;AAAA,QACR,UAAU;AAAA,MACZ;AAAA,MACA,QAAQ;AAAA,QACN,QAAQ;AAAA,QACR,UAAU;AAAA,MACZ;AAAA,MACA,OAAO;AAAA,QACL,QAAQ;AAAA,QACR,UAAU;AAAA,MACZ;AAAA,IACF;AAAA,EACF;AAAA,EACA,iBAAiB;AAAA,IACf,OAAO;AAAA,EACT;AACF,EAAC;AAOM,IAAM,SAA0B,CAACC,QAA4B;AAA5B,MAAAC,MAAAD,KAAE,QAAM,KAAAE,KAhDhD,IAgDwCD,KAAgB,kBAAhBA,KAAgB,CAAd,QAAM;AAC9C,QAAM,OAAO,YAAY,IAAI;AAC7B,MAAI,EAAE,MAAM,IAAI;AAChB,MAAI,CAAC,MAAM;AACT,YAAQ;AAAA,EACV;AACA,SACE,gBAAAE,OAAA,cAAC,+BAAa,KAAK,iBAAE,IAAI,SAAUD,SAAW,QAC3C,KAAK,YAAY,gBAAAC,OAAA,cAAC,cAAW,QAAQ,IAAI,OAAO,IAAI,CACvD;AAEJ;;;AE3DA;;;ACAA;AAEA,IAAM,mBAAmB,CAAC,WAAmB;AAAA,EAC3C,YAAY;AAAA,EACZ,aAAa;AACf;AACA,IAAM,qBAAqB,CAAC,WAAmB;AAAA,EAC7C,WAAW;AAAA,EACX,cAAc;AAChB;AAEO,IAAM,kBAAkB,OAAO,QAAQ;AAAA,EAC5C,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,iBAAiB;AAAA,EACjB,UAAU;AAAA,IACR,OAAO;AAAA,MACL,GAAG,iBAAiB,IAAI;AAAA,MACxB,GAAG,iBAAiB,IAAI;AAAA,MACxB,GAAG,iBAAiB,IAAI;AAAA,MACxB,GAAG,iBAAiB,IAAI;AAAA,IAC1B;AAAA,EACF;AAAA,EACA,iBAAiB;AAAA,IACf,OAAO;AAAA,EACT;AACF,CAAC;AAEM,IAAM,oBAAoB,OAAO,QAAQ;AAAA,EAC9C,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,SAAS;AAAA,EACT,iBAAiB;AAAA,EACjB,UAAU;AAAA,IACR,OAAO;AAAA,MACL,GAAG,mBAAmB,IAAI;AAAA,MAC1B,GAAG,mBAAmB,IAAI;AAAA,MAC1B,GAAG,mBAAmB,IAAI;AAAA,MAC1B,GAAG,mBAAmB,IAAI;AAAA,IAC5B;AAAA,EACF;AAAA,EACA,iBAAiB;AAAA,IACf,OAAO;AAAA,EACT;AACF,CAAC;;;AC5CD;;;ACAA;AAAA,OAAOC,YAAW;AAClB,YAAY,gBAAgB;AAG5B,IAAM,aAAa,OAAkB,iBAAM;AAAA,EACzC,KAAK;AAAA,EACL,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,cAAc;AAAA,EACd,GAAG;AAAA,EACH,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,2BAA2B;AAAA,IACzB,iBAAiB;AAAA,IACjB,QAAQ;AAAA,EACV;AAAA,EACA,WAAW;AAAA,IACT,SAAS;AAAA,EACX;AAAA,EACA,eAAe;AAAA,IACb,SAAS;AAAA,IACT,QAAQ;AAAA,EACV;AACF,CAAC;AAED,IAAM,cAAc,OAAkB,kBAAO;AAAA,EAC3C,SAAS;AAAA,EACT,KAAK;AAAA,EACL,UAAU;AAAA,EACV,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,iBAAiB;AAAA,EACjB,cAAc;AAAA,EACd,YAAY;AAAA,EACZ,MAAM;AAAA,EACN,2BAA2B;AAAA,IACzB,MAAM;AAAA,IACN,OAAO;AAAA,IACP,iBAAiB;AAAA,EACnB;AACF,CAAC;AAIM,IAAM,SAAgC,WAC3C,gBAAAC,OAAA,cAAC,+BAAe,QACd,gBAAAA,OAAA,cAAC,iBAAY,CACf;AAGF,OAAO,cAAc;;;ACnDrB;;;ACAA;AAAA,OAAOC,UAA4B,YAAAC,iBAAgB;AACnD,YAAY,iBAAiB;;;ACD7B;AAEO,IAAM,YAAY,CAAC,eACxB,UAAU;AAAA,EACR,MAAM,EAAE,QAAQ,EAAE;AAAA,EAClB,IAAI,EAAE,QAAQ,OAAO,UAAU,IAAI;AACrC,CAAC;AAEI,IAAM,UAAU,CAAC,eACtB,UAAU;AAAA,EACR,MAAM,EAAE,QAAQ,OAAO,UAAU,IAAI;AAAA,EACrC,IAAI,EAAE,QAAQ,EAAE;AAClB,CAAC;AAEI,IAAM,kBAAkB,CAAC,EAAE,QAAQ,KAAK,QAAQ,KAAK,QAAQ,KAAK,MAAM,KAAK,MAAM,KAAK,MAAM,IAAI,MACvG,UAAU;AAAA,EACR,MAAM,EAAE,WAAW,eAAe,KAAK,KAAK,KAAK,KAAK,KAAK,IAAI;AAAA,EAC/D,IAAI,EAAE,WAAW,eAAe,GAAG,KAAK,GAAG,KAAK,GAAG,GAAG;AACxD,CAAC;AAEI,IAAM,aAAa,UAAU;AAAA,EAClC,MAAM,EAAE,SAAS,GAAG,WAAW,mCAAmC;AAAA,EAClE,QAAQ,EAAE,SAAS,GAAG,WAAW,iCAAiC;AACpE,CAAC;AAEM,IAAM,cAAc,UAAU;AAAA,EACnC,MAAM,EAAE,SAAS,GAAG,WAAW,iCAAiC;AAAA,EAChE,QAAQ,EAAE,SAAS,GAAG,WAAW,mCAAmC;AACtE,CAAC;AAEM,IAAM,iBAAiB,CAAC,QAAQ,UACrC,UAAU;AAAA,EACR,MAAM,EAAE,SAAS,GAAG,WAAW,cAAc,KAAK,IAAI;AAAA,EACtD,QAAQ,EAAE,SAAS,GAAG,WAAW,gBAAgB;AACnD,CAAC;AAEI,IAAM,oBAAoB,CAAC,QAAQ,WACxC,UAAU;AAAA,EACR,MAAM,EAAE,SAAS,GAAG,WAAW,cAAc,KAAK,IAAI;AAAA,EACtD,QAAQ,EAAE,SAAS,GAAG,WAAW,gBAAgB;AACnD,CAAC;AAEI,IAAM,eAAe,UAAU;AAAA,EACpC,MAAM,EAAE,WAAW,mBAAmB;AAAA,EACtC,IAAI,EAAE,WAAW,qBAAqB;AACxC,CAAC;AAEM,IAAM,gBAAgB,UAAU;AAAA,EACrC,MAAM,EAAE,WAAW,qBAAqB;AAAA,EACxC,IAAI,EAAE,WAAW,mBAAmB;AACtC,CAAC;AACM,IAAM,cAAc,UAAU;AAAA,EACnC,MAAM,EAAE,SAAS,IAAI;AAAA,EACrB,IAAI,EAAE,SAAS,IAAI;AACrB,CAAC;AAEM,IAAM,eAAe,UAAU;AAAA,EACpC,MAAM,EAAE,SAAS,IAAI;AAAA,EACrB,IAAI,EAAE,SAAS,IAAI;AACrB,CAAC;AACM,IAAM,mBAAmB,CAAC,QAAQ,WACvC,UAAU;AAAA,EACR,MAAM,EAAE,SAAS,GAAG,WAAW,cAAc,KAAK,IAAI;AAAA,EACtD,QAAQ,EAAE,SAAS,GAAG,WAAW,gBAAgB;AACnD,CAAC;AAEI,IAAM,mBAAmB,CAAC,QAAQ,UACvC,UAAU;AAAA,EACR,MAAM,EAAE,SAAS,GAAG,WAAW,cAAc,KAAK,IAAI;AAAA,EACtD,QAAQ,EAAE,SAAS,GAAG,WAAW,gBAAgB;AACnD,CAAC;AAEH,IAAM,sBAAsB,CAAC,MAAM,YACjC,UAAU;AAAA,EACR,MAAM,EAAE,SAAS,GAAG,WAAW,gBAAgB;AAAA,EAC/C,QAAQ,EAAE,SAAS,GAAG,WAAW,cAAc,GAAG,IAAI;AACxD,CAAC;AAEI,IAAM,mBAAmB;AAAA,EAC9B,kDAAkD;AAAA,IAChD,mBAAmB;AAAA,IACnB,yBAAyB;AAAA,IACzB,YAAY;AAAA,IACZ,wBAAwB;AAAA,MACtB,sBAAsB,EAAE,eAAe,iBAAiB,EAAE;AAAA,MAC1D,wBAAwB,EAAE,eAAe,iBAAiB,EAAE;AAAA,MAC5D,yBAAyB,EAAE,eAAe,eAAe,EAAE;AAAA,MAC3D,uBAAuB,EAAE,eAAe,kBAAkB,EAAE;AAAA,IAC9D;AAAA,EACF;AACF;AAEO,IAAM,iBAAiB;AAAA,EAC5B,kDAAkD;AAAA,IAChD,mBAAmB;AAAA,IACnB,yBAAyB;AAAA,IACzB,YAAY;AAAA,IACZ,eAAe,oBAAoB;AAAA,IAEnC,wBAAwB;AAAA,MACtB,eAAe,kBAAkB,OAAO;AAAA,IAC1C;AAAA,IACA,wBAAwB;AAAA,MACtB,WAAW;AAAA,IACb;AAAA,IACA,0BAA0B;AAAA,MACxB,WAAW;AAAA,MACX,YAAY;AAAA,IACd;AAAA,IACA,uBAAuB;AAAA,MACrB,WAAW,GAAG,oBAAoB,CAAC;AAAA,IACrC;AAAA,EACF;AACF;;;AD5GA,IAAM,aAAa,OAAmB,qBAAS;AAAA,EAC7C,YAAY;AAAA,EACZ,cAAc;AAAA,EACd,SAAS;AAAA,EACT,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,iBAAiB;AAAA,EACjB,kDAAkD;AAAA,IAChD,mBAAmB;AAAA,IACnB,yBAAyB;AAAA,IACzB,YAAY;AAAA,IACZ,gCAAgC;AAAA,MAC9B,sBAAsB,EAAE,eAAe,iBAAiB,EAAE;AAAA,MAC1D,wBAAwB,EAAE,eAAe,iBAAiB,EAAE;AAAA,MAC5D,yBAAyB,EAAE,eAAe,eAAe,EAAE;AAAA,MAC3D,uBAAuB,EAAE,eAAe,kBAAkB,EAAE;AAAA,IAC9D;AAAA,EACF;AAAA,EACA,UAAU;AAAA,IACR,UAAU;AAAA,MACR,MAAM;AAAA,QACJ,iBAAiB;AAAA,QACjB,QAAQ;AAAA,MACV;AAAA,IACF;AAAA,EACF;AACF,CAAC;AAED,IAAM,iBAAiB,OAAmB,qBAAS;AAAA,EACjD,YAAY;AACd,CAAC;AAED,IAAM,cAA0B;AAIzB,IAAM,UAWT,CAAC;AAAA,EACH;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,WAAW;AAAA,EACX,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,WAAW;AAAA,EACX,gBAAgB;AAClB,MAAM;AACJ,QAAM,CAAC,MAAM,OAAO,IAAIC,UAAS,KAAK;AAEtC,SACE,gBAAAC,OAAA,cAAa,sBAAZ,MACC,gBAAAA,OAAA,cAAC,eAAY,eAA8B,MAAM,QAAQ,CAAC,UAAU,cAAc,WAChF,gBAAAA,OAAA,cAAC,kBAAe,KAAK,mBAAK,aAAc,SAAO,QAC5C,QACH,GACA,gBAAAA,OAAA,cAAC,cAAW,YAAY,IAAI,MAAY,OAAc,UAAoB,KAAK,mBAAK,WACjF,KACH,CACF,CACF;AAEJ;;;AE9EA;;;ACAA;AAAA,OAAOC,YAAW;AAClB,SAAS,uBAAuB;AAGhC,IAAMC,QAAO,OAAO,OAAO;AAAA,EACzB,OAAO;AAAA,EACP,SAAS;AAAA,EACT,UAAU;AAAA,EACV,SAAS;AAAA,EACT,UAAU;AAAA,EACV,cAAc;AAAA,EACd,iBAAiB;AAAA,EACjB,UAAU;AACZ,CAAC;AAGD,IAAM,aAAa,OAAO,UAAU;AAAA,EAClC,GAAG;AAAA,EACH,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,eAAe;AAAA,EACf,YAAY;AAAA,EACZ,OAAO;AAAA,EACP,SAAS;AAAA,EACT,aAAa;AAAA,EACb,cAAc;AAAA,EACd,QAAQ;AAAA,EACR,cAAc;AAAA,EACd,iBAAiB;AAAA,EACjB,mCAAmC;AAAA,IACjC,WAAW;AAAA,EACb;AAAA,EACA,eAAe;AAAA,IACb,SAAS;AAAA,IACT,QAAQ;AAAA,EACV;AACF,CAAC;AAED,IAAM,QAAQ,OAAO,QAAQ;AAAA,EAC3B,OAAO;AAAA,EACP,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,UAAU;AAAA,EACV,OAAO;AAAA,EACP,eAAe;AAAA,EACf,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,YAAY;AACd,CAAC;AAED,IAAM,kBAAkB,CAACC,QAAc;AAAd,MAAK,kBAALA,KAAK;AAC5B,yBAAAC,OAAA,cAAC,0BAAU,QACT,gBAAAA,OAAA,cAAC,qBAAgB,CACnB;AAAA;AAGK,IAAM,SAAS;AAAA,EACpB,MAAAF;AAAA,EACA,UAAU;AAAA,EACV;AAAA,EACA,QAAQ;AACV;;;AC9DA;;;ACAA;AAAA,OAAOG,YAAW;AAClB,YAAY,gBAAgB;AAK5B,IAAMC,QAAO,OAAkB,iBAAM;AAAA,EACnC,UAAU;AAAA,EACV,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,aAAa;AAAA,EACb,OAAO;AAAA,EACP,oCAAoC;AAAA,IAClC,QAAQ;AAAA,EACV;AACF,CAAC;AAED,IAAMC,SAAQ,OAAkB,kBAAO;AAAA,EACrC,iBAAiB;AAAA,EACjB,UAAU;AAAA,EACV,UAAU;AAAA,EACV,cAAc;AAAA,EACd,QAAQ;AAAA,EACR,oCAAoC,EAAE,QAAQ,EAAE;AAClD,CAAC;AAED,IAAMC,SAAQ,OAAkB,kBAAO;AAAA,EACrC,UAAU;AAAA,EACV,iBAAiB;AAAA,EACjB,cAAc;AAAA,EACd,QAAQ;AACV,CAAC;AAED,IAAMC,SAAQ,OAAkB,kBAAO;AAAA,EACrC,KAAK;AAAA,EACL,SAAS;AAAA,EACT,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,iBAAiB;AAAA,EACjB,QAAQ;AAAA,EACR,WAAW;AAAA,EACX,cAAc;AAAA,EACd,WAAW,EAAE,iBAAiB,mBAAmB;AAAA,EACjD,WAAW,EAAE,WAAW,OAAO;AACjC,CAAC;AAOM,IAAM,SAA4D,CAACC,QAIvE;AAJuE,MAAAC,MAAAD,KACxE;AAAA,kBAAc;AAAA,IACd;AAAA,EAtDF,IAoD0EC,KAGrE,kBAHqEA,KAGrE;AAAA,IAFH;AAAA,IACA;AAAA;AAtDF,MAAAD;AAyDE,yBAAAE,OAAA,cAACN,OAAA,mBAAS,QACR,gBAAAM,OAAA,cAACL,QAAA,MACC,gBAAAK,OAAA,cAACJ,QAAA,IAAM,CACT,GACC,cACC,gBAAAI,OAAA,cAAC,WAAQ,OAAO,QAAOF,MAAA,MAAM,UAAN,gBAAAA,IAAc,EAAE,KACrC,gBAAAE,OAAA,cAACH,QAAA,EAAM,KAAK,aAAa,CAC3B,IAEA,gBAAAG,OAAA,cAACH,QAAA,EAAM,KAAK,aAAa,CAE7B;AAAA;;;ACpEF;;;ACAA;AAAA,OAAOI,WAAoB,aAAAC,YAAW,UAAAC,eAAc;AACpD,SAAS,QAAAC,aAAY;AACrB,SAAS,UAAAC,eAAc;;;ACFvB;AAAA,OAAOC,YAA+B;AACtC,YAAY,qBAAqB;AACjC,SAAS,iBAAiB;AAKnB,IAAM,cAAc,OAAuB,uBAAO;AAAA,EACvD,iBAAiB;AAAA,EACjB,SAAS;AAAA,EACT,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,iBAAiB;AACnB,CAAC;AAEM,IAAM,sBAAsB,OAAuB,yBAAS;AAAA,EACjE,YAAY;AAAA;AACd,CAAC;AAEM,IAAM,sBAAsB,OAAuB,yBAAS;AAAA,EACjE,iBAAiB;AAAA,EACjB,UAAU;AAAA,EACV,OAAO;AACT,CAAC;AAEM,IAAM,qBAAqB,OAAuB,wBAAQ,CAAC,CAAC;AAE5D,IAAM,sBAAsB,OAAuB,yBAAS;AAAA,EACjE,OAAO;AAAA,EACP,iBAAiB;AAAA,EACjB,cAAc;AAAA,EACd,UAAU;AAAA,EACV,KAAK;AAAA,EACL,MAAM;AAAA,EACN,WAAW;AAAA,EACX,WAAW;AAAA,EACX,QAAQ;AAAA,EACR,WAAW;AAAA,EACX,WAAW;AAAA,EACX,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,gBAAgB;AAAA,IACd,wBAAwB;AAAA,MACtB,WAAW,GAAG,UAAU;AAAA,IAC1B;AAAA,IACA,0BAA0B;AAAA,MACxB,WAAW,GAAG,WAAW;AAAA,IAC3B;AAAA,EACF;AAAA,EACA,WAAW,EAAE,SAAS,OAAO;AAC/B,CAAC;AAEM,IAAM,cAAc,OAAuB,uBAAO;AAAA,EACvD,QAAQ;AACV,CAAC;AAEM,IAAM,oBAAoB,OAAuB,6BAAa,CAAC,CAAC;AAEhE,IAAM,yBAAyB,CAAC,UACrC,gBAAAC,OAAA,cAAC,eAAY,SAAO,QAClB,gBAAAA,OAAA,cAAC,+BAAe,QACd,gBAAAA,OAAA,cAAC,eAAU,CACb,CACF;;;AC/DF;AAAA,SAAS,kBAAkB;;;ACA3B;AAAA,OAAOC,WAAS,qBAAgC;AAEzC,IAAM,yBAAyB,cAAc,EAAE;AAE/C,SAAS,wBAAwB;AAAA,EACtC;AAAA,EACA;AACF,GAGG;AACD,SAAO,gBAAAA,QAAA,cAAC,uBAAuB,UAAvB,EAAgC,OAAO,2BAA0B,QAAS;AACpF;;;ADTO,SAAS,6BAA6B;AAC3C,QAAM,0BAA0B,WAAW,sBAAsB;AACjE,SAAO;AACT;;;AFSA,IAAM,eAAeC,QAAOC,OAAM,CAAC,CAAC;AAIpC,IAAM,aAAa,CAAsD,UAAa;AACpF,EAAAC,WAAU,MAAM;AACd,WAAO,MAAM;AACX,UAAI;AAAU,mBAAW,MAAO,SAAS,KAAK,MAAM,gBAAgB,QAAS,CAAC;AAAA,IAChF;AAAA,EACF,GAAG,CAAC,CAAC;AACL,SAAO,gBAAAC,QAAA,cAAC,iCAAkB,MAAkB;AAC9C;AAEA,IAAM,qBAAqB,CAAC,EAAE,UAAU,UAAU,MAA+D;AAC/G,QAAM,0BAA0B,2BAA2B;AAC3D,QAAM,eAAeC,QAA2B,IAAI;AAEpD,MAAI,WAAW;AACb,iBAAa,UAAU;AAAA,EACzB,WAAW,2BAA2B,CAAC,aAAa,SAAS;AAC3D,iBAAa,UAAU,SAAS,cAAc,uBAAuB;AAAA,EACvE,WAAW,CAAC,aAAa,SAAS;AAChC,iBAAa,UAAU,SAAS;AAAA,EAClC;AACA,SACE,gBAAAD,QAAA,cAAC,sBAAmB,WAAW,aAAa,WAC1C,gBAAAA,QAAA,cAAAA,QAAA,gBAAG,QAAS,CACd;AAEJ;AAEO,IAAM,SAAS;AAAA,EACpB,MAAM;AAAA,EACN,SAAS;AAAA,EACT,SAAS;AAAA,EACT,SAAS;AAAA,EACT,OAAO;AAAA,EACP,aAAa;AAAA,EACb,OAAO;AAAA,EACP,cAAc;AAAA,EACd,QAAQ;AACV;;;AIxDA;AAAA,OAAOE,aAAgE;AAEvE,SAAS,UAAU,cAAc,mBAAmB;AAI7C,IAAM,QAAQ,OAAO,SAAS;AAAA,EACnC,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,iBAAiB;AAAA,EACjB,cAAc;AAAA,EACd,SAAS;AAAA,EACT,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,WAAW;AAAA,EACX,OAAO;AAAA,EACP,UAAU;AAAA,EACV,WAAW;AAAA,IACT,WAAW;AAAA,IACX,QAAQ;AAAA,EACV;AAAA,EACA,kBAAkB;AAAA,IAChB,OAAO;AAAA,EACT;AAAA,EACA,UAAU;AAAA,IACR,OAAO;AAAA,MACL,MAAM;AAAA,QACJ,WAAW;AAAA,UACT,WAAW;AAAA,QACb;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF,CAAC;AAED,IAAM,eAAe,OAAO,OAAO;AAAA,EACjC,GAAG;AAAA,EACH,UAAU;AAAA,EACV,SAAS;AACX,CAAC;AAED,IAAM,mBAAkG,CAACC,QAInG;AAJmG,MAAAC,MAAAD,KACvG;AAAA;AAAA,IACA,KAAAE;AAAA,EA3CF,IAyCyGD,KAGpG,kBAHoGA,KAGpG;AAAA,IAFH;AAAA,IACA;AAAA;AAGA,SACE,gBAAAE,QAAA,cAAC,uBAAK,KAAK,mBAAKD,SAAW,QACxB,eAAe,gBAAAC,QAAA,cAAC,iBAAY,IAAK,gBAAAA,QAAA,cAAC,kBAAa,CAClD;AAEJ;AAEA,IAAM,mBAA0E,CAACH,QAAsB;AAAtB,MAAAC,MAAAD,KAAE,OAAAE,KArDnF,IAqDiFD,KAAU,kBAAVA,KAAU,CAAR;AACjF,SACE,gBAAAE,QAAA,cAAC,uBAAK,KAAK,mBAAKD,SAAW,QACzB,gBAAAC,QAAA,cAAC,cAAS,CACZ;AAEJ;AAEA,IAAM,gBAAgBA,QAAM;AAAA,EAC1B,CAACH,KAAmB,QAAQ;AAA3B,QAAAC,MAAAD,KAAE,OAAAE,KA9DL,IA8DGD,KAAU,kBAAVA,KAAU,CAAR;AACD,WACE,gBAAAE,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,UAAU;AAAA,UACV,KAAK;AAAA,UACL,QAAQ;AAAA,UACR,QAAQ;AAAA,UACR,OAAO;AAAA,UACP,IAAI;AAAA,UACJ,YAAY;AAAA,WACTD;AAAA,QAEL;AAAA,SACI;AAAA,MAEH,MAAM;AAAA,IACT;AAAA,EAEJ;AACF;AAEA,IAAM,aACJC,QAAM,WAGJ,CAACH,KAAyC,QAAQ;AAAjD,MAAAC,MAAAD,KAAE,iBAAe,OAAO,KAAAE,KAxF7B,IAwFKD,KAAgC,kBAAhCA,KAAgC,CAA9B,gBAAsB;AACzB,SACE,gBAAAE,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,iBAAE,UAAU,GAAG,OAAO,UAAWD;AAAA,MACtC,MAAM,eAAe,SAAS;AAAA,OAC1B,QAHL;AAAA,MAIC;AAAA;AAAA,EACF;AAEJ,CAAC;AAEI,IAAM,gBAAgB;AAAA,EAC3B,MAAM;AAAA,EACN,OAAO;AAAA,EACP,OAAO;AAAA,EACP,UAAU;AAAA,EACV,UAAU;AACZ;;;ACzGA;;;ACAA;AAIO,IAAME,QAAO,OAAO,OAAO;AAAA,EAChC,SAAS;AAAA;AAAA;AAAA;AAAA;AAKX,CAAC;AAED,IAAM,YAAY,OAAO,OAAO;AAAA,EAC9B,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,UAAU;AAAA,EACV,UAAU;AAAA,EACV,cAAc;AAAA,EACd,SAAS;AAAA,EACT,gBAAgB;AAAA,EAChB,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,UAAU;AAAA,IACR,eAAe;AAAA,MACb,MAAM;AAAA,QACJ,YAAY;AAAA,MACd;AAAA,IACF;AAAA,IACA,UAAU;AAAA,MACR,MAAM;AAAA,QACJ,cAAc;AAAA,MAChB;AAAA,IACF;AAAA,EACF;AACF,CAAC;AAED,IAAMC,WAAU,OAAO,OAAO;AAAA,EAC5B,UAAU;AAAA,EACV,OAAO;AAAA,EACP,QAAQ;AACV,CAAC;AAED,IAAM,OAAO,OAAO,OAAO;AAAA,EACzB,OAAO;AAAA,EACP,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,MAAM;AAAA,EACN,UAAU;AAAA,EACV,WAAW;AAAA,EACX,WAAW;AAAA,EACX,OAAO;AAAA,EACP,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,cAAc;AAAA,EACd,YAAY;AACd,CAAC;AAED,IAAM,eAAe,OAAO,OAAO;AAAA,EACjC,UAAU;AAAA,EACV,KAAK;AAAA,EACL,OAAO;AAAA,EACP,IAAI;AAAA,EACJ,cAAc;AAAA,EACd,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,IAAI;AAAA,GACD,aAT8B;AAAA,EAUjC,UAAU;AAAA,IACR,MAAM;AAAA,MACJ,OAAO;AAAA,QACL,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,WAAW;AAAA,UACT,OAAO;AAAA,UACP,QAAQ;AAAA,QACV;AAAA,MACF;AAAA,MACA,QAAQ;AAAA,QACN,OAAO;AAAA,QACP,QAAQ;AAAA,MACV;AAAA,IACF;AAAA,IACA,UAAU;AAAA,MACR,MAAM,EAAE,MAAM,KAAK;AAAA,MACnB,OAAO,EAAE,OAAO,KAAK;AAAA,IACvB;AAAA,EACF;AAAA,EACA,iBAAiB;AAAA,IACf,MAAM;AAAA,IACN,UAAU;AAAA,EACZ;AACF,EAAC;AAED,IAAM,iBAAiB,OAAO,cAAc,EAAE,iBAAiB,EAAE,UAAU,QAAQ,EAAE,CAAC;AAEtF,IAAM,mBAAmB,OAAO,UAAU;AAAA,EACxC,QAAQ;AAAA,EACR,GAAG;AAAA,EACH,OAAO;AAAA,EACP,cAAc;AAAA,EACd,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,gBAAgB;AAAA,EAChB,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,KAAK;AAAA,EACL,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,2BAA2B;AAAA,IACzB,SAAS;AAAA,IACT,WAAW;AAAA,EACb;AACF,CAAC;AAED,IAAM,kBAAkB,OAAO,KAAK,iCAC/B,aAD+B;AAAA,EAElC,eAAe;AAAA,EACf,UAAU;AAAA,EACV,MAAM;AAAA,EACN,KAAK;AAAA,EACL,WAAW;AAAA,EACX,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,WAAW;AAAA,IACT,WAAW;AAAA,IACX,QAAQ;AAAA,EACV;AACF,EAAC;AAaM,IAAM,kBAAiC;AAAA,EAC5C,MAAAD;AAAA,EACA;AAAA,EACA,SAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;;;ACrJA;;;ACAA;AAAO,IAAM,UAAU,CAAC,OAAe,qBAA6B;AAElE,MAAI,UAAU,kBAAkB;AAC9B,WAAO;AAAA,EACT;AAEA,MAAI,QAAQ,MAAM,kBAAkB;AAClC,WAAO;AAAA,EACT;AAEA,MAAI,QAAQ,MAAM,kBAAkB;AAClC,WAAO;AAAA,EACT;AAEA,MAAI,QAAQ,kBAAkB;AAC5B,WAAO;AAAA,EACT;AAEA,SAAO;AACT;;;ACnBA;AAEA,IAAMC,QAAO,OAAO,OAAO;AAAA,EACzB,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,SAAS;AAAA,EACT,eAAe;AACjB,CAAC;AAED,IAAMC,aAAY,OAAO,OAAO;AAAA,EAC9B,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,UAAU;AAAA,EACV,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,UAAU;AACZ,CAAC;AAED,IAAM,OAAO,OAAO,OAAO;AAAA,EACzB,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,UAAU;AAAA,EACV,SAAS;AAAA,EACT,cAAc;AAAA,EACd,UAAU;AAAA,EACV,YAAY;AACd,CAAC;AAQM,IAAM,kBAAiC;AAAA,EAC5C,MAAAD;AAAA,EACA,WAAAC;AAAA,EACA;AACF;;;ACtCA;;;ACAA;AAEA,IAAMC,QAAO,OAAO,OAAO;AAAA,EACzB,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,gBAAgB;AAAA,EAChB,YAAY;AAAA,EACZ,OAAO;AAAA,EACP,aAAa;AAAA,IACX,aAAa;AAAA,IACb,YAAY;AAAA,EACd;AACF,CAAC;AAED,IAAM,UAAU,OAAO,UAAU;AAAA,EAC/B,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,WAAW;AAAA,IACT,SAAS;AAAA,EACX;AAAA,EACA,eAAe;AAAA,IACb,OAAO;AAAA,IACP,QAAQ;AAAA,EACV;AAAA,EACA,iBAAiB;AAAA,EACjB,SAAS;AACX,CAAC;AAED,IAAM,OAAO,OAAO,OAAO;AAAA,EACzB,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,aAAa;AAAA,IACX,aAAa;AAAA,IACb,YAAY;AAAA,EACd;AACF,CAAC;AAED,IAAM,MAAM,OAAO,UAAU;AAAA,EAC3B,WAAW;AAAA,IACT,SAAS;AAAA,EACX;AAAA,EACA,cAAc;AAAA,EACd,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,iBAAiB;AAAA,EACjB,SAAS;AAAA,EACT,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,UAAU;AAAA,IACR,QAAQ;AAAA,MACN,MAAM;AAAA,QACJ,iBAAiB;AAAA,MACnB;AAAA,IACF;AAAA,EACF;AACF,CAAC;AASM,IAAM,mBAAmC;AAAA,EAC9C,MAAAA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;;;ACrEA;AAAA;AAAA,EACE;AAAA,EACA,WAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,UAAAC;AAAA,EACA,QAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,WAAAC;AAAA,OACK;AAGP,IAAM,eAAe,OAAOC,QAAM,CAAC,CAAC;AAEpC,IAAM,kBAAkB,OAAOC,UAAS;AAAA,EACtC,QAAQ;AAAA,EACR,YAAY;AAAA,EACZ,wBAAwB;AAAA,IACtB,iBAAiB;AAAA,EACnB;AAAA,EACA,WAAW;AAAA,IACT,SAAS;AAAA,EACX;AAAA,EACA,mBAAmB;AAAA,IACjB,WAAW;AAAA,EACb;AACF,CAAC;AAED,IAAM,sBAAsB,OAAO,YAAY;AAAA,EAC7C,GAAG;AAAA,EACH,OAAO;AAAA,EACP,GAAG;AAAA,EACH,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,WAAW;AAAA,IACT,QAAQ;AAAA,IACR,IAAI;AAAA,EACN;AAAA,EACA,mBAAmB;AAAA,IACjB,IAAI;AAAA,IACJ,SAAS;AAAA,EACX;AACF,CAAC;AAED,IAAM,eAAe,OAAO,MAAM;AAAA,EAChC,OAAO;AAAA,EACP,GAAG;AAAA,EACH,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,SAAS;AAAA,EACT,iBAAiB;AAAA,EACjB,WAAW;AAAA,IACT,QAAQ;AAAA,IACR,IAAI;AAAA,EACN;AAAA,EACA,mBAAmB;AAAA,IACjB,IAAI;AAAA,EACN;AACF,CAAC;AAED,IAAM,wBAAwB,OAAO,WAAW;AAAA,EAC9C,GAAG;AAAA,EACH,iBAAiB;AAAA,EACjB,GAAG;AACL,CAAC;AAED,IAAM,kBAAkB,OAAOC,UAAS;AAAA,EACtC,GAAG;AAAA,EACH,WAAW;AAAA,EACX,GAAG;AAAA,EACH,IAAI;AAAA,EACJ,iBAAiB;AAAA,EACjB,WAAW;AAAA,EACX,WAAW;AAAA,EACX,QAAQ;AAAA,EACR,YAAY;AACd,CAAC;AAED,IAAM,gBAAgB,OAAO,OAAO;AAAA,EAClC,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AACL,CAAC;AAED,IAAM,gBAAgB,OAAO,OAAO,CAAC,CAAC;AAEtC,IAAM,kBAAkB,OAAO,KAAK,CAAC,CAAC;AAEtC,IAAM,yBAAyB,OAAO,YAAY;AAAA,EAChD,GAAG;AAAA,EACH,WAAW;AAAA,EACX,GAAG;AAAA,EACH,IAAI;AAAA,EACJ,iBAAiB;AAAA,EACjB,WAAW;AAAA,EACX,WAAW;AAAA,EACX,QAAQ;AACV,CAAC;AAED,IAAM,uBAAuB,OAAO,cAAc;AAAA,EAChD,OAAO;AAAA,EACP,GAAG;AAAA,EACH,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,SAAS;AAAA,EACT,WAAW;AAAA,IACT,QAAQ;AAAA,IACR,IAAI;AAAA,EACN;AAAA,EACA,mBAAmB;AAAA,IACjB,IAAI;AAAA,EACN;AAAA,EACA,KAAK;AACP,CAAC;AAED,IAAM,wBAAwB,OAAO,eAAe;AAAA,EAClD,GAAG;AAAA,EACH,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,gBAAgB;AAClB,CAAC;AAEM,IAAM,WAAW;AAAA,EACtB,MAAM;AAAA,EACN,SAAS;AAAA,EACT,aAAa;AAAA,EACb,SAAS;AAAA,EACT,QAAQC;AAAA,EACR,SAAS;AAAA,EACT,gBAAgB;AAAA,EAChB,MAAM;AAAA,EACN,OAAO;AAAA,EACP,OAAO;AAAA,EACP,eAAe;AAAA,EACf,cAAc;AAAA,EACd,eAAe;AACjB;;;AC/IA;;;ACAA;AAAA,OAAOC,aAAW;AAElB,SAAkB,gBAAgB;AAG3B,IAAM,cAAc,OAAO,SAAS;AAAA,EACzC,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,gBAAgB;AAAA,EAChB,YAAY;AAAA,EACZ,cAAc;AAAA,EACd,WAAW;AAAA,EACX,YAAY;AAAA,EACZ,UAAU;AAAA,IACR,QAAQ;AAAA,MACN,MAAM;AAAA,QACJ,WAAW;AAAA,MACb;AAAA,IACF;AAAA,IACA,aAAa;AAAA,MACX,MAAM;AAAA,QACJ,WAAW;AAAA,MACb;AAAA,IACF;AAAA,IACA,UAAU;AAAA;AAAA;AAAA,MAGR,MAAM;AAAA,QACJ,QAAQ;AAAA,MACV;AAAA,IACF;AAAA,IACA,UAAU;AAAA,MACR,MAAM;AAAA,QACJ,cAAc;AAAA,MAChB;AAAA,IACF;AAAA,EACF;AAAA,EACA,iBAAiB;AAAA,IACf,QAAQ;AAAA,EACV;AACF,CAAC;AAgBM,IAAM,QAAuC,CAACC,QAAkC;AAAlC,MAAAC,MAAAD,KAAE,WAAS,OAzDhE,IAyDqDC,KAAsB,kBAAtBA,KAAsB,CAApB,WAAS;AAC9D,QAAM,EAAE,SAAS,IAAI,SAAS,EAAE,SAAS,OAAO,CAAC;AACjD,SAAO,gBAAAC,QAAA,cAAC,8BAAY,KAAK,YAAc,MAAO;AAChD;;;AC5DA;;;ACAA;AAAA,YAAY,aAAa;AAKzB,IAAMC,SAAe;AAErB,IAAM,gBAAgB,OAAe,iBAAS;AAAA,EAC5C,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,cAAc;AAAA,EACd,iBAAiB;AAAA,EACjB,QAAQ;AAAA,EACR,QAAQ;AAAA,GACL,aAZyC;AAAA,EAa5C,2BAA2B;AAAA,IACzB,SAAS;AAAA,IACT,WAAW;AAAA,EACb;AACF,EAAC;AAED,IAAM,gBAAgB,OAAe,iBAAS;AAAA,EAC5C,YAAY;AAAA,EACZ,iBAAiB;AAAA,EACjB,SAAS;AAAA,EACT,SAAS;AAAA,EACT,eAAe;AAAA,EACf,cAAc;AAAA,EACd,QAAQ;AAAA,EACR,OAAO;AAAA,GACJ,iBACJ;AAED,IAAM,aAAa;AAAA,EACjB,UAAU;AAAA,EACV,OAAO;AAAA,EACP,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,SAAS;AAAA,EACT,OAAO;AAAA,EACP,iBAAiB;AACnB;AAEA,IAAM,mBAAmB,OAAO,UAAU,iCACrC,aADqC;AAAA,EAExC,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,WAAW;AAAA,IACT,iBAAiB;AAAA,EACnB;AAAA,EACA,QAAQ;AAAA;AAAA,EAER,WAAW;AAAA,IACT,SAAS;AAAA;AAAA,EAEX;AAAA,EACA,aAAa;AAAA,IACX,aAAa;AAAA,IACb,YAAY;AAAA,EACd;AACF,EAAC;AAED,IAAM,mBAAmB,OAAO,OAAO,iCAElC,aAFkC;AAAA,EAGrC,YAAY;AAAA,EACZ,eAAe;AAAA,EACf,cAAc;AAChB,EAAC;AAEM,IAAMC,QAAO,OAAO,OAAO;AAAA,EAChC,SAAS;AAAA,EACT,aAAa;AAAA,IACX,aAAa;AAAA,IACb,YAAY;AAAA,EACd;AACF,CAAC;AAED,IAAM,iBAAiB,OAAO,kBAAkB;AAAA,EAC9C,OAAO;AAAA,EACP,WAAW;AACb,CAAC;AAWM,IAAM,iBAA+B;AAAA,EAC1C,MAAAD;AAAA,EACA,SAAS;AAAA,EACT,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,YAAY;AACd;;;ACxGA;;;ACAA;AAAA,SAAS,eAAAE,cAAa,UAAAC,eAAc;AAEpC,SAAS,2BAA2B;AAO7B,SAAS,oBAAoB,cAA2B;AAC7D,QAAM,EAAE,OAAAC,OAAM,IAAI,SAAS;AAC3B,QAAM,QAAQA,OAAM,OAAO,gBAAgB;AAC3C,QAAM,WAAWC;AAAA,IACf,CAAC,UAAkB;AACjB,YAAM,QAAgC;AAAA,QACpC,YAAY;AAAA,MACd;AACA,YAAM,SAAS,IAAI,QAAQ,GAAG,QAAQ,KAAK,IAAI,CAAC,YAAY,KAAK,KAAK;AACtE,aAAO;AAAA,IACT;AAAA,IACA,CAAC,KAAK;AAAA,EACR;AACA,QAAM,MAAMC,QAAO,IAAI;AACvB,sBAAoB;AAAA,IAClB,SAAS;AAAA,IACT;AAAA,IACA;AAAA,EACF,CAAC;AACD,SAAO;AACT;AAEO,IAAM,UAAU,CAACC,OAAc;AACpC,SAAO,KAAK,IAAI,KAAK,IAAI,CAACA,EAAC;AAC7B;;;ACjCA;AAAA,OAAOC,WAAS,aAAAC,YAAW,UAAAC,eAAc;AACzC,SAAS,sBAAsB,0BAA0B;;;;;;AAOzD,IAAM,iBAAiB,IAAI,MAAM,GAAG,EAAE,KAAK,CAAC,EAAE,OAAO,CAAC,KAAK,GAAG,UAAU;AACtE,MAAI,KAAK,IAAI,KAAK,MAAO,QAAQ,MAAO,CAAC,IAAI;AAC7C,SAAO;AACT,GAAG,CAAC,CAAC;AAEL,IAAM,eAAe,UAAU;AAAA,EAC7B,MAAM;AAAA,IACJ,UAAU;AAAA,IACV,2BAA2B;AAAA,IAC3B,cAAc;AAAA,EAChB;AAAA,EAEA,OAAO;AAAA,IACL,UAAU;AAAA,IACV,2BAA2B;AAAA,IAC3B,cAAc;AAAA,EAChB;AAAA,EAEA,IAAI;AAAA,IACF,UAAU;AAAA,IACV,2BAA2B;AAAA,IAC3B,cAAc;AAAA,EAChB;AACF,CAAC;AAED,IAAM,WAAW,MAAM;AACrB,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,WAAW,OAAO,mBAAE;AAAA,QACpB,uBAAuB;AAAA,QACvB,iBAAiB;AAAA,QACjB,UAAU;AAAA,MACZ;AAAA;AAAA,EACF;AAEJ;AAEO,IAAM,aAAa,CAAC,EAAE,SAAS,KAAK,MAAuD;AAChG,QAAM,MAAMC,QAA8B,IAAI;AAC9C,QAAM,eAAe,mBAAmB;AAExC,EAAAC,WAAU,MAAM;AACd,UAAM,cAAc,aAAa,UAAU,gBAAc;AACvD,UAAI,IAAI,SAAS;AACf,YAAI,QAAQ;AAEZ,mBAAW,SAAS,IAAI,QAAQ,UAAU;AACxC,gBAAM,YAAY,IAAI,eAAe,UAAU,KAAK,UAAU,IAAI,MAAM,KAAK;AAC7E,gBAAM,MAAM,yBAAyB,IAAI;AACzC,gBAAM,MAAM,eAAe,IAAI,GAAG,SAAS;AAC3C,gBAAM,MAAM,WAAW,IACrB,eAAe,UAAU,IAAI,IAAI,GAAG,YAAY,yCAAyC;AAC3F;AAAA,QACF;AAAA,MACF;AAAA,IACF,GAAG,qBAAqB,OAAO,CAAC;AAChC,WAAO;AAAA,EACT,GAAG,CAAC,cAAc,OAAO,CAAC;AAC1B,SACE,gBAAAF,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,KAAK;AAAA,QACH,UAAU,SAAS,UAAU,YAAY;AAAA,QACzC,KAAK,SAAS,UAAU,OAAO;AAAA,MACjC;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,cAAS;AAAA,IACV,gBAAAA,QAAA,cAAC,cAAS;AAAA,IACV,gBAAAA,QAAA,cAAC,cAAS;AAAA,EACZ;AAEJ;;;AClFA;AAAA,SAAS,SAAAG,QAAO,SAAAC,QAAO,WAAAC,UAAS,WAAWC,QAAM,UAAAC,SAAQ,WAAAC,gBAAe;AAIxE,IAAMC,iBAAgB,OAAOC,UAAS;AAAA,EACpC,SAAS;AAAA,EACT,cAAc;AAAA,EACd,iBAAiB;AAAA,EACjB,WAAW;AAAA,EACX,QAAQ;AAAA,GACL,iBACJ;AAED,IAAM,cAAc,OAAOC,QAAO,mBAC7B,iBACJ;AAED,IAAMC,iBAAgB,OAAOC,UAAS;AAAA,EACpC,WAAW;AAAA,IACT,QAAQ;AAAA,EACV;AAAA,EACA,mBAAmB;AAAA,IACjB,WAAW;AAAA,EACb;AACF,CAAC;AAEM,IAAMC,WAAU;AAAA,EACrB,MAAAC;AAAA,EACA,SAASN;AAAA,EACT,SAASG;AAAA,EACT,QAAQI;AAAA,EACR,OAAO;AAAA,EACP,OAAOC;AACT;;;ACjCA;;;ACAA;AAAA,OAAOC,WAAS,gBAAgB;AAChC;AAAA,EAKE;AAAA,EACA,kBAAAC;AAAA,EACA;AAAA,EACA,oBAAAC;AAAA,EACA;AAAA,OACK;;;ACXP;AAAO,IAAM,cAAc,CAAC,OAAgB,OAAO,KAAK,WAAW,MAAM;AACvE,MAAI,UAAU,GAAG;AACf,WAAO,KAAK,IAAI;AAAA,EAClB;AACA,MAAI,CAAC,OAAO;AACV,WAAO;AAAA,EACT;AAEA,QAAM,IAAI;AACV,QAAMC,MAAK,WAAW,IAAI,IAAI;AAC9B,QAAM,QAAQ,CAAC,IAAI,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,GAAG,EAAE,IAAI,UAAQ,OAAO,IAAI;AAElF,MAAI,IAAI,KAAK,MAAM,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,CAAC,CAAC;AAGhD,QAAM,KAAK;AAEX,SAAO,GAAG,YAAY,QAAQ,KAAK,IAAI,GAAG,CAAC,GAAG,QAAQA,GAAE,CAAC,CAAC,IAAI,MAAM,CAAC,CAAC;AACxE;;;AClBA;AAEO,IAAMC,SAAO,OAAO,OAAO;AAAA,EAChC,iBAAiB;AAAA,EACjB,UAAU;AAAA,EACV,KAAK;AAAA,EACL,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,cAAc;AAAA,EACd,SAAS;AAAA,EACT,UAAU;AAAA,EACV,WAAW;AAAA,EACX,WAAW;AAAA,EACX,UAAU;AACZ,CAAC;AAEM,IAAM,QAAQ,OAAO,SAAS,CAAC,CAAC;AAEhC,IAAM,MAAM,OAAO,MAAM;AAAA,EAC9B,OAAO;AAAA,EACP,aAAa;AAAA,IACX,IAAI;AAAA,EACN;AAAA,EACA,YAAY;AAAA,EACZ,WAAW;AACb,CAAC;AAEM,IAAMC,SAAQ,OAAO,MAAM;AAAA,EAChC,OAAO;AAAA,EACP,YAAY;AACd,CAAC;AAEM,IAAM,QAAQ,OAAO,MAAM;AAAA,EAChC,OAAO;AACT,CAAC;AAEM,IAAM,MAAM,OAAO,MAAM;AAAA,EAC9B,QAAQ;AACV,CAAC;AAWM,IAAM,QAAmB;AAAA,EAC9B,MAAAD;AAAA,EACA;AAAA,EACA,OAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;;;ACxDA;AAAA,SAAS,UAAAC,eAAc;AACvB,SAAS,mBAAmB;AAC5B,SAAqB,gBAAgB,wBAAwB;AAQ7D,IAAM,sBAAsB,OAAO;AAEnC,IAAM,OAAO,CAAC,OAAe,WAAmB,cAAsB;AACpE,SAAO,KAAK,IAAI,KAAK,IAAI,OAAO,SAAS,GAAG,SAAS;AACvD;AAaO,IAAM,SAAS,CAAC,EAAE,cAAc,cAAc,UAAU,MAAM,MAAmB;AACtF,QAAM,kBAAkB,iBAAiB,eAAe,eAAe,YAAY,CAAC;AACpF,QAAM,kBAAkB,iBAAiB,eAAe,eAAe,YAAY,CAAC;AACpF,QAAM,sBAAsB,YAAY,eAAe;AACvD,QAAM,sBAAsB,YAAY,eAAe;AAEvD,QAAM,0BAA0BC,QAAe,CAAC;AAEhD,MAAI,WAAY,gBAAgB,CAAC,mBAAqB,gBAAgB,CAAC,iBAAkB;AACvF;AAAA,EACF;AAEA,QAAM,mBACF,mDAAiB,eAAc,OAAM,mDAAiB,gBAAe,KAAM;AAE/E,QAAM,0BACJ,mDAAiB,mBAAiB,2DAAqB,iBACnD,gBAAgB,gBAAgB,oBAAoB,gBACpD;AACN,MAAI,qBACF,OAAM,mDAAiB,yBAAwB,OAAM,2DAAqB,yBAAwB;AACpG,uBAAqB,qBAAqB,IAAI,MAAM;AACpD,uBAAqB,2BAA2B,IAAI,IAAI;AAExD,QAAM,UAAU,yBAAyB;AAEzC,QAAM,eAAc,2DAAqB,sBAAqB;AAC9D,QAAM,sBAAqB,2DAAqB,6BAA4B;AAC5E,QAAM,mBAAkB,mDAAiB,sBAAqB,KAAK;AACnE,QAAM,0BAAyB,mDAAiB,6BAA4B,KAAK;AAEjF,QAAM,sBACJ,wBAAwB,IAAK,iBAAiB,MAAQ,wBAAwB,wBAAwB;AACxG,0BAAwB,UAAU;AAClC,QAAM,YAAY,IAAI,KAAK,IAAI,GAAG,sBAAsB,GAAI;AAE5D,QAAM,yBACH,2DAAqB,qBAAoB,OAAM,2DAAqB,2BAA0B;AACjG,QAAM,4BACH,mDAAiB,qBAAoB,OAAM,mDAAiB,2BAA0B,KAAK;AAE9F,QAAM,qBAAqB,IAAI,0BAA0B;AAEzD,UACE,IACA,WAAK,oBAAoB,GAAG,CAAC,GAAK,KAClC,WAAK,gBAAgB,GAAG,CAAC,GAAK,OAC9B,WAAK,SAAS,GAAG,CAAC,GAAK,OACvB,WAAK,WAAW,GAAG,CAAC,GAAK,OACzB,WAAK,oBAAoB,GAAG,CAAC,GAAK,IAClC,QAAQ,CAAC;AACb;;;AHlDO,SAAS,eAAe,EAAE,cAAc,cAAc,QAAQ,UAAU,MAAM,GAAwB;AA5B7G,MAAAC,KAAAC,KAAA;AA6BE,QAAM,gBAAgB,UAAUC,gBAAe,2BAA2BA,gBAAe;AACzF,QAAM,kBAAkBC,kBAAiB,cAAc,YAAY,CAAC;AACpE,QAAM,uBAAuBA,kBAAiBD,gBAAe,yBAAyB,YAAY,CAAC;AACnG,QAAM,wBAAwBC,kBAAiBD,gBAAe,eAAe,YAAY,CAAC;AAC1F,QAAM,kBAAkB,UAAU,6DAAuB,KAAK;AAC9D,QAAM,iBAAgBF,MAAA,YAAY,gCAAgC,MAAM,CAAC,MAAnD,gBAAAA,IAAsD;AAC5E,QAAM,2BAA2BG,kBAAiBD,gBAAe,uBAAuB;AACxF,QAAM,MAAM,OAAO,EAAE,cAAc,cAAc,QAAQ,CAAC;AAG1D,MAAI,EAAE,mBAAmB,kBAAkB;AACzC,WAAO;AAAA,EACT;AACA,SACE,gBAAAE,QAAA,cAAC,MAAM,MAAN,MACC,gBAAAA,QAAA,cAAC,eACC,gBAAAA,QAAA,cAAC,eACE,UACC,gBAAAA,QAAA,cAAC,gBACC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAM,oBAAoB,wBAAwB;AAAA,MAClD,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,OAAO,YAAY,0BAA0B,KAAK;AAAA;AAAA,EACpD,GACC,6DAAsB,IAAI,UAAQ;AAtDjD,QAAAJ,KAAAC;AAuDgB,QAAI,CAAC,MAAM;AACT,aAAO;AAAA,IACT;AACA,UAAM,QAAQ,KAAK,MAAM,iBAAiB,KAAK,GAAU,IAAI;AAC7D,WACE,gBAAAG,QAAA,cAAC,YAAS,KAAK,GAAG,KAAK,EAAE,GAAG,KAAK,GAAG,MACjC,SAAS,gBAAAA,QAAA,cAAC,YAAS,OAAO,MAAM,YAAY,GAAG,OAAM,IAAG,GACzD,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,MAAM,oBAAoB,KAAK,UAAU;AAAA,QACzC,OAAM;AAAA,QACN,QAAOJ,MAAA,KAAK,eAAL,gBAAAA,IAAiB;AAAA;AAAA,IAC1B,GACA,gBAAAI,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,MAAM,oBAAoB,KAAK,WAAW;AAAA,QAC1C,OAAM;AAAA,QACN,QAAOH,MAAA,KAAK,gBAAL,gBAAAA,IAAkB;AAAA;AAAA,IAC3B,GACA,gBAAAG,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,MAAM,oBAAoB,KAAK,eAAe;AAAA,QAC9C,OAAM;AAAA,QACN,OAAO,GAAG,KAAK,eAAe,IAC5B,oBAAoB,KAAK,aAAa,IAAI,IAAI,KAAK,aAAa,cAAc,EAChF;AAAA;AAAA,IACF,GACA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,MAAM,aAAa,KAAK,OAAO;AAAA,QAC/B,OAAM;AAAA,QACN,OAAO,YAAY,KAAK,SAAS,KAAK;AAAA;AAAA,IACxC,GACA,gBAAAA,QAAA,cAAC,MAAM,KAAN,IAAU,CACb;AAAA,EAEJ,EACF,IAEA,gBAAAA,QAAA,cAAC,gBACC,gBAAAA,QAAA,cAAC,YAAS,MAAM,aAAa,GAAG,GAAG,OAAM,OAAM,OAAO,KAAK,GAC3D,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAM,oBAAoB,mDAAiB,UAAU;AAAA,MACrD,OAAM;AAAA,MACN,QAAOH,MAAA,mDAAiB,eAAjB,gBAAAA,IAA6B;AAAA;AAAA,EACtC,GACA,gBAAAG,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAM,oBAAoB,mDAAiB,WAAW;AAAA,MACtD,OAAM;AAAA,MACN,QAAO,wDAAiB,gBAAjB,mBAA8B;AAAA;AAAA,EACvC,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAM,oBAAoB,mDAAiB,eAAe;AAAA,MAC1D,OAAM;AAAA,MACN,OAAO,GAAG,mDAAiB,eAAe,IACxC,oBAAoB,mDAAiB,aAAa,IAC9C,IAAI,mDAAiB,aAAa,cAClC,EACN;AAAA;AAAA,EACF,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAM,aAAa,mDAAiB,mBAAmB;AAAA,MACvD,OAAM;AAAA,MACN,OAAO,mDAAiB;AAAA;AAAA,EAC1B,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAM,aAAa,mDAAiB,oBAAoB;AAAA,MACxD,OAAM;AAAA,MACN,OAAO,mDAAiB;AAAA;AAAA,EAC1B,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAM,aAAa,mDAAiB,OAAO;AAAA,MAC3C,OAAM;AAAA,MACN,OAAO,YAAY,mDAAiB,SAAS,KAAK;AAAA;AAAA,EACpD,CACF,GAGF,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAM,aAAa,mDAAiB,OAAO;AAAA,MAC3C,OAAM;AAAA,MACN,OAAO,YAAY,mDAAiB,SAAS,KAAK;AAAA;AAAA,EACpD,GAEA,gBAAAA,QAAA,cAAC,YAAS,MAAM,aAAa,aAAa,GAAG,OAAM,OAAM,OAAO,eAAe,GAE/E,gBAAAA,QAAA,cAAC,YAAS,MAAM,aAAa,mDAAiB,KAAK,GAAG,OAAM,YAAW,OAAO,mDAAiB,OAAO,GAEtG,gBAAAA,QAAA,cAAC,YAAS,MAAM,aAAa,mDAAiB,KAAK,GAAG,OAAM,YAAW,OAAO,mDAAiB,OAAO,GAEtG,gBAAAA,QAAA,cAAC,uBAAoB,iBAAkC,iBAAkC,CAC3F,CACF,CACF;AAEJ;AAEA,IAAM,sBAAsB,CAAC;AAAA,EAC3B;AAAA,EACA;AACF,MAGM;AA1JN,MAAAJ,KAAAC;AA8JE,QAAM,eAAc,mDAAiB,KAAK,SAAS,iBAAe,mDAAiB,KAAK,SAAS;AACjG,QAAM,aAAa,cAAc,mDAAiB,SAAS;AAC3D,QAAM,aAAa,cAAc,mDAAiB,SAAS;AAC3D,SACE,gBAAAG,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,uBAAoB,OAAM,kBAAiB,OAAO,YAAY,GAC/D,gBAAAA,QAAA,cAAC,uBAAoB,OAAM,kBAAiB,OAAO,YAAY,GAC/D,gBAAAA,QAAA,cAAC,YAAS,MAAM,aAAa,yCAAY,MAAM,GAAG,OAAM,aAAY,QAAOJ,MAAA,yCAAY,WAAZ,gBAAAA,IAAoB,QAAQ,IAAI,GAC3G,gBAAAI,QAAA,cAAC,YAAS,MAAM,aAAa,yCAAY,MAAM,GAAG,OAAM,aAAY,QAAOH,MAAA,yCAAY,WAAZ,gBAAAA,IAAoB,QAAQ,IAAI,CAC7G;AAEJ;AAEA,IAAM,sBAAsB,CAAC;AAAA,EAC3B;AAAA,EACA;AACF,MAGM;AACJ,QAAM,kBAAkB,IAAG,+BAAO,mBAAkB,MAAM,gBAAgB,QAAQ,CAAC,IAAI,CAAC;AAExF,SACE,gBAAAG,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAM,oBAAoB,+BAAO,WAAW;AAAA,MAC5C;AAAA,MACA,OAAO,GAAG,+BAAO,WAAW,IAAI,eAAe;AAAA;AAAA,EACjD;AAEJ;AAEA,IAAM,cAAc,CAAC;AAAA,EACnB,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,UAAU;AAAA,EACV,OAAO;AACT,MAKM;AACJ,QAAM,aAAa,gBAAAA,QAAA,cAAC,MAAM,OAAN,MAAa,KAAM;AAEvC,SACE,gBAAAA,QAAA,cAAAA,QAAA,gBACG,OACC,gBAAAA,QAAA,cAAC,MAAM,KAAN,MACE,UACC,gBAAAA,QAAA,cAAC,WAAQ,MAAK,OAAM,OAAO,WACxB,UACH,IAEA,YAED,UAAU,KAAK,gBAAAA,QAAA,cAAC,MAAM,OAAN,IAAY,IAAK,gBAAAA,QAAA,cAAC,MAAM,OAAN,MAAa,KAAM,CACxD,IACE,IACN;AAEJ;AAGA,IAAM,WAAWA,QAAM,KAAK,WAAW;AAEhC,SAAS,oBAAoB,OAAkC;AACpE,SAAO,aAAa,KAAK,KAAK,UAAU;AAC1C;AAMO,SAAS,aAAa,OAA2C;AACtE,SAAO,UAAU,UAAa,UAAU;AAC1C;;;AIzOA;AAAA,YAAY,uBAAuB;AAGnC,IAAM,eAAe,OAAyB,wBAAM;AAAA,EAClD,KAAK;AAAA,EACL,QAAQ;AAAA,EACR,iBAAiB;AAAA,EACjB,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,cAAc;AAAA,EACd,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,gBAAgB;AAAA,EAChB,WAAW;AAAA,EACX,SAAS;AAAA,EACT,QAAQ;AAAA,EACR,WAAW;AAAA,IACT,WAAW;AAAA,IACX,SAAS;AAAA,EACX;AAAA,EACA,2BAA2B;AAAA,IACzB,iBAAiB;AAAA,EACnB;AACF,CAAC;AAED,IAAM,oBAAoB,OAAyB,6BAAW;AAAA,EAC5D,OAAO;AACT,CAAC;AAEM,IAAM,WAAW;AAAA,EACtB,MAAM;AAAA,EACN,WAAW;AACb;;;AChCA;AAAA,YAAY,oBAAoB;AAGzB,IAAMC,SAAQ,OAAsB,qBAAM;AAAA,EAC/C,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,OAAO;AACT,CAAC;;;ACPD;AAAA,YAAY,yBAAyB;AAGrC,IAAM,iBAAiB,OAA2B,0BAAM;AAAA,EACtD,SAAS;AAAA,EACT,YAAY;AACd,CAAC;AAED,IAAM,iBAAiB,OAA2B,0BAAM;AAAA,EACtD,IAAI;AAAA,EACJ,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,cAAc;AAAA,EACd,WAAW;AAAA,IACT,WAAW;AAAA,IACX,SAAS;AAAA,EACX;AAAA,EACA,2BAA2B;AAAA,IACzB,aAAa;AAAA,IACb,GAAG;AAAA,EACL;AACF,CAAC;AACD,IAAM,sBAAsB,OAA2B,+BAAW;AAAA,EAChE,IAAI;AACN,CAAC;AAEM,IAAM,aAAa;AAAA,EACxB,MAAM;AAAA,EACN,MAAM;AAAA,EACN,WAAW;AACb;;;AChCA;AAAA,OAAOC,aAA+B;AAEtC,YAAY,qBAAqB;AACjC,SAAS,aAAAC,kBAAiB;AAO1B,IAAM,kBAAkB,CAAC,SAAiB;AACxC,SAAO;AAAA,IACL,iBAAiB;AAAA,IACjB,YAAY;AAAA,IACZ,YAAY;AAAA,MACV,UAAU;AAAA,MACV,KAAK;AAAA,MACL,MAAM;AAAA,MACN,OAAO;AAAA,MACP,YAAY,mBAAmB,IAAI;AAAA,MACnC,WAAW,mBAAmB,IAAI;AAAA,MAClC,cAAc,mBAAmB,IAAI;AAAA,MACrC,qBAAqB;AAAA,MACrB,wBAAwB;AAAA,MACxB,IAAI;AAAA,MACJ,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,QAAQ;AAAA,IACV;AAAA,IACA,OAAO;AAAA,MACL,YAAY;AAAA,QACV,SAAS;AAAA,MACX;AAAA,MACA,QAAQ,mBAAmB,IAAI;AAAA,IACjC;AAAA,EACF;AACF;AAEA,IAAM,YAAY,OAAuB,sBAAM;AAAA,EAC7C,GAAG;AAAA,EACH,IAAI;AAAA,EACJ,GAAG;AAAA,EACH,SAAS;AAAA,EACT,eAAe;AAAA,EACf,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,QAAQ;AAAA,EACR,UAAU;AAAA,GACP,iBAV0C;AAAA,EAW7C,OAAO;AAAA,IACL,GAAG;AAAA,EACL;AAAA,EACA,UAAU;AAAA,IACR,SAAS;AAAA,MACP,UAAU,gBAAgB,oBAAoB;AAAA,MAC9C,SAAS,gBAAgB,gBAAgB;AAAA,MACzC,OAAO,gBAAgB,sBAAsB;AAAA,MAC7C,SAAS,gBAAgB,gBAAgB;AAAA,IAC3C;AAAA,EACF;AAAA,EACA,iBAAiB;AAAA,IACf,SAAS;AAAA,EACX;AACF,EAAC;AAED,IAAM,aAAa,OAAuB,uBAAO;AAAA,EAC/C,UAAU;AAAA,EACV,OAAO;AAAA,EACP,YAAY;AAAA,EACZ,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,gBAAgB;AAClB,CAAC;AACD,IAAM,mBAAmB,OAAuB,6BAAa;AAAA,EAC3D,OAAO;AACT,CAAC;AACD,IAAM,aAAa,OAAuB,uBAAO,CAAC,CAAC;AACnD,IAAM,cAAc,OAAuB,wBAAQ;AAAA,EACjD,QAAQ;AAAA,EACR,YAAY;AAAA,EACZ,QAAQ;AACV,CAAC;AACD,IAAM,gBAAgB,OAAuB,0BAAU;AAAA,EACrD,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,MAAM;AAAA,EACN,SAAS;AAAA,EACT,eAAe;AAAA,EACf,SAAS;AAAA,EACT,KAAK;AAAA,EACL,OAAO;AAAA,EACP,OAAO;AAAA,IACL,OAAO;AAAA,IACP,SAAS;AAAA,EACX;AAAA,EACA,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,WAAW;AAAA,EACX,QAAQ;AACV,CAAC;AAED,IAAM,eAAe,CAAC,EAAE,KAAAC,KAAI,MAAsD;AAChF,SACE,gBAAAC,QAAA,cAAC,cAAW,KAAKD,MAAK,SAAO,QAC3B,gBAAAC,QAAA,cAAC,kBACC,gBAAAA,QAAA,cAACC,YAAA,IAAU,CACb,CACF;AAEJ;AAWA,IAAM,WAAoC,CAACC,QAQrC;AARqC,MAAAC,MAAAD,KACzC;AAAA;AAAA,IACA;AAAA,IACA,aAAa;AAAA,IACb;AAAA,IACA;AAAA,IACA,eAAe;AAAA,EA9HjB,IAwH2CC,KAOtC,kBAPsCA,KAOtC;AAAA,IANH;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA;AAGA,SACE,gBAAAH,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,8BAAc,QACb,gBAAAA,QAAA,cAAC,kBACC,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,MAAM,MAAM,SAAS,UAAU,EAAE,KAC/D,OAAO,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,GAAG,OAAO,GAAG,OAAO,WAAW,SAAS,IAAI,KAAK,KAAI,IAAK,IAAS,MACvF,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAO,KAAK,EAAE,GAAG,WAAW,WAAW,aAAa,KAC/D,KACH,CACF,GACC,aAAa,gBAAAA,QAAA,cAAC,kBAAa,IAAK,MAChC,CAAC,cAAc,gBAAgB,SAC9B,gBAAAA,QAAA,cAAC,eAAY,SAAS,GAAG,KAAK,YAAW,MAAO,IAC9C,IACN,GACC,cACC,gBAAAA,QAAA,cAAC,wBACC,gBAAAA,QAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,YAAY,YAAY,GAAG,qBAAqB,KAC1E,WACH,CACF,IACE,MACH,CAAC,gBAAgB,SAChB,gBAAAA,QAAA,cAAC,eAAY,SAAS,GAAG,KAAK,UAAU,KAAK,EAAE,IAAI,MAAM,KACtD,MACH,IACE,IACN,CACF;AAEJ;AACO,IAAM,QAAQ;AAAA,EACnB,UAA0B;AAAA,EAC1B,MAAM;AAAA,EACN,OAAO;AAAA,EACP,aAAa;AAAA,EACb,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,UAAU;AAAA,EACV;AACF;;;ACzKA;;;ACAA;AAAA,OAAOI,aAAkC;AACzC,YAAY,mBAAmB;AAE/B,SAAS,qBAAqB;AAK9B,IAAM,kBAAkB,OAAqB,oBAAM,CAAC,CAAC;AAErD,IAAM,aAAa,OAAqB,oBAAM;AAAA,EAC5C,WAAW;AAAA,EACX,SAAS;AAAA,EACT,iBAAiB;AAAA,IACf,WAAW;AAAA,IACX,qBAAqB;AAAA,IACrB,sBAAsB;AAAA,EACxB;AAAA,EACA,gBAAgB;AAAA,IACd,wBAAwB;AAAA,IACxB,yBAAyB;AAAA,EAC3B;AACF,CAAC;AAED,IAAM,eAAe,OAAqB,sBAAQ;AAAA,EAChD,KAAK;AAAA,EACL,SAAS;AAAA,EACT,YAAY;AACd,CAAC;AAED,IAAMC,iBAAgB,OAAqB,uBAAS;AAAA,EAClD,KAAK;AAAA,EACL,YAAY;AAAA,EACZ,MAAM;AAAA,EACN,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,gBAAgB;AAAA,EAChB,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,OAAO;AACT,CAAC;AAED,IAAMC,iBAAgB,OAAqB,uBAAS;AAAA,EAClD,SAAS;AAAA,EACT,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,OAAO;AAAA,EACP,wBAAwB;AAAA,IACtB,WAAW,GAAG,UAAU,kCAAkC,CAAC;AAAA,EAC7D;AAAA,EACA,0BAA0B;AAAA,IACxB,WAAW,GAAG,QAAQ,kCAAkC,CAAC;AAAA,EAC3D;AACF,CAAC;AAED,IAAM,gBAAgB,OAAO,eAAe;AAAA,EAC1C,OAAO;AAAA,EACP,YAAY;AAAA,EACZ,yBAAyB,EAAE,WAAW,iBAAiB;AACzD,CAAC;AAGM,IAAM,gBAAgB;AACtB,IAAM,gBAAgB;AAEtB,IAAM,kBAETC,QAAM,WAGR,CAACC,KAAoD,iBAAc;AAAlE,MAAAC,MAAAD,KAAE,YAAU,YAAY,KAAAE,MAAK,UAtEhC,IAsEGD,KAA2C,kBAA3CA,KAA2C,CAAzC,YAAU,cAAY,OAAK;AAC9B,yBAAAF,QAAA,cAAC,gBAAa,KAAKG,QACjB,gBAAAH,QAAA,cAACF,gBAAA,iCAAkB,QAAlB,EAAyB,KAAK,iBAC5B,UACD,gBAAAE,QAAA,cAAC,iBAAc,eAAa,WAAW,eAAW,MAAC,KAAK,YAAY,CACtE,CACF;AAAA,CACD;AAEM,IAAM,mBAETA,QAAM;AAAA,EACR,CAACC,KAAuC,iBAAc;AAArD,QAAAC,MAAAD,KAAE,YAAU,cAlFf,IAkFGC,KAA8B,kBAA9BA,KAA8B,CAA5B,YAAU;AACX,2BAAAF,QAAA,cAACD,gBAAA,iCAAkB,QAAlB,EAAyB,KAAK,iBAC7B,gBAAAC,QAAA,cAAC,OAAI,KAAK,iBAAgB,QAAS,CACrC;AAAA;AAEJ;;;ADrFO,IAAM,YAAY;AAAA,EACvB,MAAM;AAAA,EACN,MAAM;AAAA,EACN,SAAS;AAAA,EACT,QAAQ;AACV;;;AEPA;AAEA,IAAM,iBAAiB,OAAO,YAAY;AAAA,EACxC,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,gBAAgB;AAAA,EAChB,QAAQ;AAAA,EACR,iBAAiB;AACnB,CAAC;AAEM,IAAM,WAAW;;;ACVxB;;;ACAA;AAGA,IAAMI,SAAO,OAAO,MAAM;AAAA,EACxB,gBAAgB;AAAA,EAChB,YAAY;AAAA,EACZ,IAAI;AAAA,EACJ,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,OAAO,EAAE,UAAU,QAAQ,KAAK,KAAK;AACvC,CAAC;AAED,IAAM,OAAO,OAAO,MAAM;AAAA,EACxB,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,MAAM;AAAA,EACN,KAAK;AAAA,EACL,OAAO;AAAA,IACL,UAAU;AAAA,IACV,gBAAgB;AAAA,IAChB,GAAG;AAAA,EACL;AACF,CAAC;AAED,IAAM,SAAS,OAAO,MAAM;AAAA,EAC1B,GAAG;AAAA,EACH,gBAAgB;AAAA,EAChB,YAAY;AAAA,EACZ,KAAK;AACP,CAAC;AAED,IAAM,QAAQ,OAAO,MAAM;AAAA,EACzB,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,OAAO;AAAA,EACP,KAAK;AAAA,EACL,OAAO;AAAA,IACL,SAAS;AAAA,EACX;AACF,CAAC;AAEM,IAAM,SAAS;AAAA,EACpB,MAAAA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;;;AC9CA;AAAA;AAAA,gBAAAC;AAAA;AAAA;;;ACAA;AAAA,YAAY,qBAAqB;AAGjC,IAAM,aAAa,OAAuB,sBAAM,CAAC,CAAC;AAElD,IAAMC,iBAAgB,OAAuB,+BAAe;AAAA,EAC1D,KAAK;AAAA,EACL,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,gBAAgB;AAAA,EAChB,cAAc;AAAA,EACd,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,KAAK;AAAA,EACL,iBAAiB;AAAA,EACjB,OAAO;AAAA,EACP,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,GAAG;AACL,CAAC;AAED,IAAMC,iBAAgB,OAAuB,yBAAS;AAAA,EACpD,UAAU;AAAA,EACV,iBAAiB;AAAA,EACjB,GAAG;AAAA,EACH,GAAG;AACL,CAAC;AAED,IAAM,iBAAiB,OAAuB,0BAAU;AAAA,EACtD,SAAS;AACX,CAAC;AAED,IAAMC,cAAa,OAAuB,sBAAM;AAAA,EAC9C,KAAK;AAAA,EACL,UAAU;AAAA,EACV,GAAG;AAAA,EACH,SAAS;AAAA,EACT,GAAG;AAAA,EACH,GAAG;AAAA,EACH,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,QAAQ;AACV,CAAC;AAED,IAAM,cAAc,OAAuB,uBAAO;AAAA,EAChD,GAAG;AAAA,EACH,YAAY;AAAA,EACZ,OAAO;AACT,CAAC;AAED,IAAM,kBAAkB,OAAuB,2BAAW;AAAA,EACxD,QAAQ;AAAA,EACR,iBAAiB;AAAA,EACjB,QAAQ;AAAA,EACR,SAAS;AACX,CAAC;AAED,IAAM,sBAAsB,OAAuB,+BAAe;AAAA,EAChE,UAAU;AAAA,EACV,OAAO;AAAA,EACP,OAAO;AAAA,EACP,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,gBAAgB;AAAA,EAChB,OAAO;AACT,CAAC;AAED,IAAM,qBAAqB;AAAA,EACzB,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,gBAAgB;AAAA,EAChB,GAAG;AAAA,EACH,iBAAiB;AAAA,EACjB,OAAO;AAAA,EACP,QAAQ;AACV;AAEA,IAAM,uBAAuB,OAAuB,gCAAgB,kBAAkB;AAEtF,IAAM,yBAAyB,OAAuB,kCAAkB,kBAAkB;AAEnF,IAAMC,UAAS;AAAA,EACpB,MAAM;AAAA,EACN,SAASH;AAAA,EACT,SAASC;AAAA,EACT,UAAU;AAAA,EACV,MAAMC;AAAA,EACN,OAAO;AAAA,EACP,WAAW;AAAA,EACX,eAAe;AAAA,EACf,gBAAgB;AAAA,EAChB,kBAAkB;AAAA,EAClB,OAAuB;AAAA,EACvB,MAAsB;AAAA,EACtB,UAA0B;AAAA,EAC1B,OAAuB;AACzB;;;AChGA;AAAA,YAAY,mBAAmB;AAG/B,IAAM,iBAAiB,OAAqB,oBAAM;AAAA,EAChD,SAAS;AACX,CAAC;AAED,IAAM,aAAa,OAAqB,oBAAM;AAAA,EAC5C,YAAY;AAAA,EACZ,SAAS;AACX,CAAC;AAED,IAAME,iBAAgB,OAAqB,uBAAS;AAAA,EAClD,KAAK;AAAA,EACL,YAAY;AAAA,EACZ,GAAG;AAAA,EACH,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,OAAO;AAAA,EACP,YAAY;AAAA,EACZ,QAAQ;AAAA,EACR,0BAA0B;AAAA,IACxB,IAAI;AAAA,IACJ,GAAG;AAAA,EACL;AACF,CAAC;AAED,IAAMC,iBAAgB,OAAqB,uBAAS;AAAA,EAClD,MAAM;AAAA,EACN,SAAS;AAAA,EACT,SAAS;AACX,CAAC;AAEM,IAAM,OAAO;AAAA,EAClB,MAAM;AAAA,EACN,MAAM;AAAA,EACN,SAASA;AAAA,EACT,SAASD;AACX;;;ACxCA;AAAA,OAAOE,aAA+B;AACtC,SAAS,iBAAiB;AAEnB,IAAM,SAAS,CAAC,UAA4C;AACjE,SAAO,gBAAAC,QAAA,cAAC,4BAAU,OAAO,EAAE,OAAO,QAAQ,QAAQ,OAAO,KAAO,MAAO;AACzE;;;ACLA;;;ACAA;AAAA,OAAOC,aAAW;AAClB,YAAY,WAAW;AAKvB,IAAM,gBAAgB,OAAO,KAAK;AAAA,EAChC,gBAAgB;AAAA,EAChB,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,KAAK;AAAA,EACL,UAAU;AAAA,IACR,OAAO;AAAA,MACL,SAAS;AAAA,QACP,OAAO;AAAA,QACP,WAAW;AAAA,UACT,OAAO;AAAA,QACT;AAAA,MACF;AAAA,MACA,SAAS;AAAA,QACP,OAAO;AAAA,QACP,WAAW;AAAA,UACT,OAAO;AAAA,QACT;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF,CAAC;AASM,IAAM,OAAO,CAACC,QAAiF;AAAjF,MAAAC,MAAAD,KAAE,aAAW,QAAQ,MAAM,QAAQ,WAAW,SApCnE,IAoCqBC,KAA2D,iBAA3DA,KAA2D,CAAzD,YAAmB,QAAM,SAAmB;AACjE,QAAMC,QAAO,OAAO,MAAM,IAAI,IAAIC,QAAM;AACxC,QAAM,eAAe,OACnB,gBAAAA,QAAA,cAAC,QAAK,IAAG,UACP,gBAAAA,QAAA,cAACD,OAAA,EAAK,QAAQ,OAAO,OAAO,OAAO,GAAG,GACxC,IACE;AAEJ,SACE,gBAAAC,QAAA,cAAC,gDAAkB,OAAlB,EAAwB,UACtB,aAAa,UAAU,cACxB,gBAAAA,QAAA,cAAC,QAAK,IAAG,QAAO,SAAQ,SAAQ,KAAK,EAAE,OAAO,UAAU,KACrD,QACH,GACC,aAAa,WAAW,YAC3B;AAEJ;;;ACrDA;AAAA,SAAS,WAAAC,UAAS,QAAAC,QAAM,WAAAC,gBAAe;AAIvC,IAAM,kBAAkB,OAAOC,QAAM,CAAC,CAAC;AAEvC,IAAM,qBAAqB,OAAOC,UAAS;AAAA,EACzC,QAAQ;AAAA,EACR,YAAY;AAAA,EACZ,WAAW;AAAA,IACT,SAAS;AAAA,EACX;AAAA,EACA,mBAAmB;AAAA,IACjB,WAAW;AAAA,EACb;AACF,CAAC;AAED,IAAM,qBAAqB,OAAOC,UAAS;AAAA,EACzC,GAAG;AAAA,EACH,GAAG;AAAA,EACH,WAAW;AAAA,EACX,wBAAwB;AAAA,IACtB,WAAW,GAAG,UAAU,oCAAoC,CAAC;AAAA,EAC/D;AAAA,EACA,0BAA0B;AAAA,IACxB,WAAW,GAAG,QAAQ,oCAAoC,CAAC;AAAA,EAC7D;AACF,CAAC;AAEM,IAAM,cAAc;AAAA,EACzB,MAAM;AAAA,EACN,SAAS;AAAA,EACT,SAAS;AACX;;;ACjCA;AAAA,OAAOC,YAA2B,aAAAC,aAAW,UAAAC,gBAAc;AAG3D,SAAS,SAAAC,eAAa;AACtB;AAAA,EAEE;AAAA,EACA;AAAA,EACA,2BAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;;;ACXP;AAAA,OAAOC,WAAS,aAAAC,YAAW,WAAAC,UAAS,UAAAC,eAAc;AAClD,SAAS,gBAAgB;AACzB;AAAA,EACE;AAAA,EACA;AAAA,EACA,kBAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,yBAAAC;AAAA,OACK;;;ACZP;AAAA,OAAOC,WAAS,eAAAC,oBAAmB;AACnC,SAAS,2BAA2B,2BAA2B,iBAAAC,gBAAe,eAAAC,oBAAmB;AACjG,SAAS,aAAa,qBAAqB,mBAAmB;;;ACF9D;AAAA,OAAOC,aAAW;AAKlB,IAAM,kBAAkB,CAAC;AAAA,EACvB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,OAAO;AACT,MAOM;AACJ,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,GAAG;AAAA,QACH,cAAc;AAAA,QACd,SAAS,OAAO,SAAS;AAAA,MAC3B;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAACC;AAAA,MAAA;AAAA,QACC,SAAS;AAAA,QACT,KAAK;AAAA,UACH,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,OAAO,UAAU,qBAAqB;AAAA,UACtC,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,KAAK;AAAA,UACL,MAAM;AAAA,QACR;AAAA;AAAA,MAEC;AAAA,MACA;AAAA,IACH;AAAA,IACA,gBAAAD,QAAA,cAAC,UAAO,IAAQ,SAAkB,iBAAiB,UAAU;AAAA,EAC/D;AAEJ;AAEA,IAAO,0BAAQ;;;ACpDf;AAAA,SAAS,eAAAE,cAAa,WAAAC,gBAAe;AACrC;AAAA,EACE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,eAAAC;AAAA,EACA,sBAAAC;AAAA,OACK;;;ACbP;AAAA,SAAS,YAAAC,iBAAgB;AACzB,SAAS,uBAAuB;AAEzB,IAAM,sBAAsB;AAAA,EACjC,SAAS;AAAA,EACT,eAAe;AAAA,EACf,aAAa;AAAA,EACb,WAAW;AAAA,EACX,SAAS;AACX;AAEO,IAAM,2BAA2B;AAAA,EACtC,MAAM;AAAA,EACN,cAAc;AAAA,EACd,cAAc;AAChB;AAEO,IAAM,qBAAqB,CAAC,KAAK,sBAAsB;AAC5D,QAAM,CAAC,mBAAmB,eAAe,IAAI,gBAAgB,KAAK,iBAAiB;AACnF,QAAM,CAAC,YAAY,aAAa,IAAIA,UAAS,qBAAqB,iBAAiB;AACnF,QAAM,mBAAmB,WAAS;AAChC,kBAAc,KAAK;AACnB,oBAAgB,KAAK;AAAA,EACvB;AACA,SAAO,CAAC,YAAY,gBAAgB;AACtC;;;ADEO,IAAM,gBAAgB,kBAAgB;AAC3C,QAAM,aAAaC,aAAY,oBAAoB,SAAS,YAAY,YAAY,CAAC;AACrF,SAAO;AACT;AAWO,IAAM,mBAAmB,kBAAgB;AAC9C,QAAM,QAAQ,cAAc,YAAY;AACxC,QAAM,WAAW,cAAc;AAAA,IAC7B,MAAM,SAAS;AAAA,IACf,MAAM;AAAA,EACR,CAAC;AACD,SAAO,CAAC,OAAO,QAAQ;AACzB;AAUO,IAAM,eAAe,MAAM;AAChC,SAAOC,aAAY,cAAc,SAAS,SAAS,CAAC;AACtD;AAEO,IAAM,gBAAgB,MAAM;AA9DnC,MAAAC;AA+DE,UAAOA,MAAAD,aAAY,cAAc,SAAS,WAAW,CAAC,MAA/C,gBAAAC,IAAkD;AAC3D;AAEO,IAAM,eAAe,MAAM;AAChC,SAAOD,aAAY,cAAc,SAAS,SAAS,CAAC;AACtD;AAEO,IAAM,oBAAoB,MAAM;AACrC,QAAM,CAAC,EAAE,YAAY,IAAI,mBAAmB,SAAS,SAAS;AAC9D,SAAOE,aAAY,MAAM,aAAa,GAAG,CAAC,YAAY,CAAC;AACzD;AAEO,IAAM,sBAAsB,MAAM;AACvC,QAAM,CAAC,EAAE,cAAc,IAAI,mBAAmB,SAAS,WAAW;AAClE,SAAO,MAAM,eAAe;AAC9B;AACO,IAAM,iBAAiB,MAAM;AA/EpC,MAAAD,KAAAE;AAgFE,QAAM,gBAAgBH,aAAY,cAAc,SAAS,aAAa,CAAC;AACvE,QAAM,kBAAkBA,aAAY,8CAA8C,CAAC;AACnF,QAAM,yBAAwBC,MAAAD,aAAY,yBAAyB,eAAe,CAAC,MAArD,gBAAAC,IAAwD;AACtF,QAAM,yBAAwBE,MAAAH,aAAY,yBAAyB,eAAe,CAAC,MAArD,gBAAAG,IAAwD;AACtF,SAAOH,aAAY,gBAAgB,iBAAiB,yBAAyB,qBAAqB,CAAC;AACrG;AAEO,IAAM,6BAA6B,qBAAmB;AAC3D,QAAM,yBAAyBA,aAAY,oBAAoB,SAAS,yBAAyB,eAAe,CAAC;AACjH,SAAO;AACT;AAEO,IAAM,4BAA4B,MAAM;AAC7C,QAAM,yBAAyBA,aAAY,oBAAoB,SAAS,oBAAoB,CAAC;AAC7F,SAAO;AACT;AAEO,IAAM,gCAAgC,qBAAmB;AAC9D,QAAM,QAAQ,2BAA2B,eAAe;AACxD,QAAM,WAAW,cAAc;AAAA,IAC7B,MAAM,SAAS;AAAA,IACf,MAAM;AAAA,EACR,CAAC;AACD,SAAO,CAAC,OAAO,QAAQ;AACzB;AAEO,IAAM,sBAAsB,MAAM;AACvC,QAAM,mBAAmBA,aAAY,oBAAoB,SAAS,OAAO,CAAC;AAC1E,SAAO;AACT;AAEO,IAAM,yBAAyB,MAAM;AAC1C,QAAM,CAAC,OAAO,QAAQ,IAAI,mBAAmB,SAAS,OAAO;AAC7D,SAAO,CAAC,OAAO,QAAQ;AACzB;AAEO,IAAM,2BAA2B,qBAAmB;AACzD,QAAM,yBAAyBA,aAAY,oBAAoB,SAAS,cAAc,eAAe,CAAC;AACtG,SAAO;AACT;AAEO,IAAM,+BAA+B,qBAAmB;AAC7D,QAAM,QAAQ,yBAAyB,eAAe;AACtD,QAAM,WAAW,cAAc;AAAA,IAC7B,MAAM,SAAS;AAAA,IACf,MAAM;AAAA,EACR,CAAC;AACD,SAAO,CAAC,OAAO,QAAQ;AACzB;AAEO,IAAM,qBAAqB,gBAAc;AAC9C,QAAM,QAAQA,aAAY,cAAc,UAAU,CAAC;AACnD,QAAM,UAAU,cAAc;AAC9B,QAAM,WAAWE;AAAA,IACf,CAAAE,WAAS;AACP,cAAQ,WAAW,YAAYA,MAAK;AAAA,IACtC;AAAA,IACA,CAAC,SAAS,UAAU;AAAA,EACtB;AACA,SAAO,CAAC,OAAO,QAAQ;AACzB;AAEA,IAAM,gBAAgB,CAAC,EAAE,MAAM,KAAK,MAAM;AACxC,QAAM,UAAU,cAAc;AAC9B,QAAM,QAAQC,oBAAmB;AACjC,QAAM,CAAC,EAAE,cAAc,IAAI,mBAAmB,oBAAoB,WAAW;AAC7E,QAAM,WAAWH;AAAA,IACf,WAAS;AACP,UAAI,CAAC,MAAM;AACT;AAAA,MACF;AACA,cAAQ;AAAA,QACN;AAAA,QACA,OACI;AAAA,UACE,CAAC,IAAI,GAAG;AAAA,QACV,IACA;AAAA,QACJ;AAAA,MACF;AACA,YAAM,UAAU,MAAM,SAAS,cAAc,CAAC;AAC9C,qBAAe,iCACV,QAAQ,aADE;AAAA,QAEb,CAAC,YAAY,WAAW,GAAG;AAAA,QAC3B,yBAAyB,QAAQ;AAAA,MACnC,EAAC;AAAA,IACH;AAAA,IACA,CAAC,SAAS,MAAM,MAAM,OAAO,cAAc;AAAA,EAC7C;AACA,SAAO;AACT;AAEO,IAAM,eAAe,MAAM;AAChC,QAAM,cAAcF,aAAY,iBAAiB;AACjD,QAAM,QAAQA,aAAY,WAAW;AAErC,QAAM,YAAYM,SAAQ,MAAM;AAC9B,YAAO,2CAAa,eAAc,2CAAa,cAAY,+BAAO,UAAS;AAAA,EAC7E,GAAG,CAAC,2CAAa,UAAU,2CAAa,WAAW,+BAAO,MAAM,CAAC;AAEjE,SAAO,EAAE,UAAU;AACrB;AAEO,IAAM,mBAAmB,MAAM;AACpC,QAAM,CAAC,WAAW,YAAY,IAAI,mBAAmB,SAAS,SAAS;AAEvE,QAAM,cAAcJ;AAAA,IAClB,UAAQ;AACN,mBAAa;AAAA,QACX,CAAC,WAAW,UAAU,GAAG,uCAAW;AAAA,QACpC,CAAC,WAAW,IAAI,GAAG;AAAA,MACrB,CAAC;AAAA,IACH;AAAA,IACA,CAAC,uCAAW,YAAY,YAAY;AAAA,EACtC;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA,YAAY,uCAAW;AAAA,IACvB,MAAM,uCAAW;AAAA,EACnB;AACF;AAEO,IAAM,gCAAgC,MAAM;AACjD,QAAM,6BAA6BF,aAAY,oBAAoB,SAAS,iBAAiB,CAAC;AAC9F,SAAO;AACT;AACO,IAAM,0BAA0B,MAAM;AAC3C,QAAM,CAAC,4BAA4B,2BAA2B,IAAI,mBAAmB,SAAS,iBAAiB;AAC/G,SAAO,CAAC,4BAA4B,2BAA2B;AACjE;;;AEnNA;AAEO,IAAM,kBAAkB,IAAI;AAAA,EACjC,MAAM;AAAA,EACN,IAAI;AAAA,EACJ,IAAI;AAAA,EACJ,WAAW;AACb,CAAC;AAEM,IAAM,iBAAiB,IAAI;AAAA,EAChC,SAAS;AAAA,EACT,eAAe;AAAA,EACf,aAAa;AAAA,IACX,SAAS;AAAA,EACX;AACF,CAAC;;;AJLM,IAAM,aAAa;AAAA,EACxB,SAAS;AAAA,EACT,SAAS;AAAA,EACT,WAAW;AACb;AAIO,IAAM,wBAAwB;AAAA,EACnC,CAAC,WAAW,OAAO,GAAG,gBAAAO,QAAA,cAAC,iBAAY;AAAA,EACnC,CAAC,WAAW,OAAO,GAAG,gBAAAA,QAAA,cAAC,iBAAY;AAAA,EACnC,CAAC,WAAW,SAAS,GAAG,gBAAAA,QAAA,cAAC,yBAAoB;AAC/C;AAEO,IAAM,iBAAiB,MAAM;AAClC,QAAM,aAAaC,eAAc;AACjC,QAAM,sBAAsBC,aAAY,yBAAyB;AACjE,QAAM,sBAAsBA,aAAY,yBAAyB;AACjE,QAAM,CAAC,EAAE,aAAa,cAAc,iBAAiB,GAAG,aAAa,IAAI,iBAAiB;AAC1F,QAAM,oBAAoBC;AAAA,IACxB,CAAO,sBAAgC;AACrC,UAAI,mBAAmB;AAErB,gCAAwB,MAAM,WAAW,qBAAqB,KAAK;AACnE,gCAAwB,MAAM,WAAW,sBAAsB,KAAK;AAAA,MACtE;AACA,oBAAc,EAAE,CAAC,YAAY,WAAW,GAAG,kBAAkB,CAAC;AAAA,IAChE;AAAA,IACA,CAAC,YAAY,qBAAqB,qBAAqB,aAAa;AAAA,EACtE;AAEA,SACE,gBAAAH,QAAA,cAAC,OAAI,WAAW,gBAAgB,KAC9B,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,GAAG,QAAQ,IAAI,MAAM,IAAI,MAAM,OAAO,EAAE,SAAS,OAAO,EAAE,KACpF,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,YAAY,YAAY,KAAG,kBACpC,cAAa,GAC9B,GACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,OAAM,KAAK,EAAE,MAAM,QAAQ,KACvC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAM;AAAA,MACN,OAAO,CAAC,YAAY;AAAA,MACpB,KAAK;AAAA,MACL,KAAK;AAAA,MACL,eAAe,OAAK;AAClB,sBAAc,EAAE,CAAC,YAAY,YAAY,GAAG,EAAE,CAAC,EAAE,CAAC;AAAA,MACpD;AAAA,MACA,KAAK,EAAE,GAAG,MAAM;AAAA;AAAA,EAClB,CACF,CACF,GACA,gBAAAA,QAAA,cAAC,2BAAgB,OAAM,mBAAkB,IAAG,iBAAgB,SAAS,aAAa,UAAU,mBAAmB,GAC/G,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,IAAG;AAAA,MACH,SAAS;AAAA,MACT,UAAU,WAAS;AACjB,sBAAc;AAAA,UACZ,CAAC,YAAY,gBAAgB,GAAG;AAAA,QAClC,CAAC;AAAA,MACH;AAAA;AAAA,EACF,CACF;AAEJ;;;AKzEA;AAAA,SAAS,WAAAI,gBAAe;AAUxB;AAAA,EACE;AAAA,EACA;AAAA,EACA;AAAA,EACA,eAAAC;AAAA,EACA;AAAA,OACK;;;AChBP;AAEA,IAAAC,iBAAmC;AAFnC,OAAOC,aAAW;;;ACAlB;AAAA,SAAS,eAAAC,cAAa,aAAAC,YAAW,UAAAC,SAAQ,YAAAC,iBAAgB;;;ACAzD;AACA,SAAS,4BAA4B;AAE9B,IAAM,gBAAwB;AAAA,EACnC,IAAI;AAAA,EACJ,SAAS;AAAA,EACT,aAAa;AAAA,EACb,QAAQ;AAAA,EACR,YAAY;AAAA,IACV,aAAa;AAAA,EACf;AAAA,EACA,QAAQ,CAAC;AAAA,EACT,SAAS,CAAC;AAAA,EACV,SAAS;AAAA,IACP,SAAS;AAAA,MACP,SAAS;AAAA,QACP,UAAU;AAAA,UACR,gBAAgB;AAAA,YACd,OAAO;AAAA,YACP,WAAW;AAAA,UACb;AAAA,UACA,WAAW;AAAA,YACT,eAAe,qBAAqB;AAAA,YACpC,gBAAgB;AAAA,YAChB,mBAAmB;AAAA,UACrB;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,IACA,cAAc;AAAA,MACZ,SAAS;AAAA,QACP,UAAU;AAAA,UACR,MAAM;AAAA,YACJ,qBAAqB;AAAA,YACrB,sBAAsB;AAAA,YACtB,YAAY;AAAA,YACZ,wBAAwB;AAAA,YACxB,qBAAqB;AAAA,YACrB,iBAAiB,CAAC;AAAA,YAClB,oBAAoB;AAAA,cAClB,kBAAkB;AAAA,cAClB,gBAAgB;AAAA,cAChB,kBAAkB;AAAA,YACpB;AAAA,UACF;AAAA,UACA,kBAAkB,CAAC;AAAA,UACnB,mBAAmB;AAAA,YACjB,MAAM;AAAA,cACJ,yBAAyB;AAAA,cACzB,iBAAiB,CAAC;AAAA,cAClB,0BAA0B;AAAA,YAC5B;AAAA,UACF;AAAA,UACA,iBAAiB,CAAC;AAAA,QACpB;AAAA,MACF;AAAA,IACF;AAAA,IACA,OAAO,CAAC;AAAA,EACV;AACF;;;ADtDA,IAAM,iBAAiB,IAAkC,2CAA3B,MAAM,IAAI,UAAU,CAAC,GAAM;AACvD,QAAM,cAAc;AACpB,MAAI,QAAQ,MAAM,sBAAsB;AACxC,WAAS,IAAI,GAAG,IAAI,aAAa,KAAK;AACpC,QAAI;AACF,aAAO,MAAM,MAAM,KAAK,OAAO;AAAA,IACjC,SAAS,KAAK;AACZ,cAAQ;AAAA,IACV;AAAA,EACF;AACA,UAAQ,MAAM,kCAAkC,EAAE,KAAK,QAAQ,CAAC;AAChE,QAAM;AACR;AAcO,IAAM,qBAAqB,CAAC;AAAA,EACjC,WAAW;AAAA,EACX,YAAY;AACd,MAA2D;AACzD,QAAM,CAAC,QAAQ,SAAS,IAAIC,UAA6B,MAAS;AAClE,QAAM,aAAaC,QAAoB;AACvC,QAAM,iBAAiBA,QAAe;AACtC,QAAM,oBAAoBA,QAAO,KAAK;AAEtC,QAAM,oBAAoBC,aAAY,MAAM,UAAU,eAAe,OAAO,GAAG,CAAC,CAAC;AAEjF,QAAM,0BAA0BA,aAAY,CAAC,SAAiB;AA1ChE,QAAAC;AA2CI,QAAI,CAAC,WAAW,SAAS;AACvB;AAAA,IACF;AACA,UAAM,CAACC,OAAM,OAAKD,MAAA,WAAW,YAAX,gBAAAA,IAAoB,SAAQ,CAAC,GAAG,OAAO,CAAAC,YAAUA,QAAO,SAAS,IAAI;AACvF,QAAIA,SAAQ;AACV,gBAAUA,OAAM;AAAA,IAClB;AAAA,EACF,GAAG,CAAC,CAAC;AACL,EAAAC,WAAU,MAAM;AACd,KAAC,MAAY;AApDjB,UAAAF,KAAAG;AAqDM,UAAI,kBAAkB,WAAW,CAAC,WAAW;AAC3C;AAAA,MACF;AACA,wBAAkB,UAAU;AAC5B,UAAI;AACF,cAAM,OAAO,MAAM,eAAe,YAAY,wCAAwC;AAAA,UACpF,SAAS;AAAA,YACP,eAAe,UAAU,SAAS;AAAA,UACpC;AAAA,QACF,CAAC;AACD,mBAAW,UAAU,MAAM,KAAK,KAAK;AAAA,MACvC,SAAS,GAAG;AACV,gBAAQ,MAAM,0FAA0F,CAAC;AACzG,mBAAW,UAAU;AAAA,UACnB,MAAM,CAAC,aAAa;AAAA,QACtB;AAAA,MACF;AACA,UAAI,iBAAgBA,OAAAH,MAAA,WAAW,YAAX,gBAAAA,IAAoB,SAApB,gBAAAG,IAA2B;AAC/C,UAAI,CAAC,eAAe;AAClB,gBAAQ;AAAA,UACN;AAAA,QACF;AACA,wBAAgB;AAAA,MAClB;AACA,YAAMF,UAAS;AACf,UAAI,CAAC,eAAe,SAAS;AAC3B,uBAAe,UAAUA;AAAA,MAC3B;AACA,gBAAUA,OAAM;AAChB,wBAAkB,UAAU;AAAA,IAC9B,IAAG;AAAA,EACL,GAAG,CAAC,WAAW,QAAQ,CAAC;AAExB,SAAO,EAAE,QAAQ,yBAAyB,kBAAkB;AAC9D;;;AD3EO,IAAM,oBAAoBG,QAAM,cAOrC,MAAS;AAKX,SAAS,WAAW,UAAmB,UAAmB;AACxD,UAAI,wBAAQ,QAAQ,SAAK,wBAAQ,QAAQ,GAAG;AAC1C,WAAO;AAAA,EACT;AAEA,SAAO;AACT;AAEO,IAAM,qBAAiF,CAAC;AAAA,EAC7F;AAAA,EACA;AAAA,EACA;AACF,MAAM;AACJ,QAAM,YAAoB,aAAa;AACvC,QAAM,EAAE,QAAQ,yBAAyB,kBAAkB,IAAI,mBAAmB;AAAA,IAChF;AAAA,IACA,UAAU;AAAA,EACZ,CAAC;AACD,QAAM,eAAe,aAAa,aAAS,0BAAU,QAAQ,gBAAgB,UAAU,IAAI;AAC3F,SACE,gBAAAA,QAAA,cAAC,kBAAkB,UAAlB,EAA2B,OAAO,EAAE,QAAQ,cAAc,yBAAyB,kBAAkB,KACnG,QACH;AAEJ;AAEO,IAAM,gBAAgB,MAAG;AAlDhC,MAAAC;AAkDmC,UAAAA,MAAAD,QAAM,WAAW,iBAAiB,MAAlC,gBAAAC,IAAqC;AAAA;AACjE,IAAM,sBAAsB,MAAG;AAnDtC,MAAAA;AAmDyC,UAAAA,MAAAD,QAAM,WAAW,iBAAiB,MAAlC,gBAAAC,IAAqC;AAAA;AACvE,IAAM,uBAAuB,MAAG;AApDvC,MAAAA;AAoD0C,UAAAA,MAAAD,QAAM,WAAW,iBAAiB,MAAlC,gBAAAC,IAAqC;AAAA;;;AGpD/E;AA0CO,IAAM,cAAc,oBAAkB;AAC3C,MAAI;AACF,WAAO,CAAC,iBAAiB,CAAC,IAAI,KAAK,MAAM,cAAc;AAAA,EACzD,SAAS,OAAO;AACd,WAAO,CAAC;AAAA,EACV;AACF;AAQO,IAAM,yBAAyB,MAAM;AAC1C,SAAO,OAAO,UAAU,aAAa,oBAAoB;AAC3D;AAoBO,IAAM,oBAAoB,SAAO;AACtC,QAAM,YAAY,IAAI,KAAK,aAAa,MAAM,EAAE,UAAU,WAAW,uBAAuB,EAAE,CAAC;AAC/F,QAAM,eAAe,UAAU,OAAO,GAAG;AACzC,SAAO;AACT;AAEO,IAAM,aAAa,mBAAiB;AACzC,kBAAgB,KAAK,MAAM,gBAAgB,GAAI;AAC/C,QAAM,QAAQ,KAAK,MAAM,gBAAgB,IAAI;AAC7C,QAAM,UAAU,KAAK,MAAO,gBAAgB,OAAQ,EAAE;AACtD,QAAM,UAAU,gBAAgB;AAChC,QAAM,OAAO,UAAU,IAAI,GAAG,QAAQ,KAAK,MAAM,EAAE,GAAG,KAAK,MAAM;AACjE,SAAO,GAAG,IAAI,GAAG,UAAU,KAAK,MAAM,EAAE,GAAG,OAAO,IAAI,UAAU,KAAK,MAAM,EAAE,GAAG,OAAO;AACzF;AAEA,IAAM,gBAAgB,CAACC,IAAGC,OAAM;AAC9B,MAAID,GAAE,WAAWC,GAAE;AAAQ,WAAO;AAAA,OAC7B;AAEH,aAAS,IAAI,GAAG,IAAID,GAAE,QAAQ,KAAK;AACjC,UAAIA,GAAE,CAAC,MAAMC,GAAE,CAAC,GAAG;AACjB,eAAO;AAAA,MACT;AAAA,IACF;AACA,WAAO;AAAA,EACT;AACF;AAEO,IAAM,qBAAqB,CAAC,QAAQ,mBAAmB,SAAS;AACrE,MAAI,8CAAsC;AACxC,YAAO,iCAAQ,aAAW,uDAAmB;AAAA,EAC/C,WAAW,kDAAwC;AACjD,YAAO,iCAAQ,aAAW,uDAAmB,YAAW,cAAc,iCAAQ,SAAS,uDAAmB,OAAO;AAAA,EACnH;AACF;AAEO,IAAM,mBAAmB,CAAC,MAAM,YAAY,GAAG,YAAY,SAAS;AACzE,SAAO,QAAQ,KAAK,UAAU,aAAa,KAAK,UAAU;AAC5D;AAEO,IAAM,kCAAkC,CAAC,iBAAiB,qBAAqB;AACpF,MAAI,CAAC,mBAAmB,CAAC,kBAAkB;AACzC,WAAO,CAAC,QAAW,MAAS;AAAA,EAC9B;AAEA,MAAI,aAAa;AACjB,MAAI,mBAAmB,OAAO,oBAAoB,KAAK;AACrD,iBAAa;AAAA,EACf,WAAW,mBAAmB,OAAO,oBAAoB,KAAK;AAC5D,iBAAa;AAAA,EACf;AAEA,MAAI,gBAAgB;AACpB,MAAI,mBAAmB,OAAO,oBAAoB,KAAK;AACrD,oBAAgB;AAAA,EAClB;AAEA,SAAO,CAAC,YAAY,aAAa;AACnC;AAEO,IAAM,oBAAoB,uBAAuB,KAAK,UAAU,SAAS;AAEzE,IAAM,mBAAmB,CAAC,WAAW,QAAQ,WAAW;AAC7D,SAAO,UAAU;AAAA,IAAI,cAAS;AA7IhC,UAAAC;AA8II,cAAAA,MAAA,SAAS,cAAT,gBAAAA,IAAoB;AAAA,QAClB,cAAS;AA/If,cAAAA,KAAAC;AAgJQ,gCAAaD,MAAA,SAAS,SAAT,gBAAAA,IAAe,YAAW,YAAUC,MAAA,SAAS,SAAT,gBAAAA,IAAe,YAAW,WAAW,CAAC,SAAS;AAAA;AAAA;AAAA;AAAA,EAEtG;AACF;AAEO,IAAM,iBAAiB,eAAa;AACzC,MAAI,qBAAqB;AAEzB,SAAO,KAAK,SAAS,EAAE,QAAQ,SAAO;AACpC,UAAM,SAAS,SAAS,GAAG;AAC3B,QAAI,SAAS,sBAAsB,UAAU,GAAG,GAAG;AACjD,2BAAqB;AAAA,IACvB;AAAA,EACF,CAAC;AAED,SAAO,qBAAqB;AAC9B;;;AJ/HA,SAAS,oBAAwD;AAAA,EAC/D;AACF,GAAoD;AAnCpD,MAAAC;AAoCE,QAAM,aAAa,cAAc;AACjC,QAAM,eAAcA,MAAA,yCAAY,YAAZ,gBAAAA,IAAsB;AAC1C,SAAO;AACT;AAIO,SAAS,6BAA6B;AA3C7C,MAAAA;AA4CE,QAAM,cAAc,oBAAoB,EAAE,QAAQ,UAAU,CAAC;AAC7D,QAAM,yBAAyB,CAAC,CAAC,eAAe,EAAC,2CAAa;AAC9D,MAAI;AACJ,MAAI;AACJ,MAAI,wBAAwB;AAC1B,iBAAa,OAAO,KAAK,WAAW,EAAE,OAAO,SAAO,QAAQ,qBAAqB,EAAE,CAAC;AACpF,gBAAWA,MAAA,YAAY,UAAU,MAAtB,gBAAAA,IAAyB;AAAA,EACtC;AACA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;AAIO,SAAS,kCAAkC;AA7DlD,MAAAA,KAAAC;AA8DE,QAAM,cAAc,oBAAoB,EAAE,QAAQ,eAAe,CAAC,KAAK,CAAC;AACxE,QAAM,aAAa,OAAO,KAAK,WAAW,EAAE,CAAC;AAC7C,QAAM,YAAWD,MAAA,YAAY,UAAU,MAAtB,gBAAAA,IAAyB;AAE1C,QAAM,iBAAyBC,MAAA,YAAY,UAAU,MAAtB,gBAAAA,IAAyB,iBAAgB,CAAC;AACzE,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;AAEO,SAAS,2BAA2B;AA1E3C,MAAAD,KAAAC;AA2EE,QAAM,cAAc,oBAAoB,EAAE,QAAQ,QAAQ,CAAC;AAC3D,QAAM,uBAAuB,CAAC,CAAC;AAC/B,SAAO;AAAA,IACL;AAAA,IACA,WAAUA,OAAAD,MAAA,2CAAa,YAAb,gBAAAA,IAAsB,aAAtB,gBAAAC,IAAgC;AAAA,EAC5C;AACF;AAEO,SAAS,sBAAsB;AAnFtC,MAAAD,KAAAC;AAoFE,QAAM,EAAE,SAAS,IAAI,gCAAgC;AAErD,QAAM,EAAE,cAAc,IAAI,sBAAsB;AAChD,QAAM,YAAYC,aAAY,eAAe;AAC7C,QAAM,mBAAmBA,aAAY,mBAAmB;AACxD,QAAM,WAAWA,aAAY,cAAc;AAG3C,QAAM,UAAUC,SAAQ,MAAM;AA5FhC,QAAAH;AA6FI,UAAMI,WAAU,CAAC;AACjB,SAAIJ,MAAA,qCAAU,SAAS,OAAnB,gBAAAA,IAAwB,cAAc;AACxC,MAAAI,SAAQ,KAAK,GAAG,kBAAkB,SAAS,CAAC,WAAW;AACvD,MAAAA,SAAQ,KAAK,SAAS,SAAS,CAAC,EAAE,WAAW,CAAC;AAAA,IAChD,WAAW,kBAAkB;AAC3B,MAAAA,SAAQ,KAAK,gBAAgB;AAAA,IAC/B;AACA,QAAI,eAAe;AACjB,MAAAA,SAAQ,KAAK,WAAW;AAAA,IAC1B;AACA,WAAOA;AAAA,EACT,GAAG,CAAC,qCAAU,UAAU,eAAe,WAAW,gBAAgB,CAAC;AAEnE,SAAO;AAAA,IACL,SAAOJ,MAAA,SAAS,WAAT,gBAAAA,IAAiB,UAAS;AAAA,IACjC,eAAaC,MAAA,SAAS,WAAT,gBAAAA,IAAiB,gBAAe;AAAA,IAC7C;AAAA,EACF;AACF;;;AK/GA;AAAA,SAAS,eAAAI,oBAAmB;AAC5B,SAAS,OAAO,SAAS;AACzB,SAAS,iBAAAC,gBAAe,iBAAAC,gBAAe,eAAAC,cAAa,sBAAAC,2BAA0B;AASvE,IAAM,wBAAwB,kBAAgB;AACnD,MAAI,CAAC,cAAc;AACjB,UAAM,MAAM,mCAAmC;AAAA,EACjD;AACA,SAAOC,aAAYC,eAAc,SAAS,QAAQ,CAAC,MAAM;AAC3D;AAMO,IAAM,mBAAmB,MAAM;AACpC,QAAM,WAAWD,aAAYC,eAAc,SAAS,QAAQ,CAAC;AAC7D,SAAO;AACT;AAMO,IAAM,oBAAoB,kBAAgB;AAC/C,QAAM,aAAaC,eAAc;AACjC,QAAM,eAAeC,oBAAmB;AACxC,QAAM,iBAAiBC,aAAY,MAAM;AACvC,UAAM,SAAS,aAAa,SAASH,eAAc,SAAS,QAAQ,CAAC,MAAM;AAC3E,eAAW,WAAW,SAAS,UAAU,CAAC,SAAS,eAAe,EAAE;AAAA,EACtE,GAAG,CAAC,cAAc,YAAY,YAAY,CAAC;AAC3C,SAAO;AACT;AAEO,IAAM,oBAAoB,MAAM;AACrC,QAAM,aAAaC,eAAc;AACjC,QAAM,EAAE,MAAM,aAAa,IAAI,iBAAiB;AAChD,QAAM,SAAS,iBAAiB,MAAM,kBAAkB;AAExD,QAAM,iBAAiBE;AAAA,IACrB,QAAM;AACJ,YAAM,EAAE,IAAI,QAAQ,KAAK,CAAC,EACvB;AAAA,QACC;AAAA,UACE,IAAI,EAAE;AAAA,QACR;AAAA,QACA,MAAM;AACJ,uBAAa;AAAA,YACX,CAAC,WAAW,UAAU,GAAG;AAAA,YACzB,CAAC,WAAW,IAAI,GAAG,WAAW;AAAA,UAChC,CAAC;AACD,qBAAW,WAAW,SAAS,UAAU,kBAAkB,KAAK;AAAA,QAClE;AAAA,MACF,EACC;AAAA,QACC;AAAA,UACE,QAAQ;AAAA,UACR,MAAM,EAAE,KAAK,CAAAC,UAAQ,CAAC,CAACA,KAAI;AAAA,QAC7B;AAAA,QACA,MAAM;AACJ,uBAAa;AAAA,YACX,CAAC,WAAW,UAAU,GAAG;AAAA,YACzB,CAAC,WAAW,IAAI,GAAG;AAAA,UACrB,CAAC;AACD,qBAAW,WAAW,SAAS,UAAU,EAAE;AAAA,QAC7C;AAAA,MACF,EACC,UAAU,MAAM;AACf,qBAAa;AAAA,UACX,CAAC,WAAW,UAAU,GAAG;AAAA,UACzB,CAAC,WAAW,IAAI,GAAG,WAAW;AAAA,QAChC,CAAC;AACD,mBAAW,WAAW,SAAS,UAAU,kBAAkB,KAAK;AAAA,MAClE,CAAC;AAAA,IACL;AAAA,IACA,CAAC,YAAY,MAAM,cAAc,MAAM;AAAA,EACzC;AAEA,SAAO;AACT;AAKO,IAAM,mBAAmB,MAAM;AACpC,QAAM,aAAaH,eAAc;AACjC,QAAM,gBAAgBE,aAAY,MAAM;AACtC,eAAW,WAAW,SAAS,UAAU,EAAE;AAC3C,eAAW,WAAW,SAAS,YAAY,EAAE;AAAA,EAC/C,GAAG,CAAC,UAAU,CAAC;AACf,SAAO;AACT;;;AClGA;AAAO,IAAM,qBAAqB;AAAA,EAChC,EAAE,OAAO,qBAAqB,OAAO,GAAG;AAAA,EACxC,EAAE,OAAO,WAAW,OAAO,UAAU;AAAA,EACrC,EAAE,OAAO,UAAU,OAAO,SAAS;AAAA,EACnC,EAAE,OAAO,iBAAiB,OAAO,gBAAgB;AAAA,EACjD,EAAE,OAAO,iBAAiB,OAAO,gBAAgB;AACnD;AACO,IAAM,mBAAmB;AAAA,EAC9B,EAAE,OAAO,mBAAmB,OAAO,GAAG;AAAA,EACtC,EAAE,OAAO,SAAS,OAAO,QAAQ;AAAA,EACjC,EAAE,OAAO,SAAS,OAAO,QAAQ;AACnC;AAEO,IAAM,wBAAwB,EAAE,MAAM,GAAG,SAAS,EAAE;;;AZmB3D,IAAM,iBAAiB;AAAA,EACrB,CAAC,SAAS,UAAU,GAAG;AAAA,IACrB,CAAC,YAAY,WAAW,GAAG;AAAA,IAC3B,CAAC,YAAY,YAAY,GAAG;AAAA,IAC5B,CAAC,YAAY,gBAAgB,GAAG;AAAA,IAChC,CAAC,YAAY,kBAAkB,GAAG;AAAA,IAClC,CAAC,YAAY,UAAU,GAAG;AAAA,IAC1B,CAAC,YAAY,gBAAgB,GAAG;AAAA,IAChC,CAAC,YAAY,UAAU,GAAG,WAAW;AAAA,EACvC;AAAA,EACA,CAAC,SAAS,uBAAuB,GAAG;AAAA,IAClC,aAAa;AAAA,IACb,WAAW;AAAA,IACX,aAAa;AAAA,IACb,OAAO;AAAA,IACP,kBAAkB;AAAA,EACpB;AAAA,EACA,CAAC,SAAS,QAAQ,GAAG;AAAA,EACrB,CAAC,SAAS,YAAY,GAAG;AAAA,IACvB,CAAC,cAAc,IAAI,GAAG;AAAA,IACtB,CAAC,cAAc,IAAI,GAAG,CAAC;AAAA,EACzB;AAAA,EACA,CAAC,SAAS,SAAS,GAAG;AAAA,EACtB,CAAC,SAAS,QAAQ,GAAG;AAAA,EACrB,CAAC,SAAS,KAAK,GAAG;AAAA,EAClB,CAAC,SAAS,UAAU,GAAG;AAAA,EACvB,CAAC,SAAS,WAAW,GAAG;AAAA,EACxB,CAAC,SAAS,gBAAgB,GAAG;AAAA,EAC7B,CAAC,SAAS,YAAY,GAAG,CAAC;AAAA,EAC1B,CAAC,SAAS,SAAS,GAAG;AAAA,EACtB,CAAC,SAAS,aAAa,GAAG;AAAA,EAC1B,CAAC,SAAS,uBAAuB,GAAG;AAAA,EACpC,CAAC,SAAS,oBAAoB,GAAG;AAAA,EACjC,CAAC,SAAS,cAAc,GAAG;AAAA,EAC3B,CAAC,SAAS,UAAU,GAAG;AAAA,EACvB,CAAC,SAAS,SAAS,GAAG;AAAA,IACpB,CAAC,WAAW,UAAU,GAAG;AAAA,IACzB,CAAC,WAAW,IAAI,GAAG;AAAA,EACrB;AAAA;AAAA,EAEA,CAAC,SAAS,OAAO,GAAG;AAAA,EACpB,CAAC,SAAS,iBAAiB,GAAG;AAChC;AAEO,IAAM,UAAUE,QAAM,KAAK,MAAM;AA5ExC,MAAAC,KAAAC,KAAA;AA6EE,QAAM,aAAaC,eAAc;AACjC,QAAM,CAAC,cAAc,CAAC,CAAC,IAAI,mBAAmB,oBAAoB,WAAW;AAC7E,QAAM,UAAUC,aAAY,iBAAiB;AAC7C,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,WAAW,kBAAkB,kBAAkB,EAAE;AACvD,QAAM,EAAE,oBAAoB,IAAI,YAAY;AAC5C,QAAM,oBAAoBC,QAAO,KAAK;AACtC,QAAM,CAAC,EAAE,2BAA2B,IAAI,wBAAwB;AAChE,QAAM,WAAW,SAAS,OAAU,MAAM,EAAE;AAE5C,EAAAC,WAAU,MAAM;AAvFlB,QAAAL;AAwFI,SAAIA,MAAA,qCAAU,uBAAV,gBAAAA,IAA8B,oBAAoB;AACpD,kCAA4B,IAAI;AAAA,IAClC;AAAA,EACF,GAAG,EAACA,MAAA,qCAAU,uBAAV,gBAAAA,IAA8B,oBAAoB,2BAA2B,CAAC;AAElF,QAAM,kBAAkBM,SAAQ,MAAM;AA7FxC,QAAAN;AA8FI,UAAM,UAAQA,MAAA,qCAAU,uBAAV,gBAAAA,IAA8B,qBAAoB,CAAC;AACjE,aAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACrC,UAAI,MAAM,CAAC,EAAE,WAAW,MAAM,CAAC,EAAE,KAAK;AACpC,eAAO,MAAM,CAAC,EAAE;AAAA,MAClB;AAAA,IACF;AACA,WAAO;AAAA,EACT,GAAG,EAACC,MAAA,qCAAU,uBAAV,gBAAAA,IAA8B,gBAAgB,CAAC;AAEnD,EAAAI,WAAU,MAAM;AACd,eAAW,YAAY,kCAClB,iBACA,QACJ;AAED,eAAW,iBAAiB;AAAA,MAC1B,MAAM;AAAA,MACN,YAAY;AAAA,MACZ,SAASN,QAAM;AAAA,IACjB,CAAC;AAAA,EAEH,GAAG,CAAC,UAAU,CAAC;AAEf,EAAAM,WAAU,MAAM;AACd,UAAM,aAAa,eAAe,CAAC;AACnC,UAAM,kBAAkB,iCACnB,aADmB;AAAA,MAEtB,CAAC,YAAY,WAAW,GAAG;AAAA,MAC3B,CAAC,YAAY,UAAU,GAAG,WAAW,cAAc;AAAA,IACrD;AACA,eAAW,WAAW,SAAS,YAAY,iBAAiB,IAAI;AAAA,EAClE,GAAG,CAAC,YAAY,WAAW,CAAC;AAE5B,EAAAA,WAAU,MAAM;AA/HlB,QAAAL,KAAAC;AAgII,eAAW;AAAA,MACT,SAAS;AAAA,MACT;AAAA,QACE,CAAC,YAAY,YAAY,GAAG,WACxB,sBAAsB,OACtB,QAAOA,OAAAD,MAAA,qCAAU,sBAAV,gBAAAA,IAA6B,SAA7B,gBAAAC,IAAmC,aAAa,KAAK,sBAAsB;AAAA,MACxF;AAAA,MACA;AAAA,IACF;AAAA,EACF,GAAG,CAAC,YAAY,WAAU,gDAAU,sBAAV,mBAA6B,SAA7B,mBAAmC,aAAa,CAAC;AAE3E,EAAAI,WAAU,MAAM;AACd,QAAI,CAAC,YAAY,yBAAyB;AACxC;AAAA,IACF;AACA,eAAW,WAAW,SAAS,yBAAyB,YAAY,yBAAyB,IAAI;AAAA,EACnG,GAAG,CAAC,YAAY,yBAAyB,UAAU,CAAC;AAEpD,EAAAA,WAAU,MAAM;AACd,QAAI,mBAAmB,CAAC,kBAAkB,WAAW,qBAAqB;AACxE,iBAAW,WAAW,SAAS,YAAY,eAAe;AAC1D,wBAAkB,UAAU;AAC5B,eAAS;AAAA,IACX;AAAA,EACF,GAAG,CAAC,YAAY,UAAU,qBAAqB,eAAe,CAAC;AAE/D,SAAO,gBAAAN,QAAA,cAAC,yBAAoB;AAC9B,CAAC;AAKD,IAAM,sBAAsB,MAAM;AAChC,QAAM,EAAE,cAAc,eAAe,qBAAqB,IAAIQ,uBAAsB;AACpF,QAAM,WAAWJ,aAAYK,eAAc,EAAE;AAC7C,QAAM,YAAYL,aAAY,eAAe,EAAE;AAC/C,QAAM,YAAYA,aAAY,eAAe;AAC7C,QAAM,CAAC,YAAY,aAAa,IAAI,mBAAmB,SAAS,UAAU;AAC1E,QAAM,CAAC,kBAAkB,mBAAmB,IAAI,mBAAmB,SAAS,gBAAgB;AAC5F,QAAM,CAAC,aAAa,cAAc,IAAI,mBAAmB,SAAS,WAAW;AAC7E,QAAM,kBAAkB,kBAAkB,kBAAkB,SAAS;AACrE,QAAM,kBAAkB,sBAAsB,kBAAkB,SAAS;AAEzE,EAAAE,WAAU,MAAM;AACd,QAAI,wBAAwB,kBAAkB;AAC5C,0BAAoB,KAAK;AAAA,IAC3B;AAAA,EACF,GAAG,CAAC,sBAAsB,kBAAkB,mBAAmB,CAAC;AAIhE,EAAAA,WAAU,MAAM;AACd,QAAI,cAAc,aAAa,cAAc;AAC3C,oBAAc,KAAK;AACnB,0BAAoB,KAAK;AACzB,qBAAe,KAAK;AAAA,IACtB;AAAA,EACF,GAAG,CAAC,WAAW,eAAe,gBAAgB,mBAAmB,CAAC;AAClE,EAAAA,WAAU,MAAM;AACd,QAAI,gBAAgB,UAAU;AAC5B,UAAI,YAAY;AACd,sBAAc,KAAK;AACnB,YAAI,iBAAiB;AACnB,0BAAgB;AAAA,QAClB;AAAA,MACF;AAAA,IACF;AAAA,EACF,GAAG,CAAC,cAAc,YAAY,eAAe,UAAU,iBAAiB,eAAe,CAAC;AACxF,EAAAA,WAAU,MAAM;AACd,QAAI,iBAAiB,aAAa,sBAAsB;AACtD,UAAI,aAAa;AACf,uBAAe,KAAK;AACpB,YAAI,iBAAiB;AACnB,0BAAgB;AAAA,QAClB;AAAA,MACF;AAAA,IACF;AAAA,EACF,GAAG,CAAC,eAAe,gBAAgB,aAAa,WAAW,sBAAsB,iBAAiB,eAAe,CAAC;AAClH,SAAO;AACT;;;Aa/MA;AAAA,OAAOI,WAAS,aAAAC,YAAW,UAAAC,SAAQ,YAAAC,iBAAgB;AACnD,SAAS,yBAAyB;AAClC,SAAS,SAAAC,cAAa;AACtB,SAAS,MAAM,YAAY;AAC3B,SAAuB,iBAAAC,sBAAqB;;;ACJ5C;AAAA,OAAOC,WAAS,cAAAC,mBAAkB;AAc3B,IAAM,qBAAqBC,QAAM,cAAsC;AAAA,EAC5E,UAAU;AAAA,EACV,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,mBAAmB;AAAA,EACnB,WAAW,CAAC;AAAA,EACZ,SAAS;AAAA,EACT,QAAQ;AACV,CAAC;AAED,mBAAmB,cAAc;AAE1B,IAAM,wBAAwB,MAAM;AACzC,QAAM,UAAUC,YAAW,kBAAkB;AAC7C,MAAI,CAAC,SAAS;AACZ,UAAM,MAAM,uFAAuF;AAAA,EACrG;AACA,SAAO;AACT;;;AChCA;AAAA,OAAOC,WAAS,cAAAC,aAAY,aAAAC,kBAAiB;AAC7C,SAAS,2BAA2B;AACpC,SAAS,SAAAC,QAAO,KAAAC,UAAS;AACzB,SAAS,gBAAAC,eAAc,mBAAAC,kBAAiB,iBAAAC,gBAAe,eAAAC,oBAAmB;;;ACH1E;AAEA,SAAS,aAAa,iCAAiC;AACvD,SAAS,mBAAAC,wBAAuB;AAEzB,IAAM,WAAN,MAAe;AAAA,EAAf;AAIL,4BAAmB,CAAO,eAAwB,WAAwB;AACxE,UAAI,KAAK,YAAY,GAAG;AACtB;AAAA,MACF;AACA,UAAI,eAAe;AACjB,YAAI;AAEF,gBAAM,UAAU,MAAM,OAAO,oDAAoD;AACjF,eAAK,gBAAgB,IAAI,QAAQ,iBAAiB,eAAe,MAAM;AAAA,QACzE,SAAS,OAAO;AACd,kBAAQ,MAAM,0CAA0C,OAAO,mBAAmB;AAClF,eAAK,YAAY,IAAI,YAAY,0BAA0B,MAAM,0BAA0B,IAAI;AAAA,QACjG;AAAA,MACF,OAAO;AACL,aAAK,YAAY,IAAI,YAAY,0BAA0B,MAAM,0BAA0B,IAAI;AAAA,MACjG;AAAA,IACF;AAEA,yBAAgB,MAAM;AA3BxB,UAAAC,KAAAC;AA4BI,UAAI,KAAK,eAAe;AACtB,gBAAOD,MAAA,KAAK,kBAAL,gBAAAA,IAAoB;AAAA,MAC7B,OAAO;AACL,cAAM,cAAaC,MAAA,KAAK,cAAL,gBAAAA,IAAgB;AAEnC,gBAAO,yCAAY,QAAO;AAAA,MAC5B;AAAA,IACF;AAEA,yBAAgB,MAAM;AArCxB,UAAAD;AAsCI,UAAI,KAAK,eAAe;AACtB,eAAO,KAAK,cAAc,cAAc;AAAA,MAC1C,OAAO;AAEL,iBAAOA,MAAA,KAAK,cAAL,gBAAAA,IAAgB,qBAAoB,0BAA0B,OAAO,IAAI;AAAA,MAClF;AAAA,IACF;AAEA,uBAAc,MAAM;AAClB,aAAO,KAAK,iBAAiB,KAAK;AAAA,IACpC;AAEA,mBAAU,MAAM;AAlDlB,UAAAA,KAAAC;AAmDI,aAAO,KAAK,iBAAgBD,MAAA,KAAK,kBAAL,gBAAAA,IAAoB,aAAYC,MAAA,KAAK,cAAL,gBAAAA,IAAgB;AAAA,IAC9E;AAEA,mBAAU,CAAO,cAAsB;AAtDzC,UAAAD,KAAAC;AAuDI,UAAI,KAAK,eAAe;AACtB,SAAAD,MAAA,KAAK,kBAAL,gBAAAA,IAAoB,QAAQ;AAAA,MAC9B,OAAO;AACL,eAAMC,MAAA,KAAK,cAAL,gBAAAA,IAAgB,cAAc,0BAA0B,MAAM,0BAA0B;AAAA,MAChG;AAAA,IACF;AAEA,yBAAgB,CAAO,aAAqB;AA9D9C,UAAAD,KAAAC,KAAA;AA+DI,UAAI,KAAK,eAAe;AACtB,SAAAD,MAAA,KAAK,kBAAL,gBAAAA,IAAoB,cAAc;AAAA,MACpC,OAAO;AACL,cAAM,MAAM,SAAS,cAAc,KAAK;AACxC,YAAI,UAAU;AACd,cAAM,cAAc;AACpB,YAAI,MAAM;AACV,YAAI,MAAM;AACV,YAAI;AACF,iBAAMC,MAAA,KAAK,cAAL,gBAAAA,IAAgB,cAAc,KAAK,0BAA0B;AAAA,QACrE,SAAS,GAAG;AACV,kBAAQ,MAAM,CAAC;AACf,cAAI,YAAY,aAAa;AAC3B,mBAAM,UAAK,cAAL,mBAAgB,cAAc,KAAK,0BAA0B;AAAA,UACrE;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAEA,qBAAY,CAAO,WAAmC;AACpD,UAAI,KAAK,eAAe;AACtB,cAAM,KAAK,cAAc,UAAU,MAAM;AAAA,MAC3C;AAAA,IACF;AAEA,qBAAY,MAAM;AAxFpB,UAAAD;AAyFI,eAAOA,MAAA,KAAK,kBAAL,gBAAAA,IAAoB,gBAAe;AAAA,IAC5C;AAEA,yBAAgB,MAAY;AA5F9B,UAAAA,KAAAC;AA6FI,UAAI,KAAK,eAAe;AACtB,SAAAD,MAAA,KAAK,kBAAL,gBAAAA,IAAoB;AAAA,MACtB,OAAO;AACL,eAAMC,MAAA,KAAK,cAAL,gBAAAA,IAAgB,cAAc,0BAA0B,MAAM,0BAA0B;AAAA,MAChG;AAAA,IACF;AAEA,iBAAQ,MAAM;AACZ,WAAK,gBAAgB;AACrB,WAAK,YAAY;AAAA,IACnB;AAEA,8BAAqB,MAAM;AAzG7B,UAAAD,KAAAC;AA0GI,UAAI,CAAC,UAAU;AACb,eAAO;AAAA,MACT;AACA,YAAM,mBAAiBA,OAAAD,MAAAE,qBAAA,gBAAAF,IAAiB,iBAAjB,gBAAAC,IAA+B,YAAW;AACjE,UAAI,kBAAkB,SAAS,eAAe,MAAM,GAAG,EAAE,CAAC,CAAC,IAAI,IAAI;AACjE,eAAO;AAAA,MACT;AACA,aAAO;AAAA,IACT;AAAA;AACF;AAEO,IAAM,YAAY,IAAI,SAAS;;;ACrHtC;AAAA,SAAS,eAAAE,oBAAmB;;;ACA5B;AAAA,YAAY,kBAAkB;;;ACA9B;AAAA,IAAI;AACJ,IAAI;AAEJ,SAAS,qBAAqB;AAC5B,MAAI,CAAC,mBAAmB;AACtB,wBAAoB,OACjB,iBAAiB,SAAS,eAAe,EACzC,iBAAiB,gCAAgC;AAAA,EACtD;AACA,MAAI,CAAC,qBAAqB;AACxB,0BAAsB,OACnB,iBAAiB,SAAS,eAAe,EACzC,iBAAiB,+BAA+B;AAAA,EACrD;AACF;AAEO,SAAS,uBAAuB;AACrC,sBAAoB;AACpB,wBAAsB;AACxB;AASO,SAAS,0BAA0B,eAAe,QAAQ;AAC/D,MAAI,aAAa,cAAc,OAAO,kBAAgB,aAAa,cAAc,IAAI;AAErF,QAAM,MAAM,OAAO,WAAW,IAAI;AAClC,qBAAmB;AACnB,MAAI,YAAY;AAChB,MAAI,UAAU,GAAG,GAAG,OAAO,OAAO,OAAO,MAAM;AAE/C,MAAI,WAAW,WAAW,GAAG;AAE3B,QAAI,SAAS,GAAG,GAAG,OAAO,OAAO,OAAO,MAAM;AAC9C;AAAA,EACF;AAEA,gBAAc,WAAW,MAAM,GAAG,CAAC,GAAG,KAAK,MAAM;AACnD;AAIO,SAAS,oBAAoB,QAAQ;AAC1C,QAAM,MAAM,OAAO,WAAW,IAAI;AAClC,qBAAmB;AACnB,MAAI,YAAY;AAChB,MAAI,SAAS,GAAG,GAAG,OAAO,OAAO,OAAO,MAAM;AAChD;AAMA,SAAS,cAAc,eAAe,KAAK,QAAQ;AACjD,QAAM,SAAS;AACf,SAAO,QAAQ;AACf,SAAO,SAAS;AAEhB,MAAI,YAAY;AAChB,MAAI,SAAS,GAAG,GAAG,OAAO,OAAO,OAAO,MAAM;AAE9C,MAAI,cAAc,SAAS,GAAG;AAC5B,QAAI,cAAc;AAClB,QAAI,YAAY,SAAS;AACzB,QAAI,WAAW,GAAG,GAAG,OAAO,OAAO,OAAO,MAAM;AAAA,EAClD;AAEA,MAAI,cAAc,WAAW,GAAG;AAC9B,UAAM,QAAQ,cAAc,CAAC;AAC7B,UAAM,EAAE,OAAO,OAAO,IAAI,oBAAoB,OAAO,OAAO,QAAQ,QAAQ,OAAO,SAAS,MAAM;AAKlG,UAAM,WAAW,OAAO,QAAQ,SAAS;AACzC,UAAM,WAAW,OAAO,SAAS,UAAU;AAC3C,QAAI,UAAU,OAAO,SAAS,SAAS,OAAO,MAAM;AAAA,EACtD;AAEA,MAAI,cAAc,WAAW,GAAG;AAC9B,kBAAc,QAAQ,CAAC,OAAO,UAAU;AACtC,YAAM,EAAE,OAAO,OAAO,IAAI;AAAA,QACxB;AAAA,QACA,OAAO,QAAQ,IAAI;AAAA;AAAA,QACnB,OAAO,SAAS;AAAA,MAClB;AAMA,YAAM,WAAW,OAAO,QAAQ,IAAI,SAAS,IAAK,OAAO,QAAQ,IAAK;AAItE,YAAM,WAAW,OAAO,SAAS,UAAU;AAE3C,UAAI,UAAU,OAAO,SAAS,SAAS,OAAO,MAAM;AAAA,IACtD,CAAC;AAID,UAAM,OAAO,IAAI,OAAO;AACxB,SAAK,OAAO,OAAO,QAAQ,GAAG,CAAC;AAC/B,SAAK,OAAO,OAAO,QAAQ,GAAG,OAAO,MAAM;AAC3C,QAAI,OAAO,IAAI;AAAA,EACjB;AAEA,MAAI,cAAc,WAAW,GAAG;AAC9B,kBAAc,QAAQ,CAAC,OAAO,UAAU;AACtC,YAAM,EAAE,OAAO,OAAO,IAAI,oBAAoB,OAAO,OAAO,QAAQ,IAAI,QAAQ,OAAO,SAAS,IAAI,MAAM;AAI1G,YAAM,UACJ,QAAQ,KAAK,OAAO,QAAQ,IAAI,SAAS,IAAK,OAAO,QAAQ,IAAK,QAAQ,OAAO,QAAQ,IAAI,QAAQ;AACvG,YAAM,WAAW,QAAQ,IAAI,IAAI,OAAO,SAAS,MAAM,OAAO,SAAS,IAAI,UAAU;AAErF,UAAI,UAAU,OAAO,SAAS,SAAS,OAAO,MAAM;AAAA,IACtD,CAAC;AAID,UAAM,OAAO,IAAI,OAAO;AACxB,SAAK,OAAO,OAAO,QAAQ,GAAG,CAAC;AAC/B,SAAK,OAAO,OAAO,QAAQ,GAAG,OAAO,SAAS,CAAC;AAC/C,QAAI,OAAO,IAAI;AACf,SAAK,OAAO,GAAG,OAAO,SAAS,CAAC;AAChC,SAAK,OAAO,OAAO,OAAO,OAAO,SAAS,CAAC;AAC3C,QAAI,OAAO,IAAI;AAAA,EACjB;AACA,MAAI,cAAc,WAAW,GAAG;AAC9B,kBAAc,QAAQ,CAAC,OAAO,UAAU;AACtC,YAAM,EAAE,OAAO,OAAO,IAAI,oBAAoB,OAAO,OAAO,QAAQ,IAAI,QAAQ,OAAO,SAAS,IAAI,MAAM;AAK1G,YAAM,WAAW,OAAO,QAAQ,IAAI,SAAS,IAAK,OAAO,QAAQ,KAAM,QAAQ;AAK/E,YAAM,WAAW,QAAQ,IAAI,IAAI,OAAO,SAAS,MAAM,OAAO,SAAS,IAAI,UAAU;AAErF,UAAI,UAAU,OAAO,SAAS,SAAS,OAAO,MAAM;AAAA,IACtD,CAAC;AAID,UAAM,OAAO,IAAI,OAAO;AACxB,SAAK,OAAO,OAAO,QAAQ,GAAG,CAAC;AAC/B,SAAK,OAAO,OAAO,QAAQ,GAAG,OAAO,MAAM;AAC3C,QAAI,OAAO,IAAI;AACf,SAAK,OAAO,GAAG,OAAO,SAAS,CAAC;AAChC,SAAK,OAAO,OAAO,OAAO,OAAO,SAAS,CAAC;AAC3C,QAAI,OAAO,IAAI;AAAA,EACjB;AACF;AAUA,SAAS,oBAAoB,OAAO,OAAO,QAAQ;AACjD,MAAI,aAAc,MAAM,aAAa,MAAM,cAAe;AAC1D,MAAI,cAAc;AAElB,MAAI,aAAa,OAAO;AACtB,iBAAa;AACb,kBAAe,MAAM,cAAc,MAAM,aAAc;AAAA,EACzD;AACA,SAAO,EAAE,OAAO,YAAY,QAAQ,YAAY;AAClD;;;ADjLA,IAAM,6BAA6B;AACnC,IAAM,cAAc;AACpB,IAAM,uBAAuB;AAC7B,IAAM,wBAAwB;AAC9B,IAAM,mBAAmB;AAkBzB,IAAM,aAAN,MAAiB;AAAA,EAWf,cAAc;AAVd,SAAQ,YAAY,oBAAI,IAA8B;AACtD,SAAQ,SAAmC;AAC3C,SAAQ,WAAoC;AAC5C,SAAQ,aAAgC;AACxC,SAAQ,aAAa;AACrB,SAAQ,gBAAoC,CAAC;AAC7C,SAAQ,gBAAmD;AAC3D,SAAQ,eAA8B,CAAC;AACvC,SAAQ,QAAmB;AA2E3B,gBAAO,MAAY;AA/GrB,UAAAC,KAAAC;AAgHI,UAAI,KAAK,UAAU,yBAAmB;AACpC;AAAA,MACF;AACA,WAAK,QAAQ;AACb,OAAAD,MAAA,KAAK,aAAL,gBAAAA,IAAe,oBAAoB,kBAAkB,KAAK;AAC1D,UAAI,KAAK,YAAY;AACnB,QAAa,0BAAa,KAAK,UAAU;AACzC,aAAK,aAAa;AAAA,MACpB;AACA,UAAI,KAAK,KAAK,GAAG;AACf,aAAK,QAAQ;AAAA,MACf;AAEA,YAAM,KAAK,yBAAyB,KAAK,cAAc,CAAC,CAAC;AACzD,OAAAC,MAAA,KAAK,kBAAL,gBAAAA,IAAA,WAAqB;AACrB,WAAK,cAAc,KAAK;AACxB,WAAK,MAAM;AACX,WAAK,QAAQ;AAAA,IACf;AAyBA;AAAA;AAAA;AAAA;AAAA,yBAAgB,CAACC,QAAgB;AAC/B,WAAK,UAAU,QAAQ,cAAY,qCAAWA,IAAG;AAAA,IACnD;AAtHE,SAAK,MAAM;AAAA,EACb;AAAA,EAEA,oBAAoB,IAA8B;AAChD,SAAK,UAAU,IAAI,EAAE;AAAA,EACvB;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ;AACN,YAAQ,MAAM,qBAAqB;AACnC,yBAAqB;AACrB,SAAK,SAAS;AACd,SAAK,WAAW;AAChB,SAAK,aAAa;AAClB,SAAK,aAAa;AAClB,SAAK,gBAAgB,CAAC;AACtB,SAAK,eAAe,CAAC;AACrB,SAAK,gBAAgB;AACrB,SAAK,QAAQ;AAAA,EACf;AAAA;AAAA;AAAA;AAAA,EAKA,cAAc;AACZ,WAAO,CAAC,CAAC,SAAS,2BAA2B,CAAC,SAAS,EAAE,WAAW;AAAA,EACtE;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO;AACL,WAAO,CAAC,CAAC,SAAS;AAAA,EACpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQM,MAAM,YAAwB,iBAA0D;AAAA;AAlFhG,UAAAF,KAAAC;AAmFI,UAAI,CAAC,KAAK,YAAY,GAAG;AACvB,cAAM,IAAI,MAAM,sCAAsC;AAAA,MACxD;AACA,cAAQ,MAAM,+BAA+B,KAAK,KAAK;AACvD,UAAI,KAAK,UAAU,yBAAmB;AACpC,cAAM,KAAK,KAAK;AAAA,MAClB,WAAW,KAAK,UAAU,2BAAoB;AAC5C;AAAA,MACF;AACA,WAAK,QAAQ;AACb,UAAI;AACF,cAAM,KAAK,KAAK,YAAY,eAAe;AAE3C,SAAAD,MAAA,KAAK,aAAL,gBAAAA,IAAe,iBAAiB,kBAAkB,KAAK;AACvD,aAAK,WAAW;AAChB,YAAI,CAAC,KAAK,KAAK,GAAG;AAChB,gBAAM,KAAK,WAAW;AAAA,QACxB;AACA,gBAAQ,MAAM,aAAa;AAC3B,aAAK,QAAQ;AACb,SAAAC,MAAA,KAAK,kBAAL,gBAAAA,IAAA,WAAqB;AACrB,aAAK,cAAc,IAAI;AAAA,MACzB,SAAS,KAAK;AACZ,gBAAQ,MAAM,wBAAwB,GAAG;AACzC,aAAK,QAAQ;AAAA,MACf;AAAA,IACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA2BM,qBAAqB,OAAkB,WAAqC;AAAA;AAChF,UAAI,CAAC,KAAK,QAAQ;AAChB,gBAAQ,IAAI,8BAA8B;AAC1C;AAAA,MACF;AACA,YAAM,2BAA2B,KAAK,iBAAiB,OAAO,SAAS;AACvE,YAAM,uBAAuB,KAAK;AAClC,WAAK,eAAe,KAAK,qBAAqB,0BAA0B,oBAAoB;AAC5F,UAAI;AACF,cAAM,KAAK,yBAAyB,sBAAsB,KAAK,cAAc,SAAS;AAAA,MACxF,SAAS,OAAO;AACd,gBAAQ,MAAM,uCAAuC,KAAK;AAAA,MAC5D;AAAA,IACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAaM,KAAK,YAAwB,iBAA2C;AAAA;AAC5E,YAAM,KAAK,kBAAkB;AAC7B,WAAK,aAAa;AAClB,WAAK,gBAAgB;AAAA,IACvB;AAAA;AAAA,EAEM,oBAAoB;AAAA;AACxB,UAAI,CAAC,KAAK,QAAQ;AAChB,cAAM,EAAE,QAAQ,SAAS,IAAI,KAAK,gCAAgC;AAClE,aAAK,SAAS;AACd,aAAK,WAAW;AAChB,aAAK,gBAAgB,KAAK,wBAAwB;AAClD,cAAM,mBAAmB,KAAK,SAAS,KAAK;AAC5C,4BAAoB,KAAK,MAAM;AAC/B,cAAM;AAAA,MACR;AAAA,IACF;AAAA;AAAA,EAEA,kCAAkC;AAChC,UAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,WAAO,QAAQ;AACf,WAAO,SAAS;AAChB,UAAM,WAAW,SAAS,cAAc,OAAO;AAC/C,aAAS,QAAQ;AACjB,aAAS,SAAS;AAClB,aAAS,QAAQ;AACjB,aAAS,YAAY,OAAO,cAAc;AAC1C,WAAO,EAAE,QAAQ,SAAS;AAAA,EAC5B;AAAA,EAEA,0BAA0B;AACxB,UAAM,gBAAgB,CAAC;AACvB,aAAS,IAAI,GAAG,IAAI,4BAA4B,KAAK;AACnD,YAAM,eAAe,SAAS,cAAc,OAAO;AACnD,mBAAa,WAAW;AACxB,mBAAa,cAAc;AAC3B,oBAAc,KAAK,YAAY;AAAA,IACjC;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,aAAa;AACX,UAAM,QAAQ,MAAO;AACrB,SAAK,aAA0B,wBAAW,MAAM;AAC9C,UAAI,KAAK,UAAU,6BAAsB,KAAK,UAAU,yBAAmB;AACzE;AAAA,MACF;AACA,UAAI,KAAK,UAAU,yBAAmB;AACpC,kCAA0B,KAAK,eAAe,KAAK,MAAM;AAAA,MAC3D;AACA,WAAK,WAAW;AAAA,IAClB,GAAG,KAAK;AAAA,EACV;AAAA,EAEM,aAAa;AAAA;AACjB,UAAI;AACF,YAAI,KAAK,KAAK,GAAG;AACf,eAAK,QAAQ;AAAA,QACf;AACA,YAAI,CAAC,KAAK,UAAU;AAClB;AAAA,QACF;AACA,cAAM,KAAK,SAAS,wBAAwB;AAAA,MAC9C,SAAS,OAAO;AACd,gBAAQ,MAAM,uBAAuB,OAAO,SAAS,KAAK,KAAK;AAC/D,cAAM;AAAA,MACR;AAAA,IACF;AAAA;AAAA,EAEA,UAAU;AACR,aAAS,qBAAqB;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,iBAAiB,OAAkB,WAAqC;AACtE,UAAM,eAAe,oBAAI,IAAY;AACrC,eAAW,QAAQ,OAAO;AACxB,UAAI,aAAa,SAAS,4BAA4B;AACpD;AAAA,MACF,WAAW,KAAK,cAAc,KAAK,UAAU,UAAU,KAAK,UAAU,CAAkB,GAAG;AACzF,qBAAa,IAAI,KAAK,UAAU;AAAA,MAClC;AAAA,IACF;AACA,WAAO,MAAM,KAAK,YAAY;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,qBAAqB,WAAqB,WAAqB;AAC7D,UAAM,kBAAiC,IAAI,MAAM,UAAU,MAAM;AACjE,UAAM,YAA2B,CAAC;AAElC,cAAU,QAAQ,WAAS;AACzB,YAAM,cAAc,UAAU,QAAQ,KAAK;AAC3C,UAAI,gBAAgB,MAAM,cAAc,UAAU,QAAQ;AAExD,wBAAgB,WAAW,IAAI;AAAA,MACjC,OAAO;AACL,kBAAU,KAAK,KAAK;AAAA,MACtB;AAAA,IACF,CAAC;AAED,aAAS,IAAI,GAAG,IAAI,UAAU,QAAQ,KAAK;AACzC,UAAI,CAAC,gBAAgB,CAAC,GAAG;AACvB,cAAM,WAAW,UAAU,MAAM;AACjC,YAAI,UAAU;AACZ,0BAAgB,CAAC,IAAI;AAAA,QACvB;AAAA,MACF;AAAA,IACF;AACA,WAAO,MAAM,KAAK,IAAI,IAAI,eAAe,CAAC;AAAA,EAC5C;AAAA,EAEQ,UAAU,OAAkC;AAClD,WAAO,SAAS,MAAM,WAAW,CAAC,MAAM;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWM,yBACJ,WACA,WACA,YAA6C,MAC7C;AAAA;AAtTJ,UAAAD,KAAAC;AAuTI,YAAM,YAAY,KAAK,IAAI,UAAU,QAAQ,UAAU,MAAM;AAC7D,eAAS,IAAI,GAAG,IAAI,WAAW,KAAK;AAClC,YAAI,UAAU,CAAC,MAAM,UAAU,CAAC,GAAG;AACjC;AAAA,QACF,WAAW,UAAU,CAAC,GAAG;AAGvB,cAAI,CAAC,aAAa,UAAU,UAAU,CAAC,CAAC,GAAG;AACzC,mBAAMD,MAAA,KAAK,eAAL,gBAAAA,IAAiB,YAAY,UAAU,CAAC,GAAG,KAAK,cAAc,CAAC;AAAA,UACvE;AACA,cAAI,KAAK,cAAc,CAAC,GAAG;AAEzB,iBAAK,cAAc,CAAC,EAAE,YAAY;AAAA,UACpC;AAAA,QACF;AACA,YAAI,UAAU,CAAC,GAAG;AAChB,iBAAMC,MAAA,KAAK,eAAL,gBAAAA,IAAiB,YAAY,UAAU,CAAC,GAAG,KAAK,cAAc,CAAC;AAAA,QACvE;AAAA,MACF;AAAA,IACF;AAAA;AACF;AAEO,IAAM,mBAAmB,IAAI,WAAW;;;AE7U/C;AAAA,SAAS,UAAU;AAEZ,IAAM,eAAe;AAAA,EAC1B,QAAQ,oBAAI,IAAI;AAAA,EAChB,WAAW,oBAAI,IAAI;AAAA,EACnB,SAAS,OAAO;AACd,UAAM,KAAK,MAAM,KAAK,MAAM,KAAK,GAAG;AACpC,SAAK,OAAO,IAAI,IAAI,iCAAK,QAAL,EAAY,GAAG,EAAC;AACpC,SAAK,SAAS;AACd,WAAO;AAAA,EACT;AAAA,EAEA,gBAAgB;AACd,SAAK,OAAO,MAAM;AAClB,SAAK,SAAS;AAAA,EAChB;AAAA,EAEA,YAAY,IAAI;AACd,SAAK,OAAO,OAAO,EAAE;AACrB,SAAK,SAAS;AAAA,EAChB;AAAA,EACA,aAAa,IAAI,OAAO;AACtB,QAAI,KAAK,SAAS,EAAE,GAAG;AACrB,WAAK,OAAO,IAAI,IAAI,kCAAK,KAAK,OAAO,IAAI,EAAE,IAAM,MAAO;AACxD,WAAK,SAAS;AACd,aAAO;AAAA,IACT,OAAO;AACL,aAAO,KAAK,SAAS,KAAK;AAAA,IAC5B;AAAA,EACF;AAAA,EACA,YAAY,IAAI;AACd,SAAK,UAAU,IAAI,IAAI,EAAE;AAAA,EAC3B;AAAA,EACA,eAAe,IAAI;AACjB,SAAK,UAAU,OAAO,EAAE;AAAA,EAC1B;AAAA,EACA,SAAS,IAAI;AACX,WAAO,KAAK,OAAO,IAAI,EAAE;AAAA,EAC3B;AAAA,EACA,WAAW;AACT,UAAM,SAAS,MAAM,KAAK,KAAK,OAAO,OAAO,CAAC;AAC9C,SAAK,UAAU,QAAQ,cAAY,SAAS,MAAM,CAAC;AAAA,EACrD;AACF;;;AHpCO,IAAM,qBAAqB,MAAM;AACtC,QAAM,EAAE,QAAQ,IAAI,sBAAsB;AAE1C,QAAM,WAAWE;AAAA,IACf,CAAC,UAAU,MAAM;AACf,iBAAW,MAAM;AACf,yBAAiB,KAAK,EAAE,MAAM,MAAM,QAAQ,MAAM,cAAc,CAAC;AACjE,qBAAa,cAAc;AAC3B;AAAA,MACF,GAAG,OAAO;AAAA,IACZ;AAAA,IACA,CAAC,OAAO;AAAA,EACV;AAEA,SAAO,EAAE,iBAAiB,SAAS;AACrC;;;AFCO,IAAM,kBAAkBC,QAAM,cAAmC;AAAA,EACtE,QAAQ,MAAM;AACZ,YAAQ,IAAI,QAAQ;AAAA,EACtB;AACF,CAAC;AAED,gBAAgB,cAAc;AAEvB,IAAM,wBAAwB,MAAM;AACzC,QAAM,UAAUC,YAAW,eAAe;AAC1C,MAAI,CAAC,SAAS;AACZ,UAAM,MAAM,oFAAoF;AAAA,EAClG;AACA,SAAO;AACT;AAEO,IAAM,qBAAqB,MAAM;AACtC,QAAM,aAAa,cAAc;AACjC,QAAM,oBAAoB,qBAAqB;AAC/C,QAAM,CAAC,aAAa,cAAc,IAAID,QAAM,SAAqC;AACjF,QAAM,YAAYE,aAAYC,gBAAe;AAC7C,QAAM,gBAAgB,oBAAoB,SAAS;AACnD,QAAM,aAAaC,eAAc;AACjC,QAAM,EAAE,qBAAqB,IAAI,yBAAyB;AAC1D,QAAM,EAAE,uBAAuB,IAAI,2BAA2B;AAC9D,QAAM,EAAE,gBAAgB,IAAI,mBAAmB;AAE/C,QAAM,SAAS,MAAM;AACnB;AACA,eAAW,WAAW,SAAS,WAAW,EAAE;AAC5C,mBAAe,yBAAyB,0BAAyB,uBAAsB;AAAA,EACzF;AAEA,EAAAC,WAAU,MAAM;AACd,QAAI,CAAC,YAAY;AACf;AAAA,IACF;AACA,IAAAC,OAAM,CAAC,WAAW,aAAa,CAAC,EAC7B,KAAK,CAACC,cAAa,WAAWC,GAAE,GAAG,GAAG,MAAM,eAAe,uBAAsB,CAAC,EAClF;AAAA,MACC,CAACD,cAAa,eAAeA,cAAa,SAAS;AAAA,MACnD,CAACA,cAAa,eAAeA,cAAa,UAAU;AAAA,MACpD,CAACA,cAAa,eAAeA,cAAa,YAAY;AAAA,MACtD,CAACA,cAAa,cAAcA,cAAa,SAAS;AAAA,MAClD,CAACA,cAAa,cAAcA,cAAa,UAAU;AAAA,MACnD,CAACA,cAAa,cAAcA,cAAa,YAAY;AAAA,MACrD,MAAM;AACJ,uBAAe,eAAa;AAC1B,iBAAOD,OAAM,EAAE,sBAAsB,wBAAwB,UAAU,CAAC,EACrE;AAAA,YACC,CAAC,EAAE,sBAAAG,uBAAsB,WAAAC,WAAU,MAAMD,yBAAwBC,eAAc;AAAA,YAC/E,MAAM;AAAA,UACR,EACC,KAAK,EAAE,wBAAwB,KAAK,GAAG,MAAM,uBAAsB,EACnE,UAAU,MAAM,uBAAsB;AAAA,QAC3C,CAAC;AACD,kBAAU,MAAM;AAChB,wBAAgB,GAAI;AAAA,MACtB;AAAA,IACF,EACC,KAAK,CAACH,cAAa,cAAcC,GAAE,OAAO,GAAG,MAAM;AAClD,qBAAe,yBAAyB,0BAAyB,uBAAsB;AAAA,IACzF,CAAC,EACA,UAAU,MAAM;AAAA,IAEjB,CAAC;AAAA,EACL,GAAG,CAAC,YAAY,WAAW,sBAAsB,wBAAwB,eAAe,eAAe,CAAC;AACxG,SAAO,EAAE,aAAa,OAAO;AAC/B;;;;;;AFjEA,IAAM,YAAYG,QAAM,KAIrB,CAAC,EAAE,6BAA6B,kBAAkB,YAAY,MAAM;AACrE,QAAM,aAAaC,eAAc;AACjC,QAAM,EAAE,UAAU,OAAO,IAAI,sBAAsB;AACnD,QAAM,CAAC,OAAO,QAAQ,IAAIC,UAAS,EAAE,OAAO,IAAI,MAAM,GAAG,CAAC;AAC1D,QAAM,YAAY;AAClB,QAAM,CAAC,gBAAgB,qBAAqB,IAAI,mBAAmB,SAAS,SAAS;AACrF,QAAM,CAAC,aAAa,cAAc,IAAI,kBAA0B,oBAAoB,OAAO;AAC3F,QAAM,cAAcC,QAAuB,IAAI;AAE/C,EAAAC,WAAU,MAAM;AACd,QAAI,WAAW;AACb,4BAAsB,SAAS;AAC/B;AAAA,IACF;AAEA,QAAI,kBAAkB,YAAY,WAAW,qCAAsC;AACjF;AAAA,IACF;AAEA,QAAI,CAAC,UAAU;AACb,cAAQ,MAAM,wBAAwB;AACtC;AAAA,IACF;AAEA,QAAI,qBAAqB,UAAU;AACnC,QAAI,CAAC,oBAAoB;AACvB,2BAAqB,KAAK;AAC1B,qBAAe,kBAAkB;AAAA,IACnC;AAEA,gBAAY,UAAU;AACtB,eACG,uBAAuB,EAAE,UAAU,QAAQ,mBAAmB,GAAG,EAAE,UAAU,4BAA4B,CAAC,EAC1G,KAAK,WAAS,sBAAsB,KAAK,CAAC,EAC1C,MAAM,CAAAC,WAAS,SAAS,aAAaA,MAAK,CAAC,CAAC,EAC5C,QAAQ,MAAM;AACb,kBAAY,UAAU;AAAA,IACxB,CAAC;AAAA,EACL,GAAG;AAAA,IACD;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AAED,MAAI,MAAM,OAAO;AACf,WACE,gBAAAL,QAAA,cAAC,OAAO,MAAP,EAAY,MAAM,QACjB,gBAAAA,QAAA;AAAA,MAAC,OAAO;AAAA,MAAP;AAAA,QACC,KAAK;AAAA,UACH,UAAU;AAAA,UACV,WAAW;AAAA,UACX,GAAG;AAAA,UACH,SAAS;AAAA,UACT,eAAe;AAAA,UACf,YAAY;AAAA,QACd;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,SAAI,KAAK,2BAAY,QAAQ,IAAI,OAAO,IAAI,KAAI,eAAc;AAAA,MAC/D,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,WAAW,UAAU,IAAI,MAAM,IAAI,MAAM,KAChE,MAAM,KACT;AAAA,MACA,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,sBAAsB,WAAW,SAAS,KAAI,MAAM,IAAK;AAAA,IAC3E,CACF;AAAA,EAEJ;AACA,SAAO;AACT,CAAC;AAED,IAAM,eAAe,CAAC,UAAwB;AAC5C,UAAQ,MAAM,WAAW,EAAE,MAAM,CAAC;AAClC,UAAQ;AAAA,IACN;AAAA,IACA;AAAA,EACF;AACA,SAAOM,OAAM,CAAC,MAAM,QAAQ,MAAM,IAAI,CAAC,EACpC,KAAK,CAAC,aAAa,GAAG,GAAG,OAAO;AAAA,IAC/B,OAAO;AAAA,IACP,MAAM;AAAA,EACR,EAAE,EAED,KAAK,CAAC,aAAa,GAAG,GAAG,OAAO;AAAA,IAC/B,OAAO;AAAA,IACP,MAAM;AAAA,EACR,EAAE,EACD,KAAK,CAAC,aAAa,IAAI,GAAG,OAAO;AAAA,IAChC,OAAO;AAAA,IACP,MAAM,8BAA8B,MAAM,WAAW;AAAA,EACvD,EAAE,EACD;AAAA,IAAU,MAAG;AA9HlB,UAAAC;AAgIM;AAAA;AAAA,QAAAD,QAAMC,MAAA,MAAM,aAAN,gBAAAA,IAAgB,MAAM,EACzB,KAAK,KAAK,OAAO;AAAA,UAChB,OAAO;AAAA,UACP,MAAM;AAAA,QACR,EAAE,EACD,KAAK,KAAK,OAAO;AAAA,UAChB,OAAO;AAAA,UACP,MAAM;AAAA,QACR,EAAE,EACD,UAAU,MAAM;AACf,kBAAQ,MAAM,mBAAmB,KAAK;AACtC,iBAAO;AAAA,YACL,OAAO;AAAA,YACP,MAAM;AAAA,UACR;AAAA,QACF,CAAC;AAAA;AAAA;AAAA,EACL;AACJ;AAEA,IAAO,oBAAQ;;;AQnJf;AAAA,OAAOC,YAAS,aAAAC,aAAW,UAAAC,UAAQ,YAAAC,kBAAgB;AAEnD,SAAS,MAAMC,aAAY;AAC3B;AAAA,EACE,gBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;;;ACXP;AAAA,OAAOC,WAAS,aAAAC,mBAAiB;AACjC,SAAS,YAAAC,kBAAgB;AAEzB,SAAS,sBAAsB;;;ACH/B;AAAA,OAAOC,WAAS,YAAAC,WAAU,eAAAC,cAAa,aAAAC,aAAW,YAAAC,kBAAgB;AAClE,SAAS,sBAAsB;AAC/B;AAAA,EACE,cAAAC;AAAA,EACA,gBAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,2BAAAC;AAAA,EACA;AAAA,EACA,mBAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,cAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,sBAAAC;AAAA,OACK;AACP;AAAA,EACE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,aAAAC;AAAA,EACA,gBAAAC;AAAA,EACA,eAAAC;AAAA,EACA;AAAA,EACA,eAAAC;AAAA,OACK;;;AC5BP;AAAA,OAAOC,aAAW;AAClB,SAAS,wBAAwB;;;ACDjC;AAGA,IAAMC,cAAa,OAAO,YAAgB;AAAA,EACxC,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,IAAI;AAAA,EACJ,GAAG;AAAA,EACH,eAAe;AAAA,IACb,SAAS;AAAA,IACT,QAAQ;AAAA,IACR,iBAAiB;AAAA,IACjB,OAAO;AAAA,EACT;AAAA,EACA,UAAU;AAAA,IACR,QAAQ;AAAA,MACN,MAAM;AAAA,QACJ,OAAO;AAAA,QACP,iBAAiB;AAAA,MACnB;AAAA,IACF;AAAA,EACF;AACF,CAAC;AAED,IAAO,qBAAQA;;;ADjBf,IAAM,WAAW;AAAA,EACf,UAAU;AAAA,IACR,MAAM;AAAA,MACJ,IAAI;AAAA,IACN;AAAA,EACF;AAAA,EACA,QAAQ;AAAA,IACN,OAAO;AAAA,MACL,IAAI;AAAA,IACN;AAAA,EACF;AACF;AAEA,IAAM,cAAc,OAAO,oBAAY;AAAA,EACrC,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AAAA,EACH,IAAI;AAAA,EACJ,sBAAsB;AAAA,EACtB,aAAa;AAAA,EACb,yBAAyB;AAAA,EACzB,UAAU;AAAA,EACV,mCAAmC;AAAA,IACjC,QAAQ;AAAA,EACV;AAAA,EACA,OAAO;AAAA,IACL,IAAI;AAAA,IACJ,sBAAsB;AAAA,IACtB,yBAAyB;AAAA,EAC3B;AAAA,EACA,UAAU,iCACL,WADK;AAAA,IAER,aAAa;AAAA,MACX,MAAM;AAAA,QACJ,sBAAsB;AAAA,QACtB,yBAAyB;AAAA,MAC3B;AAAA,IACF;AAAA,EACF;AACF,CAAC;AAED,IAAM,iBAAiB,OAAO,oBAAY;AAAA,EACxC,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AAAA,EACH,qBAAqB;AAAA,EACrB,aAAa;AAAA,EACb,wBAAwB;AAAA,EACxB,iBAAiB;AAAA,EACjB,UAAU;AAAA,EACV,mCAAmC;AAAA,IACjC,QAAQ;AAAA,EACV;AAAA,EACA,OAAO;AAAA,IACL,SAAS;AAAA,EACX;AAAA,EACA;AACF,CAAC;AAED,IAAMC,QAAO,OAAO,MAAM;AAAA,EACxB,YAAY;AAAA,EACZ,gBAAgB;AAAA,EAChB,OAAO;AAAA,EACP,UAAU;AAAA,IACR,UAAU;AAAA,MACR,MAAM;AAAA,QACJ,OAAO;AAAA,MACT;AAAA,IACF;AAAA,IACA,QAAQ;AAAA,MACN,MAAM;AAAA,QACJ,OAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF;AACF,CAAC;AAEM,IAAM,wBAAwB,CAAC;AAAA,EACpC,WAAW;AAAA,EACX,kBAAkB,MAAM;AACtB;AAAA,EACF;AAAA,EACA,SAAS;AAAA,EACT,iBAAiB;AAAA,EACjB;AAAA,EACA;AAAA,EACA;AAAA,EACA,cAAc;AAAA,EACd,UAAU,MAAM;AACd;AAAA,EACF;AACF,MAUM;AACJ,QAAM,cAAc,EAAE,UAAU,OAAO;AACvC,SACE,gBAAAC,QAAA,cAAC,YACC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,eAAa;AAAA,OACT,cAFL;AAAA,MAGC;AAAA,MACA;AAAA,MACA,WAAU;AAAA;AAAA,IAEV,gBAAAA,QAAA,cAAC,WAAQ,UAAU,CAAC,gBAAgB,OAAO,kBACzC,gBAAAA,QAAA,cAACD,OAAA,mBAAS,cAAc,IAAK,CAC/B;AAAA,EACF,GACC,CAAC,eAAe,WACf,gBAAAC,QAAA,cAAC,SAAS,MAAT,MACC,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,SAAO;AAAA,MAEP,eAAe,OAAK;AAClB,YAAI,UAAU;AACZ,YAAE,eAAe;AACjB,0BAAgB;AAAA,QAClB;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,mCAAmB,cAClB,gBAAAA,QAAA,cAAC,WAAQ,OAAM,kBACb,gBAAAA,QAAA,cAACD,OAAA,mBAAS,cACR,gBAAAC,QAAA,cAAC,sBAAiB,CACpB,CACF,CACF;AAAA,EACF,GACA,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,YAAY;AAAA,MACZ,aAAa;AAAA,MACb,OAAM;AAAA,MACN,MAAK;AAAA,MACL,KAAK;AAAA,QACH,GAAG;AAAA,QACH,UAAU;AAAA,QACV,WAAW;AAAA,QACX,GAAG;AAAA,QACH,QAAQ;AAAA,QACR,IAAI;AAAA,MACN;AAAA;AAAA,IAEC;AAAA,EACH,CACF,IACE,IACN;AAEJ;;;AEtKA;AAAA,OAAOC,aAAW;AAKlB,IAAM,iBAAiB,CAACC,QAA2D;AAA3D,MAAAC,MAAAD,KAAE,UAAQ,WAAW,OAAO,UAAU,QAL9D,IAKwBC,KAAkD,kBAAlDA,KAAkD,CAAhD,UAAQ,YAAkB,YAAU;AAC5D,yBAAAC,QAAA;AAAA,IAAC;AAAA,qCACK,QADL;AAAA,MAEC,KAAK;AAAA,QACH,eAAe;AAAA,QACf,YAAY;AAAA,QACZ,GAAG;AAAA,QACH,UAAU;AAAA,QACV,IAAI,SAAS,oBAAoB;AAAA,QACjC,OAAO,WAAW,oBAAoB;AAAA,QACtC,KAAK;AAAA,QACL,GAAG;AAAA,QACH,WAAW;AAAA,UACT,IAAI;AAAA,QACN;AAAA,MACF;AAAA,MACA,SAAS,MAAM;AACb,YAAI,CAAC,UAAU;AACb,kBAAQ;AAAA,QACV;AAAA,MACF;AAAA;AAAA,IAEC;AAAA,EACH;AAAA;AAGF,IAAM,kBAAkB,OAAO,MAAM;AAAA,EACnC,UAAU;AAAA,EACV,KAAK;AAAA,EACL,OAAO;AAAA,EACP,YAAY;AAAA,EACZ,OAAO;AAAA,EACP,GAAG;AAAA,EACH,UAAU;AAAA,EACV,WAAW;AAAA,EACX,WAAW;AAAA,EACX,IAAI;AAAA,EACJ,GAAG;AAAA,EACH,eAAe;AAAA,EACf,UAAU;AAAA,EACV,YAAY;AACd,CAAC;AAED,IAAM,kBAAkB,OAAO,MAAM;AAAA,EACnC,YAAY;AAAA,EACZ,OAAO;AAAA,EACP,WAAW;AAAA,EACX,UAAU;AACZ,CAAC;AAEM,IAAM,aAAa;AAAA,EACxB,MAAM;AAAA,EACN,OAAO;AAAA,EACP,OAAO;AACT;;;AC3DA;AAAA,OAAOC,WAAS,eAAAC,cAAa,aAAAC,aAAW,YAAAC,iBAAgB;AACxD,SAAS,YAAAC,iBAAgB;AACzB,SAAS,iBAAiB,aAAAC,YAAW,cAAc,mBAAmB,oBAAoB;;;ACF1F;;;ACAA;AAAA,OAAOC,aAAW;AAClB,YAAYC,sBAAqB;AAMjC,IAAM,YAAY,OAAuB,uBAAM;AAAA,EAC7C,WAAW;AAAA,EACX,UAAU;AACZ,CAAC;AACD,IAAM,eAAe,OAAuB,0BAAS;AAAA,EACnD,YAAY;AAAA;AACd,CAAC;AAED,IAAM,gBAAgB,OAAO,OAAO,SAAS;AAAA,EAC3C,KAAK;AAAA,EACL,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,MAAM;AAAA,EAEN,wBAAwB;AAAA,IACtB,WAAW,GAAG,WAAW;AAAA,EAC3B;AAAA,EAEA,0BAA0B;AAAA,IACxB,WAAW,GAAG,YAAY;AAAA,EAC5B;AACF,CAAC;AAED,IAAMC,iBAAgB,OAAuB,0BAAS;AAAA,EACpD,OAAO;AAAA,EACP,iBAAiB;AAAA,EACjB,qBAAqB;AAAA,EACrB,sBAAsB;AAAA,EACtB,WAAW;AAAA,EACX,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,KAAK;AAAA,EACL,OAAO;AAAA,EACP,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,WAAW;AAAA;AAAA;AAAA,EAIX,YAAY;AAAA,EAEZ,WAAW;AAAA,IACT,SAAS;AAAA,EACX;AAAA,EACA,gBAAgB;AAAA,IACd,wBAAwB;AAAA,MACtB,WAAW,GAAG,YAAY;AAAA,IAC5B;AAAA,IAEA,0BAA0B;AAAA,MACxB,WAAW,GAAG,aAAa;AAAA,IAC7B;AAAA,EACF;AAAA,EACA,OAAO;AAAA,IACL,UAAU;AAAA,IACV,QAAQ;AAAA,EACV;AAAA,EAEA,UAAU;AAAA,IACR,MAAM;AAAA,MACJ,KAAK;AAAA,QACH,kBAAkB;AAAA,QAClB,QAAQ;AAAA,MACV;AAAA,MACA,OAAO;AAAA,QACL,kBAAkB;AAAA,QAClB,OAAO;AAAA,MACT;AAAA,MACA,QAAQ;AAAA,QACN,kBAAkB;AAAA,QAClB,QAAQ;AAAA,QACR,KAAK;AAAA,MACP;AAAA,MACA,MAAM;AAAA,QACJ,kBAAkB;AAAA,QAClB,MAAM;AAAA,MACR;AAAA,IACF;AAAA,EACF;AAAA,EAEA,iBAAiB;AAAA,IACf,MAAM;AAAA,EACR;AACF,CAAC;AAMD,IAAM,eAAeC,QAAM;AAAA,EACzB,CAACC,KAAmC,iBAAc;AAAjD,QAAAC,MAAAD,KAAE,YAAU,UAjGf,IAiGGC,KAA0B,kBAA1BA,KAA0B,CAAxB,YAAU;AACX,2BAAAF,QAAA,cAAC,OAAO,QAAP,EAAc,aACb,gBAAAA,QAAA,cAAC,mBAAc,GACf,gBAAAA,QAAA,cAACD,gBAAA,iCAAkB,QAAlB,EAAyB,KAAK,iBAC5B,QACH,CACF;AAAA;AAEJ;AACA,IAAM,aAAa,OAAO;AAC1B,IAAM,aAAa,OAAuB,wBAAO;AAAA,EAC/C,QAAQ;AACV,CAAC;AACD,IAAM,mBAAmB,OAAO;AAChC,IAAM,wBAAwB,OAAO;AAE9B,IAAM,QAAQ;AAAA,EACnB,MAAM;AAAA,EACN,SAAS;AAAA,EACT,SAAS;AAAA,EACT,aAAa;AAAA,EACb,OAAO;AAAA,EACP,OAAO;AAAA,EACP,cAAc;AAChB;;;ACzHA;AAAA,OAAOI,WAAS,YAAAC,WAAU,aAAAC,aAAW,UAAAC,UAAQ,YAAAC,iBAAgB;AAC7D,SAAS,YAAAC,iBAAgB;AACzB;AAAA,EACE;AAAA,EACA,6BAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,WAAW,aAAa,mBAAmB;;;ACXpD;AAAA,OAAOC,aAAW;AAClB,SAAS,mBAAAC,kBAAiB,iBAAAC,sBAAqB;AAG/C,IAAM,wBAAwBC,QAAM,WAAW,CAAC,EAAE,OAAO,KAAAC,MAAK,MAAM,MAAM,WAAW,CAAC,EAAE,GAAG,QAAQ;AACjG,SACE,gBAAAD,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,SAAO;AAAA,MACP,eAAa,GAAG,KAAK;AAAA,MACrB,KAAK;AAAA,QACH,QAAQ;AAAA,QACR,IAAI;AAAA,QACJ,GAAG;AAAA,QACH,GAAG;AAAA,QACH,QAAQ;AAAA,SACLC;AAAA,MAEL;AAAA;AAAA,IAEA,gBAAAD,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,OAAO;AAAA,UACP,GAAG;AAAA,QACL;AAAA;AAAA,MAEC;AAAA,MACD,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK;AAAA,YACH,OAAO;AAAA,aACJ,aAAa,KAAK,IAFlB;AAAA,YAGH,MAAM;AAAA,YACN,IAAI,OAAO,OAAO;AAAA,cACf;AAAA;AAAA,QAGJ;AAAA,MACH;AAAA,MACC,OAAO,gBAAAA,QAAA,cAACE,gBAAA,IAAc,IAAK,gBAAAF,QAAA,cAACG,kBAAA,IAAgB;AAAA,IAC/C;AAAA,EACF;AAEJ,CAAC;;;AC3CD;AAAA,SAAS,aAAAC,YAAW,UAAAC,SAAQ,YAAAC,iBAAgB;AAErC,IAAM,qBAAqB,CAAC,EAAE,SAAS,MAA4B;AACxE,QAAM,WAAWD,QAAgC,IAAI;AACrD,QAAM,CAAC,SAAS,UAAU,IAAIC,UAAS,KAAK;AAC5C,EAAAF,WAAU,MAAM;AACd,QAAI,SAAS,WAAW,UAAU;AAChC,UAAI;AAEF,YAAI,OAAO,SAAS,QAAQ,cAAc,aAAa;AAErD,mBAAS,QAAQ,UAAU,QAAQ;AAAA,QACrC;AAAA,MACF,SAAS,OAAO;AACd,gBAAQ,IAAI,KAAK;AAAA,MACnB;AAAA,IACF;AAAA,EACF,GAAG,CAAC,QAAQ,CAAC;AACb,SAAO,EAAE,SAAS,YAAY,SAAS;AACzC;;;ACnBA;AAAO,IAAM,uBAAuB,MAAM;AACxC,SAAO;AACT;;;AHwBA,IAAM,WAAW,CAAC,EAAE,QAAQ,MAAM;AA1BlC,MAAAG;AA2BE,QAAM,EAAE,YAAY,mBAAmB,aAAa,IAAI,WAAW;AACnE,QAAM,EAAE,YAAY,YAAY,YAAY,IAAI;AAChD,QAAM,eAAeC,aAAY,uBAAuB;AACxD,QAAM,YAAYA,aAAYC,0BAAyB;AAGvD,QAAM,wBAAwB,eAAe,iBAAiB;AAC9D,QAAM,mBAAmB,cAAc,YAAY,gBAAgB;AACnE,QAAM,gBAAgB,qBAAqB,YAAY;AACvD,QAAM,aAAaC,eAAc;AACjC,QAAM,QAAQF,aAAY,aAAa;AACvC,QAAM,WAAWG,UAAS,OAAU,MAAM,EAAE;AAE5C,EAAAC,YAAU,MAAM;AACd,QAAI,UAAU;AACZ,iBAAW,eAAe;AAAA,IAC5B;AAAA,EACF,GAAG,CAAC,YAAY,QAAQ,CAAC;AAKzB,QAAM,uBAAsBL,MAAA,2CAAa,OAAO,UAAQ,CAAC,CAAC,KAAK,WAAnC,OAAAA,MAA6C,CAAC;AAE1E,MAAI,EAAC,yCAAY,WAAU,EAAC,yCAAY,WAAU,EAAC,2DAAqB,SAAQ;AAC9E,YAAQ,IAAI;AAAA,EACd;AAEA,SACE,gBAAAM,QAAA,cAAC,OAAI,WAAW,gBAAgB,MAC7B,yCAAY,UACX,gBAAAA,QAAA,cAACC,WAAA,MACE,aACC,gBAAAD,QAAA;AAAA,IAAC,gBAAgB;AAAA,IAAhB;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,IAAI;AAAA,QACJ,QAAQ;AAAA,QACR,IAAI;AAAA,QACJ,GAAG;AAAA,MACL;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,SAAM,SAAS,cAAc,SAAQ,+BAAO,gBAAe,iBAAiB,kBAAkB;AAAA,EACjG,GAEF,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAS;AAAA,MACT,MAAM,gBAAAA,QAAA,cAAC,iBAAY;AAAA,MACnB,WAAW,kBAAkB;AAAA,MAC7B,UAAU,cACR,aAAa;AAAA,QACX;AAAA,QACA,YAAY,WAAW;AAAA,MACzB,CAAC;AAAA;AAAA,EAEL,CACF,IACE,OAEH,yCAAY,UACX,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO,wBAAwB,eAAe;AAAA,MAC9C,MAAM,gBAAAA,QAAA,cAAC,eAAU;AAAA,MACjB,SAAS;AAAA,MACT,WAAW,kBAAkB;AAAA,MAC7B,UAAU,cACR,aAAa;AAAA,QACX;AAAA,QACA,YAAY,WAAW;AAAA,MACzB,CAAC;AAAA;AAAA,EAEL,IACE,OAEH,2DAAqB,WAAU,wBAC9B,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,MAAM,gBAAAA,QAAA,cAAC,iBAAY;AAAA,MACnB,SAAS;AAAA,MACT,WAAW,kBAAkB;AAAA,MAC7B,UAAU,cACR,aAAa;AAAA,QACX;AAAA,QACA,YAAY,WAAW;AAAA,MACzB,CAAC;AAAA;AAAA,IAGH,gBAAAA,QAAA,cAAC,aAAU,IAAI,kBAAkB,aAAa;AAAA,EAChD,IACE,IACN;AAEJ;AAEA,IAAM,iBAAiB,CAAC,EAAE,OAAO,SAAS,WAAW,UAAU,MAAM,WAAW,KAAK,MAAM;AA1H3F,MAAAN,KAAAQ;AA2HE,QAAM,CAAC,MAAM,OAAO,IAAIC,UAAS,KAAK;AACtC,QAAM,cAAc,qBAAqB;AACzC,QAAM,MAAMC,SAAO,IAAI;AAEvB,SACE,gBAAAJ,QAAA,cAAC,OAAI,KAAK,EAAE,IAAI,MAAM,KACpB,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,IAAI,KAAK,KAAI,KAAM,GAChC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,KAAK;AAAA,QACL,OAAO;AAAA,UACL,eAAe,WAAW,WAAW;AAAA,UACrC,YAAY,WAAW,UAAU;AAAA,QACnC;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,UAAU;AAAA,UACV,MAAM;AAAA,UACN,UAAU;AAAA,UACV,GAAG;AAAA,UACH,UAAU;AAAA,UACV,OAAO;AAAA,YACL,IAAI,WAAW,OAAO;AAAA,UACxB;AAAA,QACF;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,MAAY,cAAc,WACvC,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC;AAAA,UACA;AAAA,UACA,SAAON,MAAA,QAAQ,KAAK,CAAC,EAAE,SAAS,MAAM,aAAa,SAAS,MAArD,gBAAAA,IAAwD,UAAS;AAAA,UACxE;AAAA;AAAA,MACF,GACA,gBAAAM,QAAA,cAAC,SAAS,QAAT,MACC,gBAAAA,QAAA,cAAC,SAAS,SAAT,EAAiB,OAAM,SAAQ,YAAY,GAAG,KAAK,EAAE,IAAGE,MAAA,IAAI,YAAJ,gBAAAA,IAAa,aAAa,QAAQ,KAAK,KAC7F,QAAQ,IAAI,YAAU;AACrB,eACE,gBAAAF,QAAA;AAAA,UAAC,SAAS;AAAA,UAAT;AAAA,YACC,KAAK,OAAO;AAAA,YACZ,UAAU,MAAM,SAAS,OAAO,QAAQ;AAAA,YACxC,KAAK;AAAA,cACH,IAAI;AAAA,cACJ,IAAI,OAAO,aAAa,YAAY,cAAc;AAAA,YACpD;AAAA;AAAA,UAEC,OAAO;AAAA,QACV;AAAA,MAEJ,CAAC,CACH,CACF,CACF;AAAA,IACF;AAAA,IACC;AAAA,EACH,CACF;AAEJ;AAEA,IAAM,YAAY,CAAC,EAAE,GAAG,MAAM;AAC5B,QAAM,EAAE,SAAS,YAAY,SAAS,IAAI,mBAAmB,EAAE,UAAU,GAAG,CAAC;AAC7E,SACE,gBAAAA,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,YAAY;AAAA,QACZ,GAAG;AAAA,QACH,OAAO;AAAA,UACL,GAAG;AAAA,QACL;AAAA,MACF;AAAA,MACA,SAAS,MAAG;AAtMpB,YAAAN;AAsMuB,gBAAAA,MAAA,SAAS,YAAT,gBAAAA,IAAkB;AAAA;AAAA,MACjC,UAAU;AAAA;AAAA,IAEV,gBAAAM,QAAA,cAAC,iBAAY;AAAA,IAAE;AAAA,IACJ;AAAA,IACX,gBAAAA,QAAA,cAAC,QAAK,IAAG,QAAO,KAAK,EAAE,SAAS,QAAQ,OAAO,EAAE,SAAS,SAAS,EAAE,KAAG,cAExE;AAAA,EACF,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,MACL,KAAK;AAAA,MACL,SAAS,MAAM,WAAW,KAAK;AAAA,MAC/B,QAAQ,MAAM,WAAW,IAAI;AAAA,MAC7B,KAAK,EAAE,SAAS,OAAO;AAAA;AAAA,EACzB,CACF;AAEJ;AAEA,IAAO,yBAAQ;;;AI1Nf;AAAA,OAAOK,aAAW;AAClB,SAAS,kBAAkB,UAAU,eAAe,wBAAwB;AAQ5E,IAAM,mBAAmB,CAAC;AAAA,EACxB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAKM;AACJ,QAAM,CAAC,EAAE,0BAA0B,IAAI,8BAA8B,IAAI;AACzE,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,IAAI;AAAA,MACJ;AAAA,MACA;AAAA,MACA,UAAU,WAAS;AACjB,mCAA2B,KAAK;AAAA,MAClC;AAAA;AAAA,EACF;AAEJ;AAEO,IAAM,uBAAuB,MAAM;AACxC,QAAM,0BAA0B,2BAA2B;AAE3D,SACE,gBAAAA,QAAA,cAAC,OAAI,WAAW,gBAAgB,KAC9B,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,MAAM,yBAAyB;AAAA,MAC/B,MAAM,gBAAAA,QAAA,cAAC,mBAAc;AAAA,MACrB,SAAS,wBAAwB;AAAA;AAAA,EACnC,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,MAAM,yBAAyB;AAAA,MAC/B,MAAM,gBAAAA,QAAA,cAAC,sBAAiB;AAAA,MACxB,SAAS,wBAAwB;AAAA;AAAA,EACnC,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,MAAM,yBAAyB;AAAA,MAC/B,MAAM,gBAAAA,QAAA,cAAC,cAAS;AAAA,MAChB,SAAS,wBAAwB;AAAA;AAAA,EACnC,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,MAAM,yBAAyB;AAAA,MAC/B,MAAM,gBAAAA,QAAA,cAAC,sBAAiB;AAAA,MACxB,SAAS,wBAAwB;AAAA;AAAA,EACnC,CACF;AAEJ;;;APjDA,IAAM,eAAe;AAAA,EACnB;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,MAAM;AAAA,IACN,SAAS;AAAA,EACX;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,MAAM;AAAA,IACN,SAAS;AAAA,EACX;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,MAAM;AAAA,IACN,SAAS;AAAA,EACX;AACF;AAEA,IAAM,gBAAgB,CAAC,EAAE,MAAM,cAAc,YAAY,WAAW,gBAAAC,QAAA,cAAAA,QAAA,cAAE,EAAI,MAAM;AAC9E,QAAM,eAAe,OAAU,MAAM;AACrC,QAAM,WAAWC,UAAS,YAAY;AAEtC,QAAM,CAAC,aAAa,cAAc,IAAIC;AAAA,IAAS,MAC7C,aAAa,OAAO,CAAC,KAAK,EAAE,QAAQ,MAAO,iCAAK,MAAL,EAAU,CAAC,OAAO,GAAG,KAAK,IAAI,CAAC,CAAC;AAAA,EAC7E;AAEA,QAAM,uBAAuBC;AAAA,IAC3B,SAAO,UAAQ,eAAe,UAAS,iCAAK,OAAL,EAAW,CAAC,GAAG,GAAG,CAAC,KAAK,EAAE;AAAA,IACjE,CAAC,cAAc;AAAA,EACjB;AAEA,EAAAC,YAAU,MAAM;AACd,QAAI,eAAe,sBAAsB;AACvC,2BAAqB,QAAQ,EAAE,IAAI;AAAA,IACrC;AAAA,EACF,GAAG,CAAC,YAAY,oBAAoB,CAAC;AAErC,QAAM,CAAC,WAAW,YAAY,IAAIF,UAAS,MAAG;AAxDhD,QAAAG;AAwDmD,YAAAA,MAAA,OAAO,KAAK,WAAW,EAAE,KAAK,SAAO,YAAY,GAAG,CAAC,MAArD,OAAAA,MAA0D;AAAA,GAAE;AAC7G,QAAM,iBAAiBF,aAAY,MAAM;AACvC,iBAAa,EAAE;AAAA,EACjB,GAAG,CAAC,CAAC;AAEL,EAAAC,YAAU,MAAM;AA7DlB,QAAAC;AA8DI,QAAI,UAAU;AACZ,mBAAa,EAAE;AAAA,IACjB,OAAO;AACL,YAAM,yBAAwBA,MAAA,OAAO,KAAK,WAAW,EAAE,KAAK,SAAO,YAAY,GAAG,CAAC,MAArD,OAAAA,MAA0D;AACxF,mBAAa,qBAAqB;AAAA,IACpC;AAAA,EACF,GAAG,CAAC,UAAU,WAAW,CAAC;AAE1B,SAAO,WACL,gBAAAL,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA;AAAA,IAEC;AAAA,EACH,IAEA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA;AAAA,IAEC;AAAA,EACH;AAEJ;AAEA,IAAM,qBAAqB,CAAC;AAAA,EAC1B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,WAAW,gBAAAA,QAAA,cAAAA,QAAA,cAAE;AACf,MAAM;AACJ,SACE,gBAAAA,QAAA,cAAC,MAAM,MAAN,EAAW,MAAY,gBACtB,gBAAAA,QAAA,cAAC,MAAM,SAAN,EAAc,SAAO,QAAE,QAAS,GACjC,gBAAAA,QAAA;AAAA,IAAC,MAAM;AAAA,IAAN;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,WAAW;AAAA,MACb;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,MAAM,OAAN,EAAY,KAAK,EAAE,IAAI,OAAO,IAAI,MAAM,YAAY,SAAS,KAC5D,gBAAAA,QAAA,cAAC,QAAK,WAAU,OAAM,SAAQ,WAAU,KAAK,EAAE,GAAG,OAAO,KACtD,CAAC,YACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,SAAS,OAAO,KAAG,UAE7C,IAEA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,SAAS,OAAO,KACxC,gBAAAA,QAAA,cAAC,OAAI,IAAG,QAAO,KAAK,EAAE,GAAG,UAAU,IAAI,KAAK,GAAG,SAAS,kBACtD,gBAAAA,QAAA,cAAC,qBAAgB,CACnB,IACC,uCAAW,OAAO,GAAG,iBAAgB,UAAU,MAAM,CAAC,CACzD,GAEF,gBAAAA,QAAA,cAAC,MAAM,OAAN,MACC,gBAAAA,QAAA,cAAC,cAAW,IAAG,OAAM,eAAY,uBAC/B,gBAAAA,QAAA,cAACM,YAAA,IAAU,CACb,CACF,CACF,CACF;AAAA,IACA,gBAAAN,QAAA,cAAC,uBAAkB;AAAA,IAClB,CAAC,YACA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,WAAU;AAAA,QACV,KAAK;AAAA,UACH,IAAI;AAAA,UACJ,IAAI;AAAA,UACJ,WAAW;AAAA,QACb;AAAA;AAAA,MAEC,aACE,OAAO,CAAC,EAAE,QAAQ,MAAM,YAAY,OAAO,CAAC,EAC5C,IAAI,CAAC,EAAE,MAAMO,OAAM,SAAS,MAAM,MAAM;AACvC,eACE,gBAAAP,QAAA;AAAA,UAAC;AAAA;AAAA,YACC,KAAK;AAAA,YACL,OAAO;AAAA,YACP,SAAS,MAAM;AACb,2BAAa,OAAO;AAAA,YACtB;AAAA,YACA,IAAG;AAAA,YACH,KAAK;AAAA,cACH,KAAK;AAAA,cACL,YAAY;AAAA,cACZ,IAAI;AAAA,cACJ,SAAS;AAAA,cACT,YAAY;AAAA,cACZ,UAAU;AAAA,cACV,YAAY;AAAA,cACZ,OAAO;AAAA,cACP,YAAY;AAAA,cACZ,KAAK;AAAA,cACL,QAAQ;AAAA,cACR,WAAW;AAAA,gBACT,IAAI;AAAA,gBACJ,GAAG;AAAA,gBACH,KAAK;AAAA,gBACL,QAAQ;AAAA,cACV;AAAA,cACA,cAAc;AAAA,YAChB;AAAA;AAAA,UAEA,gBAAAA,QAAA,cAACO,OAAA,IAAK;AAAA,UACL;AAAA,QACH;AAAA,MAEJ,CAAC;AAAA,IACL,IAEA,gBAAAP,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,WAAU;AAAA,QACV,KAAK,EAAE,WAAW,UAAU,IAAI,MAAM,IAAI,OAAO,WAAW,QAAQ,WAAW,SAAS;AAAA;AAAA,MAEvF,aACE,OAAO,CAAC,EAAE,QAAQ,MAAM,YAAY,OAAO,KAAK,cAAc,OAAO,EACrE,IAAI,CAAC,EAAE,SAASQ,WAAS,OAAO,QAAQ,MAAM;AAC7C,eAAO,gBAAAR,QAAA,cAACQ,WAAA,EAAQ,KAAK,OAAO,SAAS,qBAAqB,OAAO,GAAG;AAAA,MACtE,CAAC;AAAA,IACL;AAAA,EAEJ,CACF;AAEJ;AACA,IAAM,sBAAsB,CAAC;AAAA,EAC3B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,WAAW,gBAAAR,QAAA,cAAAA,QAAA,cAAE;AACf,MAAM;AACJ,SACE,gBAAAA,QAAA,cAAC,OAAO,MAAP,EAAY,MAAY,gBACvB,gBAAAA,QAAA,cAAC,OAAO,SAAP,EAAe,SAAO,QAAE,QAAS,GAClC,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA;AAAA,IAAC,OAAO;AAAA,IAAP;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,QAAQ;AAAA,QACR,GAAG;AAAA,QACH,GAAG;AAAA,MACL;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC,KAAK;AAAA,MAAL;AAAA,QACC,OAAO;AAAA,QACP,gBAAe;AAAA,QACf,eAAe;AAAA,QACf,KAAK,EAAE,MAAM,QAAQ,UAAU,WAAW;AAAA;AAAA,MAE1C,gBAAAA,QAAA;AAAA,QAAC,KAAK;AAAA,QAAL;AAAA,UACC,KAAK;AAAA,YACH,GAAG;AAAA,YACH,eAAe;AAAA,YACf,IAAI;AAAA,YACJ,GAAG;AAAA,YACH,qBAAqB;AAAA,YACrB,wBAAwB;AAAA,UAC1B;AAAA;AAAA,QAEA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAK,WAAS;AAAA,QAC5B,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,IAAI,GAAG,WAAW,QAAQ,IAAI,MAAM,KACjE,aACE,OAAO,CAAC,EAAE,QAAQ,MAAM,YAAY,OAAO,CAAC,EAC5C,IAAI,CAAC,EAAE,MAAMO,OAAM,SAAS,MAAM,MAAM;AACvC,iBACE,gBAAAP,QAAA,cAAC,KAAK,SAAL,EAAa,KAAK,SAAS,OAAO,SAAS,KAAK,EAAE,KAAK,KAAK,KAC3D,gBAAAA,QAAA,cAACO,OAAA,IAAK,GACL,KACH;AAAA,QAEJ,CAAC,CACL;AAAA,MACF;AAAA,MACC,aACC,gBAAAP,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,WAAU;AAAA,UACV,KAAK;AAAA,YACH,MAAM;AAAA,YACN,UAAU;AAAA,YACV,IAAI;AAAA,UACN;AAAA;AAAA,QAEC,aACE,OAAO,CAAC,EAAE,QAAQ,MAAM,YAAY,OAAO,CAAC,EAC5C,IAAI,CAAC,EAAE,SAASQ,WAAS,OAAO,QAAQ,MAAM;AAC7C,iBACE,gBAAAR,QAAA,cAAC,KAAK,SAAL,EAAa,KAAK,SAAS,OAAO,SAAS,WAAW,eAAe,KACpE,gBAAAA,QAAA,cAAC,yBAAsB,QAAQ,gBAAgB,UAAU,SACtD,KACH,GACA,gBAAAA,QAAA,cAACQ,WAAA,EAAQ,SAAS,qBAAqB,OAAO,GAAG,CACnD;AAAA,QAEJ,CAAC;AAAA,MACL;AAAA,IAEJ;AAAA,IACA,gBAAAR,QAAA,cAAC,OAAO,OAAP,EAAa,KAAK,EAAE,UAAU,YAAY,OAAO,OAAO,KAAK,MAAM,KAClE,gBAAAA,QAAA,cAAC,cAAW,IAAG,OAAM,eAAY,uBAC/B,gBAAAA,QAAA,cAACM,YAAA,IAAU,CACb,CACF;AAAA,EACF,CACF,CACF;AAEJ;AACA,IAAM,wBAAwB,CAAC,EAAE,UAAU,UAAU,OAAO,MAAM;AAChE,SACE,gBAAAN,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,OAAO,SAAS,QAAQ,YAAY,SAAS,KACxE,YACC,gBAAAA,QAAA,cAAC,OAAI,IAAG,QAAO,KAAK,EAAE,IAAI,mBAAmB,IAAI,MAAM,GAAG,UAAU,GAAG,KAAK,GAAG,SAAS,UACtF,gBAAAA,QAAA,cAAC,qBAAgB,CACnB,GAED,QACH;AAEJ;AAEA,IAAO,wBAAQ;;;AJ5Pf,IAAM,cAAc,IAAI,eAAe;AAGhC,IAAM,UAAU,CAAC;AAAA,EACtB;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,SACE,gBAAAS,QAAA,cAAAA,QAAA,gBACG,mCAAS,IAAI,YACZ,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,KAAK,OAAO;AAAA,MACZ,KAAK;AAAA,QACH,iBAAiB;AAAA,QACjB,GAAG;AAAA,QACH,GAAG;AAAA,QACH,UAAU;AAAA,QACV,gBAAgB;AAAA,QAChB,OAAO,qBAAqB,OAAO,WAAW,oBAAoB;AAAA,MACpE;AAAA,MACA,SAAS,MAAM;AACb,gBAAQ,OAAO,QAAQ;AAAA,MACzB;AAAA;AAAA,IAEC,OAAO;AAAA,IACP,qBAAqB,OAAO,WAAW,gBAAAA,QAAA,cAAC,aAAU,OAAO,IAAI,QAAQ,IAAI,IAAK;AAAA,EACjF,EAEJ;AAEJ;AAEA,IAAM,cAAc,CAAC,EAAE,UAAU,KAAK,MAA4D;AAChG,SACE,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,OAAO;AAAA,QACP,IAAI;AAAA,QACJ,UAAU;AAAA,QACV,KAAK;AAAA,QACL,YAAY;AAAA,MACd;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,YAAY,UAAU,gBAAgB,UAAU,SAAS,EAAE,MAAM,KAAK,EAAE,KAAI,IAAK;AAAA,IAAO;AAAA,IAAE;AAAA,EACzG;AAEJ;AAEA,IAAM,iCAAiC,MAAM;AAxG7C,MAAAC;AAyGE,QAAM,UAAUC,eAAc;AAC9B,QAAM,CAAC,YAAY,aAAa,IAAIC,WAAS,KAAK;AAClD,QAAM,CAAC,EAAE,2BAA2B,IAAI,wBAAwB;AAChE,QAAM,oBAAmBF,MAAAG,aAAY,UAAU,MAAtB,gBAAAH,IAAyB;AAClD,QAAM,iCAAiCI;AAAA,IACrC,CAAO,YAAqB;AAC1B,UAAI,CAAC,oBAAoB,YAAY;AACnC;AAAA,MACF;AACA,UAAI,CAAC,YAAY,aAAa,EAAE,aAAa;AAC3C,cAAM,MAAM,+BAA+B;AAAA,MAC7C;AACA,oBAAc,IAAI;AAClB,UAAI,SAAS;AACX,cAAM,QAAQ,sBAAsB,WAAW;AAAA,MACjD,OAAO;AACL,cAAM,QAAQ,2BAA2B,WAAW;AAAA,MACtD;AACA,kCAA4B,OAAO;AACnC,oBAAc,KAAK;AAAA,IACrB;AAAA,IACA,CAAC,SAAS,YAAY,kBAAkB,2BAA2B;AAAA,EACrE;AACA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,EACF;AACF;AAEO,IAAM,oBAAoB,CAAC;AAAA,EAChC;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,wBAAwBD,aAAY,uBAAuB;AACjE,QAAM,6BAA6B,8BAA8B;AACjE,QAAM,EAAE,gCAAgC,WAAW,IAAI,+BAA+B;AACtF,QAAM,OAAOA,aAAY,UAAU;AACnC,QAAM,qBAAqBA,aAAY,gCAAgC,YAAY,QAAQ,CAAC,CAAC;AAE7F,MAAI,CAAC,YAAY,YAAY,KAAK,CAAC,KAAK,8BAA8B,CAAC,uBAAuB;AAC5F,WAAO;AAAA,EACT;AAEA,MAAI,YAAY;AACd,WACE,gBAAAJ,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,QAAQ,8BAA8B;AAAA,QACtC,SAAS;AAAA,QACT,SAAS,MAAY;AACnB,gBAAM,+BAA+B,CAAC,0BAA0B;AAChE,qEAAsB;AAAA,QACxB;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,oBAAe;AAAA,MAChB,gBAAAA,QAAA,cAAC,WAAW,OAAX,MAAkB,6BAA6B,kBAAkB,cAAe;AAAA,IACnF;AAAA,EAEJ;AAEA,MAAI,UAAU;AACZ,WACE,gBAAAA,QAAA,cAAC,WAAQ,OAAO,6BAA6B,kBAAkB,kBAC7D,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS,MAAY;AACnB,gBAAM,+BAA+B,CAAC,0BAA0B;AAAA,QAClE;AAAA,QACA,UAAU;AAAA,QACV,KAAK;AAAA,UACH,IAAI,8BAA8B,qBAAqB,sBAAsB;AAAA,UAC7E,aAAa,8BAA8B,qBAAqB,qBAAqB;AAAA,QACvF;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,oBAAe;AAAA,IAClB,CACF;AAAA,EAEJ;AACA,SACE,gBAAAA,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,SAAS,eAAT,EAAuB,KAAK,EAAE,IAAI,EAAE,GAAG,GACxC,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,UAAU;AAAA,QACV,gBAAgB;AAAA,MAClB;AAAA,MACA,SAAS,CAAM,MAAK;AAClB,UAAE,eAAe;AACjB,cAAM,+BAA+B,CAAC,0BAA0B;AAAA,MAClE;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,SAAS,QAAQ,YAAY,UAAU,KAAK,MAAM,UAAU,OAAO,SAAS,EAAE,MAAM,KAAK,EAAE,KACtG,gBAAAA,QAAA,cAAC,oBAAe,GAAE,cAEpB;AAAA,IACA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,IAAG;AAAA,QACH,SAAS,8BAA8B;AAAA,QACvC,UAAU;AAAA,QACV,SAAS,OAAK,EAAE,gBAAgB;AAAA,QAChC,iBAAiB,CAAM,UAAS;AAC9B,gBAAM,+BAA+B,KAAK;AAAA,QAC5C;AAAA;AAAA,IACF;AAAA,EACF,GACA,gBAAAA,QAAA,cAAC,SAAS,eAAT,EAAuB,KAAK,EAAE,IAAI,EAAE,GAAG,CAC1C;AAEJ;AAEA,IAAM,mBAAmB,CAAC,EAAE,SAAS,MAA4B;AAC/D,QAAM,EAAE,SAAS,YAAY,SAAS,IAAI,mBAAmB,EAAE,SAAS,CAAC;AACzE,SACE,gBAAAA,QAAA,cAAC,eAAY,MAAM,gBAAAA,QAAA,cAACM,cAAA,IAAY,KAC9B,gBAAAN,QAAA,cAAC,OAAI,KAAK,EAAE,MAAM,QAAQ,KAAG,UAAQ,GACrC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK,EAAE,OAAO,mBAAmB,WAAW,EAAE,QAAQ,UAAU,EAAE;AAAA,MAClE,SAAS,MAAY;AArO7B,YAAAC;AAsOU,YAAI,SAAS;AACX;AAAA,QACF;AACA,eAAMA,MAAA,SAAS,YAAT,gBAAAA,IAAkB;AAAA,MAC1B;AAAA;AAAA,IAEA,gBAAAD,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,QACL,KAAK;AAAA,QACL,SAAS,MAAM,WAAW,KAAK;AAAA,QAC/B,QAAQ,MAAM,WAAW,IAAI;AAAA,QAC7B,OAAO,EAAE,SAAS,OAAO;AAAA;AAAA,IAC3B;AAAA,IACC,UAAU,qBAAqB;AAAA,EAClC,CACF;AAEJ;AAEA,IAAM,gBAAgB,CAAC,EAAE,QAAQ,MAA+B;AAC9D,SACE,gBAAAA,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,KAAK;AAAA,QACH,iBAAiB;AAAA,QACjB,GAAG;AAAA,QACH,GAAG;AAAA,QACH,YAAY;AAAA,QACZ,KAAK;AAAA,QACL,UAAU;AAAA,QACV,SAAS,EAAE,MAAM,KAAK;AAAA,MACxB;AAAA,MACA;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAACO,eAAA,IAAa;AAAA,IAAE;AAAA,EAClB,CACF;AAEJ;AACO,IAAM,mBAAmB,CAAC,EAAE,cAAc,MAAM,MAAiC;AACtF,QAAM,EAAE,YAAY,mBAAmB,aAAa,IAAIC,YAAW,WAAS;AAC1E,iBAAa,SAAS;AAAA,MACpB,OAAO,MAAM;AAAA,MACb,SAAS;AAAA,MACT,UAAU;AAAA,IACZ,CAAC;AAAA,EACH,CAAC;AACD,QAAM,EAAE,YAAY,YAAY,YAAY,IAAI;AAChD,QAAM,YAAYJ,aAAY,eAAe;AAC7C,QAAM,EAAE,qBAAqB,qBAAqB,aAAa,YAAY,IAAIK,aAAY;AAC3F,QAAM,UAAUP,eAAc;AAC9B,QAAM,eAAeQ,oBAAmB;AACxC,QAAM,eAAeN,aAAYO,wBAAuB;AACxD,QAAM,kBAAkBP,aAAYQ,sBAAqB,YAAY,CAAC;AACtE,QAAM,YAAYR,aAAYS,gBAAe;AAC7C,QAAM,kBAAkB,OAAO,yCAAY,MAAM,IAAI;AACrD,QAAM,kBAAkB,OAAO,yCAAY,MAAM,IAAI;AACrD,QAAM,wBAAwB,eAAe,iBAAiB,aAAa,OAAO,2CAAa,MAAM,IAAI;AACzG,QAAM,EAAE,WAAW,IAAI,gCAAgC;AACvD,QAAM,CAAC,cAAc,eAAe,IAAIV,WAAS,KAAK;AACtD,QAAM,qBAAqBC,aAAY,gCAAgC,YAAY,QAAQ,CAAC,CAAC;AAC7F,QAAM,6BAA6B,8BAA8B;AACjE,QAAM,EAAE,gCAAgC,WAAW,IAAI,+BAA+B;AACtF,QAAM,eAAe,CAAC,uBAAuB,CAAC;AAE9C,EAAAU,YAAU,MAAM;AACd,KAAC,MAAY;AAxSjB,UAAAb;AAySM,YAAM,oBAAmBA,MAAA,aAAa,SAAS,UAAU,MAAhC,gBAAAA,IAAmC;AAC5D,UACE,oBACA,8BACA,CAAC,sBACD,CAAC,eACD,uCAAW,aACX;AACA,YAAI;AACF,gBAAM,+BAA+B,IAAI;AACzC,uBAAa,SAAS;AAAA,YACpB,OAAO;AAAA,YACP,SAAS;AAAA,YACT,UAAU;AAAA,YACV,MAAM,gBAAAD,QAAA,cAAC,oBAAe;AAAA,UACxB,CAAC;AAAA,QACH,SAAS,OAAO;AACd,kBAAQ,MAAM,KAAK;AAAA,QACrB;AAAA,MACF;AAAA,IACF,IAAG;AAAA,EAEL,GAAG,CAAC,4BAA4B,uCAAW,YAAY,UAAU,CAAC;AAElE,MAAI,CAAC,eAAe,CAAC,aAAa;AAChC,WAAO;AAAA,EACT;AACA,SACE,gBAAAA,QAAA,cAACe,WAAA,MACE,cACC,gBAAAf,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,UAAU,CAAC;AAAA,MACX,aAAa,eAAe,CAAC;AAAA,MAC7B,iBAAiB;AAAA,MACjB,QAAO;AAAA,MACP,gBAAgB,QAAQ,sBAAsB,QAAQ,IAAI,WAAW,UAAU,WAAM,MAAM;AAAA,MAC3F,MAAM,CAAC,sBAAsB,gBAAAA,QAAA,cAAC,gBAAW,IAAK,gBAAAA,QAAA,cAACgB,YAAA,IAAU;AAAA,MACzD,QAAQ;AAAA,MACR,SAAS;AAAA,MACT,KAAI;AAAA;AAAA,IAEJ,gBAAAhB,QAAA,cAAC,SAAS,OAAT,MACC,gBAAAA,QAAA,cAAC,eAAY,MAAM,gBAAAA,QAAA,cAACgB,YAAA,IAAU,KAC5B,gBAAAhB,QAAA,cAAC,OAAI,KAAK,EAAE,MAAM,QAAQ,KAAI,CAAC,wBAAwB,UAAU,YAAa,GAC7E,CAAC,gBAAgB,gBAAAA,QAAA,cAAC,cAAW,SAAS,uCAAW,YAAY,CAChE,GACA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS;AAAA,QACT,kBAAkB,kBAAkB;AAAA,QACpC,SAAS,cAAY,aAAa,EAAE,UAAU,YAAYiB,YAAW,WAAW,CAAC;AAAA;AAAA,IACnF,CACF;AAAA,IACA,gBAAAjB,QAAA,cAAC,SAAS,eAAT,EAAuB,KAAK,EAAE,IAAI,EAAE,GAAG;AAAA,IACvC,yBACC,gBAAAA,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,oBAAiB,UAAU,kBAAkB,eAAe,IAAI,GACjE,gBAAAA,QAAA,cAAC,SAAS,OAAT,MACC,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS;AAAA,QACT,kBAAkB,kBAAkB;AAAA,QACpC,SAAS,cAAY,aAAa,EAAE,UAAU,YAAYiB,YAAW,YAAY,CAAC;AAAA;AAAA,IACpF,CACF,CACF;AAAA,IAEF,gBAAAjB,QAAA,cAAC,uBAAkB;AAAA,IACnB,gBAAAA,QAAA,cAAC,iBAAc,SAAS,MAAM,gBAAgB,IAAI,GAAG;AAAA,EACvD,IACE,MAEH,cACC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,UAAU,CAAC;AAAA,MACX,aAAa,eAAe,CAAC;AAAA,MAC7B,iBAAiB;AAAA,MACjB,gBAAgB,QAAQ,sBAAsB,QAAQ,IAAI,WAAW,UAAU,WAAM,MAAM;AAAA,MAC3F,QAAO;AAAA,MACP,MAAM,CAAC,sBAAsB,gBAAAA,QAAA,cAAC,kBAAa,IAAK,gBAAAA,QAAA,cAACkB,cAAA,IAAY;AAAA,MAC7D,KAAI;AAAA,MACJ,QAAQ;AAAA,MACR,SAAS;AAAA;AAAA,IAET,gBAAAlB,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS;AAAA,QACT,kBAAkB,kBAAkB;AAAA,QACpC,SAAS,cAAY,aAAa,EAAE,UAAU,YAAYiB,YAAW,WAAW,CAAC;AAAA;AAAA,IACnF;AAAA,EACF,IACE,OAEH,mDAAiB,eAAc,cAAcE,cAAa,YAAY,SAAS,aAC9E,gBAAAnB,QAAA,cAAC,WAAQ,OAAM,iBAAgB,KAAI,kBACjC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS,MAAY;AACnB,YAAI;AACF,gBAAM,QAAQ,aAAa;AAAA,QAC7B,SAAS,GAAG;AACV,uBAAa,SAAS;AAAA,YACpB,OAAO,+BAAgC,EAAY,WAAW,EAAE;AAAA,YAChE,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,oBAAe;AAAA,EAClB,CACF,IACE,MACH,gBACC,gBAAAA,QAAA,cAAC,yBAAc,MAAM,cAAc,cAAc,MAAM,gBAAgB,KAAK,GAAG,YAAwB,CAE3G;AAEJ;;;AY1ZA;AAAA,OAAOoB,aAAW;AAClB,SAAS,8BAA8B,eAAAC,qBAAmB;AAC1D,SAAS,mBAAmB,uBAAuB;AAO5C,IAAM,cAAc,MAAM;AAC/B,QAAM,mBAAmBC,cAAY,4BAA4B;AACjE,QAAM,CAAC,WAAW,YAAY,IAAI,uBAAuB;AAEzD,QAAM,UAAU,MAAM;AACpB,iBAAa,CAAC,SAAS;AAAA,EACzB;AACA,MAAI,CAAC,kBAAkB;AACrB,WAAO;AAAA,EACT;AACA,SACE,gBAAAC,QAAA,cAAC,WAAQ,OAAO,YAAY,yBAAyB,0BACnD,gBAAAA,QAAA,cAAC,sBAAW,eAAY,eAAc,WACnC,YAAY,gBAAAA,QAAA,cAAC,qBAAkB,OAAM,MAAK,QAAO,QAAO,IAAK,gBAAAA,QAAA,cAAC,mBAAgB,OAAM,MAAK,QAAO,QAAO,CAC1G,CACF;AAEJ;;;AC1BA;AAAA,OAAOC,WAAS,YAAAC,kBAAgB;AAChC,SAAS,YAAAC,iBAAgB;AACzB,OAAO,UAAU;AACjB,SAAS,YAAY;AACrB;AAAA,EACE,4BAAAC;AAAA,EACA,2BAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,iBAAiB;;;ACX1B;AAAA,OAAOC,aAAW;AAKlB,IAAM,oBAAoB;AAAA,EACxB,CAAC,EAAE,SAAS,KAAK,GAAG,EAAE,SAAS,KAAK,GAAG,EAAE,SAAS,OAAO,GAAG,EAAE,SAAS,OAAO,GAAG,EAAE,SAAS,OAAO,CAAC;AAAA,EACpG,CAAC,EAAE,SAAS,OAAO,GAAG,EAAE,SAAS,aAAa,GAAG,EAAE,SAAS,MAAM,GAAG,EAAE,SAAS,aAAa,GAAG,EAAE,SAAS,MAAM,CAAC;AACpH;AAEO,IAAM,YAAY,CAAC,EAAE,aAAa,MAAM;AAC7C,SAAO,kBAAkB,IAAI,CAAC,WAAW,UACvC,gBAAAC,QAAA,cAAC,QAAK,KAAK,OAAO,SAAQ,WAAU,KAAK,EAAE,IAAI,KAAK,KACjD,UAAU,IAAI,WACb,gBAAAA,QAAA,cAAC,kBAAe,KAAK,MAAM,SAAS,SAAS,MAAM,aAAa,MAAM,OAAO,KAC3E,gBAAAA,QAAA,cAAC,cAAS,IAAI,MAAM,SAAS,MAAK,QAAO,KAAI,SAAQ,CACvD,CACD,CACH,CACD;AACH;AAEA,IAAM,iBAAiB,OAAO,QAAQ;AAAA,EACpC,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,GAAG;AAAA,EACH,WAAW;AAAA,IACT,GAAG;AAAA,IACH,IAAI;AAAA,IACJ,cAAc;AAAA,EAChB;AACF,CAAC;;;ACjCD;AAAA,SAAS,aAAAC,mBAAiB;AAKnB,IAAM,kBAAkB,CAAC,EAAE,MAAM,KAAK,MAAuC;AAClF,QAAM,CAAC,eAAe,CAAC,GAAG,eAAe,IAAI,mBAAmB,SAAS,YAAY;AAErF,EAAAC,YAAU,MAAM;AACd,QAAI,MAAM;AACR,UAAI,CAAC,aAAa,SAAS,IAAI,GAAG;AAChC,wBAAgB,CAAC,GAAG,cAAc,IAAI,CAAC;AAAA,MACzC;AAAA,IACF,OAAO;AACL,YAAM,QAAQ,aAAa,QAAQ,IAAI;AACvC,UAAI,SAAS,GAAG;AACd,cAAM,kBAAkB,CAAC,GAAG,YAAY;AACxC,wBAAgB,OAAO,OAAO,CAAC;AAC/B,wBAAgB,eAAe;AAAA,MACjC;AAAA,IACF;AAAA,EAEF,GAAG,CAAC,MAAM,IAAI,CAAC;AACjB;;;ACvBA;AAAA,SAAS,eAAAC,eAAa,aAAAC,aAAW,WAAAC,UAAS,UAAAC,UAAQ,YAAAC,kBAAgB;AAClE,SAAS,YAAAC,iBAAgB;AAEzB,SAAS,wBAAAC,6BAA4B;AACrC;AAAA,EAGE,mBAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,mBAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,sBAAAC;AAAA,OACK;AAiDA,IAAM,mBAAmB,MAAM;AAvEtC,MAAAC;AAwEE,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,WAAOA,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,oBAAmB,CAAC;AAC7C;AAEO,IAAM,0BAA0B,MAAM;AA5E7C,MAAAA;AA6EE,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,QAAQ,iBAAiB;AAE/B,OAAIA,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,qBAAqB;AACvC,WAAO,cAAc;AAAA,EACvB;AAEA,MAAI,MAAM,SAAS,GAAG;AACpB,WAAO,MAAM,CAAC;AAAA,EAChB;AAEA,SAAO;AACT;AAEO,IAAM,qBAAqB,MAAM;AA3FxC,MAAAA,KAAAC,KAAA;AA4FE,QAAM,SAAS,cAAc;AAC7B,QAAM,EAAE,UAAU,MAAI,MAAAA,OAAAD,MAAA,iCAAQ,YAAR,gBAAAA,IAAiB,YAAjB,gBAAAC,IAA0B,YAA1B,mBAAmC,aAAY,CAAC;AACtE,UAAO,uCAAW,mBAAkBC,sBAAqB;AAC3D;AAGO,IAAM,kBAAkB,CAAC,WAAuF;AAlGvH,MAAAF;AAmGE,QAAM,cAAcG,cAAY,uBAAuB;AACvD,QAAM,YAAYA,cAAYC,gBAAe;AAC7C,QAAM,iBAAiBD,cAAY,wBAAwB;AAC3D,MAAI,kBAAkBA,cAAY,cAAc,cAAc,iBAAiB;AAC/E,QAAM,wBAAwB,MAAM,KAAK,IAAI,IAAI,gBAAgB,IAAI,UAAQ,KAAK,QAAQ,CAAC,CAAC;AAC5F,QAAM,eAAeE,oBAAmB;AACxC,OAAIL,MAAA,iCAAQ,aAAR,gBAAAA,IAAkB,cAAc;AAClC,sBAAkB,gBAAgB,OAAO,UAAQ;AAC/C,aAAO,aAAa,SAAS,mBAAmB,KAAK,EAAE,CAAC,EAAE;AAAA,IAC5D,CAAC;AAAA,EACH;AACA,OAAI,iCAAQ,SAAQ,eAAe,SAAS,OAAO,IAAI,GAAG;AACxD,sBAAkB,gBAAgB,OAAO,UAAQ,KAAK,aAAa,OAAO,IAAI;AAAA,EAChF;AACA,MAAI,iCAAQ,QAAQ;AAClB,UAAM,SAAS,OAAO;AAEtB,sBAAkB,gBAAgB,OAAO,UAAQ,KAAK,KAAK,YAAY,EAAE,SAAS,MAAM,CAAC;AAAA,EAC3F;AACA,SAAO,EAAE,cAAc,iBAAiB,aAAa,WAAW,sBAAsB;AACxF;AAEO,IAAM,iBAAiB,MAAM;AAClC,QAAM,WAAWM,iBAAgB,UAAU,EAAE,SAAS;AACtD,QAAM,cAAcC,UAAS,OAAO,MAAM,EAAE;AAC5C,SAAO,YAAY;AACrB;AAEO,IAAM,wBAAwB,MAAM;AACzC,QAAM,cAAc,eAAe;AACnC,QAAM,EAAE,WAAW,IAAI,gCAAgC;AACvD,SAAO,eAAe,eAAe;AACvC;AAEO,IAAM,qBAAqB,MAAM;AACtC,QAAM,WAAWA,UAAS,OAAO,MAAM,EAAE;AACzC,QAAM,EAAE,WAAW,IAAI,gCAAgC;AACvD,SAAO,YAAY,eAAe;AACpC;AAEO,IAAM,qBAAqB,CAAC,UAAmB,cAA4B;AAChF,QAAM,iBAAiBC;AAAA,IACrB,CAAO,UAAyB;AAC9B,cAAQ,MAAM,KAAK;AAAA,QACjB,KAAK;AACH,cAAI,UAAU;AACZ,kBAAM,uCAAW;AAAA,UACnB,OAAO;AACL,mDAAW;AAAA,UACb;AACA;AAAA,QACF,KAAK;AACH,iDAAW,QAAO,uCAAW,kBAAkB,eAAc;AAC7D;AAAA,QACF,KAAK;AACH,iDAAW,QAAO,uCAAW,kBAAkB,eAAc;AAC7D;AAAA,MACJ;AAAA,IACF;AAAA,IACA,CAAC,WAAW,QAAQ;AAAA,EACtB;AAEA,SAAO;AACT;AAKO,IAAM,sBAAsB,MAAM;AACvC,QAAM,aAAaC,eAAc;AACjC,QAAM,iBAA+BN,cAAY,oBAAoB;AACrE,QAAM,CAAC,oBAAoB,qBAAqB,IAAIO,WAAS,KAAK;AAClE,QAAM,CAAC,kBAAkB,iBAAiB,IAAI,mBAAmB,SAAS,gBAAgB;AAC1F,EAAAC,YAAU,MAAM;AACd,QAAI,eAAe,QAAQ,SAAS,kBAAkB;AACpD,wBAAkB,KAAK;AAAA,IACzB;AAAA,EACF,GAAG,CAAC,kBAAkB,eAAe,QAAQ,OAAO,iBAAiB,CAAC;AACtE,QAAM,iBAAiBH;AAAA,IACrB,CAAO,aAA6C,SAAS;AAC3D,UAAI;AACF,0BAAkB,IAAI;AACtB,8BAAsB,IAAI;AAC1B,cAAM,WAAW,qBAAqB;AAAA,UACpC,YAAY,cAAc,UAAU;AAAA,UACpC,QAAQ;AAAA,QACV,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,MAAM;AACZ,YAAI,IAAI,QAAQ,SAAS,wBAAwB,GAAG;AAClD,uBAAa,SAAS;AAAA,YACpB,OAAO;AAAA,YACP,SAAS;AAAA,UACX,CAAC;AAAA,QACH,OAAO;AACL,uBAAa,SAAS;AAAA,YACpB,OAAO,IAAI;AAAA,YACX,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AACA,0BAAkB,KAAK;AAAA,MACzB;AACA,4BAAsB,KAAK;AAAA,IAC7B;AAAA,IACA,CAAC,YAAY,iBAAiB;AAAA,EAChC;AACA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;AAEO,SAAS,cACd,qBACqC;AACrC,MAAI,CAAC,qBAAqB;AACxB,WAAO;AAAA,EACT;AACA,QAAM,aAAsC;AAC5C,MAAI,oBAAoB,OAAO;AAC7B,eAAW,QAAQ,oBAAoB;AAAA,EACzC;AACA,MAAI,oBAAoB,QAAQ;AAC9B,eAAW,SAAS,oBAAoB;AAAA,EAC1C;AACA,SAAO;AACT;AAOO,SAAS,qBAAsC;AACpD,QAAM,gBAAgBL,cAAY,mBAAmB;AACrD,QAAM,EAAE,OAAO,OAAO,OAAO,IAAIA,cAAY,wBAAwB;AACrE,QAAM,uBAAuB,uBAAuB;AACpD,QAAM,QAAQA,cAAY,cAAc;AACxC,QAAM,eAAeA,cAAY,oBAAmB,+CAAe,gBAAgB,qBAAoB,CAAC,CAAC,CAAC;AAE1G,QAAM,wBAAwB,EAAE,SAAS,SAAU,UAAU;AAC7D,QAAM,4BAAqC,UAAU,EAAE,SAAS;AAChE,QAAM,8BAAuCS,SAAQ,MAAM;AACzD,WAAO,aAAa,KAAK,CAAC,SAAkB;AAnPhD,UAAAZ;AAoPM,UAAI,KAAK,YAAY,MAAM,KAAK,QAAQ,KAAK,CAAC,KAAK,SAAS;AAC1D,eAAO,CAAC,GAACA,MAAA,MAAM,KAAK,QAAQ,EAAE,kBAArB,gBAAAA,IAAoC,QAAQ;AAAA,MACvD;AACA,aAAO;AAAA,IACT,CAAC;AAAA,EACH,GAAG,CAAC,cAAc,KAAK,CAAC;AAExB,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;;;AHxOA,KAAK,EAAE,KAAK,CAAC;AAEN,IAAM,gBAAgB,CAAC,EAAE,WAAW,MAAM,MAAM;AACrD,QAAM,CAAC,MAAM,OAAO,IAAIa,WAAS,KAAK;AACtC,QAAM,cAAcC,cAAYC,wBAAuB;AACvD,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,kBAAgB,EAAE,MAAY,MAAM,gBAAgB,CAAC;AAErD,QAAM,QAAQD,cAAYE,yBAAwB;AAClD,QAAM,cAAcF,cAAY,iBAAiB;AAEjD,QAAM,WAAWG,UAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,cAAcA,UAAS,OAAU,MAAM,EAAE;AAC/C,QAAM,oBAAoB,mBAAmB;AAC7C,QAAM,oBAAoB,sBAAsB;AAEhD,QAAM,EAAE,UAAU,IAAI,eAAe;AAAA,IACnC,MAAM;AAAA,EACR,CAAC;AAED,QAAM,eAAe,CAAM,YAAW;AA5CxC,QAAAC;AA6CI,UAAMC,QAAO;AAAA,MACX,MAAM;AAAA,MACN;AAAA,MACA,UAAU;AAAA,IACZ;AAEA,cAAUA,OAAM,EAAE,WAAW,MAAM,CAAC;AACpC,KAAAD,MAAA,OAAO,oBAAP,gBAAAA,IAAA,aAAyB,EAAE,SAAS,UAAU,YAAY;AAAA,EAc5D;AAEA,MAAI,CAAC,eAAe,CAAC,SAAS,iBAAiB;AAC7C,WAAO;AAAA,EACT;AAEA,MAAI,UAAU;AACZ,WAAO,gBAAAE,QAAA,cAAC,aAAU,cAA4B;AAAA,EAChD;AACA,SACE,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,MAAY,cAAc,WACvC,gBAAAA,QAAA,cAAC,SAAS,SAAT,EAAiB,SAAO,MAAC,eAAY,wBACpC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KACE,YAAY,cAAc,EAAE,IAAI,oBAAoB,GAAG,UAAU,QAAQ,2BAA2B,IAAI,CAAC;AAAA;AAAA,IAG3G,gBAAAA,QAAA,cAAC,WAAQ,OAAM,oBACb,gBAAAA,QAAA,cAAC,WACC,gBAAAA,QAAA,cAAC,eAAU,CACb,CACF;AAAA,EACF,CACF,GACA,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,YAAY;AAAA,MACZ,OAAO,qBAAqB,oBAAoB,QAAQ;AAAA,MACxD,KAAK,EAAE,GAAG,MAAM,IAAI,mBAAmB;AAAA;AAAA,IAEvC,gBAAAA,QAAA,cAAC,aAAU,cAA4B;AAAA,EACzC,CACF;AAEJ;;;AInGA;AAAA,OAAOC,aAAW;AAClB,SAAS,YAAAC,iBAAgB;AAEzB;AAAA,EAGE,kBAAAC;AAAA,EACA,2BAAAC;AAAA,EACA;AAAA,EACA,qBAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;;;ACbP;AAAA,OAAOC,WAAS,YAAAC,WAAU,YAAAC,kBAAgB;AAE1C,SAAS,2BAAAC,0BAAyB,qBAAAC,oBAAmB,eAAAC,eAAa,yBAAAC,8BAA6B;AAC/F,SAAS,UAAU,UAAU,oBAAAC,yBAAwB;;;ACHrD;AAAA,OAAOC,aAAW;AAClB,SAAS,mBAAmB,aAAAC,kBAAiB;AAKtC,IAAM,oBAAoB,CAAC;AAAA,EAChC;AAAA,EACA;AAAA,EACA,UAAU;AAAA,EACV,gBAAgB;AAClB,MAKM;AACJ,SACE,gBAAAC,QAAA,cAAC,WACC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,OAAO;AAAA,QACP,SAAS;AAAA,QACT,YAAY;AAAA,MACd;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,qBAAkB,OAAO,EAAE,aAAa,SAAS,GAAG;AAAA,IACrD,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,WAAW,YAAY,YAAY,KAAG,QAChE,gBAAgB,WAAW,SAClC;AAAA,IACC,UAAU,OACT,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,OAAO,oBAAoB,IAAI,OAAO,GAAG,SAAS,MAAM,sBAAsB,KAAK,KAC7F,gBAAAA,QAAA,cAACC,YAAA,IAAU,CACb;AAAA,EAEJ,GACA,gBAAAD,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,sBAAsB,IAAI,MAAM,IAAI,KAAK,KAAG,QACtE,gBAAgB,WAAW,WAAU,qDAC5C,GACA,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,WAAU,KAAK,EAAE,GAAG,QAAQ,KAAK,KAAK,KACjE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,UAAQ;AAAA,MACR,SAAQ;AAAA,MACR,KAAK,EAAE,GAAG,QAAQ,OAAO,EAAE,SAAS,OAAO,EAAE;AAAA,MAC7C,SAAS,MAAM,sBAAsB,KAAK;AAAA;AAAA,IAC3C;AAAA,EAED,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK,EAAE,GAAG,OAAO;AAAA,MACjB,SAAS,MAAY;AACnB,cAAM,UAAU,EAAE,WAAW,KAAK,CAAC;AACnC,8BAAsB,KAAK;AAAA,MAC7B;AAAA,MACA,IAAG;AAAA,MACH,eAAY;AAAA;AAAA,IACb;AAAA,IACM,gBAAgB,WAAW;AAAA,EAClC,CACF,CACF;AAEJ;;;AC/DA;AAGO,IAAM,kBAAkB,OAAO,YAAY;AAAA,EAChD,OAAO;AAAA,EACP,GAAG;AAAA,EACH,IAAI;AAAA,EACJ,GAAG;AAAA,EACH,IAAI;AAAA,EACJ,2BAA2B;AAAA,IACzB,IAAI;AAAA,EACN;AAAA,EACA,4BAA4B;AAAA,IAC1B,IAAI;AAAA,EACN;AAAA,EACA,OAAO;AAAA,IACL,IAAI;AAAA,EACN;AACF,CAAC;AAEM,IAAM,oBAAoB,OAAO,iBAAiB;AAAA,EACvD,YAAY;AAAA,EACZ,qBAAqB;AAAA,EACrB,wBAAwB;AAAA,EACxB,IAAI;AACN,CAAC;;;ACzBD;AAAA,OAAOE,aAAW;AAKX,IAAM,YAAY,CAAC;AAAA,EACxB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,KAAAC,OAAM,CAAC;AACT,MAQM;AACJ,SACE,gBAAAC,QAAA,cAAC,QAAK,KAAK,iBAAE,GAAG,OAAO,UAAU,GAAG,KAAK,MAAM,MAAOD,OAAO,WAC3D,gBAAAC,QAAA,cAAC,OAAI,KAAK,EAAE,OAAO,WAAW,KAAI,IAAK,GACvC,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,KAAK,KAAK,KACpB,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,WAAW,KACzC,KACH,GACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,UAAU,KACpC,QACH,CACF,CACF;AAEJ;;;ACnCA;AAAA,OAAOC,aAAW;AAClB,SAAS,qBAAAC,oBAAmB,aAAAC,kBAAiB;AAKtC,IAAM,sBAAsB,CAAC;AAAA,EAClC;AAAA,EACA;AAAA,EACA,UAAU;AACZ,MAIM;AACJ,SACE,gBAAAC,QAAA,cAAC,WACC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,OAAO;AAAA,QACP,SAAS;AAAA,QACT,YAAY;AAAA,MACd;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAACC,oBAAA,EAAkB,OAAO,EAAE,aAAa,SAAS,GAAG;AAAA,IACrD,gBAAAD,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,WAAW,YAAY,YAAY,KAAG,OAEvE;AAAA,IACC,UAAU,OACT,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,OAAO,oBAAoB,IAAI,OAAO,GAAG,SAAS,MAAM,sBAAsB,KAAK,KAC7F,gBAAAA,QAAA,cAACE,YAAA,IAAU,CACb;AAAA,EAEJ,GACA,gBAAAF,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,mBAAmB,IAAI,MAAM,IAAI,KAAK,KAAG,uEAE1E,GACA,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,WAAU,KAAK,EAAE,GAAG,QAAQ,KAAK,KAAK,KACjE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,UAAQ;AAAA,MACR,SAAQ;AAAA,MACR,KAAK,EAAE,GAAG,QAAQ,OAAO,EAAE,SAAS,OAAO,EAAE;AAAA,MAC7C,SAAS,MAAM,sBAAsB,KAAK;AAAA;AAAA,IAC3C;AAAA,EAED,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK,EAAE,GAAG,OAAO;AAAA,MACjB,SAAS,MAAY;AACnB,cAAM,UAAU;AAAA,MAClB;AAAA,MACA,IAAG;AAAA,MACH,eAAY;AAAA;AAAA,IACb;AAAA,EAED,CACF,CACF;AAEJ;;;AJ7CO,IAAM,mBAAmB,CAAC;AAAA,EAC/B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAKM;AACJ,QAAM,CAAC,MAAM,OAAO,IAAIG,WAAS,KAAK;AACtC,QAAM,CAAC,oBAAoB,qBAAqB,IAAIA,WAAS,KAAK;AAClE,QAAM,CAAC,oBAAoB,qBAAqB,IAAIA,WAAS,KAAK;AAClE,QAAM,cAAcC,cAAYC,wBAAuB;AACvD,QAAM,cAAcD,cAAYE,kBAAiB;AACjD,QAAM,EAAE,cAAc,IAAIC,uBAAsB;AAChD,QAAM,aAAa,eAAe,wBAAwB,kBAAiB,2CAAa;AACxF,QAAM,oBAAoB,2CAAa,iBAAgB,kBAAkB,2CAAa;AAEtF,kBAAgB,EAAE,MAAM,QAAQ,sBAAsB,oBAAoB,MAAM,YAAY,CAAC;AAE7F,MAAI,CAAC,eAAe,CAAC,aAAa;AAChC,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,QAAA,cAACC,WAAA,MACE,mBACC,gBAAAD,QAAA,cAAC,YACC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAI;AAAA,MACJ,eAAY;AAAA,MACZ,KAAK;AAAA,QACH,sBAAsB;AAAA,QACtB,yBAAyB;AAAA,MAC3B;AAAA,MACA,SAAS,MAAM,sBAAsB,IAAI;AAAA;AAAA,IAEzC,gBAAAA,QAAA,cAAC,WAAQ,OAAM,gBACb,gBAAAA,QAAA,cAAC,WACC,gBAAAA,QAAA,cAAC,YAAS,OAAO,EAAE,WAAW,iBAAiB,GAAG,CACpD,CACF;AAAA,EACF,GACA,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,MAAY,cAAc,SAAS,OAAO,SACvD,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,SAAO;AAAA,MACP,KAAK;AAAA,QACH,wBAAwB;AAAA,UACtB,IAAI;AAAA,QACN;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,qBAAkB,eAAY,gCAC7B,gBAAAA,QAAA,cAACE,mBAAA,IAAiB,CACpB;AAAA,EACF,GACA,gBAAAF,QAAA,cAAC,SAAS,QAAT,EAAgB,aACf,gBAAAA,QAAA,cAAC,SAAS,SAAT,EAAiB,KAAK,EAAE,GAAG,GAAG,GAAG,OAAO,GAAG,aAAa,KAAK,YAAY,MACxE,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,WAAW,EAAE,IAAI,oBAAoB,OAAO,mBAAmB;AAAA,QAC/D,GAAG;AAAA,MACL;AAAA,MACA,eAAY;AAAA;AAAA,IAEZ,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAO,aAAa,iBAAiB;AAAA,QACrC,UAAU,0DACR,aAAa,WAAW,SAC1B;AAAA,QACA,IAAG;AAAA,QACH,YAAW;AAAA,QACX,MAAM,gBAAAA,QAAA,cAAC,YAAS,QAAQ,IAAI,OAAO,IAAI,OAAO,EAAE,WAAW,iBAAiB,GAAG;AAAA,QAC/E,SAAS,MAAS;AAAG,uBAAM,UAAU;AAAA;AAAA,QACrC,KAAK,EAAE,GAAG,QAAQ;AAAA;AAAA,IACpB;AAAA,EACF,GAEA,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,WAAW,EAAE,IAAI,oBAAoB,OAAO,wBAAwB;AAAA,QACpE,GAAG;AAAA,MACL;AAAA,MACA,eAAY;AAAA;AAAA,IAEZ,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAO,aAAa,eAAe;AAAA,QACnC,UAAU,OACR,aAAa,WAAW,SAC1B;AAAA,QACA,IAAG;AAAA,QACH,YAAW;AAAA,QACX,MAAM,gBAAAA,QAAA,cAAC,YAAS,QAAQ,IAAI,OAAO,IAAI;AAAA,QACvC,SAAS,MAAM;AACb,kBAAQ,KAAK;AACb,gCAAsB,IAAI;AAAA,QAC5B;AAAA,QACA,KAAK,EAAE,GAAG,QAAQ;AAAA;AAAA,IACpB;AAAA,EACF,CACF,CACF,CACF,CACF,IAEA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS,MAAM;AACb,8BAAsB,IAAI;AAAA,MAC5B;AAAA,MACA,KAAI;AAAA,MACJ,eAAY;AAAA;AAAA,IAEZ,gBAAAA,QAAA,cAAC,WAAQ,OAAM,gBACb,gBAAAA,QAAA,cAAC,WACC,gBAAAA,QAAA,cAAC,YAAS,OAAO,EAAE,WAAW,iBAAiB,GAAG,CACpD,CACF;AAAA,EACF,GAGF,gBAAAA,QAAA,cAAC,OAAO,MAAP,EAAY,MAAM,oBAAoB,OAAO,SAC5C,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA,cAAC,OAAO,SAAP,EAAe,KAAK,EAAE,GAAG,mBAAmB,GAAG,MAAM,IAAI,eAAe,KACvE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,WAAW,gBAAgB,MAAM,UAAU,EAAE,WAAW,KAAK,CAAC,IAAI;AAAA,MAClE;AAAA,MACA,SAAO;AAAA;AAAA,EACT,CACF,CACF,CACF,GAEA,gBAAAA,QAAA,cAAC,OAAO,MAAP,EAAY,MAAM,oBAAoB,OAAO,SAC5C,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA,cAAC,OAAO,SAAP,EAAe,KAAK,EAAE,GAAG,mBAAmB,GAAG,MAAM,IAAI,eAAe,KACvE,gBAAAA,QAAA,cAAC,uBAAoB,uBAA8C,WAAsB,SAAO,MAAC,CACnG,CACF,CACF,CACF;AAEJ;;;AKrKA;AAAA,OAAOG,WAAS,YAAAC,WAAU,YAAAC,kBAAgB;AAE1C,SAAS,2BAAAC,0BAAyB,qBAAAC,oBAAmB,eAAAC,eAAa,yBAAAC,8BAA6B;AAE/F,SAAS,aAAAC,YAAW,YAAAC,WAAU,YAAAC,iBAAgB;AAcvC,IAAM,gBAAgB,CAAC;AAAA,EAC5B;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,CAAC,MAAM,OAAO,IAAIC,WAAS,KAAK;AACtC,QAAM,EAAE,WAAW,IAAI,gCAAgC;AACvD,QAAM,CAAC,oBAAoB,qBAAqB,IAAIA,WAAS,KAAK;AAClE,QAAM,CAAC,oBAAoB,qBAAqB,IAAIA,WAAS,KAAK;AAClE,QAAM,cAAcC,cAAYC,wBAAuB;AACvD,QAAM,cAAcD,cAAYE,kBAAiB;AACjD,QAAM,EAAE,cAAc,IAAIC,uBAAsB;AAChD,QAAM,aAAa,eAAe,wBAAwB,kBAAiB,2CAAa;AACxF,QAAM,oBAAoB,2CAAa,iBAAgB,kBAAkB,2CAAa;AAEtF,kBAAgB,EAAE,MAAM,MAAM,YAAY,CAAC;AAE3C,MAAI,CAAC,eAAe,CAAC,aAAa;AAChC,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,QAAA,cAACC,WAAA,MACE,mBACC,gBAAAD,QAAA,cAAC,MAAM,MAAN,EAAW,MAAY,cAAc,WACpC,gBAAAA,QAAA,cAAC,MAAM,SAAN,EAAc,SAAO,QACpB,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS,MAAM;AACb,gBAAQ,CAAAE,UAAQ,CAACA,KAAI;AAAA,MACvB;AAAA;AAAA,EACF,CACF,GACA,gBAAAF,QAAA,cAAC,MAAM,SAAN,EAAc,aACb,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO,aAAa,iBAAiB;AAAA,MACrC,UAAU,0DACR,aAAa,WAAW,SAC1B;AAAA,MACA,IAAG;AAAA,MACH,YAAW;AAAA,MACX,MAAM,gBAAAA,QAAA,cAACG,WAAA,EAAS,QAAQ,IAAI,OAAO,IAAI,OAAO,EAAE,WAAW,iBAAiB,GAAG;AAAA,MAC/E,SAAS,MAAS;AAAG,qBAAM,UAAU;AAAA;AAAA,MACrC,KAAK,EAAE,IAAI,GAAG,IAAI,OAAO,OAAO,mBAAmB,WAAW,EAAE,OAAO,mBAAmB,EAAE;AAAA;AAAA,EAC9F,GAEA,gBAAAH,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO,aAAa,eAAe;AAAA,MACnC,UAAU,oBACR,aAAa,WAAW,SAC1B;AAAA,MACA,IAAG;AAAA,MACH,YAAW;AAAA,MACX,KAAK,EAAE,OAAO,uBAAuB,WAAW,EAAE,OAAO,wBAAwB,EAAE;AAAA,MACnF,MAAM,gBAAAA,QAAA,cAACI,WAAA,EAAS,QAAQ,IAAI,OAAO,IAAI;AAAA,MACvC,SAAS,MAAM;AACb,gBAAQ,KAAK;AACb,8BAAsB,IAAI;AAAA,MAC5B;AAAA;AAAA,EACF,CACF,CACF,IAEA,gBAAAJ,QAAA,cAAC,eAAY,SAAS,MAAM,sBAAsB,IAAI,GAAG,GAE3D,gBAAAA,QAAA,cAAC,MAAM,MAAN,EAAW,MAAM,oBAAoB,cAAc,yBAClD,gBAAAA,QAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,IAAI,gBAAgB,GAAG,OAAO,IAAI,MAAM,GAAG,aAC/D,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,WAAW,gBAAgB,YAAY;AAAA,MACvC;AAAA;AAAA,EACF,CACF,CACF,GAEA,gBAAAA,QAAA,cAAC,MAAM,MAAN,EAAW,MAAM,oBAAoB,cAAc,yBAClD,gBAAAA,QAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,IAAI,gBAAgB,GAAG,OAAO,IAAI,MAAM,GAAG,aAC/D,gBAAAA,QAAA,cAAC,uBAAoB,uBAA8C,WAAsB,CAC3F,CACF,CACF;AAEJ;AAEA,IAAM,cAAc,CAAC,EAAE,QAAQ,MAA+B;AAC5D,QAAM,oBAAoB,mBAAmB;AAC7C,QAAM,uBAAuB,sBAAsB;AAEnD,SAAO,qBAAqB,uBAC1B,gBAAAA,QAAA,cAAC,cAAW,KAAI,aAAY,eAAY,kBAAiB,WACvD,gBAAAA,QAAA,cAAC,WAAQ,OAAM,gBACb,gBAAAA,QAAA,cAAC,WACC,gBAAAA,QAAA,cAACK,YAAA,IAAU,CACb,CACF,CACF,IAEA,gBAAAL,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAI;AAAA,MACJ,eAAY;AAAA,MACZ,KAAK;AAAA,QACH,sBAAsB;AAAA,QACtB,yBAAyB;AAAA,MAC3B;AAAA,MACA;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,WAAQ,OAAM,gBACb,gBAAAA,QAAA,cAAC,WACC,gBAAAA,QAAA,cAACG,WAAA,EAAS,OAAO,EAAE,WAAW,iBAAiB,GAAG,CACpD,CACF;AAAA,EACF;AAEJ;;;ANjHO,IAAM,YAAY,CAAC;AAAA,EACxB;AAAA,EACA;AACF,MAGM;AACJ,QAAM,cAAcG,cAAYC,wBAAuB;AACvD,QAAM,cAAcD,cAAYE,kBAAiB;AACjD,QAAM,WAAWC,UAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,WAAoCH,cAAYI,eAAc;AACpE,QAAM,2BAA2B,OAAO,KAAK,QAAQ,EAAE,OAAO,cAAY;AACxE,UAAM,UAAU,SAAS,QAAQ;AACjC,WAAO,QAAQ,YAAY;AAAA,EAC7B,CAAC;AACD,QAAM,2BAA2BJ;AAAA,IAC/B,uBAAuB,CAAC,SAAkB,yBAAyB,SAAS,KAAK,YAAY,EAAE,CAAC;AAAA,EAClG;AACA,QAAM,WAAWA,cAAYK,eAAc;AAC3C,QAAM,aAAaC,gBAAc;AACjC,QAAM,oBAAoB,mBAAmB;AAC7C,QAAM,uBAAuB,sBAAsB;AAEnD,QAAM,aAAa,MAAY;AAC7B,QAAI;AACF,UAAI,2CAAa,cAAc;AAC7B,gBAAQ,IAAI,qBAAqB;AACjC,cAAM,WAAW,iBAAiB;AAClC,qBAAa,SAAS,EAAE,OAAO,sBAAsB,CAAC;AAAA,MACxD;AAAA,IACF,SAAS,GAAG;AACV,cAAQ,MAAM,yBAAyB,CAAC;AACxC,mBAAa,SAAS,EAAE,OAAO,gCAAgC,MAAM,QAAQ,CAAC;AAAA,IAChF;AAAA,EACF;AAEA,QAAM,UAAU,MAAY;AAC1B,UAAM,WAAW,QAAQ,OAAO,UAAU;AAAA,EAC5C;AAEA,QAAM,YAAY,IAAmE,2CAA5D,UAAmC,EAAE,WAAW,MAAM,GAAM;AACnF,QAAI,QAAQ,aAAc,SAAS,WAAW,yBAAyB,WAAW,GAAI;AACpF,YAAM,WAAW;AAAA,IACnB;AACA,UAAM,WAAW,MAAM;AAAA,EACzB;AAEA,MAAI,CAAC,eAAe,CAAC,aAAa;AAChC,WAAO;AAAA,EACT;AACA,MAAI,qBAAqB,sBAAsB;AAC7C,WAAO,gBAAAC,QAAA,cAAC,iBAAc,WAAsB,SAAkB,WAAsB;AAAA,EACtF;AACA,SAAO,WACL,gBAAAA,QAAA,cAAC,iBAAc,WAAsB,SAAkB,WAAsB,IAE7E,gBAAAA,QAAA,cAAC,oBAAiB,WAAsB,YAAwB,SAAkB,WAAsB;AAE5G;;;AO/EA;AAAA,OAAOC,aAAW;AAClB,SAAS,YAAAC,kBAAgB;;;ACDzB;AAAA,OAAOC,WAAS,YAAAC,WAAU,YAAAC,kBAAgB;AAC1C,SAAS,oBAAoB;AAM7B,SAAS,SAAAC,cAAa;AACtB;AAAA,EACE,wBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA;AAAA,EACA,gCAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP;AAAA,EACE;AAAA,EACA,aAAAC;AAAA,EACA;AAAA,EACA,YAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,WAAAC;AAAA,EACA,gBAAAC;AAAA,OACK;;;ACzBP;AAAA,OAAOC,aAAW;;;ACAlB;AAAA,OAAOC,WAAS,eAAAC,eAAa,aAAAC,aAAW,YAAAC,kBAAgB;AACxD,SAAS,eAAAC,cAAa,iBAAiB,iBAAAC,iBAAe,sBAAAC,2BAA0B;AAChF,SAAS,eAAe;;;ACFxB;AAAA,SAAS,2BAA2B,6BAAAC,kCAAiC;AAMrE,IAAM,oBAAN,MAAwB;AAAA,EAAxB;AACE,iCAAQ,CAAC,SAAS,UAAU;AAC1B,WAAK,UAAU;AACf,WAAK,QAAQ;AACb,WAAK,UAAU;AACf,WAAK,cAAc;AAAA,IACrB;AAEA,qCAAY,MAAM;AAdpB,UAAAC,KAAAC,KAAA;AAeI,YAAM,cAAc,KAAK,MAAM,SAAS,yBAAyB;AACjE,YAAM,cAAc,KAAK,MAAM,SAASC,0BAAyB;AACjE,OAAAD,OAAAD,MAAA,UAAU,iBAAV,gBAAAA,IAAwB,wBAAxB,gBAAAC,IAAA,KAAAD,KAA8C;AAC9C,4BAAU,iBAAV,mBAAwB,oBAAxB,4BAA0C;AAE1C,WAAK,MAAM,UAAU,CAAAG,iBAAe;AApBxC,YAAAH,KAAAC;AAqBM,SAAAA,OAAAD,MAAA,UAAU,iBAAV,gBAAAA,IAAwB,wBAAxB,gBAAAC,IAAA,KAAAD,KAA8CG;AAAA,MAChD,GAAG,yBAAyB;AAE5B,WAAK,MAAM,UAAU,CAAAC,iBAAe;AAxBxC,YAAAJ,KAAAC;AAyBM,SAAAA,OAAAD,MAAA,UAAU,iBAAV,gBAAAA,IAAwB,oBAAxB,gBAAAC,IAAA,KAAAD,KAA0CI;AAAA,MAC5C,GAAGF,0BAAyB;AAAA,IAC9B;AAEA,qCAAY,MAAY;AACtB,cAAQ,IAAI,2BAA2B;AACvC,YAAM,UAAU,KAAK,MAAM,SAAS,yBAAyB;AAC7D,YAAM,KAAK,QAAQ,qBAAqB,CAAC,OAAO;AAAA,IAClD;AAEA,qCAAY,MAAY;AACtB,cAAQ,IAAI,2BAA2B;AACvC,YAAM,UAAU,KAAK,MAAM,SAASA,0BAAyB;AAC7D,YAAM,KAAK,QAAQ,qBAAqB,CAAC,OAAO;AAAA,IAClD;AAEA,iCAAQ,MAAM;AACZ,cAAQ,IAAI,uBAAuB;AACnC,WAAK,QAAQ,MAAM;AAAA,IACrB;AAEA,yCAAgB,MAAM;AACpB,UAAI,UAAU,cAAc;AAC1B,YAAI;AACF,oBAAU,aAAa,iBAAiB,oBAAoB,KAAK,SAAS;AAC1E,oBAAU,aAAa,iBAAiB,gBAAgB,KAAK,SAAS;AACtE,oBAAU,aAAa,iBAAiB,UAAU,KAAK,KAAK;AAAA,QAC9D,SAAS,KAAK;AACZ,kBAAQ,MAAM,2CAA2C,GAAG;AAAA,QAC9D;AAAA,MACF;AAAA,IACF;AAAA;AACF;AAEO,IAAM,eAAe,IAAI,kBAAkB;;;AD5ClD,IAAM,eAAe,CAAC,EAAE,UAAU,KAAK,MAAM;AAC3C,QAAM,CAAC,SAAS,UAAU,IAAIG,WAAS,iBAAiB,KAAK,CAAC;AAC9D,QAAM,aAAaC,gBAAc;AACjC,QAAM,QAAQC,oBAAmB;AAEjC,QAAM,cAAcC,cAAY,MAAM;AACpC,QAAI,CAAC,SAAS;AACZ,uBAAiB,MAAM,YAAY,UAAU,EAAE,MAAM,SAAO,QAAQ,MAAM,yBAAyB,GAAG,CAAC;AACvG,mBAAa,MAAM,YAAY,KAAK;AAAA,IACtC,OAAO;AACL,uBAAiB,KAAK,EAAE,MAAM,SAAO,QAAQ,MAAM,yBAAyB,GAAG,CAAC;AAAA,IAClF;AAAA,EACF,GAAG,CAAC,YAAY,SAAS,KAAK,CAAC;AAE/B,MAAI,CAAC,iBAAiB,YAAY,GAAG;AACnC,WAAO;AAAA,EACT;AACA,SACE,gBAAAC,QAAA,cAAAA,QAAA,gBACG,UACC,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,OAAO,GAAG,SAAS,MAAM,YAAY,GAAG,eAAY,aACjE,OACH,IAEA,gBAAAA,QAAA,cAAC,WAAQ,OAAO,GAAG,UAAU,eAAe,UAAU,8BACpD,gBAAAA,QAAA,cAAC,sBAAW,QAAQ,CAAC,SAAS,KAAI,OAAM,SAAS,MAAM,YAAY,GAAG,eAAY,aAChF,gBAAAA,QAAA,cAAC,aAAQ,CACX,CACF,CAEJ;AAEJ;AAMO,IAAM,eAAe,MAAM;AAChC,QAAM,QAAQF,oBAAmB;AACjC,QAAM,cAAc,eAAe;AAEnC,EAAAG,YAAU,MAAM;AACd,aAAS,mBAAmB;AAC1B,aAAO,MAAM,UAAU,eAAa;AAClC,YAAI,WAAW,MAAM,SAASC,YAAW;AACzC,YAAI,aAAa;AACf,qBAAW,SAAS,OAAO,UAAQ,YAAY,WAAW,KAAK,EAAE;AAAA,QACnE;AACA,yBAAiB,qBAAqB,UAAU,SAAS,EAAE,MAAM,SAAO;AACtE,kBAAQ,MAAM,yBAAyB,GAAG;AAAA,QAC5C,CAAC;AAAA,MACH,GAAG,eAAe;AAAA,IACpB;AACA,QAAI,cAAwC,iBAAiB,KAAK,IAAI,iBAAiB,IAAI;AAC3F,qBAAiB,oBAAoB,UAAQ;AAC3C,UAAI,MAAM;AACR,YAAI,CAAC,aAAa;AAChB,wBAAc,iBAAiB;AAAA,QACjC;AAAA,MACF,OAAO;AACL;AACA,sBAAc;AAAA,MAChB;AAAA,IACF,CAAC;AACD,WAAO,MAAM;AACX;AACA,oBAAc;AAAA,IAChB;AAAA,EACF,GAAG,CAAC,aAAa,KAAK,CAAC;AAEvB,SAAO,gBAAAF,QAAA,cAAAA,QAAA,cAAE;AACX;AAEA,IAAO,uBAAQ;;;ADtFR,IAAM,MAAM,CAAC,EAAE,UAAU,KAAK,MAAM;AACzC,SAAO,gBAAAG,QAAA,cAAC,wBAAa,SAAkB;AACzC;;;AGLA;AAAA,OAAOC,WAAS,eAAAC,eAAa,aAAAC,aAAW,WAAAC,UAAS,YAAAC,kBAAgB;AACjE;AAAA,EACE,qBAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,gCAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,gBAAgB;;;ACTzB;;;ACAA;AAEO,IAAM,WAAW,OAAO,YAAY;AAAA,EACzC,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,iBAAiB;AAAA,EACjB,cAAc;AAAA,EACd,SAAS;AAAA,EACT,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,WAAW;AAAA,EACX,OAAO;AAAA,EACP,UAAU;AAAA,EACV,WAAW;AAAA,IACT,WAAW;AAAA,IACX,QAAQ;AAAA,EACV;AAAA,EACA,kBAAkB;AAAA,IAChB,OAAO;AAAA,EACT;AAAA,EACA,UAAU;AAAA,IACR,OAAO;AAAA,MACL,MAAM;AAAA,QACJ,WAAW;AAAA,UACT,WAAW;AAAA,QACb;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF,CAAC;;;AC7BD;AAAA,OAAOC,WAAS,YAAAC,WAAU,eAAAC,eAAa,aAAAC,aAAW,iBAAiB,WAAAC,UAAS,UAAAC,UAAQ,YAAAC,kBAAgB;AACpG,SAAS,YAAAC,iBAAgB;AACzB,OAAO,eAAe;AACtB,SAAS,wBAAwB;AACjC;AAAA,EAIE;AAAA,EACA,qBAAAC;AAAA,EACA,uBAAAC;AAAA,EACA;AAAA,EACA,sBAAAC;AAAA,EACA,sBAAAC;AAAA,EACA;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,sBAAAC;AAAA,OACK;AACP,SAAS,oBAAoB;;;ACnB7B;AAAA,OAAOC,WAAS,eAAAC,eAAa,YAAAC,kBAAgB;AAC7C,SAAqB,qBAAqB,qBAAAC,oBAAmB,iBAAAC,iBAAe,eAAAC,qBAAmB;AAC/F;AAAA,EACE,YAAAC;AAAA,EACA;AAAA,EACA,aAAAC;AAAA,EACA,gBAAAC;AAAA,EACA,oBAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,oBAAAC;AAAA,OACK;;;ACZP;AAAA,OAAOC,aAAW;AAIX,IAAM,iBAAiB,CAAC;AAAA,EAC7B;AAAA,EACA;AAAA,EACA;AAAA,EACA,QAAQ;AACV,MAKM;AACJ,SACE,gBAAAC,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,GAAG,QAAQ,OAAO,QAAQ,WAAW,KAAK,MAAM,GAAG,KAAK,GAAG,WACpF,MACD,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,YAAY,YAAY,KACtD,IACH,CACF;AAEJ;;;ACvBA;AAAA,SAAS,eAAAC,qBAAmB;AAC5B,SAAS,mBAAAC,kBAAiB,sBAAAC,qBAAoB,iBAAAC,iBAAe,eAAAC,qBAAmB;AAKzE,IAAM,mBAAmB,CAC9B,oBACG;AACH,QAAM,aAAaC,gBAAc;AACjC,QAAM,iBAAiBC,cAAYC,oBAAmB,eAAe,CAAC;AAEtE,QAAM,gBAAgBC;AAAA,IACpB,CAAO,gBAAwB;AAC7B,YAAM,WAAW,aACd,IAAI,iBAAiB,CAAC,GAAI,kBAAkB,CAAC,GAAI,WAAW,CAAC,EAC7D,MAAM,SAAO,aAAa,SAAS,EAAE,OAAO,IAAI,YAAY,CAAC,CAAC;AAAA,IACnE;AAAA,IACA,CAAC,YAAY,iBAAiB,cAAc;AAAA,EAC9C;AAEA,SAAO,EAAE,eAAe,eAAe;AACzC;AAEO,IAAM,uBAAuB,CAAC,EAAE,QAAQ,OAAO,qBAAqB,GAAG,MAAM;AAClF,QAAM,YAAYF,cAAYG,gBAAe;AAC7C,QAAM,qBAAqBH,cAAYC,iEAAwD,CAAC,KAAK,CAAC;AACtG,SAAO,yDAAoB,SAAS,QAAQ,uCAAW,iBAAiB;AAC1E;;;AC5BA;AAAA,SAAS,eAAAG,qBAAmB;AAC5B;AAAA,EAEE;AAAA,EACA,sBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,sBAAAC;AAAA,OACK;AAeA,IAAM,oBAAoB,MAAM;AACrC,QAAM,aAAaC,gBAAc;AACjC,QAAM,eAAeC,oBAAmB;AAExC,QAAM,oBAAoBC;AAAA,IACxB,CAAO,SAAqB,aAAqB;AAC/C,YAAM,WAAW,aAAa,SAAS,mBAAmB,mCAAS,MAAM,CAAC,MAAK,mCAAS;AACxF,YAAM,mBAAmB,EAAE,MAAM,IAAI,IAAI,QAAQ,IAAI,SAAS;AAE9D,UAAI,WAAW,UAAU;AACvB,yBAAiB,MAAM,IAAI,GAAG,QAAQ,KAAK,QAAQ,OAAO;AAAA,MAC5D,WAAW,SAAS;AAClB,yBAAiB,MAAM,IAAI,QAAQ;AAAA,MACrC;AAEA,YAAM,iBAAiB,aAAa,SAASC,0DAAoD,CAAC,KAAK,CAAC;AACxG,UAAI,EAAC,iDAAgB,KAAK,CAAC,kBAAiC,cAAc,OAAO,iBAAiB,MAAK;AACrG,cAAM,WAAW,aACd,4CAAuC,CAAC,GAAG,gBAAgB,gBAAgB,EAAE,MAAM,EAAE,CAAC,EACtF,MAAM,SAAO,aAAa,SAAS,EAAE,OAAO,IAAI,YAAY,CAAC,CAAC;AAAA,MACnE;AAAA,IACF;AAAA,IACA,CAAC,YAAY,YAAY;AAAA,EAC3B;AAEA,QAAM,sBAAsBD;AAAA,IAC1B,CAAO,kBAA0B;AAC/B,YAAM,iBAAiB,aAAa,SAASC,0DAAoD,CAAC,KAAK,CAAC;AACxG,UAAI,eAAe,aAAa,GAAG;AACjC,cAAM,WAAW,aACd;AAAA;AAAA,UAEC,eAAe,OAAO,CAAC,GAAkB,UAAkB,UAAU,aAAa;AAAA,QACpF,EACC,MAAM,SAAO,aAAa,SAAS,EAAE,OAAO,IAAI,YAAY,CAAC,CAAC;AAAA,MACnE;AAAA,IACF;AAAA,IACA,CAAC,YAAY,YAAY;AAAA,EAC3B;AAEA,QAAM,2BAA2BD;AAAA,IAC/B,CAAO,4BAAyC;AAC9C,YAAM,iBAAiB,aAAa,SAASC,0DAAoD,CAAC,KAAK,CAAC;AACxG,YAAM,yBAAyB,iDAAgB;AAAA,QAC7C,CAAC,kBAAiC,EAAC,mEAAyB,IAAI,cAAc;AAAA;AAGhF,YAAM,WAAW,aACd,4CAAuC,sBAAsB,EAC7D,MAAM,SAAO,aAAa,SAAS,EAAE,OAAO,IAAI,YAAY,CAAC,CAAC;AAAA,IACnE;AAAA,IACA,CAAC,YAAY,YAAY;AAAA,EAC3B;AAEA,SAAO,EAAE,mBAAmB,qBAAqB,yBAAyB;AAC5E;;;AHlDA,IAAM,YAAY,EAAE,QAAQ,YAAY,OAAO,WAAW;AAC1D,IAAM,gBAAgB;AAAA,EACpB,UAAU;AAAA,EACV,iBAAiB;AAAA,EACjB,GAAG;AAAA,EACH,YAAY;AAAA,EACZ,cAAc;AAChB;AAEO,IAAM,cAAc,CAAC;AAAA,EAC1B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAUM;AAxDN,MAAAC,KAAAC;AAyDE,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,EAAE,mBAAmB,OAAO,iBAAiB,MAAM,MAAID,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,uBAAsB,CAAC;AACpG,QAAM,EAAE,kBAAkB,CAAC,EAAE,KAAI,qCAAU,SAAQ,CAAC;AAEpD,QAAM,CAAC,MAAM,OAAO,IAAIE,WAAS,KAAK;AACtC,QAAM,UAAUC,gBAAc;AAC9B,QAAM,mBAAkBF,MAAAG,cAAYC,kBAAiB,MAA7B,gBAAAJ,IAAgC;AACxD,QAAM,EAAE,eAAe,cAAc,IAAI,8DAAsD;AAC/F,QAAM,gBAAgBG,cAAY,mBAAmB;AACrD,QAAM,EAAE,mBAAmB,yBAAyB,IAAI,kBAAkB;AAE1E,QAAM,EAAE,eAAe,kBAAkB,gBAAgB,sBAAsB,IAAI;AAAA;AAAA,EAEnF;AAEA,QAAM,kBAAkB,qBAAqB,EAAE,oBAAoB,QAAQ,aAAa,CAAC;AAEzF,QAAM,uBAAuBE;AAAA,IAC3B,CAAC,YAAY,OAAO;AAClB,YAAM,0BAA0B,oBAAI,IAAI,CAAC,GAAI,yBAAyB,CAAC,GAAI,SAAS,CAAC;AACrF,+BAAyB,uBAAuB;AAAA,IAClD;AAAA,IACA,CAAC,uBAAuB,wBAAwB;AAAA,EAClD;AAEA,QAAM,qBAAqBA,cAAY,MAAM;AAC3C,QAAI;AACF,6CAAW,UAAU,UAAU,QAAQ;AACvC,mBAAa,SAAS;AAAA,QACpB,OAAO;AAAA,MACT,CAAC;AAAA,IACH,SAAS,GAAG;AACV,cAAQ,IAAI,CAAC;AACb,mBAAa,SAAS;AAAA,QACpB,OAAO;AAAA,MACT,CAAC;AAAA,IACH;AAAA,EACF,GAAG,CAAC,OAAO,CAAC;AAEZ,QAAM,UAUF;AAAA,IACF,OAAO;AAAA,MACL,MAAM;AAAA,MACN,aAAa;AAAA,MACb,MAAM,gBAAAC,QAAA,cAAC,aAAU,OAAO,WAAW;AAAA,MACnC,SAAS;AAAA,MACT,MAAM;AAAA,IACR;AAAA,IACA,YAAY;AAAA,MACV,MAAM;AAAA,MACN,aAAa;AAAA,MACb,MAAM,gBAAAA,QAAA,cAAC,kBAAe,OAAO,WAAW;AAAA,MACxC,SAAS;AAAA,MACT,MAAM,CAAC,CAAC,QAAQ,cAAc,gBAAgB,SAAS,QAAQ,UAAU;AAAA,IAC3E;AAAA,IACA,KAAK;AAAA,MACH,MAAM;AAAA,MACN,aAAa;AAAA,MACb,MAAM,gBAAAA,QAAA,cAAC,WAAQ,OAAO,WAAW;AAAA,MACjC,SAAS,MAAM,kBAAkB,SAAS,iBAAiB,EAAE;AAAA,MAC7D,MAAM;AAAA,IACR;AAAA,IACA,MAAM;AAAA,MACJ,MAAM;AAAA,MACN,aAAa;AAAA,MACb,MAAM,gBAAAA,QAAA,cAACC,WAAA,EAAS,OAAO,WAAW;AAAA,MAClC,SAAS;AAAA,MACT,MAAM;AAAA,IACR;AAAA,IACA,MAAM;AAAA,MACJ,MAAM,QAAQ,gBAAgB,kBAAkB;AAAA,MAChD,MAAM,gBAAAD,QAAA,cAACE,eAAA,EAAa,OAAO,WAAW;AAAA,MACtC,SAAS,MAAY;AACnB,yBAAiB,QAAQ,EAAE;AAC3B,6BAAqB,QAAQ,EAAE;AAAA,MACjC;AAAA,MACA,MAAM,CAAC,CAAC;AAAA,IACV;AAAA,IACA,OAAO;AAAA,MACL,MAAM;AAAA,MACN,MAAM,gBAAAF,QAAA,cAAC,mBAAgB,OAAO,WAAW;AAAA,MACzC,SAAS,MAAY;AACnB,YAAI,QAAQ,cAAc;AACxB,wBAAc,QAAQ,YAAY;AAAA,QACpC;AAAA,MACF;AAAA,MACA,OAAO;AAAA,MACP,MAAM,CAAC,CAAC,kBAAkB,CAAC,mBAAmB,CAAC;AAAA,IACjD;AAAA,IACA,QAAQ;AAAA,MACN,MAAM;AAAA,MACN,MAAM,gBAAAA,QAAA,cAACG,mBAAA,EAAiB,OAAO,WAAW;AAAA,MAC1C,OAAO;AAAA,MACP,MAAM,CAAC,CAAC,mBAAmB,CAAC;AAAA,MAC5B,SAAS,MAAY;AACnB,YAAI,CAAC,QAAQ,QAAQ;AACnB;AAAA,QACF;AACA,YAAI;AACF,gBAAM,QAAQ,WAAW,QAAQ,QAAQ,EAAE;AAAA,QAC7C,SAAS,OAAO;AACd,uBAAa,SAAS,EAAE,OAAQ,MAAgB,SAAS,SAAS,QAAQ,CAAC;AAAA,QAC7E;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAEA,MAAI,UAAU;AACZ,WACE,gBAAAH,QAAA,cAAC,MAAM,MAAN,EAAW,MAAM,WAAW,cAAc,gBACzC,gBAAAA,QAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,IAAI,oBAAoB,IAAI,MAAM,GAAG,SAAS,OAAK,aAAa,OAAO,CAAC,KAC5F,gBAAAA,QAAA;AAAA,MAAC,MAAM;AAAA,MAAN;AAAA,QACC,KAAK;AAAA,UACH,SAAS;AAAA,UACT,OAAO;AAAA,UACP,GAAG;AAAA,UACH,gBAAgB;AAAA,UAChB,IAAI;AAAA,UACJ,UAAU;AAAA,UACV,IAAI;AAAA,UACJ,IAAI;AAAA,UACJ,cAAc;AAAA,UACd,YAAY;AAAA,QACd;AAAA;AAAA,MACD;AAAA,MAEC,gBAAAA,QAAA,cAAC,MAAM,OAAN,EAAY,KAAK,EAAE,OAAO,mBAAmB,GAAG,SAAS,OAAK,aAAa,OAAO,CAAC,KAClF,gBAAAA,QAAA,cAACI,YAAA,IAAU,CACb;AAAA,IACF,GAEC,OAAO,KAAK,OAAO,EAAE,IAAI,eAAa;AACrC,YAAM,SAAS,QAAQ,SAAS;AAChC,aAAO,OAAO,OACZ,gBAAAJ,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK;AAAA,UACL,MAAM,OAAO;AAAA,UACb,MAAM,OAAO;AAAA,UACb,SAAS,OAAO;AAAA,UAChB,OAAO,iCAAQ;AAAA;AAAA,MACjB,IACE;AAAA,IACN,CAAC,CACH,CACF;AAAA,EAEJ;AAEA,SACE,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,MAAY,cAAc,SAAS,KAAK,EAAE,OAAO,EAAE,SAAS,OAAO,EAAE,KAClF,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,KAAK;AAAA,QACH,YAAY;AAAA,QACZ,cAAc;AAAA,QACd,GAAG;AAAA,QACH,SAAS,OAAO,IAAI;AAAA,QACpB,UAAU;AAAA,QACV,KAAK;AAAA,QACL,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,OAAO,EAAE,SAAS,EAAE;AAAA,MACtB;AAAA;AAAA,IAEC,QAAQ,MAAM,OACb,gBAAAA,QAAA,cAAC,WAAQ,QAAQ,eAAe,OAAO,QAAQ,MAAM,eACnD,gBAAAA,QAAA,cAAC,cAAW,eAAY,qBAAoB,SAAS,QAAQ,MAAM,WAChE,QAAQ,MAAM,IACjB,CACF,IACE;AAAA,IACH,QAAQ,WAAW,OAClB,gBAAAA,QAAA,cAAC,WAAQ,QAAQ,eAAe,OAAO,QAAQ,WAAW,eACxD,gBAAAA,QAAA,cAAC,cAAW,eAAY,2BAA0B,SAAS,QAAQ,WAAW,WAC3E,QAAQ,WAAW,IACtB,CACF,IACE;AAAA,IACH,QAAQ,IAAI,OACX,gBAAAA,QAAA,cAAC,WAAQ,QAAQ,eAAe,OAAO,QAAQ,IAAI,eACjD,gBAAAA,QAAA,cAAC,cAAW,eAAY,mBAAkB,SAAS,QAAQ,IAAI,WAC5D,QAAQ,IAAI,IACf,CACF,IACE;AAAA,IAEH,QAAQ,KAAK,OACZ,gBAAAA,QAAA,cAAC,WAAQ,QAAQ,eAAe,OAAO,QAAQ,KAAK,eAClD,gBAAAA,QAAA,cAAC,cAAW,SAAS,QAAQ,KAAK,SAAS,eAAY,sBACrD,gBAAAA,QAAA,cAACC,WAAA,EAAS,OAAO,WAAW,CAC9B,CACF,IACE;AAAA,IAEH,QAAQ,MAAM,QAAQ,QAAQ,KAAK,QAAQ,QAAQ,OAAO,OACzD,gBAAAD,QAAA,cAAC,WAAQ,QAAQ,eAAe,OAAM,kBACpC,gBAAAA,QAAA,cAAC,SAAS,SAAT,EAAiB,SAAO,QACvB,gBAAAA,QAAA,cAAC,kBACC,gBAAAA,QAAA,cAACK,mBAAA,EAAiB,OAAO,WAAW,CACtC,CACF,CACF,IACE;AAAA,EACN,GACA,gBAAAL,QAAA,cAAC,SAAS,QAAT,MACC,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,YAAY;AAAA,MACZ,OAAM;AAAA,MACN,KAAK,EAAE,OAAO,OAAO,iBAAiB,mBAAmB,IAAI,MAAM,QAAQ,2BAA2B;AAAA;AAAA,IAErG,QAAQ,KAAK,OACZ,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,eAAY,oBAAmB,SAAS,QAAQ,KAAK,WACjE,QAAQ,KAAK,MACd,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,YAAY,YAAY,KACzD,QAAQ,KAAK,IAChB,CACF,IACE;AAAA,IAEH,QAAQ,MAAM,OACb,gBAAAA,QAAA;AAAA,MAAC,SAAS;AAAA,MAAT;AAAA,QACC,eAAY;AAAA,QACZ,SAAS,QAAQ,MAAM;AAAA,QACvB,KAAK,EAAE,OAAO,QAAQ,MAAM,MAAM;AAAA;AAAA,MAEjC,QAAQ,MAAM;AAAA,MACf,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,OAAO,WAAW,YAAY,YAAY,KAC3E,QAAQ,MAAM,IACjB;AAAA,IACF,IACE;AAAA,IACH,QAAQ,OAAO,OACd,gBAAAA,QAAA;AAAA,MAAC,SAAS;AAAA,MAAT;AAAA,QACC,eAAY;AAAA,QACZ,SAAS,QAAQ,OAAO;AAAA,QACxB,KAAK,EAAE,OAAO,QAAQ,OAAO,MAAM;AAAA;AAAA,MAElC,QAAQ,OAAO;AAAA,MAChB,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,OAAO,WAAW,YAAY,YAAY,KAC3E,QAAQ,OAAO,IAClB;AAAA,IACF,IACE;AAAA,EACN,CACF,CACF;AAEJ;;;AIzTA;AAAA,OAAOM,aAAW;AAClB,SAAS,YAAAC,iBAAgB;;;;;;AAUlB,IAAM,YAAY,MAAM;AAX/B,MAAAC;AAYE,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,yBAAyB,qBAAqB,EAAE,OAAO,KAAK,CAAC;AACnE,QAAM,WAAWC,UAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,kBACJ,SAAS,SACR,SAAS,KAAK,uBACb,SAAS,KAAK,wBACb,SAAS,KAAK,mBAAmB,SAAS,KAAK,gBAAgB,WAClE,CAAC;AACH,QAAM,oBAAoB,mBAAmB;AAC7C,QAAM,oBAAoB,sBAAsB;AAChD,QAAM,YAAY,qBAAqB;AAEvC,MAAI,cAAYD,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,eAAc,CAAC;AAAW,WAAO,gBAAAE,QAAA,cAAAA,QAAA,cAAE;AAEnE,SACE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,OAAO;AAAA,QACP,MAAM;AAAA,QACN,WAAW;AAAA,QACX,IAAI;AAAA,MACN;AAAA,MACA,OAAM;AAAA,MACN,SAAQ;AAAA;AAAA,IAER,gBAAAA,QAAA,cAAC,WACC,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,GAAG,UAAU,IAAI,MAAM,8BAA8B,EAAE,SAAS,OAAO,EAAE,KACnF,gBAAAA,QAAA,cAAC,SAAI,KAAK,oBAAW,OAAO,EAAE,SAAS,SAAS,GAAG,KAAI,cAAa,QAAQ,KAAK,OAAO,KAAK,CAC/F,GAEA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,GAAG,mBAAmB,KACvD,kBAAkB,yBAAyB,iBAC9C,GACC,kBACC,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK,EAAE,IAAI,MAAM,UAAU,OAAO,WAAW,UAAU,IAAI,QAAQ,GAAG,qBAAqB;AAAA;AAAA,MAC5F;AAAA,IAED,IACE,IACN;AAAA,EACF;AAEJ;;;ACzDA;AAAA,SAAS,aAAAC,aAAW,YAAAC,kBAAgB;AACpC,SAAS,sBAAAC,qBAAoB,eAAAC,qBAAmB;AAIzC,IAAM,cAAc,CAAC,cAAsB;AAChD,QAAM,iBAAiBC,cAAYC,0DAAoD,CAAC;AACxF,QAAM,CAAC,UAAU,WAAW,IAAIC,WAAS,EAAE;AAE3C,EAAAC,YAAU,MAAM;AACd,QAAIC,UAAQ;AACZ,qDAAgB,QAAQ,CAAC,kBAAiC;AACxD,UAAI,cAAc,OAAO,WAAW;AAClC,QAAAA,UAAQ,cAAc;AAAA,MACxB;AAAA,IACF;AAEA,gBAAYA,OAAK;AAAA,EACnB,GAAG,CAAC,WAAW,cAAc,CAAC;AAE9B,SAAO;AACT;;;ACrBA;AAAO,IAAMC,cAAa,CAAC,SAAe;AACxC,MAAI,EAAE,gBAAgB,OAAO;AAC3B,WAAO;AAAA,EACT;AACA,QAAM,QAAQ,KAAK,SAAS;AAC5B,QAAM,UAAU,KAAK,WAAW;AAChC,QAAM,SAAS,QAAQ,KAAK,OAAO;AACnC,SAAO,GAAG,QAAQ,KAAK,MAAM,EAAE,GAAG,KAAK,IAAI,UAAU,KAAK,MAAM,EAAE,GAAG,OAAO,IAAI,MAAM;AACxF;AAEO,IAAM,qBAAqB;;;APuBlC,IAAM,aAA2D,CAAC;AAClE,IAAI,eAAwC;AAC5C,SAAS,aAAa,OAAe;AAnCrC,MAAAC;AAqCE,WAAOA,MAAA,WAAW,KAAK,MAAhB,gBAAAA,IAAmB,SAAQ;AACpC;AAEA,IAAM,eAAe,CAAC,OAAe,IAAY,SAAiB;AAxClE,MAAAA,KAAAC;AAyCE,QAAID,MAAA,WAAW,KAAK,MAAhB,gBAAAA,IAAmB,QAAO,QAAMC,MAAA,WAAW,KAAK,MAAhB,gBAAAA,IAAmB,UAAS,MAAM;AACpE;AAAA,EACF;AACA,+CAAc,gBAAgB,KAAK,IAAI,QAAQ,GAAG,CAAC;AACnD,SAAO,OAAO,YAAY,EAAE,CAAC,KAAK,GAAG,EAAE,MAAM,GAAG,EAAE,CAAC;AACrD;AAEA,IAAM,4BAA4B,CAChC,aACA,gBACA,cACA,cACG;AACH,MAAI,eAAe,EAAE,kBAAkB,eAAe;AACpD,WAAO,YAAY,wBAAwB;AAAA,EAC7C;AACA,SAAO;AACT;AAEA,IAAM,uBAAuB,CAAC,EAAE,MAAM,MAAM,MAAyC;AACnF,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,KAAK;AAAA,QACL,UAAU;AAAA,MACZ;AAAA;AAAA,IAEC,QACC,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,IAAG;AAAA,QACH,KAAK;AAAA,UACH,OAAO;AAAA,UACP,eAAe;AAAA,UACf,YAAY;AAAA,UACZ,YAAY;AAAA,QACd;AAAA;AAAA,MAEC;AAAA,IACH;AAAA,IAED,SACC,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,IAAG;AAAA,QACH,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,OAAO;AAAA,UACP,YAAY;AAAA,UACZ,YAAY;AAAA,QACd;AAAA;AAAA,MAEC;AAAA,IACH;AAAA,EAEJ;AAEJ;AAEO,IAAM,cAAc,CAAC;AAAA,EAC1B;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,WAAWC,cAAYC,oBAAmB,QAAQ,CAAC;AACzD,QAAM,oBAAoBD,cAAY,uBAAuB;AAC7D,MAAI,UAAU;AACZ,WACE,gBAAAD,QAAA,cAAC,wBAAqB,MAAM,qBAAqB,GAAG,WAAW,MAAM,QAAQ,KAAK,EAAE,KAAK,UAAU,OAAM,QAAO;AAAA,EAEpH;AAEA,MAAI,SAAS,MAAM,QAAQ;AACzB,WAAO,gBAAAA,QAAA,cAAC,wBAAqB,MAAM,MAAM,qBAAqB,MAAM,CAAC,IAAI,iBAAiB,IAAI,OAAM,WAAU;AAAA,EAChH;AACA,SAAO;AACT;AAEA,IAAM,YACJ;AAEF,IAAMG,QAAO,OAAO,KAAK;AAAA,EACvB,OAAO;AAAA,EACP,WAAW;AAAA,EACX,WAAW;AAAA,IACT,gBAAgB;AAAA,EAClB;AACF,CAAC;AAEM,IAAM,mBAAmB,CAAC,EAAE,SAAS,OAAO,MAA4C;AAC7F,MAAI,CAAC,SAAS;AACZ,WAAO,gBAAAH,QAAA,cAACI,WAAA,IAAS;AAAA,EACnB;AAEA,SACE,gBAAAJ,QAAA,cAACI,WAAA,MACE,QACE,KAAK,EACL,MAAM,MAAM,EACZ;AAAA,IAAI,UACH,UAAU,KAAK,IAAI,IACjB,gBAAAJ,QAAA,cAACG,OAAA,EAAK,MAAM,MAAM,KAAK,MAAM,QAAO,UAAS,KAAI,yBAC9C,KAAK,MAAM,GAAG,MAAM,CACvB,IAEA,KAAK,MAAM,GAAG,MAAM;AAAA,EAExB,CACJ;AAEJ;AAEA,IAAM,iBAAiB,CAAC,EAAE,OAAO,SAAS,MAAuD;AAC/F,MAAI,SAAS,MAAM,SAAS,GAAG;AAC7B,WAAO;AAAA,EACT;AACA,SAAO,WAAW,YAAY;AAChC;AAEO,IAAM,aAAa,OAAO,MAAM;AAAA,EACrC,UAAU;AAAA,EACV,cAAc;AAAA,EACd,YAAY;AAAA,EACZ,OAAO;AAAA,EACP,UAAU;AAAA,EACV,OAAO;AAAA,EACP,YAAY;AACd,CAAC;AAED,IAAM,cAAcH,QAAM;AAAA,EACxB,CAAC,EAAE,OAAO,QAAQ,CAAC,GAAG,QAAQ,MAA0E;AAjL1G,QAAAF,KAAAC,KAAA;AAkLI,UAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,UAAM,SAASM,SAA8B,IAAI;AACjD,UAAM,WAAWC,UAAS,OAAU,MAAM,EAAE;AAC5C,UAAM,uBAAuB,CAAC,GAACR,MAAA,qCAAU,SAAV,gBAAAA,IAAgB;AAC/C,UAAM,cAAYC,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,eAAc;AAChD,UAAM,cAAcE,cAAYM,kBAAiB;AACjD,UAAM,CAAC,cAAc,eAAe,IAAI,6BAA6B,cAAc,IAAI;AACvF,UAAM,CAAC,cAAc,eAAe,IAAI,6BAA6B,cAAc,IAAI;AACvF,UAAM,cAAc,eAAe;AAAA,MACjC,OAAO,QAAQ;AAAA,MACf,UAAU,QAAQ;AAAA,IACpB,CAAC;AACD,UAAM,CAAC,WAAW,gBAAgB,IAAIC,WAAS,KAAK;AACpD,UAAM,gBAAgB,CAAC,GAAC,0CAAU,SAAV,mBAAgB;AACxC,UAAM,YAAY,QAAQ,WAAW,aAAa,MAAM,QAAQ,WAAW,eAAe;AAC1F,oBAAgB,MAAM;AACpB,UAAI,OAAO,SAAS;AAClB,qBAAa,OAAO,QAAQ,IAAI,OAAO,QAAQ,YAAY;AAAA,MAC7D;AAAA,IACF,GAAG,CAAC,OAAO,QAAQ,EAAE,CAAC;AAEtB,UAAM,eAAe,CAAC,OAAgB,MAAkD;AACtF,6BAAG;AACH,uBAAiB,KAAK;AAAA,IACxB;AAEA,WACE,gBAAAR,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,IAAI;AAAA,UACJ,IAAI;AAAA,UACJ,IAAI;AAAA,UACJ,+BAA+B,EAAE,SAAS,OAAO;AAAA,UACjD,yBAAyB,EAAE,SAAS,QAAQ,SAAS,EAAE;AAAA,QACzD;AAAA,QACA;AAAA;AAAA,MAEA,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK;AAAA,UACL,OAAM;AAAA,UACN,KAAK;AAAA,YACH,UAAU;AAAA,YACV,UAAU;AAAA;AAAA,YAEV,YAAY,0BAA0B,aAAa,aAAa,IAAI,cAAc,CAAC,CAAC,SAAS;AAAA,YAC7F,GAAG;AAAA,YACH,GAAG;AAAA,YACH,YAAY;AAAA,YACZ,OAAO;AAAA,cACL,QAAQ;AAAA,YACV;AAAA,YACA,WAAW;AAAA,cACT,YAAY;AAAA,YACd;AAAA,UACF;AAAA,UACA,eAAY;AAAA,UACZ,SAAS,OAAK;AACZ,gBAAI,UAAU;AACZ,2BAAa,MAAM,CAAC;AAAA,YACtB;AAAA,UACF;AAAA;AAAA,QAEA,gBAAAA,QAAA,cAAC,YAAS,WAAW,QAAQ,IAAI,OAAc,QAAgB;AAAA,QAC/D,gBAAAA,QAAA;AAAA,UAAC;AAAA;AAAA,YACC,KAAK;AAAA,cACH,OAAO,YAAY,SAAS;AAAA,cAC5B,YAAY;AAAA,cACZ,SAAS;AAAA,cACT,YAAY;AAAA,cACZ,WAAW;AAAA,cACX,OAAO;AAAA,YACT;AAAA,YACA,IAAG;AAAA;AAAA,UAEH,gBAAAA,QAAA;AAAA,YAAC;AAAA;AAAA,cACC,OAAM;AAAA,cACN,KAAK;AAAA,gBACH,UAAU;AAAA,gBACV,UAAU;AAAA,gBACV,cAAc;AAAA,gBACd,YAAY;AAAA,cACd;AAAA;AAAA,YAEC,QAAQ,eAAe,SAAS,CAAC,QAAQ,aACxC,gBAAAA,QAAA;AAAA,cAAC;AAAA;AAAA,gBACC,IAAG;AAAA,gBACH,SAAQ;AAAA,gBACR,KAAK,EAAE,OAAO,YAAY,SAAS,oBAAoB,YAAY,YAAY;AAAA;AAAA,cAE9E,QAAQ,cAAc;AAAA,YACzB,IAEA,gBAAAA,QAAA,cAAC,WAAQ,OAAO,QAAQ,YAAY,MAAK,OAAM,OAAM,SAAQ,QAAQ,EAAE,QAAQ,GAAG,KAChF,gBAAAA,QAAA;AAAA,cAAC;AAAA;AAAA,gBACC,IAAG;AAAA,gBACH,SAAQ;AAAA,gBACR,KAAK,EAAE,OAAO,YAAY,SAAS,oBAAoB,YAAY,YAAY;AAAA;AAAA,cAE9E,QAAQ,WAAW,cAAc,GAAG,QAAQ,UAAU,WAAW,QAAQ;AAAA,YAC5E,CACF;AAAA,YAEF,gBAAAA,QAAA;AAAA,cAAC;AAAA;AAAA,gBACC,oBAAoB,QAAQ,WAAW;AAAA,gBACvC,UAAU,QAAQ;AAAA,gBAClB,OAAO,QAAQ;AAAA;AAAA,YACjB;AAAA,UACF;AAAA,UAEC,CAAC,YACA,gBAAAA,QAAA;AAAA,YAAC;AAAA;AAAA,cACC,IAAG;AAAA,cACH,SAAQ;AAAA,cACR,KAAK;AAAA,gBACH,OAAO;AAAA,gBACP,YAAY;AAAA,gBACZ,UAAU;AAAA,gBACV,OAAO;AAAA,gBACP,QAAQ;AAAA,gBACR,IAAI;AAAA,gBACJ,GAAG;AAAA,cACL;AAAA;AAAA,YAECS,YAAW,QAAQ,IAAI;AAAA,UAC1B,IACE;AAAA,UACJ,gBAAAT,QAAA;AAAA,YAAC;AAAA;AAAA,cACC;AAAA,cACA;AAAA,cACA,iBAAiB,QAAQ,WAAW;AAAA,cACpC,SAAS,MAAM;AACb,gCAAgB,EAAE;AAClB,gCAAgB,EAAE,IAAI,QAAQ,QAAQ,MAAM,QAAQ,WAAW,CAAC;AAAA,cAClE;AAAA,cACA,cAAc,MAAM;AAClB,oBAAI,QAAQ,YAAY;AACtB,kCAAgB,QAAQ,UAAU;AAClC,kCAAgB,CAAC,CAAC;AAAA,gBACpB;AAAA,cACF;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA;AAAA,UACF;AAAA,QACF;AAAA,QACA,gBAAAA,QAAA;AAAA,UAAC;AAAA;AAAA,YACC,SAAQ;AAAA,YACR,KAAK;AAAA,cACH,GAAG;AAAA,cACH,IAAI;AAAA,cACJ,WAAW;AAAA,cACX,YAAY;AAAA,cACZ,YAAY;AAAA,cACZ,OAAO,YAAY,SAAS;AAAA,YAC9B;AAAA,YACA,SAAS,OAAK;AACZ,2BAAa,MAAM,CAAC;AAAA,YACtB;AAAA;AAAA,UAEA,gBAAAA,QAAA,cAAC,oBAAiB,SAAS,QAAQ,SAAS;AAAA,QAC9C;AAAA,MACF;AAAA,IACF;AAAA,EAEJ;AACF;AAEA,IAAM,iBAAiBA,QAAM;AAAA,EAC3B,CAAC,EAAE,OAAO,OAAO,MAAAU,MAAK,MAAyE;AAC7F,WAAO,gBAAAV,QAAA,cAAC,eAAY,OAAc,OAAc,KAAKU,MAAK,KAAK,EAAE,IAAI,SAASA,MAAK,KAAK,GAAG;AAAA,EAC7F;AACF;AAEA,IAAM,0BAA0BV,QAAM,WAGpC,CAAC,EAAE,UAAU,eAAe,GAAG,YAAY;AAC3C,QAAM,aAAaW,gBAAc;AACjC,QAAMC,WAAUC,cAAY,CAAC,OAAeH,UAAuB;AACjE,WAAOA,MAAK,KAAK,EAAE;AAAA,EACrB,GAAG,CAAC,CAAC;AACL,EAAAI,YAAU,MAAM;AACd,0BAAsB,MAAM,eAAe,CAAC,CAAC;AAAA,EAC/C,GAAG,CAAC,cAAc,CAAC;AACnB,SACE,gBAAAd,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,GAAG;AAAA,MACL;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAO;AAAA,UACL,OAAO;AAAA,QACT;AAAA;AAAA,MAEC,CAAC,EAAE,QAAQ,MAAM,MAChB,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK,UAAQ;AACX,gBAAI,MAAM;AAER,sBAAQ,UAAU;AAClB,6BAAe;AAAA,YACjB;AAAA,UACF;AAAA,UACA,WAAW,SAAS;AAAA,UACpB,UAAU;AAAA,UACV,UAAU;AAAA,UACV;AAAA,UACA;AAAA,UACA,OAAO;AAAA,YACL,WAAW;AAAA,UACb;AAAA,UACA,SAASY;AAAA,UACT,iBAAiB,CAAC,EAAE,mBAAmB,iBAAiB,MAAM;AAC5D,qBAAS,IAAI,mBAAmB,KAAK,kBAAkB,KAAK;AAC1D,kBAAI,CAAC,SAAS,CAAC,EAAE,MAAM;AACrB,2BAAW,eAAe,MAAM,SAAS,CAAC,EAAE,EAAE;AAAA,cAChD;AAAA,YACF;AAAA,UACF;AAAA;AAAA,QAEC;AAAA,MACH;AAAA,IAEJ;AAAA,EACF;AAEJ,CAAC;AAEM,IAAM,WAAWZ,QAAM;AAAA,EAC5B,CAAC,EAAE,eAAe,GAAgD,YAAY;AAC5E,UAAM,WAAWC,cAAY,iBAAiB;AAC9C,UAAM,wBAAwBA,cAAYc,uEAA2D,CAAC;AACtG,UAAM,mBAAmBC,SAAQ,MAAM;AACrC,YAAM,0BAA0B,IAAI,IAAI,yBAAyB,CAAC,CAAC;AACnE,cAAO,qCAAU,OAAO,aAAW,QAAQ,SAAS,UAAU,CAAC,wBAAwB,IAAI,QAAQ,EAAE,OAAM,CAAC;AAAA,IAC9G,GAAG,CAAC,uBAAuB,QAAQ,CAAC;AAEpC,UAAM,eAAeC,oBAAmB;AACxC,UAAM,uBAAuBZ,SAAO,KAAK;AAEzC,IAAAS,YAAU,MAAM;AACd,YAAM,cAAc,aAAa,UAAU,MAAM;AAE/C,YAAI,CAAC,QAAQ,SAAS;AACpB;AAAA,QACF;AAEA,cAAM,eAAe,QAAQ,QAAQ;AACrC,YACE,gBACA,aAAa,eAAe,aAAa,YAAY,aAAa,aAAa,aAAa,cAC5F;AACA,gCAAsB,MAAM,eAAe,CAAC,CAAC;AAAA,QAC/C;AAAA,MACF,GAAG,4BAA4B;AAC/B,aAAO;AAAA,IACT,GAAG,CAAC,cAAc,SAAS,cAAc,CAAC;AAE1C,IAAAA,YAAU,MAAM;AAEd,UAAI,iBAAiB,SAAS,MAAK,mCAAS,YAAW,CAAC,qBAAqB,SAAS;AACpF,6BAAqB,UAAU;AAE/B,gBAAQ,QAAQ,gBAAgB,CAAC;AAAA,MACnC;AAAA,IACF,GAAG,CAAC,SAAS,gBAAgB,CAAC;AAE9B,WAAO,iBAAiB,WAAW,IACjC,gBAAAd,QAAA,cAAC,eAAU,IAEX,gBAAAA,QAAA,cAAC,2BAAwB,UAAU,kBAAkB,KAAK,SAAS,gBAAgC;AAAA,EAEvG;AACF;AAEA,IAAM,WAAW,CAAC;AAAA,EAChB;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,WAAW,YAAY,SAAS;AACtC,QAAM,gBAAgBC,cAAYiB,oBAAmB;AAErD,kBAAgB,MAAM;AACpB,QAAI,iCAAQ,SAAS;AACnB,UAAI,UAAU;AACZ,eAAO,QAAQ,MAAM,aACnB;AAAA,MACJ,OAAO;AACL,eAAO,QAAQ,MAAM,aAAa;AAAA,MACpC;AACA,mBAAa,OAAO,WAAW,iCAAQ,QAAQ,YAAY;AAAA,IAC7D;AAAA,EACF,GAAG,CAAC,OAAO,WAAW,UAAU,MAAM,CAAC;AAEvC,MAAI,CAAC,UAAU;AACb,WAAO;AAAA,EACT;AAEA,SACE,gBAAAlB,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,MAAM,IAAI,MAAM,OAAO,kBAAkB,KACxE,gBAAAA,QAAA,cAAC,gBAAa,QAAQ,IAAI,OAAO,IAAI,GACrC,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,UAAU,KAAG,cACjC,kBAAkB,WAAW,QAAQ,QAClD,CACF;AAEJ;;;AHvdO,IAAM,UAAU,MAAM;AArB7B,MAAAmB,KAAAC,KAAA;AAsBE,QAAM,WAAWC,cAAYC,kBAAiB;AAC9C,QAAM,cAAcD,cAAYE,kBAAiB;AACjD,QAAM,QAAQF,cAAYG,6BAA4B;AACtD,QAAM,CAAC,oBAAoB,qBAAqB,IAAIC,WAAS,CAAC;AAE9D,QAAM,gBAAgBC;AAAA,IACpB,CAAC,YAAoB,aAAsB;AACzC,YAAM,aAAa,WAAW,SAAS,KAAK,WAAW,MAAM,GAAG,EAAE,IAAI,QAAQ;AAC9E,aAAO,cAAc,aAAa,cAAc,WAAW;AAAA,IAC7D;AAAA,IACA,CAAC,WAAW;AAAA,EACd;AAEA,EAAAC,YAAU,MAAM;AACd,UAAM,YAAY,WAAW,MAAM;AACjC,4BAAsB,KAAK;AAAA,IAC7B,GAAG,GAAG;AACN,WAAO,MAAM,aAAa,SAAS;AAAA,EACrC,GAAG,CAAC,KAAK,CAAC;AAEV,QAAM,wBAAwBN,cAAYO,uEAA2D,CAAC;AACtG,QAAM,mBAAmBC,SAAQ,MAAM;AACrC,UAAM,0BAA0B,IAAI,IAAI,yBAAyB,CAAC,CAAC;AACnE,YAAO,qCAAU,OAAO,aAAW,QAAQ,SAAS,UAAU,CAAC,wBAAwB,IAAI,QAAQ,EAAE,OAAM,CAAC;AAAA,EAC9G,GAAG,CAAC,uBAAuB,QAAQ,CAAC;AACpC,QAAM,EAAE,SAAS,gBAAgB,MAAM,WAAW,qBAAqB,GAAG,IACxER,cAAYO,gDAA+C,CAAC,KAAK,CAAC;AACpE,QAAM,yBAAyB,qBAAqB,EAAE,OAAO,KAAK,CAAC;AACnE,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,wBAAsBT,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,wBAAuB;AACnE,QAAM,sBACJ,CAAC,GAACC,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,wBAClB,CAAC,GAAC,gDAAU,SAAV,mBAAgB,oBAAhB,mBAAiC,WACnC,CAAC,GAAC,0CAAU,SAAV,mBAAgB;AAEpB,QAAM,gBAAgBM,cAAY,MAAM;AACtC,QAAI;AAAwB,aAAO;AACnC,QAAI,CAAC;AACH,aAAO,2BACL,mBAAmB,WAAW,cAAc,QAAQ,yDAAoB,QAC1E;AACF,WAAO;AAAA,EACT,GAAG;AAAA,IACD,mBAAmB;AAAA,IACnB,yDAAoB;AAAA,IACpB;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AAED,SACE,gBAAAI,QAAA,cAAC,SAAI,OAAO,EAAE,QAAQ,OAAO,KAC3B,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,IAAG;AAAA,MACH,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,WAAW;AAAA;AAAA,QAEX,GAAG,sBAAsB,sBAAsB;AAAA,QAC/C,UAAU;AAAA,MACZ;AAAA;AAAA,IAEC,qBACC,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,IAAG;AAAA,QACH,OAAO;AAAA,UACL,UAAU;AAAA,UACV,QAAQ;AAAA,UACR,OAAO;AAAA,QACT;AAAA;AAAA,MAEA,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,SAAQ;AAAA,UACR,KAAK,EAAE,QAAQ,UAAU;AAAA,UACzB,OAAO,EAAE,OAAO,SAAS,YAAY,QAAQ,SAAS,OAAO,cAAc,MAAM;AAAA;AAAA,QAEhF,uBAAuB,IAAI,gBAAgB,GAAG,kBAAkB;AAAA,MACnE;AAAA,IACF,IAEA;AAAA,IAED,iBAAiB,WAAW,IAC3B,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAO;AAAA,UACL,SAAS;AAAA,UACT,eAAe;AAAA,UACf,QAAQ;AAAA,UACR,OAAO;AAAA,UACP,YAAY;AAAA,UACZ,gBAAgB;AAAA,QAClB;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,GAAG,mBAAmB,KACvD,sBAAsB,yBAAyB,iBAClD;AAAA,MACC,sBACC,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,OAAO,EAAE,UAAU,OAAO,WAAW,UAAU,WAAW,MAAM,KAAG,4EAEtF,IAEA;AAAA,IAEJ,IAEA,iBAAiB,IAAI,aACnB,gBAAAA,QAAA,cAAC,OAAI,WAAU,eAAc,KAAK,QAAQ,IAAI,IAAI,QAAQ,IAAI,OAAO,EAAE,SAAS,cAAc,KAC5F,gBAAAA,QAAA,cAAC,QAAK,OAAO,EAAE,OAAO,QAAQ,YAAY,UAAU,gBAAgB,UAAU,KAC5E,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAO,EAAE,SAAS,QAAQ,gBAAgB,WAAW,OAAO,QAAQ,YAAY,SAAS;AAAA,QACzF,KAAK;AAAA,UACH,OAAO;AAAA,UACP,YAAY;AAAA,QACd;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,QAAK,OAAO,EAAE,UAAU,GAAG,KAAK,OAAO,YAAY,SAAS,KAC1D,QAAQ,eAAe,SAAS,CAAC,QAAQ,aACxC,gBAAAA,QAAA,cAAC,QAAK,IAAG,QAAO,SAAQ,QAAO,KAAK,EAAE,OAAO,oBAAoB,YAAY,YAAY,KACtF,QAAQ,cAAc,WACzB,IAEA,gBAAAA,QAAA,cAAC,WAAQ,OAAO,QAAQ,YAAY,MAAK,OAAM,OAAM,WACnD,gBAAAA,QAAA,cAAC,QAAK,IAAG,QAAO,SAAQ,QAAO,KAAK,EAAE,OAAO,oBAAoB,YAAY,YAAY,KACtF,cAAc,QAAQ,YAAY,mCAAS,MAAM,CACpD,CACF,GAEF,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC;AAAA,UACA,eAAe,QAAQ;AAAA,UACvB,gBAAgB,QAAQ;AAAA;AAAA,MAC1B,CACF;AAAA,MAEA,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,SAAQ;AAAA,UACR,KAAK;AAAA,YACH,OAAO;AAAA,YACP,YAAY;AAAA,YACZ,GAAG;AAAA,YACH,YAAY;AAAA,UACd;AAAA;AAAA,QAECC,YAAW,QAAQ,IAAI;AAAA,MAC1B;AAAA,IACF,CACF,GACA,gBAAAD,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,GAAG;AAAA,UACH,IAAI;AAAA,UACJ,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,YAAY;AAAA,UACZ,OAAO;AAAA,QACT;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,oBAAiB,SAAS,QAAQ,SAAS;AAAA,IAC9C,CACF,CACD;AAAA,IAEH,gBAAAA,QAAA,cAAC,SAAI,IAAG,UAAS,OAAO,EAAE,QAAQ,iBAAiB,SAAS,QAAQ,EAAE,GAAG;AAAA,EAC3E,GACC,uBACC,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,IAAI,eAAe,KAC7B,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,IAAI,MAAM,IAAI,OAAO,KAAK,MAAM,YAAY,SAAS,KAChE,gBAAAA,QAAA,cAAC,QAAK,SAAQ,aAAU,KAAG,GAC3B,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,IAAI,mBAAmB,OAAO,oBAAoB,GAAG,KAAK,KACrE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,IAAG;AAAA,MACH,OAAO;AAAA,QACL,YAAY;AAAA,QACZ,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,SAAS;AAAA,QACT,cAAc;AAAA,QACd,SAAS;AAAA,MACX;AAAA,MACA,gBAAc,cAAS,SAAT,mBAAe,uBAAsB,cAAa,oBAAS,SAAT,mBAAe,oBAAf,mBAAiC;AAAA;AAAA,KAEhG,oBAAS,SAAT,mBAAe,oBAAf,mBAAgC,IAAI,UACnC,gBAAAA,QAAA,cAAC,YAAO,KAAK,MAAM,OAAO,QACvB,IACH;AAAA,MAED,cAAS,SAAT,mBAAe,uBAAsB,gBAAAA,QAAA,cAAC,YAAO,OAAM,cAAW,UAAQ,IAAY;AAAA,EACrF,CACF,CACF,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,WAAW;AAAA,QACX,OAAO;AAAA,QACP,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,WAAW;AAAA,QACX,KAAK;AAAA,QACL,GAAG;AAAA,MACL;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,IAAG;AAAA,QACH,WAAW;AAAA,QACX,UAAU,CAAC,iBAAiB;AAAA,QAC5B,MAAM;AAAA,QACN,KAAK;AAAA,UACH,GAAG;AAAA,UACH,GAAG;AAAA,UACH,GAAG;AAAA,UACH,QAAQ;AAAA,UACR,QAAQ;AAAA,QACV;AAAA,QACA,aAAa,cAAc;AAAA,QAC3B,UAAQ;AAAA,QACR,cAAa;AAAA,QACb,qBAAkB;AAAA;AAAA,IACpB;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,IAAG;AAAA,QACH,UAAU,CAAC,iBAAiB;AAAA,QAC5B,OAAO,cAAc;AAAA,QACrB,KAAK;AAAA,UACH,IAAI;AAAA,UACJ,QAAQ;AAAA,UACR,IAAI;AAAA,UACJ,WAAW,EAAE,GAAG,qBAAqB;AAAA,QACvC;AAAA,QACA,eAAY;AAAA;AAAA,MAEZ,gBAAAA,QAAA,cAAC,cAAS;AAAA,IACZ;AAAA,EACF,CACF,CAEJ;AAEJ;AAEA,IAAM,eAAe,CAAC;AAAA,EACpB;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,WAAWT,cAAYW,oBAAmB,aAAa,CAAC;AAE9D,SACE,gBAAAF,QAAA,cAAAA,QAAA,gBACG,iBACC,gBAAAA,QAAA,cAAC,QAAK,IAAG,QAAO,SAAQ,QAAO,KAAK,EAAE,OAAO,oBAAoB,YAAY,YAAY,KAAG,OACtF,gBAAe,UACrB,IACE,MACH,gBACC,gBAAAA,QAAA,cAAC,QAAK,IAAG,QAAO,SAAQ,QAAO,KAAK,EAAE,OAAO,oBAAoB,YAAY,YAAY,KAAG,OACtF,kBAAkB,cAAc,QAAQ,UAAS,OACvD,IACE,IACN;AAEJ;;;AWnSA;AAAA,OAAOG,aAAW;AAClB,SAAS,wBAAwB;AAI1B,IAAM,gBAAgB,CAAC,EAAE,UAAU,YAAY,MAAsD;AAC1G,MAAI,CAAC,aAAa;AAChB,WAAO,gBAAAC,QAAA,cAAAA,QAAA,cAAE;AAAA,EACX;AACA,SACE,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,SAAS,UAAU,eAAY,kBAC5C,gBAAAA,QAAA,cAAC,sBAAiB,GAClB,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,OAAO,mBAAmB,KAAG,cAEjE,CACF;AAEJ;;;ACjBA;AACA,SAAS,oBAAoB;AAOtB,IAAM,YAAY,CAAC,EAAE,WAAW,SAAS,MAAsB;AACpE,YAAU,SAAS,KAAK,MAAM,SAAS;AACvC,YAAU,SAAS,KAAK,MAAM,WAAW;AACzC,SAAO,aAAa,UAAU,UAAU,SAAS,IAAI;AACvD;;;ACZA;AAAA,OAAOC,WAAS,UAAAC,UAAQ,YAAAC,kBAAgB;AACxC,SAAS,YAAAC,iBAAgB;AACzB,SAAkB,4BAAAC,2BAA0B,gBAAgB,iBAAAC,iBAAe,eAAAC,qBAAmB;AAC9F,SAAS,mBAAAC,kBAAiB,iBAAAC,gBAAe,aAAAC,kBAAiB;AAU1D,IAAM,gBAAgB,CAAC,EAAE,MAAM,MAAqC;AAClE,SAAO,QACL,gBAAAC,QAAA,cAAC,WAAQ,MAAK,OAAM,OAAO,SACzB,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,OAAO;AAAA,QACP,YAAY;AAAA,MACd;AAAA;AAAA,IACD;AAAA,IACG,MAAM,MAAM,GAAG,GAAG;AAAA,IACnB,MAAM,SAAS,MAAM,QAAQ;AAAA,IAAG;AAAA,EACnC,CACF,IAEA,gBAAAA,QAAA,cAAAA,QAAA,cAAE;AAEN;AAEA,IAAM,oBAAoB,CAAC;AAAA,EACzB;AAAA,EACA;AAAA,EACA,WAAW;AACb,MAIM;AAxCN,MAAAC;AAyCE,QAAM,QAAQC,cAAYC,yBAAwB,EAAE;AAAA,IAClD,UAAQ,UAAS,6BAAM,aAAY,SAAS;AAAA,EAC9C;AACA,QAAM,CAAC,cAAc,OAAO,IAAIC,aAASH,MAAA,MAAM,OAAO,UAAQ,UAAS,6BAAM,SAAQ,MAA5C,gBAAAA,IAAgD,QAAM,6BAAM,SAAQ;AAC7G,QAAM,aAAaI,gBAAc;AACjC,QAAM,CAAC,MAAM,OAAO,IAAID,WAAS,KAAK;AACtC,QAAM,aAAaE,SAAsC;AAEzD,SACE,gBAAAN,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,WAAU,KAAK,EAAE,GAAG,OAAO,KACtD,gBAAAA,QAAA,cAAC,QAAK,IAAG,MAAK,SAAQ,QAAK,aAE3B,GACC,YAAY,gBAAAA,QAAA,cAACO,YAAA,EAAU,SAAS,MAAM,aAAa,KAAK,GAAG,CAC9D,GAEA,gBAAAP,QAAA,cAAC,WACC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,GAAG;AAAA,QACH,SAAS;AAAA,QACT,UAAU;AAAA,QACV,WAAW;AAAA,MACb;AAAA;AAAA,IACD;AAAA,IAEC,gBAAAA,QAAA,cAAC,iBAAc,OAAO,KAAK,MAAM;AAAA,IAAE;AAAA,IAC9B,gBAAAA,QAAA,cAAC,iBAAc,OAAO,KAAK,UAAU;AAAA,IAAE;AAAA,EAC9C,CACF,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,GAAG;AAAA,QACH,IAAI;AAAA,MACN;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,UAAU;AAAA,UACV,MAAM;AAAA,UACN,UAAU;AAAA,QACZ;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,MAAY,cAAc,SAAS,KAAK,EAAE,OAAO,OAAO,KACrE,gBAAAA,QAAA;AAAA,QAAC,SAAS;AAAA,QAAT;AAAA,UAEC,KAAK;AAAA,UACL,eAAY;AAAA,UACZ,SAAO;AAAA,UACP,KAAK;AAAA,YACH,IAAI;AAAA,YACJ,GAAG;AAAA,YACH,GAAG;AAAA,UACL;AAAA;AAAA,QAEA,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,WAAU,KAAK,EAAE,OAAO,OAAO,KAC1D,gBAAAA,QAAA,cAAC,YAAM,YAAa,GACnB,OAAO,gBAAAA,QAAA,cAACQ,gBAAA,IAAc,IAAK,gBAAAR,QAAA,cAACS,kBAAA,IAAgB,CAC/C;AAAA,MACF,GAEA,gBAAAT,QAAA,cAAC,SAAS,SAAT,EAAiB,OAAM,SAAQ,YAAY,GAAG,KAAK,EAAE,QAAQ,KAAM,GAAG,OAAO,KAC3E,MAAM,IAAI,UAAK;AA5G9B,YAAAC;AA6GgB,+BAAAD,QAAA;AAAA,UAAC,SAAS;AAAA,UAAT;AAAA,YACC,eAAa;AAAA,YACb,KAAK;AAAA,YACL,UAAU,MAAM,QAAQ,IAAI;AAAA,YAC5B,KAAK,EAAE,GAAG,IAAGC,MAAA,WAAW,YAAX,gBAAAA,IAAoB,WAAW,KAAK;AAAA;AAAA,UAEhD;AAAA,QACH;AAAA,OACD,CACH,CACF;AAAA,IACF;AAAA,EACF,GACA,gBAAAD,QAAA,cAAC,QAAK,SAAQ,UAAS,OAAM,UAAS,KAAK,EAAE,OAAO,QAAQ,KAAK,MAAM,KACpE,CAAC,YACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,UAAQ;AAAA,MACR,KAAK,EAAE,OAAO,OAAO;AAAA,MACrB,SAAS,MAAM,aAAa,KAAK;AAAA,MACjC,eAAY;AAAA;AAAA,IACb;AAAA,EAED,GAGF,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,eAAY;AAAA,MACZ,SAAQ;AAAA,MACR,KAAK,EAAE,OAAO,OAAO;AAAA,MACrB,SAAS,MAAY;AACnB,YAAI,cAAc;AAChB,gBAAM,WAAW,iBAAiB,KAAK,IAAI,cAAc,IAAI;AAC7D,uBAAa,KAAK;AAAA,QACpB;AAAA,MACF;AAAA;AAAA,IACD;AAAA,EAED,CACF,CACF;AAEJ;AAEO,IAAM,kBAAkB,CAAC;AAAA,EAC9B;AAAA,EACA;AACF,MAGM;AACJ,QAAM,OAAOE,cAAY,eAAe,MAAM,CAAC;AAC/C,QAAM,WAAWQ,UAAS,OAAU,MAAM,EAAE;AAE5C,MAAI,CAAC,MAAM;AACT,WAAO;AAAA,EACT;AAEA,MAAI,UAAU;AACZ,WACE,gBAAAV,QAAA,cAAC,MAAM,MAAN,EAAW,MAAM,MAAM,cAA4B,KAAK,EAAE,cAAc,YAAY,KACnF,gBAAAA,QAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,GAAG,UAAU,YAAY,gBAAgB,QAAQ,4BAA4B,KACjG,gBAAAA,QAAA,cAAC,qBAAkB,MAAY,cAA4B,UAAQ,MAAC,CACtE,CACF;AAAA,EAEJ;AAEA,SACE,gBAAAA,QAAA,cAAC,OAAO,MAAP,EAAY,aAAW,MAAC,gBACvB,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA,cAAC,OAAO,SAAP,EAAe,KAAK,EAAE,OAAO,kBAAkB,GAAG,OAAO,UAAU,UAAU,KAC5E,gBAAAA,QAAA,cAAC,qBAAkB,MAAY,cAA4B,CAC7D,CACF,CACF;AAEJ;;;AC3LA;AAAA,OAAOW,WAAS,YAAAC,kBAAgB;AAChC,SAAS,qBAAAC,oBAAmB,iBAAAC,iBAAe,eAAAC,eAAa,yBAAAC,8BAA6B;AACrF,SAAS,qBAAAC,0BAAyB;;;ACFlC;AAAA,OAAOC,WAAS,eAAAC,eAAa,YAAAC,kBAAgB;AAC7C,SAAS,gBAAgB;;;ACDzB;AAAA,OAAOC,WAAS,UAAAC,gBAAc;AAC9B,SAAS,aAAAC,YAAW,iBAAiB,aAAAC,kBAAiB;AAc/C,IAAM,gBAAgB,CAACC,QAA6E;AAA7E,MAAAC,MAAAD,KAAE,QAAAE,OAAM,OAAO,YAAY,MAAM,UAAU,KAAAC,MAAK,UAAU,CAAC,EAfzF,IAe8BF,KAAiE,kBAAjEA,KAAiE,CAA/D,QAAM,SAAO,aAAkB,YAAU,OAAK;AAC5E,SACE,gBAAAG,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA,cAAC,OAAO,SAAP,iBAAe,KAAK,iBAAE,OAAO,sBAAuBD,SAAW,QAC9D,gBAAAC,QAAA,cAAC,OAAO,OAAP,MACC,gBAAAA,QAAA,cAAC,QAAK,SAAQ,aACZ,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,IAAI,KAAK,KAClCF,QACC,gBAAAE,QAAA,cAAC,QAAK,KAAK,gCAAE,IAAI,MAAM,OAAO,sBAAuB,aAAe,YAClE,gBAAAA,QAAA,cAACF,OAAA,IAAK,CACR,IACE,MACJ,gBAAAE,QAAA,cAAC,QAAK,SAAQ,MAAK,QAAM,QACtB,KACH,CACF,GACC,aAAa,gBAAAA,QAAA,cAAC,OAAO,cAAP,EAAoB,eAAY,sBAAqB,CACtE,CACF,GACA,gBAAAA,QAAA,cAAC,qBAAkB,KAAK,EAAE,IAAI,SAAS,GAAG,GAC1C,gBAAAA,QAAA,cAAC,WAAK,QAAS,CACjB,CACF;AAEJ;AAEO,IAAM,cAAc,CAACJ,QAA6D;AAA7D,MAAAC,MAAAD,KAAE,SAAO,MAAM,cAAc,OAAO,SA1ChE,IA0C4BC,KAAiD,kBAAjDA,KAAiD,CAA/C,QAAa,gBAAc,SAAO;AAC9D,SACE,gBAAAG,QAAA,cAAC,OAAO,MAAP,EAAY,MAAY,gBACvB,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAMC;AAAA,MACN;AAAA,MACA,mBAAmB,OAAK,EAAE,eAAe;AAAA,MACzC,iBAAiB,OAAK,EAAE,eAAe;AAAA,MACvC,sBAAsB,OAAK,EAAE,eAAe;AAAA,MAC5C,WAAW;AAAA,MACX,SAAS,EAAE,OAAO,uBAAuB;AAAA,OACrC;AAAA,IAEJ,gBAAAD,QAAA,cAAC,OAAI,KAAK,EAAE,IAAI,MAAM,KAAI,QAAS;AAAA,EACrC,CACF;AAEJ;AAEO,IAAM,gBAAgB,CAAC,EAAE,OAAO,MAAM,cAAc,OAAO,MAAM,aAAa,UAAU,UAAU,MAAAF,MAAK,MAC5G,gBAAAE,QAAA,cAAC,OAAO,MAAP,EAAY,MAAY,gBACvB,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA,cAAC,OAAO,SAAP,EAAe,KAAK,EAAE,OAAO,kBAAkB,GAAG,MAAM,KACvD,gBAAAA,QAAA,cAAC,OAAO,OAAP,EAAa,KAAK,EAAE,GAAG,GAAG,SAAS,QAAQ,eAAe,OAAO,KAAK,MAAM,KAC1EF,QAAOA,QAAO,MACf,gBAAAE,QAAA,cAAC,QAAK,SAAQ,QAAM,KAAM,CAC5B,GACC,OAAO,SAAS,WACf,gBAAAA,QAAA;AAAA,EAAC;AAAA;AAAA,IACC,SAAQ;AAAA,IACR,KAAK;AAAA,MACH,YAAY;AAAA,MACZ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,GAAG;AAAA,IACL;AAAA;AAAA,EAEC;AACH,IAEA,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,IAAI,MAAM,IAAI,MAAM,KAAI,IAAK,GAE3C,gBAAAA,QAAA,cAAC,QAAK,SAAQ,UAAS,OAAM,UAAS,KAAK,EAAE,OAAO,QAAQ,KAAK,MAAM,KACrE,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,OAAO,MAAM,KACvB,gBAAAA,QAAA,cAAC,OAAO,OAAP,EAAa,KAAK,EAAE,OAAO,OAAO,KACjC,gBAAAA,QAAA,cAAC,UAAO,SAAQ,YAAW,UAAQ,MAAC,KAAK,EAAE,OAAO,OAAO,KAAG,QAE5D,CACF,CACF,GACA,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,OAAO,MAAM,KACvB,gBAAAA,QAAA,cAAC,UAAO,SAAQ,WAAU,KAAK,EAAE,OAAO,OAAO,GAAG,SAAS,YACxD,UACH,CACF,CACF,CACF,CACF,CACF;AAOK,IAAM,YAAY,CAAC,EAAE,UAAU,UAAU,OAAO,KAAAD,MAAK,UAAU,UAAU,MAAM;AACpF,MAAI,WAAW;AAAA,IACb,QAAQ;AAAA,IACR,GAAG;AAAA,EACL;AACA,MAAI,SAAS;AACX,aAAS,KAAK,IAAI;AAAA,MAChB,eAAe;AAAA,MACf,YAAY;AAAA,IACd;AAAA,EACF;AACA,MAAIA,MAAK;AACP,eAAW,OAAO,OAAO,UAAUA,IAAG;AAAA,EACxC;AACA,SACE,gBAAAC,QAAA,cAAC,QAAK,OAAM,UAAS,SAAkB,KAAK,YACzC,QACH;AAEJ;AAEO,IAAM,YAAY,CAACJ,QAAwF;AAAxF,MAAAC,MAAAD,KAAE,YAAU,UAAU,OAAO,KAAAG,MAAK,QAAQ,UAAU,UAAU,UAjIxF,IAiI0BF,KAA4E,kBAA5EA,KAA4E,CAA1E,YAAU,WAAiB,OAAK,SAAkB;AAC5E,MAAI,WAAW;AAAA,IACb,QAAQ;AAAA,IACR,GAAG;AAAA,EACL;AACA,MAAI,SAAS;AACX,aAAS,KAAK,IAAI;AAAA,MAChB,YAAY;AAAA,IACd;AAAA,EACF;AACA,MAAIE,MAAK;AACP,eAAW,OAAO,OAAO,UAAUA,IAAG;AAAA,EACxC;AACA,SACE,gBAAAC,QAAA,cAAC,uBAAK,WAAU,UAAS,OAAc,SAAkB,KAAK,YAAc,QACzE,QACH;AAEJ;AAKO,IAAM,eAAe,CAACJ,QAA2E;AAA3E,MAAAC,MAAAD,KAAE,SAAO,SAAS,UAAU,YAAY,UAAU,SAxJ/E,IAwJ6BC,KAA+D,kBAA/DA,KAA+D,CAA7D,SAAO,WAAS,YAAU,cAAY,YAAU;AAC7E,SACE,gBAAAG,QAAA,cAAC,aAAU,SAAO,QAChB,gBAAAA,QAAA,cAACE,QAAA,MAAO,KAAM,GACd,gBAAAF,QAAA,cAAC,OAAO,MAAP,iBAAY,eAAa,iBAAiB,KAAK,IAAI,KAAK,EAAE,OAAO,OAAO,OAAO,EAAE,OAAO,OAAO,EAAE,KAAO,QACvG,gBAAAA,QAAA,cAAC,OAAO,iBAAP,IAAuB,GACxB,gBAAAA,QAAA,cAAC,OAAO,QAAP,EAAc,UAAU,OAAK,SAAS,EAAE,OAAO,KAAK,GAAG,OAAO,UAAU,KAAK,EAAE,OAAO,OAAO,KAC3F,QAAQ,IAAI,YAAU;AACrB,UAAM,KAAK,WAAW,OAAO,QAAQ,IAAI;AACzC,UAAM,QAAQ,aAAa,OAAO,UAAU,IAAI;AAChD,WACE,gBAAAA,QAAA,cAAC,YAAO,OAAO,IAAI,KAAK,MACrB,KACH;AAAA,EAEJ,CAAC,CACH,CACF,CACF;AAEJ;AAmBO,IAAM,kBAAkB,CAACG,QAA+D;AAA/D,MAAAC,MAAAD,KAAE,SAAO,UAAU,aAAa,UAAU,KA/L1E,IA+LgCC,KAAmD,kBAAnDA,KAAmD,CAAjD,SAAO,YAAU,eAAa,YAAU;AACxE,QAAM,WAAWC,SAAO;AACxB,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAO;AAAA,MACP,SAAS,MAAG;AApMlB,YAAAH;AAoMqB,gBAAAA,MAAA,SAAS,YAAT,gBAAAA,IAAkB;AAAA;AAAA,MACjC,KAAK;AAAA,QACH,gBAAgB;AAAA,QAChB,UAAU;AAAA,QACV,QAAQ;AAAA,QACR,IAAI;AAAA,QACJ,QAAQ;AAAA,QACR,GAAG;AAAA,QACH,QAAQ;AAAA,QACR,YAAY;AAAA,QACZ,GAAG;AAAA,MACL;AAAA,MACA,KAAI;AAAA;AAAA,IAEJ,gBAAAG,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,QAAQ;AAAA,UACR,YAAY;AAAA,UACZ,WAAW;AAAA,YACT,QAAQ;AAAA,YACR,YAAY;AAAA,YACZ,IAAI;AAAA,UACN;AAAA,QACF;AAAA;AAAA,MAEA,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAO;AAAA,YACL,OAAO;AAAA,YACP,QAAQ;AAAA,UACV;AAAA;AAAA,MACF;AAAA,IACF;AAAA,IACA,gBAAAA,QAAA,cAAC,QAAK,WAAU,SACd,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,QACL,KAAK,EAAE,OAAO,OAAO,OAAO,EAAE,OAAO,OAAO,EAAE;AAAA,QAC9C;AAAA,QACA,UAAU,OAAK,SAAS,EAAE,MAAM;AAAA,QAChC;AAAA,QACA;AAAA,QACA;AAAA,QACA,QAAQ;AAAA,SACJ;AAAA,IACN,GACA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,YAAY;AAAA,UACZ,QAAQ;AAAA,UACR,gBAAgB;AAAA,UAChB,WAAW;AAAA,YACT,YAAY;AAAA,YACZ,QAAQ;AAAA,UACV;AAAA,QACF;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAM,WAAY;AAAA,IAClC,CACF;AAAA,EACF;AAEJ;;;ADxPO,IAAM,kBAAkB,CAAC,EAAE,oBAAoB,UAAU,aAAa,KAAAC,MAAK,OAAO,MAAM;AAC7F,QAAM,CAAC,YAAY,aAAa,IAAIC,WAAS,8BAA8B;AAE3E,QAAM,0BAA0BC;AAAA,IAC9B,WAAS;AACP,YAAM,EAAE,MAAM,MAAM,IAAI,MAAM;AAC9B,UAAI,QAAQ,SAAS,aAAa,OAAO,KAAK,IAAI,WAAW;AAC7D,UAAI,SAAS,SAAS,cAAc,OAAO,KAAK,IAAI,WAAW;AAE/D,UAAI,UAAU,GAAG;AACf,gBAAQ;AAAA,MACV;AACA,UAAI,WAAW,GAAG;AAChB,iBAAS;AAAA,MACX;AACA,YAAM,gBAAgB;AAAA,QACpB,OAAO,CAAC,MAAM,KAAK,IAAI,QAAQ,+BAA+B;AAAA,QAC9D,QAAQ,CAAC,MAAM,MAAM,IAAI,SAAS,+BAA+B;AAAA,MACnE;AACA,oBAAc,aAAa;AAAA,IAC7B;AAAA,IACA,CAAC,UAAU;AAAA,EACb;AAEA,SACE,gBAAAC,QAAA,cAAC,aAAU,SAAO,MAAC,KAAKH,QACtB,gBAAAG,QAAA,cAAC,QAAK,KAAK,KACT,gBAAAA,QAAA,cAACC,QAAA,EAAM,KAAK,EAAE,IAAI,KAAK,KAAG,YAAU,GACnC,eACC,gBAAAD,QAAA,cAAC,WAAQ,OAAO,eACd,gBAAAA,QAAA,cAAC,aACC,gBAAAA,QAAA,cAAC,YAAS,OAAM,WAAU,CAC5B,CACF,CAEJ,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK,EAAE,OAAO,CAAC,cAAc,SAAS,OAAO,OAAO,EAAE,OAAO,OAAO,EAAE;AAAA,MACtE,KAAK;AAAA,MACL,WAAU;AAAA;AAAA,IAEV,gBAAAA,QAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,KAC3B,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,OAAO,MAAM,KAC3C,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAK,OAAK,GACxB,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,eAAa,GAAG,MAAM;AAAA,QACtB,KAAK,EAAE,OAAO,QAAQ,IAAI,KAAK;AAAA,QAC/B,MAAK;AAAA,QACL,OAAO,WAAW;AAAA,QAClB,UAAU;AAAA,QACV,UAAU;AAAA,QACV,KAAK;AAAA,QACL,KAAK;AAAA,QACL,QAAQ,MAAM,mBAAmB,UAAU;AAAA,QAC3C,MAAK;AAAA;AAAA,IACP,CACF,GACA,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,OAAO,MAAM,KAC3C,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAK,QAAM,GACzB,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,eAAa,GAAG,MAAM;AAAA,QACtB,KAAK,EAAE,OAAO,QAAQ,IAAI,KAAK;AAAA,QAC/B,MAAK;AAAA,QACL,OAAO,WAAW;AAAA,QAClB,UAAU;AAAA,QACV,QAAQ,MAAM,mBAAmB,UAAU;AAAA,QAC3C,UAAU;AAAA,QACV,KAAK;AAAA,QACL,KAAK;AAAA,QACL,MAAK;AAAA;AAAA,IACP,CACF,CACF;AAAA,EACF,CACF;AAEJ;;;AD9EA,IAAM,iBAAiB,CAAC,EAAE,MAAM,aAAa,MAAM;AACjD,QAAM,cAAcE,cAAYC,kBAAiB;AACjD,QAAM,CAAC,YAAY,aAAa,IAAIC,WAAS,8BAA8B;AAC3E,QAAM,EAAE,gBAAgB,iBAAiB,IAAI,oBAAoB;AACjE,QAAM,EAAE,sBAAsB,eAAe,aAAa,IAAIC,uBAAsB;AACpF,QAAM,aAAaC,gBAAc;AACjC,MAAI,EAAC,2CAAa,qBAAoB,cAAc;AAClD,WAAO;AAAA,EACT;AACA,MAAI,sBAAsB;AACxB,WACE,gBAAAC,QAAA,cAAC,OAAO,MAAP,EAAY,MAAY,gBACvB,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA;AAAA,MAAC,OAAO;AAAA,MAAP;AAAA,QACC,KAAK;AAAA,UACH,OAAO;AAAA,UACP,GAAG;AAAA,UACH,IAAI;AAAA,QACN;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,OAAO,OAAP,MACC,gBAAAA,QAAA,cAAC,QAAK,KAAK,GAAG,KAAK,EAAE,GAAG,uBAAuB,KAC7C,gBAAAA,QAAA,cAACC,oBAAA,IAAkB,GACnB,gBAAAD,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,UAAU,GAAG,SAAQ,QAAK,eAE1C,CACF,CACF;AAAA,MACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,sBAAsB,IAAI,KAAK,KAAG,0EAE/D;AAAA,MACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,OAAM,KAAK,EAAE,IAAI,MAAM,KACnC,gBAAAA,QAAA,cAAC,OAAO,OAAP,EAAa,SAAO,QACnB,gBAAAA,QAAA,cAAC,UAAO,UAAQ,MAAC,KAAK,EAAE,aAAa,qBAAqB,IAAI,KAAK,KAAG,WAEtE,CACF,GACA,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,eAAY;AAAA,UACZ,SAAQ;AAAA,UACR,MAAI;AAAA,UACJ,SAAS,MAAY;AACnB,gBAAI;AACF,oBAAM,WAAW,qBAAqB;AAAA,YACxC,SAAS,OAAO;AACd,2BAAa,SAAS;AAAA,gBACpB,OAAO,MAAM;AAAA,gBACb,SAAS;AAAA,cACX,CAAC;AAAA,YACH;AACA,yBAAa,KAAK;AAAA,UACpB;AAAA;AAAA,QACD;AAAA,MAED,CACF;AAAA,IACF,CACF,CACF;AAAA,EAEJ;AACA,SACE,gBAAAA,QAAA,cAAC,OAAO,MAAP,EAAY,MAAY,gBACvB,gBAAAA,QAAA,cAAC,OAAO,SAAP,EAAe,KAAK,EAAE,OAAO,kBAAkB,GAAG,MAAM,KACvD,gBAAAA,QAAA,cAAC,OAAO,OAAP,MACC,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAK,iBAAe,CACpC,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,QAAO;AAAA,MACP,KAAK,EAAE,eAAe,UAAU,YAAY,QAAQ;AAAA,MACpD,oBAAoB;AAAA;AAAA,EACtB,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,eAAY;AAAA,MACZ,SAAQ;AAAA,MACR,MAAI;AAAA,MACJ,KAAK,EAAE,IAAI,OAAO;AAAA,MAClB,MAAK;AAAA,MACL,UAAU,oBAAoB;AAAA,MAC9B,SAAS,MAAY;AACnB,cAAM,eAAe,UAAU;AAC/B,qBAAa,KAAK;AAAA,MACpB;AAAA;AAAA,IACD;AAAA,EAED,CACF,CACF;AAEJ;AAEA,IAAO,yBAAQ;;;AGpGf;AAAA,OAAOE,WAAS,aAAAC,aAAW,WAAAC,UAAS,UAAAC,UAAQ,YAAAC,kBAAgB;AAC5D,SAAS,SAAAC,QAAO,KAAAC,UAAS;AACzB;AAAA,EACE,kBAAAC;AAAA,EACA,qBAAAC;AAAA,EACA;AAAA,EACA,mBAAAC;AAAA,EACA,oBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AAcA,IAAM,gBAAgB,CAAC,EAAE,aAAa,MAAM;AAvBnD,MAAAC;AAwBE,QAAM,mBAAmB,mBAAmB;AAC5C,QAAM,eAAeC;AAAA,IACnB,MAAM,CAAC,EAAE,IAAI,cAAc,OAAO,mBAAmB,GAAG,GAAG,gBAAgB;AAAA,IAC3E,CAAC,gBAAgB;AAAA,EACnB;AACA,QAAM,CAAC,cAAc,eAAe,IAAIC,WAAS,aAAa,CAAC,CAAC;AAChE,QAAM,CAAC,kBAAkB,mBAAmB,IAAI,iBAAiB,YAAY,gBAAgB;AAC7F,QAAM,CAAC,MAAM,OAAO,IAAIA,WAAS,KAAK;AACtC,QAAM,MAAMC,SAAO;AACnB,QAAM,cAAc,qBAAqB;AAEzC,EAAAC,YAAU,MAAM;AACd,QAAI,aAAa,OAAO,gBAAgB,CAAC,iBAAiB,KAAK,WAAS,MAAM,OAAO,aAAa,EAAE,GAAG;AACrG,sBAAgB,YAAY;AAAA,IAC9B;AAAA,EACF,GAAG,CAAC,kBAAkB,YAAY,CAAC;AAEnC,SACE,gBAAAC,QAAA,cAAC,OAAO,MAAP,EAAY,aAAW,MAAC,gBACvB,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA;AAAA,IAAC,OAAO;AAAA,IAAP;AAAA,MACC,KAAK;AAAA,QACH,OAAO;AAAA,QACP,WAAW;AAAA,QACX,WAAW;AAAA,MACb;AAAA;AAAA,IAGA,gBAAAA,QAAA,cAAC,OAAO,OAAP,EAAa,KAAK,EAAE,GAAG,OAAO,KAC7B,gBAAAA,QAAA,cAAC,QAAK,SAAQ,aACZ,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,IAAI,KAAK,KACnC,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,QAAM,QAAC,iBAE1B,CACF,GACA,gBAAAA,QAAA,cAAC,OAAO,cAAP,EAAoB,eAAY,2BAA0B,CAC7D,CACF;AAAA,IACA,gBAAAA,QAAA,cAAC,qBAAkB,KAAK,EAAE,IAAI,SAAS,GAAG;AAAA,IAE1C,gBAAAA,QAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,GAAG,KAAK,EAAE,GAAG,QAAQ,KAC9C,gBAAAA,QAAA,cAAC,UAAO,SAAS,kBAAkB,iBAAiB,qBAAqB,GACzE,gBAAAA,QAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,YAAY,YAAY,KAAG,qBAExD,CACF;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,WAAU;AAAA,QACV,KAAK;AAAA,UACH,IAAI;AAAA,UACJ,UAAU;AAAA,UACV,UAAU;AAAA,QACZ;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAACC,QAAA,EAAM,SAAQ,SAAQ,KAAK,EAAE,GAAG,mBAAmB,KAAG,WAEvD;AAAA,MACA,gBAAAD,QAAA,cAAC,SAAS,MAAT,EAAc,eAAY,2BAA0B,MAAY,cAAc,WAC7E,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAO,aAAa,SAAS;AAAA,UAC7B,KAAK,EAAE,IAAI,KAAK;AAAA,UAChB,UAAU,EAAE,IAAI,EAAE;AAAA,UAClB;AAAA,UACA;AAAA;AAAA,MACF,GACA,gBAAAA,QAAA,cAAC,SAAS,QAAT,MACC,gBAAAA,QAAA,cAAC,SAAS,SAAT,EAAiB,OAAM,SAAQ,YAAY,GAAG,KAAK,EAAE,IAAGL,MAAA,IAAI,YAAJ,gBAAAA,IAAa,aAAa,QAAQ,IAAK,KAC7F,aAAa,IAAI,YAAU;AAC1B,cAAM,aAAa,OAAO,OAAO,aAAa,MAAM,OAAO,UAAU,aAAa;AAClF,eACE,gBAAAK,QAAA;AAAA,UAAC,SAAS;AAAA,UAAT;AAAA,YACC,KAAK,GAAG,OAAO,EAAE,IAAI,OAAO,SAAS,EAAE;AAAA,YACvC,SAAS,MAAM;AACb,8BAAgB,MAAM;AAAA,YACxB;AAAA,YACA,KAAK;AAAA,cACH,IAAI;AAAA,cACJ,IAAI,aAAa,cAAc;AAAA,cAC/B,GAAG,aAAa,qBAAqB;AAAA,YACvC;AAAA;AAAA,UAEC,OAAO;AAAA,QACV;AAAA,MAEJ,CAAC,CACH,CACF,CACF;AAAA,IACF;AAAA,IAEC,aAAa,OAAO,eACnB,gBAAAA,QAAA,cAAC,oBAAe,IAEhB,gBAAAA,QAAA,cAAC,cAAW,SAAS,aAAa,IAAI,OAAO,aAAa,OAAO,OAAO,aAAa,OAAO;AAAA,EAEhG,CACF,CACF;AAEJ;AAEA,IAAM,qBAAqB,MAAM;AAC/B,QAAM,YAAYE,cAAYC,gBAAe;AAC7C,QAAM,WAAWD,cAAY,cAAc;AAC3C,QAAM,cAAcA,cAAYE,kBAAiB;AACjD,QAAM,mBAAmBR;AAAA,IACvB,MACE,OAAO,OAAO,SAAS,EAAE,OAAO,CAAC,KAAK,UAAU;AArItD,UAAAD,KAAAU;AAsIQ,YAAM,YAAWV,MAAA,SAAS,MAAM,MAAM,MAArB,gBAAAA,IAAwB;AACzC,YAAM,eAAe,MAAM,WAAW;AACtC,UAAI,kBAAgBU,MAAA,MAAM,qBAAN,gBAAAA,IAAwB,SAAQ;AAClD,cAAM,IAAI;AAAA,UACR,MAAM,iBAAiB,IAAI,CAAC,EAAE,MAAM,MAAM;AACxC,mBAAO;AAAA,cACL,IAAI,MAAM;AAAA,cACV;AAAA,cACA,OAAO;AAAA,cACP,OAAO,GAAG,QAAQ,IAAI,MAAM,MAAM,IAAI,MAAM,IAAI,MAAM,KAAK;AAAA,YAC7D;AAAA,UACF,CAAC;AAAA,QACH;AACA,eAAO;AAAA,MACT;AACA,UAAI,KAAK;AAAA,QACP,IAAI,MAAM;AAAA,QACV,OAAO;AAAA,QACP,OAAO,GAAG,QAAQ,IAAI,MAAM,MAAM,IAAI,MAAM,IAAI;AAAA,MAClD,CAAC;AACD,aAAO;AAAA,IACT,GAAG,CAAC,CAAC;AAAA,IACP,CAAC,WAAW,UAAU,WAAW;AAAA,EACnC;AACA,SAAO;AACT;AAEA,IAAM,iBAAiB,MAAM;AAjK7B,MAAAV,KAAAU,KAAA;AAkKE,QAAM,QAAQC,kBAAiBC,gBAAe,cAAc;AAE5D,MAAI,CAAC,OAAO;AACV,WAAO;AAAA,EACT;AAEA,SACE,gBAAAP,QAAA,cAAC,QAAK,KAAK,EAAE,UAAU,QAAQ,KAAK,MAAM,KACxC,gBAAAA,QAAA,cAACQ,WAAA,EAAS,OAAM,gBAAe,QAAOb,MAAA,MAAM,cAAN,gBAAAA,IAAiB,aAAa,GACpE,gBAAAK,QAAA,cAACQ,WAAA,EAAS,OAAM,UAAS,QAAOH,MAAA,MAAM,cAAN,gBAAAA,IAAiB,QAAQ,GACzD,gBAAAL,QAAA,cAACQ,WAAA,EAAS,OAAM,mBAAkB,OAAO,aAAY,WAAM,YAAN,mBAAe,SAAS,KAAK,GAAG,GACrF,gBAAAR,QAAA,cAACQ,WAAA,EAAS,OAAM,qBAAoB,OAAO,aAAY,WAAM,cAAN,mBAAiB,SAAS,KAAK,GAAG,GACzF,gBAAAR,QAAA;AAAA,IAACQ;AAAA,IAAA;AAAA,MACC,OAAM;AAAA,MACN,OAAO,aAAY,WAAM,YAAN,mBAAe,0BAA0B,KAAK;AAAA;AAAA,EACnE,GACA,gBAAAR,QAAA,cAACQ,WAAA,EAAS,OAAM,oBAAmB,OAAO,aAAY,WAAM,YAAN,mBAAe,SAAS,GAAG,GACjF,gBAAAR,QAAA,cAACQ,WAAA,EAAS,OAAM,wBAAuB,OAAO,aAAY,WAAM,cAAN,mBAAiB,aAAa,GAAG,GAC3F,gBAAAR,QAAA;AAAA,IAACQ;AAAA,IAAA;AAAA,MACC,OAAM;AAAA,MACN,OAAO,QACF,WAAM,YAAN,mBAAe,yBAAwB,QAAM,WAAM,cAAN,mBAAiB,yBAAwB,MAAM,GAAG,QAAQ,CAAC,IAC3G,GACF;AAAA;AAAA,EACF,CACF;AAEJ;AAEA,IAAM,aAAa,CAAC,EAAE,SAAS,OAAO,MAAM,MAAM;AA/LlD,MAAAb;AAgME,QAAM,WAAWc,OAAM,EAAE,SAAS,OAAO,MAAM,CAAC,EAC7C;AAAA,IACC;AAAA,MACE,OAAOC,GAAE,KAAK,CAAAC,WAAS,CAAC,CAACA,MAAK;AAAA,IAChC;AAAA,IACA,MAAMJ,gBAAe,4BAA4B,KAAK,EAAE,OAAO;AAAA,EACjE,EACC,KAAK,EAAE,OAAOG,GAAE,KAAK,CAAAE,WAAS,CAAC,CAACA,MAAK,EAAE,GAAG,MAAML,gBAAe,yBAAyB,OAAO,CAAC,EAChG,UAAU,MAAMA,gBAAe,eAAe,OAAO,CAAC;AACzD,QAAM,QAAQD,kBAAiB,QAAQ;AACvC,MAAI,CAAC,OAAO;AACV,WAAO;AAAA,EACT;AACA,QAAM,UAAU,MAAM,KAAK,SAAS,SAAS;AAE7C,SACE,gBAAAN,QAAA,cAAC,QAAK,KAAK,EAAE,UAAU,QAAQ,KAAK,MAAM,KACxC,gBAAAA,QAAA,cAACQ,WAAA,EAAS,OAAM,QAAO,OAAO,MAAM,OAAO,MAAM,MAAM,MAAM,GAC7D,gBAAAR,QAAA,cAACQ,WAAA,EAAS,OAAM,WAAU,OAAO,YAAY,MAAM,SAAS,KAAK,GAAG,GACpE,gBAAAR,QAAA,cAACQ,WAAA,EAAS,OAAM,gBAAe,OAAO,MAAM,aAAa,GACzD,gBAAAR,QAAA,cAACQ,WAAA,EAAS,OAAM,UAAS,QAAOb,MAAA,MAAM,WAAN,gBAAAA,IAAc,QAAQ,IAAI,GAC1D,gBAAAK,QAAA;AAAA,IAACQ;AAAA,IAAA;AAAA,MACC,OAAO,UAAU,mBAAmB;AAAA,MACpC,OAAO,YAAY,UAAU,MAAM,gBAAgB,MAAM,SAAS;AAAA;AAAA,EACpE,GACC,MAAM,SAAS,WACd,gBAAAR,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAACQ,WAAA,EAAS,OAAM,aAAY,OAAO,MAAM,iBAAiB,GACzD,CAAC,WAAW,gBAAAR,QAAA,cAACQ,WAAA,EAAS,OAAM,6BAA4B,OAAO,MAAM,yBAAyB,CACjG,GAEF,gBAAAR,QAAA;AAAA,IAACQ;AAAA,IAAA;AAAA,MACC,OAAM;AAAA,MACN,OAAO,MAAM,gBAAgB,IAAI,MAAM,gBAAgB,KAAM,QAAQ,CAAC,CAAC,QAAQ;AAAA;AAAA,EACjF,CACF;AAEJ;AAEA,IAAMA,YAAWR,QAAM,KAAK,CAAC,EAAE,OAAO,MAAM,MAC1C,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,IAAI,mBAAmB,GAAG,kBAAkB,GAAG,MAAM,GAAG,KAAK,KACvE,gBAAAA,QAAA;AAAA,EAAC;AAAA;AAAA,IACC,SAAQ;AAAA,IACR,KAAK;AAAA,MACH,YAAY;AAAA,MACZ,OAAO;AAAA,MACP,eAAe;AAAA,IACjB;AAAA;AAAA,EAEC;AACH,GACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAO,KAAK,EAAE,YAAY,aAAa,OAAO,mBAAmB,KAC5E,SAAS,GACZ,CACF,CACD;;;ACvPD;AAAA,OAAOa,WAAS,eAAAC,eAAa,UAAAC,UAAQ,YAAAC,kBAAgB;AACrD,SAAS,iBAAAC,uBAAqB;AAC9B,SAAS,qBAAAC,oBAAmB,gBAAgB,aAAAC,kBAAiB;AAMtD,IAAM,sBAAsB,CAAC,EAAE,aAAa,MAAM;AARzD,MAAAC,KAAAC;AASE,QAAM,QAAQ,iBAAiB;AAC/B,QAAM,aAAaC,gBAAc;AACjC,QAAM,MAAMC,SAAO,IAAI;AACvB,QAAM,UAAUA,SAAO,IAAI;AAC3B,QAAM,CAAC,kBAAkB,WAAW,IAAIC,WAAS,CAAC,CAAC;AACnD,QAAM,CAAC,cAAc,OAAO,IAAIA,WAAS,EAAE;AAC3C,QAAM,CAAC,gBAAgB,iBAAiB,IAAIA,WAAS,KAAK;AAC1D,QAAM,CAAC,YAAY,aAAa,IAAIA,WAAS,KAAK;AAClD,QAAM,CAAC,cAAc,eAAe,IAAIA,WAAS,EAAE;AACnD,QAAM,CAAC,aAAa,cAAc,IAAIA,WAAS,KAAK;AAEpD,QAAM,iBAAiBC,cAAY,MAAY;AAC7C,QAAI,iBAAiB,SAAS,KAAK,cAAc;AAC/C,UAAI;AACF,uBAAe,IAAI;AACnB,cAAM,WAAW,2BAA2B,kBAAkB,YAAY;AAC1E,uBAAe,KAAK;AACpB,wBAAgB,EAAE;AAClB,qBAAa,KAAK;AAAA,MACpB,SAAS,KAAK;AACZ,yBAAgB,2BAAK,WAAU,2BAAK,UAAU,eAAe;AAC7D,uBAAe,KAAK;AAAA,MACtB;AAAA,IACF;AAAA,EACF,IAAG,CAAC,kBAAkB,cAAc,YAAY,YAAY,CAAC;AAE7D,SACE,gBAAAC,QAAA,cAAC,OAAO,MAAP,EAAY,aAAW,MAAC,gBACvB,gBAAAA,QAAA,cAAC,iBAAc,OAAM,oBAAmB,MAAM,kBAC5C,gBAAAA,QAAA,cAAC,iBACC,gBAAAA,QAAA,cAAC,YAAK,aAAW,GACjB,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,MAAM;AAAA,MACN,cAAc,WAAS;AACrB,YAAI,OAAO;AACT,4BAAkB,KAAK;AAAA,QACzB;AAAA,MACF;AAAA,MACA,OAAO;AAAA;AAAA,IAEP,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC;AAAA,QACA,OAAO,iBAAiB,WAAW,IAAI,0BAA0B,iBAAiB,SAAS;AAAA,QAC3F,KAAK;AAAA,UACH,GAAG;AAAA,UACH,GAAG;AAAA,QACL;AAAA,QACA,MAAM;AAAA;AAAA,IACR;AAAA,IACA,gBAAAA,QAAA;AAAA,MAAC,SAAS;AAAA,MAAT;AAAA,QACC,KAAK,EAAE,IAAGN,MAAA,IAAI,YAAJ,gBAAAA,IAAa,aAAa,QAAQ,IAAK;AAAA,QACjD,mBAAmB,MAAM;AACvB,cAAI,gBAAgB;AAClB,8BAAkB,KAAK;AAAA,UACzB;AAAA,QACF;AAAA;AAAA,MAEC,SACC,MAAM,IAAI,UAAQ;AAChB,eACE,gBAAAM,QAAA;AAAA,UAAC,SAAS;AAAA,UAAT;AAAA,YACC,KAAK;AAAA,YACL,SAAS,iBAAiB,SAAS,IAAI;AAAA,YACvC,iBAAiB,WAAS;AACxB,0BAAY,eAAa;AACvB,uBAAO,QAAQ,CAAC,GAAG,WAAW,IAAI,IAAI,UAAU,OAAO,CAAAC,kBAAgBA,kBAAiB,IAAI;AAAA,cAC9F,CAAC;AACD,8BAAgB,EAAE;AAAA,YACpB;AAAA;AAAA,UAEA,gBAAAD,QAAA,cAAC,SAAS,MAAT,EAAc,KAAK,EAAE,QAAQ,KAAK,GAAG,SAAS,iBAAiB,SAAS,IAAI,KAC3E,gBAAAA,QAAA,cAAC,SAAS,WAAT,MACC,gBAAAA,QAAA,cAACE,YAAA,EAAU,OAAO,IAAI,QAAQ,IAAI,CACpC,CACF;AAAA,UACC;AAAA,QACH;AAAA,MAEJ,CAAC;AAAA,IACL;AAAA,EACF,CACF,GACA,gBAAAF,QAAA,cAAC,iBACC,gBAAAA,QAAA,cAAC,YAAK,WAAS,GACf,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,MAAM,YAAY,cAAc,WAAS,cAAc,KAAK,KACzE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,MACL,OAAO,gBAAgB;AAAA,MACvB,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,MACL;AAAA,MACA,MAAM;AAAA;AAAA,EACR,GACA,gBAAAA,QAAA,cAAC,SAAS,SAAT,EAAiB,KAAK,EAAE,IAAGL,MAAA,QAAQ,YAAR,gBAAAA,IAAiB,aAAa,QAAQ,IAAK,KACpE,SACC,MAAM,IAAI,UAAQ;AAChB,WACE,gBAAAK,QAAA;AAAA,MAAC,SAAS;AAAA,MAAT;AAAA,QACC,KAAK;AAAA,QACL,UAAU,MAAM;AACd,kBAAQ,IAAI;AACZ,0BAAgB,EAAE;AAAA,QACpB;AAAA;AAAA,MAEC;AAAA,IACH;AAAA,EAEJ,CAAC,CACL,CACF,CACF,GACA,gBAAAA,QAAA,cAAC,iBACE,gBACC,gBAAAA,QAAA,cAAC,QAAK,KAAK,GAAG,KAAK,EAAE,GAAG,wBAAwB,GAAG,OAAO,IAAI,OAAO,KACnE,gBAAAA,QAAA,cAACG,oBAAA,IAAkB,GACnB,gBAAAH,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,UAAU,KAAI,YAAa,CAC7C,CAEJ,GACA,gBAAAA,QAAA,cAAC,aAAU,SAAQ,SACjB,gBAAAA,QAAA,cAAC,UAAO,SAAQ,WAAU,SAAS,gBAAgB,UAAU,EAAE,gBAAgB,iBAAiB,SAAS,MACtG,eAAe,gBAAAA,QAAA,cAAC,WAAQ,KAAK,EAAE,OAAO,qBAAqB,GAAG,GAAG,OAEpE,CACF,CACF,CACF;AAEJ;;;AC1IA;AAAA,OAAOI,aAAW;AAClB,SAAS,YAAAC,kBAAgB;;;ACDzB;AAAA,OAAOC,aAAW;AAClB,SAAS,sBAAsB,gCAAAC,+BAA8B,iBAAAC,iBAAe,eAAAC,qBAAmB;AAC/F,SAAS,qBAAAC,oBAAmB,aAAAC,mBAAiB;AAWtC,IAAM,iBAAiB,CAAC,EAAE,UAAU,OAAO,MAAiD;AACjG,QAAM,WAAW;AACjB,QAAM,UAAUC,gBAAc;AAC9B,QAAM,yBAAyBC,cAAYC,6BAA4B;AACvE,QAAM,CAAC,SAAS,UAAU,IAAI,mBAAmB,cAAc,YAAY;AAE3E,QAAM,CAAC,kBAAkB,mBAAmB,IAAI,uBAAuB;AAEvE,SACE,gBAAAC,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS,WAAW,OAAO;AAAA,MAC3B,KAAK;AAAA,QACH,OAAO;AAAA,QACP,YAAY;AAAA,QACZ,SAAS;AAAA,QACT,OAAO,EAAE,IAAI,KAAK;AAAA,MACpB;AAAA;AAAA,IAEC,yBAAyB,YAAY;AAAA,IAAS;AAAA,IAC/C,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK,EAAE,OAAO,WAAW,IAAI,QAAQ,WAAW,EAAE,OAAO,sBAAsB,QAAQ,UAAU,EAAE;AAAA,QACnG,SAAS;AAAA;AAAA,MAET,gBAAAA,QAAA,cAACC,aAAA,IAAU;AAAA,IACb;AAAA,EACF,GACC,CAAC,WACA,gBAAAD,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,sBAAsB,IAAI,MAAM,OAAO,EAAE,IAAI,KAAK,EAAE,KAAG,cAC3E,yBAAyB,YAAY,UAAS,2DAExD,yBAAyB,WAAW,WAAU,YACjD,IACE,MAEJ,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,OAAM;AAAA,MACN,KAAK;AAAA,QACH,OAAO;AAAA,QACP,KAAK;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,EAAE,IAAI,KAAK;AAAA,MACpB;AAAA;AAAA,IAEC,WAAW,OACV,gBAAAA,QAAA,cAAC,UAAO,SAAQ,YAAW,KAAK,EAAE,GAAG,OAAO,GAAG,UAAQ,MAAC,SAAS,UAAQ,QAEzE;AAAA,IAEF,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,WAAU;AAAA,QACV,SAAQ;AAAA,QACR,OAAM;AAAA,QACN,KAAK;AAAA,UACH,OAAO;AAAA,UACP,OAAO,EAAE,IAAI,KAAK;AAAA,QACpB;AAAA;AAAA,MAEC,YAAY,yBACX,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,SAAQ;AAAA,UACR,KAAK,EAAE,GAAG,QAAQ,IAAI,KAAK;AAAA,UAC3B,UAAQ;AAAA,UACR,SAAS,MAAM;AACb,gCAAoB,CAAC,gBAAgB;AACrC,mBAAO;AAAA,UACT;AAAA;AAAA,QAEC,mBAAmB,gBAAgB;AAAA,MACtC,IACE;AAAA,MACJ,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,SAAS,yBAAyB,WAAW;AAAA,UAC7C,KAAK,EAAE,OAAO,OAAO;AAAA,UACrB,eAAY;AAAA,UACZ,SAAS,MAAY;AACnB,gBAAI;AACF,kBAAI,wBAAwB;AAC1B,sBAAM,QAAQ,kBAAkB;AAAA,kBAC9B,MAAM,qBAAqB;AAAA,gBAC7B,CAAC;AACD,oCAAoB,KAAK;AACzB,sBAAME,MAAK,aAAa,aAAa,SAAS;AAAA,kBAC5C,OAAO;AAAA,kBACP,SAAS;AAAA,kBACT,UAAU;AAAA,kBACV,MAAM,gBAAAF,QAAA,cAAC,WAAQ,OAAM,gBAAe;AAAA,gBACtC,CAAC;AACD,2BAAWE,GAAE;AACb,uBAAO;AACP;AAAA,cACF;AACA,oBAAM,QAAQ,mBAAmB;AAAA,gBAC/B,MAAM,qBAAqB;AAAA,cAC7B,CAAC;AACD,oBAAM,KAAK,aAAa,aAAa,SAAS;AAAA,gBAC5C,OAAO;AAAA,gBACP,SAAS;AAAA,gBACT,UAAU;AAAA,gBACV,MAAM,gBAAAF,QAAA,cAAC,WAAQ,OAAM,gBAAe;AAAA,cACtC,CAAC;AACD,yBAAW,EAAE;AAAA,YACf,SAAS,KAAK;AACZ,oBAAM,KAAK,aAAa,aAAa,SAAS;AAAA,gBAC5C,OAAO,aAAa,yBAAyB,YAAY,QAAQ;AAAA,gBACjE,SAAS;AAAA,gBACT,MAAM,gBAAAA,QAAA,cAACG,oBAAA,EAAkB,OAAO,EAAE,aAAa,SAAS,GAAG;AAAA,cAC7D,CAAC;AACD,yBAAW,EAAE;AAAA,YACf,UAAE;AACA,kCAAoB,IAAI;AAAA,YAC1B;AACA,mBAAO;AAAA,UACT;AAAA;AAAA,QAEC,yBAAyB,YAAY;AAAA,QAAS;AAAA,MACjD;AAAA,IACF;AAAA,EACF,GACC,YACC,gBAAAH,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,sBAAsB,IAAI,MAAM,IAAI,MAAM,OAAO,EAAE,IAAI,MAAM,IAAI,KAAK,EAAE,KAAG,cAC/F,yBAAyB,YAAY,UAAS,2DAExD,yBAAyB,WAAW,WAAU,YACjD,CAEJ;AAEJ;;;ADxIO,IAAM,eAAe,CAAC,EAAE,aAAa,MAAkD;AAC5F,QAAM,WAAWI,WAAS,OAAU,MAAM,EAAE;AAE5C,QAAM,QAAQ;AAAA,IACZ;AAAA,IACA,QAAQ,MAAM;AACZ,mBAAa,KAAK;AAAA,IACpB;AAAA,EACF;AAEA,MAAI,UAAU;AACZ,WACE,gBAAAC,QAAA,cAAC,MAAM,MAAN,EAAW,aAAW,MAAC,gBACtB,gBAAAA,QAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,IAAI,gBAAgB,GAAG,OAAO,KAClD,gBAAAA,QAAA,cAAC,mCAAmB,MAAO,CAC7B,CACF;AAAA,EAEJ;AAEA,SACE,gBAAAA,QAAA,cAAC,OAAO,MAAP,EAAY,aAAW,MAAC,gBACvB,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA,cAAC,OAAO,SAAP,EAAe,KAAK,EAAE,IAAI,gBAAgB,OAAO,kBAAkB,GAAG,MAAM,KAC3E,gBAAAA,QAAA,cAAC,mCAAmB,MAAO,CAC7B,CACF,CACF;AAEJ;;;AEpCA;AAAA,OAAOC,aAAW;AAClB,SAAS,kBAAkB;;;ACD3B;AAAA,SAAS,eAAAC,eAAa,aAAAC,aAAW,YAAAC,kBAAgB;AACjD,OAAO,gBAAgB;AAKhB,IAAM,gBAAgB,MAAM;AACjC,QAAM,CAAC,qBAAqB,sBAAsB,IAAIC,WAAS,WAAW,YAAY;AAEtF,QAAM,SAASC,cAAY,MAAY;AACrC,QAAI,CAAC,WAAW,WAAW;AACzB,mBAAa,SAAS,EAAE,OAAO,mCAAmC,CAAC;AACnE;AAAA,IACF;AACA,QAAI;AACF,YAAM,YAAY,SAAS,cAAc,wBAAwB;AACjE,UAAI,qBAAqB;AACvB,cAAM,WAAW,KAAK;AAAA,MACxB,WAAW,WAAW;AACpB,cAAM,WAAW,QAAQ,SAAS;AAAA,MACpC;AAAA,IACF,SAAS,KAAK;AACZ,mBAAa,SAAS,EAAE,OAAQ,IAAc,QAAQ,CAAC;AAAA,IACzD;AAAA,EACF,IAAG,CAAC,mBAAmB,CAAC;AAExB,EAAAC,YAAU,MAAM;AACd,UAAM,WAAW,MAAM;AACrB,6BAAuB,WAAW,YAAY;AAAA,IAChD;AACA,QAAI,WAAW,WAAW;AACxB,iBAAW,GAAG,UAAU,QAAQ;AAAA,IAClC;AACA,WAAO,MAAM;AACX,UAAI,WAAW,WAAW;AACxB,mBAAW,IAAI,UAAU,QAAQ;AAAA,MACnC;AAAA,IACF;AAAA,EACF,GAAG,CAAC,CAAC;AAEL,SAAO;AAAA,IACL,SAAS,WAAW;AAAA,IACpB,cAAc;AAAA,IACd,kBAAkB;AAAA,EACpB;AACF;;;ADxCO,IAAM,iBAAiB,MAAM;AAClC,QAAM,EAAE,SAAS,cAAc,iBAAiB,IAAI,cAAc;AAElE,MAAI,CAAC,SAAS;AACZ,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,SAAS,MAAM;AACb,yBAAiB;AAAA,MACnB;AAAA,MACA,eAAY;AAAA;AAAA,IAEZ,gBAAAA,QAAA,cAAC,gBAAW;AAAA,IACZ,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,KAAK,KAChC,eAAe,UAAU,OAAM,YAClC;AAAA,EACF;AAEJ;;;AEzBA;AAAA,OAAOC,WAAS,eAAAC,eAAa,YAAAC,kBAAgB;AAC7C;AAAA,EAIE,4BAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,cAAAC,mBAAkB;;;ACT3B;AAAA,OAAOC,aAAW;AAClB,SAAoD,qBAAAC,oBAAmB,eAAAC,qBAAmB;AAUnF,IAAM,iBAAiB,CAAC,UAYzB;AACJ,QAAM,QAAQ,MAAM,SAAS,CAAC;AAC9B,QAAM,cAAcC,cAAYC,kBAAiB;AACjD,SACE,gBAAAC,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAS,CAAC,EAAE,OAAO,aAAa,OAAO,GAAG,GAAG,GAAG,MAAM,IAAI,WAAS,EAAE,OAAO,MAAM,OAAO,KAAK,EAAE,CAAC;AAAA,MACjG,UAAU,MAAM;AAAA,MAChB,UAAS;AAAA,MACT,YAAW;AAAA,MACX,UAAU,MAAM;AAAA;AAAA,EAClB,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAS;AAAA,MACT,UAAU,MAAM;AAAA,MAChB,UAAU,MAAM;AAAA,MAChB,UAAS;AAAA,MACT,YAAW;AAAA;AAAA,EACb,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAS;AAAA,MACT,UAAU,MAAM;AAAA,MAChB,UAAU,MAAM;AAAA,MAChB,UAAS;AAAA,MACT,YAAW;AAAA;AAAA,EACb,GACA,gBAAAA,QAAA,cAAC,iBACC,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAK,cAAY,GAC/B,gBAAAA,QAAA,cAAC,WAAW,MAAX,EAAgB,OAAO,OAAO,MAAM,OAAO,GAAG,eAAe,WAAS,MAAM,WAAW,UAAU,MAAM,MACrG,2CAAa,SACZ,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,IAAI,KAAK,KACnC,gBAAAA,QAAA,cAAC,WAAW,MAAX,EAAgB,OAAM,SAAQ,IAAG,qBAAoB,KAAK,EAAE,IAAI,KAAK,KACpE,gBAAAA,QAAA,cAAC,WAAW,WAAX,IAAqB,CACxB,GACA,gBAAAA,QAAA,cAACC,QAAA,EAAM,SAAQ,uBAAoB,MAAI,CACzC,IAED,2CAAa,WACZ,gBAAAD,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,QAAQ,UAAU,KAC5C,gBAAAA,QAAA,cAAC,WAAW,MAAX,EAAgB,OAAM,QAAO,IAAG,oBAAmB,KAAK,EAAE,IAAI,KAAK,KAClE,gBAAAA,QAAA,cAAC,WAAW,WAAX,IAAqB,CACxB,GACA,gBAAAA,QAAA,cAACC,QAAA,EAAM,SAAQ,sBAAmB,gBAAc,CAClD,CAEJ,CACF,GACA,gBAAAD,QAAA,cAAC,aAAU,SAAQ,SACjB,gBAAAA,QAAA,cAAC,UAAO,SAAQ,WAAU,SAAS,MAAM,SAAS,KAAK,EAAE,IAAG,+BAAO,YAAW,SAAS,GAAG,KAAG,OAE7F,CACF,CACF;AAEJ;;;ADhEO,IAAM,eAAe,CAAC;AAAA,EAC3B;AAAA,EACA,WAAW;AACb,MAGM;AACJ,QAAM,QAAQE,cAAYC,yBAAwB;AAClD,QAAM,aAAaC,gBAAc;AACjC,QAAM,CAAC,SAAS,UAAU,IAAIC,WAAS,KAAK;AAC5C,QAAM,CAAC,WAAW,YAAY,IAAIA,WAAuB;AACzD,QAAM,CAAC,cAAc,OAAO,IAAIA,WAAsB;AACtD,QAAM,CAAC,gBAAgB,SAAS,IAAIA,WAAyB;AAE7D,QAAM,UAAUC,cAAY,MAAY;AACtC,UAAM,WAAW,uBAAuB;AAAA,MACtC;AAAA,MACA,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,OAAO,eAAe,CAAC,YAAY,IAAI;AAAA,IACzC,CAAC;AACD,iBAAa,KAAK;AAAA,EACpB,IAAG,CAAC,cAAc,SAAS,WAAW,gBAAgB,YAAY,YAAY,CAAC;AAE/E,QAAM,QAAQ;AAAA,IACZ;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AAEA,MAAI,UAAU;AACZ,WACE,gBAAAC,QAAA,cAAC,MAAM,MAAN,EAAW,aAAW,MAAC,gBACtB,gBAAAA,QAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,IAAI,MAAM,KAC9B,gBAAAA,QAAA,cAAC,mCAAmB,MAAO,CAC7B,CACF;AAAA,EAEJ;AAEA,SACE,gBAAAA,QAAA,cAAC,OAAO,MAAP,EAAY,aAAW,MAAC,gBACvB,gBAAAA,QAAA,cAAC,iBAAc,OAAM,6BAA4B,MAAMC,eACrD,gBAAAD,QAAA,cAAC,mCAAmB,MAAO,CAC7B,CACF;AAEJ;;;AEvEA;AAAA,SAAS,eAAAE,qBAAmB;AAC5B;AAAA,EACE;AAAA,EACA,qBAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,sBAAAC;AAAA,OACK;AAEA,IAAM,gBAAgB,MAAM;AACjC,QAAM,aAAaC,gBAAc;AACjC,QAAM,cAAcC,cAAYC,kBAAiB;AACjD,QAAM,eAAeC,oBAAmB;AACxC,QAAM,WAAWF,cAAYG,oBAAmB,WAAW,CAAC;AAC5D,QAAM,eAAeH,cAAY,wBAAwB,WAAW,CAAC;AAErE,QAAM,SAAS,CAAO,kBAAuC;AAC3D,QAAI;AAEF,YAAM,kBAAkB,aAAa,SAASG,oBAAmB,WAAW,CAAC;AAC7E,YAAM,WAAW,eAAe,OAAO,OAAO,iBAAiB,aAAa,CAAC;AAC7E,aAAO;AAAA,IACT,SAAS,OAAO;AACd,cAAQ,MAAM,8BAA8B,aAAa;AAAA,IAC3D;AACA,WAAO;AAAA,EACT;AAEA,QAAM,kBAAkBC,cAAY,MAAY;AAC9C,QAAI,cAAc;AAChB,YAAM,WAAW,mBAAmB;AACpC,YAAM,OAAO,EAAE,cAAc,OAAU,CAAC;AAAA,IAC1C,OAAO;AACL,YAAM,WAAW,mBAAmB;AACpC,YAAM,OAAO,EAAE,SAAS,OAAO,cAAc,KAAK,IAAI,EAAE,CAAC;AAAA,IAC3D;AAAA,EACF,IAAG,CAAC,YAAY,CAAC;AAEjB,QAAM,YAAYA,cAAY,MAAY;AACxC,UAAM,WAAW,EAAC,qCAAU;AAC5B,UAAM,OAAO,EAAE,SAAS,SAAS,CAAC;AAClC,QAAI,UAAU;AACZ,YAAM,WAAW,mBAAmB;AAAA,IACtC;AAAA,EACF,IAAG,CAAC,qCAAU,OAAO,CAAC;AAEtB,SAAO;AAAA,IACL;AAAA,IACA,SAAS,CAAC,EAAC,qCAAU;AAAA,IACrB;AAAA,IACA,gBAAgB;AAAA,IAChB;AAAA,IACA;AAAA,EACF;AACF;;;ACvDA;AAAA,SAAS,aAAAC,mBAAiB;AAC1B,SAAS,iBAAAC,uBAAqB;;;ACD9B;AAAA,SAAS,cAAAC,mBAAkB;;;ACA3B;AAAA,SAAS,iBAAAC,sBAAqB;AASvB,IAAM,aAAaA,eAA0C,MAAS;;;ADNtE,IAAM,eAAe,MAAsB;AAChD,QAAM,UAAUC,YAAW,UAAU;AAErC,MAAI,YAAY,QAAW;AACzB,UAAM,IAAI,MAAM,+CAA+C;AAAA,EACjE;AAEA,SAAO;AACT;;;ADNO,IAAM,aAAa,MAAM;AAC9B,QAAM,aAAaC,gBAAc;AACjC,QAAM,EAAE,aAAa,kBAAkB,WAAW,eAAe,IAAI,aAAa;AAElF,EAAAC,YAAU,MAAM;AACd,QAAI,YAAY,WAAW;AACzB,YAAM,QAAQ,SAAS,cAAc,OAAO;AAC5C,YAAM,KAAK;AACX,YAAM,cAAc,WAAW;AAC/B,gBAAU,SAAS,KAAK,YAAY,KAAK;AAAA,IAC3C;AAAA,EACF,GAAG,CAAC,SAAS,CAAC;AAGd,EAAAA,YAAU,MAAM;AACd,QAAI,WAAW;AACb,YAAM,gBAAgB,UAAU,SAAS,eAAe,gBAAgB;AACxE,YAAM,WAAW,UAAU,SAAS,eAAe,UAAU;AAC7D,YAAM,UAAU,UAAU,SAAS,eAAe,UAAU;AAC5D,YAAM,eAAe,UAAU,SAAS,eAAe,YAAY;AACnE,YAAM,SAAS,UAAU,SAAS,eAAe,QAAQ;AAEzD,uCAAQ,eAAe,EAAE,OAAO,MAAM;AAEtC,YAAM,WAAW,IAAI;AAAA,QACnB,aAAW;AACT,kBAAQ,QAAQ,WAAS;AACvB,gBAAI,MAAM,kBAAkB,MAAM,OAAO,IAAI;AAC3C,yBAAW,eAAe,MAAM,MAAM,OAAO,EAAE;AAAA,YACjD;AAAA,UACF,CAAC;AAAA,QACH;AAAA,QACA;AAAA,UACE,MAAM;AAAA,UACN,WAAW;AAAA,QACb;AAAA,MACF;AAEA,YAAM,mBAAmB,IAAI,iBAAiB,eAAa;AACzD,kBAAU,QAAQ,cAAY;AAC5B,cAAI,SAAS,WAAW,SAAS,GAAG;AAClC,kBAAM,cAAc,SAAS;AAC7B,wBAAY,QAAQ,aAAW;AAC7B,oBAAM,YAAa,mCAAqB;AACxC,kBAAI,cAAc,qBAAqB;AACrC,wBAAQ;AAAA,kBAAiB;AAAA,kBAAS,MAChC,WAAW,MAAM,iCAAQ,eAAe,EAAE,OAAO,OAAO,UAAU,SAAS,IAAI,CAAC;AAAA,gBAClF;AAAA,cACF,WAAW;AAAW,yBAAS,QAAQ,OAAkB;AAAA,YAC3D,CAAC;AAAA,UACH;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AACD,uBAAiB,QAAQ,eAAuB;AAAA,QAC9C,WAAW;AAAA,MACb,CAAC;AAED,YAAM,cAAc,MAAY;AAC9B,cAAM,aAAY,qCAAU,UAAS;AACrC,YAAI,cAAc,YAAY;AAC5B,gBAAM,WAAW,qBAAqB,aAAa,MAAM,KAAK,CAAC;AAAA,QACjE,OAAO;AACL,gBAAM,WAAW,iBAAiB,aAAa,MAAM,KAAK,GAAG,CAAC,SAAS,CAAC;AAAA,QAC1E;AACA,qBAAa,QAAQ;AACrB,mBAAW,MAAM,iCAAQ,eAAe,EAAE,OAAO,OAAO,UAAU,SAAS,IAAI,CAAC;AAAA,MAClF;AAEA,UAAI,WAAW,cAAc,cAAc;AACzC,cAAM,cAAc,UAAU,SAAS,uBAAuB,aAAa;AAE3E,SAAC,GAAG,WAAW,EAAE,QAAQ,aAAW;AAClC,cAAI,QAAQ,IAAI;AACd,uBAAW,eAAe,MAAM,QAAQ,EAAE;AAAA,UAC5C;AAAA,QACF,CAAC;AAED,cAAM,cAAc,OAAK;AACvB,cAAI,EAAE,QAAQ;AAAS,wBAAY;AAAA,QACrC;AACA,gBAAQ,iBAAiB,SAAS,WAAW;AAC7C,qBAAa,iBAAiB,YAAY,WAAW;AACrD,eAAO,MAAM;AACX,kBAAQ,oBAAoB,SAAS,WAAW;AAChD,uBAAa,oBAAoB,YAAY,WAAW;AACxD,2BAAiB,WAAW;AAC5B,mBAAS,WAAW;AAAA,QACtB;AAAA,MACF;AAAA,IACF;AAAA,EACF,GAAG,CAAC,WAAW,UAAU,CAAC;AAE1B,EAAAA,YAAU,MAAM;AACd,WAAO,MAAM;AACX,mBAAa,eAAe;AAAA,IAC9B;AAAA,EACF,GAAG,CAAC,gBAAgB,SAAS,CAAC;AAE9B,SAAO,EAAE,aAAa,kBAAkB,UAAU;AACpD;;;A9B7CA,IAAM,SAAS;AAAA,EACb,aAAa;AAAA,EACb,kBAAkB;AAAA,EAClB,eAAe;AAAA,EACf,iBAAiB;AAAA,EACjB,iBAAiB;AAAA,EACjB,iBAAiB;AAAA,EACjB,kBAAkB;AAAA,EAClB,UAAU;AAAA,EACV,WAAW;AAAA,EACX,SAAS;AACX;AAEO,IAAM,iBAAiB,CAAC;AAAA,EAC7B;AAAA,EACA;AACF,MAGM;AACJ,QAAM,cAAcC,cAAYC,kBAAiB;AACjD,QAAM,aAAaC,gBAAc;AACjC,QAAM,gBAAgBF,cAAYG,eAAc,SAAS,QAAQ,CAAC;AAClE,QAAM,CAAC,YAAY,aAAa,IAAIC,WAAS,oBAAI,IAAI,CAAC;AACtD,QAAM,EAAE,SAAS,UAAU,IAAI,cAAc;AAC7C,QAAM,UAAU,iBAAiB,KAAK;AACtC,QAAM,eAAe,CAAC,EAAC,qCAAU;AACjC,QAAM,yBAAyBJ,cAAY,mCAAmCK,sBAAqB,OAAO,CAAC;AAC3G,QAAM,yBAAyBL,cAAYM,6BAA4B;AACvE,QAAM,EAAE,aAAa,WAAW,iBAAiB,IAAI,WAAW;AAChE,QAAM,aAAa,sBAAsB,kBAAkB,IAAI;AAC/D,QAAM,aAAa,kBAAkB,kBAAkB,IAAI;AAE3D,QAAM,oBAAoB,CAAC,EAAC,qCAAU,SAAQ,eAAe,CAAC;AAE9D,kBAAgB,EAAE,MAAM,WAAW,OAAO,GAAG,MAAM,eAAe,CAAC;AAEnE,QAAM,cAAc,CAAC,WAAmB,UAAmB;AACzD,kBAAc,YAAU;AACtB,YAAM,OAAO,IAAI,IAAI,MAAM;AAC3B,UAAI,OAAO;AAET,aAAK,MAAM;AACX,aAAK,IAAI,SAAS;AAAA,MACpB,OAAO;AACL,aAAK,OAAO,SAAS;AAAA,MACvB;AACA,aAAO;AAAA,IACT,CAAC;AAAA,EACH;AAEA,SACE,gBAAAC,QAAA,cAACC,WAAA,MACE,eAAe,YACd,gBAAAD,QAAA,cAAC,aAAU,aACT,gBAAAA,QAAA,cAAC,aAAQ,CACX,IACE,MACJ,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,MAAM,WAAW,IAAI,OAAO,aAAa;AAAA,MACzC,cAAc,WAAS,YAAY,OAAO,eAAe,KAAK;AAAA,MAC9D,OAAO;AAAA;AAAA,IAEP,gBAAAA,QAAA,cAAC,WAAQ,OAAM,kBACb,gBAAAA,QAAA,cAAC,SAAS,SAAT,EAAiB,SAAO,MAAC,eAAY,uBACpC,gBAAAA,QAAA,cAAC,0BACC,gBAAAA,QAAA,cAAC,uBAAkB,CACrB,CACF,CACF;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC,SAAS;AAAA,MAAT;AAAA,QACC,YAAY;AAAA,QACZ,OAAM;AAAA,QACN,KAAK;AAAA,UACH,IAAI;AAAA,UACJ,WAAW;AAAA,UACX,OAAO,EAAE,GAAG,MAAM;AAAA,UAClB,qCAAqC;AAAA,YACnC,SAAS;AAAA,UACX;AAAA,QACF;AAAA;AAAA,MAEC,gBAAgB,eAAe,uBAC9B,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,SAAS,WAAW,eAAY,aAC7C,gBAAAA,QAAA,cAAC,aAAQ,GACT,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,OAAO,mBAAmB,KAAG,eAEjE,GACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,OAAM,KAAK,EAAE,OAAO,oBAAoB,UAAU,IAAI,KACjE,UAAU,gBAAAA,QAAA,cAACE,YAAA,IAAU,IAAK,IAC7B,CACF,IACE;AAAA,MACH,yBACC,gBAAAF,QAAA;AAAA,QAAC,SAAS;AAAA,QAAT;AAAA,UACC,eAAY;AAAA,UACZ,SAAS,MAAM;AACb,wBAAY,OAAO,SAAS,IAAI;AAAA,UAClC;AAAA;AAAA,QAEA,gBAAAA,QAAA,cAACG,kBAAA,IAAgB;AAAA,QACjB,gBAAAH,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,UAAU,IAAI,KAC5C,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,OAAO,mBAAmB,KAAG,iBAEjE,GACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,EAAE,IAAI,MAAM,OAAO,qBAAqB,KAClE,yBAAyB,YAAY,UACxC,CACF;AAAA,QACA,gBAAAA,QAAA,cAAC,UAAO,IAAG,6BAA4B,SAAS,wBAAwB,UAAU,OAAO;AAAA,MAC3F,IACE;AAAA,MACH,eAAe,uBACd,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,KAAK,EAAE,GAAG,GAAG,WAAW,EAAE,SAAS,OAAO,EAAE,KACzD,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,SACE,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,QAAQ,GAAG,QAAQ,GAAG,KAAK,KACzC,gBAAAA,QAAA,cAACI,UAAA,IAAQ,GACT,gBAAAJ,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,KAAK,KAChC,UAAU,YAAY,UAAS,qBAClC,CACF;AAAA;AAAA,MAEJ,CACF,IACE;AAAA,MAEJ,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,aAAa;AAAA,UACb,UAAU,MAAY;AACpB,0BAAc,WAAW;AACzB,kBAAM,iBAAiB,KAAK,GAAG;AAAA,UACjC;AAAA;AAAA,MACF;AAAA,MACA,gBAAAA,QAAA,cAAC,oBAAe;AAAA,MAChB,gBAAAA,QAAA,cAAC,SAAS,eAAT,EAAuB,KAAK,EAAE,IAAI,EAAE,GAAG;AAAA,MACxC,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,SAAS,MAAM,YAAY,OAAO,iBAAiB,IAAI,GAAG,eAAY,yBACnF,gBAAAA,QAAA,cAACK,eAAA,IAAa,GACd,gBAAAL,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,KAAK,KAAG,UAEtC,CACF;AAAA,MACCM,OAAM,EAAE,YAAY,aAAa,aAAa,YAAY,EAAE,CAAC,EAC3D,KAAK,EAAE,YAAY,sBAAsB,aAAa,MAAM,GAAG,MAAM,IAAI,EACzE,KAAK,EAAE,YAAY,sBAAsB,aAAa,KAAK,GAAG,MAAM;AACnE,eACE,gBAAAN,QAAA;AAAA,UAAC,SAAS;AAAA,UAAT;AAAA,YACC,SAAS,MAAM,WAAW,WAAW,SAAS,UAAU,CAAC,aAAa;AAAA,YACtE,eAAY;AAAA;AAAA,UAEZ,gBAAAA,QAAA;AAAA,YAAC,SAAS;AAAA,YAAT;AAAA,cACC,KAAK,EAAE,QAAQ,KAAK;AAAA,cACpB,SAAS;AAAA,cACT,iBAAiB,MAAM,WAAW,WAAW,SAAS,UAAU,CAAC,aAAa;AAAA;AAAA,YAE9E,gBAAAA,QAAA,cAAC,SAAS,WAAT,MACC,gBAAAA,QAAA,cAACE,YAAA,EAAU,OAAO,IAAI,QAAQ,IAAI,CACpC;AAAA,UACF;AAAA,UACA,gBAAAF,QAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,EAAE,OAAO,OAAO,KAC3C,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,KAAK,KAAG,gBAEtC,GAEA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,KAAK,KAChC,GAAG,UAAU,WAAM,MAAM,MAC5B,CACF;AAAA,QACF;AAAA,MAEJ,CAAC,EACA,UAAU,MACT,gBAAAA,QAAA;AAAA,QAAC,SAAS;AAAA,QAAT;AAAA,UACC,SAAS,MAAM,YAAY,OAAO,iBAAiB,IAAI;AAAA,UACvD,eAAY;AAAA;AAAA,QAEZ,gBAAAA,QAAA,cAACO,WAAA,IAAS;AAAA,QACV,gBAAAP,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,KAAK,KAAG,iBAEtC;AAAA,MACF,CACD;AAAA,IACL;AAAA,EACF,GACC,WAAW,IAAI,OAAO,gBAAgB,KACrC,gBAAAA,QAAA,cAAC,uBAAoB,cAAc,CAAC,UAAmB,YAAY,OAAO,kBAAkB,KAAK,GAAG,GAErG,WAAW,IAAI,OAAO,QAAQ,KAC7B,gBAAAA,QAAA,cAAC,gBAAa,cAAc,CAAC,UAAmB,YAAY,OAAO,UAAU,KAAK,GAAG,GAGtF,WAAW,IAAI,OAAO,eAAe,KACpC,gBAAAA,QAAA,cAAC,0BAAe,MAAI,MAAC,cAAc,CAAC,UAAmB,YAAY,OAAO,iBAAiB,KAAK,GAAG,GAEpG,WAAW,IAAI,OAAO,eAAe,KACpC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAI;AAAA,MACJ,cAAc,CAAC,UAAmB,YAAY,OAAO,iBAAiB,KAAK;AAAA,MAC3E;AAAA;AAAA,EACF,GAED,WAAW,IAAI,OAAO,eAAe,KACpC,gBAAAA,QAAA,cAAC,iBAAc,MAAI,MAAC,cAAc,CAAC,UAAmB,YAAY,OAAO,iBAAiB,KAAK,GAAG,GAEnG,WAAW,IAAI,OAAO,gBAAgB,KACrC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,QAAQ;AAAA,MACR,cAAc,CAAC,UAAmB,YAAY,OAAO,kBAAkB,KAAK;AAAA;AAAA,EAC9E,GAED,WAAW,IAAI,OAAO,OAAO,KAC5B,gBAAAA,QAAA,cAAC,gBAAa,cAAc,CAAC,UAAmB,YAAY,OAAO,SAAS,KAAK,GAAG,CAKxF;AAEJ;;;AiCtRA;AAAA,OAAOQ,WAAS,UAAAC,UAAQ,YAAAC,kBAAgB;AACxC,SAAS,oBAAoB;AAE7B,SAAS,SAAAC,cAAa;AACtB;AAAA,EACE,wBAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,6BAAAC;AAAA,EACA,sCAAAC;AAAA,EACA,gCAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,yBAAAC;AAAA,OACK;AACP;AAAA,EACE,WAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,aAAAC;AAAA,EACA,aAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,YAAAC;AAAA,EACA;AAAA,EACA,YAAAC;AAAA,EACA,mBAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,cAAAC;AAAA,EACA,gBAAAC;AAAA,EACA;AAAA,OACK;;;AChCP;AAAA,OAAOC,WAAS,eAAAC,eAAa,aAAAC,aAAW,UAAAC,UAAQ,YAAAC,kBAAgB;AAChE,SAAS,YAAAC,kBAAgB;;;;;;ACDzB;AAAA,SAAS,qBAAqBC,IAAGC,IAAG;AAClC,SAAOD,OAAMC;AACf;AAEA,SAAS,2BAA2B,eAAe,MAAM,MAAM;AAC7D,MAAI,SAAS,QAAQ,SAAS,QAAQ,KAAK,WAAW,KAAK,QAAQ;AACjE,WAAO;AAAA,EACT;AAGA,MAAI,SAAS,KAAK;AAClB,WAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,QAAI,CAAC,cAAc,KAAK,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG;AACpC,aAAO;AAAA,IACT;AAAA,EACF;AAEA,SAAO;AACT;AAEO,SAAS,eAAe,MAAM;AACnC,MAAI,gBAAgB,UAAU,SAAS,KAAK,UAAU,CAAC,MAAM,SAAY,UAAU,CAAC,IAAI;AAExF,MAAI,WAAW;AACf,MAAI,aAAa;AAEjB,SAAO,WAAY;AACjB,QAAI,CAAC,2BAA2B,eAAe,UAAU,SAAS,GAAG;AAEnE,mBAAa,KAAK,MAAM,MAAM,SAAS;AAAA,IACzC;AAEA,eAAW;AACX,WAAO;AAAA,EACT;AACF;AAEA,SAAS,gBAAgB,OAAO;AAC9B,MAAI,eAAe,MAAM,QAAQ,MAAM,CAAC,CAAC,IAAI,MAAM,CAAC,IAAI;AAExD,MAAI,CAAC,aAAa,MAAM,SAAU,KAAK;AACrC,WAAO,OAAO,QAAQ;AAAA,EACxB,CAAC,GAAG;AACF,QAAI,kBAAkB,aAAa,IAAI,SAAU,KAAK;AACpD,aAAO,OAAO;AAAA,IAChB,CAAC,EAAE,KAAK,IAAI;AACZ,UAAM,IAAI,MAAM,oEAAoE,4CAA4C,kBAAkB,IAAI;AAAA,EACxJ;AAEA,SAAO;AACT;AAEO,SAAS,sBAAsB,SAAS;AAC7C,WAAS,OAAO,UAAU,QAAQ,iBAAiB,MAAM,OAAO,IAAI,OAAO,IAAI,CAAC,GAAG,OAAO,GAAG,OAAO,MAAM,QAAQ;AAChH,mBAAe,OAAO,CAAC,IAAI,UAAU,IAAI;AAAA,EAC3C;AAEA,SAAO,WAAY;AACjB,aAAS,QAAQ,UAAU,QAAQ,QAAQ,MAAM,KAAK,GAAG,QAAQ,GAAG,QAAQ,OAAO,SAAS;AAC1F,YAAM,KAAK,IAAI,UAAU,KAAK;AAAA,IAChC;AAEA,QAAI,iBAAiB;AACrB,QAAI,aAAa,MAAM,IAAI;AAC3B,QAAI,eAAe,gBAAgB,KAAK;AAExC,QAAI,qBAAqB,QAAQ,MAAM,QAAW,CAAC,WAAY;AAC7D;AAEA,aAAO,WAAW,MAAM,MAAM,SAAS;AAAA,IACzC,CAAC,EAAE,OAAO,cAAc,CAAC;AAGzB,QAAI,WAAW,QAAQ,WAAY;AACjC,UAAI,SAAS,CAAC;AACd,UAAI,SAAS,aAAa;AAE1B,eAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAE/B,eAAO,KAAK,aAAa,CAAC,EAAE,MAAM,MAAM,SAAS,CAAC;AAAA,MACpD;AAGA,aAAO,mBAAmB,MAAM,MAAM,MAAM;AAAA,IAC9C,CAAC;AAED,aAAS,aAAa;AACtB,aAAS,eAAe;AACxB,aAAS,iBAAiB,WAAY;AACpC,aAAO;AAAA,IACT;AACA,aAAS,sBAAsB,WAAY;AACzC,aAAO,iBAAiB;AAAA,IAC1B;AACA,WAAO;AAAA,EACT;AACF;AAEO,IAAI,iBAAiB,sBAAsB,cAAc;;;AWlGhE,0BAAyB;AiBAzB,IAAAC,iBAAoB;AhBApB,SAAS,MAAMC,UAAY;AGA3B,SAAS,MAAMA,UAAY;;;AuJA3B;;;ACAA;;;ACAA;AAUA,IAAI,eAAe;AACnB,IAAI,uBAAuB;AAUpB,SAAS,eAAe,UAAU,MAAM,KAAK;AAClD,QAAMC,UAAQ,SAAS,MAAM,IAAI;AACjC,SAAOA,WAASA,QAAM,UAAU,OAAO,SAASA,QAAM,GAAG,GAAG,EAAE;AAChE;AAKO,SAAS,wBAAwBC,SAAQ,iBAAiB,SAAS;AACxE,MAAI,CAACA,QAAO,mBAAmB;AAC7B;AAAA,EACF;AACA,QAAM,QAAQA,QAAO,kBAAkB;AACvC,QAAM,yBAAyB,MAAM;AACrC,QAAM,mBAAmB,SAAS,iBAAiB,IAAI;AACrD,QAAI,oBAAoB,iBAAiB;AACvC,aAAO,uBAAuB,MAAM,MAAM,SAAS;AAAA,IACrD;AACA,UAAM,kBAAkB,CAAC,MAAM;AAC7B,YAAM,gBAAgB,QAAQ,CAAC;AAC/B,UAAI,eAAe;AACjB,YAAI,GAAG,aAAa;AAClB,aAAG,YAAY,aAAa;AAAA,QAC9B,OAAO;AACL,aAAG,aAAa;AAAA,QAClB;AAAA,MACF;AAAA,IACF;AACA,SAAK,YAAY,KAAK,aAAa,CAAC;AACpC,QAAI,CAAC,KAAK,UAAU,eAAe,GAAG;AACpC,WAAK,UAAU,eAAe,IAAI,oBAAI,IAAI;AAAA,IAC5C;AACA,SAAK,UAAU,eAAe,EAAE,IAAI,IAAI,eAAe;AACvD,WAAO,uBAAuB,MAAM,MAAM;AAAA,MAAC;AAAA,MACzC;AAAA,IAAe,CAAC;AAAA,EACpB;AAEA,QAAM,4BAA4B,MAAM;AACxC,QAAM,sBAAsB,SAAS,iBAAiB,IAAI;AACxD,QAAI,oBAAoB,mBAAmB,CAAC,KAAK,aAC1C,CAAC,KAAK,UAAU,eAAe,GAAG;AACvC,aAAO,0BAA0B,MAAM,MAAM,SAAS;AAAA,IACxD;AACA,QAAI,CAAC,KAAK,UAAU,eAAe,EAAE,IAAI,EAAE,GAAG;AAC5C,aAAO,0BAA0B,MAAM,MAAM,SAAS;AAAA,IACxD;AACA,UAAM,cAAc,KAAK,UAAU,eAAe,EAAE,IAAI,EAAE;AAC1D,SAAK,UAAU,eAAe,EAAE,OAAO,EAAE;AACzC,QAAI,KAAK,UAAU,eAAe,EAAE,SAAS,GAAG;AAC9C,aAAO,KAAK,UAAU,eAAe;AAAA,IACvC;AACA,QAAI,OAAO,KAAK,KAAK,SAAS,EAAE,WAAW,GAAG;AAC5C,aAAO,KAAK;AAAA,IACd;AACA,WAAO,0BAA0B,MAAM,MAAM;AAAA,MAAC;AAAA,MAC5C;AAAA,IAAW,CAAC;AAAA,EAChB;AAEA,SAAO,eAAe,OAAO,OAAO,iBAAiB;AAAA,IACnD,MAAM;AACJ,aAAO,KAAK,QAAQ,eAAe;AAAA,IACrC;AAAA,IACA,IAAI,IAAI;AACN,UAAI,KAAK,QAAQ,eAAe,GAAG;AACjC,aAAK;AAAA,UAAoB;AAAA,UACvB,KAAK,QAAQ,eAAe;AAAA,QAAC;AAC/B,eAAO,KAAK,QAAQ,eAAe;AAAA,MACrC;AACA,UAAI,IAAI;AACN,aAAK;AAAA,UAAiB;AAAA,UACpB,KAAK,QAAQ,eAAe,IAAI;AAAA,QAAE;AAAA,MACtC;AAAA,IACF;AAAA,IACA,YAAY;AAAA,IACZ,cAAc;AAAA,EAChB,CAAC;AACH;AAEO,SAAS,WAAW,MAAM;AAC/B,MAAI,OAAO,SAAS,WAAW;AAC7B,WAAO,IAAI,MAAM,oBAAoB,OAAO,OACxC,yBAAyB;AAAA,EAC/B;AACA,iBAAe;AACf,SAAQ,OAAQ,gCACd;AACJ;AAMO,SAAS,gBAAgB,MAAM;AACpC,MAAI,OAAO,SAAS,WAAW;AAC7B,WAAO,IAAI,MAAM,oBAAoB,OAAO,OACxC,yBAAyB;AAAA,EAC/B;AACA,yBAAuB,CAAC;AACxB,SAAO,sCAAsC,OAAO,aAAa;AACnE;AAEO,SAAS,MAAM;AACpB,MAAI,OAAO,WAAW,UAAU;AAC9B,QAAI,cAAc;AAChB;AAAA,IACF;AACA,QAAI,OAAO,YAAY,eAAe,OAAO,QAAQ,QAAQ,YAAY;AACvE,cAAQ,IAAI,MAAM,SAAS,SAAS;AAAA,IACtC;AAAA,EACF;AACF;AAKO,SAAS,WAAW,WAAW,WAAW;AAC/C,MAAI,CAAC,sBAAsB;AACzB;AAAA,EACF;AACA,UAAQ,KAAK,YAAY,gCAAgC,YACrD,WAAW;AACjB;AAQO,SAAS,cAAcA,SAAQ;AAEpC,QAAM,SAAS,EAAC,SAAS,MAAM,SAAS,KAAI;AAG5C,MAAI,OAAOA,YAAW,eAAe,CAACA,QAAO,aACzC,CAACA,QAAO,UAAU,WAAW;AAC/B,WAAO,UAAU;AACjB,WAAO;AAAA,EACT;AAEA,QAAM,EAAC,WAAAC,WAAS,IAAID;AAEpB,MAAIC,WAAU,iBAAiB;AAC7B,WAAO,UAAU;AACjB,WAAO,UAAU;AAAA,MAAeA,WAAU;AAAA,MACxC;AAAA,MAAoB;AAAA,IAAC;AAAA,EACzB,WAAWA,WAAU,sBAChBD,QAAO,oBAAoB,SAASA,QAAO,yBAA0B;AAKxE,WAAO,UAAU;AACjB,WAAO,UAAU;AAAA,MAAeC,WAAU;AAAA,MACxC;AAAA,MAAyB;AAAA,IAAC;AAAA,EAC9B,WAAWD,QAAO,qBACdC,WAAU,UAAU,MAAM,sBAAsB,GAAG;AACrD,WAAO,UAAU;AACjB,WAAO,UAAU;AAAA,MAAeA,WAAU;AAAA,MACxC;AAAA,MAAwB;AAAA,IAAC;AAC3B,WAAO,sBAAsBD,QAAO,qBAChC,sBAAsBA,QAAO,kBAAkB;AAAA,EACrD,OAAO;AACL,WAAO,UAAU;AACjB,WAAO;AAAA,EACT;AAEA,SAAO;AACT;AAQA,SAAS,SAAS,KAAK;AACrB,SAAO,OAAO,UAAU,SAAS,KAAK,GAAG,MAAM;AACjD;AAOO,SAAS,cAAcE,OAAM;AAClC,MAAI,CAAC,SAASA,KAAI,GAAG;AACnB,WAAOA;AAAA,EACT;AAEA,SAAO,OAAO,KAAKA,KAAI,EAAE,OAAO,SAAS,aAAa,KAAK;AACzD,UAAM,QAAQ,SAASA,MAAK,GAAG,CAAC;AAChC,UAAM,QAAQ,QAAQ,cAAcA,MAAK,GAAG,CAAC,IAAIA,MAAK,GAAG;AACzD,UAAM,gBAAgB,SAAS,CAAC,OAAO,KAAK,KAAK,EAAE;AACnD,QAAI,UAAU,UAAa,eAAe;AACxC,aAAO;AAAA,IACT;AACA,WAAO,OAAO,OAAO,aAAa,EAAC,CAAC,GAAG,GAAG,MAAK,CAAC;AAAA,EAClD,GAAG,CAAC,CAAC;AACP;AAGO,SAAS,UAAU,OAAO,MAAM,WAAW;AAChD,MAAI,CAAC,QAAQ,UAAU,IAAI,KAAK,EAAE,GAAG;AACnC;AAAA,EACF;AACA,YAAU,IAAI,KAAK,IAAI,IAAI;AAC3B,SAAO,KAAK,IAAI,EAAE,QAAQ,UAAQ;AAChC,QAAI,KAAK,SAAS,IAAI,GAAG;AACvB,gBAAU,OAAO,MAAM,IAAI,KAAK,IAAI,CAAC,GAAG,SAAS;AAAA,IACnD,WAAW,KAAK,SAAS,KAAK,GAAG;AAC/B,WAAK,IAAI,EAAE,QAAQ,QAAM;AACvB,kBAAU,OAAO,MAAM,IAAI,EAAE,GAAG,SAAS;AAAA,MAC3C,CAAC;AAAA,IACH;AAAA,EACF,CAAC;AACH;AAGO,SAAS,YAAY,QAAQ,OAAO,UAAU;AACnD,QAAM,kBAAkB,WAAW,iBAAiB;AACpD,QAAM,iBAAiB,oBAAI,IAAI;AAC/B,MAAI,UAAU,MAAM;AAClB,WAAO;AAAA,EACT;AACA,QAAM,aAAa,CAAC;AACpB,SAAO,QAAQ,WAAS;AACtB,QAAI,MAAM,SAAS,WACf,MAAM,oBAAoB,MAAM,IAAI;AACtC,iBAAW,KAAK,KAAK;AAAA,IACvB;AAAA,EACF,CAAC;AACD,aAAW,QAAQ,eAAa;AAC9B,WAAO,QAAQ,WAAS;AACtB,UAAI,MAAM,SAAS,mBAAmB,MAAM,YAAY,UAAU,IAAI;AACpE,kBAAU,QAAQ,OAAO,cAAc;AAAA,MACzC;AAAA,IACF,CAAC;AAAA,EACH,CAAC;AACD,SAAO;AACT;;;ACrQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAA;AAUA,IAAM,UAAgB;AAEf,SAAS,iBAAiBC,SAAQ,gBAAgB;AACvD,QAAMC,aAAYD,WAAUA,QAAO;AAEnC,MAAI,CAACC,WAAU,cAAc;AAC3B;AAAA,EACF;AAEA,QAAM,uBAAuB,SAASC,IAAG;AACvC,QAAI,OAAOA,OAAM,YAAYA,GAAE,aAAaA,GAAE,UAAU;AACtD,aAAOA;AAAA,IACT;AACA,UAAMC,MAAK,CAAC;AACZ,WAAO,KAAKD,EAAC,EAAE,QAAQ,SAAO;AAC5B,UAAI,QAAQ,aAAa,QAAQ,cAAc,QAAQ,eAAe;AACpE;AAAA,MACF;AACA,YAAM,IAAK,OAAOA,GAAE,GAAG,MAAM,WAAYA,GAAE,GAAG,IAAI,EAAC,OAAOA,GAAE,GAAG,EAAC;AAChE,UAAI,EAAE,UAAU,UAAa,OAAO,EAAE,UAAU,UAAU;AACxD,UAAE,MAAM,EAAE,MAAM,EAAE;AAAA,MACpB;AACA,YAAM,WAAW,SAAS,QAAQ,MAAM;AACtC,YAAI,QAAQ;AACV,iBAAO,SAAS,KAAK,OAAO,CAAC,EAAE,YAAY,IAAI,KAAK,MAAM,CAAC;AAAA,QAC7D;AACA,eAAQ,SAAS,aAAc,aAAa;AAAA,MAC9C;AACA,UAAI,EAAE,UAAU,QAAW;AACzB,QAAAC,IAAG,WAAWA,IAAG,YAAY,CAAC;AAC9B,YAAI,KAAK,CAAC;AACV,YAAI,OAAO,EAAE,UAAU,UAAU;AAC/B,aAAG,SAAS,OAAO,GAAG,CAAC,IAAI,EAAE;AAC7B,UAAAA,IAAG,SAAS,KAAK,EAAE;AACnB,eAAK,CAAC;AACN,aAAG,SAAS,OAAO,GAAG,CAAC,IAAI,EAAE;AAC7B,UAAAA,IAAG,SAAS,KAAK,EAAE;AAAA,QACrB,OAAO;AACL,aAAG,SAAS,IAAI,GAAG,CAAC,IAAI,EAAE;AAC1B,UAAAA,IAAG,SAAS,KAAK,EAAE;AAAA,QACrB;AAAA,MACF;AACA,UAAI,EAAE,UAAU,UAAa,OAAO,EAAE,UAAU,UAAU;AACxD,QAAAA,IAAG,YAAYA,IAAG,aAAa,CAAC;AAChC,QAAAA,IAAG,UAAU,SAAS,IAAI,GAAG,CAAC,IAAI,EAAE;AAAA,MACtC,OAAO;AACL,SAAC,OAAO,KAAK,EAAE,QAAQ,SAAO;AAC5B,cAAI,EAAE,GAAG,MAAM,QAAW;AACxB,YAAAA,IAAG,YAAYA,IAAG,aAAa,CAAC;AAChC,YAAAA,IAAG,UAAU,SAAS,KAAK,GAAG,CAAC,IAAI,EAAE,GAAG;AAAA,UAC1C;AAAA,QACF,CAAC;AAAA,MACH;AAAA,IACF,CAAC;AACD,QAAID,GAAE,UAAU;AACd,MAAAC,IAAG,YAAYA,IAAG,YAAY,CAAC,GAAG,OAAOD,GAAE,QAAQ;AAAA,IACrD;AACA,WAAOC;AAAA,EACT;AAEA,QAAM,mBAAmB,SAAS,aAAa,MAAM;AACnD,QAAI,eAAe,WAAW,IAAI;AAChC,aAAO,KAAK,WAAW;AAAA,IACzB;AACA,kBAAc,KAAK,MAAM,KAAK,UAAU,WAAW,CAAC;AACpD,QAAI,eAAe,OAAO,YAAY,UAAU,UAAU;AACxD,YAAM,QAAQ,SAAS,KAAKC,IAAGC,IAAG;AAChC,YAAID,MAAK,OAAO,EAAEC,MAAK,MAAM;AAC3B,cAAIA,EAAC,IAAI,IAAID,EAAC;AACd,iBAAO,IAAIA,EAAC;AAAA,QACd;AAAA,MACF;AACA,oBAAc,KAAK,MAAM,KAAK,UAAU,WAAW,CAAC;AACpD,YAAM,YAAY,OAAO,mBAAmB,qBAAqB;AACjE,YAAM,YAAY,OAAO,oBAAoB,sBAAsB;AACnE,kBAAY,QAAQ,qBAAqB,YAAY,KAAK;AAAA,IAC5D;AACA,QAAI,eAAe,OAAO,YAAY,UAAU,UAAU;AAExD,UAAI,OAAO,YAAY,MAAM;AAC7B,aAAO,SAAU,OAAO,SAAS,WAAY,OAAO,EAAC,OAAO,KAAI;AAChE,YAAM,6BAA6B,eAAe,UAAU;AAE5D,UAAK,SAAS,KAAK,UAAU,UAAU,KAAK,UAAU,iBACxC,KAAK,UAAU,UAAU,KAAK,UAAU,kBAClD,EAAEH,WAAU,aAAa,2BACvBA,WAAU,aAAa,wBAAwB,EAAE,cACjD,CAAC,6BAA6B;AAClC,eAAO,YAAY,MAAM;AACzB,YAAI;AACJ,YAAI,KAAK,UAAU,iBAAiB,KAAK,UAAU,eAAe;AAChE,oBAAU,CAAC,QAAQ,MAAM;AAAA,QAC3B,WAAW,KAAK,UAAU,UAAU,KAAK,UAAU,QAAQ;AACzD,oBAAU,CAAC,OAAO;AAAA,QACpB;AACA,YAAI,SAAS;AAEX,iBAAOA,WAAU,aAAa,iBAAiB,EAC5C,KAAK,aAAW;AACf,sBAAU,QAAQ,OAAO,OAAK,EAAE,SAAS,YAAY;AACrD,gBAAI,MAAM,QAAQ,KAAK,OAAK,QAAQ,KAAK,CAAAK,YACvC,EAAE,MAAM,YAAY,EAAE,SAASA,OAAK,CAAC,CAAC;AACxC,gBAAI,CAAC,OAAO,QAAQ,UAAU,QAAQ,SAAS,MAAM,GAAG;AACtD,oBAAM,QAAQ,QAAQ,SAAS,CAAC;AAAA,YAClC;AACA,gBAAI,KAAK;AACP,0BAAY,MAAM,WAAW,KAAK,QAC9B,EAAC,OAAO,IAAI,SAAQ,IACpB,EAAC,OAAO,IAAI,SAAQ;AAAA,YAC1B;AACA,wBAAY,QAAQ,qBAAqB,YAAY,KAAK;AAC1D,oBAAQ,aAAa,KAAK,UAAU,WAAW,CAAC;AAChD,mBAAO,KAAK,WAAW;AAAA,UACzB,CAAC;AAAA,QACL;AAAA,MACF;AACA,kBAAY,QAAQ,qBAAqB,YAAY,KAAK;AAAA,IAC5D;AACA,YAAQ,aAAa,KAAK,UAAU,WAAW,CAAC;AAChD,WAAO,KAAK,WAAW;AAAA,EACzB;AAEA,QAAM,aAAa,SAAS,GAAG;AAC7B,QAAI,eAAe,WAAW,IAAI;AAChC,aAAO;AAAA,IACT;AACA,WAAO;AAAA,MACL,MAAM;AAAA,QACJ,uBAAuB;AAAA,QACvB,0BAA0B;AAAA,QAC1B,mBAAmB;AAAA,QACnB,sBAAsB;AAAA,QACtB,6BAA6B;AAAA,QAC7B,iBAAiB;AAAA,QACjB,gCAAgC;AAAA,QAChC,yBAAyB;AAAA,QACzB,iBAAiB;AAAA,QACjB,oBAAoB;AAAA,QACpB,oBAAoB;AAAA,MACtB,EAAE,EAAE,IAAI,KAAK,EAAE;AAAA,MACf,SAAS,EAAE;AAAA,MACX,YAAY,EAAE,cAAc,EAAE;AAAA,MAC9B,WAAW;AACT,eAAO,KAAK,QAAQ,KAAK,WAAW,QAAQ,KAAK;AAAA,MACnD;AAAA,IACF;AAAA,EACF;AAEA,QAAM,gBAAgB,SAAS,aAAa,WAAW,SAAS;AAC9D,qBAAiB,aAAa,CAAAJ,OAAK;AACjC,MAAAD,WAAU,mBAAmBC,IAAG,WAAW,OAAK;AAC9C,YAAI,SAAS;AACX,kBAAQ,WAAW,CAAC,CAAC;AAAA,QACvB;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAAA,EACH;AACA,EAAAD,WAAU,eAAe,cAAc,KAAKA,UAAS;AAKrD,MAAIA,WAAU,aAAa,cAAc;AACvC,UAAM,mBAAmBA,WAAU,aAAa,aAC9C,KAAKA,WAAU,YAAY;AAC7B,IAAAA,WAAU,aAAa,eAAe,SAASM,KAAI;AACjD,aAAO,iBAAiBA,KAAI,CAAAL,OAAK,iBAAiBA,EAAC,EAAE,KAAK,YAAU;AAClE,YAAIA,GAAE,SAAS,CAAC,OAAO,eAAe,EAAE,UACpCA,GAAE,SAAS,CAAC,OAAO,eAAe,EAAE,QAAQ;AAC9C,iBAAO,UAAU,EAAE,QAAQ,WAAS;AAClC,kBAAM,KAAK;AAAA,UACb,CAAC;AACD,gBAAM,IAAI,aAAa,IAAI,eAAe;AAAA,QAC5C;AACA,eAAO;AAAA,MACT,GAAG,OAAK,QAAQ,OAAO,WAAW,CAAC,CAAC,CAAC,CAAC;AAAA,IACxC;AAAA,EACF;AACF;;;AC5LA;AASO,SAAS,oBAAoBM,SAAQ,aAAa;AACvD,MAAIA,QAAO,UAAU,gBACnB,qBAAqBA,QAAO,UAAU,cAAc;AACpD;AAAA,EACF;AACA,MAAI,CAAEA,QAAO,UAAU,cAAe;AACpC;AAAA,EACF;AAGA,MAAI,OAAO,gBAAgB,YAAY;AACrC,YAAQ,MAAM,6DACE;AAChB;AAAA,EACF;AACA,EAAAA,QAAO,UAAU,aAAa,kBAC5B,SAAS,gBAAgB,aAAa;AACpC,WAAO,YAAY,WAAW,EAC3B,KAAK,cAAY;AAChB,YAAM,iBAAiB,YAAY,SAAS,YAAY,MAAM;AAC9D,YAAM,kBAAkB,YAAY,SAClC,YAAY,MAAM;AACpB,YAAM,qBAAqB,YAAY,SACrC,YAAY,MAAM;AACpB,kBAAY,QAAQ;AAAA,QAClB,WAAW;AAAA,UACT,mBAAmB;AAAA,UACnB,qBAAqB;AAAA,UACrB,cAAc,sBAAsB;AAAA,QACtC;AAAA,MACF;AACA,UAAI,gBAAgB;AAClB,oBAAY,MAAM,UAAU,WAAW;AAAA,MACzC;AACA,UAAI,iBAAiB;AACnB,oBAAY,MAAM,UAAU,YAAY;AAAA,MAC1C;AACA,aAAOA,QAAO,UAAU,aAAa,aAAa,WAAW;AAAA,IAC/D,CAAC;AAAA,EACL;AACJ;;;AFnCO,SAAS,gBAAgBC,SAAQ;AACtC,EAAAA,QAAO,cAAcA,QAAO,eAAeA,QAAO;AACpD;AAEO,SAAS,YAAYA,SAAQ;AAClC,MAAI,OAAOA,YAAW,YAAYA,QAAO,qBAAqB,EAAE,aAC5DA,QAAO,kBAAkB,YAAY;AACvC,WAAO,eAAeA,QAAO,kBAAkB,WAAW,WAAW;AAAA,MACnE,MAAM;AACJ,eAAO,KAAK;AAAA,MACd;AAAA,MACA,IAAIC,IAAG;AACL,YAAI,KAAK,UAAU;AACjB,eAAK,oBAAoB,SAAS,KAAK,QAAQ;AAAA,QACjD;AACA,aAAK,iBAAiB,SAAS,KAAK,WAAWA,EAAC;AAAA,MAClD;AAAA,MACA,YAAY;AAAA,MACZ,cAAc;AAAA,IAChB,CAAC;AACD,UAAM,2BACFD,QAAO,kBAAkB,UAAU;AACvC,IAAAA,QAAO,kBAAkB,UAAU,uBACjC,SAAS,uBAAuB;AAC9B,UAAI,CAAC,KAAK,cAAc;AACtB,aAAK,eAAe,CAAC,MAAM;AAGzB,YAAE,OAAO,iBAAiB,YAAY,QAAM;AAC1C,gBAAI;AACJ,gBAAIA,QAAO,kBAAkB,UAAU,cAAc;AACnD,yBAAW,KAAK,aAAa,EAC1B,KAAK,OAAK,EAAE,SAAS,EAAE,MAAM,OAAO,GAAG,MAAM,EAAE;AAAA,YACpD,OAAO;AACL,yBAAW,EAAC,OAAO,GAAG,MAAK;AAAA,YAC7B;AAEA,kBAAM,QAAQ,IAAI,MAAM,OAAO;AAC/B,kBAAM,QAAQ,GAAG;AACjB,kBAAM,WAAW;AACjB,kBAAM,cAAc,EAAC,SAAQ;AAC7B,kBAAM,UAAU,CAAC,EAAE,MAAM;AACzB,iBAAK,cAAc,KAAK;AAAA,UAC1B,CAAC;AACD,YAAE,OAAO,UAAU,EAAE,QAAQ,WAAS;AACpC,gBAAI;AACJ,gBAAIA,QAAO,kBAAkB,UAAU,cAAc;AACnD,yBAAW,KAAK,aAAa,EAC1B,KAAK,OAAK,EAAE,SAAS,EAAE,MAAM,OAAO,MAAM,EAAE;AAAA,YACjD,OAAO;AACL,yBAAW,EAAC,MAAK;AAAA,YACnB;AACA,kBAAM,QAAQ,IAAI,MAAM,OAAO;AAC/B,kBAAM,QAAQ;AACd,kBAAM,WAAW;AACjB,kBAAM,cAAc,EAAC,SAAQ;AAC7B,kBAAM,UAAU,CAAC,EAAE,MAAM;AACzB,iBAAK,cAAc,KAAK;AAAA,UAC1B,CAAC;AAAA,QACH;AACA,aAAK,iBAAiB,aAAa,KAAK,YAAY;AAAA,MACtD;AACA,aAAO,yBAAyB,MAAM,MAAM,SAAS;AAAA,IACvD;AAAA,EACJ,OAAO;AAIL,IAAM,wBAAwBA,SAAQ,SAAS,OAAK;AAClD,UAAI,CAAC,EAAE,aAAa;AAClB,eAAO;AAAA,UAAe;AAAA,UAAG;AAAA,UACvB,EAAC,OAAO,EAAC,UAAU,EAAE,SAAQ,EAAC;AAAA,QAAC;AAAA,MACnC;AACA,aAAO;AAAA,IACT,CAAC;AAAA,EACH;AACF;AAEO,SAAS,uBAAuBA,SAAQ;AAE7C,MAAI,OAAOA,YAAW,YAAYA,QAAO,qBACrC,EAAE,gBAAgBA,QAAO,kBAAkB,cAC3C,sBAAsBA,QAAO,kBAAkB,WAAW;AAC5D,UAAM,qBAAqB,SAAS,IAAI,OAAO;AAC7C,aAAO;AAAA,QACL;AAAA,QACA,IAAI,OAAO;AACT,cAAI,KAAK,UAAU,QAAW;AAC5B,gBAAI,MAAM,SAAS,SAAS;AAC1B,mBAAK,QAAQ,GAAG,iBAAiB,KAAK;AAAA,YACxC,OAAO;AACL,mBAAK,QAAQ;AAAA,YACf;AAAA,UACF;AACA,iBAAO,KAAK;AAAA,QACd;AAAA,QACA,KAAK;AAAA,MACP;AAAA,IACF;AAGA,QAAI,CAACA,QAAO,kBAAkB,UAAU,YAAY;AAClD,MAAAA,QAAO,kBAAkB,UAAU,aAAa,SAAS,aAAa;AACpE,aAAK,WAAW,KAAK,YAAY,CAAC;AAClC,eAAO,KAAK,SAAS,MAAM;AAAA,MAC7B;AACA,YAAM,eAAeA,QAAO,kBAAkB,UAAU;AACxD,MAAAA,QAAO,kBAAkB,UAAU,WACjC,SAAS,SAAS,OAAO,QAAQ;AAC/B,YAAI,SAAS,aAAa,MAAM,MAAM,SAAS;AAC/C,YAAI,CAAC,QAAQ;AACX,mBAAS,mBAAmB,MAAM,KAAK;AACvC,eAAK,SAAS,KAAK,MAAM;AAAA,QAC3B;AACA,eAAO;AAAA,MACT;AAEF,YAAM,kBAAkBA,QAAO,kBAAkB,UAAU;AAC3D,MAAAA,QAAO,kBAAkB,UAAU,cACjC,SAAS,YAAY,QAAQ;AAC3B,wBAAgB,MAAM,MAAM,SAAS;AACrC,cAAM,MAAM,KAAK,SAAS,QAAQ,MAAM;AACxC,YAAI,QAAQ,IAAI;AACd,eAAK,SAAS,OAAO,KAAK,CAAC;AAAA,QAC7B;AAAA,MACF;AAAA,IACJ;AACA,UAAM,gBAAgBA,QAAO,kBAAkB,UAAU;AACzD,IAAAA,QAAO,kBAAkB,UAAU,YAAY,SAAS,UAAU,QAAQ;AACxE,WAAK,WAAW,KAAK,YAAY,CAAC;AAClC,oBAAc,MAAM,MAAM,CAAC,MAAM,CAAC;AAClC,aAAO,UAAU,EAAE,QAAQ,WAAS;AAClC,aAAK,SAAS,KAAK,mBAAmB,MAAM,KAAK,CAAC;AAAA,MACpD,CAAC;AAAA,IACH;AAEA,UAAM,mBAAmBA,QAAO,kBAAkB,UAAU;AAC5D,IAAAA,QAAO,kBAAkB,UAAU,eACjC,SAAS,aAAa,QAAQ;AAC5B,WAAK,WAAW,KAAK,YAAY,CAAC;AAClC,uBAAiB,MAAM,MAAM,CAAC,MAAM,CAAC;AAErC,aAAO,UAAU,EAAE,QAAQ,WAAS;AAClC,cAAM,SAAS,KAAK,SAAS,KAAK,OAAK,EAAE,UAAU,KAAK;AACxD,YAAI,QAAQ;AACV,eAAK,SAAS,OAAO,KAAK,SAAS,QAAQ,MAAM,GAAG,CAAC;AAAA,QACvD;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACJ,WAAW,OAAOA,YAAW,YAAYA,QAAO,qBACrC,gBAAgBA,QAAO,kBAAkB,aACzC,sBAAsBA,QAAO,kBAAkB,aAC/CA,QAAO,gBACP,EAAE,UAAUA,QAAO,aAAa,YAAY;AACrD,UAAM,iBAAiBA,QAAO,kBAAkB,UAAU;AAC1D,IAAAA,QAAO,kBAAkB,UAAU,aAAa,SAAS,aAAa;AACpE,YAAM,UAAU,eAAe,MAAM,MAAM,CAAC,CAAC;AAC7C,cAAQ,QAAQ,YAAU,OAAO,MAAM,IAAI;AAC3C,aAAO;AAAA,IACT;AAEA,WAAO,eAAeA,QAAO,aAAa,WAAW,QAAQ;AAAA,MAC3D,MAAM;AACJ,YAAI,KAAK,UAAU,QAAW;AAC5B,cAAI,KAAK,MAAM,SAAS,SAAS;AAC/B,iBAAK,QAAQ,KAAK,IAAI,iBAAiB,KAAK,KAAK;AAAA,UACnD,OAAO;AACL,iBAAK,QAAQ;AAAA,UACf;AAAA,QACF;AACA,eAAO,KAAK;AAAA,MACd;AAAA,IACF,CAAC;AAAA,EACH;AACF;AAEO,SAAS,aAAaA,SAAQ;AACnC,MAAI,CAACA,QAAO,mBAAmB;AAC7B;AAAA,EACF;AAEA,QAAM,eAAeA,QAAO,kBAAkB,UAAU;AACxD,EAAAA,QAAO,kBAAkB,UAAU,WAAW,SAAS,WAAW;AAChE,UAAM,CAAC,UAAU,QAAQ,KAAK,IAAI;AAIlC,QAAI,UAAU,SAAS,KAAK,OAAO,aAAa,YAAY;AAC1D,aAAO,aAAa,MAAM,MAAM,SAAS;AAAA,IAC3C;AAIA,QAAI,aAAa,WAAW,MAAM,UAAU,WAAW,KACnD,OAAO,aAAa,aAAa;AACnC,aAAO,aAAa,MAAM,MAAM,CAAC,CAAC;AAAA,IACpC;AAEA,UAAM,kBAAkB,SAAS,UAAU;AACzC,YAAM,iBAAiB,CAAC;AACxB,YAAM,UAAU,SAAS,OAAO;AAChC,cAAQ,QAAQ,YAAU;AACxB,cAAM,gBAAgB;AAAA,UACpB,IAAI,OAAO;AAAA,UACX,WAAW,OAAO;AAAA,UAClB,MAAM;AAAA,YACJ,gBAAgB;AAAA,YAChB,iBAAiB;AAAA,UACnB,EAAE,OAAO,IAAI,KAAK,OAAO;AAAA,QAC3B;AACA,eAAO,MAAM,EAAE,QAAQ,UAAQ;AAC7B,wBAAc,IAAI,IAAI,OAAO,KAAK,IAAI;AAAA,QACxC,CAAC;AACD,uBAAe,cAAc,EAAE,IAAI;AAAA,MACrC,CAAC;AAED,aAAO;AAAA,IACT;AAGA,UAAM,eAAe,SAAS,OAAO;AACnC,aAAO,IAAI,IAAI,OAAO,KAAK,KAAK,EAAE,IAAI,SAAO,CAAC,KAAK,MAAM,GAAG,CAAC,CAAC,CAAC;AAAA,IACjE;AAEA,QAAI,UAAU,UAAU,GAAG;AACzB,YAAM,0BAA0B,SAAS,UAAU;AACjD,eAAO,aAAa,gBAAgB,QAAQ,CAAC,CAAC;AAAA,MAChD;AAEA,aAAO,aAAa,MAAM,MAAM;AAAA,QAAC;AAAA,QAC/B;AAAA,MAAQ,CAAC;AAAA,IACb;AAGA,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,mBAAa,MAAM,MAAM;AAAA,QACvB,SAAS,UAAU;AACjB,kBAAQ,aAAa,gBAAgB,QAAQ,CAAC,CAAC;AAAA,QACjD;AAAA,QAAG;AAAA,MAAM,CAAC;AAAA,IACd,CAAC,EAAE,KAAK,QAAQ,KAAK;AAAA,EACvB;AACF;AAEO,SAAS,2BAA2BA,SAAQ;AACjD,MAAI,EAAE,OAAOA,YAAW,YAAYA,QAAO,qBACvCA,QAAO,gBAAgBA,QAAO,iBAAiB;AACjD;AAAA,EACF;AAGA,MAAI,EAAE,cAAcA,QAAO,aAAa,YAAY;AAClD,UAAM,iBAAiBA,QAAO,kBAAkB,UAAU;AAC1D,QAAI,gBAAgB;AAClB,MAAAA,QAAO,kBAAkB,UAAU,aAAa,SAAS,aAAa;AACpE,cAAM,UAAU,eAAe,MAAM,MAAM,CAAC,CAAC;AAC7C,gBAAQ,QAAQ,YAAU,OAAO,MAAM,IAAI;AAC3C,eAAO;AAAA,MACT;AAAA,IACF;AAEA,UAAM,eAAeA,QAAO,kBAAkB,UAAU;AACxD,QAAI,cAAc;AAChB,MAAAA,QAAO,kBAAkB,UAAU,WAAW,SAAS,WAAW;AAChE,cAAM,SAAS,aAAa,MAAM,MAAM,SAAS;AACjD,eAAO,MAAM;AACb,eAAO;AAAA,MACT;AAAA,IACF;AACA,IAAAA,QAAO,aAAa,UAAU,WAAW,SAAS,WAAW;AAC3D,YAAM,SAAS;AACf,aAAO,KAAK,IAAI,SAAS,EAAE,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,QAKxB,YAAY,QAAQ,OAAO,OAAO,IAAI;AAAA,OAAC;AAAA,IACjD;AAAA,EACF;AAGA,MAAI,EAAE,cAAcA,QAAO,eAAe,YAAY;AACpD,UAAM,mBAAmBA,QAAO,kBAAkB,UAAU;AAC5D,QAAI,kBAAkB;AACpB,MAAAA,QAAO,kBAAkB,UAAU,eACjC,SAAS,eAAe;AACtB,cAAM,YAAY,iBAAiB,MAAM,MAAM,CAAC,CAAC;AACjD,kBAAU,QAAQ,cAAY,SAAS,MAAM,IAAI;AACjD,eAAO;AAAA,MACT;AAAA,IACJ;AACA,IAAM,wBAAwBA,SAAQ,SAAS,OAAK;AAClD,QAAE,SAAS,MAAM,EAAE;AACnB,aAAO;AAAA,IACT,CAAC;AACD,IAAAA,QAAO,eAAe,UAAU,WAAW,SAAS,WAAW;AAC7D,YAAM,WAAW;AACjB,aAAO,KAAK,IAAI,SAAS,EAAE,KAAK,YACxB,YAAY,QAAQ,SAAS,OAAO,KAAK,CAAC;AAAA,IACpD;AAAA,EACF;AAEA,MAAI,EAAE,cAAcA,QAAO,aAAa,aACpC,cAAcA,QAAO,eAAe,YAAY;AAClD;AAAA,EACF;AAGA,QAAM,eAAeA,QAAO,kBAAkB,UAAU;AACxD,EAAAA,QAAO,kBAAkB,UAAU,WAAW,SAAS,WAAW;AAChE,QAAI,UAAU,SAAS,KACnB,UAAU,CAAC,aAAaA,QAAO,kBAAkB;AACnD,YAAM,QAAQ,UAAU,CAAC;AACzB,UAAI;AACJ,UAAI;AACJ,UAAI;AACJ,WAAK,WAAW,EAAE,QAAQ,OAAK;AAC7B,YAAI,EAAE,UAAU,OAAO;AACrB,cAAI,QAAQ;AACV,kBAAM;AAAA,UACR,OAAO;AACL,qBAAS;AAAA,UACX;AAAA,QACF;AAAA,MACF,CAAC;AACD,WAAK,aAAa,EAAE,QAAQ,OAAK;AAC/B,YAAI,EAAE,UAAU,OAAO;AACrB,cAAI,UAAU;AACZ,kBAAM;AAAA,UACR,OAAO;AACL,uBAAW;AAAA,UACb;AAAA,QACF;AACA,eAAO,EAAE,UAAU;AAAA,MACrB,CAAC;AACD,UAAI,OAAQ,UAAU,UAAW;AAC/B,eAAO,QAAQ,OAAO,IAAI;AAAA,UACxB;AAAA,UACA;AAAA,QAAoB,CAAC;AAAA,MACzB,WAAW,QAAQ;AACjB,eAAO,OAAO,SAAS;AAAA,MACzB,WAAW,UAAU;AACnB,eAAO,SAAS,SAAS;AAAA,MAC3B;AACA,aAAO,QAAQ,OAAO,IAAI;AAAA,QACxB;AAAA,QACA;AAAA,MAAoB,CAAC;AAAA,IACzB;AACA,WAAO,aAAa,MAAM,MAAM,SAAS;AAAA,EAC3C;AACF;AAEO,SAAS,kCAAkCA,SAAQ;AAIxD,EAAAA,QAAO,kBAAkB,UAAU,kBACjC,SAAS,kBAAkB;AACzB,SAAK,uBAAuB,KAAK,wBAAwB,CAAC;AAC1D,WAAO,OAAO,KAAK,KAAK,oBAAoB,EACzC,IAAI,cAAY,KAAK,qBAAqB,QAAQ,EAAE,CAAC,CAAC;AAAA,EAC3D;AAEF,QAAM,eAAeA,QAAO,kBAAkB,UAAU;AACxD,EAAAA,QAAO,kBAAkB,UAAU,WACjC,SAAS,SAAS,OAAO,QAAQ;AAC/B,QAAI,CAAC,QAAQ;AACX,aAAO,aAAa,MAAM,MAAM,SAAS;AAAA,IAC3C;AACA,SAAK,uBAAuB,KAAK,wBAAwB,CAAC;AAE1D,UAAM,SAAS,aAAa,MAAM,MAAM,SAAS;AACjD,QAAI,CAAC,KAAK,qBAAqB,OAAO,EAAE,GAAG;AACzC,WAAK,qBAAqB,OAAO,EAAE,IAAI,CAAC,QAAQ,MAAM;AAAA,IACxD,WAAW,KAAK,qBAAqB,OAAO,EAAE,EAAE,QAAQ,MAAM,MAAM,IAAI;AACtE,WAAK,qBAAqB,OAAO,EAAE,EAAE,KAAK,MAAM;AAAA,IAClD;AACA,WAAO;AAAA,EACT;AAEF,QAAM,gBAAgBA,QAAO,kBAAkB,UAAU;AACzD,EAAAA,QAAO,kBAAkB,UAAU,YAAY,SAAS,UAAU,QAAQ;AACxE,SAAK,uBAAuB,KAAK,wBAAwB,CAAC;AAE1D,WAAO,UAAU,EAAE,QAAQ,WAAS;AAClC,YAAM,gBAAgB,KAAK,WAAW,EAAE,KAAK,OAAK,EAAE,UAAU,KAAK;AACnE,UAAI,eAAe;AACjB,cAAM,IAAI;AAAA,UAAa;AAAA,UACrB;AAAA,QAAoB;AAAA,MACxB;AAAA,IACF,CAAC;AACD,UAAM,kBAAkB,KAAK,WAAW;AACxC,kBAAc,MAAM,MAAM,SAAS;AACnC,UAAM,aAAa,KAAK,WAAW,EAChC,OAAO,eAAa,gBAAgB,QAAQ,SAAS,MAAM,EAAE;AAChE,SAAK,qBAAqB,OAAO,EAAE,IAAI,CAAC,MAAM,EAAE,OAAO,UAAU;AAAA,EACnE;AAEA,QAAM,mBAAmBA,QAAO,kBAAkB,UAAU;AAC5D,EAAAA,QAAO,kBAAkB,UAAU,eACjC,SAAS,aAAa,QAAQ;AAC5B,SAAK,uBAAuB,KAAK,wBAAwB,CAAC;AAC1D,WAAO,KAAK,qBAAqB,OAAO,EAAE;AAC1C,WAAO,iBAAiB,MAAM,MAAM,SAAS;AAAA,EAC/C;AAEF,QAAM,kBAAkBA,QAAO,kBAAkB,UAAU;AAC3D,EAAAA,QAAO,kBAAkB,UAAU,cACjC,SAAS,YAAY,QAAQ;AAC3B,SAAK,uBAAuB,KAAK,wBAAwB,CAAC;AAC1D,QAAI,QAAQ;AACV,aAAO,KAAK,KAAK,oBAAoB,EAAE,QAAQ,cAAY;AACzD,cAAM,MAAM,KAAK,qBAAqB,QAAQ,EAAE,QAAQ,MAAM;AAC9D,YAAI,QAAQ,IAAI;AACd,eAAK,qBAAqB,QAAQ,EAAE,OAAO,KAAK,CAAC;AAAA,QACnD;AACA,YAAI,KAAK,qBAAqB,QAAQ,EAAE,WAAW,GAAG;AACpD,iBAAO,KAAK,qBAAqB,QAAQ;AAAA,QAC3C;AAAA,MACF,CAAC;AAAA,IACH;AACA,WAAO,gBAAgB,MAAM,MAAM,SAAS;AAAA,EAC9C;AACJ;AAEO,SAAS,wBAAwBA,SAAQ,gBAAgB;AAC9D,MAAI,CAACA,QAAO,mBAAmB;AAC7B;AAAA,EACF;AAEA,MAAIA,QAAO,kBAAkB,UAAU,YACnC,eAAe,WAAW,IAAI;AAChC,WAAO,kCAAkCA,OAAM;AAAA,EACjD;AAIA,QAAM,sBAAsBA,QAAO,kBAAkB,UAClD;AACH,EAAAA,QAAO,kBAAkB,UAAU,kBACjC,SAAS,kBAAkB;AACzB,UAAM,gBAAgB,oBAAoB,MAAM,IAAI;AACpD,SAAK,kBAAkB,KAAK,mBAAmB,CAAC;AAChD,WAAO,cAAc,IAAI,YAAU,KAAK,gBAAgB,OAAO,EAAE,CAAC;AAAA,EACpE;AAEF,QAAM,gBAAgBA,QAAO,kBAAkB,UAAU;AACzD,EAAAA,QAAO,kBAAkB,UAAU,YAAY,SAAS,UAAU,QAAQ;AACxE,SAAK,WAAW,KAAK,YAAY,CAAC;AAClC,SAAK,kBAAkB,KAAK,mBAAmB,CAAC;AAEhD,WAAO,UAAU,EAAE,QAAQ,WAAS;AAClC,YAAM,gBAAgB,KAAK,WAAW,EAAE,KAAK,OAAK,EAAE,UAAU,KAAK;AACnE,UAAI,eAAe;AACjB,cAAM,IAAI;AAAA,UAAa;AAAA,UACrB;AAAA,QAAoB;AAAA,MACxB;AAAA,IACF,CAAC;AAGD,QAAI,CAAC,KAAK,gBAAgB,OAAO,EAAE,GAAG;AACpC,YAAM,YAAY,IAAIA,QAAO,YAAY,OAAO,UAAU,CAAC;AAC3D,WAAK,SAAS,OAAO,EAAE,IAAI;AAC3B,WAAK,gBAAgB,UAAU,EAAE,IAAI;AACrC,eAAS;AAAA,IACX;AACA,kBAAc,MAAM,MAAM,CAAC,MAAM,CAAC;AAAA,EACpC;AAEA,QAAM,mBAAmBA,QAAO,kBAAkB,UAAU;AAC5D,EAAAA,QAAO,kBAAkB,UAAU,eACjC,SAAS,aAAa,QAAQ;AAC5B,SAAK,WAAW,KAAK,YAAY,CAAC;AAClC,SAAK,kBAAkB,KAAK,mBAAmB,CAAC;AAEhD,qBAAiB,MAAM,MAAM,CAAE,KAAK,SAAS,OAAO,EAAE,KAAK,MAAO,CAAC;AACnE,WAAO,KAAK,gBAAiB,KAAK,SAAS,OAAO,EAAE,IAClD,KAAK,SAAS,OAAO,EAAE,EAAE,KAAK,OAAO,EAAG;AAC1C,WAAO,KAAK,SAAS,OAAO,EAAE;AAAA,EAChC;AAEF,EAAAA,QAAO,kBAAkB,UAAU,WACjC,SAAS,SAAS,OAAO,QAAQ;AAC/B,QAAI,KAAK,mBAAmB,UAAU;AACpC,YAAM,IAAI;AAAA,QACR;AAAA,QACA;AAAA,MAAmB;AAAA,IACvB;AACA,UAAM,UAAU,CAAC,EAAE,MAAM,KAAK,WAAW,CAAC;AAC1C,QAAI,QAAQ,WAAW,KACnB,CAAC,QAAQ,CAAC,EAAE,UAAU,EAAE,KAAK,OAAK,MAAM,KAAK,GAAG;AAGlD,YAAM,IAAI;AAAA,QACR;AAAA,QAEA;AAAA,MAAmB;AAAA,IACvB;AAEA,UAAM,gBAAgB,KAAK,WAAW,EAAE,KAAK,OAAK,EAAE,UAAU,KAAK;AACnE,QAAI,eAAe;AACjB,YAAM,IAAI;AAAA,QAAa;AAAA,QACrB;AAAA,MAAoB;AAAA,IACxB;AAEA,SAAK,WAAW,KAAK,YAAY,CAAC;AAClC,SAAK,kBAAkB,KAAK,mBAAmB,CAAC;AAChD,UAAM,YAAY,KAAK,SAAS,OAAO,EAAE;AACzC,QAAI,WAAW;AAKb,gBAAU,SAAS,KAAK;AAGxB,cAAQ,QAAQ,EAAE,KAAK,MAAM;AAC3B,aAAK,cAAc,IAAI,MAAM,mBAAmB,CAAC;AAAA,MACnD,CAAC;AAAA,IACH,OAAO;AACL,YAAM,YAAY,IAAIA,QAAO,YAAY,CAAC,KAAK,CAAC;AAChD,WAAK,SAAS,OAAO,EAAE,IAAI;AAC3B,WAAK,gBAAgB,UAAU,EAAE,IAAI;AACrC,WAAK,UAAU,SAAS;AAAA,IAC1B;AACA,WAAO,KAAK,WAAW,EAAE,KAAK,OAAK,EAAE,UAAU,KAAK;AAAA,EACtD;AAIF,WAAS,wBAAwB,IAAI,aAAa;AAChD,QAAIE,OAAM,YAAY;AACtB,WAAO,KAAK,GAAG,mBAAmB,CAAC,CAAC,EAAE,QAAQ,gBAAc;AAC1D,YAAM,iBAAiB,GAAG,gBAAgB,UAAU;AACpD,YAAM,iBAAiB,GAAG,SAAS,eAAe,EAAE;AACpD,MAAAA,OAAMA,KAAI;AAAA,QAAQ,IAAI,OAAO,eAAe,IAAI,GAAG;AAAA,QACjD,eAAe;AAAA,MAAE;AAAA,IACrB,CAAC;AACD,WAAO,IAAI,sBAAsB;AAAA,MAC/B,MAAM,YAAY;AAAA,MAClB,KAAAA;AAAA,IACF,CAAC;AAAA,EACH;AACA,WAAS,wBAAwB,IAAI,aAAa;AAChD,QAAIA,OAAM,YAAY;AACtB,WAAO,KAAK,GAAG,mBAAmB,CAAC,CAAC,EAAE,QAAQ,gBAAc;AAC1D,YAAM,iBAAiB,GAAG,gBAAgB,UAAU;AACpD,YAAM,iBAAiB,GAAG,SAAS,eAAe,EAAE;AACpD,MAAAA,OAAMA,KAAI;AAAA,QAAQ,IAAI,OAAO,eAAe,IAAI,GAAG;AAAA,QACjD,eAAe;AAAA,MAAE;AAAA,IACrB,CAAC;AACD,WAAO,IAAI,sBAAsB;AAAA,MAC/B,MAAM,YAAY;AAAA,MAClB,KAAAA;AAAA,IACF,CAAC;AAAA,EACH;AACA,GAAC,eAAe,cAAc,EAAE,QAAQ,SAAS,QAAQ;AACvD,UAAM,eAAeF,QAAO,kBAAkB,UAAU,MAAM;AAC9D,UAAM,YAAY,EAAC,CAAC,MAAM,IAAI;AAC5B,YAAM,OAAO;AACb,YAAM,eAAe,UAAU,UAC3B,OAAO,UAAU,CAAC,MAAM;AAC5B,UAAI,cAAc;AAChB,eAAO,aAAa,MAAM,MAAM;AAAA,UAC9B,CAAC,gBAAgB;AACf,kBAAM,OAAO,wBAAwB,MAAM,WAAW;AACtD,iBAAK,CAAC,EAAE,MAAM,MAAM,CAAC,IAAI,CAAC;AAAA,UAC5B;AAAA,UACA,CAAC,QAAQ;AACP,gBAAI,KAAK,CAAC,GAAG;AACX,mBAAK,CAAC,EAAE,MAAM,MAAM,GAAG;AAAA,YACzB;AAAA,UACF;AAAA,UAAG,UAAU,CAAC;AAAA,QAChB,CAAC;AAAA,MACH;AACA,aAAO,aAAa,MAAM,MAAM,SAAS,EACtC,KAAK,iBAAe,wBAAwB,MAAM,WAAW,CAAC;AAAA,IACnE,EAAC;AACD,IAAAA,QAAO,kBAAkB,UAAU,MAAM,IAAI,UAAU,MAAM;AAAA,EAC/D,CAAC;AAED,QAAM,0BACFA,QAAO,kBAAkB,UAAU;AACvC,EAAAA,QAAO,kBAAkB,UAAU,sBACjC,SAAS,sBAAsB;AAC7B,QAAI,CAAC,UAAU,UAAU,CAAC,UAAU,CAAC,EAAE,MAAM;AAC3C,aAAO,wBAAwB,MAAM,MAAM,SAAS;AAAA,IACtD;AACA,cAAU,CAAC,IAAI,wBAAwB,MAAM,UAAU,CAAC,CAAC;AACzD,WAAO,wBAAwB,MAAM,MAAM,SAAS;AAAA,EACtD;AAIF,QAAM,uBAAuB,OAAO;AAAA,IAClCA,QAAO,kBAAkB;AAAA,IAAW;AAAA,EAAkB;AACxD,SAAO;AAAA,IAAeA,QAAO,kBAAkB;AAAA,IAC7C;AAAA,IAAoB;AAAA,MAClB,MAAM;AACJ,cAAM,cAAc,qBAAqB,IAAI,MAAM,IAAI;AACvD,YAAI,YAAY,SAAS,IAAI;AAC3B,iBAAO;AAAA,QACT;AACA,eAAO,wBAAwB,MAAM,WAAW;AAAA,MAClD;AAAA,IACF;AAAA,EAAC;AAEH,EAAAA,QAAO,kBAAkB,UAAU,cACjC,SAAS,YAAY,QAAQ;AAC3B,QAAI,KAAK,mBAAmB,UAAU;AACpC,YAAM,IAAI;AAAA,QACR;AAAA,QACA;AAAA,MAAmB;AAAA,IACvB;AAGA,QAAI,CAAC,OAAO,KAAK;AACf,YAAM,IAAI,aAAa,0FAC2B,WAAW;AAAA,IAC/D;AACA,UAAM,UAAU,OAAO,QAAQ;AAC/B,QAAI,CAAC,SAAS;AACZ,YAAM,IAAI;AAAA,QAAa;AAAA,QACrB;AAAA,MAAoB;AAAA,IACxB;AAGA,SAAK,WAAW,KAAK,YAAY,CAAC;AAClC,QAAI;AACJ,WAAO,KAAK,KAAK,QAAQ,EAAE,QAAQ,cAAY;AAC7C,YAAM,WAAW,KAAK,SAAS,QAAQ,EAAE,UAAU,EAChD,KAAK,WAAS,OAAO,UAAU,KAAK;AACvC,UAAI,UAAU;AACZ,iBAAS,KAAK,SAAS,QAAQ;AAAA,MACjC;AAAA,IACF,CAAC;AAED,QAAI,QAAQ;AACV,UAAI,OAAO,UAAU,EAAE,WAAW,GAAG;AAGnC,aAAK,aAAa,KAAK,gBAAgB,OAAO,EAAE,CAAC;AAAA,MACnD,OAAO;AAEL,eAAO,YAAY,OAAO,KAAK;AAAA,MACjC;AACA,WAAK,cAAc,IAAI,MAAM,mBAAmB,CAAC;AAAA,IACnD;AAAA,EACF;AACJ;AAEO,SAAS,mBAAmBA,SAAQ,gBAAgB;AACzD,MAAI,CAACA,QAAO,qBAAqBA,QAAO,yBAAyB;AAE/D,IAAAA,QAAO,oBAAoBA,QAAO;AAAA,EACpC;AACA,MAAI,CAACA,QAAO,mBAAmB;AAC7B;AAAA,EACF;AAGA,MAAI,eAAe,UAAU,IAAI;AAC/B,KAAC,uBAAuB,wBAAwB,iBAAiB,EAC9D,QAAQ,SAAS,QAAQ;AACxB,YAAM,eAAeA,QAAO,kBAAkB,UAAU,MAAM;AAC9D,YAAM,YAAY,EAAC,CAAC,MAAM,IAAI;AAC5B,kBAAU,CAAC,IAAI,KAAM,WAAW,oBAC9BA,QAAO,kBACPA,QAAO,uBAAuB,UAAU,CAAC,CAAC;AAC5C,eAAO,aAAa,MAAM,MAAM,SAAS;AAAA,MAC3C,EAAC;AACD,MAAAA,QAAO,kBAAkB,UAAU,MAAM,IAAI,UAAU,MAAM;AAAA,IAC/D,CAAC;AAAA,EACL;AACF;AAGO,SAAS,qBAAqBA,SAAQ,gBAAgB;AAC3D,EAAM,wBAAwBA,SAAQ,qBAAqB,OAAK;AAC9D,UAAM,KAAK,EAAE;AACb,QAAI,eAAe,UAAU,MAAO,GAAG,oBACnC,GAAG,iBAAiB,EAAE,iBAAiB,UAAW;AACpD,UAAI,GAAG,mBAAmB,UAAU;AAClC;AAAA,MACF;AAAA,IACF;AACA,WAAO;AAAA,EACT,CAAC;AACH;;;AG7rBA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAAG;AAAA,EAAA;AAAA,0BAAAC;AAAA,EAAA,mBAAAC;AAAA,EAAA,0BAAAC;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAA;AAYO,SAASC,kBAAiBC,SAAQ,gBAAgB;AACvD,QAAMC,aAAYD,WAAUA,QAAO;AACnC,QAAM,mBAAmBA,WAAUA,QAAO;AAE1C,EAAAC,WAAU,eAAe,SAAS,aAAa,WAAW,SAAS;AAEjE,IAAM;AAAA,MAAW;AAAA,MACf;AAAA,IAAqC;AACvC,IAAAA,WAAU,aAAa,aAAa,WAAW,EAAE,KAAK,WAAW,OAAO;AAAA,EAC1E;AAEA,MAAI,EAAE,eAAe,UAAU,MAC3B,qBAAqBA,WAAU,aAAa,wBAAwB,IAAI;AAC1E,UAAM,QAAQ,SAAS,KAAKC,IAAGC,IAAG;AAChC,UAAID,MAAK,OAAO,EAAEC,MAAK,MAAM;AAC3B,YAAIA,EAAC,IAAI,IAAID,EAAC;AACd,eAAO,IAAIA,EAAC;AAAA,MACd;AAAA,IACF;AAEA,UAAM,qBAAqBD,WAAU,aAAa,aAChD,KAAKA,WAAU,YAAY;AAC7B,IAAAA,WAAU,aAAa,eAAe,SAASG,IAAG;AAChD,UAAI,OAAOA,OAAM,YAAY,OAAOA,GAAE,UAAU,UAAU;AACxD,QAAAA,KAAI,KAAK,MAAM,KAAK,UAAUA,EAAC,CAAC;AAChC,cAAMA,GAAE,OAAO,mBAAmB,oBAAoB;AACtD,cAAMA,GAAE,OAAO,oBAAoB,qBAAqB;AAAA,MAC1D;AACA,aAAO,mBAAmBA,EAAC;AAAA,IAC7B;AAEA,QAAI,oBAAoB,iBAAiB,UAAU,aAAa;AAC9D,YAAM,oBAAoB,iBAAiB,UAAU;AACrD,uBAAiB,UAAU,cAAc,WAAW;AAClD,cAAM,MAAM,kBAAkB,MAAM,MAAM,SAAS;AACnD,cAAM,KAAK,sBAAsB,iBAAiB;AAClD,cAAM,KAAK,uBAAuB,kBAAkB;AACpD,eAAO;AAAA,MACT;AAAA,IACF;AAEA,QAAI,oBAAoB,iBAAiB,UAAU,kBAAkB;AACnE,YAAM,yBACJ,iBAAiB,UAAU;AAC7B,uBAAiB,UAAU,mBAAmB,SAASA,IAAG;AACxD,YAAI,KAAK,SAAS,WAAW,OAAOA,OAAM,UAAU;AAClD,UAAAA,KAAI,KAAK,MAAM,KAAK,UAAUA,EAAC,CAAC;AAChC,gBAAMA,IAAG,mBAAmB,oBAAoB;AAChD,gBAAMA,IAAG,oBAAoB,qBAAqB;AAAA,QACpD;AACA,eAAO,uBAAuB,MAAM,MAAM,CAACA,EAAC,CAAC;AAAA,MAC/C;AAAA,IACF;AAAA,EACF;AACF;;;AClEA;AAUO,SAASC,qBAAoBC,SAAQ,sBAAsB;AAChE,MAAIA,QAAO,UAAU,gBACnB,qBAAqBA,QAAO,UAAU,cAAc;AACpD;AAAA,EACF;AACA,MAAI,CAAEA,QAAO,UAAU,cAAe;AACpC;AAAA,EACF;AACA,EAAAA,QAAO,UAAU,aAAa,kBAC5B,SAAS,gBAAgB,aAAa;AACpC,QAAI,EAAE,eAAe,YAAY,QAAQ;AACvC,YAAM,MAAM,IAAI,aAAa,wDACC;AAC9B,UAAI,OAAO;AAEX,UAAI,OAAO;AACX,aAAO,QAAQ,OAAO,GAAG;AAAA,IAC3B;AACA,QAAI,YAAY,UAAU,MAAM;AAC9B,kBAAY,QAAQ,EAAC,aAAa,qBAAoB;AAAA,IACxD,OAAO;AACL,kBAAY,MAAM,cAAc;AAAA,IAClC;AACA,WAAOA,QAAO,UAAU,aAAa,aAAa,WAAW;AAAA,EAC/D;AACJ;;;AFrBO,SAASC,aAAYC,SAAQ;AAClC,MAAI,OAAOA,YAAW,YAAYA,QAAO,iBACpC,cAAcA,QAAO,cAAc,aACpC,EAAE,iBAAiBA,QAAO,cAAc,YAAY;AACtD,WAAO,eAAeA,QAAO,cAAc,WAAW,eAAe;AAAA,MACnE,MAAM;AACJ,eAAO,EAAC,UAAU,KAAK,SAAQ;AAAA,MACjC;AAAA,IACF,CAAC;AAAA,EACH;AACF;AAEO,SAASC,oBAAmBD,SAAQ,gBAAgB;AACzD,MAAI,OAAOA,YAAW,YAClB,EAAEA,QAAO,qBAAqBA,QAAO,uBAAuB;AAC9D;AAAA,EACF;AACA,MAAI,CAACA,QAAO,qBAAqBA,QAAO,sBAAsB;AAE5D,IAAAA,QAAO,oBAAoBA,QAAO;AAAA,EACpC;AAEA,MAAI,eAAe,UAAU,IAAI;AAE/B,KAAC,uBAAuB,wBAAwB,iBAAiB,EAC9D,QAAQ,SAAS,QAAQ;AACxB,YAAM,eAAeA,QAAO,kBAAkB,UAAU,MAAM;AAC9D,YAAM,YAAY,EAAC,CAAC,MAAM,IAAI;AAC5B,kBAAU,CAAC,IAAI,KAAM,WAAW,oBAC9BA,QAAO,kBACPA,QAAO,uBAAuB,UAAU,CAAC,CAAC;AAC5C,eAAO,aAAa,MAAM,MAAM,SAAS;AAAA,MAC3C,EAAC;AACD,MAAAA,QAAO,kBAAkB,UAAU,MAAM,IAAI,UAAU,MAAM;AAAA,IAC/D,CAAC;AAAA,EACL;AAEA,QAAM,mBAAmB;AAAA,IACvB,YAAY;AAAA,IACZ,aAAa;AAAA,IACb,eAAe;AAAA,IACf,gBAAgB;AAAA,IAChB,iBAAiB;AAAA,EACnB;AAEA,QAAM,iBAAiBA,QAAO,kBAAkB,UAAU;AAC1D,EAAAA,QAAO,kBAAkB,UAAU,WAAW,SAAS,WAAW;AAChE,UAAM,CAAC,UAAU,QAAQ,KAAK,IAAI;AAClC,WAAO,eAAe,MAAM,MAAM,CAAC,YAAY,IAAI,CAAC,EACjD,KAAK,WAAS;AACb,UAAI,eAAe,UAAU,MAAM,CAAC,QAAQ;AAG1C,YAAI;AACF,gBAAM,QAAQ,UAAQ;AACpB,iBAAK,OAAO,iBAAiB,KAAK,IAAI,KAAK,KAAK;AAAA,UAClD,CAAC;AAAA,QACH,SAAS,GAAG;AACV,cAAI,EAAE,SAAS,aAAa;AAC1B,kBAAM;AAAA,UACR;AAEA,gBAAM,QAAQ,CAAC,MAAM,MAAM;AACzB,kBAAM,IAAI,GAAG,OAAO,OAAO,CAAC,GAAG,MAAM;AAAA,cACnC,MAAM,iBAAiB,KAAK,IAAI,KAAK,KAAK;AAAA,YAC5C,CAAC,CAAC;AAAA,UACJ,CAAC;AAAA,QACH;AAAA,MACF;AACA,aAAO;AAAA,IACT,CAAC,EACA,KAAK,QAAQ,KAAK;AAAA,EACvB;AACF;AAEO,SAAS,mBAAmBA,SAAQ;AACzC,MAAI,EAAE,OAAOA,YAAW,YAAYA,QAAO,qBACvCA,QAAO,eAAe;AACxB;AAAA,EACF;AACA,MAAIA,QAAO,gBAAgB,cAAcA,QAAO,aAAa,WAAW;AACtE;AAAA,EACF;AACA,QAAM,iBAAiBA,QAAO,kBAAkB,UAAU;AAC1D,MAAI,gBAAgB;AAClB,IAAAA,QAAO,kBAAkB,UAAU,aAAa,SAAS,aAAa;AACpE,YAAM,UAAU,eAAe,MAAM,MAAM,CAAC,CAAC;AAC7C,cAAQ,QAAQ,YAAU,OAAO,MAAM,IAAI;AAC3C,aAAO;AAAA,IACT;AAAA,EACF;AAEA,QAAM,eAAeA,QAAO,kBAAkB,UAAU;AACxD,MAAI,cAAc;AAChB,IAAAA,QAAO,kBAAkB,UAAU,WAAW,SAAS,WAAW;AAChE,YAAM,SAAS,aAAa,MAAM,MAAM,SAAS;AACjD,aAAO,MAAM;AACb,aAAO;AAAA,IACT;AAAA,EACF;AACA,EAAAA,QAAO,aAAa,UAAU,WAAW,SAAS,WAAW;AAC3D,WAAO,KAAK,QAAQ,KAAK,IAAI,SAAS,KAAK,KAAK,IAC9C,QAAQ,QAAQ,oBAAI,IAAI,CAAC;AAAA,EAC7B;AACF;AAEO,SAAS,qBAAqBA,SAAQ;AAC3C,MAAI,EAAE,OAAOA,YAAW,YAAYA,QAAO,qBACvCA,QAAO,eAAe;AACxB;AAAA,EACF;AACA,MAAIA,QAAO,gBAAgB,cAAcA,QAAO,eAAe,WAAW;AACxE;AAAA,EACF;AACA,QAAM,mBAAmBA,QAAO,kBAAkB,UAAU;AAC5D,MAAI,kBAAkB;AACpB,IAAAA,QAAO,kBAAkB,UAAU,eAAe,SAAS,eAAe;AACxE,YAAM,YAAY,iBAAiB,MAAM,MAAM,CAAC,CAAC;AACjD,gBAAU,QAAQ,cAAY,SAAS,MAAM,IAAI;AACjD,aAAO;AAAA,IACT;AAAA,EACF;AACA,EAAM,wBAAwBA,SAAQ,SAAS,OAAK;AAClD,MAAE,SAAS,MAAM,EAAE;AACnB,WAAO;AAAA,EACT,CAAC;AACD,EAAAA,QAAO,eAAe,UAAU,WAAW,SAAS,WAAW;AAC7D,WAAO,KAAK,IAAI,SAAS,KAAK,KAAK;AAAA,EACrC;AACF;AAEO,SAAS,iBAAiBA,SAAQ;AACvC,MAAI,CAACA,QAAO,qBACR,kBAAkBA,QAAO,kBAAkB,WAAW;AACxD;AAAA,EACF;AACA,EAAAA,QAAO,kBAAkB,UAAU,eACjC,SAAS,aAAa,QAAQ;AAC5B,IAAM,WAAW,gBAAgB,aAAa;AAC9C,SAAK,WAAW,EAAE,QAAQ,YAAU;AAClC,UAAI,OAAO,SAAS,OAAO,UAAU,EAAE,SAAS,OAAO,KAAK,GAAG;AAC7D,aAAK,YAAY,MAAM;AAAA,MACzB;AAAA,IACF,CAAC;AAAA,EACH;AACJ;AAEO,SAAS,mBAAmBA,SAAQ;AAGzC,MAAIA,QAAO,eAAe,CAACA,QAAO,gBAAgB;AAChD,IAAAA,QAAO,iBAAiBA,QAAO;AAAA,EACjC;AACF;AAEO,SAAS,mBAAmBA,SAAQ;AAIzC,MAAI,EAAE,OAAOA,YAAW,YAAYA,QAAO,oBAAoB;AAC7D;AAAA,EACF;AACA,QAAM,qBAAqBA,QAAO,kBAAkB,UAAU;AAC9D,MAAI,oBAAoB;AACtB,IAAAA,QAAO,kBAAkB,UAAU,iBACjC,SAAS,iBAAiB;AACxB,WAAK,wBAAwB,CAAC;AAE9B,UAAI,gBAAgB,UAAU,CAAC,KAAK,UAAU,CAAC,EAAE;AACjD,UAAI,kBAAkB,QAAW;AAC/B,wBAAgB,CAAC;AAAA,MACnB;AACA,sBAAgB,CAAC,GAAG,aAAa;AACjC,YAAM,qBAAqB,cAAc,SAAS;AAClD,UAAI,oBAAoB;AAEtB,sBAAc,QAAQ,CAAC,kBAAkB;AACvC,cAAI,SAAS,eAAe;AAC1B,kBAAM,WAAW;AACjB,gBAAI,CAAC,SAAS,KAAK,cAAc,GAAG,GAAG;AACrC,oBAAM,IAAI,UAAU,6BAA6B;AAAA,YACnD;AAAA,UACF;AACA,cAAI,2BAA2B,eAAe;AAC5C,gBAAI,EAAE,WAAW,cAAc,qBAAqB,KAAK,IAAM;AAC7D,oBAAM,IAAI,WAAW,yCAAyC;AAAA,YAChE;AAAA,UACF;AACA,cAAI,kBAAkB,eAAe;AACnC,gBAAI,EAAE,WAAW,cAAc,YAAY,KAAK,IAAI;AAClD,oBAAM,IAAI,WAAW,8BAA8B;AAAA,YACrD;AAAA,UACF;AAAA,QACF,CAAC;AAAA,MACH;AACA,YAAM,cAAc,mBAAmB,MAAM,MAAM,SAAS;AAC5D,UAAI,oBAAoB;AAQtB,cAAM,EAAC,OAAM,IAAI;AACjB,cAAM,SAAS,OAAO,cAAc;AACpC,YAAI,EAAE,eAAe;AAAA,QAEhB,OAAO,UAAU,WAAW,KAC5B,OAAO,KAAK,OAAO,UAAU,CAAC,CAAC,EAAE,WAAW,GAAI;AACnD,iBAAO,YAAY;AACnB,iBAAO,gBAAgB;AACvB,eAAK,sBAAsB;AAAA,YAAK,OAAO,cAAc,MAAM,EACxD,KAAK,MAAM;AACV,qBAAO,OAAO;AAAA,YAChB,CAAC,EAAE,MAAM,MAAM;AACb,qBAAO,OAAO;AAAA,YAChB,CAAC;AAAA,UACH;AAAA,QACF;AAAA,MACF;AACA,aAAO;AAAA,IACT;AAAA,EACJ;AACF;AAEO,SAAS,kBAAkBA,SAAQ;AACxC,MAAI,EAAE,OAAOA,YAAW,YAAYA,QAAO,eAAe;AACxD;AAAA,EACF;AACA,QAAM,oBAAoBA,QAAO,aAAa,UAAU;AACxD,MAAI,mBAAmB;AACrB,IAAAA,QAAO,aAAa,UAAU,gBAC5B,SAAS,gBAAgB;AACvB,YAAM,SAAS,kBAAkB,MAAM,MAAM,SAAS;AACtD,UAAI,EAAE,eAAe,SAAS;AAC5B,eAAO,YAAY,CAAC,EAAE,OAAO,KAAK,iBAAiB,CAAC,CAAC,CAAC,CAAC;AAAA,MACzD;AACA,aAAO;AAAA,IACT;AAAA,EACJ;AACF;AAEO,SAAS,gBAAgBA,SAAQ;AAItC,MAAI,EAAE,OAAOA,YAAW,YAAYA,QAAO,oBAAoB;AAC7D;AAAA,EACF;AACA,QAAM,kBAAkBA,QAAO,kBAAkB,UAAU;AAC3D,EAAAA,QAAO,kBAAkB,UAAU,cAAc,SAAS,cAAc;AACtE,QAAI,KAAK,yBAAyB,KAAK,sBAAsB,QAAQ;AACnE,aAAO,QAAQ,IAAI,KAAK,qBAAqB,EAC1C,KAAK,MAAM;AACV,eAAO,gBAAgB,MAAM,MAAM,SAAS;AAAA,MAC9C,CAAC,EACA,QAAQ,MAAM;AACb,aAAK,wBAAwB,CAAC;AAAA,MAChC,CAAC;AAAA,IACL;AACA,WAAO,gBAAgB,MAAM,MAAM,SAAS;AAAA,EAC9C;AACF;AAEO,SAAS,iBAAiBA,SAAQ;AAIvC,MAAI,EAAE,OAAOA,YAAW,YAAYA,QAAO,oBAAoB;AAC7D;AAAA,EACF;AACA,QAAM,mBAAmBA,QAAO,kBAAkB,UAAU;AAC5D,EAAAA,QAAO,kBAAkB,UAAU,eAAe,SAAS,eAAe;AACxE,QAAI,KAAK,yBAAyB,KAAK,sBAAsB,QAAQ;AACnE,aAAO,QAAQ,IAAI,KAAK,qBAAqB,EAC1C,KAAK,MAAM;AACV,eAAO,iBAAiB,MAAM,MAAM,SAAS;AAAA,MAC/C,CAAC,EACA,QAAQ,MAAM;AACb,aAAK,wBAAwB,CAAC;AAAA,MAChC,CAAC;AAAA,IACL;AACA,WAAO,iBAAiB,MAAM,MAAM,SAAS;AAAA,EAC/C;AACF;;;AG3SA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAAE;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUO,SAAS,oBAAoBC,SAAQ;AAC1C,MAAI,OAAOA,YAAW,YAAY,CAACA,QAAO,mBAAmB;AAC3D;AAAA,EACF;AACA,MAAI,EAAE,qBAAqBA,QAAO,kBAAkB,YAAY;AAC9D,IAAAA,QAAO,kBAAkB,UAAU,kBACjC,SAAS,kBAAkB;AACzB,UAAI,CAAC,KAAK,eAAe;AACvB,aAAK,gBAAgB,CAAC;AAAA,MACxB;AACA,aAAO,KAAK;AAAA,IACd;AAAA,EACJ;AACA,MAAI,EAAE,eAAeA,QAAO,kBAAkB,YAAY;AACxD,UAAM,YAAYA,QAAO,kBAAkB,UAAU;AACrD,IAAAA,QAAO,kBAAkB,UAAU,YAAY,SAAS,UAAU,QAAQ;AACxE,UAAI,CAAC,KAAK,eAAe;AACvB,aAAK,gBAAgB,CAAC;AAAA,MACxB;AACA,UAAI,CAAC,KAAK,cAAc,SAAS,MAAM,GAAG;AACxC,aAAK,cAAc,KAAK,MAAM;AAAA,MAChC;AAGA,aAAO,eAAe,EAAE,QAAQ,WAAS,UAAU;AAAA,QAAK;AAAA,QAAM;AAAA,QAC5D;AAAA,MAAM,CAAC;AACT,aAAO,eAAe,EAAE,QAAQ,WAAS,UAAU;AAAA,QAAK;AAAA,QAAM;AAAA,QAC5D;AAAA,MAAM,CAAC;AAAA,IACX;AAEA,IAAAA,QAAO,kBAAkB,UAAU,WACjC,SAAS,SAAS,UAAU,SAAS;AACnC,UAAI,SAAS;AACX,gBAAQ,QAAQ,CAAC,WAAW;AAC1B,cAAI,CAAC,KAAK,eAAe;AACvB,iBAAK,gBAAgB,CAAC,MAAM;AAAA,UAC9B,WAAW,CAAC,KAAK,cAAc,SAAS,MAAM,GAAG;AAC/C,iBAAK,cAAc,KAAK,MAAM;AAAA,UAChC;AAAA,QACF,CAAC;AAAA,MACH;AACA,aAAO,UAAU,MAAM,MAAM,SAAS;AAAA,IACxC;AAAA,EACJ;AACA,MAAI,EAAE,kBAAkBA,QAAO,kBAAkB,YAAY;AAC3D,IAAAA,QAAO,kBAAkB,UAAU,eACjC,SAAS,aAAa,QAAQ;AAC5B,UAAI,CAAC,KAAK,eAAe;AACvB,aAAK,gBAAgB,CAAC;AAAA,MACxB;AACA,YAAM,QAAQ,KAAK,cAAc,QAAQ,MAAM;AAC/C,UAAI,UAAU,IAAI;AAChB;AAAA,MACF;AACA,WAAK,cAAc,OAAO,OAAO,CAAC;AAClC,YAAM,SAAS,OAAO,UAAU;AAChC,WAAK,WAAW,EAAE,QAAQ,YAAU;AAClC,YAAI,OAAO,SAAS,OAAO,KAAK,GAAG;AACjC,eAAK,YAAY,MAAM;AAAA,QACzB;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACJ;AACF;AAEO,SAAS,qBAAqBA,SAAQ;AAC3C,MAAI,OAAOA,YAAW,YAAY,CAACA,QAAO,mBAAmB;AAC3D;AAAA,EACF;AACA,MAAI,EAAE,sBAAsBA,QAAO,kBAAkB,YAAY;AAC/D,IAAAA,QAAO,kBAAkB,UAAU,mBACjC,SAAS,mBAAmB;AAC1B,aAAO,KAAK,iBAAiB,KAAK,iBAAiB,CAAC;AAAA,IACtD;AAAA,EACJ;AACA,MAAI,EAAE,iBAAiBA,QAAO,kBAAkB,YAAY;AAC1D,WAAO,eAAeA,QAAO,kBAAkB,WAAW,eAAe;AAAA,MACvE,MAAM;AACJ,eAAO,KAAK;AAAA,MACd;AAAA,MACA,IAAIC,IAAG;AACL,YAAI,KAAK,cAAc;AACrB,eAAK,oBAAoB,aAAa,KAAK,YAAY;AACvD,eAAK,oBAAoB,SAAS,KAAK,gBAAgB;AAAA,QACzD;AACA,aAAK,iBAAiB,aAAa,KAAK,eAAeA,EAAC;AACxD,aAAK,iBAAiB,SAAS,KAAK,mBAAmB,CAAC,MAAM;AAC5D,YAAE,QAAQ,QAAQ,YAAU;AAC1B,gBAAI,CAAC,KAAK,gBAAgB;AACxB,mBAAK,iBAAiB,CAAC;AAAA,YACzB;AACA,gBAAI,KAAK,eAAe,SAAS,MAAM,GAAG;AACxC;AAAA,YACF;AACA,iBAAK,eAAe,KAAK,MAAM;AAC/B,kBAAM,QAAQ,IAAI,MAAM,WAAW;AACnC,kBAAM,SAAS;AACf,iBAAK,cAAc,KAAK;AAAA,UAC1B,CAAC;AAAA,QACH,CAAC;AAAA,MACH;AAAA,IACF,CAAC;AACD,UAAM,2BACJD,QAAO,kBAAkB,UAAU;AACrC,IAAAA,QAAO,kBAAkB,UAAU,uBACjC,SAAS,uBAAuB;AAC9B,YAAM,KAAK;AACX,UAAI,CAAC,KAAK,kBAAkB;AAC1B,aAAK,iBAAiB,SAAS,KAAK,mBAAmB,SAAS,GAAG;AACjE,YAAE,QAAQ,QAAQ,YAAU;AAC1B,gBAAI,CAAC,GAAG,gBAAgB;AACtB,iBAAG,iBAAiB,CAAC;AAAA,YACvB;AACA,gBAAI,GAAG,eAAe,QAAQ,MAAM,KAAK,GAAG;AAC1C;AAAA,YACF;AACA,eAAG,eAAe,KAAK,MAAM;AAC7B,kBAAM,QAAQ,IAAI,MAAM,WAAW;AACnC,kBAAM,SAAS;AACf,eAAG,cAAc,KAAK;AAAA,UACxB,CAAC;AAAA,QACH,CAAC;AAAA,MACH;AACA,aAAO,yBAAyB,MAAM,IAAI,SAAS;AAAA,IACrD;AAAA,EACJ;AACF;AAEO,SAAS,iBAAiBA,SAAQ;AACvC,MAAI,OAAOA,YAAW,YAAY,CAACA,QAAO,mBAAmB;AAC3D;AAAA,EACF;AACA,QAAM,YAAYA,QAAO,kBAAkB;AAC3C,QAAM,kBAAkB,UAAU;AAClC,QAAM,mBAAmB,UAAU;AACnC,QAAM,sBAAsB,UAAU;AACtC,QAAM,uBAAuB,UAAU;AACvC,QAAM,kBAAkB,UAAU;AAElC,YAAU,cACR,SAAS,YAAY,iBAAiB,iBAAiB;AACrD,UAAM,UAAW,UAAU,UAAU,IAAK,UAAU,CAAC,IAAI,UAAU,CAAC;AACpE,UAAM,UAAU,gBAAgB,MAAM,MAAM,CAAC,OAAO,CAAC;AACrD,QAAI,CAAC,iBAAiB;AACpB,aAAO;AAAA,IACT;AACA,YAAQ,KAAK,iBAAiB,eAAe;AAC7C,WAAO,QAAQ,QAAQ;AAAA,EACzB;AAEF,YAAU,eACR,SAAS,aAAa,iBAAiB,iBAAiB;AACtD,UAAM,UAAW,UAAU,UAAU,IAAK,UAAU,CAAC,IAAI,UAAU,CAAC;AACpE,UAAM,UAAU,iBAAiB,MAAM,MAAM,CAAC,OAAO,CAAC;AACtD,QAAI,CAAC,iBAAiB;AACpB,aAAO;AAAA,IACT;AACA,YAAQ,KAAK,iBAAiB,eAAe;AAC7C,WAAO,QAAQ,QAAQ;AAAA,EACzB;AAEF,MAAI,eAAe,SAAS,aAAa,iBAAiB,iBAAiB;AACzE,UAAM,UAAU,oBAAoB,MAAM,MAAM,CAAC,WAAW,CAAC;AAC7D,QAAI,CAAC,iBAAiB;AACpB,aAAO;AAAA,IACT;AACA,YAAQ,KAAK,iBAAiB,eAAe;AAC7C,WAAO,QAAQ,QAAQ;AAAA,EACzB;AACA,YAAU,sBAAsB;AAEhC,iBAAe,SAAS,aAAa,iBAAiB,iBAAiB;AACrE,UAAM,UAAU,qBAAqB,MAAM,MAAM,CAAC,WAAW,CAAC;AAC9D,QAAI,CAAC,iBAAiB;AACpB,aAAO;AAAA,IACT;AACA,YAAQ,KAAK,iBAAiB,eAAe;AAC7C,WAAO,QAAQ,QAAQ;AAAA,EACzB;AACA,YAAU,uBAAuB;AAEjC,iBAAe,SAAS,WAAW,iBAAiB,iBAAiB;AACnE,UAAM,UAAU,gBAAgB,MAAM,MAAM,CAAC,SAAS,CAAC;AACvD,QAAI,CAAC,iBAAiB;AACpB,aAAO;AAAA,IACT;AACA,YAAQ,KAAK,iBAAiB,eAAe;AAC7C,WAAO,QAAQ,QAAQ;AAAA,EACzB;AACA,YAAU,kBAAkB;AAC9B;AAEO,SAASE,kBAAiBF,SAAQ;AACvC,QAAMG,aAAYH,WAAUA,QAAO;AAEnC,MAAIG,WAAU,gBAAgBA,WAAU,aAAa,cAAc;AAEjE,UAAM,eAAeA,WAAU;AAC/B,UAAM,gBAAgB,aAAa,aAAa,KAAK,YAAY;AACjE,IAAAA,WAAU,aAAa,eAAe,CAAC,gBAAgB;AACrD,aAAO,cAAc,gBAAgB,WAAW,CAAC;AAAA,IACnD;AAAA,EACF;AAEA,MAAI,CAACA,WAAU,gBAAgBA,WAAU,gBACvCA,WAAU,aAAa,cAAc;AACrC,IAAAA,WAAU,eAAe,SAAS,aAAa,aAAa,IAAI,OAAO;AACrE,MAAAA,WAAU,aAAa,aAAa,WAAW,EAC5C,KAAK,IAAI,KAAK;AAAA,IACnB,EAAE,KAAKA,UAAS;AAAA,EAClB;AACF;AAEO,SAAS,gBAAgB,aAAa;AAC3C,MAAI,eAAe,YAAY,UAAU,QAAW;AAClD,WAAO,OAAO;AAAA,MAAO,CAAC;AAAA,MACpB;AAAA,MACA,EAAC,OAAa,cAAc,YAAY,KAAK,EAAC;AAAA,IAChD;AAAA,EACF;AAEA,SAAO;AACT;AAEO,SAAS,qBAAqBH,SAAQ;AAC3C,MAAI,CAACA,QAAO,mBAAmB;AAC7B;AAAA,EACF;AAEA,QAAM,qBAAqBA,QAAO;AAClC,EAAAA,QAAO,oBACL,SAASI,mBAAkB,UAAU,eAAe;AAClD,QAAI,YAAY,SAAS,YAAY;AACnC,YAAM,gBAAgB,CAAC;AACvB,eAAS,IAAI,GAAG,IAAI,SAAS,WAAW,QAAQ,KAAK;AACnD,YAAI,SAAS,SAAS,WAAW,CAAC;AAClC,YAAI,OAAO,SAAS,UAAa,OAAO,KAAK;AAC3C,UAAM,WAAW,oBAAoB,mBAAmB;AACxD,mBAAS,KAAK,MAAM,KAAK,UAAU,MAAM,CAAC;AAC1C,iBAAO,OAAO,OAAO;AACrB,iBAAO,OAAO;AACd,wBAAc,KAAK,MAAM;AAAA,QAC3B,OAAO;AACL,wBAAc,KAAK,SAAS,WAAW,CAAC,CAAC;AAAA,QAC3C;AAAA,MACF;AACA,eAAS,aAAa;AAAA,IACxB;AACA,WAAO,IAAI,mBAAmB,UAAU,aAAa;AAAA,EACvD;AACF,EAAAJ,QAAO,kBAAkB,YAAY,mBAAmB;AAExD,MAAI,yBAAyB,oBAAoB;AAC/C,WAAO,eAAeA,QAAO,mBAAmB,uBAAuB;AAAA,MACrE,MAAM;AACJ,eAAO,mBAAmB;AAAA,MAC5B;AAAA,IACF,CAAC;AAAA,EACH;AACF;AAEO,SAAS,0BAA0BA,SAAQ;AAEhD,MAAI,OAAOA,YAAW,YAAYA,QAAO,iBACrC,cAAcA,QAAO,cAAc,aACnC,EAAE,iBAAiBA,QAAO,cAAc,YAAY;AACtD,WAAO,eAAeA,QAAO,cAAc,WAAW,eAAe;AAAA,MACnE,MAAM;AACJ,eAAO,EAAC,UAAU,KAAK,SAAQ;AAAA,MACjC;AAAA,IACF,CAAC;AAAA,EACH;AACF;AAEO,SAAS,sBAAsBA,SAAQ;AAC5C,QAAM,kBAAkBA,QAAO,kBAAkB,UAAU;AAC3D,EAAAA,QAAO,kBAAkB,UAAU,cACjC,SAAS,YAAY,cAAc;AACjC,QAAI,cAAc;AAChB,UAAI,OAAO,aAAa,wBAAwB,aAAa;AAE3D,qBAAa,sBACX,CAAC,CAAC,aAAa;AAAA,MACnB;AACA,YAAM,mBAAmB,KAAK,gBAAgB,EAAE,KAAK,iBACnD,YAAY,SAAS,MAAM,SAAS,OAAO;AAC7C,UAAI,aAAa,wBAAwB,SAAS,kBAAkB;AAClE,YAAI,iBAAiB,cAAc,YAAY;AAC7C,cAAI,iBAAiB,cAAc;AACjC,6BAAiB,aAAa,UAAU;AAAA,UAC1C,OAAO;AACL,6BAAiB,YAAY;AAAA,UAC/B;AAAA,QACF,WAAW,iBAAiB,cAAc,YAAY;AACpD,cAAI,iBAAiB,cAAc;AACjC,6BAAiB,aAAa,UAAU;AAAA,UAC1C,OAAO;AACL,6BAAiB,YAAY;AAAA,UAC/B;AAAA,QACF;AAAA,MACF,WAAW,aAAa,wBAAwB,QAC5C,CAAC,kBAAkB;AACrB,aAAK,eAAe,SAAS,EAAC,WAAW,WAAU,CAAC;AAAA,MACtD;AAEA,UAAI,OAAO,aAAa,wBAAwB,aAAa;AAE3D,qBAAa,sBACX,CAAC,CAAC,aAAa;AAAA,MACnB;AACA,YAAM,mBAAmB,KAAK,gBAAgB,EAAE,KAAK,iBACnD,YAAY,SAAS,MAAM,SAAS,OAAO;AAC7C,UAAI,aAAa,wBAAwB,SAAS,kBAAkB;AAClE,YAAI,iBAAiB,cAAc,YAAY;AAC7C,cAAI,iBAAiB,cAAc;AACjC,6BAAiB,aAAa,UAAU;AAAA,UAC1C,OAAO;AACL,6BAAiB,YAAY;AAAA,UAC/B;AAAA,QACF,WAAW,iBAAiB,cAAc,YAAY;AACpD,cAAI,iBAAiB,cAAc;AACjC,6BAAiB,aAAa,UAAU;AAAA,UAC1C,OAAO;AACL,6BAAiB,YAAY;AAAA,UAC/B;AAAA,QACF;AAAA,MACF,WAAW,aAAa,wBAAwB,QAC5C,CAAC,kBAAkB;AACrB,aAAK,eAAe,SAAS,EAAC,WAAW,WAAU,CAAC;AAAA,MACtD;AAAA,IACF;AACA,WAAO,gBAAgB,MAAM,MAAM,SAAS;AAAA,EAC9C;AACJ;AAEO,SAAS,iBAAiBA,SAAQ;AACvC,MAAI,OAAOA,YAAW,YAAYA,QAAO,cAAc;AACrD;AAAA,EACF;AACA,EAAAA,QAAO,eAAeA,QAAO;AAC/B;;;AC9VA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA,iBAAqB;AAGd,SAAS,oBAAoBK,SAAQ;AAG1C,MAAI,CAACA,QAAO,mBAAoBA,QAAO,mBAAmB,gBACtDA,QAAO,gBAAgB,WAAY;AACrC;AAAA,EACF;AAEA,QAAM,wBAAwBA,QAAO;AACrC,EAAAA,QAAO,kBAAkB,SAAS,gBAAgB,MAAM;AAEtD,QAAI,OAAO,SAAS,YAAY,KAAK,aACjC,KAAK,UAAU,QAAQ,IAAI,MAAM,GAAG;AACtC,aAAO,KAAK,MAAM,KAAK,UAAU,IAAI,CAAC;AACtC,WAAK,YAAY,KAAK,UAAU,UAAU,CAAC;AAAA,IAC7C;AAEA,QAAI,KAAK,aAAa,KAAK,UAAU,QAAQ;AAE3C,YAAM,kBAAkB,IAAI,sBAAsB,IAAI;AACtD,YAAM,kBAAkB,WAAAC,QAAS,eAAe,KAAK,SAAS;AAC9D,iBAAW,OAAO,iBAAiB;AACjC,YAAI,EAAE,OAAO,kBAAkB;AAC7B,iBAAO;AAAA,YAAe;AAAA,YAAiB;AAAA,YACrC,EAAC,OAAO,gBAAgB,GAAG,EAAC;AAAA,UAAC;AAAA,QACjC;AAAA,MACF;AAGA,sBAAgB,SAAS,SAAS,SAAS;AACzC,eAAO;AAAA,UACL,WAAW,gBAAgB;AAAA,UAC3B,QAAQ,gBAAgB;AAAA,UACxB,eAAe,gBAAgB;AAAA,UAC/B,kBAAkB,gBAAgB;AAAA,QACpC;AAAA,MACF;AACA,aAAO;AAAA,IACT;AACA,WAAO,IAAI,sBAAsB,IAAI;AAAA,EACvC;AACA,EAAAD,QAAO,gBAAgB,YAAY,sBAAsB;AAIzD,EAAM,wBAAwBA,SAAQ,gBAAgB,OAAK;AACzD,QAAI,EAAE,WAAW;AACf,aAAO,eAAe,GAAG,aAAa;AAAA,QACpC,OAAO,IAAIA,QAAO,gBAAgB,EAAE,SAAS;AAAA,QAC7C,UAAU;AAAA,MACZ,CAAC;AAAA,IACH;AACA,WAAO;AAAA,EACT,CAAC;AACH;AAEO,SAAS,iCAAiCA,SAAQ;AACvD,MAAI,CAACA,QAAO,mBAAoBA,QAAO,mBAAmB,mBACtDA,QAAO,gBAAgB,WAAY;AACrC;AAAA,EACF;AAIA,EAAM,wBAAwBA,SAAQ,gBAAgB,OAAK;AACzD,QAAI,EAAE,WAAW;AACf,YAAM,kBAAkB,WAAAC,QAAS,eAAe,EAAE,UAAU,SAAS;AACrE,UAAI,gBAAgB,SAAS,SAAS;AAGpC,UAAE,UAAU,gBAAgB;AAAA,UAC1B,GAAG;AAAA,UACH,GAAG;AAAA,UACH,GAAG;AAAA,QACL,EAAE,gBAAgB,YAAY,EAAE;AAAA,MAClC;AAAA,IACF;AACA,WAAO;AAAA,EACT,CAAC;AACH;AAEO,SAAS,mBAAmBD,SAAQ,gBAAgB;AACzD,MAAI,CAACA,QAAO,mBAAmB;AAC7B;AAAA,EACF;AAEA,MAAI,EAAE,UAAUA,QAAO,kBAAkB,YAAY;AACnD,WAAO,eAAeA,QAAO,kBAAkB,WAAW,QAAQ;AAAA,MAChE,MAAM;AACJ,eAAO,OAAO,KAAK,UAAU,cAAc,OAAO,KAAK;AAAA,MACzD;AAAA,IACF,CAAC;AAAA,EACH;AAEA,QAAM,oBAAoB,SAAS,aAAa;AAC9C,QAAI,CAAC,eAAe,CAAC,YAAY,KAAK;AACpC,aAAO;AAAA,IACT;AACA,UAAM,WAAW,WAAAC,QAAS,cAAc,YAAY,GAAG;AACvD,aAAS,MAAM;AACf,WAAO,SAAS,KAAK,kBAAgB;AACnC,YAAM,QAAQ,WAAAA,QAAS,WAAW,YAAY;AAC9C,aAAO,SAAS,MAAM,SAAS,iBACxB,MAAM,SAAS,QAAQ,MAAM,MAAM;AAAA,IAC5C,CAAC;AAAA,EACH;AAEA,QAAM,0BAA0B,SAAS,aAAa;AAEpD,UAAMC,UAAQ,YAAY,IAAI,MAAM,iCAAiC;AACrE,QAAIA,YAAU,QAAQA,QAAM,SAAS,GAAG;AACtC,aAAO;AAAA,IACT;AACA,UAAM,UAAU,SAASA,QAAM,CAAC,GAAG,EAAE;AAErC,WAAO,YAAY,UAAU,KAAK;AAAA,EACpC;AAEA,QAAM,2BAA2B,SAAS,iBAAiB;AAKzD,QAAI,wBAAwB;AAC5B,QAAI,eAAe,YAAY,WAAW;AACxC,UAAI,eAAe,UAAU,IAAI;AAC/B,YAAI,oBAAoB,IAAI;AAG1B,kCAAwB;AAAA,QAC1B,OAAO;AAGL,kCAAwB;AAAA,QAC1B;AAAA,MACF,WAAW,eAAe,UAAU,IAAI;AAKtC,gCACE,eAAe,YAAY,KAAK,QAAQ;AAAA,MAC5C,OAAO;AAEL,gCAAwB;AAAA,MAC1B;AAAA,IACF;AACA,WAAO;AAAA,EACT;AAEA,QAAM,oBAAoB,SAAS,aAAa,iBAAiB;AAG/D,QAAI,iBAAiB;AAKrB,QAAI,eAAe,YAAY,aACvB,eAAe,YAAY,IAAI;AACrC,uBAAiB;AAAA,IACnB;AAEA,UAAMA,UAAQ,WAAAD,QAAS;AAAA,MAAY,YAAY;AAAA,MAC7C;AAAA,IAAqB;AACvB,QAAIC,QAAM,SAAS,GAAG;AACpB,uBAAiB,SAASA,QAAM,CAAC,EAAE,UAAU,EAAE,GAAG,EAAE;AAAA,IACtD,WAAW,eAAe,YAAY,aAC1B,oBAAoB,IAAI;AAIlC,uBAAiB;AAAA,IACnB;AACA,WAAO;AAAA,EACT;AAEA,QAAM,2BACFF,QAAO,kBAAkB,UAAU;AACvC,EAAAA,QAAO,kBAAkB,UAAU,uBACjC,SAAS,uBAAuB;AAC9B,SAAK,QAAQ;AAIb,QAAI,eAAe,YAAY,YAAY,eAAe,WAAW,IAAI;AACvE,YAAM,EAAC,aAAY,IAAI,KAAK,iBAAiB;AAC7C,UAAI,iBAAiB,UAAU;AAC7B,eAAO,eAAe,MAAM,QAAQ;AAAA,UAClC,MAAM;AACJ,mBAAO,OAAO,KAAK,UAAU,cAAc,OAAO,KAAK;AAAA,UACzD;AAAA,UACA,YAAY;AAAA,UACZ,cAAc;AAAA,QAChB,CAAC;AAAA,MACH;AAAA,IACF;AAEA,QAAI,kBAAkB,UAAU,CAAC,CAAC,GAAG;AAEnC,YAAMG,aAAY,wBAAwB,UAAU,CAAC,CAAC;AAGtD,YAAM,aAAa,yBAAyBA,UAAS;AAGrD,YAAM,YAAY,kBAAkB,UAAU,CAAC,GAAGA,UAAS;AAG3D,UAAI;AACJ,UAAI,eAAe,KAAK,cAAc,GAAG;AACvC,yBAAiB,OAAO;AAAA,MAC1B,WAAW,eAAe,KAAK,cAAc,GAAG;AAC9C,yBAAiB,KAAK,IAAI,YAAY,SAAS;AAAA,MACjD,OAAO;AACL,yBAAiB,KAAK,IAAI,YAAY,SAAS;AAAA,MACjD;AAIA,YAAM,OAAO,CAAC;AACd,aAAO,eAAe,MAAM,kBAAkB;AAAA,QAC5C,MAAM;AACJ,iBAAO;AAAA,QACT;AAAA,MACF,CAAC;AACD,WAAK,QAAQ;AAAA,IACf;AAEA,WAAO,yBAAyB,MAAM,MAAM,SAAS;AAAA,EACvD;AACJ;AAEO,SAAS,uBAAuBH,SAAQ;AAC7C,MAAI,EAAEA,QAAO,qBACT,uBAAuBA,QAAO,kBAAkB,YAAY;AAC9D;AAAA,EACF;AAMA,WAAS,WAAW,IAAI,IAAI;AAC1B,UAAM,sBAAsB,GAAG;AAC/B,OAAG,OAAO,SAAS,OAAO;AACxB,YAAMI,QAAO,UAAU,CAAC;AACxB,YAAM,SAASA,MAAK,UAAUA,MAAK,QAAQA,MAAK;AAChD,UAAI,GAAG,eAAe,UAClB,GAAG,QAAQ,SAAS,GAAG,KAAK,gBAAgB;AAC9C,cAAM,IAAI,UAAU,8CAClB,GAAG,KAAK,iBAAiB,SAAS;AAAA,MACtC;AACA,aAAO,oBAAoB,MAAM,IAAI,SAAS;AAAA,IAChD;AAAA,EACF;AACA,QAAM,wBACJJ,QAAO,kBAAkB,UAAU;AACrC,EAAAA,QAAO,kBAAkB,UAAU,oBACjC,SAAS,oBAAoB;AAC3B,UAAM,cAAc,sBAAsB,MAAM,MAAM,SAAS;AAC/D,eAAW,aAAa,IAAI;AAC5B,WAAO;AAAA,EACT;AACF,EAAM,wBAAwBA,SAAQ,eAAe,OAAK;AACxD,eAAW,EAAE,SAAS,EAAE,MAAM;AAC9B,WAAO;AAAA,EACT,CAAC;AACH;AAUO,SAAS,oBAAoBA,SAAQ;AAC1C,MAAI,CAACA,QAAO,qBACR,qBAAqBA,QAAO,kBAAkB,WAAW;AAC3D;AAAA,EACF;AACA,QAAM,QAAQA,QAAO,kBAAkB;AACvC,SAAO,eAAe,OAAO,mBAAmB;AAAA,IAC9C,MAAM;AACJ,aAAO;AAAA,QACL,WAAW;AAAA,QACX,UAAU;AAAA,MACZ,EAAE,KAAK,kBAAkB,KAAK,KAAK;AAAA,IACrC;AAAA,IACA,YAAY;AAAA,IACZ,cAAc;AAAA,EAChB,CAAC;AACD,SAAO,eAAe,OAAO,2BAA2B;AAAA,IACtD,MAAM;AACJ,aAAO,KAAK,4BAA4B;AAAA,IAC1C;AAAA,IACA,IAAI,IAAI;AACN,UAAI,KAAK,0BAA0B;AACjC,aAAK;AAAA,UAAoB;AAAA,UACvB,KAAK;AAAA,QAAwB;AAC/B,eAAO,KAAK;AAAA,MACd;AACA,UAAI,IAAI;AACN,aAAK;AAAA,UAAiB;AAAA,UACpB,KAAK,2BAA2B;AAAA,QAAE;AAAA,MACtC;AAAA,IACF;AAAA,IACA,YAAY;AAAA,IACZ,cAAc;AAAA,EAChB,CAAC;AAED,GAAC,uBAAuB,sBAAsB,EAAE,QAAQ,CAAC,WAAW;AAClE,UAAM,aAAa,MAAM,MAAM;AAC/B,UAAM,MAAM,IAAI,WAAW;AACzB,UAAI,CAAC,KAAK,4BAA4B;AACpC,aAAK,6BAA6B,OAAK;AACrC,gBAAM,KAAK,EAAE;AACb,cAAI,GAAG,yBAAyB,GAAG,iBAAiB;AAClD,eAAG,uBAAuB,GAAG;AAC7B,kBAAM,WAAW,IAAI,MAAM,yBAAyB,CAAC;AACrD,eAAG,cAAc,QAAQ;AAAA,UAC3B;AACA,iBAAO;AAAA,QACT;AACA,aAAK;AAAA,UAAiB;AAAA,UACpB,KAAK;AAAA,QAA0B;AAAA,MACnC;AACA,aAAO,WAAW,MAAM,MAAM,SAAS;AAAA,IACzC;AAAA,EACF,CAAC;AACH;AAEO,SAAS,uBAAuBA,SAAQ,gBAAgB;AAE7D,MAAI,CAACA,QAAO,mBAAmB;AAC7B;AAAA,EACF;AACA,MAAI,eAAe,YAAY,YAAY,eAAe,WAAW,IAAI;AACvE;AAAA,EACF;AACA,MAAI,eAAe,YAAY,YAAY,eAAe,WAAW,KAAK;AACxE;AAAA,EACF;AACA,QAAM,YAAYA,QAAO,kBAAkB,UAAU;AACrD,EAAAA,QAAO,kBAAkB,UAAU,uBACnC,SAAS,qBAAqB,MAAM;AAClC,QAAI,QAAQ,KAAK,OAAO,KAAK,IAAI,QAAQ,wBAAwB,MAAM,IAAI;AACzE,YAAMK,OAAM,KAAK,IAAI,MAAM,IAAI,EAAE,OAAO,CAAC,SAAS;AAChD,eAAO,KAAK,KAAK,MAAM;AAAA,MACzB,CAAC,EAAE,KAAK,IAAI;AAEZ,UAAIL,QAAO,yBACP,gBAAgBA,QAAO,uBAAuB;AAChD,kBAAU,CAAC,IAAI,IAAIA,QAAO,sBAAsB;AAAA,UAC9C,MAAM,KAAK;AAAA,UACX,KAAAK;AAAA,QACF,CAAC;AAAA,MACH,OAAO;AACL,aAAK,MAAMA;AAAA,MACb;AAAA,IACF;AACA,WAAO,UAAU,MAAM,MAAM,SAAS;AAAA,EACxC;AACF;AAEO,SAAS,+BAA+BL,SAAQ,gBAAgB;AAKrE,MAAI,EAAEA,QAAO,qBAAqBA,QAAO,kBAAkB,YAAY;AACrE;AAAA,EACF;AACA,QAAM,wBACFA,QAAO,kBAAkB,UAAU;AACvC,MAAI,CAAC,yBAAyB,sBAAsB,WAAW,GAAG;AAChE;AAAA,EACF;AACA,EAAAA,QAAO,kBAAkB,UAAU,kBACjC,SAAS,kBAAkB;AACzB,QAAI,CAAC,UAAU,CAAC,GAAG;AACjB,UAAI,UAAU,CAAC,GAAG;AAChB,kBAAU,CAAC,EAAE,MAAM,IAAI;AAAA,MACzB;AACA,aAAO,QAAQ,QAAQ;AAAA,IACzB;AAMA,SAAM,eAAe,YAAY,YAAY,eAAe,UAAU,MAC7D,eAAe,YAAY,aACxB,eAAe,UAAU,MAC5B,eAAe,YAAY,aAC7B,UAAU,CAAC,KAAK,UAAU,CAAC,EAAE,cAAc,IAAI;AACpD,aAAO,QAAQ,QAAQ;AAAA,IACzB;AACA,WAAO,sBAAsB,MAAM,MAAM,SAAS;AAAA,EACpD;AACJ;AAIO,SAAS,qCAAqCA,SAAQ,gBAAgB;AAC3E,MAAI,EAAEA,QAAO,qBAAqBA,QAAO,kBAAkB,YAAY;AACrE;AAAA,EACF;AACA,QAAM,4BACFA,QAAO,kBAAkB,UAAU;AACvC,MAAI,CAAC,6BAA6B,0BAA0B,WAAW,GAAG;AACxE;AAAA,EACF;AACA,EAAAA,QAAO,kBAAkB,UAAU,sBACjC,SAAS,sBAAsB;AAC7B,QAAI,OAAO,UAAU,CAAC,KAAK,CAAC;AAC5B,QAAI,OAAO,SAAS,YAAa,KAAK,QAAQ,KAAK,KAAM;AACvD,aAAO,0BAA0B,MAAM,MAAM,SAAS;AAAA,IACxD;AAQA,WAAO,EAAC,MAAM,KAAK,MAAM,KAAK,KAAK,IAAG;AACtC,QAAI,CAAC,KAAK,MAAM;AACd,cAAQ,KAAK,gBAAgB;AAAA,QAC3B,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AACH,eAAK,OAAO;AACZ;AAAA,QACF;AACE,eAAK,OAAO;AACZ;AAAA,MACJ;AAAA,IACF;AACA,QAAI,KAAK,OAAQ,KAAK,SAAS,WAAW,KAAK,SAAS,UAAW;AACjE,aAAO,0BAA0B,MAAM,MAAM,CAAC,IAAI,CAAC;AAAA,IACrD;AACA,UAAM,OAAO,KAAK,SAAS,UAAU,KAAK,cAAc,KAAK;AAC7D,WAAO,KAAK,MAAM,IAAI,EACnB,KAAK,OAAK,0BAA0B,MAAM,MAAM,CAAC,CAAC,CAAC,CAAC;AAAA,EACzD;AACJ;;;AT/bA,UAAqB;AAGd,SAAS,eAAe,EAAC,QAAAM,QAAM,IAAI,CAAC,GAAG,UAAU;AAAA,EACtD,YAAY;AAAA,EACZ,aAAa;AAAA,EACb,YAAY;AACd,GAAG;AAED,QAAMC,WAAgB;AACtB,QAAM,iBAAuB,cAAcD,OAAM;AAEjD,QAAME,WAAU;AAAA,IACd;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA;AAAA,IAEA;AAAA,EACF;AAGA,UAAQ,eAAe,SAAS;AAAA,IAC9B,KAAK;AACH,UAAI,CAAC,uBAAc,CAAY,sBAC3B,CAAC,QAAQ,YAAY;AACvB,QAAAD,SAAQ,sDAAsD;AAC9D,eAAOC;AAAA,MACT;AACA,UAAI,eAAe,YAAY,MAAM;AACnC,QAAAD,SAAQ,sDAAsD;AAC9D,eAAOC;AAAA,MACT;AACA,MAAAD,SAAQ,6BAA6B;AAErC,MAAAC,SAAQ,cAAc;AAGtB,MAAW,+BAA+BF,SAAQ,cAAc;AAChE,MAAW,qCAAqCA,SAAQ,cAAc;AAEtE,MAAW,iBAAiBA,SAAQ,cAAc;AAClD,MAAW,gBAAgBA,SAAQ,cAAc;AACjD,MAAW,mBAAmBA,SAAQ,cAAc;AACpD,MAAW,YAAYA,SAAQ,cAAc;AAC7C,MAAW,wBAAwBA,SAAQ,cAAc;AACzD,MAAW,uBAAuBA,SAAQ,cAAc;AACxD,MAAW,aAAaA,SAAQ,cAAc;AAC9C,MAAW,2BAA2BA,SAAQ,cAAc;AAC5D,MAAW,qBAAqBA,SAAQ,cAAc;AAEtD,MAAW,oBAAoBA,SAAQ,cAAc;AACrD,MAAW,iCAAiCA,SAAQ,cAAc;AAClE,MAAW,oBAAoBA,SAAQ,cAAc;AACrD,MAAW,mBAAmBA,SAAQ,cAAc;AACpD,MAAW,uBAAuBA,SAAQ,cAAc;AACxD,MAAW,uBAAuBA,SAAQ,cAAc;AACxD;AAAA,IACF,KAAK;AACH,UAAI,CAAC,wBAAe,CAAaG,uBAC7B,CAAC,QAAQ,aAAa;AACxB,QAAAF,SAAQ,uDAAuD;AAC/D,eAAOC;AAAA,MACT;AACA,MAAAD,SAAQ,8BAA8B;AAEtC,MAAAC,SAAQ,cAAc;AAGtB,MAAW,+BAA+BF,SAAQ,cAAc;AAChE,MAAW,qCAAqCA,SAAQ,cAAc;AAEtE,MAAYI,kBAAiBJ,SAAQ,cAAc;AACnD,MAAYG,oBAAmBH,SAAQ,cAAc;AACrD,MAAYK,aAAYL,SAAQ,cAAc;AAC9C,MAAY,iBAAiBA,SAAQ,cAAc;AACnD,MAAY,mBAAmBA,SAAQ,cAAc;AACrD,MAAY,qBAAqBA,SAAQ,cAAc;AACvD,MAAY,mBAAmBA,SAAQ,cAAc;AACrD,MAAY,mBAAmBA,SAAQ,cAAc;AACrD,MAAY,kBAAkBA,SAAQ,cAAc;AACpD,MAAY,gBAAgBA,SAAQ,cAAc;AAClD,MAAY,iBAAiBA,SAAQ,cAAc;AAEnD,MAAW,oBAAoBA,SAAQ,cAAc;AACrD,MAAW,oBAAoBA,SAAQ,cAAc;AACrD,MAAW,mBAAmBA,SAAQ,cAAc;AACpD,MAAW,uBAAuBA,SAAQ,cAAc;AACxD;AAAA,IACF,KAAK;AACH,UAAI,CAAC,uBAAc,CAAC,QAAQ,YAAY;AACtC,QAAAC,SAAQ,sDAAsD;AAC9D,eAAOC;AAAA,MACT;AACA,MAAAD,SAAQ,6BAA6B;AAErC,MAAAC,SAAQ,cAAc;AAGtB,MAAW,+BAA+BF,SAAQ,cAAc;AAChE,MAAW,qCAAqCA,SAAQ,cAAc;AAEtE,MAAW,qBAAqBA,SAAQ,cAAc;AACtD,MAAW,sBAAsBA,SAAQ,cAAc;AACvD,MAAW,iBAAiBA,SAAQ,cAAc;AAClD,MAAW,oBAAoBA,SAAQ,cAAc;AACrD,MAAW,qBAAqBA,SAAQ,cAAc;AACtD,MAAW,0BAA0BA,SAAQ,cAAc;AAC3D,MAAWI,kBAAiBJ,SAAQ,cAAc;AAClD,MAAW,iBAAiBA,SAAQ,cAAc;AAElD,MAAW,oBAAoBA,SAAQ,cAAc;AACrD,MAAW,iCAAiCA,SAAQ,cAAc;AAClE,MAAW,mBAAmBA,SAAQ,cAAc;AACpD,MAAW,uBAAuBA,SAAQ,cAAc;AACxD,MAAW,uBAAuBA,SAAQ,cAAc;AACxD;AAAA,IACF;AACE,MAAAC,SAAQ,sBAAsB;AAC9B;AAAA,EACJ;AAEA,SAAOC;AACT;;;AD7HA,IAAM,UACJ,eAAe,EAAC,QAAQ,OAAO,WAAW,cAAc,SAAY,OAAM,CAAC;;;ApHd7E,IAAAI,iBAAoB;ACApB,SAAS,MAAMC,UAAY;ASA3B,SAAS,MAAMA,UAAY;AUA3B,SAAS,MAAMC,UAAc;AMA7B,SAAS,iBAAiBC,UAAoB;A2EA9C,SAA8B;AhEA9B,SAAS,iBAAiBC,UAAoB;A0BA9C,SAAS,MAAMC,UAAY;AKA3B,SAAS,iBAAiBD,UAAoB;AoCA9C,OAAOA,QAAkB;AACzB,SAAS,MAAMC,UAAY;AID3B,SAAS,MAAMA,UAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;A7JA3B,IAAAC,KAAAC,GAAA,CAAAC,IAAAC,OAAA;AAAAA,KAAA,UAAA,EACE,SAAW,WACX,SAAW,OACX,YAAc,EACZ,MAAQ,OACR,KAAO,6CACP,WAAa,2BACf,GACA,MAAQ,qBACR,QAAU,iBACV,SAAW,mBACX,OAAS,CACP,QACA,KACF,GACA,SAAW,EACT,MAAQ,OACV,GACA,SAAW,EACT,KAAK,EACH,SAAW,uBACX,QAAU,mBACV,SAAW,kBACb,EACF,GACA,aAAe,OACf,SAAW,EACT,UAAY,mCACZ,OAAS,wCACT,KAAO,0BACP,cAAc,4BACd,OAAS,uCACT,OAAS,UACT,eAAe,wBACf,QAAU,gCACV,MAAQ,uBACR,cAAc,gBACd,iBAAiB,mBACjB,MAAQ,+BACR,YAAY,mBACZ,SAAW,cACX,MAAQ,cACR,SAAW,oBACX,MAAQ,+LACV,GACA,MAAQ,8BACR,QAAU,SACV,cAAgB,EACd,eAAiB,UACjB,OAAS,UACT,kBAAkB,UAClB,UAAY,SACZ,iBAAiB,WACjB,gBAAgB,UAChB,MAAQ,UACR,kBAAkB,UAClB,SAAW,QACb,GACA,iBAAmB,EACjB,+BAA+B,UAC/B,yBAAyB,UACzB,wBAAwB,UACxB,uBAAuB,WACvB,eAAe,UACf,oBAAoB,UACpB,gBAAgB,UAChB,OAAS,SACX,GACA,aAAe,uJACf,UAAY,CACV,SACA,UACA,gBACA,OACF,EACF;AAAA,CAAA;AC/DO,IAAKC,MAAAA,QACVA,EAAA,eAAe,gBACfA,EAAA,UAAU,WACVA,EAAA,aAAa,cACbA,EAAA,YAAY,aACZA,EAAA,eAAe,gBACfA,EAAA,gBAAgB,iBAChBA,EAAA,SAAS,UAPCA,IAAAA,MAAA,CAAA,CAAA;AEJL,IAAKC,MAAAA,QACVA,EAAA,OAAO,QADGA,IAAAA,MAAA,CAAA,CAAA;AC0FL,IAAKC,MAAAA,QACVA,EAAA,OAAO,QACPA,EAAA,QAAQ,SAFEA,IAAAA,MAAA,CAAA,CAAA;AAAL,IAKKC,MAAAA,QACVA,EAAA,cAAc,eACdA,EAAA,YAAY,aACZA,EAAA,YAAY,aACZA,EAAA,cAAc,eACdA,EAAA,QAAQ,SACRA,EAAA,eAAe,gBACfA,EAAA,cAAc,eACdA,EAAA,cAAc,eACdA,EAAA,gBAAgB,iBAChBA,EAAA,cAAc,eACdA,EAAA,gBAAgB,iBAChBA,EAAA,iBAAiB,kBACjBA,EAAA,iBAAiB,kBACjBA,EAAA,4BAA4B,6BAC5BA,EAAA,eAAe,gBACfA,EAAA,6BAA6B,8BAC7BA,EAAA,mCAAmC,oCACnCA,EAAA,aAAa,cACbA,EAAA,oBAAoB,qBACpBA,EAAA,uBAAuB,wBACvBA,EAAA,uBAAuB,wBACvBA,EAAA,eAAe,gBACfA,EAAA,mBAAmB,oBACnBA,EAAA,eAAe,gBACfA,EAAA,eAAe,gBACfA,EAAA,eAAe,gBACfA,EAAA,qBAAqB,sBACrBA,EAAA,aAAa,cACbA,EAAA,qBAAqB,sBACrBA,EAAA,8BAA8B,+BA9BpBA,IAAAA,MAAA,CAAA,CAAA;ACvGL,IAAKC,MAAAA,QACVA,EAAA,QAAQ,SACRA,EAAA,QAAQ,SAFEA,IAAAA,MAAA,CAAA,CAAA;AEYL,SAASC,GAAsBC,IAAsCC,GAAuB;AACjG,MAAIC,GACAC;AACJ,MAAIF;AACF,aAAWG,KAAWH,EAAK,iBAAiB;AAC1C,UAAMI,IAAQL,GAAOI,CAAO;AACxBE,SAAcD,CAAK,MACrBF,IAAaI,GAAQF,CAAK,IAAIA,IAAQF,GACtCD,IAAaM,GAAQH,CAAK,IAAIA,IAAQH;IAE1C;AAGF,SAAO,EAAE,OAAOA,GAAmC,OAAOC,EAAkC;AAC9F;AAEO,SAASI,GAAQF,IAA6B;AACnD,SAAOA,MAASA,GAAM,SAAS;AACjC;AAEO,SAASG,GAAQH,IAA6B;AACnD,SAAOA,MAASA,GAAM,SAAS;AACjC;AAEO,SAASC,GAAcD,IAA6B;AACzD,SAAOA,MAASA,GAAM,WAAW;AACnC;AAEO,SAASI,GAAgBJ,IAA6B;AAC3D,SAAOA,MAASA,GAAM,WAAW;AACnC;AAEO,SAASK,GAAgBL,IAA6B;AAC3D,SAAOA,MAASA,GAAM,WAAW;AACnC;AAEO,SAASM,GAAWN,IAAsB;AAC/C,SAAIA,KACK,CAAA,EAAQA,MAAA,QAAAA,GAAO,YAEjB;AACT;AAEO,SAASO,GAAeC,IAAiBT,GAAkB;AAChE,SAAIA,KAAWS,GAAM,OAAOT,CAAO,IAC1BS,GAAM,OAAOT,CAAO,EAAE,UAExB;AACT;AAYO,SAASU,GAAuBC,IAA0C;AAxEjF,MAAAC;AAyEE,MAAIC,IAAQ,OACVC,IAAQ,OACRC,IAAS;AACX,UAAIH,IAAAD,MAAA,OAAA,SAAAA,GAAM,kBAAN,QAAAC,EAAqB,YACvBC,IAAQF,GAAK,cAAc,QAAQ,SAAS,OAAO,GACnDG,IAAQH,GAAK,cAAc,QAAQ,SAAS,OAAO,GACnDI,IAASJ,GAAK,cAAc,QAAQ,SAAS,QAAQ,IAEhD,EACL,OAAAE,GACA,OAAAC,GACA,QAAAC,EACF;AACF;ACtFO,IAAKC,MAAAA,QACVA,EAAAA,EAAA,UAAA,CAAA,IAAA,WACAA,EAAAA,EAAA,QAAA,CAAA,IAAA,SACAA,EAAAA,EAAA,OAAA,CAAA,IAAA,QACAA,EAAAA,EAAA,OAAA,CAAA,IAAA,QACAA,EAAAA,EAAA,OAAA,CAAA,IAAA,QACAA,EAAAA,EAAA,UAAA,CAAA,IAAA,WACAA,EAAAA,EAAA,QAAA,CAAA,IAAA,SACAA,EAAAA,EAAA,OAAA,CAAA,IAAA,QARUA,IAAAA,MAAA,CAAA,CAAA;AAAL,IAYDC,KAAY,OAAO,UAAW,eAAe,OAAO,OAAO,UAAW;AAZrE,IAiBcC,IAArB,MAA+B;EAG7B,OAAO,EAAEC,MAAgBC,GAAa;AACpC,SAAK,IAAI,GAAqBD,GAAK,GAAGC,CAAI;EAC5C;EAEA,OAAO,EAAED,MAAgBC,GAAa;AACpC,SAAK,IAAI,GAAmBD,GAAK,GAAGC,CAAI;EAC1C;EAEA,OAAO,EAAED,MAAgBC,GAAa;AACpC,SAAK,IAAI,GAAkBD,GAAK,GAAGC,CAAI;EACzC;EAEA,OAAO,EAAED,MAAgBC,GAAa;AACpC,SAAK,IAAI,GAAkBD,GAAK,GAAGC,CAAI;EACzC;EAEA,OAAO,EAAED,MAAgBC,GAAa;AACpC,SAAK,IAAI,GAAmBD,GAAK,GAAGC,CAAI;EAC1C;EAEA,OAAO,KAAKC,GAAc;AACxB,SAAK,IAAI,GAAkB,0BAA0BA,CAAI;EAC3D;EAEA,OAAO,QAAQA,GAAc;AAC3B,SAAK,IAAI,GAAqB,0BAA0BA,GAAMA,CAAI;EACpE;EAEA,OAAO,UAAU;AACf,gBAAY,WAAW,GACvB,YAAY,cAAc;EAC5B;EAGA,OAAe,IAAIC,GAAoBH,MAAgBC,GAAa;AAClE,QAAI,EAAA,KAAK,MAAM,QAAQ,IAAIE,EAAM,QAAQ;AAIzC,cAAQA,GAAO;QACb,KAAK,GAAqB;AACxB,kBAAQ,IAAIH,GAAK,GAAGC,CAAI;AACxB;QACF;QACA,KAAK,GAAmB;AACtB,kBAAQ,MAAMD,GAAK,GAAGC,CAAI;AAC1B;QACF;QACA,KAAK,GAAkB;AACrB,kBAAQ,KAAKD,GAAK,GAAGC,CAAI;AACzB;QACF;QACA,KAAK,GAAkB;AACrB,kBAAQ,KAAKD,GAAK,GAAGC,CAAI;AACzB;QACF;QACA,KAAK,GAAmB;AACtB,kBAAQ,MAAMD,GAAK,GAAGC,CAAI;AAC1B;QACF;QACA,KAAK,GAAkB;AACrB,sBAAY,KAAKA,EAAK,CAAC,CAAC;AACxB;QACF;QACA,KAAK,GAAqB;AACxB,cAAMC,IAAOD,EAAK,CAAC;AACnB,cAAI;AACF,gBAAMG,IAAQ,YAAY,QAAQF,GAAMA,CAAI;AAE5C,iBAAK,IAAI,GAAmBF,GAAKE,GAAME,KAAA,OAAA,SAAAA,EAAO,QAAQ,GACtD,YAAY,WAAWF,CAAI,GAC3B,YAAY,cAAcA,CAAI;UAChC,SAASG,GAAO;AACd,iBAAK,IAAI,GAAmBL,GAAKE,GAAMG,CAAK;UAC9C;AACA;QACF;MACF;EACF;AACF;AAlFqBN,EACZ,QAAqBD,KAAY,IAAmB;AEhBtD,IAAMQ,KAAkB,IAAIC,oBAAAA;AAA5B,IAEMC,IAAY,OAAO,UAAW;AAFpC,IAFPC;AAEO,IAIMC,KACX,OAAO,UAAW,eAAe,GAACD,KAAAH,GAAgB,WAAW,EAAE,SAA7B,QAAAG,GAAmC,YAAA,EAAc,SAAS,UAAA;AAQ9F,IAAME,KAAmB,MACnB,CAAAD;AADN,IAQaE,KAAcD,GAAiB;AAR5C,IAfAE;AAeA,IAfAC;AAeA,IAiBaC,MAAWD,MAAAD,KAAAG,GAAgB,WAAW,MAA3B,OAAA,SAAAH,GAA8B,SAA9B,OAAA,SAAAC,GAAoC,YAAA,EAAc,SAAS,QAAA;AAjBnF,IAfAD;AAeA,IAfAC;AAeA,IAmBaG,OAAYH,MAAAD,KAAAG,GAAgB,WAAW,MAA3B,OAAA,SAAAH,GAA8B,SAA9B,OAAA,SAAAC,GAAoC,YAAA,OAAkB;AElCxE,IAAKI,MAAAA,QACVA,EAAA,SAAS,UACTA,EAAA,QAAQ,SACRA,EAAA,MAAM,OAHIA,IAAAA,MAAA,CAAA,CAAA;ACGZ,SAASC,KAAoB;AAI3B,MAAIC,KAAa,QAAQ;AACvB,QAAMC,KAAU,OAAO,SAAS;AAEhC,WAAIA,OAAY,eAAeA,OAAY,cAAA,UAIvCA,GAAQ,SAAS,gBAAgB,IAAA,QAAA;EAKvC;AAEA,SAAA;AACF;AAEO,IAAMC,KAAiBH,GAAkB;AEjBzC,IAAMI,KAAa,EAExB,2BAA2B,EAEzB,mBAAmB,KAGnB,2BAA2B,MAG3B,gBAAgB,KAClB,GAEA,WAAW,EAET,eAAe,KAEf,2BAA2B,MAG3B,sBAAsB,MAGtB,sBAAsB,KACxB,GAEA,cAAc,EAEZ,eAAe,KAGf,4BAA4B,MAG5B,sBAAsB,MAGtB,eAAe,MAGf,oBAAoB,MAGpB,mBAAmB,MAGnB,wBAAwB,MAGxB,4BAA4B,MAG5B,gBAAgB,MAGhB,kBAAkB,MAGlB,mBAAmB,MAGnB,0BAA0B,MAG1B,wBAAwB,MAGxB,sBAAsB,MAGtB,yBAAyB,KAC3B,GAEA,cAAc,EAEZ,qBAAqB,MAGrB,sBAAsB,MAGtB,8BAA8B,MAG9B,+BAA+B,MAG/B,aAAa,MAGb,kBAAkB,MAElB,cAAc,KAChB,GAEA,uBAAuB,EAErB,eAAe,KAGf,gBAAgB,MAGhB,iCAAiC,KACnC,GAEA,eAAe,EAEb,eAAe,KAGf,YAAY,MAGZ,SAAS,MAGT,WAAW,MAGX,qBAAqB,MAGrB,wBAAwB,MAGxB,mBAAmB,MAGnB,uBAAuB,MAGvB,cAAc,MAEd,qBAAqB,MAErB,sBAAsB,MAEtB,2BAA2B,MAC3B,6BAA6B,MAE7B,mBAAmB,KACrB,GAEA,gBAAgB,EACd,kBAAkB,MAClB,qBAAqB,KACvB,EACF;ACvJO,IAAMC,IAAN,MAAMC,UAAqB,MAA8C;EAI9E,YACkBC,GACTC,GACPC,GACOC,GACAC,GACAC,IAAsB,OAC7B;AACA,UAAMF,CAAO;AAPG,SAAA,OAAAH;AACT,SAAA,OAAAC;AAEA,SAAA,UAAAE;AACA,SAAA,cAAAC;AACA,SAAA,aAAAC;AAKP,WAAO,eAAe,MAAMN,EAAa,SAAS,GAClD,KAAK,SAASG,EAAO,SAAS;EAChC;EAEA,wBAAwB;AACtB,WAAO,EACL,YAAY,KAAK,MACjB,YAAY,KAAK,MACjB,eAAe,KAAK,SACpB,mBAAmB,KAAK,aACxB,QAAQ,KAAK,QACb,aAAa,KAAK,WACpB;EACF;EAEA,eAAeI,GAAc;AAC3B,SAAK,cAAcA;EACrB;EAEA,WAAW;AAtCb,QAAAnB;AAuCI,WAAO;cACG,KAAK,IAAI;cACT,KAAK,IAAI;gBACP,KAAK,MAAM;iBACV,KAAK,OAAO;qBACR,KAAK,WAAW;oBACjB,KAAK,UAAU;sBACdA,IAAA,KAAK,gBAAL,OAAA,SAAAA,EAAkB,OAAO;;EAE5C;AACF;AErCA,IAAMoB,KAAmD,CAAA,QAAA,SAAA,UAAA,WAAA,YAAA,MAOzD;AAPA,IASaC,IAAe,EAC1B,2BAA2B,EACzB,gBAAgBC,IAAmBC,IAAc,IAAI;AACnD,SAAO,IAAIC,EACTC,GAAW,0BAA0B,mBACrC,4BACAH,IACA,SAASC,CAAW,IACpB,SAASA,CAAW,EACtB;AACF,GAEA,wBAAwBD,IAAmBC,IAAc,IAAI;AAC3D,SAAO,IAAIC,EACTC,GAAW,0BAA0B,2BACrC,2BACAH,IACA,2BACAC,CACF;AACF,GAEA,cAAcD,IAAmBC,IAAc,IAAI;AACjD,SAAO,IAAIC,EACTC,GAAW,0BAA0B,gBACrC,0BACAH,IACA,+BACAC,CACF;AACF,EACF,GAEA,WAAW,EACT,aAAaG,IAAcJ,GAAmBC,IAAc,IAAII,IAAa,MAAM;AACjF,SAAO,IAAIH,EACTE,IACA,gBACAJ,GACA,IAAIA,CAAM,mBAAmBC,CAAW,IACxCA,GACAI,CACF;AACF,GAEA,oBAAoBL,IAAmBC,IAAc,IAAI;AACvD,SAAO,IAAIC,EACTC,GAAW,UAAU,sBACrB,uBACAH,IACA,+BAA+BC,CAAW,IAC1CA,CACF;AACF,GAEA,mBAAmBD,IAAmBC,IAAc,IAAI;AACtD,SAAO,IAAIC,EACTC,GAAW,UAAU,sBACrB,sBACAH,IACA,uCAAuCC,CAAW,IAClDA,GACA,IACF;AACF,GAEA,uBAAuBD,IAAmBC,IAAc,IAAI;AAC1D,SAAO,IAAIC,EACTC,GAAW,UAAU,2BACrB,aACAH,IACA,WAAWC,CAAW,IACtB,WAAWA,CAAW,EACxB;AACF,EACF,GAEA,cAAc,EACZ,aAAaD,IAAmBC,IAAc,IAAI;AAChD,SAAO,IAAIC,EACTC,GAAW,aAAa,eACxB,gBACAH,IACA,YAAYC,CAAW,IACvB,YAAYA,CAAW,EACzB;AACF,GAEA,wBAAwBD,IAAmBM,GAAoBL,IAAc,IAAI;AAC/E,SAAO,IAAIC,EACTC,GAAW,aAAa,4BACxB,2BACAH,IACA,qDAAqDM,CAAU,IAC/DL,CACF;AACF,GAEA,mBAAmBD,IAAmBM,GAAoBL,IAAc,IAAI;AAC1E,SAAO,IAAIC,EACTC,GAAW,aAAa,sBACxB,sBACAH,IACA,oDAAoDM,CAAU,IAC9DL,CACF;AACF,GAEA,YAAYD,IAAmBM,GAAoBL,IAAc,IAAI;AACnE,SAAO,IAAIC,EACTC,GAAW,aAAa,eACxB,eACAH,IACA,8DAA8DM,CAAU,IACxEL,CACF;AACF,GAEA,iBAAiBD,IAAmBM,GAAoBL,IAAc,IAAI;AACxE,SAAO,IAAIC,EACTC,GAAW,aAAa,oBACxB,oBACAH,IACA,0CAA0CM,CAAU,IACpDL,CACF;AACF,GAEA,gBACED,IACAC,IAAc,IACdM,IAAU,6EACV;AACA,SAAO,IAAIL,EACTC,GAAW,aAAa,mBACxB,mBACAH,IACAO,GACAN,CACF;AACF,GAEA,qBAAqBD,IAAmBC,IAAc,IAAI;AACxD,SAAO,IAAIC,EACTC,GAAW,aAAa,wBACxB,wBACAH,IACA,+DACAC,CACF;AACF,GAEA,gBAAgBD,IAAmBC,IAAc,IAAI;AACnD,SAAO,IAAIC,EACTC,GAAW,aAAa,gBACxB,mBACAH,IACA,6EACAC,CACF;AACF,GAEA,wBAAwBD,IAAmBC,IAAc,IAAI;AAC3D,SAAO,IAAIC,EACTC,GAAW,aAAa,4BACxB,2BACAH,IACA,oCACAC,CACF;AACF,GAEA,gBAAgBD,IAAmBM,GAAoBL,IAAc,IAAI;AACvE,SAAO,IAAIC,EACTC,GAAW,aAAa,kBACxB,mBACAH,IACA,iFAAiFM,CAAU,IAC3FL,CACF;AACF,GAEA,gBAAgBD,IAAmBC,IAAc,mDAAmD;AAClG,SAAO,IAAIC,EACTC,GAAW,aAAa,mBACxB,mBACAH,IACA,2CACAC,CACF;AACF,GAEA,uBAAuBD,IAAmBM,GAAoBL,IAAc,IAAI;AAC9E,SAAO,IAAIC,EACTC,GAAW,aAAa,0BACxB,0BACAH,IACA,iEAAiEM,CAAU,IAC3EL,CACF;AACF,GAEA,sBAAsB;AACpB,SAAO,IAAIC,EACTC,GAAW,aAAa,wBACxB,uBAAA,SAEA,iDACA,2DACF;AACF,GAEA,mBAAmBF,IAAqB;AACtC,SAAO,IAAIC,EACTC,GAAW,aAAa,sBACxB,wBAAA,SAEAF,IACAA,EACF;AACF,GAEA,sBAAsBO,IAAoB;AACxC,SAAO,IAAIN,EACTC,GAAW,aAAa,yBACxB,yBAAA,SAEA,6BAA6BK,EAAU,WACvC,kCAAkCA,EAAU,WAC5C,KACF;AACF,EACF,GAEA,cAAc,EACZ,kBAAkBR,IAAmBC,IAAc,IAAI;AACrD,SAAO,IAAIC,EACTC,GAAW,aAAa,qBACxB,qBACAH,IACA,IAAIA,GAAO,SAAS,CAAC,+BACrBC,CACF;AACF,GAEA,mBAAmBD,IAAmBC,IAAc,IAAI;AACtD,SAAO,IAAIC,EACTC,GAAW,aAAa,sBACxB,sBACAH,IACA,IAAIA,GAAO,SAAS,CAAC,gCACrBC,CACF;AACF,GAEA,0BAA0BD,IAAmBC,IAAc,IAAI;AAC7D,SAAO,IAAIC,EACTC,GAAW,aAAa,8BACxB,6BACAH,IACA,IAAIA,GAAO,SAAS,CAAC,4BACrBC,CACF;AACF,GAEA,2BAA2BD,IAAmBC,IAAc,IAAI;AAC9D,SAAO,IAAIC,EACTC,GAAW,aAAa,+BACxB,8BACAH,IACA,IAAIA,GAAO,SAAS,CAAC,6BACrBC,GACA,IACF;AACF,GAEA,WAAWD,IAAmBC,IAAc,IAAII,IAAa,OAAO;AAClE,SAAO,IAAIH,EACTC,GAAW,aAAa,aACxB,cACAH,IACA,IAAIA,GAAO,SAAS,CAAC,kCACrBC,GACAI,CACF;AACF,GAEA,gBAAgBL,IAAmBC,IAAc,IAAI;AACnD,SAAO,IAAIC,EACTC,GAAW,aAAa,kBACxB,mBACAH,IACA,IAAIA,GAAO,SAAS,CAAC,wCACrBC,CACF;AACF,GAEA,YAAYD,IAAmBC,IAAc,IAAI;AAC/C,SAAO,IAAIC,EACTC,GAAW,aAAa,cACxB,eACAH,IACA,gCAAgCC,CAAW,IAC3CA,CACF;AACF,EACF,GAEA,uBAAuB,EACrB,aAAaG,IAAcJ,GAAqCC,GAAqB;AACnF,SAAO,IAAIC,EAAaE,IAAM,gBAAgBJ,GAAQC,GAAaA,GAAaH,GAAgB,SAASE,CAAM,CAAC;AAClH,GAEA,cAAcA,IAAmBC,IAAc,IAAI;AACjD,SAAO,IAAIC,EACTC,GAAW,sBAAsB,gBACjC,iBACAH,IACA,8CACAC,CACF;AACF,GAEA,4BAA4BD,IAAmBC,IAAc,IAAI;AAC/D,SAAO,IAAIC,EACTC,GAAW,sBAAsB,iCACjC,+BACAH,IACA,iDACAC,CACF;AACF,EACF,GAEA,eAAe,EACb,aAAaD,IAAmBC,IAAc,IAAI;AAChD,SAAO,IAAIC,EACTC,GAAW,cAAc,eACzB,gBACAH,IACA,2BACAC,CACF;AACF,GAEA,WAAWD,IAAmBC,GAAqB;AACjD,SAAO,IAAIC,EACTC,GAAW,cAAc,YACzB,cACAH,IACA,6BAA6BA,GAAO,SAAS,CAAC,IAAIC,CAAW,KAC7DA,CACF;AACF,GAEA,QAAQD,IAAmBC,GAAqB;AAC9C,SAAO,IAAIC,EACTC,GAAW,cAAc,SACzB,WACAH,IACA,sBAAsBC,CAAW,IACjCA,CACF;AACF,GAEA,SAASD,IAAmBC,IAAc,IAAI;AAC5C,SAAO,IAAIC,EAAaC,GAAW,cAAc,WAAW,YAAYH,IAAQC,GAAaA,CAAW;AAC1G,GAEA,kBAAkBD,IAAmBS,GAAqBR,IAAc,IAAI;AAC1E,SAAO,IAAIC,EACTC,GAAW,cAAc,qBACzB,qBACAH,IACA,kCAAkCS,CAAW,IAC7CR,CACF;AACF,GAEA,qBAAqBD,IAAmBC,IAAc,IAAI;AACxD,SAAO,IAAIC,EACTC,GAAW,cAAc,wBACzB,wBACAH,IACA,0BACAC,CACF;AACF,GAEA,gBAAgBD,IAAmBC,IAAc,IAAI;AACnD,SAAO,IAAIC,EACTC,GAAW,cAAc,mBACzB,mBACAH,IACA,qBACAC,CACF;AACF,GAEA,oBAAoBD,IAAmBC,IAAc,IAAI;AACvD,SAAO,IAAIC,EACTC,GAAW,cAAc,uBACzB,uBACAH,IACA,yBACAC,CACF;AACF,GAEA,iBAAiBM,IAAiBG,GAAc;AAC9C,SAAO,IAAIR,EACTC,GAAW,cAAc,mBACzB,oBAAA,cAEAI,IACAG,IAAS,KAAK,UAAUA,CAAM,IAAI,EACpC;AACF,GAEA,YAAYV,IAAmBC,GAAqB;AAClD,SAAO,IAAIC,EACTC,GAAW,cAAc,cACzB,eACAH,IACA,sCACAC,GACA,IACF;AACF,GAEA,yBAAyBD,IAAmBC,IAAc,IAAI;AAC5D,SAAO,IAAIC,EACTC,GAAW,cAAc,qBACzB,4BACAH,IACA,oDACAC,CACF;AACF,GAEA,yBAAyBA,KAAc,0CAA0C;AAC/E,SAAO,IAAIC,EACTC,GAAW,cAAc,6BACzB,4BAAA,QAEA,4BACAF,EACF;AACF,GAEA,sBAAsB;AACpB,SAAO,IAAIC,EACTC,GAAW,cAAc,sBACzB,uBAAA,QAEA,6OACA,IACA,IACF;AACF,GAEA,2BAA2B;AACzB,SAAO,IAAID,EACTC,GAAW,cAAc,2BACzB,4BAAA,QAEA,kKACA,IACA,IACF;AACF,EACF,GAEA,mBAAmB,EACjB,qBAAqBH,IAAmBC,IAAc,IAAI;AACxD,SAAO,IAAIC,EACT,MACA,wBACAF,IACA,yDACAC,CACF;AACF,GAEA,WAAWD,IAAmBC,IAAc,IAAI;AAC9C,SAAO,IAAIC,EAAa,MAAM,cAAcF,IAAQ,sBAAsBC,CAAW;AACvF,GAEA,iBAAiBD,IAAmBC,IAAc,IAAI;AACpD,SAAO,IAAIC,EAAa,MAAM,oBAAoBF,IAAQ,4BAA4BC,CAAW;AACnG,GAEA,qBAAqBD,IAAmBC,IAAc,IAAI;AACxD,SAAO,IAAIC,EAAa,MAAM,wBAAwBF,IAAQ,kCAAkCC,CAAW;AAC7G,GAEA,mBAAmBD,IAAmBC,IAAc,IAAI;AACtD,SAAO,IAAIC,EACT,MACA,sBACAF,IACA,uDACAC,CACF;AACF,EACF,GAEA,gBAAgB,EACd,cAAcD,IAAmBC,GAAqB;AACpD,SAAO,IAAIC,EACTC,GAAW,eAAe,kBAC1B,iBACAH,IACA,2BACAC,CACF;AACF,GACA,eAAeD,IAAmBC,GAAqB;AACrD,SAAO,IAAIC,EACTC,GAAW,eAAe,qBAC1B,oBACAH,IACA,oCACAC,CACF;AACF,EACF,EACF;AChiBA,IAAMU,KAAN,MAAmB;EAAnB,cAAA;AACE,SAAA,YAAY,oBAAI;EAAA;EAChB,QAAQC,GAAa;AACnB,WAAI,KAAK,UAAU,IAAIA,CAAG,IACjB,OAAO,KAAK,UAAU,IAAIA,CAAG,CAAC,IAEhC;EACT;EAEA,QAAQA,GAAaC,GAAa;AAChC,SAAK,UAAU,IAAID,GAAKC,CAAG;EAC7B;EAEA,WAAWD,GAAa;AACtB,SAAK,UAAU,OAAOA,CAAG;EAC3B;EAEA,QAAQ;AACN,SAAK,UAAU,MAAM;EACvB;EAEA,IAAIE,GAAW;AACb,QAAI,UAAU,WAAW;AACvB,YAAM,IAAI,UAAU,gFAAgF;AAGtG,WADY,MAAM,KAAK,KAAK,UAAU,KAAK,CAAC,EACjCA,CAAC;EACd;EAEA,IAAI,SAAS;AACX,WAAO,KAAK,UAAU;EACxB;AACF;AAhCA,IAkCaC,KAAiC,MAAM;AAClD,MAAI;AACEC,SAAa,CAAC,iBAChB,OAAO,eAAe,IAAIL;EAE9B,SAASM,IAAG;AACVC,MAAU,EAAE,mCAAmCnB,EAAa,cAAc,yBAAyB,CAAC;EACtG;AACF;ACzCO,IAAMY,KAAN,MAAsB;EAG3B,YAA4BC,GAAa;AAAb,SAAA,MAAAA;AAF5B,SAAQ,UAA0B;EAEQ;EAK1C,aAAa;AACX,QAAI;AACF,aAAII,KAAa,CAAC,KAAK,YACrBD,GAA+B,GAC/B,KAAK,UAAU,OAAO,eAEjB,KAAK;IACd,SAAS,GAAG;AACV,aAAAG,EAAU,EAAE,mCAAmCnB,EAAa,cAAc,yBAAyB,CAAC,GAC7F;IACT;EACF;EAEA,MAAqB;AA1BvB,QAAAoB;AA2BI,QAAMC,KAAaD,IAAA,KAAK,WAAW,MAAhB,OAAA,SAAAA,EAAmB,QAAQ,KAAK,GAAA;AACnD,WAAKC,IAGQ,KAAK,MAAMA,CAAU,IAFhC;EAIJ;EAEA,IAAIC,GAAU;AAnChB,QAAAF;AAoCI,QAAMG,IAAc,KAAK,UAAUD,CAAK;AAAA,KACxCF,IAAA,KAAK,WAAW,MAAhB,QAAAA,EAAmB,QAAQ,KAAK,KAAKG,CAAAA;EACvC;EAEA,QAAQ;AAxCV,QAAAH;AAAAA,KAyCIA,IAAA,KAAK,WAAW,MAAhB,QAAAA,EAAmB,WAAW,KAAK,GAAA;EACrC;AACF;ANxCO,IAAMI,KAAuB,MAAM;AACxC,MAAIC,IACEC,IAAU,IAAId,GAAqB,wBAAwB,GAC3De,IAAYD,EAAQ,IAAI;AAC9B,SAAIC,IACFF,KAAKE,KAELF,KAAKG,GAAK,GACVF,EAAQ,IAAID,EAAE,IAETA;AACT;AOHO,SAASI,GAAUC,IAAY;AACpC,SAA8BA,MAAU;AAC1C;ACPA,IAAMC,KAAc,GAAA,EAA8B;AAgB3C,SAASC,GAAgBC,KAAAA,QAAwBC,GAA0C;AAChG,MAAMC,IAAM,OACNC,IAAMC,OAAAA,WAA2CJ,OAAAA,SAAsB,SAAS;AAEtF,MAAIK;AACF,WAAOC,GAAsB,EAC3B,IAAI,cACJ,YAAY,QAAQ,SACpB,KAAAJ,GACA,aAAAJ,IACA,KAAAK,GACA,QAAQC,IACR,aAAa,CAAC,EAACH,KAAA,QAAAA,EAAe,aAC9B,WAAW,QACX,mBAAmB,QAAQ,SAC3B,uBAAuBA,KAAA,OAAA,SAAAA,EAAe,WACxC,CAAC;AAGH,MAAMM,IAAWC,GAAgB,MAAM,GACjCC,IAAeD,GAAgB,UAAU,GACzCE,IAAgBF,GAAgB,WAAW,GAE3CG,IAAKC,GAAc,OAAOL,EAAS,IAAI,EAAE,GACzCM,IAAaN,EAAS,WAAW,IAEjCO,IAAUF,GAAc,GAAGF,EAAc,IAAI,IAAIA,EAAc,OAAO,EAAE,GAC1EK,IAAeD;AACnB,SAAIL,EAAa,SAEfM,IAAe,GADMH,GAAc,GAAGH,EAAa,MAAM,IAAIA,EAAa,IAAI,EAAE,CAClD,IAAIK,CAAO,KAGpCR,GAAsB,EAC3B,IAAAK,GACA,YAAAE,GACA,KAAAX,GACA,aAAAJ,IACA,cAAAiB,GACA,KAAAZ,GACA,QAAQC,IACR,aAAa,CAAC,EAACH,KAAA,QAAAA,EAAe,aAC9B,WAAWA,KAAA,OAAA,SAAAA,EAAe,MAC1B,mBAAmBA,KAAA,OAAA,SAAAA,EAAe,SAClC,uBAAuBA,KAAA,OAAA,SAAAA,EAAe,WACxC,CAAC;AACH;AAEA,SAASW,GAAcI,IAAW;AAChC,SAAOA,GAAE,QAAQ,MAAM,GAAG;AAC5B;AAEA,IAAMV,KAAwB,CAACW,IAAmBC,IAAY,QAC5D,OAAO,KAAKD,EAAM,EACf,OAAOE,OAAOC,GAAUH,GAAOE,CAAsB,CAAC,CAAC,EACvD,IAAIA,OAAO,GAAGA,CAAG,IAAIF,GAAOE,CAAsB,CAAC,EAAE,EACrD,KAAKD,CAAS;AXzDnB,IAAqBG,IAArB,MAAwF;EA4BtF,YAAY,EAAE,MAAAC,GAAM,OAAAC,GAAO,YAAAC,GAAY,aAAAC,GAAa,WAAAC,EAAU,GAAuB;AAvBrF,SAAA,WAeI,EACF,MAAM,CAAC,GACP,WAAW3B,GAAgB,EAC7B;AAME,SAAK,OAAOuB,GACZ,KAAK,QAAQC,GACb,KAAK,cAAcE,KAAe,OAClC,KAAK,aAAaD,KAAc,CAAC,GACjC,KAAK,YAAYE,MAAa,oBAAI,KAAK,GAAE,QAAQ,GACjD,KAAK,WAAWC,GAAK,GACrB,KAAK,YAAYC,GAAqB;EACxC;EAEA,iBAAiB;AACf,WAAO,EACL,MAAM,KAAK,MACX,MAAMC,EAAAC,EAAA,CAAA,GAAK,KAAK,UAAA,GAAV,EAAsB,WAAW,KAAK,WAAW,QAAQ1B,GAAe,CAAA,GAC9E,YAAW,oBAAI,KAAK,GAAE,QAAQ,EAChC;EACF;AACF;AYxDA,IAAqB2B,IAArB,MAA2C;EAIzC,OAAO,QACLC,GACAC,GACAC,IAAoB,oBAAI,QACxBC,IAAoB,oBAAI,QACxBC,GACA;AACA,QAAMd,IAAO,KAAK,aAAa,WAAWU,MAAU,MAAS,GACvDT,IAAQS,IAAAA,IAAAA,GAERR,IAAa,KAAK,uBACtBK,EAAAC,EAAA,CAAA,GACKG,CAAAA,GADL,EAEE,CAAC,KAAK,gBAAgB,GAAGC,KAAA,OAAA,SAAAA,EAAa,QAAA,GACtC,CAAC,KAAK,gBAAgB,GAAGC,KAAA,OAAA,SAAAA,EAAa,QAAA,GACtC,UAAAC,EACF,CAAA,GACAJ,CACF;AAEA,WAAO,IAAIX,EAAe,EAAE,MAAAC,GAAM,OAAAC,GAAO,YAAAC,EAAW,CAAC;EACvD;EAEA,OAAO,WAAWQ,GAAeC,GAAsD;AACrF,QAAMX,IAAO,gBACPC,IAAQS,IAAAA,IAAAA,GACRR,IAAa,KAAK,uBAAuBS,GAAsBD,CAAK;AAE1E,WAAO,IAAIX,EAAe,EAAE,MAAAC,GAAM,OAAAC,GAAO,YAAAC,EAAW,CAAC;EACvD;EAEA,OAAO,QAAQa,GAWZ;AAXY,QAAAC,IAAAD,GACb,EAAA,OAAAL,EA9CJ,IA6CiBM,GAEVC,IAAAC,GAFUF,GAEV,CADH,OAAA,CAAA;AAWA,QAAMhB,IAAO,KAAK,aAAa,WAAWU,MAAU,MAAS,GACvDT,IAAQS,IAAAA,IAAAA,GACRR,IAAa,KAAK,uBAAuBe,GAAOP,CAAK;AAE3D,WAAO,IAAIX,EAAe,EAAE,MAAAC,GAAM,OAAAC,GAAO,YAAAC,EAAW,CAAC;EACvD;EAEA,OAAO,KAAKiB,GAeT;AAfS,QAAAC,IAAAD,GACV,EAAA,OAAAT,EAjEJ,IAgEcU,GAEPH,IAAAC,GAFOE,GAEP,CADH,OAAA,CAAA;AAeA,QAAMpB,IAAO,KAAK,aAAa,QAAQU,MAAU,MAAS,GACpDT,IAAQS,IAAAA,IAAAA,GAERR,IAAa,KAAK,uBAAuBK,EAAAC,EAAA,CAAA,GAAKS,CAAAA,GAAL,EAAY,mBAAmB,CAAC,CAACA,EAAM,kBAAkB,CAAA,GAAGP,CAAK;AAEhH,WAAO,IAAIX,EAAe,EAAE,MAAAC,GAAM,OAAAC,GAAO,YAAAC,EAAW,CAAC;EACvD;EAEA,OAAO,QAAQ,EAAE,SAAAmB,GAAS,UAAAC,GAAU,OAAAZ,EAAM,GAAwE;AAChH,QAAMV,IAAO,KAAK,aAAa,WAAWU,MAAU,MAAS,GACvDT,IAAQS,IAAAA,IAAAA,GACRR,IAAa,KAAK,uBACtB,EACE,SAAAmB,GACA,OAAOC,KAAA,OAAA,SAAAA,EAAU,OACjB,OAAOA,KAAA,OAAA,SAAAA,EAAU,MACnB,GACAZ,CACF;AACA,WAAO,IAAIX,EAAe,EACxB,MAAAC,GACA,OAAAC,GACA,YAAAC,EACF,CAAC;EACH;EAEA,OAAO,eAAeQ,GAAqB;AACzC,WAAO,IAAIX,EAAe,EACxB,MAAM,kBACN,OAAA,GACA,YAAY,KAAK,mBAAmBW,CAAK,EAC3C,CAAC;EACH;EACA,OAAO,cAAcA,GAAc;AACjC,QAAMV,IAAO,KAAK,aAAa,aAAa,KAAK,GAC3CC,IAAAA,GACAC,IAAa,KAAK,mBAAmBQ,CAAK;AAEhD,WAAO,IAAIX,EAAe,EAAE,MAAAC,GAAM,OAAAC,GAAO,YAAAC,EAAW,CAAC;EACvD;EAEA,OAAO,QAAQ;AACb,WAAO,IAAIH,EAAe,EAAE,MAAM,SAAS,OAAA,EAAgC,CAAC;EAC9E;EAEA,OAAO,gBAAgB;AACrB,WAAO,IAAIA,EAAe,EAAE,MAAM,iBAAiB,OAAA,EAAiC,CAAC;EACvF;EAEA,OAAO,mBAAmBW,GAAqB;AAC7C,WAAO,IAAIX,EAAe,EACxB,MAAM,sBACN,OAAA,GACA,YAAY,KAAK,mBAAmBW,CAAK,EAC3C,CAAC;EACH;EAEA,OAAO,aAAa,EAClB,iBAAAa,GACA,WAAAC,GACA,MAAAC,GACA,SAAAJ,GACA,OAAAX,EACF,GAMG;AACD,QAAMV,IAAO,KAAK,aAAaU,IAAQ,YAAY,UAAUe,CAAI,IAAIf,MAAU,MAAS,GAClFT,IAAQS,IAAAA,IAAAA,GACRR,IAAa,KAAK,uBAAuB,EAAE,WAAAsB,GAAW,SAAAH,GAAS,iBAAAE,EAAgB,GAAGb,CAAK;AAC7F,WAAO,IAAIX,EAAe,EACxB,MAAAC,GACA,OAAAC,GACA,YAAAC,EACF,CAAC;EACH;EAEA,OAAO,YAAYwB,GAAqC;AACtD,QAAM1B,IAAO,cACPC,IAAAA,GACAC,IAAawB,EAAM,sBAAsB;AAE/C,WAAO,IAAI3B,EAAe,EAAE,MAAAC,GAAM,OAAAC,GAAO,YAAAC,EAAW,CAAC;EACvD;EAEA,OAAO,SAASwB,GAAqC;AACnD,QAAM1B,IAAO,aACPC,IAAAA,GACAC,IAAawB,EAAM,sBAAsB;AAE/C,WAAO,IAAI3B,EAAe,EAAE,MAAAC,GAAM,OAAAC,GAAO,YAAAC,EAAW,CAAC;EACvD;EAEA,OAAO,eAAeQ,GAAqB;AACzC,QAAMV,IAAO,oBACPC,IAAAA;AAEN,WAAO,IAAIF,EAAe,EAAE,MAAAC,GAAM,OAAAC,GAAO,YAAY,KAAK,mBAAmBS,CAAK,EAAE,CAAC;EACvF;EAMA,OAAO,iBAAiBiB,GAA4BC,GAAqB;AACvE,QAAM5B,IAAO,2BACPC,IAAAA,GACFC,IAAkB,EACpB,YAAYyB,EAAM,YAClB,SAASA,EAAM,QACjB;AAEA,QAAI,CAACC,KAAcD,EAAM,sBAAsB,MAAM;AAEnD,UAAME,IAAa,oBAAI,QACjBC,IAAWD,EAAW,QAAQ,IAAIF,EAAM,WAAW,QAAQ;AACjEzB,UAAaK,EAAAC,EAAA,CAAA,GAAKN,CAAAA,GAAL,EAAiB,UAAA4B,GAAU,YAAAD,EAAW,CAAA;IACrD;AAEA,WAAO,IAAI9B,EAAe,EAAE,MAAAC,GAAM,OAAAC,GAAO,YAAAC,EAAW,CAAC;EACvD;EAEA,OAAO,mBAAmBQ,GAAcqB,GAA0C;AAChF,QAAM7B,IAAa,KAAK,uBAAuB,EAAE,QAAA6B,EAAO,GAAGrB,CAAK,GAC1DT,IAAAA,GACAD,IAAO;AAEb,WAAO,IAAID,EAAe,EAAE,MAAAC,GAAM,OAAAC,GAAO,YAAAC,EAAW,CAAC;EACvD;EAEA,OAAO,sBAAsBA,GAAmE;AAC9F,WAAO,IAAIH,EAAe,EACxB,MAAM,+BACN,OAAOG,EAAW,QAAA,IAAA,GAClB,YAAAA,EACF,CAAC;EACH;EAEA,OAAO,aAAaA,GAAoC;AACtD,WAAO,IAAIH,EAAe,EACxB,MAAM,mBACN,OAAA,GACA,YAAAG,EACF,CAAC;EACH;EAEA,OAAO,eAAeA,GAAsC;AAC1D,WAAO,IAAIH,EAAe,EACxB,MAAM,oBACN,OAAA,GACA,YAAAG,EACF,CAAC;EACH;EAEA,OAAO,cAAc4B,GAAkB;AACrC,WAAO,IAAI/B,EAAe,EACxB,MAAM,eACN,OAAA,GACA,YAAY,EAAE,UAAA+B,EAAS,EACzB,CAAC;EACH;EAEA,OAAO,aAAa;AAClB,WAAO,IAAI/B,EAAe,EACxB,MAAM,eACN,OAAA,EACF,CAAC;EACH;EAEA,OAAO,YAAY;AACjB,WAAO,IAAIA,EAAe,EACxB,MAAM,cACN,OAAA,EACF,CAAC;EACH;EAEA,OAAO,aAAa,EAClB,SAAAiC,GACA,MAAAP,GACA,QAAAQ,GACA,YAAAC,EACF,GAKG;AACD,WAAO,IAAInC,EAAe,EACxB,MAAM,GAAGiC,IAAU,uBAAuB,mBAAmB,IAC7D,OAAA,GACA,YAAYxB,EAAA,EACV,QAAAyB,GACA,MAAAR,EAAAA,GACGS,CAAAA,EAEP,CAAC;EACH;EAEA,OAAe,aAAalC,GAAcmC,GAAa;AAErD,WAAO,GAAGnC,CAAI,IADCmC,IAAK,YAAY,QACR;EAC1B;EAEA,OAAe,uBAAuBC,GAAwB1B,GAAe;AAC3E,QAAM2B,IAAkB,KAAK,mBAAmB3B,CAAK;AACrD,WAAA0B,IAAoB5B,EAAAA,EAAA,CAAA,GAAK6B,CAAAA,GAAoBD,CAAAA,GACtCA;EACT;EAEA,OAAe,mBAAmB1B,GAAoC;AACpE,WAAIA,IACKA,aAAiB4B,IACpB5B,EAAM,sBAAsB,IAC5B,EACE,YAAYA,EAAM,MAClB,eAAeA,EAAM,SACrB,mBAAmBA,EAAM,MAC3B,IAEG,CAAC;EAEZ;AACF;AAvSqBD,EACJ,mBAAmB,gBADfA,EAEJ,mBAAmB;AKFpC,IAAM8B,KAAN,MAAoB;EAApB,cAAA;AACE,SAAQ,UAAU,IAAIC,GAA8B,sBAAsB;AAC1E,SAAQ,WAAW;AAEnB,SAAiB,MAAM;EAAA;EAEvB,WAAWC,GAAoB;AAC7B,SAAK,UAAUA;EACjB;EAEA,gBAAgBC,GAAgB;AAC9B,SAAK,WAAWA;EAClB;EAQA,gBAAgBC,GAAmD,EAAE,UAAAC,GAAU,SAAAC,EAAQ,GAAe;AACpG,QAAI,CAAC,KAAK,WAAW,CAAC,KAAK;AACzB;AAEF,QAAMC,IAAe,KAAK,QAAQH,CAAI,EAAE,KAAKI,OAAU,KAAK,OAAO,EAAE,UAAAH,GAAU,SAAAC,EAAQ,GAAGE,CAAM,CAAC;AACjG,QAAI,CAACD,GAAc;AACjBE,QAAU,EAAE,KAAK,KAAK,wCAAwCJ,CAAQ,cAAcC,CAAO,EAAE;AAC7F;IACF;AACA,QAAMI,IAAkB,KAAK,QAAQ,IAAI,KAAK,CAAC;AAE7CA,MAAgBN,CAAI,IAAIG,GAI1B,KAAK,QAAQ,IAAIG,CAAe;EAClC;EAEA,eAAe;AACb,QAAK,KAAK;AAGV,aAAO,KAAK,QAAQ,IAAI;EAC1B;EAEA,UAAU;AACR,SAAK,WAAW,OAChB,KAAK,UAAU;EACjB;EAEQ,OAAOC,GAAqBH,GAAoB;AAEtD,WAAOG,EAAQ,aAAaH,EAAO,aAAaG,EAAQ,YAAYH,EAAO,WAAW,CAACG,EAAQ;EACjG;AACF;AAtDA,IAwDaC,IAAuB,IAAIZ;ACVjC,IAAKa,MAAAA,QACVA,EAAA,YAAY,aACZA,EAAA,UAAU,WAFAA,IAAAA,MAAA,CAAA,CAAA;AAAL,IAWKC,MAAAA,QACVA,EAAA,yBAAyB,0BACzBA,EAAA,uBAAuB,wBAFbA,IAAAA,MAAA,CAAA,CAAA;AQUL,SAASC,GAA0CC,IAAOC,IAAQ,KAAK;AAC5E,MAAIC;AACJ,SAAO,YAAaC,GAAU;AAC5B,iBAAaD,CAAK,GAClBA,IAAQ;AAGR,QAAME,IAAU;AAChBF,QAAQ,WAAW,MAAM;AACvBF,MAAAA,GAAG,MAAMI,GAASD,CAAI;IACxB,GAAGF,CAAK;EACV;AACF;AEtFO,IAAKI,MAAAA,QACVA,EAAA,MAAM,OACNA,EAAA,UAAU,WAFAA,IAAAA,MAAA,CAAA,CAAA;ACAL,IAAKC,MAAAA,QACVA,EAAA,OAAO,QACPA,EAAA,cAAc,eACdA,EAAA,UAAU,WACVA,EAAA,SAAS,UACTA,EAAA,UAAU,WACVA,EAAA,UAAU,WACVA,EAAA,SAAS,UAPCA,IAAAA,MAAA,CAAA,CAAA;AA4FL,IAAKC,MAAAA,QACVA,EAAA,MAAM,OACNA,EAAA,SAAS,UAFCA,IAAAA,MAAA,CAAA,CAAA;AAAL,IAKKC,MAAAA,QACVA,EAAA,UAAU,WACVA,EAAA,SAAS,UACTA,EAAA,YAAY,aAHFA,IAAAA,MAAA,CAAA,CAAA;AALL,IAwBKC,MAAAA,QACVA,EAAA,cAAc,eACdA,EAAA,UAAU,WACVA,EAAA,UAAU,WACVA,EAAA,SAAS,UAJCA,IAAAA,MAAA,CAAA,CAAA;AAxBL,IA8BKC,MAAAA,QACVA,EAAA,UAAU,WADAA,IAAAA,MAAA,CAAA,CAAA;AExGL,IAAKC,MAAAA,QACVA,EAAA,QAAQ,SACRA,EAAA,QAAQ,SAFEA,IAAAA,MAAA,CAAA,CAAA;ACXL,IAAKC,MAAAA,QACVA,EAAA,aAAa,cACbA,EAAA,aAAa,cACbA,EAAA,cAAc,eAHJA,IAAAA,MAAA,CAAA,CAAA;ASCL,IAAMC,KAAN,MAAqC;EAI1C,cAAc;AAFd,SAAiB,MAAM;AACvB,SAAQ,YAAY,oBAAI;AAaxB,SAAA,UAAU,CAACC,GAAsBC,MAAoD;AA3BvF,UAAAC;AA4BI,WAAK,eAAe,GAEpB,KAAK,UAAUF,CAAO,IACtBE,IAAA,KAAK,yBAAL,QAAAA,EAA2B,QAAQF,CAAAA,GACnC,KAAK,UAAU,IAAIA,GAASC,CAAc;IAC5C;AAEA,SAAA,YAAaD,OAAyB;AAnCxC,UAAAE;AAAAA,OAoCIA,IAAA,KAAK,yBAAL,QAAAA,EAA2B,UAAUF,CAAAA,GACrC,KAAK,UAAU,OAAOA,CAAO;IAC/B;AAEA,SAAQ,iBAAiB,MAAM;AACzB,WAAK,YAAY,KAAK,CAAC,KAAK,yBAC9B,KAAK,uBAAuB,IAAI,qBAAqB,KAAK,kBAAkB;IAEhF;AAEA,SAAQ,qBAAsBG,OAAyC;AA9CzE,UAAAD;AA+CI,eAAWE,KAASD;AAAAA,SAClBD,IAAA,KAAK,UAAU,IAAIE,EAAM,MAAqB,MAA9C,QAAAF,EAAkDE,CAAAA;IAEtD;AAlCE,SAAK,eAAe;EACtB;EAEA,cAAc;AACZ,QAAMC,IAAcC,KAAa,OAAO,OAAO,wBAAyB;AACxE,WAAKD,KACHE,EAAU,EAAE,KAAK,KAAK,sEAAsE,GAEvFF;EACT;AA0BF;AAxCO,IA0CMG,KAA0B,IAAIT;ACzCpC,IAAMU,KAAN,MAA+B;EAIpC,cAAc;AAFd,SAAiB,MAAM;AACvB,SAAQ,YAAY,oBAAI;AAaxB,SAAA,UAAU,CACRT,GACAU,GACAC,IAAiC,EAAE,KAAK,aAAa,MAClD;AAhCP,UAAAT;AAiCI,WAAK,eAAe,GAEpB,KAAK,UAAUF,CAAO,IACtBE,IAAA,KAAK,mBAAL,QAAAA,EAAqB,QAAQF,GAASW,CAAAA,GACtC,KAAK,UAAU,IAAIX,GAASU,CAAQ;IACtC;AAEA,SAAA,YAAaV,OAAyB;AAxCxC,UAAAE;AAAAA,OAyCIA,IAAA,KAAK,mBAAL,QAAAA,EAAqB,UAAUF,CAAAA,GAC/B,KAAK,UAAU,OAAOA,CAAO;IAC/B;AAEA,SAAQ,iBAAiB,MAAM;AACzB,WAAK,YAAY,KAAK,CAAC,KAAK,mBAC9B,KAAK,iBAAiB,IAAI,eAAeY,GAAS,KAAK,cAAc,GAAG,CAAC;IAE7E;AAEA,SAAQ,eAAgBT,OAAmC;AAnD7D,UAAAD;AAoDI,eAAWE,KAASD;AAAAA,SAClBD,IAAA,KAAK,UAAU,IAAIE,EAAM,MAAqB,MAA9C,QAAAF,EAAkDE,CAAAA;IAEtD;AAtCE,SAAK,eAAe;EACtB;EAEA,cAAc;AACZ,QAAMC,IAAcC,KAAa,OAAO,OAAO,kBAAmB;AAClE,WAAKD,KACHE,EAAU,EAAE,KAAK,KAAK,kCAAkC,GAEnDF;EACT;AA8BF;AA5CO,IA8CMQ,KAAoB,IAAIJ;ACa9B,IAAKK,MAAAA,QACVA,EAAA,YAAY,aACZA,EAAA,UAAU,WAFAA,IAAAA,MAAA,CAAA,CAAA;AAAL,IAKKC,MAAAA,QACVA,EAAA,IAAA,IAAO,MACPA,EAAA,QAAQ,SACRA,EAAA,SAAW,UAHDA,IAAAA,MAAA,CAAA,CAAA;AOlDL,IAAMC,KAAiC;AAAvC,IACMC,KAA+B;AASrC,IAAMC,KAAmB,KAAK,IAAI,GAAG,EAAE,IAAI;AQlClD,IAAqBC,KAArB,MAAkC;AAElC;AAFqBA,GACZ,aAAa,MAAMC,GAAO;A/DwB5B,IAAMC,IAAcC,CAAAA,OAA6BA,GAAM;AAAvD,IAKMC,KAAgBD,CAAAA,OAAoCA,GAAM;AALhE,IAUME,KAAoBC,eAAeF,IAAcG,CAAAA,OAAWA,GAAO,WAAW,IAAI,OAAOA,GAAO,GAAG,EAAE,CAAE;AAV7G,IAcMC,KAAeF,eAAeJ,GAAYO,CAAAA,OAAQA,GAAK,EAAE;AAd/D,IAmBMC,IAAkBP,CAAAA,OAAgDA,GAAM;AAnB9E,IAwBMQ,KAAqBR,CAAAA,OAAoBA,GAAM,SAAS;AAxB9D,IA6BMS,KAA2BT,CAAAA,OAAoBA,GAAM,SAAS;AA7BpE,IAkCMU,IAAmBV,CAAAA,OAAoBA,GAAM;AAlCnD,IA+CMW,KAAqBC,CAAAA,OAAoBA,GAAM;AA/CrD,IAiEMC,KAAkBC,CAAAA,OACtBA,GAAM;AAlER,IA6EMC,KAA0BC,eAAe,CAACC,CAAU,GAAGC,CAAAA,OAAQA,MAAQA,GAAK,WAAW;AA7E7F,IAqFMC,KAAkBH,eAAe,CAACD,IAAyBE,CAAU,GAAG,CAACG,IAAaF,MAC7FE,KAKKF,EAAK,cAAc,SAAYA,EAAK,aAAa,IAAIA,EAAK,MAAM,SAKhE,KAAK,IAAIA,EAAK,cAAc,SAAYA,EAAK,YAAYA,EAAK,MAAM,SAAS,GAAG,CAAC,CAE3F;AAlGM,IAyGDG,KAAuBC,CAAAA,OAA6BA,GAAM;AAzGzD,IA8GMC,KAAcP,eACzB,CAACC,GAAYO,GAAgBH,EAAmB,GAChD,CAACH,IAAMO,GAAYC,MACbA,IACKR,GAAK,MAAM,OAAOS,OAAUT,GAAK,cAAcS,CAAM,EAAE,IAAIA,OAAUF,EAAWE,CAAM,CAAC,IAEzFT,GAAK,MAAM,IAAIS,OAAUF,EAAWE,CAAM,CAAC,CAEtD;AAtHO,IA2HDC,KAAeZ,eAAea,GAAiBC,CAAAA,OAC5C,OAAO,OAAOA,EAAW,CACjC;AA7HM,IAkIMC,KAAkBf,eAAeC,GAAYO,GAAgB,CAACN,IAAMc,MACxEA,EAAMd,GAAK,SAAS,CAC5B;AApIM,IAyIMe,KAAoBjB,eAAeC,GAAYC,CAAAA,OACnDA,GAAK,SACb;AA3IM,IAgJMgB,KAAsBlB,eAAee,IAAiBI,CAAAA,OAAQA,MAAA,OAAA,SAAAA,GAAM,IAAI;AAhJ9E,IAqJMC,KAA0BpB,eAAee,IAAiBI,CAAAA,OAAQA,MAAA,OAAA,SAAAA,GAAM,QAAQ;AArJtF,IA0JME,KAA0BrB,eAAee,IAAiBI,CAAAA,OAAQA,MAAA,OAAA,SAAAA,GAAM,UAAU;AA1JxF,IA+JMG,IAA0BtB,eAAee,IAAiBI,CAAAA,OAAQA,MAAA,OAAA,SAAAA,GAAM,UAAU;AA/JxF,IAoKDI,KAA+BvB,eAAee,IAAiBI,CAAAA,OAAQA,MAAA,OAAA,SAAAA,GAAM,eAAe;AApK3F,IAyKMK,KAAsBxB,eACjC,CAACqB,IAAyBC,GAAyBC,EAA4B,GAC/E,CAACE,IAAcC,GAAcC,MAAsB;AACjD,MAAMC,IAAqBD,IAAoB,CAAC,GAAGA,CAAiB,IAAI,CAAC;AACzE,SAAAF,MAAgBG,EAAS,QAAQH,EAAY,GAC7CC,KAAgBE,EAAS,QAAQF,CAAY,GACtCE;AACT,CACF;AAjLO,IAsLMC,KAAoB7B,eAAeO,IAAaS,CAAAA,OACpDA,GAAM,OAAOc,OAAK,CAACA,EAAE,OAAO,CACpC;AAxLM,IA6LMC,KAAwB/B,eAAeQ,GAAgBwB,IAAgB,CAACC,IAAUC,MAAa;AAE1G,MAAMC,IAAkB,OAAO,QAAQD,CAAQ,EAAE,KAAK,CAACE,GAAIC,MAAO;AA1NpE,QAAAC,GAAAC;AA2NI,QAAMC,MAAUF,IAAAF,EAAG,CAAC,MAAJ,OAAA,SAAAE,EAAO,eAAc;AAErC,cADgBC,IAAAF,EAAG,CAAC,MAAJ,OAAA,SAAAE,EAAO,eAAc,KACpBC,IAAU,IAAI;EACjC,CAAC;AACD,MAAIL,EAAgB,SAAS,KAAKA,EAAgB,CAAC,EAAE,CAAC,EAAE,cAAcA,EAAgB,CAAC,EAAE,CAAC,EAAE,aAAa,GAAG;AAC1G,QAAMxB,IAASwB,EAAgB,CAAC,EAAE,CAAC,EAAE;AACrC,QAAIxB,KAAUsB;AACZ,aAAOA,GAAStB,CAAM;EAE1B;AACA,SAAO;AACT,CAAC;AA3MM,IA+OM8B,KAA4BC,eAAeC,IAAiBC,GAAiB,CAACC,IAAWC,MAAc;AAClH,MAAM,EAAE,OAAAC,GAAO,OAAAC,EAAM,IAAIC,GAAsBH,GAAWD,EAAS;AACnE,SAAO,CAAC,EAAEE,KAASC;AACrB,CAAC;AAlPM,IAuPME,KAA0BR,eAAeS,GAAgBP,GAAiB,CAACQ,IAAUN,MAAc;AAC9G,MAAIO;AACJ,WAAWC,KAAUF,IAAU;AAC7B,QAAMG,IAAOH,GAASE,CAAM,GACtB,EAAE,OAAAP,GAAO,OAAAC,EAAM,IAAIC,GAAsBH,GAAWS,CAAI;AAC9D,QAAIR;AACF,aAAOQ;AACEP,SAAS,CAACK,MACnBA,IAAkBE;EAEtB;AACA,SAAOF;AACT,CAAC;AAnQM,IAwQMG,KAA+Bd,eAAeQ,IAAyBK,CAAAA,OAC3E,CAAC,CAACA,EACV;AA1QM,IA+QME,KAAyBf,eAAeS,GAAgBP,GAAiB,CAACQ,IAAUN,MAAc;AAC7G,WAAWQ,KAAUF,IAAU;AAC7B,QAAMG,IAAOH,GAASE,CAAM,GACtB,EAAE,OAAAN,GAAO,OAAAD,EAAM,IAAIE,GAAsBH,GAAWS,CAAI;AAC9D,QAAI,CAACR,KAAWC;AACd,aAAOO;EAEX;AAEF,CAAC;AAxRM,IA6RMG,KAA2BhB,eAAeS,GAAgBP,GAAiB,CAACQ,IAAUN,MAAc;AAC/G,MAAMa,IAAa,CAAC,GACdC,IAAa,CAAC;AACpB,WAAWN,KAAUF,IAAU;AAC7B,QAAMG,IAAOH,GAASE,CAAM,GACtB,EAAE,OAAAP,GAAO,OAAAC,EAAM,IAAIC,GAAsBH,GAAWS,CAAI;AAC1DR,QACFY,EAAW,KAAKJ,CAAI,IACXP,KACTY,EAAW,KAAKL,CAAI;EAExB;AACA,SAAOI,EAAW,OAAOC,CAAU;AACrC,CAAC;AA1SM,IA4SMC,KAAiCnB,eAAeS,GAAgBP,GAAiB,CAACQ,IAAUN,MAAc;AACrH,WAAWgB,KAAWhB,GAAW;AAC/B,QAAMiB,IAAQjB,EAAUgB,CAAO;AAC/B,QAAIE,GAAgBD,CAAK,KAAKE,GAAQF,CAAK,KAAKA,EAAM;AACpD,aAAOX,GAASW,EAAM,MAAM;EAEhC;AAEF,CAAC;AApTM,IAsTMG,KAAiCxB,eAAeS,GAAgBP,GAAiB,CAACQ,IAAUN,MAAc;AACrH,WAAWgB,KAAWhB,GAAW;AAC/B,QAAMiB,IAAQjB,EAAUgB,CAAO;AAC/B,QAAIK,GAAgBJ,CAAK,KAAKA,EAAM;AAClC,aAAOX,GAASW,EAAM,MAAM;EAEhC;AAEF,CAAC;AA9TM,IAmUMK,KAAuB1B,eAAe2B,IAAcC,CAAAA,OAC9DA,GAA2B,OAAOC,EAAU,CAC/C;AArUO,IA0UMC,KAAyB9B,eAAe+B,IAAyBC,CAAAA,OAAcA,GAAW,MAAM;AA1UtG,IA+UMC,KAA+BjC,eAAekC,IAAmBC,CAAAA,OACrE,OAAO,OAAOA,EAAQ,EAAE,OAAOC,OAAK,CAACA,EAAE,IAAI,EAAE,MACrD;AAjVM,IAsVMC,KAAoBrC,eAAe+B,IAAyBG,IAAmB,CAACI,IAAQC,MAAW;AAC9G,MAAMJ,IAAyB,CAAC;AAChC,SAAAG,GAAO,QAAQE,OAAS;AACtBL,MAAS,KAAKI,EAAOC,CAAK,CAAC;EAC7B,CAAC,GACML;AACT,CAAC;AA5VM,IA8VMM,KAA6BzC,eAAeqC,IAAmBF,CAAAA,OACnEA,GAAS,OAAOC,OAAE;AA1X3B,MAAAM;AA0X8B,SAAA,CAACN,EAAE,iBAAiB,EAAEA,EAAE,oBAAkBM,IAAAN,EAAE,mBAAF,OAAA,SAAAM,EAAkB,UAAS;AAAA,CAAE,CACpG;AAhWM,IAoWMC,KAAwC3C,eAAeyC,IAA4BN,CAAAA,OACvFA,GAAS,OAAOC,OAAK,CAACA,EAAE,IAAI,EAAE,MACtC;AAtWM,IA0WMQ,KAAkB5C,eAAe,CAAC6C,CAAU,GAAGC,CAAAA,OAAQA,MAAQA,GAAK,SAAS;AA1WnF,IA+WMC,KAAoB/C,eAAe4C,IAAiBI,CAAAA,OAAaA,OAAAA,SAAkC;AA/WzG,IAiXMC,KAAoBjD,eAAe6C,GAAYC,CAAAA,OAAQA,GAAK,cAAA,cAAuC;AAjXzG,IAmXMI,KAA+BlD,eAAe6C,GAAYC,CAAAA,OACjE,CAACA,GAAK,kBAAkBA,GAAK,eAAe,UAAU,IACjD,QAEFA,GAAK,eAAe,KACzBK,OACEA,EAAc,SAAA,aAAyCA,EAAc,UAAA,SACzE,CACD;AA3XM,IAgYMC,KAAkBC,CAAAA,OACtBA,GAAM;AAjYR,IAuYMC,KAA2BtD,eAAe,CAACoD,EAAc,GAAGG,CAAAA,OAAY,OAAO,KAAKA,EAAQ,CAAC;AAvYnG,IA4YMC,KAAsBxD,eAAe,CAACC,IAAiBmD,EAAc,GAAG,CAACjD,IAAWoD,MAC/FpD,MAAA,QAAAA,GAAW,WAAWoD,EAASpD,GAAU,QAAQ,IAAI,IACvD;AA9YO,IAgZMsD,KAAyBJ,CAAAA,OAAiB;AA3avD,MAAAX;AA2a0D,UAAAA,IAAAW,GAAM,YAAN,OAAA,SAAAX,EAAe;AAAA;AAhZlE,IAsZMgB,KAAoB1D,eAAe,CAACyD,IAAuBL,EAAc,GAAG,CAACO,IAAUJ,MAClGI,KAAWJ,EAASI,EAAQ,IAAI,IAClC;AAxZO,IA6ZMC,KAA6B5D,eAAe,CAACwD,EAAmB,GAAIK,CAAAA,OAAkB;AAxbnG,MAAAnB;AAybE,UAAKA,IAAAmB,MAAA,OAAA,SAAAA,GAAM,oBAAN,QAAAnB,EAAuB,mBAGrBmB,GAAK,gBAAgB,iBAAiB,SAAS,IAF7C;AAGX,CAAC;AAlaM,IAuaMC,KAAoB9D,eAAewD,IAAqBK,CAAAA,OAAQA,MAAA,OAAA,SAAAA,GAAM,WAAW;AAvavF,IAwaME,KAAuB/D,eAAe6C,GAAYC,CAAAA,OAAQA,GAAK,SAAS;AAxa9E,IAyaMkB,KAAkBhE,eAAe6C,GAAYC,CAAAA,OAAQA,GAAK,IAAI;AAzapE,IA0aMmB,KAAiBjE,eAAe6C,GAAYC,CAAAA,OAAQA,GAAK,GAAG;AA1alE,IA2aMoB,KAA4BlE,eAAe6C,GAAYC,CAAAA,OAAQA,GAAK,cAAc;AA3axF,IA4aMqB,KAAkBnE,eAAe6C,GAAYC,CAAAA,OAAQA,GAAK,SAAS;AA5azE,IA6aMsB,KAAsBpE,eAAe6C,GAAYC,CAAAA,OAAQA,GAAK,SAAS;AA7a7E,IA8aMuB,KAAoBrE,eAAe6C,GAAYC,CAAAA,OAAQ,CAAC,CAACA,GAAK,WAAW;AA9a/E,IA+aMwB,KAAyBtE,eAAe6C,GAAYC,CAAAA,OAAQ,CAAC,CAACA,GAAK,gBAAgB;AA/azF,IAgbMyB,KAAoBvE,eAAe6C,GAAYC,CAAAA,OAAQ,CAAC,CAACA,GAAK,WAAW;AAhb/E,IAibM0B,KAAmBxE,eAAe6C,GAAYC,CAAAA,OAAQA,GAAK,UAAU;AAjb3E,IAsbM2B,KAAkBC,CAAAA,OAAoBA,GAAM;AAtblD,IA2bMC,KAAwBC,eAAeC,IAAaC,CAAAA,OACxDA,GAAM,OAAOC,OAAQA,EAAK,YAAY,CAC9C;AA7bM,IAgcMC,KAAqBC,CAAAA,OAAoBA,GAAM;AAhcrD,IAkcMC,KAAmBN,eAC9BI,IACAG,CAAAA,OAAe,OAAO,OAAOA,EAAW,EAAE,CAAC,CAC7C;AyE1dA,IAAMC,KACJ,CAACC,KAAAA,YACAJ,OACCA,EAAM,SAASI,EAAI,EAAE;AAHzB,IAKMC,KACJ,CAACD,KAAAA,YACAJ,OACCA,EAAM,SAASI,EAAI,EAAE;AARzB,IAUME,KACJ,CAACF,KAAAA,YACAJ,OACCA,EAAM,SAASI,EAAI,EAAE;AAbzB,IAeMG,KACJ,CAACH,KAAAA,YACAJ,OACCA,EAAM,SAASI,EAAI,EAAE;AAlBzB,IAoBMI,KACJ,CAACJ,KAAAA,YACAJ,OACCA,EAAM,SAASI,EAAI,EAAE;AAvBzB,IAyBMK,KACJ,CAACL,KAAAA,YACAJ,OACCA,EAAM,SAASI,EAAI,EAAE;AA5BzB,IAiCMM,KAAiB,CAACN,KAAAA,YACtBT,eAAeQ,GAAkBC,EAAI,GAAGO,OAC/B,OAAO,OAAOA,CAAa,CACnC;AApCH,IAsCMC,KAA6B,CAACR,KAAAA,YAClCT,eAAeQ,GAAkBC,EAAI,GAAGC,GAAwBD,EAAI,GAAG,CAACO,GAAeE,MAAqB;AAC1G,MAAKA,EAAiB;AAGtB,WAAOF,EAAcE,EAAiB,EAAE;AAC1C,CAAC;AA5CH,IA8CaC,KAA2C,EACtD,WAAWT,GAAAA,OAA6C,GACxD,UAAUC,GAAAA,OAA4C,GACtD,aAAaC,GAAAA,OAA+C,GAC5D,cAAcC,GAAAA,OAAgD,GAC9D,QAAQC,GAAAA,OAA0C,GAClD,MAAMC,GAAAA,OAAoC,GAC1C,cAAcE,GAAAA,OAAgD,EAChE;AAtDA,IAwDaG,KAA2C,EACtD,WAAWV,GAAAA,OAA6C,GACxD,UAAUC,GAAAA,OAA4C,GACtD,aAAaC,GAAAA,OAA+C,GAC5D,cAAcC,GAAAA,OAAgD,GAC9D,QAAQC,GAAAA,OAA0C,GAClD,MAAMC,GAAAA,OAAoC,GAC1C,cAAcE,GAAAA,OAAgD,EAChE;AEpDO,SAASI,EAAmCC,IAAoE;AACrH,SAAQC,OACElB,OAAaiB,GAASjB,GAAOkB,CAAE;AAE3C;ACpBA,IAAMC,KAAgB;AAAtB,IAEaC,IAAN,MAAgB;EAGrB,OAAO,EAAEC,MAAgBC,GAAa;AACpC,SAAK,IAAA,GAAyBD,GAAK,GAAGC,CAAI;EAC5C;EAEA,OAAO,KAAKA,GAAa;AACvB,SAAK,IAAA,GAAuB,GAAGA,CAAI;EACrC;EAEA,OAAO,KAAKA,GAAa;AACvB,SAAK,IAAA,GAAsB,GAAGA,CAAI;EACpC;EAEA,OAAO,KAAKA,GAAa;AACvB,SAAK,IAAA,GAAsB,GAAGA,CAAI;EACpC;EAEA,OAAO,KAAKA,GAAa;AACvB,SAAK,IAAA,GAAuB,GAAGA,CAAI;EACrC;EAEA,OAAO,KAAKC,GAAc;AACxB,SAAK,IAAA,GAAsB,0BAA0BA,CAAI;EAC3D;EAEA,OAAO,QAAQA,GAAc;AAC3B,SAAK,IAAA,GAAyB,0BAA0BA,GAAMA,CAAI;EACpE;EAEA,OAAO,UAAU;AACf,gBAAY,WAAW,GACvB,YAAY,cAAc;EAC5B;EAGA,OAAe,IAAIC,MAAuBF,GAAa;AACrD,QAAI,EAAA,KAAK,MAAM,QAAQ,IAAIE,EAAM,QAAQ;AAIzC,cAAQA,GAAO;QACb,KAAA,GAA0B;AACxB,kBAAQ,IAAIL,IAAe,GAAGG,CAAI;AAClC;QACF;QACA,KAAA,GAAwB;AACtB,kBAAQ,MAAMH,IAAe,GAAGG,CAAI;AACpC;QACF;QACA,KAAA,GAAuB;AACrB,kBAAQ,KAAKH,IAAe,GAAGG,CAAI;AACnC;QACF;QACA,KAAA,GAAuB;AACrB,kBAAQ,KAAKH,IAAe,GAAGG,CAAI;AACnC;QACF;QACA,KAAA,GAAwB;AACtB,kBAAQ,MAAMH,IAAe,GAAGG,CAAI;AACpC;QACF;QACA,KAAA,GAAuB;AACrB,sBAAY,KAAKA,EAAK,CAAC,CAAC;AACxB;QACF;QACA,KAAA,GAA0B;AACxB,cAAMD,IAAMC,EAAK,CAAC,GACZC,IAAOD,EAAK,CAAC;AACnB,cAAI;AACF,gBAAMG,IAAQ,YAAY,QAAQF,GAAMA,CAAI;AAE5C,iBAAK,IAAA,GAAuBF,GAAKE,GAAME,KAAA,OAAA,SAAAA,EAAO,QAAQ,GACtD,YAAY,WAAWF,CAAI,GAC3B,YAAY,cAAcA,CAAI;UAChC,SAASG,GAAO;AACd,iBAAK,IAAA,GAAuBL,GAAKE,GAAMG,CAAK;UAC9C;AACA;QACF;MACF;EACF;AACF;AAnFaN,EACJ,QAAqB;AF+B9B,IAAMO,KAAe,CAACC,IAAkBC,MAAkCA;AAA1E,IACMC,KAAgB,CAACF,IAAkBG,MAAoCA;AAD7E,IAEMC,KAAiB,CAACJ,IAAkBK,MAAsCA;AAFhF,IAGMC,KAAmB,CAACN,IAAkBO,MAA4BA;AAHxE,IAIMC,KAAe,CAACR,IAAkBS,MAA+BA;AAJvE,IAMMC,IAAqB3C,eAAe,CAAC4C,GAAgBZ,EAAY,GAAG,CAACa,IAAYX,MACrFA,IAASW,GAAWX,CAAM,IAAI,IAChC;AARA,IAUMY,KAAsB9C,eAAe,CAAC+C,GAAiBZ,EAAa,GAAG,CAACa,IAAaZ,MACzFA,IAAUY,GAAYZ,CAAO,IAAI,IACnC;AAZA,IAcMa,KAA2BjD,eAAe,CAAC+C,GAAiBZ,EAAa,GAAG,CAACa,IAAaZ,MAAY;AAC1G,MAAI,CAACA;AACH,WAAO;AAET,MAAMc,IAAQF,GAAYZ,CAAO;AACjC,UAAIc,KAAA,OAAA,SAAAA,EAAO,UAAS,UACXA,IAEF;AACT,CAAC;AAvBD,IAyBMC,KAA2BnD,eAAe,CAAC+C,GAAiBZ,EAAa,GAAG,CAACa,IAAaZ,MAAY;AAC1G,MAAI,CAACA;AACH,WAAO;AAET,MAAMc,IAAQF,GAAYZ,CAAO;AACjC,UAAIc,KAAA,OAAA,SAAAA,EAAO,UAAS,UACXA,IAEF;AACT,CAAC;AAlCD,IAoCME,KAAiCpD,eAAe,CAAC+C,GAAiBZ,EAAa,GAAG,CAACa,IAAaZ,MAAY;AAChH,MAAI,CAACA;AACH,WAAO;AAET,MAAMc,IAAQF,GAAYZ,CAAO;AACjC,UAAIc,KAAA,OAAA,SAAAA,EAAO,UAAS,YAAWA,KAAA,OAAA,SAAAA,EAAO,YAAW,WACxCA,IAEF;AACT,CAAC;AA7CD,IA8CMG,KAAiCrD,eAAe,CAAC+C,GAAiBZ,EAAa,GAAG,CAACa,IAAaZ,MAAY;AAChH,MAAI,CAACA;AACH,WAAO;AAET,MAAMc,IAAQF,GAAYZ,CAAO;AACjC,UAAIc,KAAA,OAAA,SAAAA,EAAO,UAAS,YAAWA,KAAA,OAAA,SAAAA,EAAO,YAAW,WACxCA,IAEF;AACT,CAAC;AAvDD,IAyDMI,KAAqBtD,eAAe,CAACuD,IAAgBd,EAAY,GAAG,CAACe,IAAYd,MACrFA,IAASc,GAAWd,CAAM,IAAI,IAChC;AA3DA,IAgEae,IAAiBpC,EAAUsB,CAAkB;AAhE1D,IAsEae,KAAgBrC,EAC3BrB,eAAe,CAAC2D,IAAmBpB,EAAgB,GAAG,CAACqB,IAASpB,MAAQ;AACtE,MAAKoB;AAGL,WAAIpB,IACKoB,GAAQpB,CAAG,IAEboB;AACT,CAAC,CACH;AAaO,SAASC,GAGdrB,IAAS;AACT,SAAQnC,OAAuB;AAC7B,QAAKA,EAAM;AAGX,aAAImC,KACKnC,EAAM,aAAamC,EAAG,IAExBnC,EAAM;EACf;AACF;AAEO,IAqBMyD,KAAqBC,EAAUC,eAAeC,GAAoBC,CAAAA,OAAQA,MAAA,OAAA,SAAAA,GAAM,IAAI,CAAC;AArB3F,IAuBMC,KAAqBJ,EAAUC,eAAeC,GAAoBC,CAAAA,OAAQA,MAAA,OAAA,SAAAA,GAAM,IAAI,CAAC;AAvB3F,IA4BME,KAAkBL,EAAUM,EAAmB;AA5BrD,IAiCMC,KAAuBP,EAAUQ,EAAwB;AAjC/D,IAsCMC,KAAuBT,EAAUU,EAAwB;AAtC/D,IA2CMC,KAA6BX,EAAUY,EAA8B;AA3C3E,IAgDMC,KAA6Bb,EAAUc,EAA8B;AAhD3E,IAqDMC,KAA2Bf,EAAU,CAACgB,IAAiBC,MAAkD;AACpH,MAAMd,IAAOD,EAAmBc,IAAOC,CAAM;AAC7C,MAAId,KAAQA,EAAK,cAAcA,EAAK,eAAe;AACjD,WAAOa,GAAM,OAAOb,EAAK,UAAU;AAGvC,CAAC;AA3DM,IAgEMe,KAA2BlB,EAAU,CAACgB,IAAiBC,MAAkD;AACpH,MAAMd,IAAOD,EAAmBc,IAAOC,CAAM;AAC7C,MAAId,KAAQA,EAAK,cAAcA,EAAK,eAAe;AACjD,WAAOa,GAAM,OAAOb,EAAK,UAAU;AAGvC,CAAC;AAtEM,IAiFMgB,KAAgCC,EAAU,CAACC,IAAiBC,MAAmC;AAC1G,MAAMC,IAAOC,EAAmBH,IAAOC,CAAM;AAC7C,UAAOC,KAAA,OAAA,SAAAA,EAAM,gBAAgB,IAAIE,OAAWJ,GAAM,OAAOI,CAAO,CAAA,MAAM,CAAC;AACzE,CAAC;AApFM,IAsFDC,KAAyB,CAACL,IAAiBI,MACxCA,IAAUJ,GAAM,SAASI,CAAO,IAAI;AAvFtC,IA6FME,KAAuBP,EAClCQ,eAAeF,IAAwBG,CAAAA,QAAWA,MAAA,OAAA,SAAAA,GAAS,eAAc,CAAC,CAC5E;AA/FO,IAoGDC,KAAwB,CAACT,IAAiBC,MAAkC;AAChF,MAAMS,IAAiBC,GAAyBV,CAAM,EAAED,EAAK;AAC7D,SAAOK,GAAuBL,IAAOU,KAAA,OAAA,SAAAA,EAAgB,EAAE;AACzD;AAvGO,IA4GME,KAAsBb,EACjCQ,eAAeE,IAAuBD,CAAAA,QAAWA,MAAA,OAAA,SAAAA,GAAS,eAAc,CAAC,CAC3E;AA9GO,IAgHMK,KAAkCd,EAAU,CAACC,IAAiBC,MAAkC;AAC3G,MAAIA;AACF,WAAOD,GAAM,oBAAoBC,CAAM;AAG3C,CAAC;AArHM,IA0HMa,KAA+Bf,EAAU,CAACC,IAAiBC,MAAuB;AAC7F,MAAMC,IAAOC,EAAmBH,IAAOC,CAAM;AAC7C,MAAIC,GAAM;AACR,QAAME,IAAUF,KAAA,OAAA,SAAAA,EAAM,gBAAgB,KAAKE,OAAWW,GAAQf,GAAM,OAAOI,CAAO,CAAC,CAAA;AACnF,WAAOA,IAAWJ,GAAM,OAAOI,CAAO,IAAsB;EAC9D;AAEF,CAAC;AAjIM,IAmIMY,KAAwCjB,EACnDQ,eAAeU,GAAiBd,GAAoB,CAACe,IAAQhB,MAAS;AACpE,MAAME,IAAUF,KAAA,OAAA,SAAAA,EAAM,gBAAgB,KAAKE,OAAW;AACpD,QAAMe,IAAQD,GAAOd,CAAO;AAC5B,WAAOgB,GAAgBD,CAAK,KAAKE,GAAQF,CAAK;EAChD,CAAA;AACA,SAAOf,IAAWc,GAAOd,CAAO,IAAsB;AACxD,CAAC,CACH;AA3IO,IA6IMkB,KAAwCvB,EACnDQ,eAAeU,GAAiBd,GAAoB,CAACe,IAAQhB,MAAS;AACpE,MAAME,IAAUF,KAAA,OAAA,SAAAA,EAAM,gBAAgB,KAAKE,OAAW;AACpD,QAAMe,IAAQD,GAAOd,CAAO;AAC5B,WAAOgB,GAAgBD,CAAK,KAAKJ,GAAQI,CAAK;EAChD,CAAA;AACA,SAAOf,IAAWc,GAAOd,CAAO,IAAsB;AACxD,CAAC,CACH;AArJO,IAuJMmB,KAAmCxB,EAC9CQ,eAAeU,GAAiBd,GAAoB,CAACe,IAAQhB,MAAS;AACpE,MAAME,IAAUF,KAAA,OAAA,SAAAA,EAAM,gBAAgB,KAAKE,OAAW;AACpD,QAAMe,IAAQD,GAAOd,CAAO;AAC5B,WAAOoB,GAAgBL,CAAK,KAAKJ,GAAQI,CAAK;EAChD,CAAA;AACA,SAAOf,IAAWc,GAAOd,CAAO,IAAsB;AACxD,CAAC,CACH;AA/JO,IAiKMqB,KAA6B1B,EACxCQ,eAAeU,GAAiBd,GAAoB,CAACe,IAAQhB,MACpDwB,GAAsBR,IAAQhB,CAAI,CAC1C,CACH;AArKO,IAkLMyB,KAAkCC,CAAAA,OAC7CC,eAAeC,GAA2BF,EAAE,GAAGG,OACtCA,EAAY,KACpB;AArLI,IA0LMC,KAA2BC,EAAU,CAACC,IAAiBC,MAAoB;AACtF,MAAMC,IAAOC,EAAmBH,IAAOC,CAAM;AAC7C,SAAOG,GAAeJ,IAAOE,KAAA,OAAA,SAAAA,EAAM,UAAU;AAC/C,CAAC;AA7LM,IAkMMG,KAA2BN,EAAU,CAACC,IAAiBC,MAAoB;AACtF,MAAMC,IAAOC,EAAmBH,IAAOC,CAAM;AAC7C,SAAOG,GAAeJ,IAAOE,KAAA,OAAA,SAAAA,EAAM,UAAU;AAC/C,CAAC;AArMM,IA0MMI,KAA4BP,EAAU,CAACC,IAAiBO,MAAqB;AACxF,MAAIA,KAAWP,GAAM,OAAOO,CAAO;AACjC,WAAQP,GAAM,OAAOO,CAAO,EAAoB,WAAW;AAG/D,CAAC;AA/MM,IAoNMC,KAA+BT,EAAU,CAACC,IAAiBC,MAAoB;AAC1F,MAAMC,IAAOC,EAAmBH,IAAOC,CAAM;AAC7C,SAAOK,GAA0BJ,KAAA,OAAA,SAAAA,EAAM,UAAU,EAAEF,EAAK;AAC1D,CAAC;AAvNM,IA4NMS,KAA0CV,EAAU,CAACC,IAAiBC,MAAoB;AACrG,MAAMS,IAAQjB,GAA+BQ,CAAM,EAAED,EAAK;AAC1D,SAAOM,GAA0BI,KAAA,OAAA,SAAAA,EAAO,EAAE,EAAEV,EAAK;AACnD,CAAC;AA/NM,IAwOMW,KAAyBZ,EAAU,CAACC,IAAiBO,MAAqB;AACrF,MAAMG,IAAQE,GAAoBZ,IAAOO,CAAO;AAChD,MAAIG,GAAO;AACT,QAAIA,EAAM,SAAS,SAAS;AAC1BG,QAAU,EAAE,8BAA8B;AAC1C;IACF;AACA,WAAOH,EAAM;EACf;AAEF,CAAC;AAlPM,IAuPMI,KAA4Bf,EAAU,CAACC,IAAiBC,MAAoB;AACvF,MAAMC,IAAOC,EAAmBH,IAAOC,CAAM;AAC7C,SAAOU,GAAuBT,KAAA,OAAA,SAAAA,EAAM,UAAU,EAAEF,EAAK;AACvD,CAAC;AA1PM,IA+PMe,KAAuChB,EAAU,CAACC,IAAiBC,MAAoB;AAClG,MAAMS,IAAQjB,GAA+BQ,CAAM,EAAED,EAAK;AAC1D,SAAOW,GAAuBD,KAAA,OAAA,SAAAA,EAAO,EAAE,EAAEV,EAAK;AAChD,CAAC;AAlQM,IAuQMgB,KAA8BjB,EAAU,CAACC,IAAiBO,MAAqB;AAC1F,MAAMG,IAAQE,GAAoBZ,IAAOO,CAAO;AAChD,MAAIG,GAAO;AACT,QAAIA,EAAM,SAAS,SAAS;AAC1BG,QAAU,EAAE,8BAA8B;AAC1C;IACF;AACA,WAAOH,EAAM;EACf;AAEF,CAAC;AAjRM,IAmRDO,KAAiCtB,eACrC,CAACuB,IAAmBC,IAAmBC,EAAY,GACnD,CAACC,IAAUC,GAAarB,MAAW;AACjC,MAAKA;AAGL,WAAOoB,GAAS,OAAOE,OAAW;AAzatC,UAAAC;AA+aM,aAJI,CAACD,EAAQ,iBAAiB,GAACC,IAAAD,EAAQ,mBAAR,QAAAC,EAAwB,WAInDD,EAAQ,UAAU,CAAC,CAACD,GAAarB,CAAM,EAAE,SAASsB,EAAQ,MAAM,IAC3D,QAGF,CAACD,GAAarB,CAAM,EAAE,SAASsB,EAAQ,aAAc;IAC9D,CAAC;AACH,CACF;AAtSO,IAwSDE,KAA+B9B,eAAe,CAACuB,IAAmBQ,EAAc,GAAG,CAACL,IAAUM,MAAa;AAC/G,MAAKA;AAGL,WAAON,GAAS,OAAOE,OAAW;AA5bpC,UAAAC,GAAAI;AA8bI,cAAKJ,IAAAD,EAAQ,mBAAR,QAAAC,EAAwB,UAGtBI,IAAAL,EAAQ,mBAAR,OAAA,SAAAK,EAAwB,SAASD,CAAAA,IAF/B;IAGX,CAAC;AACH,CAAC;AAnTM,IAqTME,KAA0BlC,eAAeuB,IAAmBG,CAAAA,OAChEA,GAAS,OAAOE,OAAW;AAtcpC,MAAAC;AAucI,SAAO,CAACD,EAAQ,iBAAiB,GAACC,IAAAD,EAAQ,mBAAR,QAAAC,EAAwB;AAC5D,CAAC,CACF;AAzTM,IA2TDM,KAAiCnC,eAAe,CAAC8B,IAA8BC,EAAc,GAAGL,CAAAA,OAC/FA,KAGEA,GAAS,OAAOU,OAAK,CAACA,EAAE,IAAI,EAAE,SAF5B,CAGV;AAhUM,IAkUDC,KAAmCrC,eAAe,CAACsB,IAAgCG,EAAY,GAAGC,CAAAA,OACjGA,KAGEA,GAAS,OAAOU,OAAK,CAACA,EAAE,IAAI,EAAE,SAF5B,CAGV;AAvUM,IAyUME,KAAqCtC,eAAekC,IAAyBR,CAAAA,OACjFA,GAAS,OAAOU,OAAK,CAACA,EAAE,IAAI,EAAE,MACtC;AA3UM,IA6UMG,KAAyBnC,EAAUkB,EAA8B;AA7UvE,IA+UMkB,KAAuBpC,EAAU0B,EAA4B;AA/UnE,IAiVMW,KAAkCrC,EAAU+B,EAA8B;AAjVhF,IAkVMO,KAAoCtC,EAAUiC,EAAgC;AAlVpF,IA+XMM,KAAiBC,EAAUC,EAAkB;AG1fnD,IAAMC,KAA6BC,eAAe,CAACC,GAAgBC,CAAe,GAAG,CAACC,IAAUC,MACvD,OAAO,OAAOD,EAAQ,EAAE,IAAIE,OAAQ;AAtBpF,MAAAC;AAuBI,SAAO,EACL,MAAMD,GACN,gBAAgBA,EAAK,cAAaC,IAAAF,EAAUC,EAAK,UAAU,MAAzB,OAAA,SAAAC,EAA4B,UAAU,MAC1E;AACF,CAAC,CAEF;AARM,IAUDC,KAAgCC,CAAAA,OAC7BA,GAAM,mBAAmB,CAAC,KAAK;AAXjC,IAiBMC,KAA0BT,eACrC,CAACO,IAA8BN,GAAgBS,EAAc,GAC7D,CAACC,IAASR,GAAUS,MACbD,KAGE,EACL,aAAaA,GAAQ,cAAcR,EAASQ,GAAQ,WAAW,IAAI,QACnE,MAAMC,EAASD,GAAQ,QAAQ,GAC/B,OAAOA,GAAQ,MACjB,IANS,IAQb;AA7BO,IAkCME,KAA2Bb,eAAe,CAACc,EAAmB,GAAGC,CAAAA,OAAQC,GAAuBD,EAAI,CAAC;AAlC3G,IAuCME,KAAgCjB,eAAe,CAACkB,EAAiB,GAAGH,CAAAA,OAAQC,GAAuBD,EAAI,CAAC;AChD9G,IAODI,KAA0BC,eAAe,CAACC,GAAyBC,CAAe,GAAG,CAACC,IAASC,MAAc;AACjH,MAAIC,IAAyB;AAC7B,SAAIF,OACFE,IAAQD,EAAUD,EAAO,KAEpBE,KAAA,OAAA,SAAAA,EAAO,YAAW,CAAC;AAC5B,CAAC;AAbM,IAeDC,KAA0BN,eAAe,CAACO,IAAyBL,CAAe,GAAG,CAACC,IAASC,MAAc;AACjH,MAAIC,IAAyB;AAC7B,SAAIF,OACFE,IAAQD,EAAUD,EAAO,KAEpBE,KAAA,OAAA,SAAAA,EAAO,YAAW,CAAC;AAC5B,CAAC;Ac9BM,IAAKG,MAAAA,QACVA,EAAAA,EAAA,WAAA,CAAA,IAAA,YACAA,EAAAA,EAAA,eAAA,CAAA,IAAA,gBACAA,EAAAA,EAAA,mBAAA,CAAA,IAAA,oBACAA,EAAAA,EAAA,kBAAA,CAAA,IAAA,mBACAA,EAAAA,EAAA,iBAAA,CAAA,IAAA,kBACAA,EAAAA,EAAA,kBAAA,CAAA,IAAA,mBACAA,EAAAA,EAAA,YAAA,CAAA,IAAA,aAPUA,IAAAA,MAAA,CAAA,CAAA;ASgCZ,IAAMC,KAAN,MAAsE;EAAtE,cAAA;AACE,SAAS,MAAM;AACf,SAAQ,eAAe,IAAIC,GAA+B,eAAe;AACzE,SAAA,cAAc;AACd,SAAQ,MAAkB;AAC1B,SAAQ,eAAe;EAAA;EAEvB,OAAOC,GAAU;AACf,SAAK,MAAMA,GACX,KAAK,kBAAkB;EACzB;EAEA,qBAAqBC,GAAY;AAC/B,SAAK,eAAeA;EACtB;EAEA,UAAUC,GAAuB;AAC/B,QAAI,CAAC,KAAK,KAAK;AACb,WAAK,kBAAkBA,CAAK;AAC5B;IACF;AACA,QAAMC,IAA+B,EACnC,OAAOD,EAAM,MACb,SAASA,EAAM,YACf,UAAU,OAAOA,EAAM,SAAS,GAChC,MAAMA,EAAM,SAAS,MACrB,WAAWA,EAAM,WACjB,WAAWA,EAAM,WACjB,SAAS,EACP,eAAe,KAAK,aACtB,EACF,GACME,IAAM,KAAK,QAAA,SAAmBC,KAAiCC;AACrE,UAAMF,GAAK,EACT,QAAQ,QACR,SAAS,EACP,gBAAgB,oBAChB,eAAe,UAAUF,EAAM,SAAS,KAAK,IAC7C,eAAeA,EAAM,SAAS,UAChC,GACA,MAAM,KAAK,UAAUC,CAAW,EAClC,CAAC,EACE,KAAKI,OAAY;AAEhB,UAAIA,EAAS,WAAW,KAAK;AAC3B,aAAK,kBAAkBL,CAAK;AAC5B;MACF;AACA,UAAIK,EAAS,WAAW;AACtB,cAAM,MAAMA,EAAS,UAAU;AAEjC,WAAK,kBAAkBL,CAAK;IAC9B,CAAC,EACA,MAAMM,OAAS;AACdC,QAAU,EAAE,KAAK,KAAK,wBAAwBD,GAAON,CAAK,GAC1D,KAAK,kBAAkBA,CAAK;IAC9B,CAAC;EACL;EACA,oBAAoB;AAClB,QAAMQ,IAAS,KAAK,aAAa,IAAI;AACrCA,SAAA,QAAAA,EAAQ,QAAQR,OAAS,KAAK,UAAUA,CAAK,CAAA;EAC/C;EAEQ,kBAAkBA,GAA6B;AACrD,QAAMS,IAAiB,KAAK,aAAa,IAAI,KAAK,CAAC;AAC9CA,MAAe,KAAKC,OAAiBA,EAAc,cAAcV,EAAM,SAAS,MAC/ES,EAAe,WAAW,OAC5BA,EAAe,MAAM,GAEvBA,EAAe,KAAKT,CAAK,GACzB,KAAK,aAAa,IAAIS,CAAc;EAExC;EAEQ,kBAAkBT,GAA6B;AACrD,QAAMQ,IAAS,KAAK,aAAa,IAAI,KAAK,CAAC,GACrCG,IAAQH,EAAO,UAAUI,OAAgBA,EAAa,cAAcZ,EAAM,SAAS;AACrFW,QAAQ,OACVH,EAAO,OAAOG,GAAO,CAAC,GACtB,KAAK,aAAa,IAAIH,CAAM;EAEhC;AACF;AAlFA,IAoFaK,KAAyB,IAAIjB;ASjHnC,IAAMkB,KAAN,MAAsB;EAE3B,OAAe,YAAYC,GAAoB;AAC7C,QAAIA,EAAS,WAAW;AACtB,YAAMC,EAAa,UAAU,oBAAA,YAAwCD,EAAS,UAAU;AAE1F,QAAIA,EAAS,UAAU;AACrB,YAAMC,EAAa,UAAU,aAAaD,EAAS,QAAA,YAA4BA,KAAA,OAAA,SAAAA,EAAU,UAAU;EAGvG;EAEA,OAAa,aAAaE,GAUR;AAAA,WAAAC,EAAA,MAAA,WAAA,WAVQ,EACxB,OAAAC,GACA,eAAAC,IAAgB,4BAChB,MAAAC,GACA,UAAAC,EACF,GAKkB;AAChBC,QAAU,EACR,KAAK,KACL,kCAAkCH,CAAa,WAAWC,EAAK,KAAK,OAAO,YAAYA,EAAK,KAAK,UAAU,GAC7G;AACA,UAAMG,IAAM,IAAI,IAAI,sBAAsBJ,CAAa,GACjDK,IAAOC,EAAAC,EAAA,CAAA,GACRN,CAAAA,GADQ,EAEX,SAASC,EACX,CAAA;AACA,UAAI;AACF,YAAMP,IAAW,MAAM,MAAMS,GAAK,EAChC,SAAS,EAAE,eAAe,UAAUL,CAAK,GAAG,GAC5C,MAAM,KAAK,UAAUM,CAAI,GACzB,QAAQ,OACV,CAAC;AACD,YAAI;AACF,eAAK,YAAYV,CAAQ;AACzB;QACF,SAASa,GAAK;AACZ,gBAAAL,EAAU,EAAE,KAAK,KAAK,SAAUK,EAAc,SAASb,EAAS,MAAM,GAChEa,aAAeC,IACjBD,IACAZ,EAAa,UAAU,aAAaD,EAAS,QAAA,YAA6Ba,EAAc,OAAO;QACrG;MACF,SAASA,GAAK;AACZ,YAAME,IAAQF;AACd,cAAI,CAAC,mBAAmB,gBAAgB,YAAY,EAAE,KAAKG,OAAWD,EAAM,QAAQ,SAASC,CAAO,CAAC,IAC7Ff,EAAa,UAAU,oBAAA,YAAwCc,EAAM,OAAO,IAE9EA;MACR;IACF,CAAA;EAAA;AACF;AAvDahB,GACI,MAAM;AuBPhB,IAAKkB,KAAAA,QACVA,EAAAA,EAAA,gBAAA,CAAA,IAAA,iBACAA,EAAAA,EAAA,mBAAA,CAAA,IAAA,oBACAA,EAAAA,EAAA,sBAAA,CAAA,IAAA,uBACAA,EAAAA,EAAA,6BAAA,CAAA,IAAA,8BACAA,EAAAA,EAAA,+BAAA,CAAA,IAAA,gCALUA,IAAAA,KAAA,CAAA,CAAA;ACAL,IAAKC,MAAAA,QACVA,EAAA,eAAe,gBACfA,EAAA,aAAa,cACbA,EAAA,SAAS,UACTA,EAAA,UAAU,WACVA,EAAA,SAAS,UACTA,EAAA,eAAe,gBACfA,EAAA,UAAU,WAPAA,IAAAA,MAAA,CAAA,CAAA;ASCL,IAAKC,MAAAA,QACVA,EAAAA,EAAA,UAAU,CAAA,IAAV,WACAA,EAAAA,EAAA,YAAY,CAAA,IAAZ,aAFUA,IAAAA,MAAA,CAAA,CAAA;AeIZ,IAAMC,KAAqBC,CAAAA,OAAyBA,GAAM,UAAU;AAApE,IACMC,KAA2BD,CAAAA,OAAyBA,GAAM,UAAU;AAD1E,IAEME,KAA2BF,CAAAA,OAAyBA,GAAM,UAAU;AAF1E,IAGMG,KAAe,CAACC,IAAuBC,MAAkCA;AAH/E,IAIMC,KAAgB,CAACF,IAAuBG,MAAoCA;AAJlF,IAKMC,KAA6BR,CAAAA,OAAyBA,GAAM;AALlE,IAMMS,KAAsBT,CAAAA,OAAyBA,GAAM;AAN3D,IAOMU,KAA4BV,CAAAA,OAAyBA,GAAM;AAPjE,IAYMW,KAAiBC,eACrB,CAACH,IAAoBV,EAAiB,GACtC,CAACc,IAAgBC,MAAgBD,GAAeC,CAAW,CAC7D;AAfA,IAoBMC,KAAcH,eAAeD,IAAgBA,CAAAA,OAAe;AAzBlE,MAAAK;AAyBqE,UAAAA,IAAAL,MAAA,OAAA,SAAAA,GAAgB,cAAhB,OAAA,SAAAK,EAA2B;AAAA,CAAW;AApB3G,IAsBMC,KAASL,eAAeD,IAAgBA,CAAAA,OAAe;AA3B7D,MAAAK;AA2BgE,UAAAA,IAAAL,MAAA,OAAA,SAAAA,GAAgB,cAAhB,OAAA,SAAAK,EAA2B;AAAA,CAAM;AAtBjG,IA2BME,KAAiBN,eAAeD,IAAgBA,CAAAA,OAAe;AAhCrE,MAAAK;AAgCwE,UAAAA,IAAAL,MAAA,OAAA,SAAAA,GAAgB,YAAhB,OAAA,SAAAK,EAAyB;AAAA,CAAO;AA3BxG,IAgCMG,KAAmBP,eAAeD,IAAgBA,CAAAA,OAAe;AArCvE,MAAAK;AAqC0E,UAAAA,IAAAL,MAAA,OAAA,SAAAA,GAAgB,cAAhB,OAAA,SAAAK,EAA2B;AAAA,CAAO;AAhC5G,IAqCMI,KAA0BR,eAC9BD,IACAA,CAAAA,OAAe;AA5CjB,MAAAK;AA4CoB,UAAAA,IAAAL,MAAA,OAAA,SAAAA,GAAgB,YAAhB,OAAA,SAAAK,EAAyB;AAAA,CAC7C;AAxCA,IA6CMK,KAA4BT,eAChCD,IACAA,CAAAA,OAAe;AApDjB,MAAAK;AAoDoB,UAAAA,IAAAL,MAAA,OAAA,SAAAA,GAAgB,cAAhB,OAAA,SAAAK,EAA2B;AAAA,CAC/C;AAhDA,IAqDMM,KAAiBV,eAAeD,IAAgBA,CAAAA,OAAe;AA1DrE,MAAAK;AA0DwE,UAAAA,IAAAL,MAAA,OAAA,SAAAA,GAAgB,YAAhB,OAAA,SAAAK,EAAyB;AAAA,CAAS;AArD1G,IA0DMO,KAAqBX,eAAeD,IAAgBA,CAAAA,OAAe;AA/DzE,MAAAK;AA+D4E,UAAAA,IAAAL,MAAA,OAAA,SAAAA,GAAgB,cAAhB,OAAA,SAAAK,EAA2B;AAAA,CAAa;AA1DpH,IAiEMQ,KAA0BZ,eAAe,CAACH,IAAoBN,EAAY,GAAG,CAACU,IAAgBR,MAClGA,IAASQ,GAAeR,CAAM,IAAI,MACpC;AAnEA,IAqEMoB,KAA2Bb,eAC/B,CAACJ,IAA2BF,EAAa,GACzC,CAACoB,IAAiBnB,MAAaA,IAAUmB,GAAgBnB,CAAO,IAAI,MACtE;AAxEA,IA0EMoB,KAAgCf,eACpC,CAACF,IAA0BJ,EAAa,GACxC,CAACsB,IAAsBrB,MAAaA,IAAUqB,GAAqBrB,CAAO,IAAI,MAChF;AA7EA,IAkFMsB,KAAgBC,EAAUN,EAAuB;AAlFvD,IAuFMO,KAAiBD,EAAUL,EAAwB;AAvFzD,IA6FMO,KAAuBpB,eAC3B,CAACF,IAA0BT,EAAuB,GAClD,CAACgC,IAAY1B,MAAS;AApGxB,MAAAS;AAoG4B,SAAAT,KAAUS,IAAAiB,GAAW1B,CAAO,MAAlB,OAAA,SAAAS,EAAsB,CAAA,IAAK;AAAA,CACjE;AAhGA,IAkGMkB,KAA2BJ,EAC/BlB,eAAee,IAA+BM,CAAAA,OAAcA,MAAA,OAAA,SAAAA,GAAa,CAAA,CAAE,CAC7E;AApGA,IAsGME,KAAuBvB,eAC3B,CAACF,IAA0BR,EAAuB,GAClD,CAAC+B,IAAY1B,MAAS;AA7GxB,MAAAS;AA6G4B,SAAAT,KAAUS,IAAAiB,GAAW1B,CAAO,MAAlB,OAAA,SAAAS,EAAsB,CAAA,IAAK;AAAA,CACjE;AAzGA,IA2GMoB,KAA2BN,EAAUlB,eAAee,IAA+BM,CAAAA,OAAcA,EAAU,CAAC;;;AtK7GlH;AAAA,EACE,gBAAAI;AAAA,EACA,kBAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,yBAAAC;AAAA,OACK;AACP,SAAS,qBAAAC,oBAAmB,aAAAC,aAAW,iBAAiB,kBAAkB;AAUnE,IAAM,mBAAmB,CAC9B;AAAA,EACE;AAAA,EACA;AAAA,EACA;AACF,GACA,YAAY,SACT;AACH,MAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAAC,kBAAkB;AACtE,WAAO;AAAA,EACT;AACA,QAAM,QAAkB,CAAC;AACzB,MAAI,sBAAsB;AACxB,UAAM,KAAK,SAAS;AAAA,EACtB;AACA,MAAI,qBAAqB;AACvB,UAAM,KAAK,QAAQ;AAAA,EACrB;AACA,MAAI,kBAAkB;AACpB,UAAM,KAAK,KAAK;AAAA,EAClB;AACA,SAAO,MAAM,KAAK,SAAS;AAC7B;AAEO,IAAM,aAAa,MAAM;AAhDhC,MAAAC;AAiDE,QAAM,EAAE,cAAc,cAAc,IAAIC,uBAAsB;AAC9D,QAAM,WAAWC,cAAYC,eAAc;AAC3C,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,cAAcC,SAA8B,IAAI;AACtD,QAAM,EAAE,WAAW,IAAI,gCAAgC;AACvD,QAAM,CAAC,UAAU,WAAW,IAAIC,WAAS,CAAC;AAE1C,QAAM,aAAaC,cAAY,MAAM;AACnC,gBAAY,UAAU,YAAY,MAAM;AAzD5C,UAAAP;AA0DM,YAAM,aAAYA,MAAA,qCAAU,SAAS,OAAnB,gBAAAA,IAAwB,eAAe,uBAAuB,cAAc;AAC9F,WAAI,qCAAU,YAAW,WAAW;AAClC,oBAAY,KAAK,IAAI,IAAI,UAAU,QAAQ,CAAC;AAAA,MAC9C;AAAA,IACF,GAAG,GAAI;AAAA,EACT,GAAG,CAAC,qCAAU,SAAS,qCAAU,UAAU,UAAU,CAAC;AAEtD,EAAAQ,YAAU,MAAM;AACd,QAAI,qCAAU,SAAS;AACrB,iBAAW;AAAA,IACb;AACA,QAAI,EAAC,qCAAU,YAAW,YAAY,SAAS;AAC7C,oBAAc,YAAY,OAAO;AAAA,IACnC;AACA,WAAO,MAAM;AACX,UAAI,YAAY,SAAS;AACvB,sBAAc,YAAY,OAAO;AAAA,MACnC;AAAA,IACF;AAAA,EACF,GAAG,CAAC,SAAS,SAAS,UAAU,UAAU,CAAC;AAE3C,MAAI,CAAC,gBAAgB,CAAC,eAAe;AACnC,WAAO;AAAA,EACT;AACA,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAI;AAAA,MACJ,KAAK;AAAA,QACH,QAAQ;AAAA,QACR,SAAS;AAAA,QACT,cAAc;AAAA,MAChB;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,GAAG,MAAM,GAAG,MAAM,GAAG,UAAU,IAAI,wBAAwB,IAAI,KAAK,GAAG;AAAA,IACnF,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,KAAI,OACvB,gBAAAA,QAAA,cAAC,QAAK,SAAS,CAAC,WAAW,WAAW,WAAS,MAAI,GACnD,gBAAAA,QAAA,cAAC,QAAK,SAAQ,eAAWT,MAAA,qCAAU,aAAV,gBAAAA,IAAoB,UAAS,KAAK,eAAe,WAAW,QAAQ,IAAI,EAAG,CACtG;AAAA,EACF;AAEJ;AAEO,IAAM,kBAAkB,MAAM;AACnC,QAAM,EAAE,sBAAsB,qBAAqB,kBAAkB,cAAc,IAAIC,uBAAsB;AAC7G,QAAM,cAAcC,cAAYQ,kBAAiB;AACjD,QAAM,WAAWN,WAAS,OAAU,MAAM,EAAE;AAE5C,MACE,CAAC;AAAA;AAAA,EAGD,CAAC,2CAAa,kBAAkB,CAAC,qBAAqB,CAAC,kBAAkB,oBAAoB,EAAE;AAAA,IAC7F,WAAS,CAAC,CAAC;AAAA,EACb,GACA;AAEA,QAAI,EAAE,YAAY;AAAgB,aAAO;AAAA,EAC3C;AAEA,SACE,gBAAAK,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,QAAQ,EAAE,QAAQ,EAAE;AAAA,MACpB,OAAO,iBAAiB;AAAA,QACtB;AAAA,QACA;AAAA,QACA;AAAA,MACF,CAAC;AAAA;AAAA,IAED,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,OAAO;AAAA,UACP,YAAY;AAAA,QACd;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,cAAW,OAAO,IAAI,QAAQ,IAAI;AAAA,IACrC;AAAA,EACF;AAEJ;AAEO,IAAM,uBAAuB,MAAM;AACxC,QAAM,YAAYP,cAAYS,qBAAoB;AAClD,MAAI,UAAU,OAAO,UAAU,IAAI,UAAU,GAAkB,QAAQ;AACrE,WACE,gBAAAF,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,QAAQ,EAAE,QAAQ,EAAE;AAAA,QACpB,OAAO,iBAAiB;AAAA,UACtB,sBAAsB;AAAA,UACtB,qBAAqB;AAAA,UACrB,kBAAkB;AAAA,QACpB,CAAC;AAAA;AAAA,MAED,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK;AAAA,YACH,OAAO;AAAA,YACP,YAAY;AAAA,UACd;AAAA;AAAA,QAEA,gBAAAA,QAAA,cAAC,mBAAgB,OAAO,IAAI,QAAQ,IAAI;AAAA,MAC1C;AAAA,IACF;AAAA,EAEJ;AACA,SAAO;AACT;AAEA,IAAMG,kBAAiB,MAAM;AAC3B,QAAM,cAAcV,cAAYQ,kBAAiB;AACjD,QAAM,CAAC,MAAM,OAAO,IAAIJ,WAAS,KAAK;AACtC,QAAM,EAAE,gBAAgB,iBAAiB,IAAI,oBAAoB;AACjE,QAAM,EAAE,sBAAsB,eAAe,aAAa,IAAIL,uBAAsB;AACpF,QAAM,aAAaY,gBAAc;AACjC,MAAI,EAAC,2CAAa,qBAAoB,cAAc;AAClD,WAAO;AAAA,EACT;AACA,MAAI,sBAAsB;AACxB,WACE,gBAAAJ,QAAA,cAACK,SAAQ,MAAR,EAAa,MAAY,cAAc,WACtC,gBAAAL,QAAA,cAACK,SAAQ,SAAR,EAAgB,SAAO,QACtB,gBAAAL,QAAA,cAAC,UAAO,SAAQ,UAAS,eAAY,kBAAiB,MAAI,MAAC,UAAQ,MAAC,SAAS,MAAM,QAAQ,IAAI,KAC7F,gBAAAA,QAAA,cAAC,gBAAW,GACZ,gBAAAA,QAAA,cAAC,QAAK,IAAG,QAAO,KAAK,EAAE,OAAO,EAAE,SAAS,OAAO,GAAG,OAAO,eAAe,KAAG,gBAE5E,CACF,CACF,GACA,gBAAAA,QAAA,cAACK,SAAQ,QAAR,MACC,gBAAAL,QAAA,cAACK,SAAQ,SAAR,EAAgB,OAAM,OAAM,YAAY,GAAG,KAAK,EAAE,GAAG,MAAM,KAC1D,gBAAAL,QAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,OAAO,qBAAqB,KAAG,6CAE5D,GACA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,eAAY;AAAA,QACZ,SAAQ;AAAA,QACR,MAAI;AAAA,QACJ,KAAK,EAAE,IAAI,OAAO;AAAA,QAClB,SAAS,MAAY;AACnB,cAAI;AACF,kBAAM,WAAW,qBAAqB;AAAA,UACxC,SAAS,OAAO;AACd,kBAAM,MAAM;AACZ,yBAAa,SAAS;AAAA,cACpB,OAAO,IAAI;AAAA,cACX,SAAS;AAAA,YACX,CAAC;AAAA,UACH;AACA,kBAAQ,KAAK;AAAA,QACf;AAAA;AAAA,MACD;AAAA,IAED,CACF,CACF,CACF;AAAA,EAEJ;AACA,SACE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,eAAY;AAAA,MACZ,SAAQ;AAAA,MACR,MAAI;AAAA,MACJ,UAAU,oBAAoB;AAAA,MAC9B,SAAS,MAAY;AACnB,cAAM,eAAe;AAAA,MACvB;AAAA;AAAA,IAEC,mBAAmB,gBAAAA,QAAA,cAAC,WAAQ,MAAM,IAAI,OAAM,gBAAe,IAAK,gBAAAA,QAAA,cAAC,gBAAW;AAAA,IAC7E,gBAAAA,QAAA,cAAC,QAAK,IAAG,QAAO,KAAK,EAAE,OAAO,EAAE,SAAS,OAAO,GAAG,OAAO,eAAe,KACtE,mBAAmB,aAAa,SAAQ,YAC3C;AAAA,EACF;AAEJ;AAKO,IAAM,gBAAgB,MAAM;AACjC,QAAM,cAAcP,cAAYa,wBAAuB;AACvD,QAAM,WAAWX,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,YAAYF,cAAYc,gBAAe;AAE7C,SACE,gBAAAP,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,KAAK,KACnC,CAAC,YACA,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,KAAK,KACpC,gBAAAA,QAAA,cAAC,0BAAqB,GACtB,gBAAAA,QAAA,cAAC,qBAAgB,GAChB,cAAcQ,cAAa,UAAU,gBAAAR,QAAA,cAAC,gBAAW,IAAK,IACzD,GAED,eAAe,CAAC,WAAW,gBAAAA,QAAA,cAACG,iBAAA,IAAe,IAAK,IACnD;AAEJ;AAEO,IAAM,uBAAuB,CAAC;AAAA,EACnC;AAAA,EACA;AACF,MAGM;AACJ,SACE,gBAAAH,QAAA,cAAC,MAAM,MAAN,EAAW,MAAM,QAChB,gBAAAA,QAAA,cAAC,MAAM,SAAN,MACC,gBAAAA,QAAA,cAAC,MAAM,OAAN,EAAY,KAAK,EAAE,GAAG,MAAM,KAC3B,gBAAAA,QAAA,cAAC,QAAK,WAAU,OAAM,SAAQ,WAAU,KAAK,EAAE,GAAG,QAAQ,GAAG,uBAAuB,KAClF,gBAAAA,QAAA,cAAC,QAAK,SAAQ,SAAQ,OAAM,UAAS,KAAI,OACvC,gBAAAA,QAAA,cAACS,oBAAA,IAAkB,GACnB,gBAAAT,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,uBAAuB,KAAG,gBAEvD,CACF,GACA,gBAAAA,QAAA,cAAC,MAAM,OAAN,EAAY,KAAK,EAAE,OAAO,QAAQ,GAAG,SAAS,WAC7C,gBAAAA,QAAA,cAACU,aAAA,IAAU,CACb,CACF,CACF,GACA,gBAAAV,QAAA,cAAC,uBAAkB,GACnB,gBAAAA,QAAA,cAAC,OAAI,IAAG,OAAM,KAAK,EAAE,GAAG,OAAO,WAAW,UAAU,WAAW,OAAO,KACpE,gBAAAA,QAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,EAAE,GAAG,sBAAsB,IAAI,KAAK,KAAG,2EAEpE,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK,EAAE,OAAO,OAAO;AAAA,MACrB,MAAK;AAAA,MACL,eAAY;AAAA,MACZ,SAAS;AAAA;AAAA,IACV;AAAA,EAED,CACF,CACF,CACF;AAEJ;;;AkLxSA;AAAA,OAAOW,WAAS,YAAAC,kBAAgB;AAChC,SAAS,YAAAC,kBAAgB;AACzB,SAAS,uBAAAC,sBAAqB,iBAAAC,iBAAe,eAAAC,qBAAmB;;;ACFhE;AAAA,OAAOC,aAAW;AAClB,SAAS,mBAAAC,kBAAiB,aAAAC,mBAAiB;AAMpC,IAAM,oBAAoB,CAAC;AAAA,EAChC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAQM;AACJ,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,UAAU,CAAM,MAAK;AACnB,UAAE,eAAe;AACjB,cAAM,WAAW;AAAA,MACnB;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS,WAAW,OAAO;AAAA,QAC3B,KAAK;AAAA,UACH,OAAO;AAAA,UACP,YAAY;AAAA,UACZ,SAAS;AAAA,UACT,IAAI;AAAA,UACJ,OAAO,EAAE,IAAI,MAAM,cAAc,4BAA4B;AAAA,QAC/D;AAAA;AAAA,MAEC,WAAW,gBAAAA,QAAA,cAACC,kBAAA,EAAgB,SAAS,aAAa,OAAO,EAAE,aAAa,SAAS,GAAG,IAAK;AAAA,MAAK;AAAA,MAE/F,gBAAAD,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK,EAAE,OAAO,WAAW,IAAI,QAAQ,WAAW,EAAE,OAAO,sBAAsB,QAAQ,UAAU,EAAE;AAAA,UACnG,SAAS;AAAA;AAAA,QAET,gBAAAA,QAAA,cAACE,aAAA,IAAU;AAAA,MACb;AAAA,IACF;AAAA,IACA,gBAAAF,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,sBAAsB,IAAI,MAAM,IAAI,MAAM,OAAO,EAAE,IAAI,MAAM,IAAI,KAAK,EAAE,KAAG,iEAE5G;AAAA,IACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,UAAS,OAAM,UAAS,KAAK,EAAE,IAAI,MAAM,GAAG,QAAQ,OAAO,EAAE,IAAI,KAAK,EAAE,KACpF,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK,EAAE,OAAO,QAAQ,IAAI,mBAAmB;AAAA,QAC7C,OAAO;AAAA,QAEP,MAAM,WAAW,WAAW;AAAA,QAC5B,UAAU,OAAK;AACb,yBAAe,EAAE,OAAO,KAAK;AAAA,QAC/B;AAAA,QACA,cAAa;AAAA,QACb,UAAQ;AAAA,QACR,eAAY;AAAA,QACZ,WAAW,CAAM,MAAK;AACpB,cAAI,EAAE,QAAQ,WAAW,eAAe,YAAY,KAAK,EAAE,SAAS,KAAK,gBAAgB,eAAe;AACtG,cAAE,eAAe;AACjB,gBAAI,UAAU;AACZ;AAAA,YACF;AACA,uBAAW;AAAA,UACb;AAAA,QACF;AAAA;AAAA,IACF,CACF;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,OAAM;AAAA,QACN,KAAK;AAAA,UACH,OAAO;AAAA,UACP,KAAK;AAAA,UACL,IAAI;AAAA,UACJ,OAAO,EAAE,IAAI,KAAK;AAAA,QACpB;AAAA;AAAA,MAEC,WAAW,OACV,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,SAAQ;AAAA,UACR,KAAK,EAAE,GAAG,OAAO;AAAA,UACjB,UAAQ;AAAA,UACR,MAAK;AAAA,UACL,UAAU,CAAC;AAAA,UACX,SAAS;AAAA;AAAA,QACV;AAAA,MAED;AAAA,MAGF,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,SAAQ;AAAA,UACR,KAAK,EAAE,OAAO,OAAO;AAAA,UACrB,MAAK;AAAA,UACL,UAAU,EAAC,2CAAa,YAAU,2CAAa,YAAW;AAAA,UAC1D,eAAY;AAAA;AAAA,QACb;AAAA,MAED;AAAA,IACF;AAAA,EACF;AAEJ;;;ADpGO,IAAM,kBAAkB,CAAC;AAAA,EAC9B;AAAA,EACA,kBAAkB;AACpB,MAGM;AACJ,QAAM,CAAC,mBAAmB,oBAAoB,IAAI,mBAAmB,oBAAoB,OAAO;AAChG,QAAM,aAAaG,gBAAc;AACjC,QAAM,gBAAgBC,cAAYC,oBAAmB;AACrD,QAAM,CAAC,aAAa,cAAc,IAAIC,WAAS,aAAa;AAC5D,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAE5C,QAAM,aAAa,MAAY;AAC7B,UAAM,QAAO,2CAAa,WAAU;AACpC,QAAI,CAAC,QAAQ,SAAS,eAAe;AACnC;AAAA,IACF;AACA,QAAI;AACF,YAAM,WAAW,WAAW,IAAI;AAChC,2BAAqB,iCACf,qBAAqB,CAAC,IADP;AAAA,QAEnB;AAAA,MACF,EAAC;AAAA,IACH,SAAS,OAAO;AACd,cAAQ,MAAM,yBAAyB,KAAK;AAC5C,mBAAa,SAAS,EAAE,OAAQ,MAAgB,QAAQ,CAAC;AAAA,IAC3D,UAAE;AACA,mBAAa,KAAK;AAAA,IACpB;AAAA,EACF;AAEA,QAAM,QAAQ;AAAA,IACZ;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,QAAQ,MAAM,aAAa,KAAK;AAAA,IAChC,aAAa,MAAM;AACjB,mBAAa,KAAK;AAClB;AAAA,IACF;AAAA,EACF;AAEA,MAAI,UAAU;AACZ,WACE,gBAAAC,QAAA,cAAC,MAAM,MAAN,EAAW,aAAW,MAAC,gBACtB,gBAAAA,QAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,IAAI,gBAAgB,GAAG,OAAO,KAClD,gBAAAA,QAAA,cAAC,sCAAsB,MAAO,CAChC,CACF;AAAA,EAEJ;AAEA,SACE,gBAAAA,QAAA,cAAC,OAAO,MAAP,EAAY,aAAW,MAAC,gBACvB,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA,cAAC,OAAO,SAAP,EAAe,KAAK,EAAE,IAAI,gBAAgB,OAAO,kBAAkB,GAAG,MAAM,KAC3E,gBAAAA,QAAA,cAAC,sCAAsB,MAAO,CAChC,CACF,CACF;AAEJ;;;AE7EA;AAAA,SAAS,eAAAC,qBAAmB;AAC5B,SAAS,iBAAAC,gBAAe,iBAAAC,iBAAe,eAAAC,eAAa,sBAAAC,4BAA0B;AAGvE,IAAM,qBAAqB,CAAC,cAAsB;AACvD,MAAI,CAAC,WAAW;AACd,UAAM,MAAM,+BAA+B;AAAA,EAC7C;AACA,SAAOC,cAAYC,eAAc,SAAS,KAAK,CAAC,MAAM;AACxD;AAOO,IAAM,iBAAiB,CAAC,cAAsB;AACnD,QAAM,aAAaC,gBAAc;AACjC,QAAM,eAAeC,qBAAmB;AACxC,QAAM,cAAcC,cAAY,MAAM;AACpC,UAAM,SAAS,aAAa,SAASC,eAAc,SAAS,KAAK,CAAC,MAAM;AACxE,eAAW,WAAW,SAAS,OAAO,CAAC,SAAS,YAAY,EAAE;AAAA,EAChE,GAAG,CAAC,cAAc,YAAY,SAAS,CAAC;AACxC,SAAO;AACT;;;ACxBA;AAAA,SAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAEpC,SAAS,sBAAsB,qBAAqB,eAAAC,qBAAmB;AAEhE,IAAM,2BAA2B,MAAM;AAC5C,QAAM,cAAcA,cAAY,EAAiB;AACjD,QAAM,eAAe,oBAAoB,qBAAqB,YAAY;AAC1E,QAAM,CAAC,gBAAgB,iBAAiB,IAAIC,WAAS,KAAK;AAE1D,EAAAC,YAAU,MAAM;AACd,QAAI,CAAC,cAAc;AACjB;AAAA,IACF;AACA,sBAAkB,aAAa,KAAK,cAAc,WAAW;AAAA,EAC/D,GAAG,CAAC,aAAa,YAAY,CAAC;AAC9B,SAAO,EAAE,gBAAgB,kBAAkB;AAC7C;;;AtLqDA,IAAMC,UAAS;AAAA,EACb,aAAa;AAAA,EACb,kBAAkB;AAAA,EAClB,eAAe;AAAA,EACf,iBAAiB;AAAA,EACjB,iBAAiB;AAAA,EACjB,iBAAiB;AAAA,EACjB,kBAAkB;AAAA,EAClB,UAAU;AAAA,EACV,WAAW;AAAA,EACX,SAAS;AACX;AAEO,IAAM,cAAc,CAAC;AAAA,EAC1B;AAAA,EACA;AACF,MAGM;AACJ,QAAM,aAAaC,gBAAc;AACjC,QAAM,cAAcC,cAAYC,kBAAiB;AACjD,QAAM,cAAcD,cAAYE,wBAAuB;AACvD,QAAM,EAAE,sBAAsB,eAAe,aAAa,IAAIC,uBAAsB;AACpF,QAAM,CAAC,YAAY,aAAa,IAAIC,WAAS,oBAAI,IAAI,CAAC;AACtD,QAAM,CAAC,kBAAkB,mBAAmB,IAAIA,WAAS,KAAK;AAC9D,QAAM,CAAC,mBAAmB,oBAAoB,IAAIA,WAAS,KAAK;AAChE,QAAM,CAAC,eAAe,gBAAgB,IAAIA,WAAS,KAAK;AACxD,QAAM,CAAC,iBAAiB,kBAAkB,IAAIA,WAAS,KAAK;AAC5D,QAAM,qBAAqB,kBAAkB,kBAAkB,YAAY;AAC3E,QAAM,EAAE,UAAU,IAAI,aAAa;AACnC,QAAM,iBAAiB,kBAAkB;AACzC,QAAM,YAAYJ,cAAYK,gBAAe;AAC7C,QAAM,eAAeC,SAAO,IAAI;AAChC,QAAM,EAAE,SAAS,WAAW,cAAc,gBAAgB,IAAI,cAAc;AAC5E,QAAM,EAAE,gBAAgB,kBAAkB,IAAI,yBAAyB;AACvE,QAAM,EAAE,OAAO,YAAY,IAAI,oBAAoB;AACnD,QAAM,qBAAqB,eAAe,cAAc,YAAY;AACpE,QAAM,oBAAoB,mBAAmB;AAC7C,QAAM,uBAAuB,sBAAsB;AACnD,QAAM,WAAW,kBAAkB,kBAAkB,EAAE;AACvD,QAAM,sBAAsBN,cAAYO,0BAAyB;AACjE,QAAM,EAAE,gBAAgB,mBAAmB,IAAI,oBAAoB;AACnE,QAAM,yBAAyBP,cAAYQ,oCAAmCC,sBAAqB,OAAO,CAAC;AAC3G,QAAM,yBAAyBT,cAAYU,6BAA4B;AAEvE,QAAM,CAAC,gBAAgB,IAAI,uBAAuB;AAClD,kBAAgB,EAAE,MAAM,WAAW,OAAO,KAAK,oBAAoB,mBAAmB,MAAM,eAAe,CAAC;AAE5G,QAAM,cAAc,CAAC,WAAmB,UAAmB;AACzD,kBAAc,YAAU;AACtB,YAAM,OAAO,IAAI,IAAI,MAAM;AAC3B,UAAI,OAAO;AACT,aAAK,IAAI,SAAS;AAAA,MACpB,OAAO;AACL,aAAK,OAAO,SAAS;AAAA,MACvB;AACA,aAAO;AAAA,IACT,CAAC;AAAA,EACH;AAEA,eAAa,cAAc,MAAM,iBAAiB,KAAK,CAAC;AAExD,SACE,gBAAAC,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,MAAM,MAAN,EAAW,MAAM,kBAAkB,cAAc,uBAChD,gBAAAA,QAAA,cAAC,WAAQ,OAAM,kBACb,gBAAAA,QAAA,cAAC,MAAM,SAAN,EAAc,SAAO,MAAC,eAAY,uBACjC,gBAAAA,QAAA,cAAC,sBAAW,KAAK,EAAE,IAAI,qBAAqB,uBAAuB,qBAAqB,GAAG,KACzF,gBAAAA,QAAA,cAACC,oBAAA,IAAkB,CACrB,CACF,CACF,GACA,gBAAAD,QAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,IAAI,gBAAgB,IAAI,MAAM,KAClD,gBAAAA,QAAA;AAAA,IAAC,MAAM;AAAA,IAAN;AAAA,MACC,KAAK;AAAA,QACH,SAAS;AAAA,QACT,OAAO;AAAA,QACP,GAAG;AAAA,QACH,gBAAgB;AAAA,QAChB,UAAU;AAAA,QACV,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,cAAc;AAAA,QACd,IAAI;AAAA,QACJ,YAAY;AAAA,MACd;AAAA;AAAA,IACD;AAAA,IAEC,gBAAAA,QAAA,cAAC,MAAM,OAAN,MACC,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,OAAO,mBAAmB,KACpC,gBAAAA,QAAA,cAACE,aAAA,IAAU,CACb,CACF;AAAA,EACF,GACA,gBAAAF,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,SAAS;AAAA,QACT,qBAAqB;AAAA,QACrB,kBAAkB;AAAA,QAClB,eAAe;AAAA,QACf,YAAY;AAAA,QACZ,IAAI;AAAA,MACN;AAAA;AAAA,KAEC,qCAAU,qBACT,gBAAAA,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,SAAS,MAAM;AACb,6BAAmB;AACnB,8BAAoB,KAAK;AAAA,QAC3B;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,WAAW,OAAX,MAAkB,kBAAkB,SAAS,CAAE;AAAA,MAChD,gBAAAA,QAAA,cAAC,gBAAW;AAAA,MACZ,gBAAAA,QAAA,cAAC,WAAW,OAAX,MAAiB,cAAY;AAAA,IAChC;AAAA,IAGD,SAAS,aACR,gBAAAA,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,QAAQ;AAAA,QACR,SAAS,MAAM;AACb,0BAAgB;AAChB,8BAAoB,KAAK;AAAA,QAC3B;AAAA;AAAA,MAEC,eAAe,gBAAAA,QAAA,cAAC,0BAAqB,IAAK,gBAAAA,QAAA,cAACG,WAAA,IAAS;AAAA,MACrD,gBAAAH,QAAA,cAAC,WAAW,OAAX,MAAkB,eAAe,UAAU,SAAQ,OAAK;AAAA,IAC3D,IACE;AAAA,IACJ,gBAAAA,QAAA,cAAC,qBAAkB,qBAA0C,YAAU,MAAC;AAAA,IACvE,yBACC,gBAAAA,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,SAAS,MAAM;AACb,8BAAoB,KAAK;AACzB,sBAAYb,QAAO,SAAS,IAAI;AAAA,QAClC;AAAA;AAAA,MAEC,0BAA0B,mBAAmB,gBAAAa,QAAA,cAACI,oBAAA,IAAkB,IAAK,gBAAAJ,QAAA,cAACK,kBAAA,IAAgB;AAAA,MACvF,gBAAAL,QAAA,cAAC,WAAW,OAAX,MAAiB,gBAAc;AAAA,IAClC,IACE;AAAA,IACH,uBAAuB,CAAC,EAAC,qCAAU,sBAClC,gBAAAA,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,SAAS,MAAM;AACb,mBAAS;AACT,8BAAoB,KAAK;AAAA,QAC3B;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,2BAAsB;AAAA,MACvB,gBAAAA,QAAA,cAAC,WAAW,OAAX,MAAiB,oBAAkB;AAAA,IACtC,IACE;AAAA,KAEH,qCAAU,oBAAmB,EAAE,wBAAwB,sBACtD,gBAAAA,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,SAAS,MAAM;AACb,2BAAiB,IAAI;AACrB,8BAAoB,KAAK;AAAA,QAC3B;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAACM,YAAA,IAAU;AAAA,MACX,gBAAAN,QAAA,cAAC,WAAW,OAAX,MAAiB,iBAAe;AAAA,IACnC;AAAA,IAGD,aACC,gBAAAA,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,SAAS,MAAM;AACb,yBAAe;AACf,8BAAoB,KAAK;AACzB,4BAAkB,KAAK;AAAA,QACzB;AAAA;AAAA,MAEC,iBAAiB,gBAAAA,QAAA,cAAC,oBAAe,IAAK,gBAAAA,QAAA,cAAC,cAAS;AAAA,MACjD,gBAAAA,QAAA,cAAC,WAAW,OAAX,MAAiB,mBAAiB;AAAA,IACrC;AAAA,KAGD,qCAAU,QACT,gBAAAA,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,QAAQ;AAAA,QACR,SAAS,MAAM;AACb,oBAAU;AACV,8BAAoB,KAAK;AAAA,QAC3B;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAACO,UAAA,IAAQ;AAAA,MACT,gBAAAP,QAAA,cAAC,WAAW,OAAX,MAAiB,eAAa;AAAA,IACjC;AAAA,IAGF,gBAAAA,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,SAAS,MAAM;AACb,+BAAqB,IAAI;AACzB,8BAAoB,KAAK;AAAA,QAC3B;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAACQ,eAAA,IAAa;AAAA,MACd,gBAAAR,QAAA,cAAC,WAAW,OAAX,MAAiB,UAAQ;AAAA,IAC5B;AAAA,IAEC,gBAAe,2CAAa,oBAC3B,gBAAAA,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,UAAU;AAAA,QACV,SAAS,MAAY;AACnB,cAAI,oBAAoB;AACtB;AAAA,UACF;AACA,cAAI,wBAAwB,eAAe;AACzC,gCAAoB,KAAK;AACzB,+BAAmB,IAAI;AAAA,UACzB,OAAO;AAEL,kBAAM,eAAe;AACrB,gCAAoB,KAAK;AAAA,UAC3B;AACA,cAAI,cAAc;AAChB,gCAAoB,KAAK;AAAA,UAC3B;AAAA,QACF;AAAA;AAAA,MAEC,qBAAqB,gBAAAA,QAAA,cAAC,aAAQ,IAAK,gBAAAA,QAAA,cAACS,aAAA,IAAW;AAAA,MAChD,gBAAAT,QAAA,cAAC,WAAW,OAAX,MACEU,OAAM,EAAE,sBAAsB,mBAAmB,CAAC,EAChD,KAAK,EAAE,sBAAsB,MAAM,oBAAoB,MAAM,GAAG,MAAM,cAAc,EACpF,KAAK,EAAE,oBAAoB,KAAK,GAAG,MAAM,oBAAoB,EAC7D,KAAK,EAAE,oBAAoB,MAAM,GAAG,MAAM,iBAAiB,EAC3D,UAAU,MAAM,IAAI,CACzB;AAAA,IACF,IACE;AAAA,IAEH,SAAS,cACR,gBAAAV,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,SAAS,MAAM;AACb,8BAAoB,KAAK;AACzB,6BAAmB;AAAA,QACrB;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAACW,WAAA,IAAS;AAAA,MACV,gBAAAX,QAAA,cAAC,WAAW,OAAX,MAAiB,eAAa;AAAA,IACjC,IACE;AAAA,EACN,CACF,CACF,GACA,gBAAAA,QAAA,cAAC,yBAAc,MAAM,mBAAmB,cAAc,sBAAsB,YAAwB,GACnG,WAAW,IAAIb,QAAO,QAAQ,KAC7B,gBAAAa,QAAA,cAAC,gBAAa,cAAc,CAAC,UAAmB,YAAYb,QAAO,UAAU,KAAK,GAAG,UAAQ,MAAC,GAE/F,WAAW,IAAIA,QAAO,WAAW,KAChC,gBAAAa,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,cAAc,CAAC,UAAmB,YAAYb,QAAO,aAAa,KAAK;AAAA,MACvE,iBAAiB,MAAM,oBAAoB,IAAI;AAAA;AAAA,EACjD,GAED,WAAW,IAAIA,QAAO,OAAO,KAC5B,gBAAAa,QAAA,cAAC,gBAAa,cAAc,CAAC,UAAmB,YAAYb,QAAO,SAAS,KAAK,GAAG,GAErF,iBACC,gBAAAa,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,MACL,KAAK;AAAA,QACH,UAAU;AAAA,QACV,GAAG;AAAA,QACH,UAAU;AAAA,QACV,MAAM;AAAA,QACN,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,IAAI;AAAA,QACJ,QAAQ;AAAA,QACR,GAAG;AAAA,QACH,IAAI;AAAA,QACJ,GAAG;AAAA,QACH,IAAI;AAAA,MACN;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,iBAAc,UAAQ,MAAC;AAAA,EAC1B,GAED,mBACC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS,MAAM,mBAAmB,KAAK;AAAA,MACvC,iBAAiB,MAAY;AAC3B,YAAI;AACF,gBAAM,WAAW,qBAAqB;AACtC,6BAAmB,KAAK;AAAA,QAC1B,SAAS,OAAO;AACd,uBAAa,SAAS;AAAA;AAAA,YAEpB,OAAO,MAAM;AAAA,YACb,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AAAA,MACF;AAAA;AAAA,EACF,CAEJ;AAEJ;;;AlCpWO,IAAM,eAAe,CAAC;AAAA,EAC3B;AAAA,EACA;AACF,MAGM;AACJ,QAAM,WAAWY,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,uBAAuB,sBAAsB;AACnD,SAAO,YAAY,uBACjB,gBAAAC,QAAA,cAAC,eAAY,UAAoB,YAAwB,IAEzD,gBAAAA,QAAA,cAAC,kBAAe,UAAoB,YAAwB;AAEhE;;;AyN5BA;AAAA,OAAOC,aAAW;AAClB,SAAS,YAAAC,WAAU,wBAAAC,6BAA4B;AAQxC,IAAM,YAAY,CAAC,EAAE,KAAAC,KAAI,MAAqB;AACnD,QAAM,EAAE,cAAc,gBAAgB,IAAI,cAAc;AACxD,QAAM,EAAE,SAAS,IAAI,gCAAgC;AAErD,MAAI,CAAC,SAAS,YAAY;AACxB,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,QAAA,cAAC,WAAQ,OAAO,eAAe,eAAe,gBAC5C,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,eAAY;AAAA,MACZ,KAAKD;AAAA,MACL,QAAQ,CAAC;AAAA,MACT,SAAS,MAAS;AAAG,qBAAM,gBAAgB;AAAA;AAAA;AAAA,IAE1C,eAAe,gBAAAC,QAAA,cAACC,uBAAA,IAAqB,IAAK,gBAAAD,QAAA,cAACE,WAAA,IAAS;AAAA,EACvD,CACF;AAEJ;;;AC7BA;AAAA,OAAOC,WAAS,YAAAC,iBAAgB;AAChC,SAAS,4BAAAC,2BAA0B,sBAAsB,eAAAC,eAAa,kBAAAC,uBAAsB;AAC5F,SAAS,uBAAuB;;;ACFhC;AAAA,OAAOC,WAAS,YAAAC,WAAU,YAAAC,kBAAgB;AAC1C,SAAS,sBAAsB;AAC/B,SAAS,UAAU,oBAAAC,yBAAwB;;;;;;;;;ACF3C;AAGO,IAAM,oBAAoB,OAAO,oBAAY;AAAA,EAClD,GAAG;AAAA,EACH,IAAI;AAAA,EACJ,GAAG;AAAA,EACH,sBAAsB;AAAA,EACtB,yBAAyB;AAAA,EACzB,OAAO;AAAA,IACL,IAAI;AAAA,IACJ,IAAI;AAAA,EACN;AACF,CAAC;AAEM,IAAM,gBAAgB,OAAO,mBAAmB;AAAA,EACrD,qBAAqB;AAAA,EACrB,wBAAwB;AAAA,EACxB,sBAAsB;AAAA,EACtB,yBAAyB;AAAA,EACzB,iBAAiB;AAAA,EACjB,GAAG;AAAA,EACH,OAAO;AAAA,IACL,GAAG;AAAA,IACH,IAAI;AAAA,EACN;AACF,CAAC;;;AC1BD;AAAA,OAAOC,WAAS,YAAAC,kBAAgB;;;ACAhC;AAAA,OAAOC,aAAW;AAIX,IAAM,YAAY,MAAM;AAC7B,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,IAAI;AAAA,MACN;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,OAAO,OAAP,EAAa,SAAO,QACnB,gBAAAA,QAAA,cAAC,QAAK,IAAG,MAAK,SAAQ,QAAK,WAE3B,CACF;AAAA,IACA,gBAAAA,QAAA,cAAC,OAAO,aAAP,EAAmB,SAAO,QACzB,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,GAAG;AAAA,QACL;AAAA;AAAA,MACD;AAAA,IAED,CACF;AAAA,EACF;AAEJ;;;AC9BA;AAAA,OAAOC,aAAW;AAKX,IAAM,YAAY,CAAC,EAAE,SAAS,aAAa,MAAM;AACtD,QAAM,CAAC,EAAE,YAAY,IAAI,mBAAmB,SAAS,SAAS;AAE9D,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,KAAK;AAAA,MACP;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,UAAQ;AAAA,QACR,MAAK;AAAA,QACL,SAAS,MAAM;AACb,uBAAa,KAAK;AAAA,QACpB;AAAA,QACA,KAAK,EAAE,GAAG,MAAM;AAAA;AAAA,MACjB;AAAA,IAED;AAAA,IACA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,MAAK;AAAA,QACL,SAAS,MAAM;AACb,cAAI,SAAS;AACX,yBAAa,OAAO;AACpB,yBAAa,KAAK;AAAA,UACpB;AAAA,QACF;AAAA,QACA,UAAU,CAAC;AAAA,QACX,eAAY;AAAA,QACZ,KAAK;AAAA,UACH,GAAG;AAAA,QACL;AAAA;AAAA,MACD;AAAA,IAED;AAAA,EACF;AAEJ;;;AC/CA;AAAA,OAAOC,aAAW;AAClB,SAAS,iBAAiB;;;ACD1B;AAAA,OAAOC,aAAW;AAClB,SAAS,YAAAC,iBAAgB;AAIlB,IAAM,UAAU,MAAM;AAC3B,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,GAAG;AAAA,QACH,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,WAAW;AAAA,MACb;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAACC;AAAA,MAAA;AAAA,QACC,OAAM;AAAA,QACN,QAAO;AAAA,QACP,OAAO;AAAA,UACL,cAAc;AAAA,QAChB;AAAA;AAAA,IACF;AAAA,IACA,gBAAAD,QAAA,cAAC,QAAK,SAAQ,aAAU,uIAGxB;AAAA,EACF;AAEJ;;;ADvBO,IAAM,eAAe,CAAC,EAAE,SAAS,YAAY,aAAa,MAAM;AACrE,QAAM,CAAC,UAAU,GAAG,IAAI,QAAQ,KAAK,MAAM,GAAG;AAC9C,SACE,gBAAAE,QAAA,cAAC,OAAO,MAAP,EAAY,aAAW,MAAC,gBACvB,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA;AAAA,IAAC,OAAO;AAAA,IAAP;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,UAAU;AAAA,QACV,GAAG;AAAA,QACH,IAAI;AAAA,MACN;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,QAAK,WAAU,YACd,gBAAAA,QAAA,cAAC,eAAU,GACX,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,YAAY;AAAA,UACZ,IAAI;AAAA,UACJ,GAAG;AAAA,UACH,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,GAAG;AAAA,UACH,WAAW;AAAA,UACX,GAAG;AAAA,UACH,IAAI;AAAA,UACJ,GAAG;AAAA,UACH,WAAW;AAAA,YACT,WAAW;AAAA,YACX,QAAQ;AAAA,UACV;AAAA,UACA,IAAI;AAAA,UACJ,IAAI;AAAA,QACN;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,QAAK,WAAU,OAAM,KAAK,EAAE,UAAU,KAAK,UAAU,MAAM,KAC1D,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK;AAAA,YACH,cAAc;AAAA,YACd,UAAU;AAAA,YACV,YAAY;AAAA,UACd;AAAA;AAAA,QAEC;AAAA,MACH,GACA,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,YAAY,SAAS,KAAG,KAAE,GAAI,CAC7C;AAAA,MACA,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,SAAS,MAAM,WAAW,IAAI;AAAA,UAC9B,OAAO;AAAA,YACL,QAAQ;AAAA,UACV;AAAA;AAAA,MACF;AAAA,IACF,GACA,gBAAAA,QAAA,cAAC,aAAQ,GACT,gBAAAA,QAAA,cAAC,aAAU,SAAkB,cAA4B,CAC3D;AAAA,EACF,CACF,CACF;AAEJ;;;AH/DO,SAAS,eAAe,EAAE,aAAa,GAAG;AAC/C,QAAM,CAAC,SAAS,UAAU,IAAIC,WAAS,IAAI;AAE3C,SAAO,CAAC,UACN,gBAAAC,QAAA,cAAC,OAAO,MAAP,EAAY,aAAW,MAAC,gBACvB,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA;AAAA,IAAC,OAAO;AAAA,IAAP;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,UAAU;AAAA,QACV,GAAG;AAAA,QACH,IAAI;AAAA,MACN;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,QAAK,WAAU,YACd,gBAAAA,QAAA,cAAC,eAAU,GACX,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,UAAU,YAAU;AAClB,qBAAW,OAAO,MAAM,CAAC,CAAC;AAAA,QAC5B;AAAA,QACA,aAAY;AAAA,QACZ,MAAK;AAAA,QACL,QAAO;AAAA;AAAA,IACT,GAEA,gBAAAA,QAAA,cAAC,aAAU,SAAkB,cAA4B,CAC3D;AAAA,EACF,CACF,CACF,IAEA,gBAAAA,QAAA,cAAC,gBAAa,SAAkB,YAAwB,cAA4B;AAExF;;;AFhCA,IAAMC,UAAS;AAAA,EACb,OAAO;AAAA,EACP,cAAc;AAAA,EACd,WAAW;AACb;AAEO,SAAS,qBAAqB;AACnC,QAAM,CAAC,YAAY,aAAa,IAAIC,WAAS,oBAAI,IAAI,CAAC;AACtD,QAAM,EAAE,iBAAiB,IAAI,eAAe;AAC5C,QAAM,cAAc,CAAC,WAAW,UAAU;AACxC,kBAAc,YAAU;AACtB,YAAM,OAAO,IAAI,IAAI,MAAM;AAC3B,UAAI,OAAO;AACT,aAAK,IAAI,SAAS;AAAA,MACpB,OAAO;AACL,aAAK,OAAO,SAAS;AAAA,MACvB;AACA,aAAO;AAAA,IACT,CAAC;AAAA,EACH;AACA,QAAM,EAAE,kBAAkB,IAAI,eAAe;AAC7C,SACE,gBAAAC,QAAA,cAACC,WAAA,MACC,gBAAAD,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,MAAM,WAAW,IAAIF,QAAO,KAAK;AAAA,MACjC,cAAc,WAAS,YAAYA,QAAO,OAAO,KAAK;AAAA,MACtD,OAAO;AAAA;AAAA,IAEP,gBAAAE,QAAA,cAAC,SAAS,SAAT,EAAiB,SAAO,MAAC,eAAY,eAAc,UAAU,oBAC5D,gBAAAA,QAAA,cAAC,iBAAc,UAAU,oBACvB,gBAAAA,QAAA,cAAC,WAAQ,OAAM,WACb,gBAAAA,QAAA,cAAC,WACC,gBAAAA,QAAA,cAACE,mBAAA,IAAiB,CACpB,CACF,CACF,CACF;AAAA,IACA,gBAAAF,QAAA;AAAA,MAAC,SAAS;AAAA,MAAT;AAAA,QACC,YAAY;AAAA,QACZ,KAAK;AAAA,UACH,GAAG;AAAA,UACH,WAAW;AAAA,UACX,GAAG;AAAA,UACH,IAAI;AAAA,QACN;AAAA;AAAA,MAEA,gBAAAA,QAAA;AAAA,QAAC,SAAS;AAAA,QAAT;AAAA,UACC,KAAK;AAAA,YACH,eAAe;AAAA,YACf,YAAY;AAAA,YACZ,IAAI;AAAA,YACJ,IAAI;AAAA,YACJ,IAAI;AAAA,YACJ,WAAW;AAAA,cACT,IAAI;AAAA,cACJ,QAAQ;AAAA,YACV;AAAA,UACF;AAAA;AAAA,QAEA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAK,eAAa;AAAA,QAChC,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAK,+BAA6B;AAAA,MAClD;AAAA,MACA,gBAAAA,QAAA;AAAA,QAAC,SAAS;AAAA,QAAT;AAAA,UACC,KAAK;AAAA,YACH,eAAe;AAAA,YACf,YAAY;AAAA,YACZ,KAAK;AAAA,YACL,IAAI;AAAA,YACJ,IAAI;AAAA,YACJ,IAAI;AAAA,YACJ,WAAW;AAAA,cACT,IAAI;AAAA,cACJ,QAAQ;AAAA,YACV;AAAA,UACF;AAAA;AAAA,QAEA,gBAAAA,QAAA;AAAA,UAAC;AAAA;AAAA,YACC,WAAU;AAAA,YACV,OAAM;AAAA,YACN,KAAK;AAAA,cACH,KAAK;AAAA,YACP;AAAA;AAAA,UAEA,gBAAAA,QAAA;AAAA,YAAC;AAAA;AAAA,cACC,IAAG;AAAA,cACH,SAAS;AAAA,cACT,KAAK;AAAA,gBACH,GAAG;AAAA,gBACH,SAAS;AAAA,gBACT,gBAAgB;AAAA,gBAChB,QAAQ;AAAA,gBACR,GAAG;AAAA,gBACH,IAAI;AAAA,gBACJ,IAAI;AAAA,cACN;AAAA;AAAA,YAEA,gBAAAA,QAAA;AAAA,cAAC;AAAA;AAAA,gBACC,KAAK;AAAA,gBACL,KAAI;AAAA,gBACJ,OAAM;AAAA,gBACN,QAAO;AAAA,gBACP,OAAO;AAAA,kBACL,qBAAqB;AAAA;AAAA,kBACrB,sBAAsB;AAAA,gBACxB;AAAA;AAAA,YACF;AAAA,UACF;AAAA,UACA,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,OAAM,YAC7B,gBAAAA,QAAA,cAAC,QAAK,SAAQ,WAAQ,cAAY,GAClC,gBAAAA,QAAA;AAAA,YAAC;AAAA;AAAA,cACC,SAAQ;AAAA,cACR,KAAK;AAAA,gBACH,GAAG;AAAA,gBACH,WAAW;AAAA,cACb;AAAA;AAAA,YACD;AAAA,UAED,CACF;AAAA,QACF;AAAA,QACA,gBAAAA,QAAA;AAAA,UAAC;AAAA;AAAA,YACC,WAAU;AAAA,YACV,OAAM;AAAA,YACN,KAAK;AAAA,cACH,KAAK;AAAA,YACP;AAAA;AAAA,UAEA,gBAAAA,QAAA;AAAA,YAAC;AAAA;AAAA,cACC,SAAS,MAAM;AACb,4BAAYF,QAAO,WAAW,IAAI;AAAA,cACpC;AAAA,cACA,UAAU;AAAA,cACV,KAAK;AAAA,gBACH,GAAG;AAAA,gBACH,SAAS;AAAA,gBACT,gBAAgB;AAAA,gBAChB,QAAQ;AAAA,gBACR,GAAG;AAAA,gBACH,IAAI;AAAA,gBACJ,IAAI;AAAA,cACN;AAAA;AAAA,YAEA,gBAAAE,QAAA;AAAA,cAAC;AAAA;AAAA,gBACC,KAAK;AAAA,gBACL,KAAI;AAAA,gBACJ,OAAM;AAAA,gBACN,QAAO;AAAA,gBACP,OAAO;AAAA,kBACL,qBAAqB;AAAA;AAAA,kBACrB,sBAAsB;AAAA,gBACxB;AAAA;AAAA,YACF;AAAA,YACA,gBAAAA,QAAA;AAAA,cAAC;AAAA;AAAA,gBACC,WAAU;AAAA,gBACV,OAAM;AAAA,gBACN,KAAK;AAAA,kBACH,UAAU;AAAA,kBACV,KAAK;AAAA,kBACL,MAAM;AAAA,kBACN,SAAS;AAAA,kBACT,GAAG;AAAA,kBACH,IAAI;AAAA,kBACJ,QAAQ;AAAA,kBACR,KAAK;AAAA,gBACP;AAAA;AAAA,cAEA,gBAAAA,QAAA,cAAC,YAAS,QAAQ,IAAI,OAAO,IAAI;AAAA,cAEjC,gBAAAA,QAAA;AAAA,gBAAC;AAAA;AAAA,kBACC,SAAQ;AAAA,kBACR,KAAK;AAAA,oBACH,YAAY;AAAA,oBACZ,GAAG;AAAA,oBACH,IAAI;AAAA,kBACN;AAAA;AAAA,gBACD;AAAA,cAED;AAAA,YACF;AAAA,UACF;AAAA,UACA,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,OAAM,YAC7B,gBAAAA,QAAA,cAAC,QAAK,SAAQ,WAAQ,WAAS,GAC/B,gBAAAA,QAAA;AAAA,YAAC;AAAA;AAAA,cACC,SAAQ;AAAA,cACR,KAAK;AAAA,gBACH,GAAG;AAAA,gBACH,WAAW;AAAA,cACb;AAAA;AAAA,YACD;AAAA,UAED,CACF;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,EACF,GACC,WAAW,IAAIF,QAAO,SAAS,KAC9B,gBAAAE,QAAA,cAAC,kBAAe,cAAc,WAAS,YAAYF,QAAO,WAAW,KAAK,GAAG,CAEjF;AAEJ;;;ADtMO,IAAM,oBAAoB,CAAC,EAAE,KAAAK,OAAM,CAAC,EAAE,MAAM;AACjD,QAAM,qBAAqBC,cAAYC,yBAAwB;AAC/D,QAAM,cAAc,cAAc,YAAY,WAAW;AAEzD,QAAM;AAAA,IACJ;AAAA,IACA,yBAAyB;AAAA,IACzB;AAAA,EACF,IAAIC,gBAAe,WAAS;AAC1B,iBAAa,SAAS;AAAA,MACpB,OAAO,MAAM;AAAA,MACb,SAAS;AAAA,MACT,UAAU;AAAA,IACZ,CAAC;AAAA,EACH,CAAC;AACD,QAAM,EAAE,kBAAkB,IAAI,qBAAqB;AACnD,QAAM,qBAAqB,oBAAoB,CAAC,CAAC;AACjD,MAAI,CAAC,mBAAmB,UAAU,CAAC,uBAAuB,GAAG;AAC3D,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,QAAA,cAACC,WAAA,MACC,gBAAAD,QAAA,cAAC,QAAK,WAAU,SACd,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAI;AAAA,MACJ,QAAQ,CAAC;AAAA,MACT,KAAKJ;AAAA,MACL,UAAU;AAAA,MACV,SAAS,MAAY;AACnB,cAAM,kBAAkB;AACxB,cAAM,kBAAkB;AAAA,MAC1B;AAAA;AAAA,IAEA,gBAAAI,QAAA,cAAC,WAAQ,OAAO,GAAG,CAAC,qBAAqB,UAAU,MAAM,qBACvD,gBAAAA,QAAA,cAAC,WACC,gBAAAA,QAAA,cAAC,qBAAgB,CACnB,CACF;AAAA,EACF,GACA,gBAAAA,QAAA,cAAC,wBAAmB,CACtB,CACF;AAEJ;;;AQzDA;AAAA,OAAOE,WAAS,aAAAC,mBAAiB;AAEjC,SAAS,6BAAAC,kCAAiC;AAC1C;AAAA,EACE,iBAAAC;AAAA,EACA;AAAA,EACA,6BAAAC;AAAA,EACA;AAAA,EACA,eAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,yBAAAC,8BAA6B;AAS/B,IAAM,WAAW,MAAM;AAC5B,QAAM,WAAW,kBAAkB,kBAAkB,EAAE;AACvD,QAAM,WAAW,sBAAsB,kBAAkB,EAAE;AAC3D,QAAM,YAAYC,cAAYC,0BAAyB;AACvD,QAAM,cAAcD,cAAY,iBAAiB;AACjD,QAAM,mBAAmBA,cAAY,sBAAsB;AAC3D,QAAM,iBAAiBA,cAAYE,eAAc,SAAS,cAAc,CAAC;AACzE,QAAM,aAAaC,gBAAc;AACjC,QAAM,EAAE,YAAY,IAAIC,aAAY;AAEpC,EAAAC,YAAU,MAAM;AA/BlB,QAAAC;AAgCI,QAAI,CAAC,aAAa;AAChB,OAAAA,MAAA,8BAAAA,IAAW;AACX,iBAAW,WAAW,SAAS,YAAYC,2BAA0B,IAAI;AAAA,IAC3E;AAAA,EACF,GAAG,CAAC,YAAY,WAAW,CAAC;AAE5B,MAAI,CAAC,aAAc,CAAC,oBAAoB,YAAa,CAAC,aAAa;AACjE,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,QAAA,cAAC,WAAQ,MAAK,OAAM,UAAU,UAAU,OAAM,kCAC5C,gBAAAA,QAAA,cAAC,sBAAW,QAAQ,CAAC,UAAU,SAAS,UAAU,eAAY,oBAC3D,iBAAiB,gBAAAA,QAAA,cAAC,WAAQ,MAAM,IAAI,IAAK,gBAAAA,QAAA,cAACC,wBAAA,IAAsB,CACnE,CACF;AAEJ;;;ACjDA;AAAA,OAAOC,aAAW;AAClB,SAAS,gCAAAC,+BAA8B,eAAAC,qBAAmB;AAC1D,SAAS,gBAAgB;AASlB,IAAM,aAAa,CAAC,EAAE,QAAQ,MAAgC;AACnE,QAAM,sBAAsBC,cAAYC,6BAA4B;AACpE,QAAM,aAAa,sBAAsB,kBAAkB,IAAI;AAC/D,QAAM,aAAa,kBAAkB,kBAAkB,IAAI;AAE3D,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,UAAU;AAAA,MACZ;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,WAAQ,KAAI,QAAO,OAAO,GAAG,aAAa,UAAU,MAAM,WACzD,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS,MAAO,UAAU,QAAQ,IAAI,WAAW;AAAA,QACjD,KAAK,EAAE,IAAI,aAAa,sBAAsB,GAAG;AAAA,QACjD,eAAY;AAAA;AAAA,MAEZ,gBAAAA,QAAA,cAAC,cAAS;AAAA,IACZ,CACF;AAAA,IACC,sBAAsB,KACrB,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,QAAQ;AAAA,UACR,GAAG;AAAA,UACH,gBAAgB;AAAA,UAChB,YAAY;AAAA,UACZ,UAAU;AAAA,UACV,KAAK;AAAA,UACL,OAAO;AAAA,UACP,cAAc;AAAA,UACd,YAAY;AAAA,QACd;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,cAAY,sBAAsB,KAAK,QAAQ,mBAAoB;AAAA,IACnF;AAAA,EAEJ;AAEJ;;;AClDA;AAAA,OAAOC,WAAS,YAAAC,YAAU,eAAAC,eAAa,YAAAC,kBAAgB;AACvD,SAAS,aAAa,YAAAC,kBAAgB;AACtC;AAAA,EAEE,eAAAC;AAAA,EAEA,4BAAAC;AAAA,EACA;AAAA,EACA,2BAAAC;AAAA,EACA,qBAAAC;AAAA,EACA;AAAA,EACA,qBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP;AAAA,EACE,WAAAC;AAAA,EACA;AAAA,EACA,kBAAAC;AAAA,EACA,aAAAC;AAAA,EACA,YAAAC;AAAA,EACA,cAAAC;AAAA,EACA,cAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA,oBAAAC;AAAA,OACK;;;AC3BP;AAAA,OAAOC,aAAW;AAClB,SAAS,aAAa,mCAAAC,kCAAiC,oBAAoB,eAAAC,qBAAmB;AAC9F,SAAS,4BAA4B;;;ACFrC;AAAA,IAAM,oBAAoB;AAAA,EACxB,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AACL;AACA,kBAAkB,EAAE,IAAI;AAKjB,IAAM,iBAAiB,qBAAmB;AAC/C,SAAO,kBAAkB,eAAe;AAC1C;AAUO,IAAM,WAAW,CAAC,UAAU,iBAAiB,cAAcC,WAAU;AAC1E,QAAM,kBAAkB,YAAY;AACpC,MAAI,CAAC,iBAAiB;AACpB,WAAO;AAAA,EACT;AACA,MAAI,mBAAmB,GAAG;AACxB,WAAOA,OAAM,OAAO;AAAA,EACtB,WAAW,mBAAmB,GAAG;AAC/B,WAAOA,OAAM,OAAO;AAAA,EACtB;AACA,SAAO;AACT;;;AD7BA,IAAM,UAAU,OAAO,QAAQ;AAAA,EAC7B,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,gBAAgB;AAAA,EAChB,cAAc;AAAA,EACd,UAAU;AAAA,IACR,QAAQ;AAAA,MACN,MAAM;AAAA,QACJ,OAAO;AAAA,QACP,QAAQ;AAAA,MACV;AAAA,IACF;AAAA,EACF;AACF,CAAC;AAEM,IAAM,sBAAsB,CAAC;AAAA,EAClC;AAAA,EACA,SAAS;AAAA,EACT,SAAS;AACX,MAIM;AAhCN,MAAAC;AAiCE,QAAM,mBAAkBA,MAAAC,cAAYC,iCAAgC,MAAM,CAAC,MAAnD,gBAAAF,IAAsD;AAC9E,QAAM,WAAWC,cAAY,mBAAmB,MAAM,CAAC;AACvD,QAAM,EAAE,OAAAE,OAAM,IAAI,SAAS;AAC3B,QAAM,eAAeA,OAAM,OAAO;AAClC,MAAI,oBAAoB,MAAM,oBAAoB,UAAa,aAAa,YAAY,KAAK;AAC3F,WAAO;AAAA,EACT;AACA,MAAI,oBAAoB,GAAG;AACzB,WACE,gBAAAC,QAAA,cAAC,WAAQ,MAAK,QAAO,OAAO,eAAe,eAAe,KACxD,gBAAAA,QAAA,cAAC,WAAQ,QAAgB,KAAK,EAAE,OAAO,UAAU,GAAG,eAAY,kBAC9D,gBAAAA,QAAA,cAAC,0BAAqB,CACxB,CACF;AAAA,EAEJ;AACA,QAAM,OAAO,SAAS,KAAK;AAC3B,SACE,gBAAAA,QAAA,cAAC,WAAQ,MAAK,QAAO,OAAO,eAAe,eAAe,KACxD,gBAAAA,QAAA,cAAC,WAAQ,QAAgB,eAAY,gBAAe,KAAK,EAAE,iBAAiB,SAAS,KAAK,kBAAkB,KAC1G,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,SAAQ;AAAA,MACR,OAAM;AAAA,MACN,UAAS;AAAA,MACT,OAAO;AAAA,QACL,UAAU;AAAA,QACV,UAAU;AAAA,QACV,gBAAgB;AAAA,QAChB,kBAAkB;AAAA,MACpB;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,GAAE;AAAA,QACF,MAAM,SAAS,GAAG,iBAAiB,cAAcD,MAAK;AAAA,QACtD,WAAU;AAAA;AAAA,IACZ;AAAA,IACA,gBAAAC,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,GAAE;AAAA,QACF,MAAM,SAAS,GAAG,iBAAiB,cAAcD,MAAK;AAAA,QACtD,WAAU;AAAA;AAAA,IACZ;AAAA,IACA,gBAAAC,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,GAAE;AAAA,QACF,MAAM,SAAS,GAAG,iBAAiB,cAAcD,MAAK;AAAA;AAAA,IACxD;AAAA,IACA,gBAAAC,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,GAAE;AAAA,QACF,MAAM,SAAS,GAAG,iBAAiB,cAAcD,MAAK;AAAA;AAAA,IACxD;AAAA,EACF,CACF,CACF;AAEJ;;;AExFA;AAAA,OAAOE,aAAW;AAClB,SAAoB,qBAAAC,oBAAmB,qBAAAC,qBAAmB,iBAAAC,iBAAe,eAAAC,qBAAmB;AAC5F,SAAS,oBAAAC,yBAAwB;AAM1B,IAAM,oBAAoB,CAAC,EAAE,OAAO,MAA6B;AARxE,MAAAC;AASE,QAAM,mBAAkBA,MAAAC,cAAYC,mBAAiB,MAA7B,gBAAAF,IAAgC;AACxD,QAAM,cAAcC,cAAYE,kBAAiB;AACjD,QAAM,UAAUC,gBAAc;AAE9B,MAAI,WAAW,eAAe,CAAC,iBAAiB;AAC9C,WAAO;AAAA,EACT;AACA,SACE,gBAAAC,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,KAAK,EAAE,OAAO,wBAAwB,IAAI,mBAAmB;AAAA,MAC7D,SAAS,MAAY;AACnB,YAAI;AACF,gBAAM,QAAQ,WAAW,QAAQ,EAAE;AAAA,QACrC,SAAS,OAAO;AACd,gBAAM,KAAK;AACX,uBAAa,SAAS,EAAE,OAAO,GAAG,SAAS,SAAS,QAAQ,CAAC;AAAA,QAC/D;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAACC,mBAAA,IAAiB;AAAA,IAClB,gBAAAD,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,OAAO,WAAW,YAAY,YAAY,KAAG,oBAEjF;AAAA,EACF;AAEJ;;;AClCA;AAAA,OAAOE,WAAS,aAAAC,mBAAiB;AACjC,SAAS,kBAAkB;AAC3B,SAAS,qBAAqB;AAC9B,SAAkB,mBAAmB,eAAAC,eAAa,gCAAgC;AAClF,SAAS,SAAS,kBAAkB,aAAAC,mBAAiB;;;ACJrD;AAAA,OAAOC,WAAS,YAAAC,kBAAgB;AAEhC,SAAS,SAAAC,cAAa;AACtB;AAAA,EAEE,qBAAAC;AAAA,EACA;AAAA,EACA,mBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP;AAAA,EACE,cAAAC;AAAA,EACA,aAAAC;AAAA,EACA,uBAAAC;AAAA,EACA;AAAA,EACA,oBAAAC;AAAA,EACA,gBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AAQP,IAAM,kBAAkB,EAAE,iBAAiB,oBAAoB,KAAK,MAAM,GAAG,KAAK;AAClF,IAAM,gBAAgB;AAAA,EACpB,YAAY;AAAA,EACZ,OAAO;AAAA,EACP,eAAe;AAAA,EACf,YAAY;AACd;AAEA,IAAM,kBAAkB,CAAC,EAAE,SAAS,MAAqC;AACvE,QAAM,CAAC,aAAa,cAAc,IAAIC,WAAS,KAAK;AACpD,MAAIC,QAAM,SAAS,QAAQ,QAAQ,EAAE,WAAW,GAAG;AACjD,WAAO;AAAA,EACT;AACA,SACE,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,MAAM,aAAa,cAAc,kBAC9C,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,eAAY;AAAA,MACZ,SAAS,OAAK,EAAE,gBAAgB;AAAA,MAChC,WAAU;AAAA,MACV,SAAO;AAAA,MACP,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,YAAY,cAAc,YAAY;AAAA,QACtC,WAAW;AAAA,UACT,GAAG;AAAA,QACL;AAAA,QACA,OAAO;AAAA,UACL,YAAY;AAAA,QACd;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,YACC,gBAAAA,QAAA,cAACC,mBAAA,IAAiB,CACpB;AAAA,EACF,GACA,gBAAAD,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,SAAS,OAAK,EAAE,gBAAgB;AAAA,MAChC,KAAK,EAAE,GAAG,eAAe,IAAI,oBAAoB,IAAI,EAAE;AAAA,MACvD,OAAM;AAAA;AAAA,IAEL;AAAA,EACH,CACF;AAEJ;AAEO,IAAM,cAAc,CAAC,EAAE,UAAU,SAAS,MAAiD;AAChG,QAAM,cAAcE,cAAYC,mBAAiB;AACjD,QAAM,aAAaC,gBAAc;AACjC,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,EAAE,eAAe,kBAAkB,CAAC,EAAE,KAAK,qCAAiD,iBAAgB,CAAC;AACnH,QAAM,0BAAyB,2CAAa,eAAc,aAAa;AACvE,QAAM,OAAOF,cAAY,qBAAqB,QAAQ,CAAC;AACvD,QAAM,SAASA,cAAYG,gBAAe;AAC1C,MAAI,CAAC,MAAM;AACT,WAAO;AAAA,EACT;AACA,QAAM,kBAAkB,KAAK,cAAc,QAAQ,SAAS,OAAO;AACnE,QAAM,kBAAkB,KAAK,cAAc,QAAQ,SAAS,OAAO;AAEnE,MAAI,wBAAwB;AAC5B,MAAI,wBAAwB;AAE5B,WAAS,QAAQ,UAAQ;AA5F3B,QAAAC,KAAAC;AA6FI,QAAI,KAAK,SAAS;AAChB;AAAA,IACF;AACA,UAAM,YAAY,CAAC,CAAC,KAAK,gBAAcD,MAAA,OAAO,KAAK,UAAU,MAAtB,gBAAAA,IAAyB;AAChE,UAAM,YAAY,CAAC,CAAC,KAAK,gBAAcC,MAAA,OAAO,KAAK,UAAU,MAAtB,gBAAAA,IAAyB;AAChE,4BAAwB,yBAAyB;AACjD,4BAAwB,yBAAyB;AAAA,EACnD,CAAC;AAED,QAAM,kBAAkB,CAAO,MAAyB,UAAU,UAAU;AAC1E,QAAI;AACF,YAAM,WAAW,uBAAuB,EAAE,OAAO,CAAC,QAAQ,GAAG,QAAQ,WAAW,MAAM,QAAQ,CAAC;AAAA,IACjG,SAAS,GAAG;AACV,cAAQ,MAAM,CAAC;AAAA,IACjB;AAAA,EACF;AAGA,QAAM,yBACJ,2CAAa,kBAAiB,kBAAkB,aAAY,mDAAiB,SAAS;AAExF,MACE,SAAS,WAAW;AAAA,EAEnB,SAAS,WAAW,KAAK,SAAS,CAAC,EAAE,WACtC,CAAC,MACD;AACA,WAAO;AAAA,EACT;AAEA,QAAM,qBAAqB,MAAM;AAC/B,aAAS,QAAQ,UAAQ;AACvB,YAAM,WAAW,YAAY,KAAK,QAAQ,EAAE;AAC5C,UAAI,UAAU;AACZ,mBAAW,iBAAiB,KAAK,IAAI,UAAU,IAAI;AAAA,MACrD;AAAA,IACF,CAAC;AAAA,EACH;AAEA,QAAM,sBAAsB,MAAY;AACtC,QAAI;AACF,eAAS,QAAQ,CAAM,SAAQ;AAC7B,cAAM,WAAW,WAAW,KAAK,IAAI,EAAE;AAAA,MACzC,EAAC;AAAA,IACH,SAAS,GAAG;AACV,cAAQ,MAAM,CAAC;AAAA,IACjB;AAAA,EACF;AAEA,SACE,gBAAAP,QAAA,cAAC,uBACE,yBACC,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,KAAK,iCAAK,kBAAL,EAAsB,cAAc,2BAA2B;AAAA,MACpE,SAAS;AAAA;AAAA,IAET,gBAAAA,QAAA,cAACQ,sBAAA,IAAoB;AAAA,IACrB,gBAAAR,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,iBAAe,uBAEvC;AAAA,EACF,IACE,MAEHS,OAAM,EAAE,iBAAiB,uBAAuB,SAAS,2CAAa,MAAM,WAAW,2CAAa,OAAO,CAAC,EAC1G,KAAK,EAAE,iBAAiB,MAAM,uBAAuB,MAAM,SAAS,KAAK,GAAG,MAAM;AACjF,WACE,gBAAAT,QAAA,cAAC,SAAS,MAAT,EAAc,KAAK,iBAAiB,SAAS,MAAM,gBAAgB,SAAS,KAAK,KAChF,gBAAAA,QAAA,cAACU,aAAA,IAAW,GACZ,gBAAAV,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,iBAAe,oBAEvC,CACF;AAAA,EAEJ,CAAC,EACA,KAAK,EAAE,iBAAiB,MAAM,uBAAuB,OAAO,WAAW,KAAK,GAAG,MAAM;AACpF,WACE,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,KAAK,iBAAiB,SAAS,MAAM,gBAAgB,SAAS,IAAI,KAC/E,gBAAAA,QAAA,cAACW,YAAA,IAAU,GACX,gBAAAX,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,iBAAe,iCAEvC,CACF;AAAA,EAEJ,CAAC,EACA,UAAU,MAAM,IAAI,GACtBS,OAAM,EAAE,iBAAiB,uBAAuB,SAAS,2CAAa,MAAM,WAAW,2CAAa,OAAO,CAAC,EAC1G,KAAK,EAAE,iBAAiB,MAAM,uBAAuB,MAAM,SAAS,KAAK,GAAG,MAAM;AACjF,WACE,gBAAAT,QAAA,cAAC,SAAS,MAAT,EAAc,KAAK,iBAAiB,SAAS,MAAM,gBAAgB,SAAS,KAAK,KAChF,gBAAAA,QAAA,cAACY,eAAA,IAAa,GACd,gBAAAZ,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,iBAAe,oBAEvC,CACF;AAAA,EAEJ,CAAC,EACA,KAAK,EAAE,iBAAiB,MAAM,uBAAuB,OAAO,WAAW,KAAK,GAAG,MAAM;AACpF,WACE,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,KAAK,iBAAiB,SAAS,MAAM,gBAAgB,SAAS,IAAI,KAC/E,gBAAAA,QAAA,cAACa,cAAA,IAAY,GACb,gBAAAb,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,iBAAe,iCAEvC,CACF;AAAA,EAEJ,CAAC,EACA,UAAU,MAAM,IAAI,GAEtB,wBACC,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,KAAK,iCAAK,kBAAL,EAAsB,WAAW,4BAA4B,OAAO,uBAAuB;AAAA,MAChG,SAAS;AAAA;AAAA,IAET,gBAAAA,QAAA,cAAC,oBAAe;AAAA,IAChB,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,iCAAK,gBAAL,EAAoB,OAAO,UAAU,MAAG,sBAEhE;AAAA,EACF,IACE,IACN;AAEJ;;;ACtNA;AAAA,SAAS,SAAAc,QAAO,KAAAC,UAAS;AACzB,SAAkB,qBAAAC,qBAAmB,iBAAAC,iBAAe,eAAAC,qBAAmB;AAGhE,IAAM,yBAAyB,CAAC,EAAE,MAAM,MAA4B;AAJ3E,MAAAC;AAKE,QAAM,aAAaC,gBAAc;AACjC,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM;AAAA,IACJ;AAAA,IACA;AAAA,IACA;AAAA,IACA,kBAAkB,CAAC;AAAA,IACnB,+BAA+B;AAAA,EACjC,IAAI,SAAS,gBAAgB,CAAC;AAC9B,QAAM,iBAAgBD,MAAAE,cAAYC,mBAAiB,MAA7B,gBAAAH,IAAgC;AAEtD,QAAM,oBAAoB,MAAM;AAAA,IAAO,UACrCI,OAAM,EAAE,eAAe,sBAAsB,UAAU,KAAK,SAAS,CAAC,EACnE;AAAA,MACC;AAAA,QACE,eAAeC,GAAE,KAAK,UAAQ,CAAC,CAAC,IAAI;AAAA,QACpC,sBAAsBA,GAAE,KAAK,WAAS,CAAC,CAAC,KAAK;AAAA,QAC7C,UAAUA,GAAE,KAAK,UAAQ,CAAC,CAAC,QAAQ,gBAAgB,SAAS,IAAI,CAAC;AAAA,MACnE;AAAA,MACA,MAAM;AAAA,IACR,EACC,UAAU,MAAM,KAAK;AAAA,EAC1B;AAEA,QAAM,gBAAgB,MAAY;AAChC,WAAO,QAAQ,IAAI,MAAM,IAAI,UAAQ,WAAW,oBAAoB,KAAK,EAAE,CAAC,CAAC;AAAA,EAC/E;AAEA,QAAM,kBAAkB,MAAM;AAC5B,QAAI,CAAC,iBAAiB,CAAC,eAAe;AACpC;AAAA,IACF;AACA,WAAO,QAAQ;AAAA,MACb,kBAAkB,IAAI,UAAQ;AAC5B,eAAO,WAAW,iBAAiB,KAAK,IAAI,eAAe,4BAA4B,EAAE,KAAK,MAAM;AAClG,iBAAO,+BAA+B,WAAW,oBAAoB,KAAK,EAAE,IAAI;AAAA,QAClF,CAAC;AAAA,MACH,CAAC;AAAA,IACH;AAAA,EACF;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA,iBAAiB,iBAAiB,kBAAkB,SAAS;AAAA,IAC7D;AAAA,IACA;AAAA,EACF;AACF;;;AFrCO,IAAM,aAAa;AAC1B,IAAM,aAAa;AAQZ,SAAS,QAAQ,OAAeC,OAAgB;AAzBvD,MAAAC;AA0BE,UAAOA,MAAAD,MAAK,SAAS,KAAK,MAAnB,gBAAAC,IAAsB;AAC/B;AAEO,IAAM,6BAA6BC,QAAM;AAAA,EAC9C,CAAC,EAAE,OAAO,MAAAF,OAAM,MAAM,MAAqE;AACzF,WACE,gBAAAE,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAKF,MAAK,SAAS,KAAK,EAAE;AAAA,QAC1B,MAAMA,MAAK,SAAS,KAAK;AAAA,QACzB,uBAAuBA,MAAK;AAAA,QAC5B,aAAaA,MAAK;AAAA,QAClB;AAAA;AAAA,IACF;AAAA,EAEJ;AACF;AAEO,IAAM,gBAAgB,CAAC;AAAA,EAC5B,WAAW,CAAC;AAAA,EACZ;AAAA,EACA;AAAA,EACA;AAAA,EACA,wBAAwB;AAAA,EACxB;AAAA,EACA;AACF,MAMM;AACJ,QAAM,CAAC,KAAK,EAAE,MAAM,CAAC,IAAI,WAA2B;AACpD,QAAM,cAAcG,cAAY,iBAAiB;AACjD,QAAM,EAAE,OAAO,OAAO,UAAU,IAAI,yBAAyB,EAAE,MAAM,UAAU,OAAO,GAAG,CAAC;AAC1F,QAAM,iBAAiB,YAAY,cAAc,SAAS,QAAQ;AAClE,MAAI,mBAAmB;AAEvB,MAAI,kBAAkB,aAAa;AACjC,uBAAmB;AACnB,QAAI,iCAAQ,QAAQ;AAClB,yBAAmB,iBAAiB,OAAO,UAAQ,KAAK,KAAK,YAAY,EAAE,SAAS,OAAO,UAAU,EAAE,CAAC;AAAA,IAC1G;AAAA,EACF;AACA,QAAM,EAAE,iBAAiB,sBAAsB,iBAAiB,cAAc,IAAI,uBAAuB;AAAA,IACvG,OAAO;AAAA,EACT,CAAC;AAED,EAAAC,YAAU,MAAM;AACd,QAAI,CAAC,kBAAkB,CAAC,aAAa;AACnC;AAAA,IACF;AACA,cAAU;AACV,UAAM,WAAW,YAAY,MAAM;AACjC,gBAAU;AAAA,IACZ,GAAG,UAAU;AACb,WAAO,MAAM,cAAc,QAAQ;AAAA,EACrC,GAAG,CAAC,gBAAgB,WAAW,CAAC;AAEhC,MAAI,iBAAiB,WAAW,KAAM,0BAAyB,iCAAQ,SAAS;AAC9E,WAAO;AAAA,EACT;AAEA,QAAM,SAAS,aAAa,iBAAiB;AAC7C,QAAM,UAAU,QAAQ,iBAAiB,UAAU,EAAC,iCAAQ;AAE5D,SACE,gBAAAF,QAAA,cAAC,UAAU,MAAV,EAAe,OAAO,UAAU,KAAK,EAAE,yBAAyB,EAAE,YAAY,UAAU,GAAG,IAAI,KAAK,GAAG,OACtG,gBAAAA,QAAA;AAAA,IAAC,UAAU;AAAA,IAAV;AAAA,MACC,WAAW,sBAAsB,QAAQ;AAAA,MACzC,YAAY,EAAE,GAAG,mBAAmB;AAAA,MACpC,KAAK;AAAA,QACH,eAAe;AAAA,QACf,GAAG;AAAA,QACH,UAAU;AAAA,QACV,YAAY;AAAA,QACZ,GAAG;AAAA,QACH,cAAc;AAAA,QACd,QAAQ;AAAA,QACR,wBAAwB;AAAA,UACtB,wBAAwB;AAAA,UACxB,yBAAyB;AAAA,QAC3B;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,WAAU,OAAM,UAAS,KAAK,EAAE,UAAU,GAAG,IAAI,KAAK,KAClE,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK,EAAE,YAAY,aAAa,eAAe,cAAc,OAAO,qBAAqB;AAAA;AAAA,MAExF;AAAA,MAAS;AAAA,MAAE,IAAI,kBAAkB,eAAe,iBAAiB,QAAQ,SAAS,MAAM,CAAC;AAAA,IAC5F,GACA,gBAAAA,QAAA,cAAC,eAAY,UAAoB,UAAU,kBAAkB,CAC/D;AAAA,EACF,GACA,gBAAAA,QAAA,cAAC,UAAU,SAAV,EAAkB,eAAe,EAAE,QAAQ,6BAA6B,WAAW,OAAO,KACzF,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,UAAU;AAAA,MACV,UAAU;AAAA,QACR,UAAU,wBACN,iBAAiB,KAAK,CAACG,IAAGC,OAAM;AAC9B,cAAI;AACF,kBAAM,gBAAgB,KAAK,MAAMD,GAAE,YAAY,IAAI,EAAE;AACrD,kBAAM,gBAAgB,KAAK,MAAMC,GAAE,YAAY,IAAI,EAAE;AACrD,mBAAO,gBAAgB;AAAA,UACzB,SAAS,KAAK;AACZ,mBAAO;AAAA,UACT;AAAA,QACF,CAAC,IACD;AAAA,QACJ;AAAA,QACA;AAAA,MACF;AAAA,MACA;AAAA,MACA,WAAW,iBAAiB;AAAA,MAC5B;AAAA,MACA;AAAA;AAAA,IAEC;AAAA,EACH,IACC,+CAAe,SAAS,cAAa,UACpC,gBAAAJ,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,OAAO;AAAA,QACP,GAAG;AAAA,QACH,WAAW;AAAA,MACb;AAAA,MACA,SAAS,MAAM,qCAAW;AAAA;AAAA,IAE1B,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,UAAU,KAAG,UAE9C;AAAA,IACA,gBAAAA,QAAA,cAAC,sBAAiB;AAAA,EACpB,IACE,MACH,yBAAyB,mBACxB,gBAAAA,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,uBAAkB,GACnB,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,QAAQ,GAAG,MAAM,KAAK,KAAK,GAAG,SAAQ,YACpD,gBAAAA,QAAA,cAAC,UAAO,SAAQ,YAAW,SAAS,eAAe,MAAI,MAAC,KAAK,EAAE,IAAI,KAAK,KACtE,gBAAAA,QAAA,cAACK,aAAA,IAAU,GAAE,kBACf,GAEA,gBAAAL,QAAA,cAAC,UAAO,SAAS,iBAAiB,MAAI,MAAC,KAAK,EAAE,IAAI,KAAK,KACrD,gBAAAA,QAAA,cAAC,aAAQ,GAAE,KAAE,oBACf,CACF,CACF,CAEJ,CACF;AAEJ;;;AGtLA;AAAA,SAAS,aAAAM,mBAAiB;AAE1B,SAAS,iBAAAC,gBAAe,eAAAC,qBAAmB;AAOpC,IAAM,iCAAiC,CAC5C,WACA,mBACG;AACH,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,WAAWC,cAAYC,eAAc,SAAS,QAAQ,CAAC;AAC7D,QAAM,gBAAgB,iBAAiB;AACvC,EAAAC,YAAU,MAAM;AACd,QAAI,aAAa,kBAAkB,EAAC,qCAAW,aAAY;AACzD,oBAAc;AAAA,IAChB;AAAA,EACF,GAAG,CAAC,UAAU,qCAAW,YAAY,eAAe,UAAU,WAAW,cAAc,CAAC;AAC1F;;;ACrBA;AAAA,SAAS,YAAAC,kBAAgB;AACzB,SAAS,sBAAAC,qBAAoB,qBAAAC,qBAAmB,iBAAAC,iBAAe,eAAAC,qBAAmB;AAG3E,IAAM,wBAAwB,CAAC,EAAE,QAAQ,KAAK,MAAwC;AAJ7F,MAAAC,KAAAC;AAKE,QAAM,aAAaC,gBAAc;AACjC,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM;AAAA,IACJ;AAAA,IACA;AAAA,IACA;AAAA,IACA,kBAAkB,CAAC;AAAA,IACnB,+BAA+B;AAAA,EACjC,IAAI,SAAS,gBAAgB,CAAC;AAC9B,QAAM,YAAY,SAAS;AAC3B,QAAM,iBAAgBF,MAAAG,cAAYC,mBAAiB,MAA7B,gBAAAJ,IAAgC;AACtD,QAAM,4BACJ,kBACE,aAAa,4BAA6B,mDAAiB,SAAS,UAAS;AACjF,QAAM,YAAWC,MAAAE,cAAYE,oBAAmB,MAAM,CAAC,MAAtC,gBAAAJ,IAAyC;AAC1D,QAAM,CAAC,MAAM,OAAO,IAAIK,WAAS,KAAK;AAEtC,QAAM,gBAAgB,MAAY;AAChC,UAAM,WAAW,oBAAoB,MAAM;AAAA,EAC7C;AAEA,QAAM,oBAAoB,MAAY;AACpC,QAAI,WAAW;AACb,kBAAY,WAAW,iBAAiB,QAAQ,UAAU,IAAI;AAAA,IAChE,WAAW,eAAe;AACxB,YAAM,WAAW,iBAAiB,QAAQ,eAAe,4BAA4B;AACrF,UAAI,8BAA8B;AAChC,cAAM,cAAc;AAAA,MACtB;AAAA,IACF;AACA,YAAQ,KAAK;AAAA,EACf;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;;;ARHO,IAAM,kBAAkB,CAAC;AAAA,EAC9B,gBAAgB,CAAC;AAAA,EACjB;AACF,MAGM;AACJ,QAAM,CAAC,QAAQ,SAAS,IAAIC,WAA0C;AACtE,QAAM,EAAE,cAAc,aAAa,UAAU,IAAI,gBAAgB,MAAM;AACvE,QAAM,cAAcC,cAAYC,kBAAiB;AACjD,QAAM,sBAAiD,CAAC;AAExD,QAAM,kBAAkBD,cAAY,qBAAqB;AAEzD,eAAa,QAAQ,iBAAe;AAClC,QAAI,YAAY,UAAU;AACxB,UAAI,oBAAoB,YAAY,QAAQ,MAAM,QAAW;AAC3D,4BAAoB,YAAY,QAAQ,IAAI,CAAC;AAAA,MAC/C;AACA,0BAAoB,YAAY,QAAQ,EAAE,KAAK,WAAW;AAAA,IAC5D;AAAA,EACF,CAAC;AAGD,MAAI,aAAa;AACf,kBAAc,QAAQ,UAAQ;AAC5B,UAAI,CAAC,oBAAoB,IAAI,GAAG;AAC9B,4BAAoB,IAAI,IAAI,CAAC;AAAA,MAC/B;AAAA,IACF,CAAC;AAAA,EACH;AAEA,iCAA+B,oBAAoB,kBAAkB,YAAY;AAEjF,QAAM,WAAWE,cAAY,CAAC,UAAkB;AAC9C,cAAU,iBAAe;AACvB,UAAI,CAAC,aAAa;AAChB,sBAAc,CAAC;AAAA,MACjB;AACA,kBAAY,SAAS,MAAM,YAAY;AACvC,aAAO,mBAAK;AAAA,IACd,CAAC;AAAA,EACH,GAAG,CAAC,CAAC;AAEL,MAAI,cAAc,GAAG;AACnB,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,QAAA,cAACC,YAAA,MACC,gBAAAD,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,KAAK;AAAA,QACH,MAAM;AAAA,QACN,KAAK;AAAA,MACP;AAAA;AAAA,IAEC,EAAC,iCAAQ,WAAU,aAAa,WAAW,IAAI,OAAO,gBAAAA,QAAA,cAAC,qBAAkB,UAAoB,YAAU,MAAC;AAAA,IACzG,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC;AAAA,QACA,gBAAgB;AAAA,QAChB,aAAa,CAAC,CAAC;AAAA,QACf;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA;AAAA,MAEC,aAAa,WAAW,IACvB,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAM;AAAA,UACN,SAAQ;AAAA,UACR,WAAU;AAAA,UACV,KAAK,EAAE,GAAG,QAAQ,GAAG,QAAQ,SAAS,OAAO;AAAA;AAAA,QAE7C,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAM,CAAC,SAAS,oBAAoB,0BAA2B;AAAA,MAC/E,IACE;AAAA,IACN;AAAA,EACF,CACF;AAEJ;AAEO,IAAM,mBAAmB,MAAM;AACpC,QAAM,YAAYH,cAAYK,gBAAe;AAC7C,QAAM,iBAAiB,kBAAkB,kBAAkB,YAAY;AACvE,QAAM,iBAAiB,sBAAsB,kBAAkB,YAAY;AAE3E,MAAI,cAAc,GAAG;AACnB,WAAO;AAAA,EACT;AACA,SACE,gBAAAF,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,IAAI,iBAAiB,sBAAsB;AAAA,MAC7C;AAAA,MACA,SAAS,MAAM;AACb,YAAI,YAAY,GAAG;AACjB,yBAAe;AAAA,QACjB;AAAA,MACF;AAAA,MACA,eAAY;AAAA;AAAA,IAEZ,gBAAAA,QAAA,cAACG,aAAA,IAAW;AAAA,IACZ,gBAAAH,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,GAAG,UAAU,KAC9C,kBAAkB,SAAS,CAC9B;AAAA,EACF;AAEJ;AAEO,IAAM,cAAc,CAAC;AAAA,EAC1B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAKM;AACJ,QAAM,cAAcH,cAAYO,kBAAiB;AACjD,SACE,gBAAAJ,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,KAAK;AAAA,MACV,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,IAAI;AAAA,QACJ,GAAG;AAAA,QACH,6BAA6B,EAAE,SAAS,OAAO;AAAA,MACjD;AAAA,MACA,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,eAAa,iBAAiB,KAAK;AAAA,MACnC;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK,iCAAK,aAAa,MAAM,IAAxB,EAA2B,MAAM,SAAS,IAAI,MAAM,YAAY,aAAa,OAAO,mBAAmB;AAAA;AAAA,MAE3G,KAAK;AAAA,MAAK;AAAA,MAAE,gBAAgB,KAAK,KAAK,UAAU;AAAA,IACnD;AAAA,IACC,eAAe,KAAK,WACnB,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,QAAQ,KAAK;AAAA,QACb,UAAU,KAAK;AAAA,QACf,MAAM,KAAK;AAAA,QACX;AAAA;AAAA,IACF,IACE;AAAA,EACN;AAEJ;AAEA,IAAM,0BAA0B,CAAC;AAAA,EAC/B,sBAAsB,CAAC;AAAA,EACvB;AAAA,EACA;AAAA,EACA,iBAAiB,CAAC;AAAA,EAClB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MASM;AACJ,SACE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,KAAK;AAAA,QACH,KAAK;AAAA,QACL,WAAW;AAAA,QACX,WAAW;AAAA,QACX,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,sCAAsC;AAAA,UACpC,SAAS;AAAA,QACX;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,UAAU,MAAV,EAAe,MAAM,cAAc,WAAW,YAAY,aAAW,QACnE,eAAe,SAAS,IACvB,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,UAAU;AAAA,QACV,UAAS;AAAA,QACT;AAAA,QACA;AAAA,QACA,uBAAqB;AAAA,QACrB;AAAA;AAAA,IACF,IACE,MACH,OAAO,KAAK,mBAAmB,EAAE,IAAI,UACpC,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,QACL,UAAU,oBAAoB,IAAI;AAAA,QAClC,UAAU;AAAA,QACV;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA;AAAA,IACF,CACD,CACH;AAAA,IACC;AAAA,EACH;AAEJ;AAKA,IAAM,qBAAqBA,QAAM;AAAA,EAC/B,CAAC;AAAA,IACC;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,MAKM;AAxRR,QAAAK,KAAAC;AAyRI,UAAM,eAAeT,cAAYU,yBAAwB,MAAM,CAAC;AAChE,UAAM,iBAAgBF,MAAAR,cAAYW,mBAAiB,MAA7B,gBAAAH,IAAgC;AACtD,UAAM,mBAAkBC,MAAAT,cAAYW,mBAAiB,MAA7B,gBAAAF,IAAgC;AACxD,UAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,UAAM,EAAE,aAAa,IAAI,YAAY,CAAC;AACtC,UAAM,wBAAyB,gBAAgB,iBAAkB;AACjE,UAAM,eAAe,CAACT,cAAY,yBAAyB,MAAM,CAAC;AAElE,WACE,gBAAAG,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,KAAK;AAAA,UACH,YAAY;AAAA,UACZ,KAAK;AAAA,QACP;AAAA;AAAA,MAEC,wBACC,gBAAAA,QAAA,cAAC,yCAAsC,QAAgB,MAAY,IAEnE,gBAAAA,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,uBAAoB,QAAgB,GACpC,aAAaS,aAAY,OACxB,gBAAAT,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAM;AAAA,UACN,SAAQ;AAAA,UACR,KAAK,EAAE,GAAG,MAAM,GAAG,oBAAoB,IAAI,mBAAmB,cAAc,SAAS;AAAA;AAAA,QAErF,gBAAAA,QAAA,cAAC,YAAS,OAAO,IAAI,QAAQ,IAAI;AAAA,MACnC,GAED,gBACC,gBAAAA,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAM;AAAA,UACN,SAAQ;AAAA,UACR,KAAK,EAAE,GAAG,MAAM,GAAG,oBAAoB,IAAI,mBAAmB,cAAc,SAAS;AAAA;AAAA,QAErF,gBAAAA,QAAA,cAACU,WAAA,EAAS,QAAQ,IAAI,OAAO,IAAI;AAAA,MACnC,GAED,eACC,gBAAAV,QAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAM;AAAA,UACN,SAAQ;AAAA,UACR,KAAK,EAAE,GAAG,MAAM,GAAG,oBAAoB,IAAI,mBAAmB,cAAc,SAAS;AAAA;AAAA,QAErF,gBAAAA,QAAA,cAACW,aAAA,EAAW,QAAQ,IAAI,OAAO,IAAI;AAAA,MACrC,IACE,MAEH,wBAAwB,gBAAAX,QAAA,cAAC,0BAAuB,QAAgB,MAAY,IAAK,IACpF;AAAA,IAEJ;AAAA,EAEJ;AACF;AAEA,IAAM,mBAAmB,EAAE,GAAG,MAAM,cAAc,SAAS;AAC3D,IAAM,wCAAwC,CAAC,EAAE,QAAQ,KAAK,MAAwC;AACpG,QAAM,EAAE,mBAAmB,eAAe,2BAA2B,UAAU,IAAI,sBAAsB;AAAA,IACvG;AAAA,IACA;AAAA,EACF,CAAC;AACD,MAAI,CAAC,2BAA2B;AAC9B,WAAO;AAAA,EACT;AACA,SACE,gBAAAA,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,UAAO,SAAQ,YAAW,KAAK,kBAAkB,SAAS,iBACzD,gBAAAA,QAAA,cAACY,aAAA,EAAU,QAAQ,IAAI,OAAO,IAAI,CACpC,GACC,CAAC,aACA,gBAAAZ,QAAA,cAAC,UAAO,SAAQ,WAAU,SAAS,mBAAmB,KAAK,oBACzD,gBAAAA,QAAA,cAACa,UAAA,EAAQ,QAAQ,IAAI,OAAO,IAAI,CAClC,CAEJ;AAEJ;AAEA,IAAM,yBAAyB,CAAC,EAAE,QAAQ,KAAK,MAAwC;AAzWvF,MAAAR;AA0WE,QAAM;AAAA,IACJ;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,IAAI,sBAAsB,EAAE,QAAQ,KAAK,CAAC;AAC1C,QAAM,gBAAgB,CAAC,GAACA,MAAAR,cAAYW,mBAAiB,MAA7B,gBAAAH,IAAgC;AACxD,QAAM,CAAC,qBAAqB,sBAAsB,IAAIT,WAAS,KAAK;AACpE,QAAM,QAAQC,cAAYiB,yBAAwB;AAElD,SACE,gBAAAd,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,MAAY,cAAc,WAAS,QAAQ,KAAK,GAAG,OAAO,SACvE,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,SAAO;AAAA,MACP,eAAY;AAAA,MACZ,WAAU;AAAA,MACV,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,SAAS,OAAO,SAAS;AAAA,QACzB,WAAW;AAAA,UACT,IAAI;AAAA,QACN;AAAA,QACA,OAAO;AAAA,UACL,SAAS;AAAA,QACX;AAAA,MACF;AAAA,MACA,UAAU;AAAA;AAAA,IAEV,gBAAAA,QAAA,cAAC,OAAI,KAAK,EAAE,IAAI,OAAO,KACrB,gBAAAA,QAAA,cAACe,mBAAA,IAAiB,CACpB;AAAA,EACF,GACA,gBAAAf,QAAA,cAAC,SAAS,QAAT,MACC,gBAAAA,QAAA,cAAC,SAAS,SAAT,EAAiB,OAAM,OAAM,YAAY,GAAG,KAAK,EAAE,GAAG,OAAO,IAAI,mBAAmB,KAClF,4BACC,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,KAAK,EAAE,IAAI,mBAAmB,GAAG,SAAS,MAAM,kBAAkB,KAC/E,gBAAAA,QAAA,cAACgB,iBAAA,IAAe,GAChB,gBAAAhB,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,YAAY,aAAa,GAAG,mBAAmB,KAChF,YAAY,0BAA0B,oBACzC,CACF,IACE,MAEH,iBAAiB,MAAM,SAAS,IAC/B,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,KAAK,EAAE,IAAI,mBAAmB,GAAG,SAAS,MAAM,uBAAuB,IAAI,KACxF,gBAAAA,QAAA,cAAC,wBAAmB,GACpB,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,YAAY,aAAa,GAAG,mBAAmB,KAAG,aAEtF,CACF,IACE,MACJ,gBAAAA,QAAA,cAAC,qBAAkB,QAAgB,CACrC,CACF,CACF,GACC,uBAAuB,gBAAAA,QAAA,cAAC,mBAAgB,QAAgB,cAAc,wBAAwB,CACjG;AAEJ;AAEO,IAAM,oBAAoB,CAAC;AAAA,EAChC;AAAA,EACA,cAAc;AAAA,EACd,aAAa;AACf,MAIM;AACJ,QAAM,CAAC,OAAO,QAAQ,IAAIA,QAAM,SAAS,EAAE;AAC3C,QAAM,WAAWiB,WAAS,OAAU,MAAM,EAAE;AAE5C;AAAA,IACE,MAAM;AACJ,eAAS,KAAK;AAAA,IAChB;AAAA,IACA;AAAA,IACA,CAAC,OAAO,QAAQ;AAAA,EAClB;AAEA,SACE,gBAAAjB,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,GAAG,WAAW,MAAM;AAAA,QACpB,IAAI;AAAA,QACJ,UAAU;AAAA,QACV,OAAO;AAAA,QACP,IAAI,aAAa,OAAO;AAAA,MAC1B;AAAA,MACA,SAAS,OAAK,EAAE,gBAAgB;AAAA;AAAA,IAEhC,gBAAAA,QAAA,cAAC,cAAW,OAAO,EAAE,UAAU,YAAY,MAAM,SAAS,GAAG;AAAA,IAC7D,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,MAAK;AAAA,QACL;AAAA,QACA,KAAK,EAAE,GAAG,QAAQ,GAAG,MAAM,IAAI,OAAO,IAAI,aAAa,qBAAqB,eAAe;AAAA,QAC3F;AAAA,QACA,WAAW,WAAS;AAClB,gBAAM,gBAAgB;AAAA,QACxB;AAAA,QACA,UAAU,WAAS;AACjB,mBAAS,MAAM,cAAc,KAAK;AAAA,QACpC;AAAA,QACA,cAAa;AAAA,QACb,qBAAkB;AAAA;AAAA,IACpB;AAAA,EACF;AAEJ;;;AS7dA;AAAA,OAAOkB,WAAS,aAAAC,mBAAiB;AACjC,SAAS,kBAAAC,iBAAgB,YAAAC,iBAAgB;AAUlC,IAAM,cAAc,MAAM;AAC/B,QAAM,cAAc,sBAAsB,kBAAkB,KAAK;AACjE,QAAM,iBAAiB,kBAAkB;AACzC,QAAM,EAAE,gBAAgB,kBAAkB,IAAI,yBAAyB;AAEvE,EAAAC,YAAU,MAAM;AACd,QAAI,kBAAkB,aAAa;AACjC,wBAAkB,KAAK;AAAA,IACzB;AAAA,EACF,GAAG,CAAC,aAAa,gBAAgB,iBAAiB,CAAC;AAEnD,SACE,gBAAAC,QAAA,cAAC,WAAQ,KAAI,SAAQ,OAAO,GAAG,cAAc,UAAU,MAAM,wBAC3D,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS,MAAM;AACb,uBAAe;AACf,0BAAkB,KAAK;AAAA,MACzB;AAAA,MACA,KAAK,EAAE,IAAI,cAAc,sBAAsB,GAAG;AAAA,MAClD,eAAY;AAAA;AAAA,IAEX,iBAAiB,gBAAAA,QAAA,cAACC,iBAAA,IAAe,IAAK,gBAAAD,QAAA,cAACE,WAAA,IAAS;AAAA,EACnD,CACF;AAEJ;;;ACpCA;AAAA,OAAOC,aAAW;AAClB,SAAS,yBAAyB,eAAAC,eAAa,qBAAqB;AACpE,SAAS,sBAAsB;AAOxB,IAAM,mBAAmB,MAAM;AACpC,QAAM,EAAE,QAAQ,MAAM,QAAQ,IAAI,cAAc;AAChD,QAAM,cAAcC,cAAY,uBAAuB;AACvD,QAAM,WAAW,CAAC,CAAC,eAAgB,QAAQ,CAAC;AAE5C,MAAI,CAAC,QAAQ;AACX,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAI;AAAA,MACJ,OACE,cAAc,wDAAwD,GAAG,OAAO,UAAU,MAAM;AAAA;AAAA,IAGlG,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS,MAAY;AACnB,cAAI,UAAU;AACZ;AAAA,UACF;AACA,cAAI;AACF,kBAAM,OAAO;AAAA,UACf,SAAS,OAAO;AACd,yBAAa,SAAS,EAAE,OAAQ,MAAgB,SAAS,SAAS,QAAQ,CAAC;AAAA,UAC7E;AAAA,QACF;AAAA,QACA,QAAQ,CAAC;AAAA,QACT;AAAA,QACA,eAAY;AAAA;AAAA,MAEZ,gBAAAA,QAAA,cAAC,oBAAe;AAAA,IAClB;AAAA,EACF;AAEJ;;;AvQZO,IAAMC,UAAS,CAAC;AAAA,EACrB;AAAA,EACA;AACF,MAGM;AAtCN,MAAAC,KAAAC;AAuCE,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,gBAAgB,CAAC,GAACF,MAAA,qCAAU,SAAV,gBAAAA,IAAgB;AACxC,QAAM,kBAAgBC,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,mBAAkB,eAAe;AAEvE,QAAM,aAAa,sBAAsB,kBAAkB,IAAI;AAC/D,QAAM,aAAa,kBAAkB,kBAAkB,IAAI;AAC3D,QAAM,EAAE,UAAU,IAAI,aAAa;AAEnC,EAAAE,YAAU,MAAM;AACd,QAAI,CAAC,cAAc,eAAe;AAChC,iBAAW;AAAA,IACb;AAAA,EAEF,GAAG,CAAC,YAAY,aAAa,CAAC;AAE9B,SACE,gBAAAC,QAAA;AAAA,IAAC,OAAU;AAAA,IAAV;AAAA,MACC,KAAK;AAAA,QACH,UAAU;AAAA,QACV,OAAO;AAAA,UACL,gBAAgB;AAAA,UAChB,KAAK;AAAA,UACL,UAAU;AAAA;AAAA,UAEV,QAAQ,iBAAiB,aAAa,KAAK;AAAA,QAC7C;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC,OAAU;AAAA,MAAV;AAAA,QACC,KAAK;AAAA,UACH,OAAO;AAAA,YACL,GAAG;AAAA,YACH,GAAG;AAAA,YACH,KAAK;AAAA,UACP;AAAA,QACF;AAAA;AAAA,MAEC,WAAW,gBAAAA,QAAA,cAAC,aAAU,YAAwB,IAAK;AAAA,MACpD,gBAAAA,QAAA,cAAC,sBAAiB;AAAA,MACjB,CAAC,YAAY,SAAS,qBAAqB,gBAAAA,QAAA,cAAC,cAAS,IAAK;AAAA,IAC7D;AAAA,IACA,gBAAAA,QAAA;AAAA,MAAC,OAAU;AAAA,MAAV;AAAA,QACC,KAAK;AAAA,UACH,OAAO;AAAA,YACL,GAAG;AAAA,YACH,KAAK;AAAA,UACP;AAAA,QACF;AAAA;AAAA,MAEC,WACC,gBAAAA,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,uBAAkB,GACnB,gBAAAA,QAAA,cAAC,eAAU,IACV,qCAAU,SAAQ,gBAAAA,QAAA,cAAC,gBAAW,GAC/B,gBAAAA,QAAA,cAAC,gBAAa,UAAoB,YAAwB,CAC5D,IAEA,gBAAAA,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,uBAAkB,GACnB,gBAAAA,QAAA,cAAC,eAAU,GACV,eAAe,wBAAwB,gBAAAA,QAAA,cAAC,iBAAY,IACpD,qCAAU,oBAAmB,gBAAAA,QAAA,cAAC,mBAAc,GAC7C,gBAAAA,QAAA,cAAC,aAAU,YAAwB,CACrC;AAAA,IAEJ;AAAA,IACA,gBAAAA,QAAA,cAAC,OAAU,OAAV,MACC,gBAAAA,QAAA,cAAC,sBAAiB,GACjB,aAAa,gBAAAA,QAAA,cAAC,iBAAY,GAC1B,CAAC,aAAY,qCAAU,SAAQ,gBAAAA,QAAA,cAAC,gBAAW,IAC3C,qCAAU,qBAAoB,gBAAAA,QAAA,cAAC,sBAAiB,GACjD,gBAAAA,QAAA,cAAC,gBAAa,UAAoB,YAAwB,CAC5D;AAAA,EACF;AAEJ;;;AwQlHA;AAAA,OAAOC,WAAS,eAAAC,eAAa,YAAAC,kBAAgB;AAC7C,SAAS,kBAAAC,iBAAgB,iBAAAC,iBAAe,eAAAC,eAAa,yBAAAC,8BAA6B;AAU3E,SAAS,kBAAkB;AAChC,QAAM,WAAWC,cAAYC,eAAc,EAAE,SAAS;AACtD,QAAM,CAAC,WAAW,YAAY,IAAIC,WAAS,CAAC,CAAC,QAAQ;AACrD,QAAM,aAAaC,gBAAc;AACjC,QAAM,EAAE,cAAc,IAAIC,uBAAsB;AAChD,QAAM,CAAC,cAAc,aAAa,IAAI,mBAAmB,SAAS,UAAU;AAC5E,QAAM,WAAWC,cAAY,MAAY;AACvC,QAAI;AACF,UAAI,gBAAgB,eAAe;AACjC;AAAA,MACF;AACA,oBAAc,IAAI;AAClB,YAAM,WAAW,kBAAkB,CAAC,CAAC;AAAA,IACvC,SAAS,OAAO;AACd,cAAQ,MAAM,KAAK;AACnB,oBAAc,KAAK;AAAA,IACrB;AAAA,EACF,IAAG,CAAC,YAAY,cAAc,eAAe,aAAa,CAAC;AAE3D,SAAO,WACL,gBAAAC,QAAA;AAAA,IAAC,OAAO;AAAA,IAAP;AAAA,MACC,MAAM;AAAA,MACN,cAAc,WAAS;AACrB,YAAI,CAAC,OAAO;AACV,uBAAa,KAAK;AAAA,QACpB;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA,cAAC,OAAO,SAAP,EAAe,KAAK,EAAE,GAAG,kBAAkB,KAC1C,gBAAAA,QAAA;AAAA,MAAC,OAAO;AAAA,MAAP;AAAA,QACC,KAAK;AAAA,UACH,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,cAAc;AAAA,UACd,IAAI;AAAA,QACN;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,YAAY,YAAY,KAAG,mBAErD;AAAA,IACF,GACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,OAAO,OAAO,qBAAqB,KAAG,wEAEpE,GACA,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,WAAU,KAAK,EAAE,GAAG,QAAQ,KAAK,KAAK,KACjE,gBAAAA,QAAA,cAAC,UAAO,UAAQ,MAAC,SAAQ,YAAW,KAAK,EAAE,GAAG,OAAO,GAAG,SAAS,MAAM,aAAa,KAAK,KAAG,SAE5F,GACA,gBAAAA,QAAA,cAAC,UAAO,KAAK,EAAE,GAAG,OAAO,GAAG,SAAS,YAAU,SAE/C,CACF,CACF,CACF;AAAA,EACF,IACE;AACN;;;ACtEA;AAAA,OAAOC,YAAS,aAAAC,mBAAiB;AACjC;AAAA,EACE;AAAA,EACA,uBAAAC;AAAA,EACA,2BAAAC;AAAA,EACA;AAAA,EACA,kBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;;;ACTP;AAAA,OAAOC,YAAS,YAAAC,YAAU,eAAAC,eAAa,aAAAC,aAAW,WAAAC,WAAS,YAAAC,kBAAgB;AAC3E,SAAS,cAAAC,aAAY,YAAAC,kBAAgB;AACrC;AAAA,EACE,gBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,6BAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,mBAAAC;AAAA,EACA;AAAA,EACA,yBAAAC;AAAA,OACK;AACP,SAAS,cAAAC,aAAY,gBAAAC,qBAAoB;;;ACjBzC;AAAA,OAAOC,YAAS,aAAAC,mBAAiB;AACjC,SAAS,YAAAC,kBAAgB;AACzB,SAAS,SAAAC,eAAa;AACtB,SAAS,iBAAAC,gBAAe,4BAAAC,2BAA0B,eAAAC,qBAAmB;;;ACHrE;AAAA,OAAOC,cAAW;;;ACAlB;AAAA,OAAOC,WAAS,aAAAC,aAAW,WAAAC,UAAS,UAAAC,UAAQ,YAAAC,kBAAgB;AAC5D;AAAA,EAEE,2BAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,cAAc,iBAAiB;;;ACTxC;AAAA,OAAOC,aAAW;AAClB,SAAS,qBAAAC,qBAAmB,eAAAC,qBAAmB;AAC/C,SAAS,mBAAAC,kBAAiB,oBAAAC,mBAAkB,aAAAC,aAAW,cAAAC,mBAAkB;AAqClE,IAAM,gBAAgB,CAAC,EAAE,QAAQ,SAAS,QAAQ,IAAI,QAAQ,MAAM;AACzE,SACE,gBAAAC,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,EAAE,GAAG,QAAQ,IAAI,MAAM,IAAI,OAAO,QAAQ,WAAW,cAAc,4BAA4B,IAAI,KAAK;AAAA;AAAA,IAE5G,SACC,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,KAAK;AAAA,UACH,IAAI;AAAA,UACJ,OAAO;AAAA,QACT;AAAA,QACA,SAAS;AAAA,QACT,eAAY;AAAA;AAAA,MAEZ,gBAAAA,QAAA,cAACC,kBAAA,IAAgB;AAAA,IACnB,IACE;AAAA,IACJ,gBAAAD,QAAA,cAAC,OAAI,KAAK,EAAE,MAAM,SAAS,SAAS,QAAQ,YAAY,SAAS,KAC9D,QACC,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,eAAe;AAAA,UACf,YAAY;AAAA,UACZ,OAAO;AAAA,QACT;AAAA;AAAA,MAEC;AAAA,IACH,IACE,MACJ,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAM,OAAQ,CAC9B;AAAA,IACC,UACC,gBAAAA,QAAA,cAAC,cAAW,SAAS,SAAS,KAAK,EAAE,WAAW,aAAa,GAAG,eAAY,0BAC1E,gBAAAA,QAAA,cAACE,aAAA,IAAU,CACb,IACE;AAAA,EACN;AAEJ;AACO,IAAMC,aAAY,CAAC,EAAE,UAAU,UAAU,MAAM,MAAM;AAC1D,SACE,gBAAAH,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,MAAM;AAAA,QACN,QAAQ;AAAA,QACR,UAAU;AAAA,QACV,KAAK;AAAA,QACL,MAAM;AAAA,QACN,IAAI;AAAA,QACJ,WAAW;AAAA,QACX,WAAW,GAAG,iBAAiB,KAAK,CAAC;AAAA,QACrC,SAAS;AAAA,QACT,eAAe;AAAA,QACf,cAAc,UAAU,OAAO;AAAA,MACjC;AAAA;AAAA,IAEC;AAAA,EACH;AAEJ;AAiCO,IAAM,YAAY,CAAC,EAAE,MAAM,MAAM;AACtC,MAAI,CAAC,OAAO;AACV,WAAO;AAAA,EACT;AACA,SACE,gBAAAI,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,OAAO,uBAAuB,KAC/D,KACH;AAEJ;;;AC9IA;AAAA,OAAOC,aAAW;AAKlB,IAAM,YAA6C;AAAA,EACjD;AAAA,EACA;AAAA,EACA;AACF;AAEO,IAAM,kBAAkB,CAAC,EAAE,OAAO,MAAiC;AACxE,MAAI,CAAC;AAAQ,WAAO;AACpB,SACE,gBAAAC,QAAA,cAAC,QAAK,OAAM,YACV,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,iBAAiB,UAAU,MAAM,0BAAuB,yBAAyB;AAAA,QACjF,GAAG;AAAA,QACH,cAAc;AAAA,MAChB;AAAA;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,YAAY;AAAA,UACZ,OAAO;AAAA,QACT;AAAA;AAAA,MAEC,UAAU,MAAM;AAAA,IACnB;AAAA,EACF,CACF;AAEJ;;;AFZO,IAAM,gBAAgB,MAAM;AACjC,QAAM,iBAAiB,kBAAkB;AACzC,QAAM,cAAcC,cAAYC,mBAAiB;AAEjD,SACE,gBAAAC,QAAA,cAACC,YAAA,EAAU,SAAO,QAChB,gBAAAD,QAAA,cAAC,iBAAc,SAAQ,qBAAoB,SAAS,gBAAgB,GACpE,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,IAAI,OAAO,IAAI,OAAO,WAAW,OAAO,MACrE,2CAAa,cAAa,gBAAAA,QAAA,cAAC,aAAQ,GACpC,gBAAAA,QAAA,cAAC,cAAS,CACZ,CACF;AAEJ;AAEA,SAAS,yBAAyB;AAAA,EAChC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,GAKG;AACD,QAAM,oBAAoB,SAAS,qCAAqC;AACxE,SACE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,KAAK;AAAA,QACH,QAAQ;AAAA,QACR,GAAG;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,QAAQ;AAAA,MACV;AAAA,MACA,OAAM;AAAA;AAAA,IAEN,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,QAAQ;AAAA,UACR,GAAG;AAAA,UACH,IAAI;AAAA,UACJ,GAAG;AAAA,UACH,GAAG;AAAA,QACL;AAAA;AAAA,MAEC;AAAA,IACH;AAAA,IACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAO,KAAK,EAAE,IAAI,MAAM,KACnC,KACH;AAAA,EACF;AAEJ;AAEA,IAAM,UAAU,MAAM;AACpB,QAAM,UAAUE,gBAAc;AAC9B,QAAM,CAAC,OAAO,QAAQ,IAAIC,WAAS,EAAE;AACrC,QAAM,oBAAoBL,cAAYM,wBAAuB;AAC7D,QAAM,CAAC,eAAe,gBAAgB,IAAID,WAAS,KAAK;AACxD,QAAM,CAAC,OAAO,QAAQ,IAAIA,WAAS;AACnC,QAAM,CAAC,YAAY,aAAa,IAAIA,WAAS,EAAE;AAC/C,QAAM,EAAE,aAAa,IAAI,iBAAiB;AAC1C,QAAM,CAAC,iBAAiB,kBAAkB,IAAIA,4BAA8B;AAE5E,QAAM,WAAWE,SAAyB,IAAI;AAE9C,EAAAC,YAAU,MAAM;AACd,QAAI,SAAS,SAAS;AACpB,eAAS,QAAQ,MAAM;AAAA,IACzB;AAAA,EACF,GAAG,CAAC,eAAe,CAAC;AAEpB,QAAM,eAAe,CAAC,OAAe;AACnC,iBAAa;AAAA,MACX,CAAC,WAAW,UAAU,GAAG;AAAA,MACzB,CAAC,WAAW,IAAI,GAAG,WAAW;AAAA,IAChC,CAAC;AAAA,EACH;AAEA,QAAM,gBAAgBC,SAAQ,MAAM;AAClC,QAAI,CAAC,iBAAiB,KAAK,GAAG;AAC5B,UAAI,OAAO;AACT,sBAAc,gDAAgD;AAAA,MAChE;AACA,aAAO;AAAA,IACT,OAAO;AACL,oBAAc,EAAE;AAChB,aAAO;AAAA,IACT;AAAA,EACF,GAAG,CAAC,KAAK,CAAC;AAEV,SACE,gBAAAP,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,EAAE,GAAG,sBAAsB,IAAI,MAAM,KAAG,2CAErE,GACA,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,QAAQ,KAAK,OAAO,IAAI,MAAM,KAC5C,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,MAAM,gBAAAA,QAAA,cAAC,aAAU,OAAO,IAAI,QAAQ,IAAI;AAAA,MACxC,SAAS,MAAM,oCAAwC;AAAA,MACvD,QAAQ;AAAA;AAAA,EACV,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,MAAM,gBAAAA,QAAA,cAAC,gBAAa,OAAO,IAAI,QAAQ,IAAI;AAAA,MAC3C,SAAS,MAAM,oCAAwC;AAAA,MACvD,QAAQ;AAAA;AAAA,EACV,CACF,GACA,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,IAAI,MAAM,KACxC,gBAAAA,QAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,IAAI,KAAK,KAAI,aAAa,gBAAgB,YAAY,CAAC,EAAG,GACvF,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,MACL,MAAK;AAAA,MACL,aAAY;AAAA,MACZ,OAAO;AAAA,MACP,UAAU,WAAS,SAAS,MAAM,OAAO,MAAM,UAAU,CAAC;AAAA,MAC1D,KAAK;AAAA,QACH,iBAAiB;AAAA,QACjB,QAAQ;AAAA,MACV;AAAA;AAAA,EACF,GACA,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,IAAI,MAAM,KACpC,gBAAAA,QAAA,cAAC,UAAO,iBAAiB,WAAS,iBAAiB,KAAK,GAAG,KAAK,EAAE,IAAI,KAAK,GAAG,GAC9E,gBAAAA,QAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,GAAG,qBAAqB,KAAG,iBAExD,CACF,GAEA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,UAAU;AAAA,MACV,KAAK,EAAE,IAAI,MAAM;AAAA,MACjB,SAAS,MAAY;AACnB,cAAM,KAAK,KAAK,IAAI,EAAE,SAAS;AAC/B,cAAM,QAAQ,oBACX,WAAW;AAAA,UACV;AAAA,UACA;AAAA,UACA,WAAW;AAAA,UACX,2BAA2B,iBAAiB,oBAAoB,CAAC,iBAAiB,IAAI;AAAA;AAAA,UAEtF,MAAM,gBAAgB,YAAY;AAAA,QACpC,CAAC,EACA,KAAK,MAAM,aAAa,EAAE,CAAC,EAC3B,MAAM,SAAO,SAAS,IAAI,OAAO,CAAC;AAAA,MACvC;AAAA;AAAA,IACD;AAAA,IACS;AAAA,EACV,GACA,gBAAAA,QAAA,cAAC,aAAU,OAAO,SAAS,YAAY,CACzC,CACF;AAEJ;AAEA,IAAM,WAAW,MAAM;AACrB,QAAM,aAAaE,gBAAc;AACjC,QAAM,QAAQJ,cAAYU,YAAW;AACrC,QAAM,cAAcD;AAAA,IAClB,MAAG;AA1LP,UAAAE;AA2LM,cAAAA,MAAA,+BACI,KAAK,CAACC,IAAGC,OAAG;AA5LtB,YAAAF,KAAAG,KAAA;AA4L0B,kBAAAA,OAAAH,MAAAE,MAAA,gBAAAA,GAAG,cAAH,gBAAAF,IAAc,YAAd,gBAAAG,IAAA,KAAAH,SAA6B,QAAM,WAAAC,MAAA,gBAAAA,GAAG,cAAH,mBAAc,YAAd,gCAA6B;AAAA,aADpF,gBAAAD,IAEI,KAAK,CAACC,IAAGC,SAAOA,MAAA,gBAAAA,GAAG,WAAU,YAAY,IAAI,OAAMD,MAAA,gBAAAA,GAAG,WAAU,YAAY,IAAI;AAAA;AAAA,IACtF,CAAC,KAAK;AAAA,EACR;AACA,QAAM,cAAcZ,cAAYC,mBAAiB;AAEjD,EAAAO,YAAU,MAAM;AACd,UAAM,cAAc,MAAY;AAC9B,YAAM,WAAW,oBAAoB,SAAS;AAAA,IAChD;AACA,gBAAY;AAAA,EACd,GAAG,CAAC,WAAW,mBAAmB,CAAC;AAEnC,UAAO,+BAAO,UACZ,gBAAAN,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,KAAK;AAAA,QACH,OAAO;AAAA,UACH,2CAAa,aAAY,EAAE,WAAW,kCAAkC,YAAY,MAAM,IAAI,CAAC;AAAA;AAAA,IAGrG,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,mBAAmB,KAAG,4BAEnD;AAAA,IACA,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,KAAK,OAAO,IAAI,KAAK,KAClD,2CAAa,IAAI,UAChB,gBAAAA,QAAA,cAAC,mBAAgB,KAAK,KAAK,IAAI,IAAI,KAAK,IAAI,OAAO,KAAK,OAAO,QAAQ,KAAK,OAAO,EAEvF;AAAA,EACF,IACE;AACN;AAEA,IAAM,kBAAkB,CAAC,EAAE,IAAI,OAAO,OAAO,MAA4D;AACvG,QAAM,EAAE,aAAa,IAAI,iBAAiB;AAE1C,SACE,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,iBAAiB,mBAAmB,cAAc,MAAM,GAAG,KAAK,KAC9F,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,QAAQ,gBAAgB,iBAAiB,IAAI,MAAM,KACjE,gBAAAA,QAAA,cAAC,QAAK,SAAQ,QAAO,KAAK,EAAE,GAAG,oBAAoB,YAAY,YAAY,KACxE,KACH,GACA,gBAAAA,QAAA,cAAC,mBAAgB,QAAgB,CACnC,GACA,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,QAAQ,KAAK,KAAK,GAAG,SAAQ,SAC3C,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,SAAS,MACP,aAAa;AAAA,QACX,CAAC,WAAW,UAAU,GAAG;AAAA,QACzB,CAAC,WAAW,IAAI,GAAG,WAAW,YAAY,WAAW,mBAAmB,WAAW;AAAA,MACrF,CAAC;AAAA;AAAA,IAEJ;AAAA,EAED,CACF,CACF;AAEJ;;;AGvPA;AACA,OAAOa,YAAS,WAAAC,WAAS,YAAAC,kBAAgB;AACzC,SAAS,MAAMC,aAAY;AAC3B,SAAS,gBAAgB,iBAAAC,iBAAe,eAAAC,eAAa,yBAAAC,8BAA6B;AAClF,SAAS,iBAAAC,sBAAqB;;;ACJ9B;AACA,OAAOC,WAAS,eAAAC,eAAa,UAAAC,UAAQ,YAAAC,kBAAgB;AAMrD,SAAS,eAAe,aAAAC,kBAAiB;;;ACPzC;AAAA,OAAOC,aAAW;AAClB,SAAS,qBAAAC,oBAAmB,aAAAC,mBAAiB;AAMtC,IAAM,sBAAsB,CAAC;AAAA,EAClC;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,SACE,gBAAAC,QAAA,cAAC,OAAO,MAAP,EAAY,QACX,gBAAAA,QAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,QAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,QAAA,cAAC,OAAO,SAAP,EAAe,KAAK,EAAE,GAAG,MAAM,KAC9B,gBAAAA,QAAA,cAAC,WACC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,OAAO;AAAA,QACP,SAAS;AAAA,QACT,YAAY;AAAA,MACd;AAAA;AAAA,IAEA,gBAAAA,QAAA,cAACC,oBAAA,EAAkB,OAAO,EAAE,aAAa,SAAS,GAAG;AAAA,IACrD,gBAAAD,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,WAAW,YAAY,YAAY,KAAG,kBAEvE;AAAA,IAEA,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,IAAI;AAAA,UACJ,OAAO;AAAA,UACP,WAAW,EAAE,OAAO,oBAAoB,QAAQ,UAAU;AAAA,QAC5D;AAAA,QACA,SAAS,MAAM,QAAQ,KAAK;AAAA;AAAA,MAE5B,gBAAAA,QAAA,cAACE,aAAA,IAAU;AAAA,IACb;AAAA,EACF,GACA,gBAAAF,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,sBAAsB,IAAI,MAAM,IAAI,KAAK,KAAG,2DAE7E,GACA,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,QAAQ,IAAI,OAAO,KAAK,MAAM,KAC5C,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,UAAQ;AAAA,MACR,SAAS,MAAM,QAAQ,KAAK;AAAA,MAC5B,KAAK,EAAE,GAAG,QAAQ,UAAU,OAAO,YAAY,YAAY;AAAA;AAAA,IAC5D;AAAA,EAED,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,EAAE,GAAG,QAAQ,UAAU,OAAO,YAAY,YAAY;AAAA,MAC3D,SAAQ;AAAA,MACR,SAAS,MAAM;AACb,uBAAe;AACf,gBAAQ,KAAK;AAAA,MACf;AAAA;AAAA,IACD;AAAA,EAED,CACF,CACF,CACF,CACF,CACF;AAEJ;;;ACzEA;AAAA,OAAOG,aAAW;AAGX,IAAM,OAAO,MAAM,gBAAAC,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,QAAQ,cAAc,4BAA4B,GAAG,OAAO,IAAI,KAAK,GAAG;;;ACHlH;AACA,OAAOC,aAAW;AAClB,SAAS,iBAAiB,aAAAC,kBAAiB;;;ACF3C;AAAA,OAAOC,aAAW;AAElB,SAAS,aAAAC,kBAAiB;AAKnB,IAAM,wBAAwB,CAAC;AAAA,EACpC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAKM;AACJ,SACE,gBAAAC,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,aAAa,UAAU,QAAQ,CAAC;AAAA,MAChC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,iBAAiB;AAAA,QACjB,QAAQ;AAAA,MACV;AAAA,MACA,QAAO,iCAAQ,SAAQ;AAAA,MACvB,KAAK;AAAA,MACL,UAAU,WAAS,uBAAuB,OAAO,MAAM,OAAO,MAAM,UAAU,CAAC;AAAA,MAC/E,WAAW;AAAA;AAAA,EACb,GACA,gBAAAA,QAAA,cAAC,sBAAW,SAAS,MAAM,aAAa,KAAK,GAAG,KAAK,EAAE,IAAI,eAAe,QAAQ,OAAO,KACvF,gBAAAA,QAAA,cAACC,YAAA,IAAU,CACb,CACF;AAEJ;;;ACrCA;AAAA,OAAOC,aAAW;AAGX,IAAM,YAAY,CAAC,EAAE,UAAU,MAA6B;AACjE,SACE,gBAAAC,QAAA,cAAC,QAAK,KAAK,EAAE,YAAY,SAAS,KAC/B,YACC,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,qBAAqB,KACnD,WAAU,QACV,cAAc,IAAI,SAAS,OAC9B,IACE,IACN;AAEJ;;;ACdA;AAAA,OAAOC,aAAW;AAIX,IAAM,eAAe,CAAC,EAAE,QAAQ,eAAe,MAAiE;AACrH,QAAM,eAAe,OAAO,OAAO,cAAc,YAAY,OAAO,mBAAmB,YAAY,iBAAiB;AACpH,QAAM,gBAAiB,OAAO,OAAO,aAAa,KAAM;AAExD,SAAO,eACL,gBAAAC,QAAA,cAAC,SAAS,MAAT,EAAc,OAAO,eAAe,KAAK,EAAE,IAAI,KAAK,KACnD,gBAAAA,QAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,OAAO;AAAA,QACL,WAAW,eAAe,MAAM,aAAa;AAAA,MAC/C;AAAA;AAAA,EACF,CACF,IACE;AACN;;;AHTO,IAAM,wBAAwB,CAAC;AAAA,EACpC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAAM;AACJ,QAAM,sBAAsB,CAAC,SAAS,UAAU;AAC9C,UAAM,cAAc,IAAI,IAAI,eAAe;AAC3C,QAAI,SAAS;AACX,kBAAY,IAAI,KAAK;AAAA,IACvB,OAAO;AACL,kBAAY,OAAO,KAAK;AAAA,IAC1B;AACA,uBAAmB,WAAW;AAAA,EAChC;AAEA,SACE,gBAAAC,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,KAAK,OAAO,GAAG,QAAQ,IAAI,MAAM,KAC9D,QAAQ,IAAI,YAAU;AAjC7B,QAAAC;AAkCQ,WACE,gBAAAD,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,GAAG,aAAa,IAAI,OAAO,KAAK,IAAI,KAAK,EAAE,GAAG,QAAQ,KAAK,KAAK,KACvF,CAAC,aAAa,CAAC,SACd,gBAAAA,QAAA;AAAA,MAAC,SAAS;AAAA,MAAT;AAAA,QACC,IAAI,GAAG,aAAa,IAAI,OAAO,KAAK;AAAA,QACpC,UAAU,CAAC;AAAA,QACX,UAASC,MAAA,uDAAmB,YAAnB,gBAAAA,IAA4B,SAAS,OAAO;AAAA,QACrD,iBAAiB,aAAW,oBAAoB,SAAS,OAAO,KAAK;AAAA,QACrE,KAAK;AAAA,UACH,QAAQ,aAAa,YAAY;AAAA,UACjC,YAAY;AAAA,QACd;AAAA;AAAA,MAEA,gBAAAD,QAAA,cAAC,SAAS,WAAT,MACC,gBAAAA,QAAA,cAACE,YAAA,EAAU,OAAO,IAAI,QAAQ,IAAI,CACpC;AAAA,IACF,IACE,MAEH,cAAa,6DAAsB,SAAS,OAAO,UAClD,gBAAAF,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,OAAO,mBAAmB,KACpD,gBAAAA,QAAA,cAAC,mBAAgB,QAAQ,IAAI,OAAO,IAAI,CAC1C,IACE,MAEJ,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,UAAU,IAAI,KAC5C,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,OAAO,KACrB,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,SAAS,QAAQ,UAAU,IAAI,KAC1C,gBAAAA,QAAA,cAACG,QAAA,EAAM,SAAS,GAAG,aAAa,IAAI,OAAO,KAAK,MAAK,OAAO,IAAK,CACnE,GACC,iBAAiB,gBAAAH,QAAA,cAAC,aAAU,WAAW,OAAO,WAAW,CAC5D,GACC,iBAAiB,gBAAAA,QAAA,cAAC,gBAAa,QAAgB,gBAAgC,CAClF,GAEC,aAAa,WAAU,uDAAmB,QAAQ,SAAS,OAAO,UACjE,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,sBAAsB,UAAU,cAAc,KAAG,aAElF,IACE,IACN;AAAA,EAEJ,CAAC,CACH;AAEJ;AAEO,IAAM,6BAA6B,CAAC,EAAE,QAAQ,SAAS,cAAc,wBAAwB,aAAa,MAAM;AACrH,SACE,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,KAAK,OAAO,GAAG,QAAQ,IAAI,MAAM,KAC9D,QAAQ,IAAI,CAAC,QAAQ,UAAU;AAC9B,WACE,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,OAAO,KAAK,EAAE,GAAG,QAAQ,KAAK,KAAK,KAC1D,UACC,gBAAAA,QAAA;AAAA,MAAC,SAAS;AAAA,MAAT;AAAA,QACC,iBAAiB,aAAW,aAAa,SAAS,KAAK;AAAA,QACvD,SAAS,OAAO;AAAA,QAChB,KAAK;AAAA,UACH,QAAQ;AAAA,UACR,OAAO;AAAA,QACT;AAAA;AAAA,MAEA,gBAAAA,QAAA,cAAC,SAAS,WAAT,MACC,gBAAAA,QAAA,cAACE,YAAA,EAAU,OAAO,IAAI,QAAQ,IAAI,CACpC;AAAA,IACF,GAEF,gBAAAF,QAAA;AAAA,MAAC;AAAA;AAAA,QACC;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA;AAAA,IACF,CACF;AAAA,EAEJ,CAAC,CACH;AAEJ;;;AIhHA;AACA,OAAOI,aAAW;AAClB,SAAS,mBAAAC,wBAAuB;AAMzB,IAAM,sBAAsB,CAAC;AAAA,EAClC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAAM;AACJ,SACE,gBAAAC,QAAA,cAAC,WAAW,MAAX,EAAgB,OAAO,uDAAmB,QAAQ,eAAe,WAAS,UAAU,KAAK,KACxF,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,KAAK,OAAO,GAAG,QAAQ,IAAI,MAAM,KAC9D,QAAQ,IAAI,YAAU;AACrB,WACE,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,GAAG,aAAa,IAAI,OAAO,KAAK,IAAI,KAAK,EAAE,GAAG,QAAQ,KAAK,KAAK,KACvF,CAAC,aAAa,CAAC,SACd,gBAAAA,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,KAAK;AAAA,UACH,YAAY;AAAA,UACZ,GAAG;AAAA,UACH,GAAG;AAAA,UACH,QAAQ;AAAA,UACR,aAAa;AAAA,UACb,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,IAAI;AAAA,UACJ,gBAAgB;AAAA,UAChB,YAAY;AAAA,UACZ,QAAQ,aAAa,YAAY;AAAA,UACjC,2BAA2B;AAAA,YACzB,aAAa;AAAA,YACb,aAAa;AAAA,UACf;AAAA,QACF;AAAA,QACA,UAAU,CAAC;AAAA,QACX,OAAO,OAAO;AAAA,QACd,IAAI,GAAG,aAAa,IAAI,OAAO,KAAK;AAAA;AAAA,MAEpC,gBAAAA,QAAA;AAAA,QAAC,WAAW;AAAA,QAAX;AAAA,UACC,KAAK;AAAA,YACH,GAAG;AAAA,YACH,GAAG;AAAA,YACH,YAAY;AAAA,YACZ,cAAc;AAAA,UAChB;AAAA;AAAA,MACF;AAAA,IACF,IACE,MAEH,aAAa,uBAAuB,OAAO,SAAS,SACnD,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,OAAO,mBAAmB,KACrC,gBAAAA,QAAA,cAACC,kBAAA,EAAgB,QAAQ,IAAI,OAAO,IAAI,CAC1C,IACE,MAEJ,gBAAAD,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,UAAU,IAAI,KAC5C,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,GAAG,OAAO,KACrB,gBAAAA,QAAA,cAAC,QAAK,KAAK,EAAE,SAAS,QAAQ,UAAU,KAAK,OAAO,mBAAmB,KACrE,gBAAAA,QAAA,cAACE,QAAA,EAAM,OAAO,EAAE,OAAO,UAAU,GAAG,SAAS,GAAG,aAAa,IAAI,OAAO,KAAK,MAC1E,OAAO,IACV,CACF,GACC,iBAAiB,gBAAAF,QAAA,cAAC,aAAU,WAAW,OAAO,WAAW,CAC5D,GACC,iBAAiB,gBAAAA,QAAA,cAAC,gBAAa,QAAgB,gBAAgC,CAClF,GACC,aAAa,WAAU,uDAAmB,YAAW,OAAO,QAC3D,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,sBAAsB,UAAU,cAAc,KAAG,aAElF,IACE,IACN;AAAA,EAEJ,CAAC,CACH,CACF;AAEJ;AAEO,IAAM,2BAA2B,CAAC,EAAE,QAAQ,SAAS,cAAc,wBAAwB,aAAa,MAAM;AACnH,QAAM,qBAAqB,QAAQ,UAAU,YAAU,OAAO,eAAe;AAE7E,SACE,gBAAAA,QAAA,cAAC,WAAW,MAAX,EAAgB,OAAO,oBAAoB,eAAe,gBACzD,gBAAAA,QAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,KAAK,OAAO,GAAG,QAAQ,IAAI,MAAM,KAC9D,QAAQ,IAAI,CAAC,QAAQ,UAAU;AAC9B,WACE,gBAAAA,QAAA,cAAC,QAAK,OAAM,UAAS,KAAK,UAAU,KAAK,IAAI,KAAK,EAAE,GAAG,QAAQ,KAAK,KAAK,KACtE,UACC,gBAAAA,QAAA;AAAA,MAAC,WAAW;AAAA,MAAX;AAAA,QACC,KAAK;AAAA,UACH,YAAY;AAAA,UACZ,GAAG;AAAA,UACH,QAAQ;AAAA,UACR,aAAa;AAAA,UACb,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,YAAY;AAAA,UACZ,QAAQ;AAAA,UACR,2BAA2B;AAAA,YACzB,aAAa;AAAA,YACb,aAAa;AAAA,UACf;AAAA,QACF;AAAA,QACA,OAAO;AAAA;AAAA,MAEP,gBAAAA,QAAA;AAAA,QAAC,WAAW;AAAA,QAAX;AAAA,UACC,KAAK;AAAA,YACH,GAAG;AAAA,YACH,GAAG;AAAA,YACH,YAAY;AAAA,YACZ,cAAc;AAAA,UAChB;AAAA;AAAA,MACF;AAAA,IACF,GAEF,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA;AAAA,IACF,CACF;AAAA,EAEJ,CAAC,CACH,CACF;AAEJ;;;APlHO,IAAM,eAAe,CAAC;AAAA,EAC3B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAOM;AAvCN,MAAAG;AAwCE,QAAM,MAAMC,SAAO,IAAI;AACvB,QAAM,cAAc,qBAAqB;AACzC,QAAM,CAAC,YAAY,aAAa,IAAIC,WAAS,KAAK;AAClD,QAAM,CAAC,MAAM,OAAO,IAAIA,WAAS,KAAK;AACtC,QAAM,CAAC,MAAM,OAAO,IAAIA,WAA8B,SAAS,2CAAmC;AAClG,QAAM,CAAC,MAAM,OAAO,IAAIA,WAAS,SAAS,IAAI;AAC9C,QAAM,CAAC,QAAQ,SAAS,IAAIA,WAAS,SAAS,KAAK,CAAC;AACpD,QAAM,CAAC,SAAS,UAAU,IAAIA;AAAA,KAC5B,qCAAU,YAAW;AAAA,MACnB,EAAE,MAAM,IAAI,iBAAiB,MAAM;AAAA,MACnC,EAAE,MAAM,IAAI,iBAAiB,MAAM;AAAA,IACrC;AAAA,EACF;AAEA,QAAM,UAAU,gBAAgB;AAAA,IAC9B;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AAED,QAAM,yBAAyBC;AAAA,IAC7B,CAACC,QAAeC,UAAiB;AAC/B,iBAAW,CAAAC,aAAW,CAAC,GAAGA,SAAQ,MAAM,GAAGF,MAAK,GAAG,iCAAKE,SAAQF,MAAK,IAAlB,EAAqB,MAAAC,MAAK,IAAG,GAAGC,SAAQ,MAAMF,SAAQ,CAAC,CAAC,CAAC;AAAA,IAC9G;AAAA,IACA,CAAC,UAAU;AAAA,EACb;AAEA,QAAM,eAAeD;AAAA,IACnB,CAACC,WACC,WAAW,CAAAE,aAAW;AACpB,YAAM,aAAa,CAAC,GAAGA,QAAO;AAC9B,iBAAW,OAAOF,QAAO,CAAC;AAC1B,aAAO;AAAA,IACT,CAAC;AAAA,IACH,CAAC,UAAU;AAAA,EACb;AAEA,QAAM,2BAA2BD;AAAA,IAC/B,CAAC,gBAAwB;AACvB,UAAI,CAAC,QAAQ;AACX;AAAA,MACF;AACA;AAAA,QAAW,CAAAG,aACTA,SAAQ,IAAI,CAAC,QAAQF,WAAW,iCAC3B,SAD2B;AAAA,UAE9B,iBAAiBA,WAAU;AAAA,QAC7B,EAAE;AAAA,MACJ;AAAA,IACF;AAAA,IACA,CAAC,YAAY,MAAM;AAAA,EACrB;AAEA,QAAM,6BAA6BD;AAAA,IACjC,CAAC,SAAkBC,WAAkB;AACnC,UAAI,CAAC,QAAQ;AACX;AAAA,MACF;AACA,iBAAW,CAAAE,aAAW;AAAA,QACpB,GAAGA,SAAQ,MAAM,GAAGF,MAAK;AAAA,QACzB,iCAAKE,SAAQF,MAAK,IAAlB,EAAqB,iBAAiB,QAAQ;AAAA,QAC9C,GAAGE,SAAQ,MAAMF,SAAQ,CAAC;AAAA,MAC5B,CAAC;AAAA,IACH;AAAA,IACA,CAAC,YAAY,MAAM;AAAA,EACrB;AAEA,SACE,gBAAAG,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,QAAK,SAAQ,YAAW,KAAK,EAAE,GAAG,mBAAmB,eAAe,YAAY,KAAG,aACxE,QAAQ,GAAE,QAAK,MAC3B,GACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,IAAI,MAAM,IAAI,MAAM,KAAG,eAEpD,GACA,gBAAAA,QAAA,cAAC,SAAS,MAAT,EAAc,MAAY,cAAc,WACvC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MAEA,OAAO,oBAAoB,IAAI;AAAA,MAC/B,KAAK;AAAA,QACH,iBAAiB;AAAA,QACjB,QAAQ;AAAA,MACV;AAAA,MACA;AAAA;AAAA,EACF,GACA,gBAAAA,QAAA,cAAC,SAAS,QAAT,MAEC,gBAAAA,QAAA,cAAC,SAAS,SAAT,EAAiB,OAAM,SAAQ,YAAY,GAAG,KAAK,EAAE,IAAGP,MAAA,IAAI,YAAJ,gBAAAA,IAAa,aAAa,QAAQ,IAAK,KAC7F,OAAO,KAAK,mBAAmB,EAAE,IAAI,WAAS;AAC7C,WACE,gBAAAO,QAAA;AAAA,MAAC,SAAS;AAAA,MAAT;AAAA,QACC,KAAK;AAAA,QAEL,UAAU,MAAM,QAAQ,KAAK;AAAA,QAC7B,KAAK;AAAA,UACH,IAAI;AAAA,UACJ,IAAI,SAAS,QAAQ,cAAc;AAAA,QACrC;AAAA;AAAA,MAGC,oBAAoB,KAAK;AAAA,IAC5B;AAAA,EAEJ,CAAC,CACH,CACF,CACF,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAW;AAAA,MACX,aAAY;AAAA,MACZ,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,iBAAiB;AAAA,QACjB,QAAQ;AAAA,QACR,WAAW;AAAA,QACX,QAAQ;AAAA,QACR,WAAW;AAAA,MACb;AAAA,MACA,OAAO;AAAA,MACP,UAAU,WAAS,QAAQ,MAAM,OAAO,MAAM,UAAU,CAAC;AAAA;AAAA,EAC3D,GACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,sBAAsB,WAAW,OAAO,IAAI,KAAK,MAC/E,6BAAM,WAAU,GAAE,OACrB,GACA,gBAAAA,QAAA,cAAC,UAAK,GAEL,gDAAwC,mDACvC,gBAAAA,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,IAAI,MAAM,GAAG,qBAAqB,KAAG,SAElE,GAEC,UACC,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,sBAAsB,IAAI,MAAM,KAC1D,+CACG,yDACA,sDACN,GAGD,gDACC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA;AAAA,MACA,cAAc;AAAA,MACd;AAAA,MACA;AAAA;AAAA,EACF,GAGD,oDACC,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA;AAAA,MACA,cAAc;AAAA,MACd;AAAA,MACA;AAAA;AAAA,EACF,IAGD,mCAAS,UAAS,MACjB,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,QAAQ;AAAA,QACR,WAAW,EAAE,GAAG,mBAAmB;AAAA,MACrC;AAAA,MACA,SAAS,MAAM,WAAW,CAAC,GAAG,SAAS,EAAE,MAAM,IAAI,iBAAiB,MAAM,CAAC,CAAC;AAAA;AAAA,IAE5E,gBAAAA,QAAA,cAAC,iBAAc,OAAO,EAAE,UAAU,YAAY,MAAM,OAAO,GAAG;AAAA,IAE9D,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,IAAI;AAAA,UACJ,GAAG;AAAA,QACL;AAAA;AAAA,MACD;AAAA,IAED;AAAA,EACF,GAEF,gBAAAA,QAAA,cAAC,UAAK,GACL,SACC,gBAAAA,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,QAAK,SAAQ,WAAU,OAAM,UAAS,KAAK,EAAE,KAAK,MAAM,GAAG,OAAO,KACjE,gBAAAA,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,qBAAqB,KAAG,iBAEzD,GACA,gBAAAA,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAK;AAAA,MACL,OAAO;AAAA,MACP,KAAK;AAAA,MACL,KAAK;AAAA,MACL,UAAU,OAAK,UAAU,KAAK,IAAI,OAAO,EAAE,OAAO,KAAK,GAAG,GAAG,CAAC;AAAA,MAC9D,KAAK;AAAA,QACH,iBAAiB;AAAA,QACjB,QAAQ;AAAA,QACR,UAAU;AAAA,MACZ;AAAA;AAAA,EACF,CACF,CAOF,IACE,IACN,IACE,MAEJ,gBAAAA,QAAA,cAAC,QAAK,SAAQ,OAAM,OAAM,UAAS,KAAK,EAAE,IAAI,OAAO,KAAK,KAAK,KAC7D,gBAAAA,QAAA,cAAC,cAAW,KAAK,EAAE,QAAQ,2BAA2B,KACpD,gBAAAA,QAAA,cAACC,YAAA,EAAU,SAAS,MAAM,cAAc,CAAC,IAAI,GAAG,CAClD,GACA,gBAAAD,QAAA;AAAA,IAAC;AAAA;AAAA,MACC,UAAU;AAAA,MACV,OACE,QAAQ,SAAS,IACb,uCACA,8BAA8B,SAAS,mCAAmC,EAAE;AAAA,MAElF,QAAQ,EAAE,UAAU,MAAM;AAAA;AAAA,IAE1B,gBAAAA,QAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,UAAU,CAAC;AAAA,QACX,SAAS,MAAM;AACb,iBAAO;AAAA,YACL,OAAO;AAAA,YACP;AAAA,YACA;AAAA,YACA;AAAA,YACA,WAAW;AAAA,YACX,SAAS,SAAS;AAAA,YAClB;AAAA,UACF,CAAC;AAAA,QACH;AAAA;AAAA,MACD;AAAA,IAED;AAAA,EACF,CACF,GAEA,gBAAAA,QAAA,cAAC,uBAAoB,MAAM,YAAY,SAAS,eAAe,gBAAgC,CACjG;AAEJ;AAEO,IAAM,kBAAkB,CAAC;AAAA,EAC9B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,SAAS;AACX,MAMM;AACJ,MAAI,CAAC,iBAAiB,IAAI,KAAK,CAAC,MAAM;AACpC,WAAO;AAAA,EACT;AAEA,QAAM,qBAAqB,QAAQ,SAAS,KAAK,QAAQ,MAAM,YAAU,UAAU,iBAAiB,OAAO,MAAM,CAAC,CAAC;AACnH,QAAM,mBAAmB,QAAQ,KAAK,YAAU,OAAO,eAAe;AAEtE,MAAI,CAAC,QAAQ;AACX,WAAO;AAAA,EACT;AAGA,MAAI,UAAU,SAAS,GAAG;AACxB,WAAO;AAAA,EACT;AAEA,SAAO,sBAAsB;AAC/B;;;AQnUA;AAAA,OAAOE,WAAS,WAAAC,iBAAe;AAE/B,SAAS,mBAAAC,wBAAuB;AAIzB,IAAM,gBAAgB,CAAC;AAAA,EAC5B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAKM;AAhBN,MAAAC;AAiBE,QAAM,cAAcC,UAAQ,MAAM;AAjBpC,QAAAD;AAkBI,UAAM,qBAAqB,CAAC;AAC5B,UAAM,EAAE,QAAQ,QAAQ,KAAIA,MAAA,qCAAU,WAAV,OAAAA,MAAoB,CAAC;AACjD,QAAI,QAAQ;AACV,yBAAmB,KAAK,MAAM;AAAA,IAChC;AACA,QAAI,SAAS;AACX,yBAAmB,KAAK,GAAG,OAAO;AAAA,IACpC;AACA,WAAO;AAAA,EACT,GAAG,CAAC,qCAAU,MAAM,CAAC;AAErB,SACE,gBAAAE,QAAA,cAAAA,QAAA,gBACE,gBAAAA,QAAA,cAAC,QAAK,SAAQ,YAAW,KAAK,EAAE,GAAG,mBAAmB,eAAe,YAAY,KAC7D,aACR,QAAQ,GAAE,QAAK,QAAO,MAAG,oBAAoB,SAAS,IAAI,CACtE,GACA,gBAAAA,QAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,IAAI,MAAM,IAAI,MAAM,KAC9C,SAAS,IACZ,IACCF,MAAA,SAAS,YAAT,gBAAAA,IAAkB,IAAI,CAAC,QAAQG,WAC9B,gBAAAD,QAAA,cAAC,QAAK,KAAK,GAAG,OAAO,IAAI,IAAIC,MAAK,IAAI,KAAK,EAAE,YAAY,UAAU,IAAI,MAAM,KAC3E,gBAAAD,QAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,GAAG,qBAAqB,KAClD,OAAO,IACV,IAEE,YAAY,SAASC,SAAQ,CAAC,KAAK,OAAO,oBAC1C,gBAAAD,QAAA,cAAC,QAAK,KAAK,EAAE,OAAO,kBAAkB,IAAI,MAAM,KAC9C,gBAAAA,QAAA,cAACE,kBAAA,EAAgB,QAAQ,IAAI,OAAO,IAAI,CAC1C,CAEJ,IAED,SAAS,YACR,gBAAAF,QAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,mBAAmB,IAAI,MAAM,KAAG,wBAEjE,IACE,MACJ,gBAAAA,QAAA,cAAC,QAAK,SAAQ,OAAM,KAAK,EAAE,GAAG,QAAQ,YAAY,SAAS,KACzD,gBAAAA,QAAA,cAAC,UAAO,SAAQ,YAAW,KAAK,EAAE,YAAY,YAAY,GAAG,SAAS,MAAM,eAAe,SAAS,OAAO,KAAG,MAE9G,CACF,CACF;AAEJ;;;ATlDA,IAAM,oBAAoB,eAAa;AACrC,QAAM,oBAAoB,UAAU,IAAI,cAAY;AAClD,WAAO,iCAAK,WAAL,EAAe,OAAO,MAAM,SAASG,MAAK,EAAE;AAAA,EACrD,CAAC;AACD,SAAO;AACT;AAEO,SAAS,kBAAkB;AApBlC,MAAAC,KAAAC,KAAA;AAqBE,QAAM,UAAUC,gBAAc;AAC9B,QAAM,EAAE,aAAa,IAAIC,uBAAsB;AAC/C,QAAM,iBAAiB,kBAAkB;AACzC,QAAM,EAAE,YAAY,IAAI,YAAY,IAAI,iBAAiB;AACzD,QAAM,cAAcC,cAAY,eAAe,EAAE,CAAC;AAClD,QAAM,CAAC,WAAW,YAAY,IAAIC;AAAA,MAChCL,MAAA,YAAY,cAAZ,gBAAAA,IAAuB,UAAS,kBAAkB,YAAY,SAAS,IAAI,CAAC,EAAE,SAASD,MAAK,EAAE,CAAC;AAAA,EACjG;AAEA,QAAM,cAAcO,UAAQ,MAAM,UAAU,SAAS,KAAK,UAAU,MAAM,eAAe,GAAG,CAAC,SAAS,CAAC;AAEvG,QAAM,aAAa,MAAY;AAC7B,UAAM,QAAQ,oBAAoB,UAAU,EAAE;AAC9C,UAAM,kBAAkB,EAAE;AAC1B,gBAAY,WAAW,IAAI;AAAA,EAC7B;AAEA,QAAM,oBAAoB,CAAM,YAAW;AAEzC,QAAI,WAAW,cAAc;AAC3B,UAAI;AACF,cAAM,QAAQ,qBAAqB;AAAA,UACjC;AAAA,YACE,SAAS,QAAQ,OAAO;AAAA,YACxB,UAAU;AAAA,UACZ;AAAA,QACF,CAAC;AAAA,MACH,SAAS,GAAG;AACV,gBAAQ,MAAM,CAAC;AAAA,MACjB;AAAA,IACF;AAAA,EACF;AAEA,QAAM,gBAAe,2CAAa,UAC9B,MAAAL,MAAA,2CAAa,SAAb,gBAAAA,IAAoB,OAApB,mBAAwB,mBAAgB,gDAAa,SAAb,mBAAmB,MAAM,MACjE;AACJ,QAAM,UAAS,2CAAa,UAAS;AACrC,SACE,gBAAAM,SAAA,cAACC,YAAA,EAAU,SAAO,QAChB,gBAAAD,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS;AAAA,MACT,SAAS;AAAA,MACT,QAAQ,MAAM,YAAY,WAAW,gBAAgB;AAAA;AAAA,EACvD,GACA,gBAAAA,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,GAAG,OAAO,WAAW,OAAO,KAC1D,gBAAAA,SAAA,cAAC,QAAK,WAAU,YACb,UAAU,IAAI,CAAC,UAAU,UACxB,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,SAAS;AAAA,MACd;AAAA,MACA;AAAA,MACA,QAAQ,UAAU;AAAA,MAClB,QAAQ,CAAM,mBAAkB;AAC9B,cAAM,mBAAmB,CAAC,GAAG,UAAU,MAAM,GAAG,KAAK,GAAG,gBAAgB,GAAG,UAAU,MAAM,QAAQ,CAAC,CAAC;AACrG,qBAAa,gBAAgB;AAC7B,cAAM,iBAAiB,iBAAiB,OAAO,CAAAE,cAAY,gBAAgBA,SAAQ,CAAC;AACpF,cAAM,QAAQ,oBAAoB,mBAAmB,IAAI,cAAc;AAAA,MACzE;AAAA,MACA;AAAA,MACA,gBAAgB,CAAM,eAAc;AAClC,cAAM,mBAAmB,UAAU,OAAO,qBAAmB,gBAAe,mDAAiB,QAAO;AACpG,qBAAa,gBAAgB;AAC7B,cAAM,iBAAiB,iBAAiB,OAAO,CAAAA,cAAY,gBAAgBA,SAAQ,CAAC;AACpF,cAAM,QAAQ,oBAAoB,mBAAmB,IAAI,cAAc;AAAA,MACzE;AAAA,MACA,gBAAgB,gBACd,aAAa,UAAQ;AACnB,cAAM,kBAAkB,CAAC,GAAG,IAAI;AAChC,wBAAgB,QAAQ,CAAAA,cAAY;AAClC,cAAI,cAAcA,UAAS,YAAY,YAAY;AACjD,YAAAA,UAAS,QAAQ;AAAA,UACnB;AAAA,QACF,CAAC;AACD,eAAO;AAAA,MACT,CAAC;AAAA;AAAA,EAEL,CACD,CACH,GACA,gBAAAF,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,IAAI;AAAA,QACJ,QAAQ;AAAA,QACR,WAAW,EAAE,GAAG,qBAAqB;AAAA,MACvC;AAAA,MACA,SAAS,MAAM,aAAa,CAAC,GAAG,WAAW,EAAE,SAASR,MAAK,EAAE,CAAC,CAAC;AAAA;AAAA,IAE/D,gBAAAQ,SAAA,cAACG,gBAAA,IAAc;AAAA,IACf,gBAAAH,SAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,IAAI,OAAO,GAAG,WAAW,KAAG,sBAEzD;AAAA,EACF,GACA,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,OAAO,GAAG,SAAQ,SAChC,gBAAAA,SAAA,cAAC,UAAO,UAAU,CAAC,aAAa,SAAS,MAAS;AAAG,sBAAW;AAAA,QAAG,WACzD,2CAAa,IACvB,CACF,CACF,CACF;AAEJ;AAEA,IAAM,eAAe,CAAC,EAAE,UAAU,QAAQ,OAAO,QAAQ,gBAAgB,QAAQ,eAAe,MAAM;AACpG,SACE,gBAAAA,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,GAAG,OAAO,IAAI,oBAAoB,GAAG,MAAM,IAAI,MAAM,KAClF,SAAS,QACR,gBAAAA,SAAA,cAAC,iBAAc,UAAoB,OAAc,QAAgB,gBAAgC,IAEjG,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,gBAAgB,MAAM,eAAe,SAAS,OAAO;AAAA,MACrD,QAAQ,YAAU,OAAO,MAAM;AAAA,MAC/B;AAAA,MACA;AAAA,MACA;AAAA;AAAA,EACF,CAEJ;AAEJ;;;AU7IA;AAAA,OAAOI,YAAS,YAAAC,kBAAgB;AAChC,SAAS,kBAAAC,iBAAgB,eAAAC,qBAAmB;AAC5C,SAAS,mBAAAC,kBAAiB,oBAAAC,mBAAkB,aAAAC,mBAAiB;;;ACF7D;AAAA,OAAOC,cAAW;AAClB,SAAS,mBAAAC,kBAAiB,WAAW,wBAAwB;;;ACD7D;AAAO,IAAM,mBAAmB,CAAC,cAAkC,UAAU,SAAS;AACpF,MAAI,CAAC;AAAc,WAAO;AAE1B,QAAM,eAAe,eAAe;AACpC,QAAM,QAAQ,KAAK,MAAM,eAAe,IAAI;AAC5C,QAAM,UAAU,KAAK,MAAO,eAAe,OAAQ,EAAE;AACrD,QAAM,UAAU,eAAe;AAE/B,MAAI,gBAAgB;AACpB,MAAI,OAAO;AACT,qBAAiB,GAAG,KAAK;AAAA,EAC3B;AACA,MAAI,WAAW,OAAO;AACpB,qBAAiB,GAAG,OAAO;AAAA,EAC7B;AACA,MAAI,CAAC,YAAY,SAAS,UAAU;AAClC,WAAO;AAAA,EACT;AACA,mBAAiB,GAAG,UAAU,QAAQ,QAAQ,CAAC,IAAI,KAAK,MAAM,OAAO,CAAC;AAEtE,SAAO;AACT;;;ADfA,IAAM,mBAA2C,EAAE,GAAG,WAAW,GAAG,WAAW,GAAG,UAAU;AAErF,IAAM,mBAAmB,CAAC;AAAA,EAC/B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAQM;AACJ,SACE,gBAAAC,SAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,WAAU,KAAK,EAAE,IAAI,KAAK,KACrD,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,KAAK,KACpC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,iBAAiB,iBAAiB,QAAQ,KAAK;AAAA,QAC/C,GAAG;AAAA,QACH,GAAG;AAAA,QACH,cAAc;AAAA,QACd,OAAO,WAAW,IAAI,oBAAoB;AAAA,QAC1C,UAAU;AAAA,QACV,YAAY;AAAA,MACd;AAAA;AAAA,IAEC;AAAA,EACH,GAEA,gBAAAA,SAAA,cAAC,WACC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,YAAY,aAAa,OAAO,mBAAmB,KAC1E,QACH,GAEA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,KAAK,KAChC,OAAM,OAAI,kBAAiB,SAC9B,CACF,CACF,GAEA,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,MAAM,OAAO,qBAAqB,KAChE,aAAa,KAAK,QAAQ,gBAAAA,SAAA,cAAC,oBAAiB,QAAQ,IAAI,OAAO,IAAI,IAAK,MACxE,gBACC,gBAAAA,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAACC,kBAAA,EAAgB,QAAQ,IAAI,OAAO,IAAI,GACxC,gBAAAD,SAAA,cAAC,QAAK,SAAQ,QACX,kBAAiB,KAAE,aACtB,CACF,IACE,MAEH,WACC,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,MAAM,OAAO,qBAAqB,KACjE,gBAAAA,SAAA,cAAC,aAAU,QAAQ,IAAI,OAAO,IAAI,GAClC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,QAAM,iBAAiB,QAAQ,CAAE,CACjD,IACE,IACN,CACF;AAEJ;;;AE3EA;AAAA,OAAOE,cAAW;AAClB,SAAkB,qBAAAC,oBAAmB,eAAAC,qBAAmB;;;ACDxD;AAAA,OAAOC,cAAW;AAIX,IAAM,eAAe,CAAC,EAAE,OAAO,QAAQ,EAAE,MAA6D;AAC3G,MAAI,CAAC,SAAS,EAAE,OAAO,UAAU,WAAW;AAC1C,WAAO,gBAAAC,SAAA,cAAAA,SAAA,cAAE;AAAA,EACX;AACA,SACE,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,GAAG,MAAM,YAAY,oBAAoB,cAAc,MAAM,GAAG,OAAO,KACjF,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK,EAAE,eAAe,aAAa,OAAO,sBAAsB,YAAY,aAAa,IAAI,KAAK;AAAA;AAAA,IAEjG;AAAA,EACH,GACA,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,YAAY,YAAY,KAAI,KAAM,CACjD;AAEJ;;;ACnBA;AAAA,SAAS,aAAAC,aAAW,YAAAC,kBAAgB;AACpC;AAAA,EAGE,kBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AAEA,IAAM,iBAAiB,CAAC,WAAmB;AAChD,QAAM,aAAaC,gBAAc;AACjC,QAAM,OAAOC,cAAYC,gBAAe,MAAM,CAAC;AAC/C,QAAM,CAAC,iBAAiB,kBAAkB,IAAIC,WAAiD;AAE/F,QAAM,WAAqC,mDAAiB,YAAW;AAAA,IACrE,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,UAAU;AAAA,IACV,SAAS;AAAA,IACT,cAAc;AAAA,EAChB;AACA,QAAM,CAAC,cAAc,eAAe,IAAIA,WAAS,EAAE,kBAAkB,GAAG,gBAAgB,EAAE,CAAC;AAE3F,EAAAC,YAAU,MAAM;AACd,UAAM,uBAAuB,MAAY;AAxB7C,UAAAC;AAyBM,UAAI,CAAC,mBAAmB,QAAQ,EAAC,6BAAM,cAAa,KAAK,UAAU,WAAW;AAC5E,cAAM,kBAAkB,MAAM,WAAW,oBAAoB,iBAAiB,KAAK,IAAI,GAAG,EAAE;AAE5F,cAAM,EAAE,kBAAkB,eAAe,MACvCA,MAAA,6BAAM,cAAN,gBAAAA,IAAiB,OAAO,CAAC,aAAa,aAAa;AA7B7D,cAAAA;AA8BY,sBAAY,oBAAoB,SAAS,UAAU;AACnD,sBAAY,oBAAkBA,MAAA,qCAAU,cAAV,gBAAAA,IAAqB,WAAU;AAC7D,iBAAO;AAAA,QACT,GAAG,kBAAiB;AAEtB,2BAAmB,eAAe;AAClC,wBAAgB,EAAE,kBAAkB,eAAe,CAAC;AAAA,MACtD;AAAA,IACF;AAEA,yBAAqB;AAAA,EACvB,GAAG,CAAC,MAAM,WAAW,qBAAqB,iBAAiB,YAAY,CAAC;AAExE,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA,kBAAkB,aAAa;AAAA,IAC/B,gBAAgB,aAAa;AAAA,EAC/B;AACF;;;AFzCO,IAAM,2BAA2B,CAAC,EAAE,KAAK,MAAyB;AACvE,QAAM,cAAcC,cAAYC,kBAAiB;AACjD,QAAM,EAAE,iBAAiB,QAAQ,IAAI,eAAe,KAAK,EAAE;AAC3D,MAAI,KAAK,UAAU,WAAW;AAC5B,WAAO,gBAAAC,SAAA,cAAAA,SAAA,cAAE;AAAA,EACX;AACA,QAAM,yBAAyB,gBAAgB,KAAK;AACpD,QAAM,YAAY,mDAAiB,QAAQ,KAAK,WAAM;AAfxD,QAAAC;AAe2D,aAAAA,MAAA,MAAM,SAAN,gBAAAA,IAAY,YAAW;AAAA;AAEhF,QAAM,QAAQ,yBACV;AAAA,IACE;AAAA,MACE,OAAO;AAAA,MACP,OAAO,GAAG,QAAQ,cAAe,MAAM,QAAQ,aAAc,QAAQ,YAAY,QAAQ,CAAC,IAAI,CAAC,MAC7F,QAAQ,UACV,IAAI,QAAQ,UAAU;AAAA,IACxB;AAAA,IACA;AAAA,MACE,OAAO;AAAA,MACP,OAAO,GAAG,QAAQ,cAAe,MAAM,QAAQ,eAAgB,QAAQ,YAAY,QAAQ,CAAC,IAAI,CAAC,MAC/F,QAAQ,YACV,IAAI,QAAQ,UAAU;AAAA,IACxB;AAAA;AAAA,IAEA,EAAE,OAAO,mBAAmB,OAAO,iBAAiB,QAAQ,OAAO,EAAE;AAAA,IACrE;AAAA,MACE,OAAO;AAAA,MACP,OAAO,OAAO,UAAU,QAAQ,QAAQ,IAAI,QAAQ,WAAW,QAAQ,SAAS,QAAQ,CAAC;AAAA,IAC3F;AAAA,EACF,IACA;AAAA,IACE,EAAE,OAAO,aAAa,QAAO,uCAAW,aAAY,IAAI;AAAA,IACxD,EAAE,OAAO,UAAU,QAAO,uCAAW,UAAS,EAAE;AAAA;AAAA,IAEhD,EAAE,OAAO,cAAc,OAAO,iBAAiB,uCAAW,QAAQ,EAAE;AAAA,IACpE;AAAA,MACE,OAAO;AAAA,MACP,QAAO,uCAAW,kBAAiB,GAAG,uCAAW,gBAAgB,IAAI,UAAU,cAAc,KAAK;AAAA,IACpG;AAAA,EACF;AAEJ,SACE,gBAAAD,SAAA,cAAC,WACC,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,YAAY,aAAa,IAAI,KAAK,KAAG,uBAAqB,GACvE,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,SAAS,QAAQ,qBAAqB,WAAW,KAAK,KAAK,KACpE,MAAM,IAAI,SACT,gBAAAA,SAAA,cAAC,gBAAa,KAAK,IAAI,OAAO,OAAO,IAAI,OAAO,OAAO,IAAI,OAAO,CACnE,CACH,CACF;AAEJ;;;AHxCO,IAAM,qBAAqB,CAAC,EAAE,OAAO,MAA0B;AAnBtE,MAAAE,KAAAC;AAoBE,QAAM,OAAOC,cAAYC,gBAAe,MAAM,CAAC;AAC/C,QAAM,EAAE,iBAAiB,iBAAiB,IAAI,eAAe,MAAM;AACnE,QAAM,CAAC,gBAAgB,iBAAiB,IAAIC,WAAS,KAAK;AAC1D,QAAM,EAAE,YAAY,IAAI,iBAAiB;AACzC,QAAM,iBAAiB,kBAAkB;AAEzC,MAAI,CAAC,QAAQ,CAAC;AACZ,WACE,gBAAAC,SAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,UAAS,KAAK,EAAE,MAAM,OAAO,KACxD,gBAAAA,SAAA,cAAC,aAAQ,CACX;AAGJ,QAAM,kBAAgBL,MAAA,KAAK,cAAL,gBAAAA,IAAgB,WAAU;AAEhD,SACE,gBAAAK,SAAA,cAACC,YAAA,EAAU,SAAO,QAChB,gBAAAD,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,MAAM,QAAQ,GAAG,KAAK,KACpD,gBAAAA,SAAA,cAAC,QAAK,SAAQ,WAAU,OAAM,UAAS,KAAK,EAAE,IAAI,MAAM,cAAc,4BAA4B,IAAI,KAAK,KACzG,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,KAAK,KACpC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,EAAE,OAAO,sBAAsB,WAAW,EAAE,OAAO,oBAAoB,QAAQ,UAAU,EAAE;AAAA,MAChG,SAAS,MAAM,YAAY,WAAW,IAAI;AAAA;AAAA,IAE1C,gBAAAA,SAAA,cAACE,kBAAA,IAAgB;AAAA,EACnB,GACA,gBAAAF,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,YAAY,YAAY,KAC/C,KAAK,KACR,GACA,gBAAAA,SAAA,cAAC,mBAAgB,QAAQ,KAAK,OAAO,CACvC,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,EAAE,OAAO,sBAAsB,WAAW,EAAE,OAAO,oBAAoB,QAAQ,UAAU,EAAE;AAAA,MAChG,SAAS;AAAA;AAAA,IAET,gBAAAA,SAAA,cAACG,aAAA,IAAU;AAAA,EACb,CACF,GACA,gBAAAH,SAAA,cAAC,OAAI,KAAK,EAAE,WAAW,QAAQ,IAAI,OAAO,IAAI,KAAK,KAChD,CAAC,iBAAiB,gBAAAA,SAAA,cAAC,4BAAyB,MAAY,IAAK,MAE9D,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,YAAY,aAAa,IAAI,KAAK,KAAG,aAE/D,GACA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,qBAAqB,KAAG,0DAEzD,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,WAAW;AAAA,QACX,MAAM,iBAAiB,UAAU;AAAA,QACjC,IAAI,iBAAiB,QAAQ;AAAA,QAC7B,IAAI,iBAAiB,MAAM;AAAA,QAC3B,IAAI,iBAAiB,OAAO;AAAA,QAC5B,iBAAiB,iBAAiB,KAAK;AAAA,QACvC,cAAc;AAAA,MAChB;AAAA;AAAA,KAEC,mDAAiB,YAChB,gBAAgB,QACb,MAAM,GAAG,iBAAiB,SAAY,CAAC,EACvC,IAAI,cACH,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK,SAAS;AAAA,QACd,UAAU,SAAS;AAAA,QACnB,OAAO,SAAS;AAAA,QAChB;AAAA,QACA,kBAAkB,SAAS;AAAA,QAC3B,UAAU,SAAS,KAAK,YAAY;AAAA,QACpC;AAAA,QACA,UAAU,SAAS;AAAA;AAAA,IACrB,CACD;AAAA,MACJJ,MAAA,mDAAiB,YAAjB,gBAAAA,IAA0B,UAAS,KAAK,CAAC,iBACxC,gBAAAI,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,GAAG;AAAA,UACH,WAAW;AAAA,UACX,QAAQ;AAAA,UACR,OAAO;AAAA,UACP,GAAG;AAAA,QACL;AAAA,QACA,SAAS,MAAM,kBAAkB,IAAI;AAAA;AAAA,MAErC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,QAAK,UAAQ;AAAA,MAAO;AAAA,MAAC,gBAAAA,SAAA,cAACI,mBAAA,IAAiB;AAAA,IACvD,IACE;AAAA,EACN,CACF,CACF,CACF;AAEJ;;;AMnHA;AAAA,OAAOC,YAAS,aAAAC,aAAW,UAAAC,UAAQ,YAAAC,kBAAgB;AACnD;AAAA,EACE,mBAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,mBAAAC,kBAAiB,aAAAC,mBAAiB;;;ACT3C;AAAA,OAAOC,cAAyC;;;ACAhD;AACA,OAAOC,YAAS,eAAAC,eAAa,aAAAC,aAAW,WAAAC,WAAS,UAAAC,UAAQ,YAAAC,kBAAgB;AACzE,SAAS,SAAAC,cAAa;AACtB,SAAS,mBAAAC,kBAAiB,2BAAAC,0BAAyB,iBAAAC,iBAAe,eAAAC,qBAAmB;AACrF,SAAS,mBAAAC,kBAAiB,mBAAAC,kBAAiB,mBAAAC,wBAAuB;AAO3D,IAAMC,gBAAe,CAAC;AAAA,EAC3B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,UAAU,CAAC;AAAA,EACX;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAAM;AACJ,QAAM,UAAUC,gBAAc;AAC9B,QAAM,YAAYC,cAAYC,gBAAe;AAE7C,QAAM,sBAAqB,uCAAW,QAAO;AAC7C,QAAM,oBAAoBD,cAAYE,wBAAuB;AAC7D,QAAM,sBACJ,CAAC,6BACD,0BAA0B,WAAW,KACrC,0BAA0B,SAAS,qBAAqB,EAAE;AAC5D,QAAM,CAAC,iBAAiB,kBAAkB,IAAIC,WAAS,iBAAiB;AAExE,EAAAC,YAAU,MAAM;AACd,uBAAmB,iBAAiB;AAAA,EACtC,GAAG,CAAC,iBAAiB,CAAC;AAEtB,QAAM,gBACJ,wBAAwB,mBAAoB,sBAAsB,cAAc,cAAe,CAAC;AAElG,QAAM,SAAS,cAAc;AAC7B,QAAM,YAAY,cAAc;AAChC,QAAM,aAAa,UAAU,CAAC;AAC9B,QAAM,YAAYC,SAAO,KAAK,IAAI,CAAC;AACnC,QAAM,kBAAkB,mBAAmB,QAAQ,iBAAiB,IAAI;AAExE,QAAM,CAAC,oBAAoB,qBAAqB,IAAIF,WAAS;AAC7D,QAAM,CAAC,sBAAsB,uBAAuB,IAAIA,WAAS,oBAAI,IAAI,CAAC;AAC1E,QAAM,CAAC,aAAa,cAAc,IAAIA,WAAS,IAAI;AAEnD,QAAM,kBAAkB,UAAU,mBAAmB,CAAC,gBAAgB;AAEtE,QAAM,cAAcG,UAAQ,MAAM;AAChC,QAAI,8CAAsC;AACxC,aAAO,uBAAuB;AAAA,IAChC,WAAW,kDAAwC;AACjD,aAAO,qBAAqB,OAAO;AAAA,IACrC;AAAA,EACF,GAAG,CAAC,oBAAoB,sBAAsB,IAAI,CAAC;AAEnD,QAAM,aAAaC,cAAY,MAAY;AACzC,QAAI,CAAC,aAAa;AAChB;AAAA,IACF;AACA,UAAM,oBAAoB;AAAA,MACxB,eAAe;AAAA,MACf,QAAQ;AAAA,MACR,SAAS,MAAM,KAAK,oBAAoB;AAAA,MACxC,UAAU,KAAK,IAAI,IAAI,UAAU;AAAA,IACnC;AACA,UAAM,QAAQ,oBAAoB,mBAAmB,QAAQ,CAAC,iBAAiB,CAAC;AAChF,yBAAqB,UAAQ;AAC3B,YAAM,WAAW,mBAAK;AACtB,eAAS,KAAK,IAAI,EAAE,QAAQ,oBAAoB,SAAS,MAAM,KAAK,oBAAoB,EAAE;AAC1F,aAAO;AAAA,IACT,CAAC;AACD,cAAU,UAAU,KAAK,IAAI;AAAA,EAC/B,IAAG;AAAA,IACD;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,QAAQ;AAAA,IACR;AAAA,IACA;AAAA,EACF,CAAC;AAED,SACE,gBAAAC,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,iBAAiB;AAAA,QACjB,cAAc;AAAA,QACd,GAAG;AAAA,QACH,IAAI;AAAA,QACJ,QACE,mBAAmB,CAAC,SAChB,aAAa,kBAAkB,mBAAmB,sBAAsB,KACxE;AAAA,MACR;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,aAC3B,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,OAAOC,OAAM,EAAE,iBAAiB,QAAQ,gBAAgB,CAAC,EACtD;AAAA,YACC,CAAC,EAAE,iBAAAC,kBAAiB,QAAAC,QAAO,MAAMD,oBAAmB,CAACC;AAAA,YACrD,CAAC,EAAE,iBAAAC,iBAAgB,MAAOA,mBAAkB,mBAAmB;AAAA,UACjE,EACC,UAAU,MAAM,iBAAiB;AAAA,UACpC,YAAY;AAAA,UACZ,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,KAAK;AAAA,QACP;AAAA;AAAA,MAECH,OAAM,EAAE,iBAAiB,WAAW,gBAAgB,CAAC,EACnD;AAAA,QACC,CAAC,EAAE,iBAAAC,kBAAiB,WAAAG,WAAU,MAAMH,oBAAmBG;AAAA,QACvD,CAAC,EAAE,iBAAAD,iBAAgB,MAAM;AACvB,iBAAOA,mBACL,gBAAAJ,SAAA,cAACM,kBAAA,EAAgB,QAAQ,IAAI,OAAO,IAAI,IAExC,gBAAAN,SAAA,cAACO,kBAAA,EAAgB,QAAQ,IAAI,OAAO,IAAI;AAAA,QAE5C;AAAA,MACF,EACC,UAAU,MAAM,IAAI;AAAA,MAAE;AAAA,MACf;AAAA,MAAM;AAAA,MAAK;AAAA,MAAe;AAAA,MAAG,KAAK,YAAY;AAAA,IAC1D,CACF;AAAA,IAEA,gBAAAP,SAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,EAAE,IAAI,MAAM,KACvC,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,OAAO,mBAAmB,KAAI,IAAK,GAChD,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK,EAAE,OAAO,sBAAsB,WAAW,EAAE,OAAO,oBAAoB,QAAQ,UAAU,EAAE;AAAA,QAChG,SAAS,MAAM,eAAe,UAAQ,CAAC,IAAI;AAAA;AAAA,MAE3C,gBAAAA,SAAA;AAAA,QAACQ;AAAA,QAAA;AAAA,UACC,OAAO,EAAE,WAAW,cAAc,mBAAmB,gBAAgB,YAAY,sBAAsB;AAAA;AAAA,MACzG;AAAA,IACF,CACF;AAAA,IAEA,gBAAAR,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK,EAAE,WAAW,cAAc,QAAQ,KAAK,YAAY,wBAAwB,WAAW,QAAQ,IAAI,KAAK;AAAA;AAAA,MAE5G,+CACC,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK;AAAA,UACL,eAAe;AAAA,UACf;AAAA,UACA;AAAA,UACA,oBAAoB,iCAAQ;AAAA,UAC5B;AAAA,UACA,WAAW;AAAA,UACX,gBAAgB,iCAAQ;AAAA,UACxB;AAAA,UACA,mBAAmB;AAAA,UACnB,WAAW,cAAc;AAAA;AAAA,MAC3B,IACE;AAAA,MAEH,mDACC,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,eAAe;AAAA,UACf;AAAA,UACA;AAAA,UACA,sBAAsB,iCAAQ;AAAA,UAC9B;AAAA,UACA,iBAAiB;AAAA,UACjB,oBAAoB;AAAA,UACpB,gBAAgB,iCAAQ;AAAA,UACxB;AAAA,UACA,mBAAmB;AAAA,UACnB,WAAW,cAAc;AAAA;AAAA,MAC3B,IACE;AAAA,IACN;AAAA,IACC,UACC,gBAAAA,SAAA,cAAC,mBAAgB,aAA0B,QAAQ,YAAY,UAAU,iBAAiB,QAAgB;AAAA,EAE9G;AAEJ;AAEA,IAAM,kBAAkB,CAAC,EAAE,aAAa,UAAU,QAAQ,OAAO,MAAM;AACrE,SACE,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,OAAM,KAAK,EAAE,KAAK,MAAM,GAAG,OAAO,KAC5D,WACC,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,YAAY,aAAa,OAAO,qBAAqB,KAC/D,SAAS,UAAU,YAAY,MAC/B,UAAU,CAAC,SAAS,UAAU,aAAa,MAC3C,CAAC,UAAU,CAAC,SAAS,UAAU,UAAU,IAC5C,IAEA,gBAAAA,SAAA,cAAC,UAAO,KAAK,EAAE,GAAG,WAAW,YAAY,YAAY,GAAG,UAAU,CAAC,aAAa,SAAS,UACtF,SAAS,WAAW,MACvB,CAEJ;AAEJ;;;ADzMO,IAAM,eAAe,CAAC;AAAA,EAC3B;AAAA,EACA;AAAA,EACA;AACF,MAIM;AAdN,MAAAS;AAeE,MAAI,EAAC,6BAAM,YAAW;AACpB,WAAO;AAAA,EACT;AAEA,QAAM,SAAS,KAAK,SAAS;AAC7B,QAAM,YAAY,KAAK,UAAU;AAEjC,SACE,gBAAAC,SAAA,cAAAA,SAAA,gBACG,UAAU,YAAY,gBAAAA,SAAA,cAAC,4BAAyB,MAAM,MAAM,IAAK,OACjED,MAAA,KAAK,cAAL,gBAAAA,IAAgB,IAAI,CAAC,UAAU,UAAO;AAzB7C,QAAAA;AA0BQ,2BAAAC,SAAA;AAAA,MAACC;AAAA,MAAA;AAAA,QACC,QAAQ,KAAK;AAAA,QACb;AAAA,QACA,WAAW,KAAK;AAAA,QAChB,WAAW,KAAK;AAAA,QAChB,KAAK,GAAG,SAAS,IAAI,IAAI,KAAK;AAAA,QAC9B,OAAO,SAAS;AAAA,QAChB,MAAM,SAAS;AAAA,QACf,MAAM,SAAS;AAAA,QACf,QAAQ,SAAS;AAAA,QACjB,kBAAgBF,MAAA,KAAK,cAAL,gBAAAA,IAAgB,WAAU;AAAA,QAC1C,SAAS,SAAS;AAAA,QAClB,mBAAmB,yDAAqB,SAAS;AAAA,QACjD,QAAQ,SAAS;AAAA,QACjB;AAAA,QACA,2BAA2B,KAAK;AAAA;AAAA,IAClC;AAAA,IAEJ;AAEJ;;;AE9CA;AAAA,OAAOG,YAAmC,aAAAC,aAAW,YAAAC,kBAAgB;AAO9D,IAAM,YAAY,CAAC;AAAA,EACxB;AAAA,EACA;AAAA,EACA;AACF,MAIM;AAfN,MAAAC,KAAAC,KAAA;AAgBE,QAAM,CAAC,cAAc,eAAe,IAAIC,WAAS,eAAe,kBAAkB,CAAC;AACnF,QAAM,kBAAiBF,MAAA,KAAK,cAAL,gBAAAA,IAAgB,KAAK,cAAY,SAAS,UAAU;AAC3E,QAAM,kBAAgBC,MAAA,KAAK,cAAL,gBAAAA,IAAgB,WAAU,KAAK;AAGrD,EAAAE,YAAU,MAAM;AACd,oBAAgB,eAAe,kBAAkB,CAAC;AAAA,EACpD,GAAG,CAAC,kBAAkB,CAAC;AAEvB,MAAK,CAAC,kBAAkB,CAAC,gBAAiB,GAAC,UAAK,cAAL,mBAAgB,SAAQ;AACjE,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,SAAA,cAAAA,SAAA,gBACG,KAAK,UAAU,IAAI,cAAY;AA/BtC,QAAAJ;AAgCQ,WAAO,iBAAgB,iDAAgB,WAAU,SAAS,QACxD,gBAAAI,SAAA;AAAA,MAACC;AAAA,MAAA;AAAA,QACC,KAAK,SAAS;AAAA,QACd,QAAQ,KAAK;AAAA,QACb,QAAQ,KAAK,SAAS;AAAA,QACtB,WAAW,KAAK;AAAA,QAChB,WAAW,KAAK;AAAA,QAChB,OAAO,SAAS;AAAA,QAChB,MAAM,SAAS;AAAA,QACf,MAAM,SAAS;AAAA,QACf,QAAQ,qCAAU;AAAA,QAClB,kBAAgBL,MAAA,KAAK,cAAL,gBAAAA,IAAgB,WAAU;AAAA,QAC1C,SAAS,SAAS;AAAA,QAClB,mBAAmB,yDAAqB,SAAS;AAAA,QACjD,QAAQ,SAAS;AAAA,QACjB,2BAA2B,KAAK;AAAA,QAChC;AAAA;AAAA,IACF,IACE;AAAA,EACN,CAAC,CACH;AAEJ;;;AHhCO,IAAM,SAAS,CAAC,EAAE,IAAI,aAAa,MAAgD;AACxF,QAAM,UAAUM,gBAAc;AAC9B,QAAM,OAAOC,cAAYC,gBAAe,EAAE,CAAC;AAC3C,QAAM,kBAAkBD,cAAYE,oBAAmB,6BAAM,SAAS,CAAC;AACvE,QAAM,cAAcF,cAAYG,mBAAiB;AACjD,QAAM,iBAAiB,CAAC,EAAC,2CAAa;AACtC,QAAM,EAAE,YAAY,IAAI,iBAAiB;AAEzC,QAAM,kBAAiB,6BAAM,UAAS,UAAU,KAAK,UAAU;AAC/D,QAAM,0BAA0BC,SAAO,KAAK;AAC5C,QAAM,CAAC,gBAAgB,iBAAiB,IAAIC,WAA2B,CAAC,CAAC;AACzE,QAAM,YAAYL,cAAYM,gBAAe;AAC7C,QAAM,cAAc,uCAAW;AAC/B,QAAM,iBAAiB,uCAAW;AAGlC,EAAAC,YAAU,MAAM;AACd,4BAAwB,UAAU;AAClC,sBAAkB,CAAC,CAAC;AAAA,EACtB,GAAG,CAAC,IAAI,iBAAiB,CAAC;AAE1B,EAAAA,YAAU,MAAM;AACd,UAAM,eAAe,MAAY;AAC/B,UAAI,QAAQ,QAAQ,uBAAuB,CAAC,wBAAwB,SAAS;AAC3E,cAAM,QAAQ,oBAAoB,iBAAiB,MAAM,IAAI;AAC7D,gCAAwB,UAAU;AAAA,MACpC;AAAA,IACF;AACA,iBAAa;AAAA,EACf,GAAG,CAAC,MAAM,QAAQ,mBAAmB,CAAC;AAEtC,EAAAA,YAAU,MAAM;AACd,QAAI,6BAAM,WAAW;AACnB,YAAM,qBAAqB,iBAAiB,KAAK,WAAW,aAAa,cAAc;AAEvF,+DAAoB,QAAQ,cAAY;AACtC,YAAI,UAAU;AACZ,4BAAkB,UAAQ;AA3DpC,gBAAAC,KAAAC,KAAA;AA4DY,kBAAM,WAAW,mBAAK;AACtB,sBAASD,MAAA,SAAS,CAAC,MAAV,gBAAAA,IAAa,aAAa,IAAI,EAAE,SAAQC,MAAA,SAAS,CAAC,MAAV,gBAAAA,IAAa,QAAQ,UAAS,cAAS,CAAC,MAAV,mBAAa,QAAQ;AACpG,mBAAO;AAAA,UACT,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF;AAAA,EACF,GAAG,CAAC,aAAa,6BAAM,WAAW,IAAI,cAAc,CAAC;AAErD,MAAI,CAAC,MAAM;AACT,WAAO;AAAA,EACT;AAEA,QAAM,qBAAqB,KAAK,SAAS,UAAU,KAAK,UAAU,aAAa,CAAC,KAAK;AAErF,SACE,gBAAAC,SAAA,cAACC,YAAA,EAAU,SAAO,QAChB,gBAAAD,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,KAAK;AAAA,QACL,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,GAAG;AAAA,QACH,OAAO;AAAA,QACP,cAAc;AAAA,MAChB;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS,MAAM,YAAY,WAAW,gBAAgB;AAAA,QACtD,KAAK,EAAE,QAAQ,WAAW,GAAG,sBAAsB,WAAW,EAAE,OAAO,mBAAmB,EAAE;AAAA;AAAA,MAE5F,gBAAAA,SAAA,cAACE,kBAAA,IAAgB;AAAA,IACnB;AAAA,IACA,gBAAAF,SAAA,cAAC,QAAK,SAAQ,QAAM,KAAK,KAAM;AAAA,IAC/B,gBAAAA,SAAA,cAAC,mBAAgB,QAAQ,KAAK,OAAO;AAAA,IACrC,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,YAAY;AAAA,UACZ,QAAQ;AAAA,UACR,WAAW,EAAE,SAAS,MAAM;AAAA,UAC5B,QAAQ;AAAA,QACV;AAAA;AAAA,MAEA,gBAAAA,SAAA,cAACG,aAAA,EAAU,SAAS,cAAc;AAAA,IACpC;AAAA,EACF,GAEA,gBAAAH,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,GAAG,UAAU,MAAM,SAAS,WAAW,OAAO,KAC3E,KAAK,UAAU,YACd,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,OAAO,sBAAsB,YAAY,YAAY,KAC/D,mBAAmB,eAAc,eAAY,KAAK,IACrD,IACE,MAEH,iBACC,gBAAAA,SAAA,cAAC,aAAU,MAAY,oBAAoB,gBAAgB,sBAAsB,mBAAmB,IAEpG,gBAAAA,SAAA,cAAC,gBAAa,MAAY,oBAAoB,gBAAgB,sBAAsB,mBAAmB,CAE3G,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,EAAE,GAAG,QAAQ,gBAAgB,OAAO,YAAY,UAAU,GAAG,MAAM,WAAW,2BAA2B;AAAA;AAAA,IAE7G,KAAK,UAAU,aAAa,kBAC3B,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK,EAAE,YAAY,aAAa,GAAG,cAAc;AAAA,QACjD,SAAS,MAAM,QAAQ,oBAAoB,SAAS,EAAE;AAAA;AAAA,MACvD;AAAA,MACM,KAAK;AAAA,IACZ;AAAA,IAED,qBACC,gBAAAA,SAAA,cAAC,UAAO,KAAK,EAAE,YAAY,aAAa,GAAG,cAAc,GAAG,SAAS,MAAM,YAAY,WAAW,OAAO,KAAG,kBAE5G,IACE;AAAA,EACN,CACF;AAEJ;;;ApB/HO,IAAM,QAAQ,MAAM;AACzB,QAAM,iBAAiB,kBAAkB;AACzC,QAAM,EAAE,YAAY,QAAQ,KAAK,IAAI,iBAAiB;AAEtD,MAAI,SAAS,WAAW,kBAAkB;AACxC,WAAO,gBAAAI,SAAA,cAAC,mBAAc;AAAA,EACxB,WAAW,SAAS,WAAW,kBAAkB;AAC/C,WAAO,gBAAAA,SAAA,cAAC,qBAAgB;AAAA,EAC1B,WAAW,SAAS,WAAW,MAAM;AACnC,WAAO,gBAAAA,SAAA,cAAC,UAAO,cAAc,gBAAgB,IAAI,QAAQ;AAAA,EAC3D,WAAW,SAAS,WAAW,SAAS;AACtC,WAAO,gBAAAA,SAAA,cAAC,sBAAmB,QAAgB;AAAA,EAC7C,OAAO;AACL,WAAO;AAAA,EACT;AACF;;;AwB9BA;AAAA,OAAOC,cAAW;AAClB,SAAS,aAAAC,mBAAiB;;;ACD1B;AAAA,OAAOC,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C,SAAS,uBAAuB,eAAAC,qBAAmB;AACnD,SAAS,qBAAqB;AAIvB,IAAM,aAAa,MAAM;AAC9B,QAAM,kBAAkBC,cAAY,qBAAqB;AACzD,SACE,mBACA,gBAAgB,QACd,gBAAAC,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,KAAK,EAAE,MAAM,SAAS,OAAO,oBAAoB,OAAO,EAAE,SAAS,OAAO,EAAE;AAAA;AAAA,IAE5E,gBAAAA,SAAA,cAAC,mBAAc;AAAA,IACf,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,iCAAK,aAAa,GAAG,IAArB,EAAwB,IAAI,KAAK,IAAG,OAAO,gBAAgB,QAChF,gBAAgB,IACnB;AAAA,EACF;AAGN;AAEA,IAAM,UAAU,OAAO,OAAO;AAAA,EAC5B,WAAW;AAAA,EACX,GAAG;AAAA,EACH,WAAW;AAAA,EACX,OAAO;AAAA,IACL,WAAW;AAAA,EACb;AACF,CAAC;AAEM,IAAM,OAAO,MAAM;AAlC1B,MAAAC;AAmCE,QAAM,aAAa,cAAc;AACjC,QAAM,QAAOA,MAAA,yCAAY,SAAZ,gBAAAA,IAAkB;AAC/B,QAAM,CAAC,WAAW,YAAY,IAAIC,WAAS,KAAK;AAEhD,EAAAC,YAAU,MAAM;AACd,QAAI,WAAW;AACb,mBAAa,KAAK;AAAA,IACpB;AAAA,EAEF,GAAG,CAAC,IAAI,CAAC;AAET,SAAO,QAAQ,CAAC,YACd,gBAAAH,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,MACL,KAAI;AAAA,MACJ,SAAS,OAAK;AACZ,UAAE,OAAO,UAAU;AACnB,qBAAa,IAAI;AAAA,MACnB;AAAA;AAAA,EACF,IACE;AACN;;;ACxDA;AAAA,OAAOI,cAAW;;;ACAlB;AAAA,OAAOC,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAKpC,IAAM,WAAW,CAAC,EAAE,UAAU,MAA2B;AAC9D,QAAM,CAAC,aAAa,cAAc,IAAIC,WAAS,iBAAiB,KAAK,IAAI,IAAI,UAAU,QAAQ,GAAG,KAAK,CAAC;AAExG,EAAAC,YAAU,MAAM;AACd,UAAM,aAAa,YAAY,MAAM;AACnC,qBAAe,iBAAiB,KAAK,IAAI,IAAI,UAAU,QAAQ,GAAG,KAAK,CAAC;AAAA,IAC1E,GAAG,GAAI;AAEP,WAAO,MAAM;AACX,oBAAc,UAAU;AAAA,IAC1B;AAAA,EACF,GAAG,CAAC,SAAS,CAAC;AAEd,SACE,gBAAAC,SAAA,cAAC,QAAK,KAAK,EAAE,OAAO,qBAAqB,KACvC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,UAAU,KAAG,YACnC,aAAY,MACvB,CACF;AAEJ;;;ADpBO,IAAM,iBAAiB,CAAC,EAAE,QAAQ,MAAsC;AAC7E,SACE,gBAAAC,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,GAAG,OAAO,KACnC,QAAQ,IAAI,CAAC,QAAQ,UACpB,gBAAAA,SAAA,cAACA,SAAM,UAAN,EAAe,KAAK,OAAO,SAAS,KAClC,QAAQ,KAAK,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,GAAG,MAAM,GAAG,MAAM,GAAG,UAAU,IAAI,sBAAsB,GAAG,OAAO,GAAG,GAC/F,OAAO,WAAW,WACjB,gBAAAA,SAAA,cAAC,YAAS,WAAW,QAAQ,IAE7B,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,qBAAqB,KAC/C,MACH,CAEJ,CACD,CACH;AAEJ;;;AFTO,IAAM,kBAAkB,MAAM;AACnC,QAAM,EAAE,YAAY,IAAI,oBAAoB;AAC5C,QAAM,kBAAkB,mBAAmB;AAC3C,SACE,gBAAAC,SAAA,cAAC,OAAI,KAAK,EAAE,MAAM,SAAS,UAAU,WAAW,KAC7C,kBACC,gBAAAA,SAAA,cAAC,QAAK,WAAU,OAAM,OAAM,UAAS,KAAI,OACvC,gBAAAA,SAAA,cAAC,UAAK,GACN,gBAAAA,SAAA,cAAC,0BAAqB,CACxB,IAEA,gBAAAA,SAAA,cAAC,0BAAqB,GAExB,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,IAAI,MAAM,KACpB,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,OAAO,oBAAoB,YAAY,aAAa,SAAS,kBAAkB,SAAS,GAAG,KAAG,aAE3G,GACA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,qBAAqB,KAC/C,WACH,CACF,CACF;AAEJ;AAEA,IAAM,uBAAuB,MAAM;AACjC,QAAM,EAAE,OAAO,QAAQ,IAAI,oBAAoB;AAC/C,QAAM,oBAAoB,kBAAkB,kBAAkB,YAAY;AAC1E,QAAM,kBAAkB,mBAAmB;AAC3C,SACE,gBAAAA,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,UAAU,UAAU,KAAK,GAAG,IAAI,eAAe,KAC7E,gBAAAA,SAAA,cAAC,QAAK,SAAQ,WAAU,OAAM,UAAS,KAAK,EAAE,GAAG,OAAO,KACtD,gBAAAA,SAAA,cAAC,QAAK,SAAQ,QAAM,KAAM,GACzB,CAAC,mBACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS;AAAA,MACT,KAAK;AAAA,QACH,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,WAAW,EAAE,SAAS,MAAM;AAAA,MAC9B;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAACC,aAAA,IAAU;AAAA,EACb,CAEJ,GACA,gBAAAD,SAAA,cAAC,kBAAe,SAAkB,CACpC;AAEJ;;;AI9DA;AAAA,OAAOE,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C,SAAS,YAAAC,kBAAgB;AAEzB,SAAS,SAAAC,eAAa;AACtB,SAAS,mBAAAC,kBAAiB,eAAAC,qBAAmB;AAC7C,SAAS,aAAAC,mBAAiB;;;ACL1B;AAAA,OAAOC,YAA2B,eAAAC,eAAa,UAAAC,gBAAc;AAC7D,SAAS,YAAAC,kBAAgB;AAGzB,SAAS,SAAAC,eAAa;AACtB,SAAS,wBAAwB,iBAAAC,iBAAe,eAAAC,eAAa,sBAAAC,4BAA0B;AACvF,SAAS,mBAAAC,wBAAuB;;;ACNhC;AAAA,OAAOC,YAAoB,eAAAC,eAAa,aAAAC,aAAW,UAAAC,UAAQ,YAAAC,kBAAgB;AAC3E,SAAS,YAAAC,kBAAgB;AACzB,OAAOC,WAAU;AACjB,OAAO,YAAY;AACnB,SAAuB,mBAAAC,kBAAiB,iBAAAC,iBAAe,eAAAC,qBAAmB;AAC1E,SAAS,aAAAC,YAAW,mBAAAC,kBAAiB,YAAAC,WAAU,oBAAAC,yBAAwB;;;ACLvE;AAAA,OAAOC,YAAS,YAAAC,kBAAgB;AAChC,SAAS,YAAAC,kBAAgB;AACzB,SAAS,mBAAAC,kBAAiB,iBAAAC,gBAAe,aAAAC,aAAW,WAAW,cAAAC,mBAAkB;;;ACFjF;AAAA,OAAOC,YAAS,WAAAC,WAAS,YAAAC,kBAAgB;AACzC,SAAS,YAAAC,kBAAgB;AACzB;AAAA,EAEE,eAAAC;AAAA,EACA;AAAA,EACA;AAAA,EACA,qBAAAC;AAAA,EACA,gCAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,aAAAC,YAAW,cAAAC,mBAAkB;AAUtC,IAAM,cAAc,MAAM;AACxB,SAAO,gBAAAC,SAAA,cAAC,OAAI,KAAK,EAAE,MAAM,MAAM,IAAI,oBAAoB,IAAI,MAAM,GAAG,SAAS,GAAG;AAClF;AAEA,IAAM,eAAe,CAAC;AAAA,EACpB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,OAAO;AACT,MAMM;AACJ,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAE5C,QAAMC,SAAO,CAAC,WACV,SAAS,OACT,CAACC,QAAgE;AAAhE,QAAAC,MAAAD,KAAE,WA1CT,IA0COC,KAAe,iBAAfA,KAAe,CAAb;AACD,2BAAAJ,SAAA,cAAC,uCAAS,OAAT,EAAe,KAAK,iBAAE,GAAG,WAAY,KAAK,SACxC,QACH;AAAA;AAEN,SACE,gBAAAA,SAAA;AAAA,IAACE;AAAA,IAAA;AAAA,MACC,eAAY;AAAA,MACZ,KAAK,EAAE,OAAO,UAAU,IAAI,OAAO,IAAI,MAAM,IAAI,mBAAmB;AAAA,MACpE;AAAA;AAAA,IAEA,gBAAAF,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK,EAAE,SAAS,QAAQ,YAAY,UAAU,KAAK,MAAM,YAAY,aAAa,OAAO,mBAAmB;AAAA;AAAA,MAE3G;AAAA,MACA;AAAA,IACH;AAAA,IACA,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,IAAI,QAAQ,OAAO,mBAAmB,KAC/D,cAAc,KACb,gBAAAA,SAAA,cAAC,WAAQ,OAAO,GAAG,WAAW,aAC5B,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,IAAI,SAAS,OAAO,EAAE,KAChC,gBAAAA,SAAA,cAAC,iBAAY,CACf,CACF,GAED,UAAU,gBAAAA,SAAA,cAACK,YAAA,EAAU,OAAO,IAAI,QAAQ,IAAI,CAC/C;AAAA,EACF;AAEJ;AAEA,IAAM,iBAAiBL,SAAM;AAAA,EAC3B,CAAC,EAAE,sBAAsB,MAAM,SAAS,MAAoE;AAC1G,WACE,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,YAAY,EAAE,KACvB,uBAAuB,gBAAAA,SAAA,cAAC,qBAAkB,OAAO,GAAG,GACrD,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK,EAAE,GAAG,UAAU,YAAY,aAAa,eAAe,aAAa,OAAO,qBAAqB;AAAA;AAAA,MAEpG;AAAA,IACH,CACF;AAAA,EAEJ;AACF;AAEA,IAAM,WAAWA,SAAM,KAAK,CAAC,EAAE,OAAO,MAA2B;AAC/D,QAAM,cAAsBM,cAAYC,6BAA4B;AACpE,QAAM,CAAC,EAAE,eAAe,IAAI,6BAA6B,cAAc,IAAI;AAC3E,QAAM,CAAC,EAAE,eAAe,IAAI,6BAA6B,cAAc,IAAI;AAC3E,SACE,gBAAAP,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,MAAM,gBAAAA,SAAA,cAACQ,aAAA,IAAW;AAAA,MAClB;AAAA,MACA;AAAA,MACA,SAAS,MAAM;AACb,wBAAgB,CAAC,CAAC;AAClB,wBAAgB,EAAE;AAAA,MACpB;AAAA;AAAA,EACF;AAEJ,CAAC;AAED,IAAM,WAAWR,SAAM,KAAK,CAAC,EAAE,MAAM,OAAO,MAAyC;AACnF,QAAM,cAAsBM,cAAY,gCAAgC,IAAI,CAAC;AAC7E,QAAM,CAAC,EAAE,eAAe,IAAI,6BAA6B,cAAc,IAAI;AAC3E,QAAM,CAAC,EAAE,eAAe,IAAI,6BAA6B,cAAc,IAAI;AAC3E,SACE,gBAAAN,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO;AAAA,MACP;AAAA,MACA;AAAA,MACA,SAAS,MAAM;AACb,wBAAgB,CAAC,CAAC;AAClB,wBAAgB,IAAI;AAAA,MACtB;AAAA;AAAA,EACF;AAEJ,CAAC;AAED,IAAM,WAAW,CAAC,EAAE,QAAQ,MAAM,OAAO,MAAyD;AAChG,QAAM,cAAsBM,cAAY,kCAAkC,MAAM,CAAC;AACjF,QAAM,CAAC,EAAE,eAAe,IAAI,6BAA6B,cAAc,IAAI;AAC3E,QAAM,CAAC,EAAE,eAAe,IAAI,6BAA6B,cAAc,IAAI;AAE3E,SACE,gBAAAN,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO;AAAA,MACP;AAAA,MACA;AAAA,MACA,SAAS,MAAM;AACb,wBAAgB,EAAE,IAAI,QAAQ,KAAK,CAAC;AACpC,wBAAgB,EAAE;AAAA,MACpB;AAAA;AAAA,EACF;AAEJ;AAEA,IAAM,4BAA4B,CAAC;AAAA,EACjC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAMM;AACJ,QAAM,QAAQ,iBAAiB;AAC/B,QAAM,gBAAgBS;AAAA,IACpB,MACE,MAAM;AAAA;AAAA,MAEJ,WACG,CAAC,eAAe,KAAK,KAAK,YAAY,EAAE,SAAS,YAAY,YAAY,CAAC,MAC3E,KAAK,SAASC,aAAY;AAAA,IAC9B;AAAA,IACF,CAAC,OAAO,WAAW;AAAA,EACrB;AAEA,QAAM,YAAYD,UAAQ,MAAM;AAC9B,QAAI,cAAiC,CAAC;AACtC,QAAI,uBAAuB,CAAC,aAAa;AACvC,oBAAc,CAAC,gBAAAT,SAAA,cAAC,YAAS,QAAQ,CAAC,gBAAgB,CAAC,gBAAgB,CAAE;AAAA,IACvE;AACA,QAAI,MAAM,SAAS,KAAK,CAAC,aAAa;AACpC,kBAAY,KAAK,gBAAAA,SAAA,cAAC,kBAAe,qBAAqB,uBAAqB,OAAK,CAAiB;AACjG,YAAM;AAAA,QAAQ,cACZ,YAAY,KAAK,gBAAAA,SAAA,cAAC,YAAS,KAAK,UAAU,QAAQ,iBAAiB,UAAU,MAAM,UAAU,CAAE;AAAA,MACjG;AAAA,IACF;AAEA,QAAI,cAAc,SAAS,GAAG;AAC5B,kBAAY;AAAA,QACV,gBAAAA,SAAA,cAAC,kBAAe,qBAAqB,uBAAuB,MAAM,SAAS,KAAG,cAAY;AAAA,MAC5F;AAAA,IACF;AACA,kBAAc;AAAA,MAAQ,UACpB,YAAY;AAAA,QACV,gBAAAA,SAAA,cAAC,YAAS,KAAK,KAAK,IAAI,MAAM,KAAK,MAAM,QAAQ,KAAK,IAAI,QAAQ,KAAK,OAAO,gBAAgB;AAAA,MAChG;AAAA,IACF;AAEA,WAAO;AAAA,EACT,GAAG,CAAC,qBAAqB,aAAa,cAAc,gBAAgB,OAAO,aAAa,CAAC;AAEzF,SACE,gBAAAA,SAAA,cAAC,SAAS,OAAT,EAAe,KAAK,EAAE,WAAW,QAAQ,WAAW,OAAO,IAAI,mBAAmB,KAChF,UAAU,IAAI,CAAC,MAAM,UACpB,gBAAAA,SAAA,cAAC,OAAI,KAAK,SAAQ,IAAK,CACxB,CACH;AAEJ;AAEO,IAAM,eAAe,CAAC,EAAE,MAAM,OAAO,MAAwC;AA3MpF,MAAAG,KAAAC;AA4ME,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,QAAQE,cAAYK,kBAAiB;AAC3C,QAAM,CAAC,QAAQ,SAAS,IAAIC,WAAS,EAAE;AAEvC,QAAM,uBAAuB,CAAC,GAACT,MAAA,qCAAU,SAAV,gBAAAA,IAAgB;AAC/C,QAAM,sBAAsB,CAAC,GAACC,MAAA,qCAAU,SAAV,gBAAAA,IAAgB;AAE9C,SACE,gBAAAJ,SAAA,cAAAA,SAAA,gBACG,MAAM,SAAS,KAAK,wBACnB,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,IAAI,KAAK,KACnB,gBAAAA,SAAA,cAAC,qBAAkB,UAAU,WAAW,aAAY,2BAA0B,CAChF,GAEF,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,cAAc;AAAA,MACd,gBAAgB;AAAA,MAChB,OAAO,uBAAuB,QAAQ,CAAC;AAAA,MACvC;AAAA,MACA,aAAa;AAAA;AAAA,EACf,CACF;AAEJ;;;ADpNO,IAAM,wBAAwB,MAAM;AAf3C,MAAAa,KAAAC;AAgBE,QAAM,CAAC,MAAM,OAAO,IAAIC,WAAS,KAAK;AACtC,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,uBAAuB,CAAC,GAACH,MAAA,qCAAU,SAAV,gBAAAA,IAAgB;AAC/C,QAAM,sBAAsB,CAAC,GAACC,MAAA,qCAAU,SAAV,gBAAAA,IAAgB;AAC9C,QAAM,QAAQ,iBAAiB;AAC/B,QAAM,eAAe,yBAAyB,cAAc,IAAI;AAChE,QAAM,eAAe,yBAAyB,cAAc,IAAI;AAChE,QAAM,mBAAmB,wBAAwB;AACjD,QAAM,YAAY,aAAa,QAAQ,gBAAgB;AAEvD,MAAI,EAAE,wBAAwB,uBAAuB,MAAM,SAAS,MAAM,CAAC,wBAAwB,CAAC,WAAW;AAC7G,WAAO;AAAA,EACT;AACA,SACE,gBAAAG,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,IAAI,MAAM,MAAM,SAAS,IAAI,KAAK,KAC5D,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,qBAAqB,KACnD,YAAY,OAAO,oBACtB,GAEC,WACC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK,EAAE,GAAG,sBAAsB,QAAQ,4BAA4B,GAAG,MAAM,GAAG,SAAS,IAAI,KAAK;AAAA,MAClG,KAAI;AAAA,MACJ,SAAS,OAAK;AACZ,gBAAQ,WAAS,CAAC,KAAK;AACvB,UAAE,gBAAgB;AAAA,MACpB;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,GAAG;AAAA,UACH,IAAI;AAAA,UACJ,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,KAAK;AAAA,UACL,eAAe,cAAc,aAAa,OAAO,eAAe;AAAA,QAClE;AAAA;AAAA,MAEC,cAAc,cAAc,WAC3B,gBAAAA,SAAA,cAAC,aAAU,OAAO,IAAI,QAAQ,IAAI,IAElC,gBAAAA,SAAA,cAACC,aAAA,EAAW,OAAO,IAAI,QAAQ,IAAI;AAAA,MAEpC,aAAa;AAAA,IAChB;AAAA,IACC,cACE,OAAO,gBAAAD,SAAA,cAACE,gBAAA,EAAc,OAAO,IAAI,QAAQ,IAAI,IAAK,gBAAAF,SAAA,cAACG,kBAAA,EAAgB,OAAO,IAAI,QAAQ,IAAI;AAAA,EAC/F,IAEA,gBAAAH,SAAA,cAAC,SAAS,MAAT,EAAc,MAAY,cAAc,WAAS,QAAQ,KAAK,KAC7D,gBAAAA,SAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,SAAO;AAAA,MACP,eAAY;AAAA,MACZ,KAAK;AAAA,QACH,YAAY;AAAA,QACZ,GAAG;AAAA,QACH,GAAG;AAAA,QACH,IAAI;AAAA,MACN;AAAA,MACA,UAAU;AAAA;AAAA,IAEV,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,GAAG,qBAAqB,GAAG,KAAI,OACzD,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,GAAG;AAAA,UACH,IAAI;AAAA,UACJ,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,KAAK;AAAA,UACL,eAAe,cAAc,aAAa,OAAO,eAAe;AAAA,QAClE;AAAA;AAAA,MAEC,cAAc,cAAc,WAC3B,gBAAAA,SAAA,cAAC,aAAU,OAAO,IAAI,QAAQ,IAAI,IAElC,gBAAAA,SAAA,cAACC,aAAA,EAAW,OAAO,IAAI,QAAQ,IAAI;AAAA,MAEpC,aAAa;AAAA,IAChB,GACC,aACC,gBAAAD,SAAA;AAAA,MAACG;AAAA,MAAA;AAAA,QACC,OAAO,EAAE,WAAW,OAAO,mBAAmB,gBAAgB,YAAY,uBAAuB;AAAA,QACjG,OAAO;AAAA,QACP,QAAQ;AAAA;AAAA,IACV,CAEJ;AAAA,EACF,GAEA,gBAAAH,SAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,UAAU;AAAA,QACV,WAAW;AAAA,QACX,IAAI;AAAA,MACN;AAAA,MACA,OAAM;AAAA,MACN,YAAY;AAAA;AAAA,IAEZ,gBAAAA,SAAA,cAAC,gBAAa,MAAM,cAAc,QAAQ,aAAa,IAAI;AAAA,EAC7D,CACF,CAEJ,GACC,WACC,gBAAAA,SAAA,cAAC,MAAM,MAAN,EAAW,MAAY,cAAc,WAAS,QAAQ,KAAK,KAC1D,gBAAAA,SAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,IAAI,KAAK,KAC7B,gBAAAA,SAAA;AAAA,IAAC,MAAM;AAAA,IAAN;AAAA,MACC,KAAK;AAAA,QACH,SAAS;AAAA,QACT,GAAG;AAAA,QACH,gBAAgB;AAAA,QAChB,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,cAAc;AAAA,MAChB;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,OAAO,sBAAsB,YAAY,YAAY,KAAG,WAAS;AAAA,IAC9E,gBAAAA,SAAA,cAAC,MAAM,OAAN,EAAY,KAAK,EAAE,OAAO,qBAAqB,KAC9C,gBAAAA,SAAA,cAACI,aAAA,IAAU,CACb;AAAA,EACF,GACA,gBAAAJ,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS,MAAM;AACb,gBAAQ,KAAK;AAAA,MACf;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,gBAAa,MAAM,cAAc,QAAQ,aAAa,IAAI;AAAA,EAC7D,CACF,CACF,IACE,IACN;AAEJ;;;AE5JA;AAAA,SAAS,eAAAK,qBAAmB;AAC5B,SAAS,iBAAAC,gBAAe,iBAAAC,iBAAe,eAAAC,qBAAmB;AAGnD,IAAM,sBAAsB,MAAM;AACvC,QAAM,aAAaC,gBAAc;AACjC,MAAI,mBAAmBC,cAAYC,eAAc,SAAS,SAAS,CAAC;AACpE,MAAI,qBAAqB,UAAa,qBAAqB,MAAM;AAC/D,uBAAmB;AAAA,EACrB;AACA,QAAM,kBAAkBC;AAAA,IACtB,aAAW;AACT,iBAAW,WAAW,SAAS,WAAW,SAAS,IAAI;AAAA,IACzD;AAAA,IACA,CAAC,UAAU;AAAA,EACb;AACA,SAAO,CAAC,kBAAkB,eAAe;AAC3C;;;ACjBA;AAAA,SAAS,aAAAC,aAAW,UAAAC,gBAAc;AAE3B,IAAM,uBAAuB,aAAW;AAC7C,QAAM,MAAMA,SAAO,IAAI;AACvB,EAAAD,YAAU,MAAM;AACd,QAAI,SAAS;AACX,iBAAW,MAAM;AANvB,YAAAE,KAAAC;AAOQ,cAAM,QAAOA,OAAAD,MAAA,IAAI,YAAJ,gBAAAA,IAAa,cAAc,uBAA3B,gBAAAC,IAA+C;AAC5D,cAAM,QAAQ,SAAS,cAAc,OAAO;AAC5C,cAAM,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBpB,qCAAM,YAAY;AAAA,MACpB,GAAG,CAAC;AAAA,IACN;AAAA,EACF,GAAG,CAAC,OAAO,CAAC;AAEZ,SAAO;AACT;;;AJNA,IAAMC,YAAW,OAAO,YAAY;AAAA,EAClC,OAAO;AAAA,EACP,IAAI;AAAA,EACJ,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,KAAK;AAAA,EACL,WAAW;AAAA,IACT,WAAW;AAAA,IACX,SAAS;AAAA,EACX;AACF,CAAC;AAED,SAAS,YAAY,EAAE,SAAS,GAAuC;AACrE,QAAM,CAAC,WAAW,YAAY,IAAIC,WAAS,KAAK;AAChD,QAAM,MAAM,qBAAqB,SAAS;AAC1C,SACE,gBAAAC,SAAA,cAACC,SAAQ,MAAR,EAAa,MAAM,WAAW,cAAc,gBAC3C,gBAAAD,SAAA,cAACC,SAAQ,SAAR,EAAgB,SAAO,MAAC,KAAK,EAAE,YAAY,OAAO,KACjD,gBAAAD,SAAA,cAAC,cAAe,IAAG,SACjB,gBAAAA,SAAA,cAACE,YAAA,IAAU,CACb,CACF,GACA,gBAAAF,SAAA,cAACC,SAAQ,QAAR,MACC,gBAAAD,SAAA;AAAA,IAACC,SAAQ;AAAA,IAAR;AAAA,MACC,aAAa;AAAA,MACb,YAAY;AAAA,MACZ,OAAM;AAAA,MACN,KAAK;AAAA,QACH,GAAG;AAAA,MACL;AAAA;AAAA,IAEA,gBAAAD,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,UAAU;AAAA,UACV,WAAW;AAAA,QACb;AAAA,QACA;AAAA;AAAA,MAEA,gBAAAA,SAAA,cAAC,UAAO,eAAe,UAAU,MAAMG,OAAM,iBAAgB,QAAO,cAAa,UAAS;AAAA,IAC5F;AAAA,EACF,CACF,CACF;AAEJ;AAEO,IAAM,aAAa,CAAC,EAAE,QAAQ,SAAS,MAAiE;AA7E/G,MAAAC,KAAAC,KAAA;AA8EE,QAAM,aAAaC,gBAAc;AACjC,QAAM,WAAWC,SAA4B,IAAI;AACjD,QAAM,CAAC,cAAc,eAAe,IAAI,oBAAoB;AAC5D,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,EAAE,UAAU,WAAW,IAAI,gCAAgC;AACjE,QAAM,wBAAsBJ,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,wBAAuB;AACnE,QAAM,YAAYK,cAAYC,gBAAe;AAC7C,QAAM,iBAAgBL,MAAA,qCAAU,SAAV,gBAAAA,IAAgB;AACtC,QAAM,iBAAiB,CAAC,GAAC,gDAAU,SAAV,mBAAgB,uBAAhB,mBAAoC;AAC7D,QAAM,eAAe,yBAAyB,cAAc,IAAI;AAChE,QAAM,CAAC,cAAc,eAAe,IAAI,6BAA6B,cAAc,IAAI;AACvF,QAAM,mBAAmB,wBAAwB;AACjD,QAAM,YAAY,aAAa,QAAQ,gBAAgB;AACvD,QAAM,yBAAyB,qBAAqB,EAAE,OAAO,KAAK,CAAC;AACnE,QAAM,kBAAkB,mBAAmB;AAC3C,QAAM,CAAC,uBAAuB,wBAAwB,IAAIN,WAAS,KAAK;AACxE,QAAM,uBAAuB,sBAAsB;AAEnD,EAAAY,YAAU,MAAM;AAhGlB,QAAAP,KAAAC;AAiGI,QAAI,CAAC,aAAa,MAAM,CAAC,gBAAgB,CAAC,CAAC,YAAY,EAAE,EAAE,SAAS,gBAAgB,GAAG;AACrF,sBAAgB,gBAAgB;AAAA,IAClC,OAAO;AAEL,UAAI,EAAE,YAAY,yBAAyB,GAACD,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,oBAAmB;AAC7E,SAAAC,MAAA,SAAS,YAAT,gBAAAA,IAAkB;AAAA,MACpB;AAAA,IACF;AAAA,EACF,GAAG,CAAC,kBAAkB,cAAc,cAAc,iBAAiB,UAAU,sBAAsB,qCAAU,IAAI,CAAC;AAElH,QAAM,mBAAmBO,cAAY,MAAM;AACzC,QAAI,SAAS,SAAS;AACpB,eAAS,QAAQ,MAAM,SAAS,GAAG,KAAK;AAAA,QACtC;AAAA,QACA,SAAS,QAAQ,QAAQ,KAAK,IAAI,SAAS,QAAQ,cAAc,KAAK,CAAC,IAAI;AAAA,MAC7E,CAAC;AAAA,IACH;AAAA,EACF,GAAG,CAAC,CAAC;AAEL,QAAM,oBAAoBA,cAAY,MAAM;AAC1C,QAAI,SAAS,SAAS;AACpB,eAAS,QAAQ,MAAM,SAAS,GAAG,KAAK,IAAI,IAAI,KAAK,IAAI,SAAS,QAAQ,cAAc,KAAK,CAAC,CAAC,CAAC;AAAA,IAClG;AAAA,EACF,GAAG,CAAC,CAAC;AAEL,QAAM,cAAcA,cAAY,MAAY;AA1H9C,QAAAR;AA2HI,UAAM,WAAUA,MAAA,qCAAU,YAAV,gBAAAA,IAAmB;AACnC,QAAI,CAAC,WAAW,CAAC,QAAQ,KAAK,EAAE,QAAQ;AACtC;AAAA,IACF;AACA,QAAI;AACF,UAAI,cAAc;AAChB,cAAM,WAAW,iBAAiB,SAAS,CAAC,YAAY,CAAC;AAAA,MAC3D,WAAW,aAAa,IAAI;AAC1B,cAAM,WAAW,kBAAkB,SAAS,aAAa,EAAE;AAAA,MAC7D,OAAO;AACL,cAAM,WAAW,qBAAqB,OAAO;AAAA,MAC/C;AACA,eAAS,QAAQ,QAAQ;AACzB,uBAAiB;AACjB,iBAAW,MAAM;AACf,eAAO,CAAC;AAAA,MACV,GAAG,CAAC;AAAA,IACN,SAAS,OAAO;AACd,YAAM,MAAM;AACZ,mBAAa,SAAS;AAAA,QACpB,OAAO,IAAI,QAAQ,WAAW,cAAc,IAAI,GAAG,aAAa,IAAI,yBAAyB,IAAI;AAAA,MACnG,CAAC;AAAA,IACH;AAAA,EACF,IAAG,CAAC,cAAc,cAAc,YAAY,MAAM,CAAC;AAEnD,EAAAO,YAAU,MAAM;AACd,UAAM,iBAAiB,SAAS;AAChC,QAAI,gBAAgB;AAClB,qBAAe,QAAQ;AACvB,wBAAkB;AAClB,+BAAyB,aAAa,SAAS,kBAAkB;AAAA,IACnE;AAAA,EACF,GAAG,CAAC,YAAY,CAAC;AAEjB,EAAAA,YAAU,MAAM;AACd,UAAM,iBAAiB,SAAS;AAChC,WAAO,MAAM;AACX,uBAAgB,iDAAgB,UAAS,EAAE;AAAA,IAC7C;AAAA,EACF,GAAG,CAAC,eAAe,CAAC;AAEpB,MAAI,wBAAwB;AAC1B,WAAO;AAAA,EACT;AAEA,SACE,gBAAAX,SAAA,cAAC,OAAI,KAAK,EAAE,UAAU,WAAW,KAC/B,gBAAAA,SAAA,cAAC,YACC,gBAAAA,SAAA,cAAC,2BAAsB,GACtB,kBAAkB,YAAY,gBAC7B,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,OAAM,KAAK,EAAE,IAAI,KAAK,GAAG,SAAS,OAAK,EAAE,gBAAgB,KACpF,gBAAAA,SAAA,cAACC,SAAQ,MAAR,MACC,gBAAAD,SAAA,cAACC,SAAQ,SAAR,EAAgB,SAAO,QACtB,gBAAAD,SAAA,cAAC,cAAW,KAAK,EAAE,QAAQ,2BAA2B,KACpD,gBAAAA,SAAA,cAACa,mBAAA,EAAiB,QAAO,MAAK,OAAM,MAAK,CAC3C,CACF,GACA,gBAAAb,SAAA,cAACC,SAAQ,QAAR,MACC,gBAAAD,SAAA;AAAA,IAACC,SAAQ;AAAA,IAAR;AAAA,MACC,OAAM;AAAA,MACN,MAAK;AAAA,MACL,SAAS,MAAM;AACb,cAAM,YAAY;AAAA,UAChB,SAAS;AAAA,UACT,WAAW;AAAA,YACT,QAAQ,uCAAW;AAAA,YACnB,QAAQ,uCAAW;AAAA,YACnB,UAAU,uCAAW;AAAA,UACvB;AAAA,UACA,WAAW,KAAK,IAAI;AAAA,QACtB;AACA,mBAAW,aAAa,kCAAkC,SAAS;AAAA,MACrE;AAAA,MACA,KAAK;AAAA,QACH,iBAAiB;AAAA,QACjB,SAAS;AAAA,QACT,YAAY;AAAA,QACZ,KAAK;AAAA,QACL,cAAc;AAAA,QACd,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,WAAW,EAAE,iBAAiB,eAAe;AAAA,MAC/C;AAAA;AAAA,IAEA,gBAAAD,SAAA,cAACc,kBAAA,IAAgB;AAAA,IACjB,gBAAAd,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,YAAY,YAAY,KAAG,YAErD;AAAA,EACF,CACF,CACF,CACF,IACE,IACN,GACC,aACC,gBAAAA,SAAA,cAAC,QAAK,SAAO,cAAS,YAAT,mBAAkB,kBAAiB,KAAK,WAAW,OAAO,KAAK,EAAE,KAAK,MAAM,GAAG,OAAO,KACjG,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,IAAI,iBAAiB,WAAW,iBAAiB;AAAA,QACjD,WAAW;AAAA,QACX,UAAU;AAAA,QACV,IAAI,iBAAiB,WAAW,OAAO;AAAA,QACvC,IAAI;AAAA,QACJ,UAAU;AAAA,QACV,GAAG;AAAA,QACH,OAAO;AAAA,UACL,WAAW;AAAA,UACX,WAAW;AAAA,QACb;AAAA,SACI,uBAAuB,EAAE,WAAW,OAAO,IAAI,EAAE,IAAI,CAAC;AAAA;AAAA,IAG3D;AAAA,IACD,gBAAAA,SAAA;AAAA,MAACF;AAAA,MAAA;AAAA,QACC,WAAW,qBAAqB;AAAA,QAChC,KAAK;AAAA,UACH,GAAG;AAAA,UACH,uBAAuB,EAAE,OAAO,mBAAmB;AAAA,UACnD,iBAAiB,EAAE,OAAO,kBAAkB;AAAA,UAC5C,kBAAkB,EAAE,OAAO,qBAAqB;AAAA,UAChD,QAAQ;AAAA,QACV;AAAA,QACA,aAAa;AAAA,QACb,KAAK;AAAA,QACL,UAAQ;AAAA,QACR,WAAW,EAAE,YAAY;AAAA,QACzB,YAAY,CAAM,UAAS;AACzB,cAAI,MAAM,QAAQ,SAAS;AACzB,gBAAI,CAAC,MAAM,YAAY,CAAC,uBAAuB;AAC7C,oBAAM,eAAe;AACrB,oBAAM,YAAY;AAAA,YACpB;AAAA,UACF;AAAA,QACF;AAAA,QACA,cAAa;AAAA,QACb,qBAAkB;AAAA,QAClB,UAAU,OAAK;AACb,4BAAkB;AAClB,mCAAyB,EAAE,OAAO,MAAM,SAAS,kBAAkB;AAAA,QACrE;AAAA,QACA,QAAQ;AAAA,QACR,SAAS,OAAK,EAAE,gBAAgB;AAAA,QAChC,OAAO,OAAK,EAAE,gBAAgB;AAAA,QAC9B,QAAQ,OAAK,EAAE,gBAAgB;AAAA;AAAA,IACjC;AAAA,IACC,CAAC,YAAY,CAAC,uBACb,gBAAAE,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,UAAU,WAAS;AACjB,cAAI,SAAS,SAAS;AACpB,qBAAS,QAAQ,SAAS,IAAI,MAAM,MAAM;AAAA,UAC5C;AAAA,QACF;AAAA;AAAA,IACF,IACE;AAAA,IACJ,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,WAAU;AAAA,QACV,SAAS;AAAA,QACT,UAAU;AAAA,QACV,KAAK;AAAA,UACH,IAAI;AAAA,UACJ,QAAQ;AAAA,UACR,IAAI;AAAA,UACJ,WAAW,EAAE,GAAG,WAAW,KAAK,qBAAqB;AAAA,QACvD;AAAA,QACA,eAAY;AAAA;AAAA,MAEZ,gBAAAA,SAAA,cAACe,WAAA,IAAS;AAAA,IACZ;AAAA,EACF,IACE,mBAAmB,yBACnB,gBAAAf,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,YAAY;AAAA,MACd;AAAA,MACA,KAAI;AAAA;AAAA,IAEJ,gBAAAA,SAAA,cAAC,aAAU,KAAK,EAAE,IAAI,mBAAmB,GAAG;AAAA,IAC5C,gBAAAA,SAAA,cAAC,gBAAa,UAAoB,YAAwB;AAAA,EAC5D,CACF,CAEJ,GAED,yBACC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,wBAAwB,YAAY,aAAa,IAAI,MAAM,IAAI,KAAK,KAAG,uCAExG,CAEJ;AAEJ;;;AK3TA;AAAA,OAAOgB,YAAS,eAAAC,qBAAmB;AACnC,SAAS,mBAAAC,kBAAiB,sBAAAC,qBAAoB,iBAAAC,iBAAe,eAAAC,qBAAmB;AAQzE,IAAM,aAAa,MAAM;AAThC,MAAAC,KAAAC;AAUE,QAAM,aAAaC,gBAAc;AACjC,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,mBAAmB,CAAC,GAACD,OAAAD,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,uBAAhB,gBAAAC,IAAoC;AAC/D,QAAM,EAAE,SAAS,gBAAgB,MAAM,WAAW,qBAAqB,GAAG,IACxEE,cAAYC,gDAA+C,CAAC,KAAK,CAAC;AAEpE,QAAM,YAAYD,cAAYE,gBAAe;AAE7C,QAAM,cAAcC;AAAA,IAClB,MAAS;AACP,mBAAM,WAAW,aAAa,kCAAkC;AAAA,QAC9D,SAAS;AAAA,QACT,WAAW,EAAE,UAAU,uCAAW,MAAM,QAAQ,uCAAW,gBAAgB,QAAQ,uCAAW,GAAG;AAAA,QACjG,WAAW,KAAK,IAAI;AAAA,MACtB,CAAC;AAAA;AAAA,IACH,CAAC,YAAY,SAAS;AAAA,EACxB;AAEA,SAAO,gBAAgB,OACrB,gBAAAC,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,KAAK,EAAE,cAAc,MAAM,IAAI,oBAAoB,GAAG,eAAe,GAAG,OAAO;AAAA;AAAA,IAE/E,gBAAAA,SAAA,cAAC,WACC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,YAAY,aAAa,OAAO,mBAAmB,KAAG,aAEhF,GACA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK,EAAE,OAAO,sBAAsB,UAAU,QAAQ,UAAU,UAAU,cAAc,WAAW;AAAA;AAAA,MACpG;AAAA,OAC0B,yDAAoB,aAAW,uCAAW,MAAK,QAAQ,yDAAoB;AAAA,IACtG,CACF;AAAA,IACC,mBACC,gBAAAA,SAAA,cAAC,UAAO,KAAK,EAAE,YAAY,aAAa,UAAU,OAAO,cAAc,KAAK,GAAG,SAAS,eAAa,QAErG,IAEA,gBAAAA,SAAA,cAAAA,SAAA,cAAE;AAAA,EAEN;AAEJ;AAEO,IAAM,cAAc,MAAM;AAC/B,QAAM,yBAAyB,qBAAqB,EAAE,OAAO,KAAK,CAAC;AACnE,MAAI,CAAC,wBAAwB;AAC3B,WAAO;AAAA,EACT;AACA,SACE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,KAAK,EAAE,cAAc,MAAM,IAAI,oBAAoB,GAAG,eAAe,GAAG,OAAO;AAAA;AAAA,IAE/E,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,sBAAsB,WAAW,UAAU,GAAG,OAAO,KAAG,2CAEzF;AAAA,EACF;AAEJ;;;ACxEA;AAAA,OAAOC,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C,SAAS,oBAAoB;AAC7B,SAAS,YAAAC,kBAAgB;AACzB,SAAS,sBAAAC,qBAAoB,eAAAC,qBAAmB;AAChD,SAAS,WAAAC,UAAS,iBAAiB;;;ACJnC;AAAA,OAAOC,cAAW;AAClB,SAAS,mBAAAC,kBAAiB,iBAAAC,sBAAqB;AAGxC,IAAM,kBAAkB,CAAC;AAAA,EAC9B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAKM;AACJ,MAAI,QAAQ,GAAG;AACb,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,KAAK,KAAK,KACxC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS;AAAA,MACT,KACE,UAAU,IACN,EAAE,QAAQ,eAAe,OAAO,kBAAkB,IAClD,EAAE,QAAQ,WAAW,OAAO,qBAAqB;AAAA;AAAA,IAGvD,gBAAAA,SAAA,cAACC,gBAAA,EAAc,QAAQ,IAAI,OAAO,IAAI;AAAA,EACxC,GACA,gBAAAD,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS;AAAA,MACT,KACE,UAAU,QAAQ,IACd,EAAE,QAAQ,eAAe,OAAO,kBAAkB,IAClD,EAAE,QAAQ,WAAW,OAAO,qBAAqB;AAAA;AAAA,IAGvD,gBAAAA,SAAA,cAACE,kBAAA,EAAgB,QAAQ,IAAI,OAAO,IAAI;AAAA,EAC1C,CACF;AAEJ;;;AC3CA;AAAA,OAAOC,cAAW;AAGX,IAAM,iBAAiB,CAAC,EAAE,OAAO,MAAM,MAAwC;AACpF,QAAM,cAAc,KAAK,IAAI,GAAG,KAAK;AAErC,MAAI,QAAQ,GAAG;AACb,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,KAAK,KAAK,KACvC,CAAC,GAAG,MAAM,WAAW,CAAC,EAAE,IAAI,CAAC,GAAG,MAC/B,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,YAAY;AAAA,QACZ,QAAQ;AAAA,QACR,aAAa,MAAM,QAAQ,qBAAqB;AAAA,MAClD;AAAA;AAAA,EACF,CACD,CACH;AAEJ;;;AFPA,IAAM,wBAAwB;AAEvB,IAAM,gBAAgB,MAAM;AAlBnC,MAAAC,KAAAC,KAAA;AAmBE,QAAM,iBAAiBC,cAAYC,0DAAoD,CAAC;AACxF,QAAM,CAAC,oBAAoB,qBAAqB,IAAIC,WAAS,CAAC;AAC9D,QAAM,EAAE,oBAAoB,IAAI,kBAAkB;AAClD,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAE5C,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,kBAAkB,CAAC,GAACL,MAAA,qCAAU,SAAV,gBAAAA,IAAgB;AAE1C,QAAM,CAAC,cAAc,eAAe,IAAII,WAAS,IAAI;AACrD,QAAM,yBAAuBH,MAAA,iDAAiB,wBAAjB,gBAAAA,IAAsC,SAAQ;AAC3E,QAAM,cAAc,qBAAqB,SAAS;AAElD,QAAM,4BAA4B,MAAM;AACtC,UAAM,gBAAgB,KAAK,IAAI,qBAAqB,GAAG,CAAC;AACxD,oBAAgB,eAAe,aAAa,EAAE,KAAK,SAAS,qBAAqB;AACjF,0BAAsB,aAAa;AAAA,EACrC;AAEA,QAAM,wBAAwB,MAAM;AAClC,UAAM,YAAY,KAAK,IAAI,qBAAqB,GAAG,eAAe,SAAS,CAAC;AAC5E,oBAAgB,eAAe,SAAS,EAAE,KAAK,SAAS,qBAAqB;AAC7E,0BAAsB,SAAS;AAAA,EACjC;AAEA,QAAM,gBAAgB,aAAa;AAAA,IACjC,YAAY,MAAM,sBAAsB;AAAA,IACxC,cAAc,MAAM,0BAA0B;AAAA,EAChD,CAAC;AAGD,EAAAK,YAAU,MAAM;AACd,UAAM,SAAQ,iDAAgB,WAAU;AACxC,QAAI,sBAAsB,OAAO;AAC/B,4BAAsB,QAAQ,CAAC;AAAA,IACjC;AAAA,EACF,GAAG,CAAC,oBAAoB,cAAc,CAAC;AAEvC,MAAI,CAAC,kBAAkB,eAAe,WAAW,GAAG;AAClD,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,GAAG,QAAQ,KAAK,KAAK,KAC9C,CAAC,WACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO;AAAA,MACP,OAAO,eAAe;AAAA,MACtB,cAAc;AAAA,MACd,UAAU;AAAA;AAAA,EACZ,IACE,MACJ,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,OAAO;AAAA,QACP,IAAI,cAAY,0CAAU,SAAV,mBAAgB,cAAa,wBAAwB;AAAA,QACrE,GAAG;AAAA,QACH,KAAK;AAAA,QACL,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,UAAU;AAAA,QACV,QAAQ;AAAA,MACV;AAAA,MACA,OAAM;AAAA,MACN,SAAQ;AAAA;AAAA,IAEP,WAAW,gBAAAA,SAAA,cAAC,kBAAe,OAAO,oBAAoB,OAAO,eAAe,QAAQ,IAAK;AAAA,IAE1F,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,GAAG;AAAA,UACH,WAAW;AAAA,UACX,WAAW;AAAA,UACX,WAAW;AAAA,UACX,WAAW;AAAA,UACX,YAAY;AAAA,YACV,OAAO;AAAA,UACT;AAAA,QACF;AAAA;AAAA,MAEA,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,SAAQ;AAAA,UACR,KAAK,EAAE,OAAO,mBAAmB;AAAA,WAC7B,gBAHL;AAAA,UAIC,QAAO,oBAAe,kBAAkB,MAAjC,mBAAoC;AAAA;AAAA,QAE3C,gBAAAA,SAAA;AAAA,UAAC;AAAA;AAAA,YACC,SAAS;AAAA,YACT,QAAQ,eAAe,wBAAwB,qBAAqB;AAAA;AAAA,QACtE;AAAA,QACC,cACC,gBAAAA,SAAA,cAAC,UAAK,OAAO,EAAE,QAAQ,UAAU,GAAG,SAAS,MAAM,gBAAgB,UAAQ,CAAC,IAAI,KAAG,QAC1E,eAAe,iBAAiB,UACzC,IACE;AAAA,MACN;AAAA,IACF;AAAA,IAEC,kBACC,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS,MAAM;AACb,8BAAoB,kBAAkB;AACtC,gCAAsB,KAAK,IAAI,GAAG,qBAAqB,CAAC,CAAC;AAAA,QAC3D;AAAA,QACA,KAAK;AAAA,UACH,QAAQ;AAAA,UACR,OAAO;AAAA,UACP,WAAW,EAAE,OAAO,mBAAmB;AAAA,UACvC,0BAA0B,EAAE,SAAS,kBAAkB;AAAA,UACvD,0BAA0B,EAAE,SAAS,mBAAmB;AAAA,QAC1D;AAAA,QACA,OAAM;AAAA;AAAA,MAEN,gBAAAA,SAAA,cAAC,aAAU,WAAU,iBAAgB,OAAO,EAAE,SAAS,OAAO,GAAG,QAAQ,IAAI,OAAO,IAAI;AAAA,MACxF,gBAAAA,SAAA,cAACC,UAAA,EAAQ,WAAU,iBAAgB,OAAO,EAAE,SAAS,QAAQ,GAAG,QAAQ,IAAI,OAAO,IAAI;AAAA,IACzF,IACE;AAAA,EACN,CACF;AAEJ;;;APnHO,IAAM,OAAO,MAAM;AAxB1B,MAAAC,KAAAC;AAyBE,QAAM,EAAE,UAAU,WAAW,IAAI,gCAAgC;AACjE,QAAM,UAAUC,SAAgC,IAAI;AACpD,QAAM,aAAaC,gBAAc;AACjC,QAAM,eAAeC,qBAAmB;AACxC,QAAM,EAAE,SAAS,gBAAgB,KAAK,IAAIC,cAAY,+BAA+C,CAAC,KAAK,CAAC;AAC5G,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,oBAAoB,mBAAmB;AAC7C,QAAM,oBAAoB,sBAAsB;AAChD,iCAA+B,QAAQ,kBAAkB,IAAI;AAC7D,QAAM,yBAAyB,qBAAqB,EAAE,OAAO,KAAK,CAAC;AAEnE,QAAM,iBAAiBC;AAAA,IACrB,CAAC,cAAc,MAAM;AArCzB,UAAAP;AAsCM,UAAI,QAAQ,WAAW,QAAQ,QAAQ,gBAAgB,cAAc,GAAG;AACtE,cAAM,gBAAgB,aAAa,SAAS,sBAAsB;AAClE,SAAAA,MAAA,QAAQ,YAAR,gBAAAA,IAAiB,aAAa,eAAe;AAC7C,8BAAsB,MAAM;AAzCpC,cAAAA;AA0CU,WAAAA,MAAA,QAAQ,YAAR,gBAAAA,IAAiB,aAAa,eAAe;AAAA,QAC/C,CAAC;AACD,mBAAW,eAAe,IAAI;AAAA,MAChC;AAAA,IACF;AAAA,IACA,CAAC,YAAY,YAAY;AAAA,EAC3B;AAEA,QAAM,YAAY,qBAAqB;AAEvC,SACE,gBAAAQ,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,MAAM;AAAA,QACN,KAAK;AAAA,MACP;AAAA;AAAA,IAEC,cAAYR,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,eAAc,CAAC,YAAY,OAAO,gBAAAQ,SAAA,cAAC,mBAAc;AAAA,IAC9E,gBAAAA,SAAA,cAAC,YAAS,KAAK,SAAS,gBAAgC;AAAA,IACxD,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,GAAG,QAAQ,KAAK,KAAK,KAC/C,gBAAAA,SAAA,cAAC,gBAAW,GACZ,gBAAAA,SAAA,cAAC,iBAAY,GACZ,cAAc,CAAC,iBAAiB,2BAC/B,gBAAAA,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,aAAU,KAAK,EAAE,IAAI,mBAAmB,GAAG,GAC5C,gBAAAA,SAAA,cAAC,gBAAa,UAAoB,YAAwB,CAC5D,CAEJ;AAAA,IACC,cAAYP,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,eAAc,CAAC,YAAY,gBAAAO,SAAA,cAAC,mBAAc,IAAK;AAAA,IAC3E,gBACC,gBAAAA,SAAA,cAAC,cAAW,QAAQ,kBAClB,gBAAAA,SAAA,cAAC,uBAAoB,gBAAgC,SAAkB,CACzE,IACE;AAAA,IACH,aACC,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,UAAU;AAAA,WACPC,QAAM,EAAE,mBAAmB,mBAAmB,eAAe,uBAAuB,CAAC,EACrF;AAAA,UACC;AAAA,YACE,mBAAmB;AAAA,YACnB,eAAe;AAAA,UACjB;AAAA,UACA,OAAO,EAAE,QAAQ,OAAO,OAAO,MAAM;AAAA,QACvC,EACC;AAAA,UACC;AAAA,YACE,mBAAmB;AAAA,YACnB,eAAe;AAAA,UACjB;AAAA,UACA,OAAO,EAAE,QAAQ,OAAO,OAAO,MAAM;AAAA,QACvC,EACC;AAAA,UACC;AAAA,YACE,mBAAmB;AAAA,YACnB,eAAe;AAAA,UACjB;AAAA,UACA,OAAO,EAAE,QAAQ,OAAO,OAAO,KAAK;AAAA,QACtC,EACC;AAAA,UACC;AAAA,YACE,mBAAmB;AAAA,YACnB,eAAe;AAAA,YACf,wBAAwB;AAAA,UAC1B;AAAA,UACA,OAAO,EAAE,QAAQ,OAAO,OAAO,KAAK;AAAA,QACtC,EACC;AAAA,UACC;AAAA,YACE,mBAAmB;AAAA,YACnB,eAAe;AAAA,YACf,wBAAwB;AAAA,UAC1B;AAAA,UACA,OAAO,EAAE,QAAQ,OAAO,OAAO,KAAK;AAAA,QACtC,EACC;AAAA,UACC;AAAA,YACE,mBAAmB;AAAA,YACnB,wBAAwB;AAAA,UAC1B;AAAA,UACA,OAAO,EAAE,QAAQ,OAAO,OAAO,KAAK;AAAA,QACtC,EACC,UAAU,OAAO,CAAC,EAAE;AAAA;AAAA,MAGzB,gBAAAD,SAAA,cAAC,mBAAc;AAAA,IACjB;AAAA,EAEJ;AAEJ;AAEA,IAAM,sBAAsB,CAAC;AAAA,EAC3B;AAAA,EACA;AACF,MAGM;AACJ,QAAM,cAAcH,cAAY,EAA4B;AAC5D,MAAI,CAAC,eAAe,CAAC,QAAQ,SAAS;AACpC,WAAO;AAAA,EACT;AAEA,QAAM,eAAe,QAAQ,QAAQ;AACrC,MACE,gBACA,aAAa,eAAe,aAAa,YAAY,aAAa,aAAa,aAAa,cAC5F;AACA,WAAO;AAAA,EACT;AAEA,SACE,gBAAAG,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,OAAO;AAAA,QACP,MAAM;AAAA,QACN,QAAQ;AAAA,QACR,UAAU;AAAA,MACZ;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,SAAS,MAAM;AACb,yBAAe,WAAW;AAAA,QAC5B;AAAA,QACA,MAAI;AAAA,QACJ,KAAK;AAAA,UACH,GAAG;AAAA,UACH,IAAI;AAAA,UACJ,WAAW,EAAE,IAAI,KAAK;AAAA,UACtB,cAAc;AAAA,UACd,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,GAAG;AAAA,QACL;AAAA;AAAA,MACD;AAAA,MACM,gBAAgB,IAAI,YAAY;AAAA,MACrC,gBAAAA,SAAA,cAACE,kBAAA,EAAgB,QAAQ,IAAI,OAAO,IAAI;AAAA,IAC1C;AAAA,EACF;AAEJ;;;AU7LA;AAAA,OAAOC,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C,SAAS,iBAAiB;AAC1B,SAAS,cAAAC,mBAAkB;AAC3B,SAAS,oBAAAC,yBAAwB;AACjC,SAAS,2BAAAC,0BAAyB,eAAAC,eAAa,4BAAAC,iCAAgC;AAC/E,SAAS,mBAAAC,kBAAiB,aAAAC,mBAAiB;AAY3C,IAAM,uBAAuB,CAAC;AAAA,EAC5B;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,EAAE,KAAK,OAAO,IAAI,UAAU;AAClC,QAAM,CAAC,YAAY,aAAa,IAAIC,WAAS,KAAK;AAElD,EAAAC,YAAU,MAAM;AACd,QAAI,WAAW,UAAU,CAAC,YAAY;AACpC,oBAAc,IAAI;AAClB,eAAS,EACN,MAAM,QAAQ,KAAK,EACnB,QAAQ,MAAM,cAAc,KAAK,CAAC;AAAA,IACvC;AAAA,EACF,GAAG,CAAC,SAAS,UAAU,QAAQ,UAAU,CAAC;AAC1C,SACE,gBAAAC,SAAA,cAAC,QAAK,KAAU,OAAc,OAAM,UAAS,SAAQ,YAClD,aAAa,gBAAAA,SAAA,cAAC,WAAQ,MAAM,IAAI,IAAK,IACxC;AAEJ;AAEA,IAAMC,8BAA6BD,SAAM;AAAA,EACvC,CAAC;AAAA,IACC;AAAA,IACA,MAAAE;AAAA,IACA;AAAA,EACF,MAIM;AACJ,QAAI,CAACA,MAAK,SAAS,KAAK,GAAG;AACzB,aAAO,gBAAAF,SAAA,cAAC,wBAAqB,SAASE,MAAK,SAAS,UAAUA,MAAK,eAAe,OAAc;AAAA,IAClG;AACA,WACE,gBAAAF,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAKE,MAAK,SAAS,KAAK,EAAE;AAAA,QAC1B,MAAMA,MAAK,SAAS,KAAK;AAAA,QACzB,aAAaA,MAAK;AAAA,QAClB;AAAA;AAAA,IACF;AAAA,EAEJ;AACF;AAEO,IAAM,wBAAwB,CAAC,EAAE,UAAU,OAAO,MAAgD;AACvG,QAAM,EAAE,OAAO,OAAO,SAAS,WAAW,cAAc,IAAIC,0BAAyB,EAAE,MAAM,UAAU,OAAO,GAAG,CAAC;AAClH,QAAM,CAAC,QAAQ,SAAS,IAAIL,WAAiB,EAAE;AAC/C,QAAM,gBAAgB,MAAM,OAAO,OAAE;AAvEvC,QAAAM;AAuE0C,YAAAA,MAAA,EAAE,SAAF,gBAAAA,IAAQ,cAAc,SAAS,iCAAQ;AAAA,GAAc;AAC7F,QAAM,cAAcC,cAAYC,wBAAuB;AACvD,QAAM,CAAC,KAAK,EAAE,MAAM,CAAC,IAAIC,YAA2B;AACpD,QAAM,SAAS,cAAc,cAAc,SAAS;AACpD,QAAM,gBAAgB,iBAAiB;AAEvC,EAAAR,YAAU,MAAM;AACd,cAAU;AAAA,EAEZ,GAAG,CAAC,CAAC;AAEL,SACE,gBAAAC,SAAA,cAAC,QAAK,KAAU,WAAU,UAAS,KAAK,EAAE,MAAM,QAAQ,KAAK,KAAK,KAChE,gBAAAA,SAAA,cAAC,QAAK,OAAM,YACV,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,MAAM,SAAS,QAAQ,UAAU,GAAG,SAAS,UACvE,gBAAAA,SAAA,cAACQ,kBAAA,IAAgB,GACjB,gBAAAR,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,MAAM,QAAQ,KAAG,cAE3C,CACF,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS,OAAK;AACZ,UAAE,gBAAgB;AAClB,sBAAc;AAAA,MAChB;AAAA,MACA,eAAY;AAAA;AAAA,IAEZ,gBAAAA,SAAA,cAACS,aAAA,IAAU;AAAA,EACb,CACF,GACA,gBAAAT,SAAA,cAAC,qBAAkB,UAAU,CAACU,YAAmB,UAAUA,OAAM,GAAG,aAAa,cAAc,QAAQ,IAAI,GAC3G,gBAAAV,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,QAAQ,6BAA6B,cAAc,MAAM,MAAM,QAAQ,KACrG,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,QAAQ,YAAY,cAAc,6BAA6B,IAAI,KAAK,KAClG,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,UAAU,WAAW,KAC/B,UAAS,KAAE,kBAAkB,MAAM,MAAM,GAAE,KAAE,kBAAkB,KAAK,GAAE,GACzE,CACF,GACA,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,MAAM,SAAS,WAAW,QAAQ,WAAW,UAAU,IAAI,OAAO,KAC5E,gBAAAA,SAAA;AAAA,IAACW;AAAA,IAAA;AAAA,MACC,UAAU,WAAU,UAAU,cAAc,SAAS,IAAI,KAAK;AAAA,MAC9D,UAAU,EAAE,UAAU,eAAe,SAAS,QAAQ,GAAG,eAAe,aAAa,gBAAgB,KAAK;AAAA,MAC1G;AAAA,MACA,WAAW,cAAc,SAAS;AAAA,MAClC;AAAA,MACA;AAAA;AAAA,IAECV;AAAA,EACH,CACF,CACF,CACF;AAEJ;;;AC3HA;AAAA,OAAOW,cAAW;AAClB,SAAS,mBAAAC,kBAAiB,sBAAAC,qBAAoB,iBAAAC,iBAAe,eAAAC,qBAAmB;AAChF,SAAS,mBAAAC,kBAAiB,gBAAAC,qBAAoB;AAOvC,IAAM,eAAe,MAAM;AATlC,MAAAC,KAAAC;AAUE,QAAM,aAAaC,gBAAc;AACjC,QAAM,YAAYC,cAAYC,gBAAe;AAC7C,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,eAAe,CAAC,GAACH,OAAAD,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,uBAAhB,gBAAAC,IAAoC;AAC3D,QAAM,EAAE,SAAS,gBAAgB,KAAK,IAAIE,cAAYE,gDAA+C,CAAC,KAAK,CAAC;AAC5G,QAAM,YAAY,gBAAgB;AAElC,MAAI,CAAC,WAAW;AACd,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,SAAA,cAACC,SAAQ,MAAR,MACC,gBAAAD,SAAA,cAACC,SAAQ,SAAR,EAAgB,SAAO,MAAC,KAAK,EAAE,IAAI,KAAK,KACvC,gBAAAD,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK,EAAE,OAAO,sBAAsB,WAAW,EAAE,OAAO,mBAAmB,GAAG,QAAQ,UAAU;AAAA;AAAA,IAEhG,gBAAAA,SAAA,cAACE,eAAA,IAAa;AAAA,EAChB,CACF,GACA,gBAAAF,SAAA,cAACC,SAAQ,QAAR,MACC,gBAAAD,SAAA;AAAA,IAACC,SAAQ;AAAA,IAAR;AAAA,MACC,OAAM;AAAA,MACN,MAAK;AAAA,MACL,YAAY;AAAA,MACZ,SAAS,MAAM;AACb,cAAM,YAAY;AAAA,UAChB,SAAS;AAAA,UACT,WAAW;AAAA,YACT,QAAQ,uCAAW;AAAA,YACnB,QAAQ,uCAAW;AAAA,YACnB,UAAU,uCAAW;AAAA,UACvB;AAAA,UACA,WAAW,KAAK,IAAI;AAAA,QACtB;AACA,mBAAW,aAAa,kCAAkC,SAAS;AAAA,MACrE;AAAA,MACA,KAAK;AAAA,QACH,iBAAiB;AAAA,QACjB,SAAS;AAAA,QACT,YAAY;AAAA,QACZ,KAAK;AAAA,QACL,cAAc;AAAA,QACd,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,WAAW,EAAE,iBAAiB,eAAe;AAAA,MAC/C;AAAA;AAAA,IAEA,gBAAAD,SAAA,cAACG,kBAAA,IAAgB;AAAA,IACjB,gBAAAH,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,YAAY,YAAY,KAAG,YAErD;AAAA,EACF,CACF,CACF;AAEJ;;;AZhDA,IAAM,gBAAgB;AAAA,EACpB,OAAO;AAAA,EACP,GAAG;AAAA,EACH,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,GAAG;AAAA,EACH,gBAAgB;AAAA,EAChB,0BAA0B;AAAA,IACxB,OAAO;AAAA,EACT;AACF;AAEA,IAAMI,oBAAmB,CAAC,EAAE,MAAM,MAAyB;AACzD,SAAO,QAAQ,MACb,gBAAAC,SAAA,cAAC,cAAK,KAAE,OAAM,GAAC,IAEf,gBAAAA,SAAA,cAAC,WAAQ,OAAO,SACd,gBAAAA,SAAA,cAAC,cAAK,KAAE,kBAAkB,KAAK,GAAE,GAAC,CACpC;AAEJ;AAEO,IAAM,eAAeA,SAAM,KAG/B,CAAC,EAAE,SAAS,kBAAkB,MAAM,UAAU,MAAM,MAAM;AA5C7D,MAAAC,KAAAC;AA6CE,QAAM,aAAa,kBAAkB,kBAAkB,IAAI;AAC3D,QAAM,qBAAqB,kBAAkB,kBAAkB,YAAY;AAC3E,QAAM,gBAAgB,iBAAiB;AACvC,QAAM,CAAC,WAAW,YAAY,IAAIC,WAAS,MAAM;AACjD,QAAM,CAAC,YAAY,aAAa,IAAIA,WAAS,EAAE;AAC/C,QAAM,YAAYC,cAAYC,gBAAe;AAC7C,QAAM,EAAE,UAAU,WAAW,IAAI,gCAAgC;AACjE,QAAM,eAAaJ,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,eAAc;AACjD,QAAM,WAAW,CAAC,EAAC,qCAAU;AAC7B,QAAM,mBAAmB,CAAC,EAAC,qCAAU;AACrC,QAAM,WAAW,EAAE,YAAY,qBAAqB;AACpD,QAAM,WAAWK,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,gBAAgB,CAAC,GAACJ,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,eAAc;AACtD,QAAM,EAAE,kBAAkB,CAAC,EAAE,KAAK,qCAAiD,iBAAgB,CAAC;AACpG,QAAM,aAAa,sBAAsB,kBAAkB,IAAI;AAC/D,QAAM,mBAAmB,YAAY,eAAe,CAAC,YAAY,CAAC;AAElE,EAAAK,YAAU,MAAM;AACd,IAAAC,QAAM,EAAE,WAAW,UAAU,iBAAiB,CAAC,EAC5C,KAAK,EAAE,WAAW,kBAAkB,MAAM,UAAU,OAAO,kBAAkB,KAAK,GAAG,MAAM;AAC1F,mBAAa,kBAAkB,YAAY;AAAA,IAC7C,CAAC,EACA,KAAK,EAAE,WAAW,kBAAkB,cAAc,UAAU,MAAM,kBAAkB,MAAM,GAAG,MAAM;AAClG,mBAAa,kBAAkB,IAAI;AAAA,IACrC,CAAC,EACA,KAAK,EAAE,UAAU,OAAO,kBAAkB,MAAM,GAAG,MAAM;AACxD,oBAAc;AAAA,IAChB,CAAC;AAAA,EACL,GAAG,CAAC,UAAU,WAAW,kBAAkB,aAAa,CAAC;AAEzD,EAAAD,YAAU,MAAM;AACd,iBAAa,MAAM;AAAA,EACrB,GAAG,CAAC,MAAM,CAAC;AAEX,MAAI,YAAY;AACd,WACE,gBAAAP,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,WAAU;AAAA,QACV,KAAK;AAAA,UACH,OAAO;AAAA,UACP,GAAG;AAAA,UACH,YAAY;AAAA,UACZ,UAAU;AAAA,QACZ;AAAA;AAAA,MAEA,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,UAAU,YAAY,MAAM,GAAG,KAAK,GAAG,MAAM,QAAQ,QAAQ,IAAI,IAAI,eAAe,KAC9F,gBAAAA,SAAA,cAAC,yBAAsB,UAAU,YAAY,QAAQ,MAAM,cAAc,EAAE,GAAG,CAChF;AAAA,IACF;AAAA,EAEJ;AAEA,SACE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,KAAK;AAAA,QACH,OAAO;AAAA,QACP,GAAG;AAAA,QACH,YAAY;AAAA,MACd;AAAA;AAAA,IAECQ,QAAM,EAAE,eAAe,YAAY,UAAU,SAAS,CAAC,EACrD,KAAK,EAAE,eAAe,MAAM,YAAY,MAAM,UAAU,KAAK,GAAG,MAAM,gBAAAR,SAAA,cAAC,UAAK,CAAE,EAC9E,KAAK,EAAE,UAAU,KAAK,GAAG,MAAM;AAC9B,aACE,gBAAAA,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,EAAE,GAAG,QAAQ,WAAW,EAAE,SAAS,OAAO,EAAE,KACvE,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,SAAQ;AAAA,UACR,KAAK;AAAA,YACH,YAAY;AAAA,YACZ,GAAG;AAAA,YACH,GAAG;AAAA,YACH,IAAI;AAAA,YACJ,WAAW,EAAE,SAAS,OAAO;AAAA,UAC/B;AAAA;AAAA,QAEC,cAAc,kBAAkB,OAC/B,eAAe,wBAAwB,aAEvC,gBAAAA,SAAA,cAAC,cAAK,oBAEJ,gBAAAA,SAAA,cAACD,mBAAA,EAAiB,OAAO,WAAW,CACtC;AAAA,MAEJ,GACA,gBAAAC,SAAA,cAAC,YACE,mBAAmB,gBAAAA,SAAA,cAAC,kBAAa,IAAK,MACtC,iBAAiB,aAAa,OAC7B,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK;AAAA,YACH,IAAI;AAAA,YACJ,OAAO;AAAA,YACP,WAAW,EAAE,OAAO,mBAAmB;AAAA,YACvC,WAAW,EAAE,SAAS,OAAO;AAAA,UAC/B;AAAA,UACA,SAAS,OAAK;AACZ,cAAE,gBAAgB;AAClB,gBAAI,cAAc,kBAAkB,MAAM;AACxC,yBAAW;AAAA,YACb,OAAO;AACL,iCAAmB;AAAA,YACrB;AAAA,UACF;AAAA,UACA,eAAY;AAAA;AAAA,QAEX,eAAe,wBAAwB,aAAa,OAAO,gBAAAA,SAAA,cAACS,aAAA,IAAU;AAAA,MACzE,CAEJ,CACF,GACC,cAAc,kBAAkB,OAC/B,gBAAAT,SAAA,cAAC,UAAK,IAEN,gBAAAA,SAAA,cAAC,mBAAgB,eAAe,iBAAiB,UAAU,eAAe,CAE9E;AAAA,IAEJ,CAAC,EACA,UAAU,MAAM;AACf,aACE,gBAAAA,SAAA;AAAA,QAAC,KAAK;AAAA,QAAL;AAAA,UACC,OAAO;AAAA,UACP,eAAe;AAAA,UACf,KAAK;AAAA,YACH,eAAe;AAAA,YACf,MAAM;AAAA,UACR;AAAA;AAAA,QAEA,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,OAAO,KACrB,gBAAAA,SAAA,cAAC,KAAK,MAAL,EAAU,KAAK,EAAE,UAAU,GAAG,cAAc,MAAM,IAAI,mBAAmB,KACxE,gBAAAA,SAAA,cAAC,KAAK,SAAL,EAAa,OAAO,kBAAkB,MAAM,SAAS,YAAY,KAAK,iBACpE,UACH,GACA,gBAAAA,SAAA,cAAC,KAAK,SAAL,EAAa,OAAO,kBAAkB,cAAc,SAAS,oBAAoB,KAAK,iBAAe,oBAEpG,gBAAAA,SAAA,cAACD,mBAAA,EAAiB,OAAO,WAAW,CACtC,CACF,GACC,mBAAmB,gBAAAC,SAAA,cAAC,kBAAa,IAAK,MACtC,iBAAiB,aAAa,OAC7B,gBAAAA,SAAA;AAAA,UAAC;AAAA;AAAA,YACC,KAAK,EAAE,IAAI,MAAM,OAAO,sBAAsB,WAAW,EAAE,OAAO,mBAAmB,EAAE;AAAA,YACvF,SAAS,OAAK;AACZ,gBAAE,gBAAgB;AAClB,kBAAI,cAAc,kBAAkB,MAAM;AACxC,2BAAW;AAAA,cACb,OAAO;AACL,mCAAmB;AAAA,cACrB;AAAA,YACF;AAAA,YACA,eAAY;AAAA;AAAA,UAEZ,gBAAAA,SAAA,cAACS,aAAA,IAAU;AAAA,QACb,CAEJ;AAAA,QACA,gBAAAT,SAAA,cAAC,KAAK,SAAL,EAAa,OAAO,kBAAkB,cAAc,KAAK,EAAE,GAAG,EAAE,KAC/D,gBAAAA,SAAA,cAAC,mBAAgB,eAAe,iBAAiB,UAAU,eAAe,CAC5E;AAAA,QACA,gBAAAA,SAAA,cAAC,KAAK,SAAL,EAAa,OAAO,kBAAkB,MAAM,KAAK,EAAE,GAAG,EAAE,KACvD,gBAAAA,SAAA,cAAC,UAAK,CACR;AAAA,MACF;AAAA,IAEJ,CAAC;AAAA,EACL;AAEJ,CAAC;;;AarND;AAAA,OAAOU,YAAS,eAAAC,eAAa,WAAAC,WAAS,YAAAC,kBAAgB;AACtD,SAAS,cAAAC,mBAAkB;AAC3B;AAAA,EACE,4BAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,4BAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,4BAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,aAAa,YAAAC,WAAU,cAAAC,mBAAkB;;;ACblD;AAAA,OAAOC,cAAW;AAClB;AAAA,EACE,eAAAC;AAAA,EACA,sBAAAC;AAAA,EACA;AAAA,EACA,sBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,YAAAC,WAAU,WAAAC,UAAS,mBAAAC,kBAAiB,qBAAqB;AAKlE,IAAM,iBAAiB,CAAC;AAAA,EACtB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAMM;AACJ,QAAM,cAAcC,cAAYC,gDAA8C,CAAC,MAAM;AACrF,QAAM,sBAAsB,CAAC,CAACD,cAAY,0BAA0B,MAAM,CAAC;AAC3E,QAAM,WAAWA,cAAYE,oBAAmB,MAAM,CAAC;AACvD,SACE,gBAAAC,SAAA,cAACC,UAAA,MACE,CAAC,YACA,gBAAAD,SAAA,cAAAA,SAAA,gBACG,OACC,gBAAAA,SAAA,cAAC,QAAK,OAAM,YACT,aAAaE,aAAY,OACxB,gBAAAF,SAAA,cAAC,mBACC,gBAAAA,SAAA,cAACG,WAAA,EAAS,OAAM,MAAK,QAAO,MAAK,CACnC,GAED,uBACC,gBAAAH,SAAA,cAAC,mBACC,gBAAAA,SAAA,cAACI,kBAAA,EAAgB,OAAM,MAAK,QAAO,MAAK,CAC1C,GAED,UACC,gBAAAJ,SAAA,cAAC,mBACC,gBAAAA,SAAA,cAACK,UAAA,EAAQ,OAAM,MAAK,QAAO,MAAK,CAClC,GAED,eACC,gBAAAL,SAAA,cAAC,mBACC,gBAAAA,SAAA,cAAC,iBAAc,OAAM,MAAK,QAAO,MAAK,CACxC,GAEF,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,eAAe;AAAA,SACX,QAAQ,aAAc,QAAmB,EAAE,IAAI,CAAC;AAAA,MAEtD,SAAQ;AAAA;AAAA,IAEP;AAAA,EACH,CACF,IACE,MACJ,gBAAAA,SAAA,cAAC,uBAAoB,QAAM,MAAC,QAAgB,QAAM,MAAC,CACrD,IACE,IACN;AAEJ;AAEA,IAAM,cAAc,OAAO,OAAO,EAAE,GAAG,oBAAoB,IAAI,MAAM,IAAI,MAAM,SAAS,OAAO,CAAC;AAEhG,IAAMC,WAAU,OAAO,OAAO;AAAA,EAC5B,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,gBAAgB;AAAA,EAChB,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,MAAM;AAAA,EACN,iBAAiB;AAAA,EACjB,cAAc;AAAA,EACd,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,YAAY;AAAA,IACV,GAAG;AAAA,EACL;AACF,CAAC;AAED,IAAO,yBAAQ;;;AC5Ff;AAAA,OAAOK,YAAS,YAAAC,kBAAgB;AAChC,SAAS,YAAAC,kBAAgB;AACzB;AAAA,EAEE,qBAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,4BAAAC;AAAA,EACA,eAAAC;AAAA,EACA,qBAAAC;AAAA,OACK;AACP,SAAS,aAAAC,aAAW,oBAAAC,yBAAwB;;;ACZ5C;AAAA,OAAOC,YAAS,YAAAC,kBAAgB;AAChC,SAAS,YAAAC,kBAAgB;AACzB;AAAA,EAKE,4BAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,EACA;AAAA,OACK;AACP;AAAA,EACE,cAAAC;AAAA,EACA,aAAAC;AAAA,EACA;AAAA,EACA,sBAAAC;AAAA,EACA,WAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA;AAAA,EACA,eAAAC;AAAA,EACA,YAAAC;AAAA,EACA,gBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;;;AC7BP;AAIO,IAAM,mBAAmB,MAAM;AACpC,UAAO,uCAAW,kBAAiB,IAAI,wBAAwB;AACjE;;;ADuCO,IAAM,aAAa,CAAC;AAAA,EACzB;AAAA,EACA;AAAA,EACA;AACF,MAIM,CAAC,CAAC,YAAa,CAAC,CAAC,gBAAgB,iBAAiB,WAAa,CAAC,CAAC,gBAAgB,iBAAiB;AAExG,IAAM,aAAa,EAAE,OAAO,EAAE,IAAI,MAAM,YAAY,aAAa,UAAU,KAAK,EAAE;AAElF,IAAM,mBAAmB,CAAC;AAAA,EACxB;AAAA,EACA,mBAAmB,MAAM;AACvB;AAAA,EACF;AACF,MAGM;AACJ,QAAM,aAAaC,gBAAc;AACjC,QAAM,kBAAkBC,cAAYC,gDAA8C,CAAC;AACnF,QAAM,oBAAoB,oBAAoB;AAC9C,QAAM,gBAAgB,iBAAiB;AAEvC,QAAM,qBAAqB,CAAC,sBAC1B,WAAW,aACR,iCAAiC,iBAAiB,EAClD,MAAM,CAAC,QAAsB,aAAa,SAAS,EAAE,OAAO,IAAI,YAAY,CAAC,CAAC;AAEnF,SACE,gBAAAC,SAAA;AAAA,IAAC,eAAe;AAAA,IAAf;AAAA,MACC,WAAW;AAAA,MACX,KAAK;AAAA,MACL,SAAS,MAAM;AACb,YAAI,mBAAmB;AACrB,6BAAmB;AAAA,QACrB,OAAO;AACL,6BAAmB,MAAM;AAAA,QAC3B;AACA,yBAAiB;AAAA,MACnB;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAACC,WAAA,EAAS,QAAQ,IAAI,OAAO,IAAI;AAAA,IACjC,gBAAAD,SAAA,cAAC,cAAM,oBAAoB,0BAA0B,6BAA8B;AAAA,EACrF;AAEJ;AAEA,IAAM,aAAa,CAAC,EAAE,cAAc,aAAa,MAAsD;AACrG,QAAM,CAAC,eAAe,gBAAgB,IAAI,mBAAmB,SAAS,aAAa;AACnF,QAAM,gBAAgB,iBAAiB;AAEvC,QAAM,eAAe,WAAW;AAAA,IAC9B,SAAS;AAAA,IACT;AAAA,IACA;AAAA,EACF,CAAC;AAED,SACE,gBAAAA,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA;AAAA,IAAC,eAAe;AAAA,IAAf;AAAA,MACC,WAAW;AAAA,MACX,KAAK;AAAA,MACL,SAAS,MAAO,eAAe,iBAAiB,IAAI,iBAAiB,gBAAgB,YAAY;AAAA;AAAA,IAEjG,gBAAAA,SAAA,cAACE,UAAA,EAAQ,QAAQ,IAAI,OAAO,IAAI;AAAA,IAChC,gBAAAF,SAAA,cAAC,cAAM,eAAe,UAAU,OAAM,kBAAgB;AAAA,EACxD,CACF;AAEJ;AAEA,IAAM,gBAAgB,MAAM;AAC1B,QAAM,CAAC,WAAW,YAAY,IAAI,mBAAmB,SAAS,aAAa;AAC3E,QAAM,gBAAgB,iBAAiB;AAEvC,SACE,gBAAAA,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,eAAe,YAAf,EAA0B,WAAW,eAAe,KAAK,YAAY,SAAS,MAAM,aAAa,CAAC,SAAS,KAC1G,gBAAAA,SAAA,cAAC,cAAW,QAAQ,IAAI,OAAO,IAAI,GACnC,gBAAAA,SAAA,cAAC,cAAM,YAAY,SAAS,YAAW,aAAW,CACpD,CACF;AAEJ;AAEA,IAAM,kBAAkB,CAAC,EAAE,QAAQ,MAA+B;AArIlE,MAAAG;AAsIE,QAAM,QAAuBL,cAAYM,iBAAgB,OAAO,CAAC;AACjE,QAAM,UAAUP,gBAAc;AAC9B,QAAM,KAAK,qBAAqB;AAChC,MAAI,GAACM,MAAA,+BAAO,qBAAP,gBAAAA,IAAyB,WAAU,MAAM,YAAY,CAAC,MAAM,SAAS;AACxE,WAAO;AAAA,EACT;AACA,QAAM,eAAe,MAAM,iBAAiB,KAAK,CAAC,UAAuC,MAAM,UAAU,MAAM,KAAK;AACpH,QAAM,gBAAgB,iBAAiB;AACvC,SACE,gBAAAH,SAAA,cAACK,YAAA,MACC,gBAAAL,SAAA,cAAC,eAAe,YAAf,EAA0B,WAAW,eAAe,KAAK,EAAE,OAAO,sBAAsB,QAAQ,UAAU,KAAG,2BAE9G,GACC,MAAM,iBAAiB,IAAI,CAAC,UAAuC;AAClE,WACE,gBAAAA,SAAA;AAAA,MAAC,eAAe;AAAA,MAAf;AAAA,QACC,WAAW;AAAA,QACX,KAAK,MAAM;AAAA,QACX,SAAS,MAAY;AACnB,gBAAM,QAAQ,kBAAkB,SAAS,MAAM,KAAK;AAAA,QACtD;AAAA,QACA,KAAK;AAAA,UACH,gBAAgB;AAAA,UAChB,IAAI,MAAM,mBAAmB,MAAM,QAAQ,KAAK;AAAA,UAChD,WAAW;AAAA,YACT,IAAI,MAAM,mBAAmB,MAAM,QAAQ,KAAK;AAAA,UAClD;AAAA,QACF;AAAA;AAAA,MAEA,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,IAAG;AAAA,UACH,KAAK;AAAA,YACH,eAAe;AAAA,YACf,IAAI;AAAA,YACJ,YAAY,MAAM,mBAAmB,MAAM,QAAQ,cAAc;AAAA,YACjE,OAAO,MAAM,mBAAmB,MAAM,QAAQ,qBAAqB;AAAA,UACrE;AAAA;AAAA,QAEC,MAAM;AAAA,MACT;AAAA,MACA,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,IAAG;AAAA,UACH,SAAQ;AAAA,UACR,KAAK;AAAA,YACH,OAAO,MAAM,mBAAmB,MAAM,QAAQ,qBAAqB;AAAA,UACrE;AAAA;AAAA,QAEC,MAAM,WAAW;AAAA,QAAM;AAAA,QAAE,MAAM,WAAW;AAAA,MAC7C;AAAA,IACF;AAAA,EAEJ,CAAC,GACD,gBAAAA,SAAA,cAAC,eAAe,YAAf,EAA0B,WAAW,iBACpC,gBAAAA,SAAA,cAAC,QAAK,IAAG,QAAO,SAAQ,MAAK,KAAK,EAAE,OAAO,qBAAqB,KAAG,wBAEjE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,IAAG;AAAA,MACH,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,YAAY;AAAA,QACZ,eAAe;AAAA,QACf,OAAO;AAAA,QACP,IAAI;AAAA,MACN;AAAA;AAAA,IAEC,eACC,gBAAAA,SAAA,cAAAA,SAAA,gBACG,MAAM,OAAM,MAAG,aAAa,WAAW,OAAM,KAAE,aAAa,WAAW,QAAO,GACjF,IAEA;AAAA,EAEJ,CACF,CACF,CACF;AAEJ;AAEO,IAAM,kBAAkB,CAAC;AAAA,EAC9B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,oBAAoB,MAAM;AACxB;AAAA,EACF;AAAA,EACA,sBAAsB,MAAM;AAC1B;AAAA,EACF;AAAA,EACA,sBAAsB,MAAM;AAC1B;AAAA,EACF;AACF,MAYM;AACJ,QAAM,UAAUH,gBAAc;AAC9B,QAAM,gBAAgB,iBAAiB;AACvC,QAAM,cAAcC,cAAYQ,mBAAiB;AACjD,QAAM,gBAAgB,CAAC,EAAC,2CAAa;AACrC,QAAM,eAAe,CAAC,EAAC,2CAAa;AACpC,QAAM,EAAE,SAAS,IAAI,sBAAsB;AAC3C,QAAM,QAAQR,cAAYS,yBAAwB;AAElD,QAAM,EAAE,gBAAgB,gBAAgB,WAAW,aAAa,aAAa,OAAO,IAAI;AAAA,IACtF;AAAA,IACA;AAAA,EACF;AAEA,QAAM,EAAE,UAAU,IAAIC,gBAAe;AAAA,IACnC,MAAM;AAAA,EACR,CAAC;AAED,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAE5C,MAAI,SAAS;AACX,WAAO,iBAAiB,eAAe,CAAC,YAAY,gBAClD,gBAAAT,SAAA,cAAAA,SAAA,gBACG,iBAAiB,gBAAAA,SAAA,cAAC,cAAW,cAA4B,cAA4B,GACrF,iBAAiB,gBAAAA,SAAA,cAAC,oBAAiB,QAAQ,QAAQ,kBAAkB,MAAM,kBAAkB,GAAG,GAChG,eAAe,gBAAAA,SAAA,cAAC,mBAAc,GAC9B,CAAC,YACA,gBAAAA,SAAA;AAAA,MAAC,eAAe;AAAA,MAAf;AAAA,QACC,WAAW;AAAA,QACX,SAAS,MAAM;AACb,8BAAoB;AACpB,4BAAkB;AAAA,QACpB;AAAA;AAAA,MAEA,gBAAAA,SAAA,cAAC,cAAW,QAAQ,IAAI,OAAO,IAAI;AAAA,MACnC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,EAAE,YAAY,YAAY,GAAG,GAAG,mBAAmB,KAAG,aAEvF;AAAA,IACF,CAEJ,IACE;AAAA,EACN;AAEA,SACE,gBAAAA,SAAA,cAAAA,SAAA,gBACG,cACC,gBAAAA,SAAA;AAAA,IAAC,eAAe;AAAA,IAAf;AAAA,MACC,WAAW;AAAA,MACX,KAAK;AAAA,MACL,SAAS,MAAM;AACb,oBAAY;AACZ,0BAAkB;AAAA,MACpB;AAAA,MACA,eAAa,iBAAiB,+BAA+B;AAAA;AAAA,IAE5D,iBAAiB,gBAAAA,SAAA,cAACU,cAAA,EAAY,QAAQ,IAAI,OAAO,IAAI,IAAK,gBAAAV,SAAA,cAACW,eAAA,EAAa,QAAQ,IAAI,OAAO,IAAI;AAAA,IAChG,gBAAAX,SAAA,cAAC,cAAM,iBAAiB,eAAe,yBAA0B;AAAA,EACnE,IACE,MAEH,cACC,gBAAAA,SAAA;AAAA,IAAC,eAAe;AAAA,IAAf;AAAA,MACC,KAAK;AAAA,MACL,WAAW;AAAA,MACX,SAAS,MAAM;AACb,oBAAY;AACZ,0BAAkB;AAAA,MACpB;AAAA,MACA,eAAa,iBAAiB,+BAA+B;AAAA;AAAA,IAE5D,iBAAiB,gBAAAA,SAAA,cAACY,YAAA,EAAU,QAAQ,IAAI,OAAO,IAAI,IAAK,gBAAAZ,SAAA,cAACa,aAAA,EAAW,QAAQ,IAAI,OAAO,IAAI;AAAA,IAC5F,gBAAAb,SAAA,cAAC,cAAM,iBAAiB,eAAe,yBAA0B;AAAA,EACnE,IACE,MAEH,iBAAiB,MAAM,SAAS,IAC/B,gBAAAA,SAAA;AAAA,IAAC,eAAe;AAAA,IAAf;AAAA,MACC,WAAW;AAAA,MACX,KAAK;AAAA,MACL,SAAS,MAAM;AACb,4BAAoB;AACpB,0BAAkB;AAAA,MACpB;AAAA,MACA,eAAY;AAAA;AAAA,IAEZ,gBAAAA,SAAA,cAACc,qBAAA,EAAmB,QAAQ,IAAI,OAAO,IAAI;AAAA,IAC3C,gBAAAd,SAAA,cAAC,cAAK,aAAW;AAAA,EACnB,IACE,MAEH,eACC,gBAAAA,SAAA,cAAC,eAAe,YAAf,EAA0B,eAAY,6BAA4B,KAAK,iCAAK,aAAL,EAAiB,IAAI,KAAK,MAChG,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,KACxB,gBAAAA,SAAA,cAACe,cAAA,EAAY,QAAQ,IAAI,OAAO,IAAI,GACpC,gBAAAf,SAAA,cAAC,OAAI,IAAG,QAAO,KAAK,EAAE,IAAI,KAAK,KAAG,YACvB,QAAO,GAClB,CACF,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,EAAE,IAAI,SAAS;AAAA,MACpB,MAAM;AAAA,MACN,OAAO,CAAC,OAAO,WAAW,WAAW,SAAS,GAAG;AAAA,MACjD,eAAe,OAAK,uCAAY,EAAE,CAAC;AAAA;AAAA,EACrC,CACF,IACE,MAEH,iBACC,gBAAAA,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,cAAW,cAA4B,cAA4B,GACnE,iBAAiB,gBAAAA,SAAA,cAAC,oBAAiB,QAAQ,QAAQ,kBAAkB,MAAM,kBAAkB,GAAG,CACnG,GAGD,WAAW,OAAO,gBAAAA,SAAA,cAAC,mBAAgB,SAAS,cAAc,GAE1D,eACC,gBAAAA,SAAA;AAAA,IAAC,eAAe;AAAA,IAAf;AAAA,MACC,KAAK,iCAAK,aAAL,EAAiB,WAAW,OAAO;AAAA,MACxC,SAAS,MAAY;AACnB,YAAI;AACF,gBAAM,QAAQ,WAAW,QAAQ,EAAE;AAAA,QACrC,SAAS,OAAO;AAAA,QAEhB;AACA,0BAAkB;AAAA,MACpB;AAAA,MACA,eAAY;AAAA;AAAA,IAEZ,gBAAAA,SAAA,cAACgB,iBAAA,EAAe,QAAQ,IAAI,OAAO,IAAI;AAAA,IACvC,gBAAAhB,SAAA,cAAC,cAAK,oBAAkB;AAAA,EAC1B,IACE,MAEH,gBAAgB,gBACf,gBAAAA,SAAA;AAAA,IAAC,eAAe;AAAA,IAAf;AAAA,MACC,SAAS,MAAM;AACb,kBAAU,CAAC,CAAC;AACZ,0BAAkB;AAAA,MACpB;AAAA,MACA,KAAK;AAAA;AAAA,IAEL,gBAAAA,SAAA,cAACiB,kBAAA,EAAgB,QAAQ,IAAI,OAAO,IAAI;AAAA,IACxC,gBAAAjB,SAAA,cAAC,cAAK,kBAAgB;AAAA,EACxB,IACE,IACN;AAEJ;;;AD7WA,IAAM,WAAW,CAAC;AAAA,EAChB;AAAA,EACA;AAAA,EACA;AAAA,EACA,gBAAgB;AAAA,EAChB;AAAA,EACA,yBAAyB;AAC3B,MAOM;AAzCN,MAAAkB,KAAAC;AA0CE,QAAM,CAAC,MAAM,OAAO,IAAIC,WAAS,KAAK;AACtC,QAAM,EAAE,OAAAC,OAAM,IAAI,SAAS;AAE3B,QAAM,cAAcC,cAAYC,mBAAiB;AACjD,QAAM,UAAU,gBAAgB;AAChC,QAAM,EAAE,aAAa,IAAID,cAAYE,mBAAiB,KAAK,CAAC;AAC5D,QAAM,EAAE,WAAW,aAAa,YAAY,IAAIC,mBAAkB,cAAc,YAAY;AAC5F,QAAM,gBAAgB;AAEtB,QAAM,wBAAsBP,MAAAI,cAAYI,0BAAyB,MAAM,CAAC,MAA5C,gBAAAR,IAA+C,QAAO;AAClF,QAAM,gBAAgB,CAAC,EAAE,gBAAiB,gBAAgB;AAE1D,QAAM,QAAQI,cAAYK,iBAAgB,YAAY,CAAC;AACvD,QAAM,sBAAsB,GAACR,MAAA,+BAAO,qBAAP,gBAAAA,IAAyB,WAAU,MAAM,YAAY,CAAC,MAAM;AACzF,QAAM,WAAWS,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,OAAON,cAAYO,gBAAe,MAAM,CAAC;AAC/C,QAAM,CAAC,qBAAqB,sBAAsB,IAAIT,WAAS,KAAK;AACpE,QAAM,CAAC,qBAAqB,sBAAsB,IAAIA,WAAS,KAAK;AACpE,kBAAgB,EAAE,MAAM,MAAM,WAAW,CAAC;AAC1C,QAAM,gBAAgB,iBAAiB;AAEvC,MAAI,EAAE,gBAAgB,eAAe,eAAe,aAAa,kBAAkB,qBAAqB;AACtG,WAAO;AAAA,EACT;AAEA,QAAM,sBAAsB,MAAM,uBAAuB,IAAI;AAC7D,QAAM,sBAAsB,MAAM,uBAAuB,IAAI;AAE7D,QAAM,QAAQ;AAAA,IACZ;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AAEA,SACE,gBAAAU,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,eAAe,MAAf,EAAoB,MAAY,cAAc,WAC7C,gBAAAA,SAAA;AAAA,IAAC,eAAe;AAAA,IAAf;AAAA,MACC,eAAY;AAAA,MACZ,KAAK,EAAE,IAAI,GAAGT,OAAM,OAAO,eAAe,KAAK,MAAM,GAAG,MAAM,GAAG,SAAS,GAAG,QAAQ;AAAA,MACrF,SAAS,OAAK,EAAE,gBAAgB;AAAA,MAChC,WAAW;AAAA;AAAA,IAEX,gBAAAS,SAAA,cAACC,mBAAA,EAAiB,OAAO,IAAI,QAAQ,IAAI;AAAA,EAC3C,GAEC,WACC,gBAAAD,SAAA,cAAC,MAAM,MAAN,EAAW,MAAY,cAAc,WACpC,gBAAAA,SAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,IAAI,gBAAgB,IAAI,KAAK,KACjD,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,OAAO;AAAA,QACP,SAAS;AAAA,QACT,GAAG;AAAA,QACH,gBAAgB;AAAA,QAChB,YAAY;AAAA,QACZ,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,cAAc;AAAA,MAChB;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,WACC,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,OAAO,oBAAoB,YAAY,YAAY,KAC7D,6BAAM,MACN,UAAU,WAAW,IACxB,IACC,6BAAM,YACL,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,mBAAmB,IAAI,KAAK,KAC1D,KAAK,QACR,IACE,IACN;AAAA,IAEA,gBAAAA,SAAA,cAAC,MAAM,OAAN,EAAY,KAAK,EAAE,OAAO,UAAU,KACnC,gBAAAA,SAAA,cAACE,aAAA,IAAU,CACb;AAAA,EACF,GACA,gBAAAF,SAAA,cAAC,OAAI,KAAK,EAAE,IAAI,MAAM,IAAI,MAAM,WAAW,QAAQ,WAAW,OAAO,KACnE,gBAAAA,SAAA,cAAC,kDAAoB,QAApB,EAA2B,mBAAmB,MAAM,QAAQ,KAAK,IAAG,CACvE,CACF,CACF,IAEA,gBAAAA,SAAA,cAAC,eAAe,SAAf,EAAuB,MAAK,OAAM,OAAM,OAAM,KAAK,EAAE,WAAW,OAAO,WAAW,OAAO,KACxF,gBAAAA,SAAA,cAAC,oCAAoB,MAAO,CAC9B,CAEJ,GACC,uBAAuB,gBAAAA,SAAA,cAAC,mBAAgB,cAAc,wBAAwB,GAC9E,uBAAuB,gBAAAA,SAAA,cAAC,mBAAgB,QAAQ,QAAQ,cAAc,wBAAwB,CACjG;AAEJ;AAIA,IAAO,mBAAQ;;;AGlJf;AAAA,IAAM,wBAAwB;AAC9B,IAAM,WAAW,oBAAI,IAAI;AAAA,EACvB,CAAC,CAAC,MAAM,QAAQ,EAAE,SAAS,GAAG,aAAa;AAAA,EAC3C,CAAC,CAAC,MAAM,SAAS,EAAE,SAAS,GAAG,QAAQ,qBAAqB,GAAG;AAAA,EAC/D,CAAC,CAAC,OAAO,QAAQ,EAAE,SAAS,GAAG,GAAG,qBAAqB,WAAW;AAAA,EAClE,CAAC,CAAC,OAAO,SAAS,EAAE,SAAS,GAAG,qBAAqB;AAAA,EACrD,CAAC,CAAC,MAAM,MAAS,EAAE,SAAS,GAAG,QAAQ,qBAAqB,GAAG;AAAA,EAC/D,CAAC,CAAC,OAAO,MAAS,EAAE,SAAS,GAAG,GAAG,qBAAqB,EAAE;AAC5D,CAAC;AAEM,IAAM,oBAAoB,CAAC,EAAE,UAAU,SAAS,MAAM,MAAM;AACjE,QAAM,gBAAgB,aAAa;AACnC,MAAI,CAAC,iBAAiB,CAAC,OAAO;AAE5B,WAAO,gBAAgB,SAAS,IAAI,CAAC,SAAS,MAAS,EAAE,SAAS,CAAC,EAAE,QAAQ,uBAAuB,QAAQ,IAAI;AAAA,EAClH;AACA,QAAM,iBAAiB,MAAM,WAAW;AAExC,MAAI,QAAQ,SAAS,IAAI,CAAC,SAAS,MAAM,MAAM,EAAE,SAAS,CAAC;AAC3D,MAAI,OAAO;AACT,YAAQ,MAAM,QAAQ,uBAAuB,QAAQ;AAAA,EACvD,OAAO;AACL,YAAQ,GAAG,QAAQ,IAAI,MAAM,MAAM;AAAA,EACrC;AAEA,SAAO,GAAG,KAAK,GAAG,iBAAiB,qBAAqB,EAAE;AAC5D;;;ALIA,IAAM,eAAe,CAAC,EAAE,QAAQ,KAAK,MAAqD;AACxF,QAAM,WAAWG,cAAYC,oBAAmB,MAAM,CAAC;AACvD,QAAM,SAAQ,qCAAU,YAAW;AACnC,QAAM,eAAeD,cAAYE,yBAAwB,MAAM,CAAC;AAEhE,SACE,gBAAAC,SAAA,cAAAA,SAAA,gBACG,eACC,gBAAAA,SAAA,cAAC,gBAAgB,cAAhB,EAA6B,MAAY,eAAY,2BACpD,gBAAAA,SAAA,cAACC,WAAA,EAAS,OAAO,IAAI,QAAQ,IAAI,CACnC,IACE,MACH,QACC,gBAAAD,SAAA,cAAC,gBAAgB,cAAhB,EAA6B,MAAY,eAAY,qBACpD,gBAAAA,SAAA,cAAC,eAAY,OAAO,IAAI,QAAQ,IAAI,CACtC,IACE,IACN;AAEJ;AAEA,IAAM,OAAO,CAAC;AAAA,EACZ,SAAS;AAAA,EACT,UAAU;AAAA,EACV;AAAA,EACA;AAAA,EACA,YAAY;AAAA,EACZ,cAAc;AAAA,EACd,cAAc;AAAA,EACd,UAAU,CAAC;AAAA,EACX,eAAe,CAAC;AAAA,EAChB,yBAAyB;AAAA,EACzB,4BAA4B;AAAA,EAC5B,mBAAmB;AAAA,EACnB,sBAAsB;AAAA,EACtB,qBAAqB;AACvB,MAeM;AACJ,QAAM,gBAAgB,UAAUE,sBAAqB,OAAO,IAAIC,0BAAyB,MAAM;AAC/F,QAAM,QAAQN,cAAY,aAAa;AACvC,QAAM,WAAWA,cAAYO,oBAAmB,MAAM,CAAC;AACvD,QAAM,aAAaP,cAAYQ,0BAAyB,MAAM,CAAC;AAC/D,QAAM,cAAcR,cAAYS,mBAAiB;AACjD,QAAM,cAAc,cAAc,YAAY,WAAW;AACzD,QAAM,mBAAmB,cAAc,YAAY,gBAAgB;AACnE,QAAM,mBAAmB,cAAc,YAAY,gBAAgB;AACnE,QAAM,eAAe,CAACT,cAAYU,0BAAyB,MAAM,CAAC;AAClE,QAAM,eAAe,EAAC,+BAAO;AAC7B,QAAM,CAAC,gBAAgB,iBAAiB,IAAIC,WAAS,KAAK;AAC1D,QAAM,kBAAkB,+BAAO;AAC/B,QAAM,UAAU,gBAAgB;AAChC,QAAM,CAAC,aAAa,IAAI,mBAAmB,SAAS,aAAa;AACjE,QAAM,SAAS,WAAW;AAAA,IACxB,SAAS;AAAA,IACT,cAAc,+BAAO;AAAA,IACrB,cAAc,yCAAY;AAAA,EAC5B,CAAC;AACD,QAAM,QAAQ,kBAAkB;AAAA,IAC9B;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AACD,QAAM,iBAAiBC,cAAY,CAAC,UAA4B;AAC9D,sBAAkB,MAAM,SAAS,YAAY;AAAA,EAC/C,GAAG,CAAC,CAAC;AAEL,QAAM,CAAC,KAAK,EAAE,OAAO,iBAAiB,QAAQ,iBAAiB,CAAC,IAAIC,YAA2B;AAE/F,QAAM,6BAA6B,oBAAoB,OAAO,mBAAmB;AAEjF,QAAM,CAAC,YAAY,aAAa,IAAIC;AAAA,IAClC,MAAM,gCAAgC,iBAAiB,gBAAgB;AAAA,IACvE,CAAC,iBAAiB,gBAAgB;AAAA,EACpC;AAEA,SACE,gBAAAX,SAAA;AAAA,IAAC,gBAAgB;AAAA,IAAhB;AAAA,MACC;AAAA,MACA,KAAK;AAAA,QACH;AAAA,QACA;AAAA,SACG;AAAA,MAEL,eAAa,oBAAoB,QAAQ;AAAA;AAAA,IAExC,aAAa,SACZ,gBAAAA,SAAA;AAAA,MAAC,gBAAgB;AAAA,MAAhB;AAAA,QACC,cAAc;AAAA,QACd,cAAc;AAAA,QACd,UAAU,CAAC;AAAA,QACX,KAAK;AAAA;AAAA,MAEJ,oBAAoB,6BACnB,gBAAAA,SAAA,cAAC,kBAAe,cAAc,yCAAY,IAAI,cAAc,+BAAO,IAAI,QAAQ,QAAQ,SAAkB,IACvG;AAAA,MAEJ,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,SAAS,+BAAO;AAAA,UAChB,QAAQ,UAAU,SAAY,CAAC;AAAA,UAC/B,QACE,oBACA,WAAW,gBACX,+BAAO,YAAW,cAClB,+BAAO,gBAAe;AAAA,UAExB,UAAU,CAAC;AAAA,UACX,eAAY;AAAA,UACZ,KAAK;AAAA,YACH;AAAA,YACA,QAAQ,kBAAkB,mBAAmB;AAAA,YAC7C,IAAI;AAAA,UACN;AAAA;AAAA,MACF;AAAA,MACC,kBAAkB,KAAK,mBAAmB,IACzC,gBAAAA,SAAA,cAAAA,SAAA,gBACG,gBAAiB,CAAC,WAAW,cAC5B,gBAAAA,SAAA,cAAC,gBAAgB,iBAAhB,MACC,gBAAAA,SAAA,cAAC,UAAO,MAAM,YAAY,IAAI,eAAY,2BAA0B,MAAM,YAAY,CACxF,IACE,MACH,CAAC,uBAAuB,eACvB,gBAAAA,SAAA,cAAC,gBAAgB,gBAAhB,EAA+B,eAAY,+BAA8B,MAAM,iBAC9E,gBAAAA,SAAA,cAACY,aAAA,IAAW,CACd,IACE,MACH,CAAC,uBAAuB,CAAC,eACxB,gBAAAZ,SAAA,cAAC,gBAAgB,gBAAhB,EAA+B,MAAM,iBACpC,gBAAAA,SAAA,cAAC,cAAW,SAAS,yCAAY,IAAI,MAAM,eAAe,CAC5D,IACE,MACH,CAAC,sBAAsB,gBAAAA,SAAA,cAAC,gBAAa,QAAgB,MAAM,eAAe,CAC7E,IACE;AAAA,MACH,kBAAmB,eAAe,UAAU,iBAAiB,IAC5D,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,QAAQ;AAAA,UACR,eAAc,yCAAY,OAAM;AAAA,UAChC,eAAc,+BAAO,OAAM;AAAA,UAC3B;AAAA,UACA;AAAA;AAAA,MACF,IACE;AAAA,MAEJ,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,WAAW;AAAA,UACX,MAAM;AAAA,UACN;AAAA,UACA;AAAA,UACA;AAAA;AAAA,MACF;AAAA,IACF,IACE;AAAA,EACN;AAEJ;AAEA,IAAM,YAAYA,SAAM,KAAK,IAAI;AAEjC,IAAO,oBAAQ;;;AM1Mf;AAAA,OAAOa,YAAS,aAAAC,aAAW,UAAAC,UAAQ,YAAAC,kBAAgB;AACnD,SAAS,YAAAC,kBAAgB;AAUzB,SAAsB,6BAAAC,kCAAiC;AAEvD;AAAA,EACE,gBAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,6BAAAC;AAAA,EACA;AAAA,EACA,mBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,oBAAoB,mBAAAC,kBAAiB,aAAAC,mBAAiB;;;ACxB/D;AAAA,OAAOC,cAAW;AAGlB,SAAS,6BAAAC,kCAAiC;;;ACH1C;AAAA,OAAOC,cAAW;AAIlB,IAAMC,SAAO,CAAC;AAAA,EACZ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,SAAS;AACX,MAOE,gBAAAC,SAAA;AAAA,EAAC;AAAA;AAAA,IACC,eAAa;AAAA,IACb,WAAU;AAAA,IACV,OAAM;AAAA,IACN,KAAK;AAAA,MACH,GAAG;AAAA,MACH,cAAc;AAAA,MACd,IAAI;AAAA,MACJ,QAAQ,aAAa,WAAW,qBAAqB,cAAc;AAAA,MACnE,QAAQ;AAAA,MACR,WAAW,EAAE,QAAQ,yBAAyB;AAAA,OAC1C,WAAW,EAAE,QAAQ,OAAO,iBAAiB,QAAQ,QAAQ,MAAM,gBAAgB,QAAQ,IAAI,CAAC;AAAA,IAEtG,SAAS,MAAY;AACnB,YAAM;AAAA,IACR;AAAA;AAAA,EAEC;AACH;AAGF,IAAMC,SAAQ,CAAC,EAAE,SAAS,MAA6B;AACrD,SAAO,WACL,gBAAAD,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,qBAAqB,KACnD,QACH,IACE;AACN;AAEA,IAAME,QAAO,CAAC,EAAE,SAAS,MAAwC;AAC/D,SAAO,WAAW,gBAAAF,SAAA,cAAC,OAAI,KAAK,EAAE,OAAO,mBAAmB,KAAI,QAAS,IAAS;AAChF;AAEO,IAAM,WAAW;AAAA,EACtB,MAAAD;AAAA,EACA,OAAAE;AAAA,EACA,MAAAC;AACF;;;AD9CO,IAAM,eAAe,CAAC;AAAA,EAC3B;AAAA,EACA;AAAA,EACA,mBAAmB;AACrB,MAWM;AACJ,MAAI,QAAQ,WAAW,GAAG;AACxB,WAAO;AAAA,EACT;AACA,SACE,gBAAAC,SAAA,cAAC,OAAI,KAAK,EAAE,IAAI,MAAM,KACpB,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,oBAAoB,YAAY,YAAY,KAC1E,KACH,GACA,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,IAAI,MAAM,SAAS,QAAQ,qBAAqB,eAAe,KAAK,KAAK,KAClF,QAAQ;AAAA,IAAI,CAAC,QAAQ,UACpB,OAAO,YACL,gBAAAA,SAAA;AAAA,MAAC,SAAS;AAAA,MAAT;AAAA,QACC,KAAK,OAAO;AAAA,QACZ,QAAQ,OAAO,UAAUC,2BAA0B,QAAQ,qBAAqB,KAAK,KAAK,OAAO;AAAA,SAC7F,SAHL;AAAA,QAIC,UAAU,qBAAqB,OAAO;AAAA;AAAA,MAEtC,gBAAAD,SAAA,cAAC,SAAS,MAAT,MAAe,iCAAQ,IAAK;AAAA,MAC7B,gBAAAA,SAAA,cAAC,SAAS,OAAT,MAAgB,iCAAQ,KAAM;AAAA,IACjC,IAEA;AAAA,EAEJ,CACF,CACF;AAEJ;;;ADfA,IAAM,WAAW,EAAE,QAAQ,QAAQ,OAAO,OAAO;AAE1C,IAAM,WAAW,CAAC,EAAE,kBAAkB,CAAC,EAAE,MAAqD;AAtCrG,MAAAE;AAuCE,QAAM,WAAW,kBAAkB,kBAAkB,EAAE;AACvD,QAAM,aAAaC,gBAAc;AACjC,QAAM,YAAYC,cAAYC,gBAAe;AAC7C,QAAM,OAAOD,cAAY,EAAmB;AAC5C,QAAM,YAAYA,cAAYE,0BAAyB;AACvD,QAAM,mBAAmB,cAAc,YAAY,gBAAgB;AACnE,QAAM,gBAAgBC,sBAAqB,uCAAW,UAAU;AAChE,QAAM,QAAQH,cAAY,aAAa;AACvC,QAAM,CAAC,YAAY,aAAa,IAAII,WAAS,UAAU,cAAc,KAAK,GAAG;AAC7E,QAAM,YAAYJ,cAAYK,gBAAe;AAC7C,QAAM,cAAcL,cAAYM,kBAAiB;AACjD,QAAM,qBAAqB,UAAU,mBAAmB;AACxD,QAAM,mBAAmBN,cAAY,EAAsB;AAC3D,QAAM,aAAaA,cAAY,EAAgB;AAC/C,QAAM,WAAWO,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,CAAC,gBAAgB,iBAAiB,IAAI,mBAAmB,SAAS,cAAc;AACtF,QAAM,gBAAgBP,cAAY,kCAAgCF,MAAA,8BAAAA,IAAW,cAAa,EAAE,CAAC;AAC7F,QAAM,aAAaE,cAAY,GAAc,SAAS,UAAU,CAAC;AACjE,QAAM,YAAY,gBAAgB,IAAI,CAAC,UAAkC,MAAM,OAAO,EAAE;AACxF,QAAM,mBAAmBQ,SAAO,KAAK;AAErC,QAAM,YAAY,cAAcC,cAAa;AAE7C,QAAM,gBAAgB,aAAa,eAAe,CAAC;AAEnD,EAAAC,YAAU,MAAM;AACd,UAAM,iBAAiB,MAAY;AACjC,wBAAkB,KAAK;AACvB,UAAI,CAAC,MAAM;AACT;AAAA,MACF;AACA,YAAM,UAAU,iBAAiB;AACjC,YAAM,WAAW;AAAA,QACf,UAAU,YAAY;AAAA,QACtB,KAAK,MAAM,KAAK,cAAc,MAAM,YAAY,CAAC;AAAA,MACnD;AAAA,IACF;AACA,UAAM,8BAA8B,MAAY;AAC9C,UAAI,EAAC,+BAAO,OAAM,iBAAiB,WAAW,eAAe;AAC3D;AAAA,MACF;AAEA,UAAI;AACF,yBAAiB,UAAU;AAC3B,YAAI,oBAAoB,sBAAsB,YAAY;AACxD,4BAAkB,IAAI;AACtB,gBAAM,UAAU,iBAAiB,YAAY,MAAM;AACjD,8BAAkB,KAAK;AAAA,UACzB,CAAC;AACD,gBAAM,aAAa,UAAU,YAAY;AACzC,cAAI,WAAW,QAAQ,MAAM,cAAc;AACzC,uBAAW,wBAAwB,CAAC,UAAU,YAAY,CAAyB,CAAC;AAAA,UACtF,OAAO;AACL,kBAAM,eAAe;AAAA,UACvB;AAAA,QACF,OAAO;AACL,gBAAM,eAAe;AAAA,QACvB;AAEA,cAAM,0BAA0B,MAAY;AAC1C,kBAAQ,YAAY;AAAA,YAClB,KAAKC,2BAA0B;AAC7B;AAAA,YACF,KAAKA,2BAA0B;AAC7B,oBAAM,UAAU,QAAQ,UAAU;AAClC;AAAA,YACF;AACE,oBAAM,UAAU,cAAc,UAAU;AAAA,UAC5C;AAAA,QACF;AAEA,cAAM,wBAAwB;AAAA,MAChC,SAAS,OAAO;AACd,gBAAQ,MAAM,0CAA0C,KAAK;AAC7D,0BAAkB,KAAK;AAAA,MACzB;AAAA,IACF;AAEA,gCAA4B;AAAA,EAC9B,GAAG;AAAA,IACD;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,+BAAO;AAAA,IACP;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AAED,EAAAD,YAAU,MAAM;AACd,QAAI,CAAC,WAAW;AACd,eAAS;AAAA,IACX;AACA,WAAO,MAAM,kBAAkB,KAAK;AAAA,EACtC,GAAG,CAAC,WAAW,mBAAmB,QAAQ,CAAC;AAE3C,iCAA+B,sBAAsB,kBAAkB,EAAE;AAEzE,SACE,gBAAAE,SAAA,cAAC,QAAK,KAAK,EAAE,IAAI,MAAM,MAAM,OAAO,GAAG,WAAU,YAC/C,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,WAAU,KAAK,EAAE,GAAG,QAAQ,YAAY,gBAAgB,IAAI,KAAK,KAC5F,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,oBAAoB,SAAS,QAAQ,YAAY,SAAS,KAAG,uBACxE,YAAY,iBAAiB,gBAAAA,SAAA,cAAC,WAAQ,MAAM,IAAI,OAAO,EAAE,YAAY,SAAS,GAAG,IAAK,EAC5G,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,EAAE,OAAO,oBAAoB,WAAW,EAAE,OAAO,qBAAqB,GAAG,QAAQ,UAAU;AAAA,MAChG,SAAS;AAAA;AAAA,IAET,gBAAAA,SAAA,cAACC,aAAA,IAAU;AAAA,EACb,CACF,GAEC,gBACC,gBAAAD,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ,+BAAO,gBAAe,iBAAiB;AAAA,MAC/C,SAAS,uCAAW;AAAA,MACpB,eAAY;AAAA,MACZ,KAAK,EAAE,OAAO,QAAQ,QAAQ,QAAQ;AAAA;AAAA,EACxC,IACE,MACJ,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,WAAW;AAAA,QACX,MAAM;AAAA,QACN,IAAI;AAAA,QACJ,IAAI;AAAA,MACN;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,SAAS;AAAA,UACP;AAAA,YACE,OAAO;AAAA,YACP,MAAM,gBAAAA,SAAA,cAACE,kBAAA,EAAgB,OAAO,UAAU;AAAA,YACxC,OAAOH,2BAA0B;AAAA,YACjC,SAAS,MAAY;AACnB,oBAAM,UAAU,cAAc;AAC9B,yBAAW,WAAW,SAAS,YAAYA,2BAA0B,IAAI;AAAA,YAC3E;AAAA,YACA,WAAW;AAAA,UACb;AAAA,UACA;AAAA,YACE,OAAO;AAAA,YACP,MAAM,gBAAAC,SAAA,cAAC,sBAAmB,OAAO,UAAU;AAAA,YAC3C,OAAOD,2BAA0B;AAAA,YACjC,SAAS,MAAY;AA5LnC,kBAAAb;AA6LgB,qBAAMA,MAAA,8BAAAA,IAAW,QAAQ;AACzB,yBAAW,WAAW,SAAS,YAAYa,2BAA0B,IAAI;AAAA,YAC3E;AAAA,YACA,WAAW,sBAAsB;AAAA,UACnC;AAAA,QACF;AAAA,QACA,kBAAkB;AAAA;AAAA,IACpB;AAAA,IAGA,gBAAAC,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,GAAG,QAAQ,KAAK,MAAM,IAAI,KAAK,KAC5D,eAAeD,2BAA0B,QAAQ,oBAAoB,aACpE,gBAAAC,SAAA,cAAC,WACC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,oBAAoB,YAAY,aAAa,IAAI,KAAK,KAAG,gBAE1F,GACA,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,QAAQ,gBAAgB,iBAAiB,YAAY,UAAU,KAAK,KAAK,KACvF,gBAAAA,SAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,EAAE,YAAY,WAAW,OAAO,qBAAqB,KAAG,KAErF,GACA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,aAAa;AAAA,QACb,OAAO,CAAC,UAAU;AAAA,QAClB,eAAe,CAAM,MAAK;AACxB,wBAAc,EAAE,CAAC,CAAC;AAClB,gBAAM,UAAU,QAAQ,EAAE,CAAC,CAAC;AAAA,QAC9B;AAAA,QACA,MAAM;AAAA,QACN,KAAK;AAAA,QACL,KAAK;AAAA;AAAA,IACP,GACA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,EAAE,YAAY,WAAW,OAAO,qBAAqB,KAAG,MAErF,CACF,CACF,IACE,IACN;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,SAAS,UAAU,IAAI,eAAa;AAAA,UAClC;AAAA,UACA,OAAO;AAAA,UACP,SAAS,MAAY;AAzOjC,gBAAAd;AA0Oc,mBAAMA,MAAA,8BAAAA,IAAW,cAAc;AAC/B,uBAAW,WAAW,SAAS,YAAY,QAAQ;AAAA,UACrD;AAAA,UACA,WAAW;AAAA,QACb,EAAE;AAAA,QACF,kBAAkB;AAAA;AAAA,IACpB;AAAA,EACF,CACF;AAEJ;;;AhD3NA,IAAMiB,WAAU,OAAO,OAAO;AAAA,EAC5B,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AAAA,EACH,MAAM;AAAA,EACN,YAAY;AAAA,EACZ,GAAG;AAAA,EACH,UAAU;AAAA,EACV,OAAO;AAAA,IACL,GAAG;AAAA,IACH,GAAG;AAAA,IACH,IAAI;AAAA,IACJ,OAAO;AAAA,IACP,UAAU;AAAA,IACV,QAAQ;AAAA,IACR,cAAc;AAAA,IACd,QAAQ;AAAA,EACV;AAAA,EACA,OAAO;AAAA,IACL,GAAG;AAAA,IACH,WAAW,GAAG,gBAAgB,EAAE,OAAO,OAAO,CAAC,CAAC;AAAA,EAClD;AAAA,EACA,UAAU;AAAA,IACR,iBAAiB;AAAA,MACf,MAAM;AAAA,QACJ,OAAO;AAAA,UACL,UAAU;AAAA,UACV,WAAW;AAAA,QACb;AAAA,MACF;AAAA,IACF;AAAA,IACA,cAAc;AAAA,MACZ,MAAM;AAAA,QACJ,OAAO;AAAA,UACL,UAAU;AAAA,QACZ;AAAA,MACF;AAAA,IACF;AAAA,IACA,aAAa;AAAA,MACX,MAAM;AAAA,QACJ,OAAO;AAAA,UACL,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,UAAU;AAAA,UACV,QAAQ;AAAA,UACR,QAAQ;AAAA,QACV;AAAA,MACF;AAAA,IACF;AAAA,IACA,iBAAiB;AAAA,MACf,MAAM;AAAA,QACJ,WAAW;AAAA,MACb;AAAA,IACF;AAAA,IACA,cAAc;AAAA,MACZ,MAAM,CAAC;AAAA,IACT;AAAA,IACA,mBAAmB;AAAA,MACjB,MAAM;AAAA,QACJ,WAAW;AAAA,QACX,YAAY;AAAA,MACd;AAAA,IACF;AAAA,EACF;AAAA,EACA,kBAAkB;AAAA,IAChB;AAAA,MACE,iBAAiB;AAAA,MACjB,aAAa;AAAA,MACb,KAAK;AAAA,QACH,UAAU;AAAA,QACV,QAAQ;AAAA,QACR,WAAW;AAAA,QACX,OAAO;AAAA,UACL,IAAI;AAAA,QACN;AAAA,MACF;AAAA,IACF;AAAA,IACA;AAAA,MACE,cAAc;AAAA,MACd,aAAa;AAAA,MACb,KAAK;AAAA,QACH,UAAU;AAAA,QACV,QAAQ;AAAA,QACR,WAAW;AAAA,MACb;AAAA,IACF;AAAA,IACA;AAAA,MACE,cAAc;AAAA,MACd,aAAa;AAAA,MACb,KAAK;AAAA,QACH,IAAI;AAAA,MACN;AAAA,IACF;AAAA,EACF;AACF,CAAC;AAED,IAAM,WAAW,CAAC;AAAA,EAChB;AAAA,EACA,eAAe;AACjB,MAGM;AA/HN,MAAAC,KAAAC,KAAA;AAgIE,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,WAAWC,cAAYC,eAAc,SAAS,QAAQ,CAAC;AAC7D,QAAM,0BAA0BD,cAAYC,eAAc,SAAS,uBAAuB,CAAC;AAC3F,QAAM,WAAUJ,MAAAG,cAAYE,0BAAyB,uBAAuB,CAAC,MAA7D,gBAAAL,IAAgE;AAChF,QAAM,EAAE,SAAS,IAAI,gCAAgC;AACrD,QAAM,EAAE,UAAU,iBAAiB,IAAI,2BAA2B;AAClE,QAAM,aAAa,cAAc,YAAY,UAAU;AAEvD,QAAM,uBAAuB,sBAAsB;AACnD,QAAM,oBAAoB,mBAAmB;AAE7C,QAAM,oBAAkB,MAAAC,MAAA,qDAAkB,uBAAlB,gBAAAA,IAAsC,qBAAtC,mBAAwD,WAC5E,0DAAkB,uBAAlB,mBAAsC,qBACtC,0CAAU,uBAAV,mBAA8B,qBAAoB,CAAC;AAEvD,QAAM,aAAa;AAAA,IACjB,2BAA2B,uCAAW;AAAA,IACtC,kBAAkB,uCAAW;AAAA,IAC7B,qBAAqB,uCAAW;AAAA,IAChC,oBAAoB,uCAAW;AAAA,IAC/B,WAAW,uCAAW;AAAA,EACxB;AACA,QAAM,oBAAoB,YAAY,aAAa,kBAAkB,UAAQ,0CAAU,SAAV,mBAAgB;AAC7F,QAAM,cAAc;AAAA,IAClB,iBAAiB;AAAA,IACjB,cAAc;AAAA,IACd;AAAA,IACA,aAAa,CAAC,GAAC,0CAAU,SAAV,mBAAgB;AAAA,IAC/B,iBAAiB,aAAa,kBAAkB;AAAA,IAChD,mBAAmB,aAAa,kBAAkB;AAAA,EACpD;AAEA,QAAM,oBAAoBK,QAAM,QAAQ,EACrC,KAAK,kBAAkB,OAAO,MAC7B,gBAAAC,SAAA;AAAA,IAACR;AAAA,IAAA;AAAA,MACC,KAAK;AAAA,QACH,OAAO;AAAA,UACL,qBAAqB;AAAA,UACrB,sBAAsB;AAAA,QACxB;AAAA,MACF;AAAA,OACI;AAAA,IAEJ,gBAAAQ,SAAA,cAAC,WAAM;AAAA,EACT,CACD,EACA,KAAK,kBAAkB,IAAI,MAC1B,gBAAAA,SAAA,cAACR,UAAA,iBAAQ,KAAK,EAAE,GAAG,iBAAiB,KAAO,cACzC,gBAAAQ,SAAA,cAAC,YAAS,iBAAkC,CAC9C,CACD,EACA,KAAK,kBAAkB,MAAM,kBAAkB,cAAc,MAC5D,gBAAAA,SAAA,cAACR,UAAA,iCAAY,cAAZ,EAAyB,aAAa,sBACrC,gBAAAQ,SAAA,cAAC,gBAAa,QAAQ,UAAU,SAAS,qBAAqB,sBAAsB,CACtF,CACD,EACA,KAAK,kBAAkB,cAAc,MACpC,gBAAAA,SAAA,cAACR,UAAA,mBAAY,cACX,gBAAAQ,SAAA,cAAC,qBAAgB,CACnB,CACD,EACA,UAAU,MAAM;AACf,WAAO;AAAA,EACT,CAAC;AAEH,QAAM,gBAAgB,iBAAiB;AAEvC,EAAAC,YAAU,MAAM;AACd,WAAO,MAAM;AACX,oBAAc;AAAA,IAChB;AAAA,EACF,GAAG,CAAC,aAAa,CAAC;AAElB,MAAI,CAAC,qBAAqB,CAAC,SAAS;AAClC,WAAO;AAAA,EACT;AAEA,SACE,gBAAAD,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,GAAGD,QAAM,EAAE,mBAAmB,qBAAqB,CAAC,EACjD,KAAK,EAAE,sBAAsB,KAAK,GAAG,MAAM,OAAO,EAClD,KAAK,EAAE,mBAAmB,KAAK,GAAG,MAAM,MAAM,EAC9C,UAAU,MAAM,MAAM;AAAA,QACzB,GAAG;AAAA,QACH,YAAY;AAAA,QACZ,KAAK;AAAA,QACL,UAAU;AAAA,QACV,WAAW,EAAE,SAAS,OAAO;AAAA,QAC7B,OAAO;AAAA,UACL,UAAU;AAAA,UACV,QAAQ;AAAA,QACV;AAAA,MACF;AAAA;AAAA,IAEC,WAAW,eAAe,WAAW,WACpC,gBAAAC,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,QAAQ;AAAA,QACR;AAAA,QACA,OAAM;AAAA,QACN,QAAQ;AAAA,QACR,SAAS,EAAE,GAAG,GAAG,WAAW,SAAS,YAAY,EAAE;AAAA,SAC/C;AAAA,IACN;AAAA,IAED;AAAA,EACH;AAEJ;AAEA,IAAO,mBAAQ;;;AmDhPf;AAAA,OAAOE,cAAW;AAKlB,IAAM,OAAO,CAAC;AAAA,EACZ,OAAO,gBAAAC,SAAA,cAAAA,SAAA,cAAE;AAAA,EACT,UAAU;AAAA,EACV,kBAAkB;AAAA,EAClB,YAAY;AAAA,EACZ,kBAAkB;AAAA,EAClB;AAAA,EACA,KAAAC,OAAM,CAAC;AACT,MAQM;AACJ,MAAI,mBAAmB,CAAC,SAAS;AAC/B,WAAO;AAAA,EACT;AACA,SACE,gBAAAD,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK,iBAAE,iBAAiB,GAAG,SAAS,KAAK,MAAM,cAAc,QAASC;AAAA,MACtE,SAAS,MAAM;AAAA;AAAA,IAEd;AAAA,IACD,gBAAAD,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,YAAY,aAAa,OAAO,UAAU,KACjE,OACH;AAAA,EACF;AAEJ;AAEA,IAAO,eAAQ;;;ACvCf;AAAA,OAAOE,cAAW;AAMlB,IAAM,mBAAmB,CAAC;AAAA,EACxB,cAAc;AAAA,EACd,OAAO;AAAA,EACP,KAAAC,OAAM,CAAC;AACT,MAKE,gBAAAC,SAAA,cAAC,QAAK,WAAU,UAAS,SAAQ,UAAS,OAAM,UAAS,KAAK,iBAAE,MAAM,QAAQ,OAAO,eAAgBD,SACnG,gBAAAC,SAAA,cAAC,WAAQ,OAAM,gBAAe,MAAM,KAAK,GACxC,OAAO,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,IAAI,OAAO,OAAO,mBAAmB,KAAI,IAAK,IAAU,IAC/E;AAGF,IAAO,2BAAQ;;;ACrBf;AAAA,OAAOC,cAAW;AAClB,SAAS,YAAAC,kBAAgB;AACzB,SAAS,wBAAAC,6BAA4B;AACrC,SAAS,yBAAAC,+BAA6B;AACtC,SAAS,kBAAkB;AAM3B,IAAM,cAAc,CAAC;AAAA,EACnB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,qBAAqB;AAAA,EACrB,qBAAqB;AACvB,MAQM;AA1BN,MAAAC,KAAAC,KAAA;AA2BE,QAAM,aAAa,CAAC,MAA4B;AAC9C,MAAE,eAAe;AAAA,EACnB;AACA,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,EAAE,cAAc,eAAe,kBAAkB,qBAAqB,IAAIC,wBAAsB;AAEtG,QAAM,SAAS,cAAc;AAC7B,QAAM,EAAE,WAAW,WAAW,CAAC,EAAE,MAAI,MAAAF,OAAAD,MAAA,iCAAQ,YAAR,gBAAAA,IAAiB,YAAjB,gBAAAC,IAA0B,YAA1B,mBAAmC,aAAY,CAAC;AAErF,QAAM,cACJ,qCAAU,mBAAkBG,sBAAqB,kCACjD,CAAC,gBACD,CAAC,iBACD,CAAC,oBACD,CAAC;AAEH,SACE,gBAAAC,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,EAAE,eAAe,qBAAqB,WAAW,OAAO,OAAO,EAAE,eAAe,MAAM,EAAE;AAAA,MAC7F,UAAU;AAAA;AAAA,IAEV,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,MAAM,GAAG,OAAO,KAC/C,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,UAAQ;AAAA,QACR,IAAG;AAAA,QACH;AAAA,QACA,KAAK,EAAE,GAAG,QAAQ,WAAW,aAAa;AAAA,QAC1C,OAAO;AAAA,QACP,UAAU,OAAK,SAAS,EAAE,OAAO,MAAM,UAAU,CAAC;AAAA,QAClD,aAAY;AAAA,QACZ,WAAS;AAAA,QACT,cAAa;AAAA,QACb,WAAW,OAAK;AACd,cAAI,EAAE,QAAQ,WAAW,KAAK,KAAK,EAAE,SAAS,GAAG;AAC/C,cAAE,eAAe;AACjB,gBAAI,UAAU;AACZ;AAAA,YACF;AACA,mBAAO;AAAA,UACT;AAAA,QACF;AAAA;AAAA,IACF,GACC,sBAAsB,sBAAsB,CAAC,WAAW,gBAAAA,SAAA,cAAC,qBAAgB,IAAK,IACjF;AAAA,IAEA,gBAAAA,SAAA,cAAC,UAAO,MAAK,UAAS,MAAI,MAAC,UAAU,CAAC,QAAQ,CAAC,YAAY,SAAS,UAEjE,aAAa,gBAAAA,SAAA,cAAC,cAAW,QAAQ,IAAI,OAAO,IAAI,IAAK,MACrD,aAAa,SAAS,oBAAoB,SAAS,cACtD;AAAA,EACF;AAEJ;AAEA,IAAM,OAAO,OAAO,QAAQ;AAAA,EAC1B,OAAO;AAAA,EACP,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,KAAK;AAAA,EACL,IAAI;AAAA,EACJ,IAAI;AAAA,EACJ,OAAO;AAAA,IACL,KAAK;AAAA,EACP;AACF,CAAC;AAED,IAAO,sBAAQ;;;AtDhDf,IAAM,4BAA4B,CAAC,YAAY,MAAM;AACnD,MAAI,cAAc,GAAG;AACnB,WAAO;AAAA,EACT;AACA,QAAM,eAAe,kBAAkB,SAAS;AAChD,SAAO,GAAG,YAAY,SAAS,SAAS,YAAY,MAAM,IAAI,KAAK,GAAG;AACxE;AAEA,IAAM,0BAA0B,MAAM;AACpC,QAAM,YAAYC,cAAYC,gBAAe;AAC7C,QAAM,aAAaD,cAAYE,sBAAqB,uCAAW,UAAU,CAAC;AAC1E,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,MAAI,cAAc;AAClB,OAAI,yCAAY,WAAS,yCAAY,SAAQ;AAC3C,kBAAc,WAAW,QAAQ,WAAW;AAAA,EAC9C,OAAO;AACL,kBAAc,WAAW,IAAI,KAAK,KAAK;AAAA,EACzC;AACA,SAAO;AACT;AAEA,IAAM,cAAc,CAAC;AAAA,EACnB;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,CAAC,mBAAmB,oBAAoB,IAAI;AAAA,IAChD,oBAAoB;AAAA,IACpB;AAAA,EACF;AACA,QAAM,EAAE,cAAc,IAAIC,wBAAsB;AAChD,QAAM,YAAY,aAAa;AAC/B,QAAM,CAAC,MAAM,OAAO,IAAIC,WAAS,eAAe,kBAAkB,IAAI;AACtE,QAAM,EAAE,aAAa,YAAY,IAAIC,aAAY;AACjD,QAAM,CAAC,cAAc,eAAe,IAAID,WAAS,KAAK;AACtD,QAAM,EAAE,UAAU,IAAI,sBAAsB;AAC5C,QAAM,EAAE,UAAU,IAAIE,iBAAgB;AACtC,QAAM,iBAAiBP,cAAYQ,eAAc,SAAS,cAAc,CAAC;AACzE,QAAM,EAAE,YAAY,SAAS,KAAK,IAAI,eAAe;AAAA,IACnD;AAAA,IACA,OAAO;AAAA,IACP,cAAc,uCAAW;AAAA,IACzB,iBAAiB;AAAA,MACf,cAAc,eAAe,kBAAkB;AAAA,MAC/C,cAAc,eAAe,kBAAkB;AAAA,MAC/C,+BAA+B,CAAC,wBAAwB;AAAA,IAC1D;AAAA,IACA,gCAAgC;AAAA,IAChC,aAAa,CAAC,GAAG,WAAW;AAC1B,UAAI,WAAW,WAAW;AACxB,wBAAgB,IAAI;AAAA,MACtB;AAAA,IACF;AAAA,IACA;AAAA,EACF,CAAC;AACD,QAAM,EAAE,kBAAkB,IAAIC,sBAAqB;AACnD,QAAM,YAAYT,cAAYU,gBAAe;AAC7C,QAAM,wBAAwBC,cAAY,MAAM;AAC9C,yBAAqB;AAAA,MACnB;AAAA,IACF,CAAC;AACD,SAAK;AAAA,EACP,GAAG,CAAC,MAAM,MAAM,oBAAoB,CAAC;AACrC,QAAM,EAAE,WAAW,CAAC,EAAE,IAAI,2BAA2B;AACrD,QAAM,EAAE,gBAAgB,gBAAgB,CAAC,GAAG,mBAAmB,IAAI,YAAY,CAAC;AAChF,QAAM,cAAc,wBAAwB;AAC5C,EAAAC,YAAU,MAAM;AACd,QAAI,WAAW;AACb,UAAI,aAAa;AACf,8BAAsB;AAAA,MACxB,OAAO;AACL,gBAAQ,EAAE,KAAK,MAAM,kBAAkB,CAAC;AAAA,MAC1C;AAAA,IACF;AAAA,EAEF,GAAG,CAAC,WAAW,WAAW,CAAC;AAE3B,EAAAA,YAAU,MAAM;AACd,QAAI,aAAa;AACf,cAAQ,WAAW;AAAA,IACrB;AAAA,EACF,GAAG,CAAC,WAAW,CAAC;AAEhB,SAAO,cAAcC,cAAa,UAChC,gBAAAC,SAAA,cAAC,QAAK,SAAQ,UAAS,KAAK,EAAE,MAAM,QAAQ,UAAU,WAAW,KAC/D,gBAAAA,SAAA,cAACC,YAAA,EAAU,KAAK,EAAE,GAAG,QAAQ,IAAI,MAAM,OAAO,EAAE,gBAAgB,iBAAiB,IAAI,MAAM,EAAE,KAC1F,cAAc,OAAO,gBAAAD,SAAA,cAAC,SAAI,GAC3B,gBAAAA,SAAA,cAAC,QAAK,WAAU,UAAS,SAAQ,UAAS,KAAK,EAAE,GAAG,QAAQ,UAAU,SAAS,KAAK,KAAK,KACvF,gBAAAA,SAAA,cAAC,UAAK,GACN,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,WAAW,cAAc,WAAW,SAAS,KACpE,cAAc,KACjB,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,EAAE,GAAG,sBAAsB,WAAW,UAAU,UAAU,QAAQ,UAAU,aAAa;AAAA,MAC9F,SAAQ;AAAA;AAAA,IAEP,cAAc;AAAA,EACjB,GACA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,UAAS,KAAK,EAAE,KAAK,KAAK,KACrC,gBACC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,iBAAgB;AAAA,MAChB,WAAU;AAAA,MACV,MAAM,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,GAAG,OAAO,GAAG,OAAO,iBAAiB,oBAAoB,cAAc,SAAS,GAAG;AAAA;AAAA,EACvG,IACE,MACJ,gBAAAA,SAAA,cAAC,gBAAK,SAAS,0BAA0B,SAAS,GAAG,iBAAe,MAAC,CACvE,CACF,GACC,cAAc,gBAAAA,SAAA,cAAC,eAAY,MAAY,OAAO,cAAc,IAAK,MAClE,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,GAAG,QAAQ,UAAU,GAAG,KAAK,IAAI,aAAa,CAAC,IAAI,GAAG,KAAK,KACrE,gBAAAA,SAAA,cAAC,mBAAgB,cAAc,CAAC,eAAe,CAAC,aAAa,WAAW,CAAC,CAAC,oBAAoB,GAC9F,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,UAAU,CAAC,CAAC;AAAA,MACZ,UAAU;AAAA,MACV,YAAY,cAAc,CAAC;AAAA,MAC3B,QAAQ;AAAA,MACR,oBAAoB,CAAC;AAAA,MACrB,oBAAoB,CAAC;AAAA;AAAA,EACvB,CACF,CACF,GACA,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,UAAU,YAAY,OAAO,KAAK,KAAK,GAAG,QAAQ,QAAQ,UAAU,SAAS,KACvF,gBAAAA,SAAA,cAAC,sBAAS,CACZ,CACF,IAEA,gBAAAA,SAAA,cAAC,8BAAiB;AAEtB;AAEA,IAAMC,aAAY,OAAO,OAAO;AAAA,EAC9B,OAAO;AAAA,GACJ,aAF2B;AAAA,EAG9B,eAAe;AAAA,EACf,IAAI;AACN,EAAC;AAEM,IAAM,cAAc,CAAC,EAAE,MAAM,MAAM,MAAyC;AACjF,QAAM,YAAYf,cAAYC,gBAAe;AAC7C,QAAM,EAAE,qBAAqB,YAAY,IAAIK,aAAY;AACzD,QAAM,YAAYN,cAAYgB,0BAAyB;AACvD,QAAM,mBAAmB,cAAc,YAAY,gBAAgB;AACnE,QAAM,gBAAgBd,sBAAqB,uCAAW,UAAU;AAChE,QAAM,QAAQF,cAAY,aAAa;AACvC,QAAM,eAAe,CAAC,uBAAuB,CAAC;AAC9C,QAAM,cAAc,wBAAwB;AAC5C,QAAM,CAAC,KAAK,EAAE,OAAO,iBAAiB,QAAQ,iBAAiB,CAAC,IAAIiB,YAA2B;AAC/F,QAAM,CAAC,YAAY,aAAa,IAAIC;AAAA,IAClC,MAAM,gCAAgC,iBAAiB,gBAAgB;AAAA,IACvE,CAAC,iBAAiB,gBAAgB;AAAA,EACpC;AAEA,SACE,gBAAAJ,SAAA;AAAA,IAAC,gBAAgB;AAAA,IAAhB;AAAA,MACC;AAAA,MACA,KAAK;AAAA,QACH,IAAI;AAAA,QACJ;AAAA,QACA,QAAQ;AAAA,QACR,OAAO;AAAA,QACP,UAAU;AAAA,QACV,UAAU;AAAA,QACV,IAAI;AAAA,QACJ,OAAO;AAAA,UACL,IAAI;AAAA,UACJ,OAAO;AAAA,UACP,UAAU;AAAA,UACV,IAAI;AAAA,QACN;AAAA,MACF;AAAA;AAAA,IAEC,YACC,gBAAAA,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,0BAAe,MAAK,IAAG,QAAQ,UAAU,IAAI,WAAW,OAAO,GAChE,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ,+BAAO,gBAAe,iBAAiB;AAAA,QAC/C,SAAS,UAAU;AAAA,QACnB,eAAY;AAAA;AAAA,IACd,GAEC,CAAC,YACA,gBAAAA,SAAA,cAAC,gBAAgB,iBAAhB,MACC,gBAAAA,SAAA,cAAC,UAAO,MAAY,eAAY,uBAAsB,MAAM,YAAY,CAC1E,IACE,IACN,IACE;AAAA,IACH,CAAC,aAAa,CAAC,QAAQ,gBAAAA,SAAA,cAAC,8BAAiB,IAAK;AAAA,IAE9C,eACC,gBAAAA,SAAA,cAAC,gBAAgB,gBAAhB,EAA+B,MAAM,iBACpC,gBAAAA,SAAA,cAACK,aAAA,IAAW,CACd,IAEA,gBAAAL,SAAA,cAAC,gBAAgB,gBAAhB,EAA+B,MAAM,iBACpC,gBAAAA,SAAA,cAAC,cAAW,SAAS,uCAAW,YAAY,CAC9C;AAAA,EAEJ;AAEJ;AAEO,IAAM,kBAAkB,CAAC,EAAE,cAAc,UAAU,MAAqD;AAC7G,QAAM,WAAWX,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,qBAAqBH,cAAYoB,kBAAiB;AACxD,SACE,gBAAAN,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS,gBAAgB,WAAW,WAAW;AAAA,MAC/C,KAAK;AAAA,QACH,OAAO;AAAA,QACP,IAAI;AAAA,MACN;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,KAAK,KAAK,KACrB,gBAAAA,SAAA,cAAC,sBAAiB,GACjB,aAAa,qBAAqB,gBAAAA,SAAA,cAAC,cAAS,IAAK,IACpD;AAAA,IACA,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAI,OACtB,YAAY,gBAAAA,SAAA,cAAC,qBAAkB,UAAQ,MAAC,GACxC,CAAC,eAAe,gBAAAA,SAAA,cAAC,qBAAgB,IAAK,IACzC;AAAA,EACF;AAEJ;AAEO,IAAM,kBAAkBA,SAAM,KAAK,MAAM;AAC9C,QAAM,CAAC,MAAM,OAAO,IAAIT,WAAS,KAAK;AAEtC,SACE,gBAAAS,SAAA,cAACO,YAAA,MACC,gBAAAP,SAAA,cAAC,sBAAW,eAAY,uBAAsB,KAAK,EAAE,YAAY,EAAE,GAAG,SAAS,MAAM,QAAQ,WAAS,CAAC,KAAK,KAC1G,gBAAAA,SAAA,cAACQ,eAAA,IAAa,CAChB,GACC,QAAQ,gBAAAR,SAAA,cAAC,yBAAc,MAAY,cAAc,SAAS,CAC7D;AAEJ,CAAC;AAED,IAAO,sBAAQ;;;AuDlSf;AAAA,OAAOS,cAAW;AAClB,SAAS,YAAAC,kBAAgB;AAIlB,IAAM,gBAAgB,CAAC;AAAA,EAC5B,OAAO;AAAA,EACP;AAAA,EACA;AAAA,EACA;AAAA,EACA,aAAa;AAAA,EACb;AAAA,EACA,iBAAiB;AACnB,MAQM;AACJ,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAE5C,MAAI,UAAU;AACZ,WACE,gBAAAC,SAAA,cAAC,MAAM,MAAN,EAAW,MAAY,gBACtB,gBAAAA,SAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,IAAI,KAAK,KAC7B,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,YAAY,aAAa,GAAG,oBAAoB,OAAO,EAAE,IAAI,KAAK,EAAE,KAAI,KAAM,GAC1F,MACD,gBAAAA,SAAA,cAAC,kBAAe,YAAwB,UAAoB,UAAU,gBAAgB,CACxF,CACF;AAAA,EAEJ;AAEA,SACE,gBAAAA,SAAA,cAAC,OAAO,MAAP,EAAY,MAAY,OAAO,OAAO,gBACrC,gBAAAA,SAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,SAAA,cAAC,OAAO,SAAP,EAAe,KAAK,EAAE,GAAG,MAAM,GAAG,mBAAmB,OAAK,EAAE,eAAe,KAC1E,gBAAAA,SAAA,cAAC,OAAO,OAAP,EAAa,KAAK,EAAE,GAAG,GAAG,SAAS,QAAQ,eAAe,OAAO,KAAK,OAAO,gBAAgB,SAAS,KACrG,gBAAAA,SAAA,cAAC,QAAK,SAAQ,QAAM,KAAM,CAC5B,GACA,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,IAAI,MAAM,IAAI,MAAM,KAAI,IAAK,GACzC,gBAAAA,SAAA,cAAC,kBAAe,YAAwB,UAAoB,UAAU,gBAAgB,CACxF,CACF,CACF;AAEJ;AAEA,IAAM,iBAAiB,CAAC;AAAA,EACtB;AAAA,EACA;AAAA,EACA,WAAW;AACb,MAKE,gBAAAA,SAAA,cAAC,QAAK,SAAQ,UAAS,OAAM,UAAS,KAAK,EAAE,OAAO,QAAQ,KAAK,OAAO,OAAO,EAAE,IAAI,MAAM,IAAI,KAAK,EAAE,KACpG,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,OAAO,MAAM,KACvB,gBAAAA,SAAA,cAAC,OAAO,OAAP,EAAa,KAAK,EAAE,OAAO,QAAQ,QAAQ,OAAO,GAAG,SAAO,QAC3D,gBAAAA,SAAA,cAAC,UAAO,SAAQ,YAAW,UAAQ,MAAC,KAAK,EAAE,OAAO,QAAQ,GAAG,QAAQ,GAAG,YAAoB,SAE5F,CACF,CACF,GACA,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,OAAO,MAAM,KACvB,gBAAAA,SAAA,cAAC,UAAO,SAAQ,WAAU,KAAK,EAAE,OAAO,OAAO,GAAG,SAAS,UAAU,YAClE,UACH,CACF,CACF;;;AxDtDK,IAAM,yBAAyB,MAAM;AAC1C,QAAM,aAAaC,gBAAc;AACjC,QAAM,EAAE,eAAe,IAAI,cAAc;AACzC,QAAM,YAAYC,cAAY,iBAAiB;AAC/C,QAAM,cAAcA,cAAYC,wBAAuB;AACvD,QAAM,oBAAoBD,cAAY,uBAAuB;AAC7D,QAAM,OAAOA,cAAYE,oBAAmB;AAC5C,QAAM,EAAE,UAAU,IAAIC,gBAAe,EAAE,MAAM,qBAAqB,CAAC;AACnE,QAAM,EAAE,WAAW,CAAC,EAAE,IAAI,2BAA2B;AACrD,QAAM,EAAE,mBAAmB,IAAI,YAAY,CAAC;AAE5C,EAAAC,YAAU,MAAM;AACd,QAAI,EAAC,uDAAmB,OAAM;AAC5B;AAAA,IACF;AACA,KAAC,MAAY;AACX,YAAM,WAAW,QAAQ,EAAE,QAAQ,kBAAkB,KAAK,KAAK,CAAC;AAAA,IAClE,IAAG;AAAA,EACL,GAAG,CAAC,YAAY,mBAAmB,aAAa,cAAc,CAAC;AAE/D,MAAI,EAAC,uDAAmB,OAAM;AAC5B,WAAO;AAAA,EACT;AAEA,QAAM,OACJ,gBAAAC,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,GAAG;AAAA,QACH,WAAW;AAAA,QACX,OAAO,EAAE,WAAW,QAAQ,cAAc,4BAA4B,IAAI,MAAM,IAAI,KAAK;AAAA,MAC3F;AAAA;AAAA,IACD;AAAA,EAED,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,OAAO,EAAE,OAAO,OAAO;AAAA,QACvB,eAAe;AAAA,QACf,IAAI;AAAA,QACJ,OAAO,EAAE,IAAI,KAAK;AAAA,MACpB;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,eAAY,MAAM,QAAQ,IAAI;AAAA,IAE/B,gBAAAA,SAAA,cAAC,mBAAgB,cAAc,MAAM,WAAW,CAAC,CAAC,oBAAoB;AAAA,EACxE,CACF;AAGF,SACE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,cAAc,CAAM,UAAS;AA3EnC,YAAAC;AA4EQ,YAAI,CAAC,OAAO;AACV,qBAAW,iBAAiB,iBAAiB;AAC7C,oBAAU,iCAAK,oBAAL,EAAwB,UAAU,KAAK,IAAG,EAAE,SAAQA,MAAA,kBAAkB,gBAAlB,gBAAAA,IAA+B,GAAG,CAAC;AACjG,gBAAM,WAAW,qBAAqB;AACtC,gBAAM,WAAW,mBAAmB;AAAA,QACtC;AAAA,MACF;AAAA,MACA;AAAA,MACA,UAAU,MAAY;AACpB,cAAM,WAAW,iBAAiB,iBAAiB;AACnD,cAAM,eAAe,EAAE,UAAU,YAAY,CAAC;AAC9C,cAAM,WAAW,mBAAmB;AAAA,MACtC;AAAA,MACA,YAAW;AAAA,MACX,gBAAgB,CAAC;AAAA;AAAA,EACnB;AAEJ;;;AyD7FA;AAAA,OAAOC,YAAS,UAAU,aAAAC,aAAW,YAAAC,kBAAgB;AAErD,SAAS,YAAAC,kBAAgB;AAMzB,SAAS,SAAAC,eAAa;AACtB;AAAA,EACE,2BAAAC;AAAA,EACA,6BAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,iBAAAC,gBAAe,mBAAAC,wBAAuB;;;AChB/C;AAAA,OAAOC,YAAS,aAAAC,aAAW,WAAAC,WAAS,YAAAC,kBAAgB;AAEpD;AAAA,EACE,qBAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,eAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,oBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,sBAAAC;AAAA,OACK;;;ACVP;AAAA,OAAOC,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C,SAAS,YAAAC,kBAAgB;AACzB,SAAS,iBAAAC,sBAAqB;;;ACF9B;AAAA,OAAOC,cAAW;AAIX,IAAM,cAAcC,SAAM;AAAA,EAC/B,CAAC,EAAE,MAAM,OAAO,SAAS,MAAkE;AACzF,WACE,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,WAAU;AAAA,QACV,KAAK;AAAA,UACH,WAAW;AAAA,UACX,QAAQ;AAAA,UACR,GAAG;AAAA,UACH,gBAAgB;AAAA,UAChB,KAAK;AAAA,QACP;AAAA;AAAA,MAEA,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK;AAAA,YACH,iBAAiB;AAAA,YACjB,SAAS;AAAA,YACT,YAAY;AAAA,YACZ,KAAK;AAAA,YACL,MAAM;AAAA,YACN,GAAG;AAAA,YACH,gBAAgB;AAAA,UAClB;AAAA;AAAA,QAEC;AAAA,MACH;AAAA,MACA,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,WAAU;AAAA,UACV,KAAK;AAAA,YACH,GAAG;AAAA,YACH,KAAK;AAAA,UACP;AAAA;AAAA,QAEA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,EAAE,UAAU,OAAO,OAAO,mBAAmB,EAAE,KAC7E,KACH;AAAA,QACA,gBAAAA,SAAA;AAAA,UAAC;AAAA;AAAA,YACC,SAAQ;AAAA,YACR,KAAK,EAAE,YAAY,YAAY,OAAO,sBAAsB,OAAO,EAAE,UAAU,MAAM,EAAE;AAAA;AAAA,UAEtF;AAAA,QACH;AAAA,MACF;AAAA,IACF;AAAA,EAEJ;AACF;;;ACnDA;AAAA,OAAOC,YAAS,aAAAC,aAAW,UAAAC,gBAAc;AACzC,OAAO,eAAe;AACtB,SAAS,YAAAC,kBAAgB;AACzB;AAAA,EACE,4BAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,cAAAC,mBAAkB;;;ACV3B;AAAA,OAAOC,YAAS,cAAAC,mBAAkB;AAY3B,IAAM,mBAAmBD,SAAM,cAA+B;AAAA,EACnE,wBAAwB;AAAA,EACxB,2BAA2B;AAAA,EAC3B,kBAAkB;AAAA,EAClB,qBAAqB;AAAA,EACrB,sBAAsB;AAAA,EACtB,WAAW;AAAA,EACX,oBAAoB;AACtB,CAAC;AAEM,IAAM,sBAAsB,MAAM;AACvC,QAAM,UAAUC,YAAW,gBAAgB;AAC3C,SAAO;AACT;;;ADCA,IAAM,gBAAgB,CAAC,EAAE,aAAa,MAAkD;AACtF,SACE,gBAAAC,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,MAAM,GAAG,MAAM,IAAI,oBAAoB,GAAG,MAAM,OAAO,mBAAmB,KACzG,gBAAAA,SAAA,cAAC,oBAAiB,aAAa,MAAM,GACrC,gBAAAA,SAAA,cAAC,YAAK,KAAG,GACT,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,SAAS,MAAM,aAAa,KAAK;AAAA,MACjC,KAAK,EAAE,IAAI,eAAe,QAAQ,cAAc;AAAA;AAAA,IAEhD,gBAAAA,SAAA,cAACC,aAAA,IAAW;AAAA,EACd,CACF;AAEJ;AAEA,IAAM,gBAAgB;AACtB,IAAM,kBAAkB;AACxB,IAAM,2BAA2B,IAAI;AACrC,IAAM,qBAAqB,IAAI;AAExB,IAAM,YAAY,CAAC,EAAE,OAAO,MAA2B;AAC5D,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,cAAcA,WAAS,OAAU,MAAM,EAAE;AAC/C,QAAM,WAAW,SAASC,gBAAe,MAAM,IAAIC;AACnD,QAAM,OAAOC,cAAY,QAAQ;AACjC,QAAM,CAAC,WAAW,YAAY,IAAI,mBAAmB,SAAS,aAAa;AAC3E,QAAM,aAAaA,cAAYC,sBAAqB,6BAAM,UAAU,CAAC;AACrE,QAAM,qBAAqBD,cAAYE,yBAAwB;AAC/D,QAAM,iBAAiB,oBAAoB;AAC3C,MAAI,cAAc,WAAW,2BAA2B;AACxD,OAAI,yCAAY,WAAS,yCAAY,WAAU,CAAC,UAAU;AACxD,kBAAc,WAAW,QAAQ,WAAW;AAAA,EAC9C;AACA,MAAI,SAAS;AACb,MAAI,QAAQ,SAAS;AAErB,MAAI,eAAe,QAAQ,iBAAiB;AAC1C,YAAQ;AACR,aAAS,QAAQ;AAAA,EACnB;AAEA,QAAM,UAAUC,SAAuB,IAAI;AAE3C,EAAAC,YAAU,MAAM;AACd,UAAM,OAAO,QAAQ;AACrB,QAAI,CAAC,QAAQ,CAAC,OAAO,gBAAgB;AACnC;AAAA,IACF;AACA,UAAM,iBAAiB,IAAI,eAAe,aAAW;AACnD,cAAQ,QAAQ,WAAS;AACvB,YAAI,MAAM,WAAW,KAAK,eAAe;AAEvC,eAAK,MAAM,YAAY;AAAA,QACzB;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AACD,SAAK,iBAAiB,eAAe,QAAQ,KAAK,aAAa;AAC/D,WAAO,MAAM;AACX,oCAAM,mBAAiB,iDAAgB,UAAU,KAAK;AACtD,uDAAgB;AAAA,IAClB;AAAA,EACF,GAAG,CAAC,CAAC;AAEL,MAAI,CAAC,mBAAmB,SAAS,CAAC,mBAAmB,OAAO;AAC1D,WAAO;AAAA,EACT;AAEA,SACE,gBAAAT,SAAA,cAAC,aAAU,QAAO,UAAS,SAAkB,QAAO,0BAClD,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,MACL,KAAK;AAAA,QACH,UAAU;AAAA,QACV,QAAQ;AAAA,QACR,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,WAAW;AAAA,QACX,GAAG;AAAA,SACC,CAAC,YACD;AAAA,QACE;AAAA,QACA,GAAG;AAAA,MACL,IACA,CAAC;AAAA;AAAA,IAGN,YACC,gBAAAA,SAAA,cAAC,iBAAc,cAA4B,IAE3C,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,QAAQ,6BAAM;AAAA,QACd,SAAS,6BAAM;AAAA,QACf,SAAS;AAAA,UACP,MAAM;AAAA,UACN,SAAS;AAAA,QACX;AAAA,QACA;AAAA,QACA;AAAA,QACA,cAAc,EAAE,YAAY,mBAAmB;AAAA,QAC/C,aAAW;AAAA,QACX,aAAW;AAAA,SACP,iBAZL;AAAA,QAaC,2BAAyB;AAAA;AAAA,IAC3B;AAAA,EAEJ,CACF;AAEJ;;;AEvIA;AAAA,OAAOU,YAAS,aAAAC,mBAAiB;AACjC,SAAS,mBAAAC,kBAAiB,oBAAAC,yBAAwB;AAG3C,IAAM,aAAa,CAAC;AAAA,EACzB;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,cAAc,SAAS;AAC7B,QAAM,eAAe,SAAS,WAAW;AACzC,QAAM,WAAW,CAAC,MAA4B;AAC5C,MAAE,gBAAgB;AAClB,iBAAa,KAAK,IAAI,OAAO,GAAG,WAAW,CAAC,CAAC;AAAA,EAC/C;AACA,QAAM,WAAW,CAAC,MAA4B;AAC5C,MAAE,gBAAgB;AAClB,iBAAa,KAAK,IAAI,OAAO,GAAG,CAAC,CAAC;AAAA,EACpC;AAEA,EAAAC,YAAU,MAAM;AAEd,QAAI,QAAQ,UAAU;AACpB,mBAAa,KAAK,IAAI,GAAG,WAAW,CAAC,CAAC;AAAA,IACxC;AAAA,EACF,GAAG,CAAC,UAAU,cAAc,IAAI,CAAC;AAEjC,MAAI,YAAY,GAAG;AACjB,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,SAAA,cAAC,iBAAiB,MAAjB,EAAsB,KAAK,EAAE,YAAY,EAAE,KAC1C,gBAAAA,SAAA,cAAC,iBAAiB,SAAjB,EAAyB,UAAU,aAAa,SAAS,YACxD,gBAAAA,SAAA,cAACC,kBAAA,EAAgB,OAAO,IAAI,QAAQ,IAAI,OAAO,EAAE,QAAQ,cAAc,gBAAgB,UAAU,GAAG,CACtG,GACC,YAAY,IACX,gBAAAD,SAAA,cAAC,iBAAiB,MAAjB,MACE,CAAC,GAAG,MAAM,QAAQ,CAAC,EAAE,IAAI,CAAC,GAAG,MAC5B,gBAAAA,SAAA;AAAA,IAAC,iBAAiB;AAAA,IAAjB;AAAA,MACC,KAAK;AAAA,MACL,QAAQ,SAAS;AAAA,MACjB,SAAS,OAAK;AACZ,UAAE,gBAAgB;AAClB,qBAAa,CAAC;AAAA,MAChB;AAAA;AAAA,EACF,CACD,CACH,IACE,MACJ,gBAAAA,SAAA,cAAC,iBAAiB,SAAjB,EAAyB,UAAU,cAAc,SAAS,YACzD,gBAAAA,SAAA,cAACE,mBAAA,EAAiB,OAAO,IAAI,QAAQ,IAAI,OAAO,EAAE,QAAQ,eAAe,gBAAgB,UAAU,GAAG,CACxG,CACF;AAEJ;;;AC3DA;AAAA,OAAOC,cAAW;AAOX,IAAM,OAAOC,SAAM;AAAA,EACxB,CAAC,EAAE,OAAO,WAAW,GAAG,QAAQ;AAC9B,UAAM,iBAAiB,oBAAoB;AAC3C,WACE,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC;AAAA,QACA,KAAK;AAAA,UACH,MAAM;AAAA,UACN,KAAK;AAAA,UACL,SAAS;AAAA,UACT,cAAc;AAAA,UACd,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,UAAU;AAAA,UACV,WAAW;AAAA,UACX,OAAO,EAAE,KAAK,aAAa,IAAI,KAAK;AAAA,QACtC;AAAA;AAAA,MAEC,+BAAO,IAAI,UAAQ;AAzB5B,YAAAC,KAAAC,KAAA;AA0BU,eACE,gBAAAF,SAAA;AAAA,UAAC;AAAA;AAAA,YACC,OAAKC,MAAA,KAAK,UAAL,gBAAAA,IAAY,SAAMC,MAAA,KAAK,SAAL,gBAAAA,IAAW;AAAA,YAClC,OAAO,KAAK;AAAA,YACZ,QAAQ,KAAK;AAAA,YACb,SAAQ,UAAK,SAAL,mBAAW;AAAA,YACnB,UAAS,UAAK,UAAL,mBAAY;AAAA,YACrB,SAAS,EAAE,SAAS,EAAE;AAAA,YACtB,WAAU;AAAA,aACN;AAAA,QACN;AAAA,MAEJ;AAAA,IACF;AAAA,EAEJ;AACF;;;AC1CA;AAAA,SAAS,aAAAC,aAAW,WAAAC,WAAS,YAAAC,kBAAgB;AAC7C,SAAS,cAAAC,aAAY,YAAAC,kBAAgB;AACrC;AAAA,EACE;AAAA,EAEA,mBAAAC;AAAA,EAEA,sBAAAC;AAAA,OACK;AAGP,IAAM,oBAAoB,EAAE,SAAS,CAAC,IAAI,GAAG,IAAI,GAAG,KAAK,CAAC,GAAG,QAAQ,CAAC,IAAI,GAAG,IAAI,GAAG,IAAI,EAAE,EAAE;AAErF,IAAM,oBAAoB,CAAC,EAAE,OAAO,aAAa,MAAkD;AACxG,QAAM,eAAeC,qBAAmB;AACxC,QAAM,YAAY,aAAa,SAASC,gBAAe;AACvD,QAAM,iBAAiBC;AAAA,IACrB,MAAM,kBAAkB,OAAO,WAAW,MAAM,KAAK;AAAA,IACrD,CAAC,OAAO,SAAS;AAAA,EACnB;AACA,QAAM,YAAY,KAAK,KAAK,eAAe,SAAS,YAAY;AAChE,QAAM,YAAYA,UAAQ,MAAM;AAC9B,QAAI,aAAa;AACjB,QAAI,YAAY,eAAe;AAC/B,UAAM,OAAO,CAAC;AAEd,aAAS,IAAI,GAAG,IAAI,WAAW,KAAK;AAClC,YAAM,QAAQ,KAAK,IAAI,WAAW,YAAY;AAC9C,WAAK,KAAK,eAAe,MAAM,YAAY,aAAa,KAAK,CAAC;AAC9D,kBAAY,YAAY;AACxB,oBAAc;AAAA,IAChB;AACA,WAAO;AAAA,EACT,GAAG,CAAC,gBAAgB,WAAW,YAAY,CAAC;AAC5C,SAAO;AACT;AAEO,IAAM,gBAAgB,CAAC;AAAA,EAC5B;AAAA,EACA;AAAA,EACA,aAAa;AACf,MAIM;AACJ,QAAM,eAAeF,qBAAmB;AACxC,QAAM,CAAC,KAAK,EAAE,OAAO,OAAO,CAAC,IAAIG,YAA2B;AAC5D,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,CAAC,gBAAgB,iBAAiB,IAAIC,WAAyC,CAAC,CAAC;AAEvF,EAAAC,YAAU,MAAM;AACd,QAAI,UAAU,KAAK,WAAW,GAAG;AAC/B;AAAA,IACF;AAEA,eAAW,QAAQ,UAAU;AAC3B,YAAM,kBAAkB,KAAK;AAC7B,UAAI,UACF,kBAAkB,KAAK,kBAAkB,IACrC,KAAK,KAAK,kBAAkB,CAAC,IAC7B,KAAK,KAAK,KAAK,KAAK,eAAe,CAAC;AAC1C,UAAI,UAAU;AACZ,kBAAU,kBAAkB,IAAI,IAAI,KAAK,IAAI,SAAS,CAAC;AAAA,MACzD;AACA,YAAM,UAAU,KAAK,KAAK,kBAAkB,OAAO;AACnD,UAAI,QAAQ;AAEZ,YAAM,SAAS,IAAI,MAAM,OAAO,EAAE,KAAK,IAAI,EAAE,IAAI,CAAC,GAAG,MAAM;AACzD,cAAM,UAAU,KAAK,IAAI,SAAS,kBAAkB,IAAI,OAAO;AAC/D,cAAM,cAAc,CAAC;AACrB,iBAASC,KAAI,GAAGA,KAAI,SAASA,MAAK;AAChC,cAAI,QAAQ,KAAK,QAAQ;AACvB,wBAAY,KAAK,KAAK,OAAO,CAAC;AAAA,UAChC;AAAA,QACF;AACA,eAAO;AAAA,MACT,CAAC;AAED,YAAM,MAAM,cAAc,WAAW,IAAI;AACzC,YAAM,YAAY,UAAU,UAAU,KAAK;AAC3C,YAAM,eAAe,YAAY,OAAO;AACxC,YAAM,eACJ,aAAa,oBAAoB,KAAK,kBAAkB,KACpD,kBAAkB,SAClB,kBAAkB;AAExB,iBAAW,OAAO,QAAQ;AACxB,YAAI,aAAa,SAAS,IAAI,SAAS,KAAK,OAAO,IAAI;AACvD,YAAI,aAAa;AACjB,YAAI,YAAY;AACd,uBAAa;AAAA,QACf,OAAO;AACL,gBAAM,cAAc,aAAa,IAAI,QAAM,YAAY,EAAE;AACzD,qBAAWC,MAAK,aAAa;AAC3B,gBAAIA,KAAI,cAAc;AACpB,kBAAI,aAAaA,IAAG;AAClB,6BAAaA;AAAA,cACf;AAAA,YACF;AAAA,UACF;AAIA,cAAI,eAAe,GAAG;AACpB,yBAAa;AACb,kBAAM,aAAa,aAAa,IAAI,QAAM,aAAa,EAAE;AACzD,wBAAY;AACZ,uBAAW,KAAK,YAAY;AAC1B,kBAAI,IAAI,OAAO;AACb,oBAAI,YAAY,GAAG;AACjB,8BAAY;AAAA,gBACd;AAAA,cACF;AAAA,YACF;AAAA,UACF;AAAA,QACF;AACA,iBAAS,IAAI,GAAG,IAAI,IAAI,QAAQ,KAAK;AACnC,cAAI,CAAC,EAAE,QAAQ;AACf,cAAI,CAAC,EAAE,SAAS;AAAA,QAClB;AAAA,MACF;AAAA,IACF;AACA,sBAAkB,CAAC,GAAG,QAAQ,CAAC;AAAA,EACjC,GAAG,CAAC,OAAO,QAAQ,cAAc,UAAU,cAAc,UAAU,UAAU,CAAC;AAC9E,SAAO,EAAE,gBAAgB,IAAI;AAC/B;;;AN/GO,SAAS,gBAAgB,EAAE,iBAAiB,OAAO,OAAO,cAAc,YAAY,WAAW,GAAgB;AAftH,MAAAC;AAgBE,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,MAAI,eAAe,cAAc,YAAY,YAAY;AACzD,iBAAe,WAAW,KAAK,IAAI,cAAc,CAAC,IAAI;AACtD,QAAM,WAAW,kBAAkB;AAAA,IACjC;AAAA,IACA;AAAA,EACF,CAAC;AAED,QAAM,EAAE,KAAK,eAAe,IAAI,cAAc;AAAA,IAC5C;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AACD,QAAM,CAAC,MAAM,OAAO,IAAIC,WAAS,CAAC;AAClC,QAAM,aAAWF,MAAA,eAAe,CAAC,MAAhB,gBAAAA,IAAmB,WAAU;AAE9C,EAAAG,YAAU,MAAM;AACd,QAAI,WAAW,GAAG;AAChB,+CAAa;AAAA,IACf;AAAA,EACF,GAAG,CAAC,UAAU,UAAU,CAAC;AAEzB,SACE,gBAAAC,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,MAAM,SAAS,GAAG,QAAQ,UAAU,YAAY,UAAU,EAAE,KAC1F,gBAAAA,SAAA,cAAC,QAAK,OAAO,eAAe,IAAI,GAAG,KAAU,YAAwB,GACpE,CAAC,cACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,cAAc,CAAAC,UAAQ;AACpB,gBAAQA,KAAI;AACZ,qDAAeA;AAAA,MACjB;AAAA,MACA,UAAU,eAAe;AAAA;AAAA,EAC3B,GAED,SAAS,WAAW,IACnB,gBAAAD,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,UAAS;AAAA,MACT,MAAM,gBAAAA,SAAA,cAACE,gBAAA,EAAc,OAAM,QAAO,QAAO,QAAO,OAAO,EAAE,OAAO,QAAQ,GAAG;AAAA;AAAA,EAC7E,IACE,MACH,kBAAkB,gBAAAF,SAAA,cAAC,eAAU,CAChC;AAEJ;;;AO7DA;AAAA,OAAOG,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C,SAAS,YAAAC,kBAAgB;AACzB,SAAS,mBAAAC,mBAAiB,eAAAC,qBAAmB;;;ACF7C;AAAA,OAAOC,YAAS,aAAAC,aAAW,UAAAC,UAAQ,YAAAC,kBAAgB;AACnD,SAAS,YAAAC,kBAAgB;AACzB,SAAS,iBAAAC,iBAAe,sBAAAC,sBAAoB,mBAAAC,kBAAiB,eAAAC,qBAAmB;;;ACFhF;AAAA,OAAOC,cAAW;AAQlB,IAAMC,SAAO,CAAC;AAAA,EACZ;AAAA,EACA;AAAA,EACA;AACF,MAA+E;AAC7E,SACE,gBAAAC,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAW,aAAa,QAAQ;AAAA,MAChC,KAAK,EAAE,GAAG,QAAQ,MAAM,SAAS,UAAU,GAAG,KAAK,MAAM,OAAO,EAAE,KAAK,aAAa,IAAI,KAAK,EAAE;AAAA;AAAA,IAE9F;AAAA,EACH;AAEJ;AAEA,IAAM,mBAAmB,CAAC,EAAE,UAAU,KAAAC,OAAM,CAAC,EAAE,MAA8C;AAC3F,SACE,gBAAAD,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,iBAAE,MAAM,SAAS,KAAK,MAAM,WAAW,KAAMC,SACxE,QACH;AAEJ;AAEA,IAAM,mBAAmB,CAAC;AAAA,EACxB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAAoH;AAClH,QAAM,kBAAkB,oBAAoB;AAC5C,MAAI,EAAC,+BAAO,SAAQ;AAClB,WAAO;AAAA,EACT;AACA,QAAM,aAAa,aACf;AAAA,IACE,qBAAqB;AAAA,IACrB,kBAAkB,UAAU,MAAM,MAAM;AAAA,IACxC,WAAW;AAAA,IACX,OAAO;AAAA,EACT,IACA;AAAA,IACE,kBAAkBD,SAAM,SAAS,MAAM,QAAQ,IAAI,IAAI,eAAe;AAAA,IACtE,qBAAqB,UAAU,MAAM,MAAM;AAAA,EAC7C;AACJ,SACE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,KAAK,aAAa,OAAO;AAAA,QACzB,YAAY;AAAA,SACT,aALA;AAAA,QAMH,OAAO,EAAE,KAAK,aAAa,IAAI,KAAK;AAAA,MACtC;AAAA;AAAA,IAEC,MAAM,IAAI,UAAQ;AA/DzB,UAAAE,KAAAC,KAAA;AAgEQ,aACE,gBAAAH,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAKE,MAAA,KAAK,UAAL,gBAAAA,IAAY,SAAMC,MAAA,KAAK,SAAL,gBAAAA,IAAW;AAAA,UAClC,SAAQ,UAAK,SAAL,mBAAW;AAAA,UACnB,UAAS,UAAK,UAAL,mBAAY;AAAA,UACrB,SAAS;AAAA,YACP,SAAS;AAAA,YACT,UAAU;AAAA,YACV,aAAa,KAAK;AAAA,aACd,aAAa,EAAE,GAAG,OAAO,IAAI,EAAE,GAAG,OAAO,IAJtC;AAAA,YAKP,OAAO,EAAE,aAAa,EAAE;AAAA,UAC1B;AAAA,UACA,WAAU;AAAA,WACN;AAAA,MACN;AAAA,IAEJ,CAAC;AAAA,IACA,YAAY,gBAAAH,SAAA,cAAC,OAAI,KAAK,EAAE,YAAY,aAAa,IAAI,UAAU,MAAM,MAAM,GAAG,KAAI,QAAS;AAAA,EAC9F;AAEJ;AAEO,IAAM,mBAAmB;AAAA,EAC9B,MAAAD;AAAA,EACA;AAAA,EACA;AACF;;;ADhFO,IAAM,iBAAiB,CAAC,EAAE,OAAO,cAAc,YAAY,YAAY,WAAW,MAAmB;AAV5G,MAAAK,KAAAC;AAWE,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,eAAe,WAAW,IAAI;AACpC,QAAM,CAAC,MAAM,OAAO,IAAIC,WAAS,CAAC;AAClC,QAAM,gBAAgBC,cAAYC,gBAAc,SAAS,aAAa,CAAC;AACvE,QAAM,kBAAkBD,cAAYE,gDAA8C,CAAC;AACnF,QAAM,0BAA0BF,cAAYC,gBAAc,SAAS,uBAAuB,CAAC;AAC3F,QAAM,cAAaL,MAAAI,cAAYG,iBAAgB,aAAa,CAAC,MAA1C,gBAAAP,IAA6C;AAChE,QAAM,0BAA0BQ,SAAO,KAAK;AAC5C,QAAM,iBAAiB,kBAAkB;AAAA,IACvC,OACE,mBAAmB,aACf,CAAC,GAAG,KAAK,EAAE,KAAK,CAAC,IAAI,OAAO;AAC1B,UAAI,4BAA4B,GAAG,IAAI;AACrC,eAAO;AAAA,MACT;AACA,UAAI,4BAA4B,GAAG,IAAI;AACrC,eAAO;AAAA,MACT;AACA,YAAM,aAAa,CAAC,YAAY,eAAe;AAE/C,UAAI,WAAW,SAAS,GAAG,EAAE,GAAG;AAC9B,eAAO;AAAA,MACT;AACA,UAAI,WAAW,SAAS,GAAG,EAAE,GAAG;AAC9B,eAAO;AAAA,MACT;AACA,aAAO;AAAA,IACT,CAAC,IACD;AAAA,IACN;AAAA,EACF,CAAC;AACD,QAAM,aAAWP,MAAA,eAAe,CAAC,MAAhB,gBAAAA,IAAmB,WAAU;AAG9C,EAAAQ,YAAU,MAAM;AA7ClB,QAAAT;AA8CI,QAAI,MAAM,SAAS,KAAK,GAACA,MAAA,eAAe,IAAI,MAAnB,gBAAAA,IAAsB,SAAQ;AACrD,cAAQ,KAAK,IAAI,GAAG,OAAO,CAAC,CAAC;AAAA,IAC/B;AAAA,EACF,GAAG,CAAC,OAAO,MAAM,cAAc,CAAC;AAEhC,EAAAS,YAAU,MAAM;AACd,QAAI,WAAW,GAAG;AAChB,+CAAa;AAAA,IACf;AAAA,EACF,GAAG,CAAC,UAAU,UAAU,CAAC;AAEzB,EAAAA,YAAU,MAAM;AACd,SAAK,cAAc,oBAAoB,SAAS,KAAK,CAAC,wBAAwB,SAAS;AACrF,cAAQ,CAAC;AACT,8BAAwB,UAAU;AAAA,IACpC,WAAW,CAAC,cAAc,CAAC,iBAAiB;AAC1C,8BAAwB,UAAU;AAAA,IACpC;AAAA,EACF,GAAG,CAAC,YAAY,iBAAiB,IAAI,CAAC;AAEtC,SACE,gBAAAC,SAAA,cAAC,iBAAiB,kBAAjB,EAAkC,OAAO,eAAe,IAAI,GAAG,YAAwB,cACrF,CAAC,cACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,cAAc,CAAAC,UAAQ;AACpB,gBAAQA,KAAI;AACZ,qDAAeA;AAAA,MACjB;AAAA,MACA,UAAU,eAAe;AAAA;AAAA,EAC3B,CAEJ;AAEJ;;;AEhFA;AAAA,SAAS,WAAAC,iBAAe;AAKjB,IAAM,yBAAyB,CAAC,gBAA0B,OAAkB,mBAA4B;AAC7G,QAAM,cAAc,eAAe;AAEnC,QAAM,CAAC,gBAAgB,cAAc,IAAIC,UAAQ,MAAM;AACrD,WAAO,MAAM;AAAA,MACX,CAAC,KAAK,SAAS;AACb,YAAI,aAAa;AACf,cAAI,YAAY,WAAW,KAAK,IAAI;AAClC,gBAAI,CAAC,EAAE,KAAK,IAAI;AAAA,UAClB,WAAW,EAAE,kBAAkB,KAAK,UAAU;AAC5C,gBAAI,CAAC,EAAE,KAAK,IAAI;AAAA,UAClB;AACA,iBAAO;AAAA,QACT;AACA,YAAI,KAAK,WAAW,kBAAkB,EAAC,iDAAgB,SAAS,KAAK,YAAY,MAAK;AACpF,iBAAO;AAAA,QACT;AACA,YAAI,iDAAgB,SAAS,KAAK,YAAY,KAAK;AACjD,cAAI,CAAC,EAAE,KAAK,IAAI;AAAA,QAClB,OAAO;AACL,cAAI,CAAC,EAAE,KAAK,IAAI;AAAA,QAClB;AAEA,eAAO;AAAA,MACT;AAAA,MACA,CAAC,CAAC,GAAG,CAAC,CAAC;AAAA,IACT;AAAA,EACF,GAAG,CAAC,OAAO,gBAAgB,gBAAgB,WAAW,CAAC;AAEvD,SAAO;AAAA,IACL;AAAA,IACA;AAAA,EACF;AACF;;;AHtBO,SAAS,eAAe;AAAA,EAC7B,iBAAiB;AAAA,EACjB,iBAAiB,CAAC;AAAA,EAClB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,GAAgB;AAvBhB,MAAAC;AAwBE,QAAM,EAAE,gBAAgB,eAAe,IAAI,uBAAuB,gBAAgB,OAAO,cAAc;AACvG,QAAM,YAAYC,cAAYC,iBAAe;AAC7C,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,MAAI,eAAe,cAAc,YAAY,YAAY;AACzD,iBAAe,WAAW,IAAI;AAC9B,QAAM,WAAW,kBAAkB;AAAA,IACjC,OAAO;AAAA,IACP;AAAA,EACF,CAAC;AACD,QAAM,EAAE,KAAK,eAAe,IAAI,cAAc;AAAA,IAC5C;AAAA,IACA;AAAA,EACF,CAAC;AACD,QAAM,CAAC,MAAM,OAAO,IAAIC,WAAS,CAAC;AAClC,QAAM,aAAWJ,MAAA,eAAe,CAAC,MAAhB,gBAAAA,IAAmB,WAAU;AAE9C,EAAAK,YAAU,MAAM;AACd,QAAI,WAAW,GAAG;AAChB,+CAAa;AAAA,IACf;AAAA,EACF,GAAG,CAAC,UAAU,UAAU,CAAC;AAEzB,SACE,gBAAAC,SAAA,cAAC,iBAAiB,MAAjB,MACC,gBAAAA,SAAA,cAAC,iBAAiB,kBAAjB,MACC,gBAAAA,SAAA,cAAC,QAAK,KAAU,OAAO,eAAe,IAAI,GAAG,CAC/C,GACC,CAAC,cACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA,cAAc,CAAAC,UAAQ;AACpB,gBAAQA,KAAI;AACZ,qDAAeA;AAAA,MACjB;AAAA,MACA,UAAU,eAAe;AAAA;AAAA,EAC3B,GAEF,gBAAAD,SAAA,cAAC,kBAAe,OAAO,gBAAgB,gBAAgC,YAAwB,GAC9F,kBAAkB,aAAa,eAAe,SAAS,KAAK,CAAC,eAAe,SAAS,SAAS,KAAK,gBAAAA,SAAA,cAAC,eAAU,CACjH;AAEJ;;;AIjEA;AAAA,OAAOE,YAAS,aAAAC,aAAW,WAAAC,WAAS,YAAAC,kBAAgB;AACpD,SAAS,YAAAC,kBAAgB;AACzB,SAAS,0BAA0B,eAAAC,qBAAmB;;;ACFtD;AAAA,OAAOC,YAAS,UAAAC,UAAQ,YAAAC,kBAAgB;AACxC,SAAS,iBAAAC,gBAAe,YAAAC,kBAAgB;AACxC,OAAOC,iBAAgB;AACvB;AAAA,EACE,qBAAAC;AAAA,EACA,kBAAAC;AAAA,EACA;AAAA,EACA,6BAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,cAAAC,aAAY,cAAAC,mBAAkB;;;ACVvC;AAAA,OAAOC,YAAS,eAAAC,eAAa,YAAAC,kBAAgB;AAC7C,SAAS,aAAAC,YAAW,mBAAAC,kBAAiB,iBAAAC,sBAAqB;AASnD,IAAM,qBAAqB,MAAM;AACtC,QAAM,CAAC,MAAM,OAAO,IAAIC,WAAS,KAAK;AACtC,QAAM,CAAC,YAAY,aAAa,IAAI,iBAAiB,YAAY,UAAU;AAC3E,QAAM,mBAAmBC;AAAA,IACvB,CAAC,UAAkB;AACjB,oBAAc,KAAK;AACnB,cAAQ,KAAK;AAAA,IACf;AAAA,IACA,CAAC,eAAe,OAAO;AAAA,EACzB;AACA,SACE,gBAAAC,SAAA,cAACC,SAAQ,MAAR,EAAa,MAAY,cAAc,WACtC,gBAAAD,SAAA,cAACC,SAAQ,SAAR,EAAgB,SAAO,QACtB,gBAAAD,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,KAAK;AAAA,QACL,OAAO,OAAO,oBAAoB;AAAA,QAClC,GAAG;AAAA,QACH,GAAG;AAAA,QACH,QAAQ;AAAA,MACV;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,OAAO;AAAA,UACP,WAAW;AAAA,YACT,GAAG;AAAA,YACH,GAAG;AAAA,UACL;AAAA,QACF;AAAA;AAAA,MAEC,sBAAsB,UAA4B;AAAA,IACrD;AAAA,IACA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,EAAE,OAAO,WAAW,YAAY,MAAM,KAChE,UACH;AAAA,IACC,OAAO,gBAAAA,SAAA,cAACE,gBAAA,EAAc,OAAO,IAAI,QAAQ,IAAI,IAAK,gBAAAF,SAAA,cAACG,kBAAA,EAAgB,OAAO,IAAI,QAAQ,IAAI;AAAA,EAC7F,CACF,GACA,gBAAAH,SAAA;AAAA,IAACC,SAAQ;AAAA,IAAR;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,iBAAiB;AAAA,QACjB,WAAW;AAAA,QACX,WAAW;AAAA,QACX,YAAY;AAAA,QACZ,OAAO;AAAA,MACT;AAAA,MACA,MAAK;AAAA,MACL,YAAY;AAAA,MACZ,OAAM;AAAA;AAAA,IAEL,OAAO,KAAK,UAAU,EAAE,IAAI,SAAO;AAClC,YAAM,QAAQ,WAAW,GAAqB;AAC9C,aACE,gBAAAD,SAAA;AAAA,QAAC;AAAA;AAAA,UACC;AAAA,UACA,SAAS,MAAM,iBAAiB,KAAK;AAAA,UACrC,OAAM;AAAA,UACN,KAAK;AAAA,YACH,KAAK;AAAA,YACL,cAAc;AAAA,YACd,GAAG;AAAA,YACH,WAAW;AAAA,cACT,QAAQ;AAAA,cACR,IAAI;AAAA,YACN;AAAA,YACA,mBAAmB;AAAA,cACjB,IAAI;AAAA,YACN;AAAA,UACF;AAAA;AAAA,QAEA,gBAAAA,SAAA;AAAA,UAAC;AAAA;AAAA,YACC,OAAM;AAAA,YACN,SAAQ;AAAA,YACR,KAAK;AAAA,cACH,OAAO;AAAA,cACP,WAAW;AAAA,gBACT,GAAG;AAAA,gBACH,GAAG;AAAA,cACL;AAAA,YACF;AAAA;AAAA,UAEC,sBAAsB,KAAK;AAAA,QAC9B;AAAA,QACA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,EAAE,YAAY,MAAM,KAC9C,KACH;AAAA,QACC,UAAU,aAAa,gBAAAA,SAAA,cAACI,YAAA,EAAU,OAAO,IAAI,QAAQ,IAAI,OAAO,EAAE,YAAY,OAAO,GAAG,IAAK;AAAA,MAChG;AAAA,IAEJ,CAAC;AAAA,EACH,CACF;AAEJ;;;AC/GA;AAAA,OAAOC,cAAW;AAClB,SAAS,iBAAAC,uBAAqB;AAC9B,SAAS,aAAAC,aAAW,mBAAAC,wBAAuB;AAKpC,IAAM,qBAAqB,MAAM;AACtC,QAAM,aAAaC,gBAAc;AAEjC,SACE,gBAAAC,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,MAAM;AAAA,QACN,IAAI;AAAA,QACJ,OAAO;AAAA,MACT;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAACC,kBAAA,EAAgB,OAAO,IAAI,QAAQ,IAAI;AAAA,IACxC,gBAAAD,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,OAAO,KAAG,6BAEvC;AAAA,IACA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK,EAAE,YAAY,YAAY;AAAA,QAC/B,SAAS,MAAY;AACnB,gBAAM,WAAW,sBAAsB,KAAK;AAAA,QAC9C;AAAA,QACA,eAAY;AAAA;AAAA,MAEZ,gBAAAA,SAAA,cAACE,aAAA,EAAU,OAAO,IAAI,QAAQ,IAAI;AAAA,MAAE;AAAA,IAEtC;AAAA,EACF;AAEJ;;;AFbA,IAAM,cAAc;AAAA,EAClB,UAAU;AAAA,EACV,OAAO;AAAA,EACP,WAAW;AAAA,EACX,GAAG;AAAA,EACH,WAAW;AAAA,EACX,YAAY;AACd;AAEA,IAAMC,QAAO,CAAC,EAAE,QAAQ,QAAQ,QAAQ,SAAS,OAAO,MAA2D;AACjH,QAAM,UAAUC,cAAYC,mBAAiB,MAAM;AACnD,QAAM,QAAQD,cAAYE,2BAA0B,MAAM,CAAC;AAC3D,QAAM,EAAE,OAAAC,OAAM,IAAI,SAAS;AAC3B,QAAM,OAAOH,cAAYI,gBAAe,MAAM,CAAC;AAC/C,QAAM,cAAc,cAAc,YAAY,WAAW;AACzD,QAAM,CAAC,gBAAgB,iBAAiB,IAAIC,WAAS,KAAK;AAC1D,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,mBAAmB,cAAc,YAAY,gBAAgB;AACnE,QAAM,gBAAgBC,SAA8B,IAAI;AAExD,QAAM,CAAC,YAAY,aAAa,IAAIF,WAAS,KAAK;AAElD,QAAM,eAAeG,eAAc,eAAe,YAAY;AAAA,IAC5D,SAAS,MAAM,cAAc,KAAK;AAAA,EACpC,CAAC;AACD,QAAM,wBAAwBC,YAAW;AACzC,QAAM,aAAaT,cAAY,+BAA+B,6BAAM,EAAE,CAAC;AAEvE,MAAI,YAAW,+BAAO,mBAAkB,CAAC,CAAC,WAAW,UAAU,aAAa,EAAE,SAAS,MAAM,cAAc,GAAG;AAC5G,WAAO,gBAAAU,SAAA,cAAC,wBAAmB;AAAA,EAC7B;AAEA,MAAI,CAAC,MAAM;AACT,WAAO;AAAA,EACT;AAEA,QAAM,QAAQ,kBAAkB;AAAA,IAC9B,UAAU,6BAAM;AAAA,IAChB,SAAS;AAAA,IACT;AAAA,EACF,CAAC;AAED,SACE,gBAAAA,SAAA;AAAA,IAAC,gBAAgB;AAAA,IAAhB;AAAA,MACC,KAAK;AAAA,QACH;AAAA,QACA;AAAA,QACA,GAAG;AAAA,QACH,WAAW;AAAA,MACb;AAAA,MACA,eAAY;AAAA;AAAA,IAEZ,gBAAAA,SAAA;AAAA,MAAC,gBAAgB;AAAA,MAAhB;AAAA,QACC,eAAa;AAAA,QACb,KAAK;AAAA,QACL,KAAK,EAAE,eAAe,UAAU,KAAK,KAAK;AAAA,QAC1C,cAAc,MAAM,kBAAkB,IAAI;AAAA,QAC1C,cAAc,MAAM;AAClB,4BAAkB,KAAK;AAAA,QACzB;AAAA;AAAA,MAEC,mBACC,gBAAAA,SAAA,cAAC,kBAAe,cAAc,yCAAY,IAAI,cAAc,+BAAO,IAAI,QAAQ,QAAQ,SAAkB,IACvG;AAAA,MACH,yBAAyB,iBACxB,gBAAAA,SAAA;AAAA,QAAC,gBAAgB;AAAA,QAAhB;AAAA,UACC,KAAK,EAAE,IAAI,GAAGP,OAAM,OAAO,eAAe,KAAK,KAAK;AAAA,UACpD,SAAS,MAAM,cAAc,CAAC,UAAU;AAAA;AAAA,QAEvC,eAAe,gBAAAO,SAAA,cAACC,aAAA,IAAW,IAAK,gBAAAD,SAAA,cAACE,aAAA,IAAW;AAAA,MAC/C,IACE;AAAA,MACH,CAAC,YAAY,kBAAkB,CAAC,gBAC/B,gBAAAF,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK;AAAA,YACH,UAAU;AAAA,YACV,KAAK;AAAA,YACL,GAAG;AAAA,YACH,GAAG;AAAA,YACH,OAAO,wBAAwB,QAAQ;AAAA,YACvC,QAAQ;AAAA,YACR,IAAI,GAAGP,OAAM,OAAO,eAAe,KAAK;AAAA,UAC1C;AAAA;AAAA,QAEA,gBAAAO,SAAA,cAAC,wBAAmB;AAAA,MACtB;AAAA,MAGD,QACC,gBAAAA,SAAA,cAAC,SAAM,aAAa,MAAM,QAAQ,OAAO,QAAQ,CAAC,aAAa,SAAS,MAAM,IAAI,KAAK,EAAE,WAAW,EAAE,GAAG,IACvG;AAAA,MACJ,gBAAAA,SAAA,cAAC,gBAAgB,MAAhB,EAAqB,KAAK,eAAc,KAAM;AAAA,MAC9C,kBAAkB,CAAC,KAAK,UACvB,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,eAAa;AAAA,UACb,QAAQ,KAAK;AAAA,UACb,cAAc,yCAAY;AAAA,UAC1B,cAAc,+BAAO;AAAA,UACrB,wBAAwB;AAAA;AAAA,MAC1B,IACE;AAAA,IACN;AAAA,EACF;AAEJ;AAEA,IAAM,kBAAkBA,SAAM,KAAKX,KAAI;AAEvC,IAAO,0BAAQ;;;ADrHR,IAAM,oBAAoB,CAAC,EAAE,OAAO,cAAc,YAAY,WAAW,MAAmB;AAhBnG,MAAAc;AAiBE,QAAM,eAAeC,cAAY,wBAAwB;AACzD,QAAM,CAAC,EAAE,wBAAwB,IAAI,mBAAmB,SAAS,uBAAuB;AACxF,QAAM,CAAC,MAAM,OAAO,IAAIC,WAAS,CAAC;AAClC,QAAM,CAAC,YAAY,aAAa,IAAI,iBAAiB,YAAY,UAAU;AAC3E,QAAM,kBAAkB,aAAa,IAAI;AACzC,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,aAAa,CAAC,YAAY,eAAe,WAAW;AAC1D,QAAM,iBAAiBC,UAAQ,MAAM;AACnC,QAAI,eAAe,WAAW,WAAW;AACvC,aAAO,CAAC;AAAA,IACV;AACA,QAAI,YAAY,eAAe,WAAW,SAAS;AACjD,aAAO,kBACH,CAAC,iBAAiB,GAAG,MAAM,OAAO,OAAK,EAAE,QAAO,mDAAiB,GAAE,CAAC,IACpE;AAAA,IACN;AACA,WAAO,MAAM,OAAO,OAAK,EAAE,QAAO,mDAAiB,GAAE;AAAA,EACvD,GAAG,CAAC,iBAAiB,OAAO,UAAU,UAAU,CAAC;AAEjD,EAAAC,YAAU,MAAM;AACd,QAAI,UAAU;AACZ,oBAAc,WAAW,OAAO;AAChC;AAAA,IACF;AACA,QAAI,eAAe,WAAW,SAAS;AACrC;AAAA,IACF;AACA,kBAAc,WAAW,OAAO;AAChC,WAAO,MAAM;AAEX,oBAAc,WAAW,OAAO;AAAA,IAClC;AAAA,EACF,GAAG,CAAC,QAAQ,CAAC;AACb,EAAAA,YAAU,MAAM;AACd,6BAAyB,mDAAiB,EAAE;AAC5C,WAAO,MAAM;AACX,+BAAyB,EAAE;AAAA,IAC7B;AAAA,EACF,GAAG,CAAC,mDAAiB,IAAI,wBAAwB,CAAC;AAElD,SACE,gBAAAC,SAAA,cAAC,iBAAiB,MAAjB,EAAsB,YAAwB,cAC7C,gBAAAA,SAAA,cAAC,iBAAiB,kBAAjB,MACC,gBAAAA,SAAA,cAAC,2BAAgB,SAAQN,MAAA,aAAa,IAAI,MAAjB,gBAAAA,IAAoB,IAAI,GAChD,CAAC,cAAc,gBAAAM,SAAA,cAAC,cAAW,MAAY,cAAc,SAAS,UAAU,aAAa,QAAQ,CAChG,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO;AAAA,MACP;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA;AAAA,EACF,GACC,eAAe,WAAW,aAAa,mBAAmB,gBAAAA,SAAA,cAAC,aAAU,QAAQ,mDAAiB,IAAI,CACrG;AAEJ;;;AIzEA;AAAA,OAAOC,YAAS,aAAAC,aAAW,WAAAC,iBAAe;AAC1C,SAAS,YAAAC,kBAAgB;AACzB,SAAS,kBAAkB;AAC3B,SAAS,uBAAuB,kBAAkB,eAAAC,eAAa,iBAAAC,sBAAqB;AAcpF,IAAM,kBAAkB,MAAM;AAC5B,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,EAAE,OAAO,UAAU,cAAc,IAAIC,eAAc,QAAQ;AAEjE,MAAI,CAAC,OAAO;AACV,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,OAAO;AAAA,UACL,MAAM;AAAA,UACN,SAAS;AAAA,UACT,YAAY;AAAA,QACd;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,MAAM,OAAO,KACvB,gBAAAA,SAAA,cAAC,cAAW,OAAc,UAAU,WAAW,QAAQ,IAAI,eAA8B,CAC3F;AAAA,EACF;AAEJ;AAEO,IAAM,mBAAmB,CAAC,EAAE,OAAO,cAAc,YAAY,WAAW,MAAmB;AAChG,QAAM,aAAaC,cAAY,gBAAgB;AAC/C,QAAM,kBAAkBA,cAAY,sBAAsB,UAAQ,KAAK,oBAAmB,yCAAY,MAAK,CAAC;AAC5G,QAAM,CAAC,YAAY,aAAa,IAAI,iBAAiB,YAAY,UAAU;AAC3E,QAAM,WAAWH,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,aAAa,CAAC,YAAY,eAAe,WAAW;AAC1D,QAAM,iBAAiBI,UAAQ,MAAM;AACnC,QAAI,eAAe,WAAW,WAAW;AACvC,aAAO,CAAC;AAAA,IACV;AACA,QAAI,YAAY,eAAe,WAAW,SAAS;AACjD,aAAO,kBACH,CAAC,iBAAiB,GAAG,MAAM,OAAO,OAAK,EAAE,QAAO,mDAAiB,GAAE,CAAC,IACpE;AAAA,IACN;AACA,WAAO,MAAM,OAAO,OAAK,EAAE,QAAO,mDAAiB,GAAE;AAAA,EACvD,GAAG,CAAC,iBAAiB,OAAO,UAAU,UAAU,CAAC;AAEjD,EAAAC,YAAU,MAAM;AACd,QAAI,UAAU;AACZ,oBAAc,WAAW,OAAO;AAChC;AAAA,IACF;AACA,QAAI,eAAe,WAAW,SAAS;AACrC;AAAA,IACF;AACA,kBAAc,WAAW,OAAO;AAChC,WAAO,MAAM;AAEX,oBAAc,WAAW,OAAO;AAAA,IAClC;AAAA,EACF,GAAG,CAAC,QAAQ,CAAC;AAEb,SACE,gBAAAH,SAAA,cAAC,iBAAiB,MAAjB,EAAsB,YAAwB,cAC7C,gBAAAA,SAAA,cAAC,iBAAiB,kBAAjB,MACC,gBAAAA,SAAA,cAAC,qBAAgB,CACnB,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO;AAAA,MACP;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA;AAAA,EACF,GACC,eAAe,WAAW,aAAa,mBAAmB,gBAAAA,SAAA,cAAC,aAAU,QAAQ,mDAAiB,IAAI,CACrG;AAEJ;;;AC5FA;AAAA,SAA6C,yBAAAI,8BAA6B;AAE1E,IAAM,cAAN,MAAkB;AAAA,EAShB,YAAY,OAA4B;AARxC,4BAA6C;AAgB7C,mCAA0B,CAAC,EAAE,OAAO,aAAa,MAAkD;AACjG,WAAK,UAAU;AACf,WAAK,eAAe;AACpB,YAAM,UAAU,IAAI,IAAI,MAAM,IAAI,UAAQ,KAAK,EAAE,CAAC;AAElD,WAAK,MAAM,QAAQ,CAAC,GAAG,QAAQ;AAC7B,YAAI,CAAC,QAAQ,IAAI,GAAG,GAAG;AACrB,eAAK,MAAM,OAAO,GAAG;AAAA,QACvB;AAAA,MACF,CAAC;AACD,WAAK,WAAW,IAAI,IAAI,CAAC,GAAG,KAAK,QAAQ,EAAE,OAAO,YAAU,QAAQ,IAAI,MAAM,CAAC,CAAC;AAChF,YAAM,QAAQ,UAAQ;AACpB,aAAK,MAAM,IAAI,KAAK,IAAI,IAAI;AAC5B,YAAI,KAAK,SAAS,OAAO,cAAc;AACrC,eAAK,SAAS,IAAI,KAAK,EAAE;AAAA,QAC3B;AAAA,MACF,CAAC;AACD,UAAI,CAAC,KAAK,kBAAkB;AAC1B,aAAK,mBAAmB,KAAK,MAAM,UAAU,KAAK,yBAAyBA,sBAAqB;AAAA,MAClG;AACA,WAAK,mBAAmB,KAAK,OAAO;AAAA,IACtC;AAEA,oBAAW,CAAC,OAAmC;AAC7C,WAAK,UAAU,IAAI,EAAE;AAAA,IACvB;AAEA,gBAAO,MAAM;AA9Cf,UAAAC;AA+CI,WAAK,gBAAgB;AACrB,WAAK,UAAU,MAAM;AACrB,OAAAA,MAAA,KAAK,qBAAL,gBAAAA,IAAA;AACA,WAAK,mBAAmB;AACxB,WAAK,UAAU;AAAA,IACjB;AAEA,8BAAqB,CAAC,YAAsB;AAC1C,UAAI,CAAC,SAAS;AACZ,aAAK,gBAAgB,KAAK,YAAY;AACtC,aAAK,gBAAgB;AACrB;AAAA,MACF;AACA,UAAI,KAAK,SAAS,IAAI,QAAQ,EAAE,KAAK,KAAK,SAAS,QAAQ,KAAK,cAAc;AAC5E,aAAK,gBAAgB;AACrB;AAAA,MACF;AAEA,WAAK,SAAS,OAAO,QAAQ,EAAE;AAE/B,WAAK,gBAAgB,KAAK,eAAe,CAAC;AAC1C,WAAK,WAAW,oBAAI,IAAI,CAAC,QAAQ,IAAI,GAAG,KAAK,QAAQ,CAAC;AACtD,WAAK,gBAAgB;AAAA,IACvB;AAEA,mCAA0B,CAAC,YAA4B;AAxEzD,UAAAA;AA0EI,UAAI,CAAC,WAAW,QAAQ,SAAOA,MAAA,KAAK,YAAL,gBAAAA,IAAc,KAAI;AAC/C;AAAA,MACF;AAEA,UAAI,CAAC,KAAK,MAAM,IAAI,QAAQ,EAAE,GAAG;AAC/B;AAAA,MACF;AACA,WAAK,UAAU;AACf,WAAK,mBAAmB,OAAO;AAAA,IACjC;AAEA,2BAAkB,MAAM;AACtB,YAAM,eAA0B,CAAC;AACjC,WAAK,SAAS,QAAQ,SAAO;AAC3B,cAAM,OAAO,KAAK,MAAM,IAAI,GAAG;AAC/B,YAAI,MAAM;AACR,uBAAa,KAAK,IAAI;AAAA,QACxB;AAAA,MACF,CAAC;AACD,WAAK,MAAM,QAAQ,UAAQ;AACzB,YAAI,CAAC,KAAK,SAAS,IAAI,KAAK,EAAE,KAAK,MAAM;AACvC,uBAAa,KAAK,IAAI;AAAA,QACxB;AAAA,MACF,CAAC;AACD,WAAK,UAAU,QAAQ,cAAY,qCAAW,aAAa;AAAA,IAC7D;AAEA,SAAQ,kBAAkB,CAAC,SAAiB;AAC1C,YAAM,eAAe,MAAM,KAAK,KAAK,QAAQ;AAC7C,aAAO,aAAa,SAAS,QAAQ,aAAa,QAAQ;AACxD,qBAAa,IAAI;AAAA,MACnB;AACA,WAAK,WAAW,IAAI,IAAI,YAAY;AAAA,IACtC;AA/FE,SAAK,QAAQ;AACb,SAAK,QAAQ,oBAAI,IAAI;AACrB,SAAK,WAAW,oBAAI,IAAI;AACxB,SAAK,UAAU;AACf,SAAK,YAAY,oBAAI,IAAI;AAAA,EAC3B;AA2FF;AAEA,IAAO,sBAAQ;;;AjB7ER,IAAM,aAAa,CAAC;AAAA,EACzB,yBAAyB,iBAAiB;AAAA,EAC1C,iBAAiB,iBAAiB,CAAC;AAAA,EACnC,2BAA2B;AAAA,EAC3B,gCAAgC;AAAA,EAChC,qBAAqB;AAAA,EACrB,0BAA0B;AAAA,EAC1B,mBAAmB;AAAA,EACnB,eAAe;AAAA,EACf,wBAAwB;AAC1B,MAAuB;AACrB,QAAM,cAAcC,cAAYC,wBAAuB;AACvD,QAAM,aAAaD,cAAYE,iBAAgB;AAC/C,QAAM,cAAc,eAAe;AACnC,QAAM,QAAQF,cAAYG,YAAW;AACrC,QAAM,gBAAgBH,cAAYI,wBAAuB;AACzD,QAAM,cAAcJ,cAAYK,mBAAiB;AAEjD,QAAM,CAAC,uBAAuB,IAAI,mBAAmB,SAAS,uBAAuB;AACrF,QAAM,mBACH,eAAe,UACd,MAAM;AAAA,IACJ,UAAQ,KAAK,YAAY,eAAe,SAAS,KAAK,QAAQ,MAAM,KAAK,cAAc,KAAK;AAAA,EAC9F,KACF;AACF,QAAM,eAAeC,UAAQ,MAAM;AAEjC,QAAI,4BAA2B,yCAAY,OAAM;AAC/C,aAAO,MAAM,OAAO,UAAQ,KAAK,OAAO,2BAA2B,KAAK,oBAAmB,yCAAY,MAAK;AAAA,IAC9G;AACA,QAAI,gBAAgB;AAClB,YAAM,oBAAoB,iBAAgB,2CAAa;AAEvD,UAAK,iBAAiB,eAAe,SAAS,aAAa,KAAM,mBAAmB;AAClF,eAAO;AAAA,MACT,OAAO;AACL,eAAO,MAAM,OAAO,UAAQ,CAAC,KAAK,OAAO;AAAA,MAC3C;AAAA,IACF;AACA,WAAO;AAAA,EACT,GAAG;AAAA,IACD;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AACD,QAAM,eAAeC,qBAAmB;AACxC,QAAM,CAAC,aAAa,cAAc,IAAIC,WAAS,YAAY;AAC3D,QAAM,cAAcF,UAAQ,MAAM,IAAI,oBAAY,YAAY,GAAG,CAAC,YAAY,CAAC;AAC/E,QAAM,CAAC,UAAU,WAAW,IAAIE,WAAS,CAAC;AAC1C,QAAM,CAAC,UAAU,WAAW,IAAIA,WAAS,CAAC;AAC1C,QAAM,aAAa;AAAA,IACjB,wBAAwB;AAAA,IACxB,2BAA2B;AAAA,IAC3B,kBAAkB;AAAA,IAClB,qBAAqB;AAAA,IACrB,oBAAoB;AAAA,IACpB,WAAW;AAAA,EACb;AAEA,EAAAC,YAAU,MAAM;AACd,QAAI,aAAa,GAAG;AAClB;AAAA,IACF;AACA,gBAAY,wBAAwB;AAAA,MAClC,OAAO;AAAA,MACP,cAAc;AAAA,IAChB,CAAC;AACD,gBAAY,SAAS,cAAc;AAAA,EACrC,GAAG,CAAC,UAAU,aAAa,cAAc,QAAQ,CAAC;AAElD,MAAI,aAAa;AACf,WACE,gBAAAC,SAAA,cAAC,iBAAiB,UAAjB,EAA0B,OAAO,cAChC,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAO;AAAA,QACP,YAAY;AAAA,QACZ,cAAc;AAAA,QACd,YAAY;AAAA;AAAA,IACd,CACF;AAAA,EAEJ,WAAW,yCAAY,MAAM;AAC3B,WACE,gBAAAA,SAAA,cAAC,iBAAiB,UAAjB,EAA0B,OAAO,cAChC,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAO;AAAA,QACP,YAAY;AAAA,QACZ,cAAc;AAAA,QACd,YAAY;AAAA;AAAA,IACd,CACF;AAAA,EAEJ,WAAW,kBAAkB;AAC3B,WACE,gBAAAA,SAAA,cAAC,iBAAiB,UAAjB,EAA0B,OAAO,cAChC,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAO;AAAA,QACP,YAAY;AAAA,QACZ,cAAc;AAAA,QACd;AAAA,QACA;AAAA,QACA,YAAY;AAAA;AAAA,IACd,CACF;AAAA,EAEJ;AACA,SACE,gBAAAA,SAAA,cAAC,iBAAiB,UAAjB,EAA0B,OAAO,cAChC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO;AAAA,MACP,YAAY;AAAA,MACZ,cAAc;AAAA,MACd;AAAA,MACA,YAAY;AAAA;AAAA,EACd,CACF;AAEJ;;;AkB3JA;AAAA,OAAOC,YAAS,aAAAC,aAAW,WAAAC,iBAAe;AAC1C,SAAS,iBAAAC,iBAAe,eAAAC,cAAa,2BAAAC,0BAAyB,eAAe,eAAAC,qBAAmB;AAQzF,IAAM,YAAY,MAAM;AAC7B,SACE,gBAAAC,SAAA,cAAC,4BACC,gBAAAA,SAAA,cAAC,oBAAe,CAClB;AAEJ;AAEO,IAAM,uBAAuB,CAAC,EAAE,SAAS,MAAM;AACpD,QAAM,QAAQC,cAAYC,YAAW;AAErC,QAAM,iBAAiBD,cAAYE,wBAAuB;AAC1D,QAAM,CAAC,EAAE,wBAAwB,IAAI,mBAAmB,SAAS,uBAAuB;AAExF,QAAM,iBAAiBC,UAAQ,MAAM;AACnC,UAAMC,kBAAiB,MAAM,OAAO,UAAQ,KAAK,QAAO,iDAAgB,GAAE;AAC1E,WAAOA;AAAA,EACT,GAAG,CAAC,OAAO,cAAc,CAAC;AAE1B,EAAAC,YAAU,MAAM;AACd,6BAAyB,iDAAgB,EAAE;AAC3C,WAAO,MAAM;AACX,+BAAyB,EAAE;AAAA,IAC7B;AAAA,EACF,GAAG,CAAC,iDAAgB,IAAI,wBAAwB,CAAC;AACjD,SACE,gBAAAN,SAAA,cAAC,iBAAiB,MAAjB,MACC,gBAAAA,SAAA,cAAC,iBAAiB,kBAAjB,MAAmC,QAAS,GAC7C,gBAAAA,SAAA,cAAC,kBAAe,OAAO,gBAAgB,CACzC;AAEJ;AAIA,IAAM,iBAAiB,MAAM;AAC3B,QAAM,cAAcC,cAAYM,gBAAc,SAAS,WAAW,CAAC;AACnE,QAAM,cAAc,oBAAoB;AAGxC,QAAM,EAAE,WAAW,iBAAiB,uBAAuB,IAAI,cAAc,WAAW;AAExF,EAAAD,YAAU,MAAM;AACd,KAAC,MAAY;AACX,UAAI,eAAe,CAAC,wBAAwB;AAC1C,YAAI;AACF,gBAAM,gBAAgB,WAAW;AAAA,QACnC,SAAS,KAAK;AACZ,sBAAY;AACZ,uBAAa,SAAS;AAAA,YACpB,OAAO,iCAAiC,IAAI,WAAW,EAAE;AAAA,YACzD,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF,IAAG;AAAA,EACL,GAAG,CAAC,wBAAwB,aAAa,iBAAiB,WAAW,CAAC;AAEtE,SACE,gBAAAN,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,OAAO;AAAA,UACL,MAAM;AAAA,UACN,SAAS;AAAA,UACT,YAAY;AAAA,QACd;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,KAAK;AAAA,QACL,OAAO;AAAA,UACL,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,QAChB;AAAA,QACA,OAAM;AAAA,QACN,gBAAe;AAAA;AAAA,IACjB;AAAA,EACF;AAEJ;;;AC7FA;AAAA,OAAOQ,YAAS,aAAAC,mBAAiB;AACjC,SAAS,mBAAmB;AASrB,IAAM,UAAU,MAAM;AAC3B,QAAM,YAAY,aAAa;AAC/B,QAAM,cAAc,kBAAkB;AAEtC,QAAM,EAAE,WAAW,eAAe,qBAAqB,IAAI,YAAY,WAAW;AAElF,EAAAC,YAAU,MAAM;AAEd,WAAO,MAAM;AACX,kBAAY;AAAA,IACd;AAAA,EACF,GAAG,CAAC,CAAC;AACL,EAAAA,YAAU,MAAM;AACd,KAAC,MAAY;AACX,UAAI;AACF,YAAI,CAAC,wBAAwB,WAAW;AACtC,gBAAM,cAAc,SAAS;AAAA,QAC/B;AAAA,MACF,SAAS,KAAK;AACZ,oBAAY;AACZ,qBAAa,SAAS;AAAA,UACpB,OAAO,iCAAiC,IAAI,WAAW,EAAE;AAAA,UACzD,SAAS;AAAA,QACX,CAAC;AAAA,MACH;AAAA,IACF,IAAG;AAAA,EACL,GAAG,CAAC,sBAAsB,WAAW,aAAa,aAAa,CAAC;AAChE,SACE,gBAAAC,SAAA,cAAC,4BACC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,OAAO;AAAA,UACL,MAAM;AAAA,UACN,SAAS;AAAA,UACT,YAAY;AAAA,QACd;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,KAAK;AAAA,QACL,OAAO;AAAA,UACL,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,QAChB;AAAA,QACA,OAAM;AAAA,QACN,gBAAe;AAAA;AAAA,IACjB;AAAA,EACF,CACF;AAEJ;;;ACjEA;AAAA,OAAOC,YAAS,aAAAC,aAAW,UAAAC,UAAQ,YAAAC,kBAAgB;AACnD,OAAOC,gBAAoC;AAC3C,SAAS,YAAAC,kBAAgB;AACzB;AAAA,EAEE,gCAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,eAAAC;AAAA,EACA;AAAA,OACK;AAiBP,IAAM,cAAN,MAAkB;AAAA,EAEhB,YAAoB,WAAmB,GAAW,mBAA2B,KAAM;AAA/D;AAA8B;AADlD,SAAQ,UAA4B,CAAC;AAAA,EAC+C;AAAA,EACpF,QAAQC,OAA4B;AA7BtC,QAAAC;AA8BI,QAAI,CAACD,MAAK,WAAW,KAAK,GAAG;AAC3B;AAAA,IACF;AACA,QAAI,KAAK,KAAK,MAAM,KAAK,YAAY,KAAK,QAAQ,KAAK,KAAK,IAAI,CAAC,EAAE,OAAO;AACxE,WAAK,QAAQ,KAAK,QAAQ,KAAK,KAAK,IAAI,CAAC,CAAC;AAAA,IAC5C;AACA,QAAI,KAAK,KAAK,MAAM,GAAG;AACrB,WAAK,QAAQ,KAAKA,KAAI;AACtB,WAAK,WAAW,KAAK,QAAQ,KAAK,KAAK,IAAI,CAAC,GAAGA,MAAK,KAAK;AACzD;AAAA,IACF;AACA,QAAI,KAAK,KAAK,IAAI,OAAKC,MAAA,KAAK,QAAQ,KAAK,KAAK,IAAI,CAAC,MAA5B,gBAAAA,IAA+B,WAAU,MAAM;AACpE,WAAK,QAAQ,KAAKD,KAAI;AACtB,WAAK,WAAW,KAAK,QAAQ,KAAK,KAAK,IAAI,CAAC,GAAGA,MAAK,KAAK;AACzD;AAAA,IACF;AACA,SAAK,QAAQ,KAAK,KAAK,IAAI,CAAC,EAAE,aAAaA,MAAK;AAChD,SAAK,QAAQ,KAAK,KAAK,IAAI,CAAC,EAAE,QAAQA,MAAK;AAC3C,SAAK,QAAQ,KAAK,KAAK,IAAI,CAAC,EAAE,MAAMA,MAAK;AACzC,SAAK,WAAW,KAAK,QAAQ,KAAK,KAAK,IAAI,CAAC,GAAGA,MAAK,KAAK;AAAA,EAC3D;AAAA,EACA,WAAW,MAAsB,SAAkB;AACjD,QAAI,CAAC,SAAS;AACZ;AAAA,IACF;AACA,SAAK,UAAU,WAAW,MAAM;AAC9B,WAAK,QAAQ,IAAI;AAAA,IACnB,GAAG,KAAK,gBAAgB;AAAA,EAC1B;AAAA,EACA,QAAQ,MAAkD;AACxD,UAAM,QAAQ,KAAK,QAAQ,QAAQ,IAAI;AACvC,QAAI,UAAU,IAAI;AAChB,aAAO;AAAA,IACT;AACA,UAAM,cAAc,KAAK,QAAQ,OAAO,OAAO,CAAC;AAChD,QAAI,YAAY,UAAU,GAAG;AAC3B,aAAO;AAAA,IACT;AACA,SAAK,aAAa,YAAY,CAAC,CAAC;AAChC,WAAO;AAAA,EACT;AAAA,EACA,aAAa,MAAsB;AACjC,QAAI,CAAC,KAAK,SAAS;AACjB;AAAA,IACF;AACA,iBAAa,KAAK,OAAO;AAAA,EAC3B;AAAA,EACA,OAAmC;AACjC,QAAI,KAAK,KAAK,KAAK,GAAG;AACpB,aAAO;AAAA,IACT;AACA,WAAO,KAAK,QAAQ,CAAC;AAAA,EACvB;AAAA,EACA,mBAA2B;AACzB,QAAI,SAAS;AACb,SAAK,QAAQ,QAAQ,CAAC,UAA2B,UAAU,MAAM,aAAa,GAAI;AAClF,WAAO;AAAA,EACT;AAAA,EACA,QAAQ;AACN,SAAK,QAAQ,SAAS;AAAA,EACxB;AAAA,EACA,OAAe;AACb,WAAO,KAAK,QAAQ;AAAA,EACtB;AACF;AACA,IAAM,QAAN,MAAY;AAAA,EAEV,YAAoB,WAAmB,GAAG;AAAtB;AADpB,SAAQ,UAA4C,CAAC;AAAA,EACV;AAAA,EAE3C,QAAQA,OAA2B;AACjC,QAAI,KAAK,KAAK,MAAM,KAAK,UAAU;AACjC,WAAK,QAAQ;AAAA,IACf;AACA,QAAI,CAAC,KAAK,QAAQA,MAAK,OAAO,GAAG;AAC/B,WAAK,QAAQA,MAAK,OAAO,IAAI;AAAA,QAC3B,SAASA,MAAK;AAAA,QACd,YAAYA,MAAK;AAAA,QACjB,OAAOA,MAAK;AAAA,QACZ,iBAAiB,IAAI,YAAY;AAAA,QACjC,OAAOA,MAAK;AAAA,QACZ,KAAKA,MAAK;AAAA,MACZ;AACA,WAAK,QAAQA,MAAK,OAAO,EAAE,gBAAgB,QAAQA,KAAsB;AACzE;AAAA,IACF;AACA,SAAK,QAAQA,MAAK,OAAO,EAAE,gBAAgB,QAAQA,KAAsB;AAAA,EAC3E;AAAA,EACA,UAA4B;AAC1B,UAAM,MAAc,OAAO,KAAK,KAAK,OAAO,EAAE,MAAM,KAAK;AACzD,UAAM,cAAc,KAAK,QAAQ,GAAG;AACpC,gBAAY,gBAAgB,MAAM;AAClC,WAAO,KAAK,QAAQ,GAAG;AACvB,WAAO;AAAA,EACT;AAAA,EAEA,OAAqC;AACnC,QAAI,KAAK,KAAK,KAAK;AAAG,aAAO;AAC7B,UAAM,MAAc,OAAO,KAAK,KAAK,OAAO,EAAE,MAAM,KAAK;AACzD,WAAO,KAAK,QAAQ,GAAG;AAAA,EACzB;AAAA,EAEA,eAA4C;AAC1C,UAAM,OAAO,OAAO,KAAK,KAAK,OAAO;AACrC,UAAMA,QAAO,KAAK,IAAI,CAAC,QAAgB;AACrC,YAAMA,QAAO,KAAK,QAAQ,GAAG;AAC7B,YAAM,OAAOA,MAAK,gBAAgB,iBAAiB;AACnD,aAAO,EAAE,CAAC,GAAG,GAAG,KAAK;AAAA,IACvB,CAAC;AACD,WAAOA;AAAA,EACT;AAAA,EACA,OAAe;AACb,WAAO,OAAO,KAAK,KAAK,OAAO,EAAE;AAAA,EACnC;AACF;AAEA,IAAM,yBAAN,MAA6B;AAAA,EAE3B,cAAc;AACZ,SAAK,cAAc,IAAI,MAAM;AAAA,EAC/B;AAAA,EACA,KAAKA,QAAwB,CAAC,GAAG;AAC/B,IAAAA,MAAK,QAAQ,CAAC,UAAyB;AACrC,WAAK,YAAY,QAAQ,KAAK;AAAA,IAChC,CAAC;AAAA,EACH;AACF;AACA,IAAM,iBAAiB,CAAC,EAAE,SAAS,MAAAA,MAAK,MAAyC;AAC/E,QAAM,WAAWE,cAAYC,oBAAmB,OAAO,CAAC,KAAK;AAC7D,EAAAH,QAAOA,MAAK,KAAK;AACjB,MAAI,CAACA;AAAM,WAAO;AAClB,SACE,gBAAAI,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,YAAY;AAAA,MACd;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,WAAG,UAAS,IAAE;AAAA,IACdJ;AAAA,EACH;AAEJ;AAEO,IAAM,iBAAiB,CAAC;AAAA,EAC7B;AAAA,EACA;AACF,MAGM;AAnLN,MAAAC;AAoLE,QAAM,EAAE,UAAU,WAAW,IAAI,gCAAgC;AACjE,QAAM,WAAWI,WAAS,OAAO,MAAM,EAAE;AACzC,QAAM,aAAa,sBAAsB,kBAAkB,IAAI;AAE/D,QAAM,qBAAmBJ,MAAA,qCAAU,SAAV,gBAAAA,IAAgB,eAAc,cAAc;AAErE,QAAM,CAAC,YAAY,IAAIK,WAAiC,IAAI,uBAAuB,CAAC;AACpF,QAAM,CAAC,aAAa,cAAc,IAAIA,WAAsC,CAAC,CAAC;AAE9E,QAAM,mBAAmB,oBAAoB;AAE7C,QAAM,yBAAyBJ,cAAYK,6BAA4B;AAEvE,QAAM,UAAUC,SAAuB,IAAI;AAE3C,EAAAC,YAAU,MAAM;AACd,UAAM,eAAe,YAAY,MAAM;AApM3C,UAAAR;AAqMM,UAAI,CAAC,cAAc;AACjB;AAAA,MACF;AACA,YAAMD,SAAOC,MAAA,aAAa,gBAAb,gBAAAA,IAA0B;AACvC,qBAAeD,KAAI;AAAA,IACrB,GAAG,GAAI;AACP,WAAO,MAAM,cAAc,YAAY;AAAA,EACzC,GAAG,CAAC,YAAY,CAAC;AAEjB,gBAAc;AAAA,IACZ,cAAc,CAACA,UAA0B;AACvC,sBAAgB,aAAa,KAAKA,KAAuB;AAAA,IAC3D;AAAA,EACF,CAAC;AACD,QAAM,aAAa,YAAY,OAAO,CAACA,UAAoC;AACzE,UAAM,MAAM,OAAO,KAAKA,KAAI,EAAE,CAAC;AAC/B,QAAIA,MAAK,GAAG,GAAG;AACb,aAAO;AAAA,IACT;AACA,WAAO;AAAA,EACT,CAAC;AACD,MAAI,WAAW,UAAU,KAAK,eAAe,wBAAwB,CAAC,oBAAoB,CAAC,wBAAwB;AACjH,WAAO;AAAA,EACT;AACA,SACE,gBAAAI,SAAA;AAAA,IAACM;AAAA,IAAA;AAAA,MACC,QAAO;AAAA,MACP;AAAA,MACA;AAAA,MACA,QAAQ,CAAC,GAAGV,UAAS;AACnB,2BAAmB,EAAE,GAAGA,MAAK,OAAO,GAAGA,MAAK,MAAM,CAAC;AAAA,MACrD;AAAA;AAAA,IAEA,gBAAAI,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,QACL,KAAK;AAAA,UACH,UAAU;AAAA,UACV,GAAG,WAAW,SAAS;AAAA,UACvB,QAAQ,mBAAmB,KAAK;AAAA,UAChC,KAAK,mBAAmB,MAAM;AAAA,UAC9B,MAAM,WAAW,IAAI;AAAA,UACrB,WAAW,WAAW,KAAK;AAAA,UAC3B,YAAY;AAAA,UACZ,UAAU;AAAA,UACV,QAAQ;AAAA,UACR,QAAQ;AAAA,UACR,GAAG;AAAA,UACH,GAAG;AAAA,UACH,YAAY;AAAA,UACZ,WAAW,EAAE,SAAS,OAAO;AAAA,QAC/B;AAAA;AAAA,MAEA,gBAAAA,SAAA,cAAC,QAAK,WAAU,YACb,WAAW,IAAI,CAACJ,OAAiC,UAAkB;AAClE,cAAM,MAAM,OAAO,KAAKA,KAAI,EAAE,CAAC;AAC/B,eAAO,gBAAAI,SAAA,cAAC,kBAAe,KAAK,OAAO,SAAS,KAAK,MAAMJ,MAAK,GAAG,GAAG;AAAA,MACpE,CAAC,CACH;AAAA,IACF;AAAA,EACF;AAEJ;;;AClQA;AAAA,SAAS,aAAAW,mBAAiB;AAC1B,SAAS,2BAAAC,0BAAyB,eAAAC,eAAa,iBAAAC,sBAAqB;AAK7D,IAAM,gCAAgC,MAAM;AACjD,QAAM,cAAcD,cAAYD,wBAAuB;AACvD,QAAM,EAAE,SAAS,mBAAmB,QAAQ,iBAAiB,IAAIE,eAAc;AAG/E,EAAAH,YAAU,MAAM;AACd,QAAI,qBAAqB,aAAa;AACpC;AAAA,IACF;AAAA,EACF,GAAG,CAAC,mBAAmB,kBAAkB,WAAW,CAAC;AACvD;;;AtBmBA,IAAM,UAAUI,SAAM,KAAK,MAAM,OAAO,uBAAW,CAAC;AAE7C,IAAM,wBAAwB,CAAC;AAAA,EACpC;AAAA,EACA;AAAA,EACA,eAAe;AACjB,MAIM;AA7CN,MAAAC;AA8CE,QAAM,oBAAoBC,cAAYC,wBAAuB;AAC7D,QAAM,cAAcD,cAAYE,wBAAuB;AACvD,QAAM,kBAAkBF,cAAYG,0BAAyB;AAE7D,QAAM,aAAaC,gBAAc;AACjC,QAAM,cAAc,cAAc;AAClC,QAAM,qBAAqB,aAAa;AACxC,QAAM,oBAAoB,mBAAmB;AAC7C,QAAM,uBAAuB,sBAAsB;AACnD,QAAM,WAAWC,WAAS,OAAO,MAAM,EAAE;AACzC,QAAM,CAAC,iBAAiB,kBAAkB,IAAIC,WAA0B,EAAE,GAAG,WAAW,IAAI,MAAM,GAAG,EAAE,CAAC;AACxG,gCAA8B;AAE9B,QAAM,EAAE,uBAAuB,2BAA2B,4BAA4B,IAAI,mBAAmB;AAE7G,EAAAC,YAAU,MAAM;AACd,QAAI,CAAC,aAAa;AAChB;AAAA,IACF;AACA,eAAW,aAAa,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAMhC,CAAC;AAAA,EAEH,GAAG,CAAC,aAAa,UAAU,CAAC;AAE5B,MAAI,CAAC,mBAAmB;AAEtB,WAAO;AAAA,EACT;AAEA,SACE,gBAAAT,SAAA,cAAC,YAAS,UAAU,gBAAAA,SAAA,cAAC,8BAAiB,KACpC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,MAAM;AAAA,QACN,UAAU;AAAA,QACV,KAAK,qBAAqB,uBAAuB,MAAM;AAAA,MACzD;AAAA,MACA,WAAWU,QAAiD,EAAE,sBAAsB,kBAAkB,CAAC,EACpG,KAAK,EAAE,sBAAsB,KAAK,GAAG,MAAM,KAAK,EAChD,KAAK,EAAE,mBAAmB,KAAK,GAAG,MAAM,QAAQ,EAChD,UAAU,MAAM,KAAK;AAAA;AAAA,IAEvBA,QAAM;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF,CAAC,EACE;AAAA,MACC;AAAA,QACE,YAAY;AAAA,MACd;AAAA,MACA,MAAM,gBAAAV,SAAA,cAAC,aAAQ;AAAA,IACjB,EACC;AAAA,MACC,CAAC,EAAE,uBAAAW,wBAAuB,6BAAAC,6BAA4B,MACpDD,0BAAyB,CAACC;AAAA,MAC5B,MACE,gBAAAZ,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAM;AAAA,UACN,UAAS;AAAA,UACT,MAAM,gBAAAA,SAAA,cAACa,gBAAA,EAAc,OAAM,QAAO,QAAO,QAAO,OAAO,EAAE,OAAO,QAAQ,GAAG;AAAA;AAAA,MAC7E;AAAA,IAEJ,EACC;AAAA,MACC,CAAC,EAAE,2BAAAC,4BAA2B,iBAAAC,kBAAiB,6BAAAH,6BAA4B,MACzEE,8BAA6B,CAACC,oBAAmB,CAACH;AAAA,MACpD,MACE,gBAAAZ,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAM;AAAA,UACN,UAAS;AAAA,UACT,MAAM,gBAAAA,SAAA,cAACgB,kBAAA,EAAgB,OAAM,QAAO,QAAO,QAAO,OAAO,EAAE,OAAO,QAAQ,GAAG;AAAA;AAAA,MAC/E;AAAA,IAEJ,EACC;AAAA,MACC,CAAC,EAAE,oBAAAC,oBAAmB,MAAM,CAAC,CAACA;AAAA,MAC9B,MAAM,gBAAAjB,SAAA,cAAC,aAAQ;AAAA,IACjB,EACC;AAAA,MACC,CAAC,EAAE,aAAAkB,aAAY,MAAM,CAAC,CAACA;AAAA,MACvB,MAAM,gBAAAlB,SAAA,cAAC,eAAU;AAAA,IACnB,EAEC,UAAU,MAAM;AA3I3B,UAAAC;AA6IY,aAAO,gBAAAD,SAAA,cAAC,gCAAgBC,MAAA,qCAAiD,sBAAjD,gBAAAA,IAAoE,KAAM;AAAA,IACpG,CAAC;AAAA,IACH,gBAAAD,SAAA,cAAC,kBAAe,oBAAoB,oBAAoB,iBAAiB,iBAAiB;AAAA,IAC1F,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,MAAMU,QAAM,EAAE,sBAAsB,kBAAkB,CAAC,EACpD,KAAK,EAAE,sBAAsB,KAAK,GAAG,MAAM,QAAQ,EACnD,KAAK,EAAE,mBAAmB,KAAK,GAAG,MAAM,OAAO,EAC/C,UAAU,MAAM,MAAS;AAAA,UAC5B,UAAU;AAAA,UACV,QAAQ,CAAC,oBAAoB,SAAS;AAAA,UACtC,WAAW;AAAA,UACX,WAAW,EAAE,SAAS,OAAO;AAAA,UAC7B,WAAW;AAAA,QACb;AAAA;AAAA,MAEA,gBAAAV,SAAA;AAAA,QAAC;AAAA;AAAA,UACC;AAAA,UAEA,YAAYC,MAAA,qCAAiD,sBAAjD,gBAAAA,IAAoE;AAAA,UAChF;AAAA;AAAA,MACF;AAAA,IACF;AAAA,EACF,CACF;AAEJ;;;AuBvKA;;;ACAA;AAAA,OAAOkB,cAAW;AAClB,SAAS,YAAAC,kBAAgB;AACzB,SAAS,gBAAAC,eAAc,mBAAAC,kBAAiB,eAAAC,qBAAmB;;;ACF3D;AAAA,OAAOC,cAAW;AAClB,SAAS,YAAAC,kBAAgB;AACzB,SAAS,oBAAAC,yBAAwB;AAU1B,IAAM,oBAAoB,MAAM;AACrC,QAAM,EAAE,OAAO,YAAY,IAAI,oBAAoB;AACnD,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,aAAa;AACnB,QAAM,oBAAoB,kBAAkB,kBAAkB,YAAY;AAC1E,QAAM,qBAAqB,eAAe,cAAc,YAAY;AAEpE,MAAK,CAAC,SAAS,CAAC,eAAiB,YAAY,CAAC,OAAQ;AACpD,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,SAAA,cAAC,QAAK,WAAW,WAAW,QAAQ,UAAU,KAAK,EAAE,IAAI,MAAM,YAAY,WAAW,WAAW,QAAQ,KACvG,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,oBAAoB,YAAY,YAAY,KACtE,KACH,GACC,CAAC,YACA,gBAAAA,SAAA,cAAC,QAAK,OAAM,OAAM,KAAK,EAAE,OAAO,mBAAmB,KACjD,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,qBAAqB,KAC/C,YAAY,MAAM,GAAG,UAAU,CAClC,GACC,YAAY,SAAS,aACpB,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO,EAAE,YAAY,OAAO,UAAU,QAAQ,QAAQ,WAAW,YAAY,OAAO;AAAA,MACpF,SAAS;AAAA;AAAA,IACV;AAAA,EAED,IACE,IACN,GAED,YAAY,cACX,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,OAAO,qBAAqB,KACvC,gBAAAA,SAAA,cAACC,mBAAA,EAAiB,QAAQ,IAAI,OAAO,IAAI,SAAS,oBAAoB,CACxE,IACE,IACN;AAEJ;;;AClDA;AAAA,OAAOC,cAAW;AAClB;AAAA,EACE,cAAAC;AAAA,EACA,6BAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,cAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP;AAAA,EACE;AAAA,EACA,kBAAAC;AAAA,EACA,aAAAC;AAAA,EACA,aAAAC;AAAA,EACA;AAAA,EACA,eAAAC;AAAA,EACA;AAAA,OACK;AASA,IAAM,oBAAoB,MAAM;AACrC,QAAM,UAAUC,gBAAc;AAC9B,QAAM,EAAE,WAAW,IAAIC,YAAW;AAClC,QAAM,EAAE,WAAW,IAAI;AACvB,QAAM,YAAYC,cAAYC,0BAAyB;AAEvD,QAAM,eAAeD,cAAYE,wBAAuB;AACxD,QAAM,kBAAkBF,cAAYG,sBAAqB,YAAY,CAAC;AACtE,MAAI,CAAC,cAAc,EAAC,yCAAY,WAAU,EAAC,mDAAiB,aAAY;AACtE,WAAO;AAAA,EACT;AACA,SACE,gBAAAC,SAAA,cAAC,WACC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,UAAU,CAAC;AAAA,MACX,SAAS,MAAY;AACnB,YAAI;AACF,gBAAM,QAAQ,aAAa;AAAA,QAC7B,SAAS,GAAG;AACV,uBAAa,SAAS;AAAA,YACpB,OAAO,+BAA+B,EAAE,WAAW,EAAE;AAAA,YACrD,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAACC,iBAAA,IAAe;AAAA,EAClB,CACF;AAEJ;AAGO,IAAM,eAAe,MAAM;AAChC,QAAM,EAAE,YAAY,mBAAmB,aAAa,IAAIN,YAAW;AAInE,QAAM,wBAAwB,eAAe,iBAAiB;AAC9D,QAAM,EAAE,YAAY,YAAY,IAAI;AACpC,MAAI,wBAAwB;AAC5B,MAAI,gBAAgB,kBAAkB;AACtC,MAAI,uBAAuB;AACzB,4BAAwB;AACxB,oBAAgB,kBAAkB;AAAA,EACpC;AACA,QAAM,aAAaD,gBAAc;AACjC,QAAM,gBAAgB,+DAAuB,KAAK,UAAQ,CAAC,CAAC,KAAK;AACjE,QAAM,mBAAmB,+DAAuB,KAAK,UAAQ,KAAK,aAAa;AAE/E,MAAI,CAAC,eAAe;AAClB,WAAO;AAAA,EACT;AACA,MAAI,YAAY,gBAAAM,SAAA,cAACE,cAAA,IAAY;AAC7B,MAAI,oBAAoB,iBAAiB,MAAM,YAAY,EAAE,SAAS,WAAW,GAAG;AAClF,gBAAY,gBAAAF,SAAA,cAAC,mBAAc;AAAA,EAC7B,WAAW,oBAAoB,iBAAiB,MAAM,YAAY,EAAE,SAAS,OAAO,GAAG;AACrF,gBAAY,gBAAAA,SAAA,cAAC,oBAAe;AAAA,EAC9B,WAAW,oBAAoB,iBAAiB,MAAM,YAAY,EAAE,SAAS,UAAU,GAAG;AACxF,gBAAY,gBAAAA,SAAA,cAAC,mBAAc;AAAA,EAC7B;AACA,SACE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,cAAc;AAAA,MACd,eAAe;AAAA,MACf,UAAU,CAAM,aAAY;AAC1B,YAAI;AACF,gBAAM,aAAa;AAAA,YACjB;AAAA,YACA,YAAY,wBAAwBG,YAAW,cAAcA,YAAW;AAAA,UAC1E,CAAC;AAAA,QACH,SAAS,GAAG;AACV,uBAAa,SAAS;AAAA,YACpB,OAAO,qCAAqC,EAAE,WAAW,EAAE;AAAA,YAC3D,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAH,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS,MAAY;AAEnB,gBAAM,WAAW,eAAe;AAAA,QAClC;AAAA;AAAA,MAEA,gBAAAA,SAAA,cAAC,0BAAY,WAAU,GAAC;AAAA,IAC1B;AAAA,EACF;AAEJ;AAEA,IAAM,sBAAsB,CAAC,EAAE,cAAc,eAAe,UAAU,SAAS,MAAM;AACnF,SACE,gBAAAA,SAAA,cAAC,MAAM,MAAN,MACC,gBAAAA,SAAA,cAAC,MAAM,SAAN,EAAc,SAAO,QAAE,QAAS,GACjC,gBAAAA,SAAA,cAAC,MAAM,SAAN,MACC,gBAAAA,SAAA,cAAC,MAAM,OAAN,EAAY,KAAK,EAAE,IAAI,OAAO,IAAI,MAAM,YAAY,SAAS,KAC5D,gBAAAA,SAAA,cAAC,QAAK,WAAU,OAAM,SAAQ,WAAU,KAAK,EAAE,GAAG,OAAO,KACvD,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,SAAS,OAAO,KAAG,OAE7C,GACA,gBAAAA,SAAA,cAAC,MAAM,OAAN,MACC,gBAAAA,SAAA,cAAC,sBAAW,IAAG,OAAM,eAAY,uBAC/B,gBAAAA,SAAA,cAACI,aAAA,IAAU,CACb,CACF,CACF,CACF,GACA,gBAAAJ,SAAA,cAAC,uBAAkB,GACnB,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,WAAW;AAAA,QACX,WAAW;AAAA,MACb;AAAA;AAAA,IAEC,aAAa,IAAI,iBAAe;AAC/B,aACE,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK,YAAY;AAAA,UACjB,OAAO,YAAY;AAAA,UACnB,IAAI,YAAY;AAAA,UAChB,SAAS,YAAY,aAAa;AAAA,UAClC,UAAU,MAAM,SAAS,YAAY,QAAQ;AAAA;AAAA,MAC/C;AAAA,IAEJ,CAAC;AAAA,EACH,CACF,CACF;AAEJ;AAEA,IAAM,kBAAkB,CAAC,EAAE,OAAO,OAAO,gBAAAA,SAAA,cAAAA,SAAA,cAAE,GAAK,SAAS,IAAI,SAAS,MAAM;AAC1E,SACE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,GAAG;AAAA,QACH,cAAc;AAAA,MAChB;AAAA,MACA,SAAS;AAAA;AAAA,IAET,gBAAAA,SAAA;AAAA,MAACK;AAAA,MAAA;AAAA,QACC,SAAS;AAAA,QACT,KAAK;AAAA,UACH,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,KAAK;AAAA,UACL,MAAM;AAAA,QACR;AAAA;AAAA,MAEC;AAAA,MACA;AAAA,IACH;AAAA,IACC,WAAW,gBAAAL,SAAA,cAACM,YAAA,EAAU,OAAO,IAAI,QAAQ,IAAI;AAAA,EAChD;AAEJ;;;AFpLO,IAAMC,UAAS,MAAM;AAC1B,QAAM,YAAYC,cAAYC,gBAAe;AAC7C,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAE5C,MAAI,cAAcC,cAAa,WAAW;AACxC,WAAO,gBAAAC,SAAA,cAAAA,SAAA,cAAE;AAAA,EACX;AACA,SACE,gBAAAA,SAAA,cAAC,QAAK,SAAQ,WAAU,OAAM,UAAS,KAAK,EAAE,UAAU,YAAY,QAAQ,OAAO,KACjF,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAI,KAAI,KAAK,EAAE,UAAU,YAAY,MAAM,MAAM,KACpE,gBAAAA,SAAA,cAAC,UAAK,GACN,gBAAAA,SAAA,cAAC,uBAAkB,GACnB,gBAAAA,SAAA,cAAC,gBAAW,GACX,YACC,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,KAAK,KACpC,gBAAAA,SAAA,cAAC,gBAAW,GACZ,gBAAAA,SAAA,cAAC,qBAAgB,GACjB,gBAAAA,SAAA,cAAC,0BAAqB,CACxB,CAEJ,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,UAAU;AAAA,QACV,OAAO;AAAA,QACP,KAAK;AAAA,MACP;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,mBAAc;AAAA,IACd,WACC,gBAAAA,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,uBAAkB,GACnB,gBAAAA,SAAA,cAAC,kBAAa,CAChB,IACE;AAAA,EACN,CACF;AAEJ;;;AGnDA;AAAA,SAAS,aAAAC,mBAAiB;AAC1B,SAAS,2BAAAC,0BAAyB,sBAAAC,4BAA0B;AAGrD,IAAM,yBAAyB,MAAM;AAC1C,QAAM,eAAeC,qBAAmB;AACxC,QAAM,EAAE,eAAe,IAAI,cAAc;AAEzC,EAAAC,YAAU,MAAM;AACd,QAAI,eAAe,aAAa,SAASC,wBAAuB;AAChE,UAAM,cAAc,aAAa,UAAU,iBAAe;AACxD,UAAI,iBAAiB,eAAe,aAAa;AAC/C,uBAAe,EAAE,UAAU,aAAa,CAAC;AACzC,uBAAe;AAAA,MACjB;AAAA,IACF,GAAGA,wBAAuB;AAC1B,WAAO;AAAA,EACT,GAAG,CAAC,YAAY,CAAC;AACjB,SAAO;AACT;;;A9VmBO,IAAM,mBAAmB,MAAM;AAtCtC,MAAAC,KAAAC,KAAA;AAuCE,QAAM,EAAE,UAAU,WAAW,QAAQ,WAAW,IAAI,sBAAsB;AAC1E,QAAM,cAAc,gCAAgC;AACpD,QAAM,EAAE,uBAAuB,IAAI,2BAA2B;AAC9D,QAAM,YAAYC,cAAYC,gBAAe;AAC7C,QAAM,oBAAoBD,cAAYE,yBAAuB;AAC7D,QAAM,aAAaC,gBAAc;AACjC,QAAM,CAAC,cAAc,eAAe,IAAIC,WAAS,KAAK;AACtD,QAAM,eAAeJ,cAAYK,gBAAc,SAAS,YAAY,CAAC;AACrE,QAAM,qBAAqB,aAAa;AACxC,QAAM,YAAYC,SAA8B,IAAI;AACpD,QAAM,YAAYA,SAA8B,IAAI;AACpD,QAAM,iBAAiB,aAAa,SAAS;AAC7C,QAAM,kBAAkBA,SAAiB;AACzC,QAAM,CAAC,YAAY,IAAI,mBAAmB,SAAS,UAAU;AAC7D,QAAM,EAAE,kBAAkB,IAAIC,sBAAqB;AAGnD,QAAM,WAAW,CAAC,GAACT,MAAA,YAAY,aAAZ,gBAAAA,IAAsB;AACzC,QAAM,iBAAiBQ,SAAO,sBAAsB;AACpD,QAAM,oBAAoB,mBAAmB;AAC7C,QAAM,uBAAuB,sBAAsB;AACnD,QAAM,kBAAkB,qBAAqB;AAE7C,QAAM,iBAAiB,MAAM;AA9D/B,QAAAR;AA+DI,UAAIA,MAAA,gBAAgB,YAAhB,gBAAAA,IAAyB,YAAW,KAAK,kBAAkB,CAAC,iBAAiB;AAC/E,sBAAgB,WAAS,CAAC,KAAK;AAAA,IACjC;AAAA,EACF;AAEA,EAAAU,YAAU,MAAM;AACd,QAAI;AACJ,oBAAgB,UAAU,gBAAgB,CAAC;AAC3C,QAAI,gBAAgB,WAAW,gBAAgB,QAAQ,WAAW,GAAG;AACnE,mBAAa,OAAO;AACpB,gBAAU,WAAW,MAAM;AACzB,YAAI,gBAAgB,WAAW,gBAAgB,QAAQ,WAAW,GAAG;AACnE,0BAAgB,cAAc;AAAA,QAChC;AAAA,MACF,GAAG,GAAI;AAAA,IACT;AACA,WAAO,MAAM;AACX,mBAAa,OAAO;AAAA,IACtB;AAAA,EACF,GAAG,CAAC,cAAc,cAAc,cAAc,CAAC;AAE/C,EAAAA,YAAU,MAAM;AACd,QACE,sBACA,CAAC,qBACD,CAAC,0BACD,cAAcC,cAAa,cAC3B,CAAC,eAAe,SAChB;AACA,iBACG,KAAK;AAAA,QACJ,UAAU,YAAYC,MAAK;AAAA,QAC3B,WAAW;AAAA,QACX,cAAc,uCAAW;AAAA,QACzB,UAAU;AAAA,UACR,cAAc,CAAC;AAAA,UACf,cAAc,CAAC;AAAA,UACf,+BAA+B,CAAC,wBAAwB;AAAA,QAC1D;AAAA,MACF,CAAC,EACA,KAAK,MAAM,kBAAkB,CAAC,EAC9B,MAAM,QAAQ,KAAK;AACtB,qBAAe,UAAU;AAAA,IAC3B;AAAA,EACF,GAAG;AAAA,IACD;AAAA,IACA,uCAAW;AAAA,IACX;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AAED,EAAAF,YAAU,MAAM;AACd;AACA,WAAO,MAAM;AACX,uBAAiB,KAAK,EAAE,MAAM,CAAC,UAAmB,QAAQ,MAAM,gBAAiB,MAAgB,OAAO,CAAC;AAAA,IAC3G;AAAA,EACF,GAAG,CAAC,UAAU,CAAC;AAEf,MAAI,CAAC,qBAAqB,CAAC,CAACC,cAAa,cAAcA,cAAa,YAAY,EAAE,SAAS,SAAS,GAAG;AACrG,WAAO,gBAAAE,SAAA,cAAC,4BAAiB,MAAM,cAAcF,cAAa,aAAa,eAAe,IAAI;AAAA,EAC5F;AAEA,QAAM,2BAA2B,kBAAkB,OAAO;AAE1D,SACE,gBAAAE,SAAA,cAAAA,SAAA,gBACG,eACC,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,UAAU,SAAS,QAAQ,KAAK,GAAG,QAAQ,GAAG,QAAQ,MAAM,GAAG,KAAK,EAAE,KAChF,gBAAAA,SAAA,cAAC,4BAAiB,MAAK,2BAA0B,KAAK,EAAE,SAAS,KAAK,IAAI,kBAAkB,GAAG,CACjG,IACE,MACJ,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,MAAM,QAAQ,UAAU,SAAS,GAAG,WAAU,YACxD,EAAE,YAAY,aAAa,SAAS,QAAQ,KAAK,oBAChD,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,MACL,KAAK;AAAA,QACH,GAAG;AAAA,QACH,YAAY;AAAA,QACZ,WAAW,2BAA2B,KAAIZ,MAAA,UAAU,YAAV,gBAAAA,IAAmB,YAAY,OAAO;AAAA,QAChF,OAAO;AAAA,UACL,GAAG;AAAA,QACL;AAAA,MACF;AAAA,MACA,eAAY;AAAA;AAAA,IAEZ,gBAAAY,SAAA,cAACC,SAAA,IAAO;AAAA,EACV,GAEF,gBAAAD,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,MAAM;AAAA,QACN,WAAW;AAAA;AAAA,QAEX,MAAK,4DAAa,aAAb,mBAA8D,sBAA9D,mBAAiF,SAAjF,mBAAuF,gBACxF,IACA;AAAA;AAAA,QACJ,eAAe;AAAA,QACf,OAAO;AAAA,UACL,IAAI;AAAA,QACN;AAAA,MACF;AAAA,MACA,IAAG;AAAA,MACH,eAAY;AAAA,MACZ,SAAS;AAAA;AAAA,IAER,YAAY,WACX,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,YAAY,YAAY;AAAA,QACxB,UAAU,YAAY;AAAA,QACtB,cAAc;AAAA;AAAA,IAChB,IACE;AAAA,EACN,GACC,CAAC,YAAY,aAAa,SAAS,QAAQ,KAAK,YAAY,YAAY,CAAC,mBACxE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,MACL,KAAK;AAAA,QACH,YAAY;AAAA,QACZ,WAAW;AAAA,QACX,YAAY;AAAA,QACZ,IAAI;AAAA,QACJ,cAAc,2BAA2B,KAAI,eAAU,YAAV,mBAAmB,YAAY,OAAO;AAAA,QACnF,OAAO;AAAA,UACL,WAAW;AAAA,UACX,IAAI,YAAY,eAAe,uBAAuB,gBAAgB;AAAA,QACxE;AAAA,MACF;AAAA,MACA,eAAY;AAAA;AAAA,IAEZ,gBAAAA,SAAA,cAACE,SAAA,EAAO,UAAU,YAAY,UAAU,YAAY,YAAY,YAAY;AAAA,EAC9E,GAED,mBAAmB,CAAC,YACnB,gBAAAF,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,YAAY;AAAA,QACZ,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,UAAU;AAAA,MACZ;AAAA,MACA,SAAQ;AAAA,MACR,KAAI;AAAA;AAAA,IAEJ,gBAAAA,SAAA,cAAC,eAAU;AAAA,IACX,gBAAAA,SAAA,cAAC,gBAAa,UAAU,YAAY,UAAU,YAAY,YAAY,YAAY;AAAA,IAClF,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,UAAU;AAAA,UACV,QAAQ;AAAA,UACR,IAAI;AAAA,QACN;AAAA;AAAA,MAEA,gBAAAA,SAAA,cAAC,mBAAc;AAAA,IACjB;AAAA,EACF,GAEF,gBAAAA,SAAA,cAAC,4BAAuB,GACxB,gBAAAA,SAAA,cAAC,qBAAgB,GACjB,gBAAAA,SAAA,cAAC,kBAAa,GACd,gBAAAA,SAAA,cAAC,4BAAuB,CAC1B,CACF;AAEJ;;;A+VvOA;AAAA,OAAOG,YAAS,iBAAiB;AACjC,SAAS,YAAAC,iBAAgB;AAMlB,IAAM,gBAAN,cAA4B,UAAU;AAAA,EAC3C,YAAY,OAAO;AACjB,UAAM,KAAK;AACX,SAAK,QAAQ,EAAE,OAAO,MAAM,WAAW,MAAM,eAAe,MAAM;AAAA,EACpE;AAAA,EAEA,kBAAkB,OAAO,WAAW;AAClC,YAAQ,MAAM,0BAA0B,MAAM,OAAO,IAAI,OAAO,SAAS;AAEzE,SAAK,SAAS;AAAA,MACZ,OAAO,+BAAO;AAAA,MACd;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,SAAS;AACP,QAAI,KAAK,MAAM,WAAW;AACxB,aACE,gBAAAC,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAM;AAAA,UACN,SAAQ;AAAA,UACR,KAAK;AAAA,YACH,MAAM;AAAA,YACN,QAAQ;AAAA,YACR,OAAO;AAAA,YACP,OAAO;AAAA,YACP,iBAAiB;AAAA,UACnB;AAAA;AAAA,QAEA,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,UAAU,YAAY,UAAU,UAAU,GAAG,MAAM,QAAQ,QAAQ,OAAO,OAAO,KAC3F,gBAAAA,SAAA;AAAA,UAAC;AAAA;AAAA,YACC,WAAU;AAAA,YACV,KAAK;AAAA,cACH,UAAU;AAAA,cACV,MAAM;AAAA,cACN,KAAK;AAAA,cACL,MAAM;AAAA,YACR;AAAA;AAAA,UAEA,gBAAAA,SAAA,cAAC,SAAI,OAAO,EAAE,QAAQ,UAAU,OAAO,OAAO,KAC5C,gBAAAA,SAAA,cAAC,YAAK,sBAAoB,GAC1B,gBAAAA,SAAA,cAAC,YAAK,cAAW,KAAK,MAAM,KAAM,GAClC,gBAAAA,SAAA,cAAC,UAAG,GAAE,2GAEN,gBAAAA,SAAA,cAAC,OAAE,MAAK,yCAAwC,QAAO,UAAS,KAAI,gBAAa,SAEjF,CACF;AAAA,UACA,gBAAAA,SAAA,cAAC,YACC,gBAAAA,SAAA,cAAC,WAAQ,OAAM,iBACb,gBAAAA,SAAA;AAAA,YAAC;AAAA;AAAA,cACC,SAAS,MAAM;AACb,uBAAO,SAAS,OAAO;AAAA,cACzB;AAAA,cACA,KAAK,EAAE,IAAI,KAAK;AAAA,cAChB,eAAY;AAAA;AAAA,YACb;AAAA,UAED,CACF,GACA,gBAAAA,SAAA,cAAC,WAAQ,OAAM,qCACb,gBAAAA,SAAA;AAAA,YAAC;AAAA;AAAA,cACC,SAAS,MAAM;AACb,sBAAM,EAAE,OAAO,UAAU,IAAI,KAAK;AAClC,0BAAU,UAAU;AAAA,kBAClB,KAAK,UAAU;AAAA,oBACb;AAAA,oBACA;AAAA,kBACF,CAAC;AAAA,gBACH;AACA,qBAAK,SAAS,EAAE,eAAe,KAAK,CAAC;AAAA,cACvC;AAAA,cACA,KAAK,EAAE,IAAI,KAAK;AAAA,cAChB,eAAY;AAAA;AAAA,YAEZ,gBAAAA,SAAA,cAACC,WAAA,IAAS;AAAA,YAAE;AAAA,YAAE,KAAK,MAAM,gBAAgB,WAAW;AAAA,UACtD,CACF,CACF;AAAA,UAEA,gBAAAD,SAAA,cAAC,aAAQ,OAAO,EAAE,YAAY,YAAY,QAAQ,SAAS,KACzD,gBAAAA,SAAA,cAAC,YAAM,KAAK,MAAM,SAAS,KAAK,MAAM,MAAM,SAAS,CAAE,GACvD,gBAAAA,SAAA,cAAC,UAAG,GACJ,gBAAAA,SAAA,cAAC,YAAM,KAAK,UAAU,KAAK,MAAM,SAAS,CAAE,CAC9C;AAAA,QACF,CACF;AAAA,MACF;AAAA,IAEJ;AAEA,WAAO,KAAK,MAAM;AAAA,EACpB;AACF;;;ACpGA;AAAA,OAAOE,YAAS,aAAAC,mBAAiB;;;ACAjC;AAAA,SAAS,aAAAC,mBAAiB;AAC1B,SAAS,cAAc,eAAAC,qBAAmB;AAEnC,IAAM,eAAN,MAAmB;AAAA,EAQxB,OAAO,KAAK,QAAQ;AAClB,QAAI,CAAC,OAAO,KAAK;AACf,aAAO,MAAM,CAAC;AAAA,IAChB;AAEA,WAAO,IAAI,uBAAuB;AAElC,WAAO,IAAI,6BAA6B;AACxC,WAAO,IAAI,UAAU,2BAAY,kBAAkB;AAEnD,SAAK,sBAAsB,2BAAY,oCAAoC;AAAA,EAC7E;AAAA,EAEA,OAAO,SAAS;AACd,WAAO,OAAO,IAAI;AAAA,EACpB;AAAA,EAEA,OAAO,qBAAqB;AAC1B,WAAO,OAAO,IAAI;AAAA,EACpB;AAAA,EAEA,OAAO,2BAA2B;AAChC,WAAO,OAAO,IAAI;AAAA,EACpB;AACF;AA/BE,cADW,cACJ,uBAAsB,2BAAY,mCAAmC;AAC5E,cAFW,cAEJ,uBAAsB,2BAAY,qCAAqC;AAC9E,cAHW,cAGJ,oBACL,2BAAY,+BACZ,2BAAY,4BACZ,2BAAY;AA4BT,SAAS,mBAAmB;AACjC,QAAM,SAASC,cAAY,YAAY;AACvC,EAAAC,YAAU,MAAM;AACd,QAAI,QAAQ;AACV,mBAAa,KAAK,MAAM;AAAA,IAC1B;AAAA,EACF,GAAG,CAAC,MAAM,CAAC;AACX,SAAO;AACT;;;ADzCA,IAAM,OAAO,MAAM;AACjB,QAAM,EAAE,YAAY,IAAI,SAAS;AAEjC,EAAAC,YAAU,MAAM;AACd,WAAO,gBAAgB;AAAA,EACzB,GAAG,CAAC,WAAW,CAAC;AAEhB,EAAAA,YAAU,MAAM;AACd,aAAS,cAAc;AAZ3B,UAAAC;AAgBM,eAAS,KAAK,MAAM,SAAS,KAAGA,MAAA,OAAO,mBAAP,gBAAAA,IAAuB,WAAU,OAAO,WAAW;AAAA,IACrF;AAEA,WAAO,iBAAiB,UAAU,WAAW;AAE7C,gBAAY;AACZ,WAAO,MAAM;AACX,aAAO,oBAAoB,UAAU,WAAW;AAAA,IAClD;AAAA,EACF,GAAG,CAAC,CAAC;AAEL,SAAO,gBAAAC,SAAA,cAAC,sBAAiB;AAC3B;;;AE5BA;AAAA,SAAS,aAAAC,mBAAiB;AAC1B;AAAA,EACE,iBAAAC;AAAA,EACA,6BAAAC;AAAA,EACA,6BAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,sBAAAC;AAAA,OACK;AAGP,IAAI,0BAA0B;AAV9B;AAWO,IAAM,uBAAN,MAA2B;AAAA,EAGhC,YAAY,OAAO,SAAS;AAF5B;AACA;AAKA,qCAAe,MAAY;AACzB,YAAM,UAAU,mBAAK,QAAO,SAASC,0BAAyB;AAC9D,YAAM,mBAAK,UAAS,qBAAqB,CAAC,OAAO;AAAA,IACnD;AAEA,qCAAe,MAAY;AACzB,YAAM,UAAU,mBAAK,QAAO,SAASC,0BAAyB;AAC9D,YAAM,mBAAK,UAAS,qBAAqB,CAAC,OAAO;AAAA,IACnD;AAEA,sCAAgB,MAAM;AACpB,UAAI,mBAAK,QAAO,SAASC,gBAAc,SAAS,QAAQ,CAAC,GAAG;AAC1D,2BAAK,UAAS,WAAW,SAAS,UAAU,EAAE;AAAA,MAChD;AAAA,IACF;AAEA,6CAAuB,MAAM;AAC3B,YAAM,aAAa,mBAAK,QAAO,SAASA,gBAAc,SAAS,UAAU,CAAC;AAC1E,YAAM,eAAe,WAAW;AAChC,yBAAK,UAAS,WAAW,SAAS,YAAY,iCACzC,aADyC;AAAA,QAE5C,kBAAkB,CAAC;AAAA,MACrB,EAAC;AAAA,IACH;AAEA,wCAAkB,MAAM;AACtB,yBAAK,UAAS,WAAW,SAAS,UAAU,CAAC,mBAAK,QAAO,SAASA,gBAAc,SAAS,QAAQ,CAAC,CAAC;AAAA,IACrG;AAGA;AAAA,wCAAkB,CAAM,MAAK;AAC3B,YAAM,cAAc,UAAU,EAAE,UAAU,EAAE;AAC5C,YAAM,QAAQ,EAAE,QAAQ,OAAO,EAAE,QAAQ;AACzC,YAAM,QAAQ,EAAE,QAAQ,OAAO,EAAE,QAAQ;AACzC,YAAM,UAAU,EAAE,QAAQ,OAAO,EAAE,QAAQ;AAE3C,YAAM,wBAAwB,eAAe;AAC7C,YAAM,wBAAwB,eAAe;AAC7C,YAAM,0BAA0B,EAAE,QAAQ;AAC1C,YAAM,2BAA2B,eAAe;AAEhD,UAAI,uBAAuB;AACzB,UAAE,eAAe;AACjB,cAAM,mBAAK,cAAL;AAAA,MACR,WAAW,uBAAuB;AAChC,UAAE,eAAe;AACjB,cAAM,mBAAK,cAAL;AAAA,MACR,WAAW,yBAAyB;AAClC,2BAAK,eAAL;AAAA,MACF,WAAW,0BAA0B;AACnC,2BAAK,iBAAL;AACA,2BAAK,sBAAL;AAAA,MACF;AAAA,IACF;AAEA,8BAAQ,MAAM;AACZ,eAAS,iBAAiB,WAAW,mBAAK,kBAAiB,KAAK;AAAA,IAClE;AAEA,gCAAU,MAAM;AACd,eAAS,oBAAoB,WAAW,mBAAK,kBAAiB,KAAK;AAAA,IACrE;AAEA,4CAAmB,MAAM;AACvB,UAAI,CAAC,yBAAyB;AAC5B,2BAAK,OAAL;AACA,kCAA0B;AAAA,MAC5B;AAAA,IACF;AAEA,8CAAqB,MAAM;AACzB,UAAI,yBAAyB;AAC3B,2BAAK,SAAL;AACA,kCAA0B;AAAA,MAC5B;AAAA,IACF;AA9EE,uBAAK,UAAW;AAChB,uBAAK,QAAS;AAAA,EAChB;AA6EF;AAlFE;AACA;AAKA;AAKA;AAKA;AAMA;AASA;AAKA;AAyBA;AAIA;AAmBK,IAAM,kBAAkB,MAAM;AACnC,QAAM,QAAQC,qBAAmB;AACjC,QAAM,UAAUC,gBAAc;AAE9B,EAAAC,YAAU,MAAM;AACd,UAAM,kBAAkB,IAAI,qBAAqB,OAAO,OAAO;AAC/D,oBAAgB,iBAAiB;AACjC,WAAO,gBAAgB;AAAA,EACzB,GAAG,CAAC,SAAS,KAAK,CAAC;AACnB,SAAO;AACT;;;AC1GA;AAAA,OAAOC,cAAW;AAClB,SAAS,YAAAC,iBAAgB;;;ACDzB;AAAA,OAAOC,YAAS,YAAAC,kBAAgB;AAChC,SAAS,YAAAC,kBAAgB;;;ACDzB;AAAA,OAAOC,YAAS,YAAAC,kBAAgB;AAChC,SAAS,YAAAC,kBAAgB;AAEzB,SAAS,iBAAAC,uBAAqB;AAC9B,SAAS,aAAAC,YAAW,aAAAC,mBAAiB;AAa9B,IAAM,gBAAgB;AAAA,EAC3B,WAAW;AAAA,EACX,MAAM;AACR;AACO,IAAM,gBAAgB,CAAC;AAAA,EAC5B;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,eAAe,MAAM;AACzB,aAAS,cAAc,IAAI;AAAA,EAC7B;AACA,QAAM,0BAA0B,CAAC,MAAa;AAC5C,MAAE,eAAe;AAAA,EACnB;AACA,MAAI,UAAU;AACZ,WACE,gBAAAC,SAAA,cAAC,MAAM,MAAN,EAAW,MAAM,UAAU,cAAc,MAAM,gBAC9C,gBAAAA,SAAA;AAAA,MAAC,MAAM;AAAA,MAAN;AAAA,QACC,KAAK,EAAE,IAAI,gBAAgB,GAAG,OAAO,WAAW,OAAO;AAAA,QACvD,sBAAsB;AAAA,QACtB,mBAAmB;AAAA;AAAA,MAEnB,gBAAAA,SAAA,cAAC,mBAAgB,SAAkB,eAAe,OAAO,UAAoB;AAAA,IAC/E,CACF;AAAA,EAEJ;AACA,SACE,gBAAAA,SAAA,cAAC,OAAO,MAAP,EAAY,MAAM,UAAU,cAAc,MAAM,gBAC/C,gBAAAA,SAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,SAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,SAAA;AAAA,IAAC,OAAO;AAAA,IAAP;AAAA,MACC,KAAK,EAAE,IAAI,gBAAgB,OAAO,SAAS,GAAG,MAAM;AAAA,MACpD,sBAAsB;AAAA,MACtB,mBAAmB;AAAA;AAAA,IAEnB,gBAAAA,SAAA,cAAC,mBAAgB,SAAkB,eAAe,OAAO,UAAoB;AAAA,EAC/E,CACF,CACF;AAEJ;AAEO,IAAM,kBAAkB,CAAC;AAAA,EAC9B;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,EAAE,SAAS,IAAI,yBAAyB;AAC9C,QAAM,EAAE,UAAU,IAAI,sBAAsB;AAC5C,QAAM,WAAWD,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,aAAaE,gBAAc;AACjC,QAAM,CAAC,SAAS,UAAU,IAAIC,WAAS,EAAE;AACzC,QAAM,CAAC,iBAAiB,kBAAkB,IAAIA,WAAS,oBAAI,IAAY,CAAC;AACxE,QAAM,sBAAsB,CAAC,SAA2B,UAAkB;AACxE,UAAM,cAAc,IAAI,IAAI,eAAe;AAC3C,QAAI,SAAS;AACX,kBAAY,IAAI,KAAK;AAAA,IACvB,OAAO;AACL,kBAAY,OAAO,KAAK;AAAA,IAC1B;AACA,uBAAmB,WAAW;AAAA,EAChC;AACA,QAAM,iBAAiB,MAAY;AACjC,QAAI,gBAAgB,KAAK,QAAQ,UAAU,eAAe;AACxD;AAAA,IACF;AACA,QAAI;AACF,YAAM,UAAU,CAAC,GAAG,eAAe,EAAE,IAAI,CAAC,UAAe;AA/F/D,YAAAC,KAAAC;AA+FkE,iBAAAA,OAAAD,MAAA,QAAQ,aAAa,MAArB,gBAAAA,IAAwB,YAAxB,gBAAAC,IAAkC,WAAU;AAAA,OAAE;AAC1G,YAAM,WAAW;AAAA,QACf;AAAA,UACE,UAAU,GAAG,qCAAU,KAAK,MAAM,QAAQ,aAAa,EAAE,YAAY,EAAE;AAAA,UACvE,QAAQ,QAAQ,aAAa,EAAE,SAAS;AAAA,UACxC,YAAY;AAAA,UACZ,YAAY,QAAQ;AAAA,UACpB,SAAS,gBAAgB,SAAS,IAAI,CAAC,IAAI;AAAA,UAC3C;AAAA,QACF;AAAA,QACA,uCAAW;AAAA,MACb;AAAA,IACF,SAAS,GAAG;AACV,cAAQ,MAAM,CAAC;AAAA,IACjB;AAEA,aAAS,cAAc,SAAS;AAAA,EAClC;AACA,SACE,gBAAAJ,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,GAAG,kBAAkB,cAAc,OAAO,mBAAmB;AAAA,QAC7D,IAAI;AAAA,QACJ,GAAG;AAAA,QACH,KAAK;AAAA,MACP;AAAA,MACA,WAAU;AAAA;AAAA,IAEV,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC;AAAA,QACA;AAAA,QACA,gBAAgB,CAAC,UAAkB;AACjC,6BAAmB,oBAAI,IAAY,CAAC;AACpC,mBAAS,KAAK;AAAA,QAChB;AAAA;AAAA,IACF;AAAA,IACA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,QAAQ,QAAQ,aAAa;AAAA,QAC7B;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA;AAAA,IACF;AAAA,IACA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,MAAK;AAAA,QACL,MAAI;AAAA,QACJ,KAAK;AAAA,UACH,WAAW,WAAW,KAAK;AAAA,QAC7B;AAAA,QACA,SAAS;AAAA;AAAA,OAER,qCAAU,qBAAoB;AAAA,IACjC;AAAA,EACF;AAEJ;AACO,IAAM,iBAAiB,CAAC;AAAA,EAC7B;AAAA,EACA;AAAA,EACA,gBAAgB,cAAc;AAChC,MAIM;AACJ,QAAM,WAAWD,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,EAAE,SAAS,IAAI,yBAAyB;AAC9C,SACE,gBAAAC,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,QAAK,OAAM,YACV,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,KAAK;AAAA,QACH,MAAM;AAAA,MACR;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS,WAAW,OAAO;AAAA,QAC3B,KAAK;AAAA,UACH,GAAG;AAAA,UACH,WAAW;AAAA,QACb;AAAA;AAAA,OAEC,qCAAU,UAAS;AAAA,IACtB;AAAA,IACA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS,WAAW,UAAU;AAAA,QAC9B,KAAK;AAAA,UACH,GAAG;AAAA,UACH,SAAS;AAAA,UACT,YAAY;AAAA,QACd;AAAA;AAAA,OAEC,qCAAU,cAAa;AAAA,IAC1B;AAAA,EACF,GACC,kBAAkB,cAAc,OAC/B,gBAAAA,SAAA,cAACK,aAAA,EAAU,OAAM,QAAO,QAAO,QAAO,OAAM,SAAQ,SAAS,MAAM,eAAe,cAAc,IAAI,GAAG,IACrG,IACN,GACA,gBAAAL,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,KAAK;AAAA,QACL,GAAG;AAAA,QACH,OAAO;AAAA,UACL,KAAK;AAAA,QACP;AAAA,MACF;AAAA;AAAA,IAEC,QAAQ,IAAI,CAAC,SAAS,UAAU;AAC/B,aACE,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAM;AAAA,UACN,WAAU;AAAA,UACV,KAAK;AAAA,YACH,GACE,kBAAkB,SAAS,kBAAkB,cAAc,OACvD,qBACA;AAAA,YACN,KAAK;AAAA,UACP;AAAA,UACA,SAAS,MAAM,eAAe,KAAK;AAAA,UACnC,KAAK,GAAG,KAAK;AAAA;AAAA,QAEb,gBAAAA,SAAA;AAAA,UAAC;AAAA;AAAA,YACC,KAAK;AAAA,cACH,YAAY;AAAA,cACZ,UAAU;AAAA,cACV,IAAI;AAAA,cACJ,QAAQ;AAAA,cACR,SAAS,kBAAkB,SAAS,kBAAkB,cAAc,OAAO,IAAI;AAAA,cAC/E,OAAO;AAAA,gBACL,UAAU;AAAA,cACZ;AAAA,YACF;AAAA;AAAA,UAEC,QAAQ;AAAA,QACX;AAAA,QACA,gBAAAA,SAAA;AAAA,UAAC;AAAA;AAAA,YACC,SAAS,WAAW,UAAU;AAAA,YAC9B,KAAK;AAAA,cACH,GACE,kBAAkB,SAAS,kBAAkB,cAAc,OACvD,uBACA;AAAA,cACN,YAAY;AAAA,YACd;AAAA;AAAA,UAEC,QAAQ;AAAA,QACX;AAAA,MACF;AAAA,IAEJ,CAAC;AAAA,EACH,CACF;AAEJ;AACO,IAAM,eAAe,CAAC;AAAA,EAC3B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAMM;AACJ,QAAM,EAAE,SAAS,IAAI,yBAAyB;AAC9C,SACE,gBAAAA,SAAA,cAAAA,SAAA,gBACG,OAAO,WAAW,OAAO,QAAQ,SAAS,KACzC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,KAAK;AAAA,QACH,KAAK;AAAA,MACP;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,GAAG;AAAA,UACH,YAAY;AAAA,UACZ,UAAU;AAAA,UACV,IAAI;AAAA,QACN;AAAA;AAAA,MAEC,OAAO,YAAY;AAAA,IACtB;AAAA,IACA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,YAAY;AAAA,UACZ,WAAW;AAAA,UACX,UAAU;AAAA,UACV,KAAK;AAAA,UACL,MAAM;AAAA,UACN,OAAO;AAAA,YACL,MAAM;AAAA,UACR;AAAA,UACA,OAAO;AAAA,YACL,MAAM;AAAA,UACR;AAAA,QACF;AAAA;AAAA,MAEC,OAAO,QAAQ,IAAI,CAAC,QAAgB,UAAkB;AACrD,eACE,gBAAAA,SAAA;AAAA,UAAC;AAAA;AAAA,YACC,OAAM;AAAA,YACN,KAAI;AAAA,YACJ,KAAK;AAAA,YACL,KAAK;AAAA,cACH,QAAQ;AAAA,cACR,GAAG;AAAA,cACH,GAAG;AAAA,YACL;AAAA;AAAA,UAEA,gBAAAA,SAAA;AAAA,YAAC,SAAS;AAAA,YAAT;AAAA,cACC,IAAI,GAAG,MAAM,IAAI,KAAK;AAAA,cACtB,SAAS,gBAAgB,IAAI,KAAK;AAAA,cAClC,iBAAiB,aAAW,oBAAoB,SAAS,KAAK;AAAA,cAC9D,KAAK;AAAA,gBACH,QAAQ;AAAA,gBACR,YAAY;AAAA,gBACZ,IAAI;AAAA,gBACJ,QAAQ;AAAA,cACV;AAAA;AAAA,YAEA,gBAAAA,SAAA,cAAC,SAAS,WAAT,MACC,gBAAAA,SAAA,cAACM,YAAA,EAAU,OAAO,IAAI,QAAQ,IAAI,CACpC;AAAA,UACF;AAAA,UACA,gBAAAN,SAAA;AAAA,YAACO;AAAA,YAAA;AAAA,cACC,SAAS,GAAG,MAAM,IAAI,KAAK;AAAA,cAC3B,KAAK;AAAA,gBACH,OAAO;AAAA,gBACP,UAAU;AAAA,gBACV,YAAY;AAAA,gBACZ,YAAY;AAAA,cACd;AAAA;AAAA,YAEC;AAAA,UACH;AAAA,QACF;AAAA,MAEJ,CAAC;AAAA,IACH;AAAA,EACF,IAED,qCAAU,YACT,gBAAAP,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAU;AAAA,MACV,KAAK;AAAA,QACH,KAAK;AAAA,MACP;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,GAAG;AAAA,UACH,YAAY;AAAA,UACZ,UAAU;AAAA,QACZ;AAAA;AAAA,OAEC,qCAAU,QAAQ,UAAS;AAAA,IAC9B;AAAA,IACA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,WAAW;AAAA,QACX,cAAa,qCAAU,QAAQ,gBAAe;AAAA,QAC9C,KAAK;AAAA,UACH,iBAAiB;AAAA,UACjB,QAAQ;AAAA,UACR,QAAQ;AAAA,UACR,QAAQ;AAAA,UACR,SAAS;AAAA,QACX;AAAA,QACA,OAAO;AAAA,QACP,UAAU,WAAS,WAAW,MAAM,OAAO,MAAM,UAAU,CAAC;AAAA;AAAA,IAC9D;AAAA,EACF,CAEJ;AAEJ;;;AC5XA;AAAA,OAAOQ,cAAW;AAClB,SAAS,YAAAC,kBAAgB;AACzB,SAAS,qBAAqB;AAKvB,IAAM,eAAe,MAAM;AAChC,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,SACE,gBAAAC,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAW,WAAW,WAAW;AAAA,MACjC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,cAAc,CAAC,WAAW,OAAO;AAAA,QACjC,IAAI;AAAA,QACJ,GAAG,CAAC,WAAW,UAAU;AAAA,QACzB,GAAG;AAAA,QACH,IAAI,WAAW,QAAQ;AAAA,QACvB,OAAO;AAAA,UACL,UAAU;AAAA,UACV,QAAQ;AAAA,QACV;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,iBAAc,OAAM,QAAO,QAAO,QAAO;AAAA,IAC1C,gBAAAA,SAAA,cAAC,QAAK,WAAU,UAAS,OAAO,WAAW,WAAW,WACpD,gBAAAA,SAAA,cAAC,QAAK,SAAQ,QAAK,6BAA2B,GAC9C,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,YAAY;AAAA,UACZ,UAAU;AAAA,UACV,SAAS;AAAA,QACX;AAAA;AAAA,MACD;AAAA,IAED,CACF;AAAA,EACF;AAEJ;;;AFnCO,IAAM,WAAW,MAAM;AAC5B,QAAM,EAAE,SAAS,IAAI,yBAAyB;AAC9C,QAAM,CAAC,OAAO,QAAQ,IAAIC,WAAS,cAAc,IAAI;AACrD,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAE5C,MAAI,CAAC,UAAU;AACb,WAAO;AAAA,EACT;AACA,QAAM,EAAE,QAAQ,IAAI;AACpB,MAAI,CAAC,SAAS;AACZ,WAAO;AAAA,EACT;AACA,UAAQ,KAAK,CAACC,IAAGC,OAAM;AACrB,QAAI,CAACD,GAAE,SAAS,CAACC,GAAE,OAAO;AACxB,aAAO;AAAA,IACT;AACA,WAAOD,GAAE,QAAQC,GAAE;AAAA,EACrB,CAAC;AAED,MAAI,UAAU,cAAc,WAAW;AACrC,WACE,gBAAAC,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,IAAI;AAAA,QACN;AAAA;AAAA,MAEA,gBAAAA,SAAA,cAAC,kBAAa;AAAA,IAChB;AAAA,EAEJ;AACA,SACE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,GAAG,WAAW,SAAS;AAAA,MACzB;AAAA;AAAA,IAEC,UAAU,cAAc,OACvB,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,GAAG,WAAW,QAAQ;AAAA,UACtB,QAAQ;AAAA,UACR,IAAI;AAAA,UACJ,cAAc,CAAC,WAAW,OAAO;AAAA,UACjC,KAAK;AAAA,UACL,OAAO;AAAA,YACL,UAAU;AAAA,YACV,QAAQ;AAAA,YACR,GAAG;AAAA,UACL;AAAA,QACF;AAAA,QACA,WAAU;AAAA;AAAA,MAEV,gBAAAA,SAAA,cAAC,kBAAe,SAAkB,gBAAgB,UAAU;AAAA,IAC9D,IAEA,gBAAAA,SAAA,cAAC,iBAAc,SAAkB,OAAc,UAAoB;AAAA,EAEvE;AAEJ;;;ADxDO,IAAM,cAAc,MAAM;AAC/B,QAAM,EAAE,OAAO,IAAI,sBAAsB;AACzC,QAAM,CAAC,iBAAiB,IAAI,mBAAmB,oBAAoB,SAAS,wBAAwB;AACpG,SACE,gBAAAC,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,MAAM,OAAO,KAC3C,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,GAAG,OAAO,OAAO,EAAE,GAAG,MAAM,EAAE,GAAG,eAAY,YACvD,gBAAAA,SAAA,cAACC,SAAA,IAAO,CACV,GACA,gBAAAD,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,WAAU;AAAA,MACV,OAAM;AAAA,MACN,KAAK,EAAE,IAAI,mBAAmB,MAAM,SAAS,UAAU,WAAW;AAAA;AAAA,IAElE,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,YAAY,YAAY,KAAG,WAErD;AAAA,IACA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,oBAAoB,YAAY,aAAa,IAAI,MAAM,KAAG,mBAE3F;AAAA,IACA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,OAAO;AAAA,UACP,IAAI;AAAA,UACJ,YAAY;AAAA,UACZ,WAAW;AAAA,QACb;AAAA;AAAA,MACD;AAAA,MAEE,kBAAkB,QACjB,gBAAAA,SAAA,cAAC,OAAI,IAAG,QAAO,KAAK,mBAAK,aAAa,GAAG,MAAK,MACzC,kBAAkB,IACvB;AAAA,MACA;AAAA,IAEJ;AAAA,IACA,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,IAAI,OAAO,KAAK,OAAO,YAAY,SAAS,KACvD,gBAAAA,SAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,OAAO,sBAAsB,YAAY,WAAW,KAAG,kBAEpF,GACA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAS,MAAM;AACb,iBAAO;AACP,uBAAa,cAAc;AAAA,QAC7B;AAAA,QACA,eAAY;AAAA;AAAA,MAEZ,gBAAAA,SAAA,cAACE,WAAA,IAAS;AAAA,MACV,gBAAAF,SAAA,cAAC,QAAK,KAAK,EAAE,IAAI,MAAM,YAAY,aAAa,OAAO,UAAU,KAAG,QAAM;AAAA,IAC5E,CACF;AAAA,IACA,gBAAAA,SAAA,cAAC,cAAS;AAAA,EACZ,CACF;AAEJ;;;AItEA;AAAA,OAAOG,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C,SAAS,YAAAC,kBAAgB;AACzB,SAAS,SAAAC,SAAO,KAAAC,UAAS;AACzB,SAAS,mBAAmB;AAUrB,IAAM,sBAAsB,MAAM;AACvC,QAAM,CAAC,yBAAyB,0BAA0B,IAAIC,WAAS,KAAK;AAC5E,QAAM,cAAcC,WAAS,OAAU,MAAM,EAAE;AAC/C,QAAM,uBAAuB,sBAAsB;AAEnD,EAAAC,YAAU,MAAM;AAlBlB,QAAAC;AAmBI,QAAI,CAAC,mBAAmB;AACtB,iCAA2B,KAAK;AAChC;AAAA,IACF;AAEA,QAAI,GAACA,MAAA,OAAO,WAAP,gBAAAA,IAAe,cAAa;AAC/B,iCAA2B,eAAe,CAAC,oBAAoB;AAC/D;AAAA,IACF;AACA,UAAM,iBAAiB,MAAM;AAC3B,YAAM,QAAQ,OAAO,OAAO,YAAY;AACxC,YAAM,OAAO,OAAO,OAAO,YAAY,QAAQ;AAE/C;AAAA,QACEC,QAAM,EAAE,OAAO,sBAAsB,aAAa,KAAK,CAAC,EACrD,KAAK,EAAE,sBAAsB,KAAK,GAAG,MAAM,KAAK,EAChD,KAAK,EAAE,OAAOC,GAAE,KAAK,CAAAC,WAASA,UAASA,UAAS,EAAE,EAAE,GAAG,CAAC,EAAE,MAAAC,MAAK,MAAMA,MAAK,SAAS,WAAW,CAAC,EAC/F,UAAU,MAAM,WAAW;AAAA,MAChC;AAAA,IACF;AACA,mBAAe;AACf,WAAO,OAAO,YAAY,iBAAiB,UAAU,cAAc;AACnE,WAAO,MAAM;AACX,aAAO,OAAO,YAAY,oBAAoB,UAAU,cAAc;AAAA,IACxE;AAAA,EACF,GAAG,CAAC,aAAa,oBAAoB,CAAC;AAEtC,MAAI,sBAAsB;AACxB,WAAO;AAAA,EACT;AACA,SACE,gBAAAC,SAAA,cAAC,OAAO,MAAP,EAAY,MAAM,yBAAyB,cAAc,8BACxD,gBAAAA,SAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,SAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,SAAA,cAAC,OAAO,SAAP,EAAe,KAAK,EAAE,GAAG,mBAAmB,GAAG,MAAM,IAAI,eAAe,KACvE,gBAAAA,SAAA,cAAC,WACC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,OAAO;AAAA,QACP,SAAS;AAAA,QACT,YAAY;AAAA,MACd;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,eAAY,OAAO,EAAE,aAAa,SAAS,GAAG;AAAA,IAC/C,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,oBAAoB,YAAY,YAAY,KAAG,2BAEhF;AAAA,EACF,GACA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,sBAAsB,IAAI,MAAM,IAAI,KAAK,KAAG,0GAE7E,GACA,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,SAAQ,WAAU,KAAK,EAAE,GAAG,QAAQ,KAAK,KAAK,KACjE,gBAAAA,SAAA,cAAC,UAAO,UAAQ,MAAC,SAAQ,YAAW,KAAK,EAAE,GAAG,OAAO,GAAG,SAAS,MAAM,2BAA2B,KAAK,KAAG,iBAE1G,CACF,CACF,CACF,CACF,CACF;AAEJ;;;AChFA;;;ACAA;AACA,OAAOC,YAAS,eAAAC,eAAa,aAAAC,mBAAiB;AAC9C;AAAA,EACE,wBAAAC;AAAA,EAEA,gBAAAC;AAAA,EACA,6BAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,uBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,sBAAAC;AAAA,OACK;AACP,SAAS,aAAAC,kBAAiB;;;AChB1B;AAAA,OAAOC,cAAW;AAClB,SAAS,wBAAwB;AAK1B,SAAS,uBAAuB;AACrC,QAAM,EAAE,OAAO,YAAY,aAAa,IAAI,iBAAiB;AAC7D,SACE,gBAAAC,SAAA;AAAA,IAAC,OAAO;AAAA,IAAP;AAAA,MACC,MAAM,CAAC,CAAC;AAAA,MACR,cAAc,WAAS;AACrB,YAAI,CAAC,OAAO;AACV,uBAAa;AAAA,QACf;AACA,mBAAW;AAAA,MACb;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,iBAAc,OAAM,oBAAmB,WAAW,SACjD,gBAAAA,SAAA,cAAC,iBACC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,QAAK,kGAEnB,CACF,GACA,gBAAAA,SAAA,cAAC,aAAU,SAAQ,SACjB,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,SAAS,MAAM;AACb,uBAAa;AACb,qBAAW;AAAA,QACb;AAAA;AAAA,MACD;AAAA,IAED,CACF,CACF;AAAA,EACF;AAEJ;;;ACtCA;AAAA,OAAOC,YAAS,aAAAC,mBAAiB;AACjC,SAAS,MAAMC,aAAY;AAC3B,SAAS,qBAAAC,qBAAmB,sBAAAC,sBAAoB,eAAAC,qBAAmB;AACnE,SAAS,YAAAC,WAAU,sBAAsB;AAKzC,IAAM,+BAA+B;AAE9B,IAAM,oBAAoB,MAAM;AACrC,QAAM,YAAYC,cAAYC,iDAA+C,CAAC;AAC9E,QAAM,cAAcD,cAAYE,mBAAiB;AAEjD,EAAAC,YAAU,MAAM;AAdlB,QAAAC,KAAAC;AAeI,QAAI,CAAC,eAAaD,MAAA,UAAU,cAAV,gBAAAA,IAAqB,YAAW,aAAa;AAC7D;AAAA,IACF;AAEA,UAAM,YAAY,KAAK,IAAI,IAAI,UAAU,YAAY;AAErD,QAAI,CAAC,WAAW;AACd;AAAA,IACF;AAEA,UAAM,eAAe;AAAA,MACnB,IAAIE,MAAK;AAAA,MACT,MAAM,UAAU,UAAU,gBAAAC,SAAA,cAAC,oBAAe,IAAK,gBAAAA,SAAA,cAACC,WAAA,IAAS;AAAA,MACzD,OAAO,QAAQ,UAAU,UAAU,YAAY,QAAQ,QAAOH,MAAA,UAAU,cAAV,gBAAAA,IAAqB,QAAQ;AAAA,IAC7F;AACA,iBAAa,SAAS,YAAY;AAAA,EACpC,GAAG,CAAC,WAAW,WAAW,CAAC;AAC3B,SAAO,gBAAAE,SAAA,cAAAA,SAAA,cAAE;AACX;;;ACjCA;AAAA,SAAS,aAAAE,mBAAiB;AAC1B,SAAS,eAAAC,oBAAmB;AAC5B;AAAA,EACE,wBAAAC;AAAA,EACA,gBAAAC;AAAA,EACA,yBAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,6BAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,uBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,sBAAAC;AAAA,OACK;;;ACdP;;;ACAA;AAAA,OAAOC,YAAS,eAAAC,qBAAmB;AACnC,SAAS,kBAAAC,iBAAgB,iBAAAC,iBAAe,eAAAC,qBAAmB;AAC3D;AAAA,EACE,kBAAAC;AAAA,EACA;AAAA,EACA,YAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,oBAAAC;AAAA,EACA,wBAAAC;AAAA,OACK;AAMP,IAAM,aAAaC,SAAM,WAAW,CAAC,GAAG,QAAQ;AAC9C,QAAM,aAAa,kBAAkB,kBAAkB,IAAI;AAC3D,QAAM,aAAa,sBAAsB,kBAAkB,IAAI;AAE/D,MAAI,YAAY;AACd,WAAO;AAAA,EACT;AAEA,SACE,gBAAAA,SAAA,cAAC,UAAO,UAAQ,MAAC,IAAG,OAAM,SAAQ,YAAW,KAAK,EAAE,GAAG,cAAc,GAAG,SAAS,YAAY,OAAU,WAEvG;AAEJ,CAAC;AAED,IAAM,kBAAkBA,SAAM,WAAW,CAAC,EAAE,KAAK,IAAI,oBAAoB,KAAK,GAAG,QAAQ;AA9BzF,MAAAC,KAAAC,KAAA;AA+BE,QAAM,aAAaC,gBAAc;AACjC,QAAM,iBAAiB,kBAAkB,kBAAkB,YAAY;AACvE,QAAM,qBAAqB,sBAAsB,kBAAkB,YAAY;AAC/E,QAAM,OAAOC,cAAYC,gBAAe,EAAE,CAAC;AAC3C,QAAM,SAAS,cAAc;AAC7B,QAAM;AAAA,IACJ;AAAA,IACA;AAAA,IACA,kBAAkB,CAAC;AAAA,IACnB,+BAA+B;AAAA,EACjC,MAAI,MAAAH,OAAAD,MAAA,iCAAQ,YAAR,gBAAAA,IAAiB,iBAAjB,gBAAAC,IAA+B,YAA/B,mBAAwC,SAAS,iBAAgB,CAAC;AAEtE,QAAM,iBAAiBI,cAAY,MAAY;AAC7C,QAAI,mBAAmB;AACrB,iBAAW,iBAAiB,IAAI,eAAe,4BAA4B;AAC3E,UAAI,8BAA8B;AAChC,cAAM,WAAW,oBAAoB,EAAE;AAAA,MACzC;AAAA,IACF,OAAO;AACL,OAAC,sBAAsB,eAAe;AAAA,IACxC;AAAA,EACF,IAAG;AAAA,IACD;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AAGD,MAAI,sBAAsB,CAAC,QAAQ,CAAC,gBAAgB,SAAS,KAAK,QAAQ,IAAI;AAC5E,WAAO;AAAA,EACT;AACA,SACE,gBAAAN,SAAA,cAAC,UAAO,UAAQ,MAAC,IAAG,OAAM,SAAQ,YAAW,KAAK,EAAE,GAAG,cAAc,GAAG,SAAS,gBAAgB,OAC9F,oBAAoB,uBAAuB,MAC9C;AAEJ,CAAC;AAEM,IAAM,cAAc;AAAA,EACzB,aAAa;AAAA,IACX,QAAQ,SAAU,cAAc;AA3EpC,UAAAC;AA4EM,aAAO;AAAA,QACL,OAAO,IAAGA,MAAA,aAAa,SAAb,gBAAAA,IAAmB,IAAI;AAAA,QACjC,MAAM,gBAAAD,SAAA,cAACO,gBAAA,IAAc;AAAA,MACvB;AAAA,IACF;AAAA,IACA,UAAU,SAAU,eAAe;AACjC,aAAO;AAAA,QACL,OAAO,GAAG,cAAc,cAAc,SAAS,CAAC,EAAE,KAAK,IAAI,QAAQ,cAAc,SAAS,CAAC;AAAA,QAC3F,MAAM,gBAAAP,SAAA,cAACO,gBAAA,IAAc;AAAA,MACvB;AAAA,IACF;AAAA,EACF;AAAA,EACA,WAAW;AAAA,IACT,QAAQ,SAAU,cAAc;AAzFpC,UAAAN;AA0FM,aAAO;AAAA,QACL,OAAO,IAAGA,MAAA,aAAa,SAAb,gBAAAA,IAAmB,IAAI;AAAA,QACjC,MAAM,gBAAAD,SAAA,cAACQ,mBAAA,IAAiB;AAAA,MAC1B;AAAA,IACF;AAAA,IACA,UAAU,SAAU,eAAe;AACjC,aAAO;AAAA,QACL,OAAO,GAAG,cAAc,cAAc,SAAS,CAAC,EAAE,KAAK,IAAI,QAAQ,cAAc,SAAS,CAAC;AAAA,QAC3F,MAAM,gBAAAR,SAAA,cAACQ,mBAAA,IAAiB;AAAA,MAC1B;AAAA,IACF;AAAA,EACF;AAAA,EACA,YAAY;AAAA,IACV,QAAQ,kBAAgB;AAvG5B,UAAAP;AAwGM,aAAO;AAAA,QACL,OAAO,IAAGA,MAAA,aAAa,SAAb,gBAAAA,IAAmB,IAAI;AAAA,QACjC,MAAM,gBAAAD,SAAA,cAACS,WAAA,IAAS;AAAA,MAClB;AAAA,IACF;AAAA,IACA,UAAU,mBAAiB;AA7G/B,UAAAR;AA8GM,YAAM,QAAQ,IAAI,IAAI,cAAc,IAAI,kBAAa;AA9G3D,YAAAA;AA8G8D,gBAAAA,MAAA,aAAa,SAAb,gBAAAA,IAAmB;AAAA,OAAE,CAAC,EAAE;AAChF,aAAO;AAAA,QACL,OAAO,IAAGA,MAAA,cAAc,cAAc,SAAS,CAAC,EAAE,SAAxC,gBAAAA,IAA8C,IAAI,IAC1D,QAAQ,IAAI,OAAO,KAAK,YAAY,EACtC;AAAA,QACA,MAAM,gBAAAD,SAAA,cAACS,WAAA,IAAS;AAAA,MAClB;AAAA,IACF;AAAA,EACF;AAAA,EACA,gBAAgB;AAAA,IACd,QAAQ,kBAAgB;AAxH5B,UAAAR,KAAAC;AAyHM,aAAO;AAAA,QACL,OAAO,IAAGD,MAAA,aAAa,SAAb,gBAAAA,IAAmB,IAAI;AAAA,QACjC,MAAM,gBAAAD,SAAA,cAACS,WAAA,IAAS;AAAA,QAChB,QAAQ,gBAAAT,SAAA,cAAC,mBAAgB,KAAIE,MAAA,aAAa,SAAb,gBAAAA,IAAmB,IAAI;AAAA,MACtD;AAAA,IACF;AAAA,IACA,UAAU,mBAAiB;AA/H/B,UAAAD;AAgIM,YAAM,QAAQ,IAAI,IAAI,cAAc,IAAI,kBAAa;AAhI3D,YAAAA;AAgI8D,gBAAAA,MAAA,aAAa,SAAb,gBAAAA,IAAmB;AAAA,OAAE,CAAC,EAAE;AAChF,aAAO;AAAA,QACL,OAAO,IAAGA,MAAA,cAAc,cAAc,SAAS,CAAC,EAAE,SAAxC,gBAAAA,IAA8C,IAAI,IAC1D,QAAQ,IAAI,OAAO,KAAK,YAAY,EACtC;AAAA,QACA,MAAM,gBAAAD,SAAA,cAACS,WAAA,IAAS;AAAA,QAChB,QAAQ,gBAAAT,SAAA,cAAC,mBAAgB,mBAAmB,OAAO;AAAA,MACrD;AAAA,IACF;AAAA,EACF;AAAA,EACA,aAAa;AAAA,IACX,QAAQ,kBAAgB;AA3I5B,UAAAC;AA4IM,aAAO;AAAA,QACL,OAAO,qBAAoBA,MAAA,aAAa,SAAb,gBAAAA,IAAmB,UAAU;AAAA,QACxD,MAAM,gBAAAD,SAAA,cAACU,iBAAA,IAAe;AAAA,QACtB,QAAQ,gBAAAV,SAAA,cAAC,gBAAW;AAAA,MACtB;AAAA,IACF;AAAA,IACA,UAAU,mBAAiB;AACzB,aAAO;AAAA,QACL,OAAO,GAAG,cAAc,MAAM;AAAA,QAC9B,MAAM,gBAAAA,SAAA,cAACU,iBAAA,IAAe;AAAA,QACtB,QAAQ,gBAAAV,SAAA,cAAC,gBAAW;AAAA,MACtB;AAAA,IACF;AAAA,EACF;AAAA,EACA,aAAa;AAAA,IACX,QAAQ,YAAU;AAChB,aAAO;AAAA,QACL,OAAO,eAAe,SAAS,WAAW,WAAW;AAAA,QACrD,MAAM,gBAAAA,SAAA,cAAC,sBAAiB;AAAA,QACxB,SAAS;AAAA,QACT,UAAU;AAAA,MACZ;AAAA,IACF;AAAA,EACF;AAAA,EACA,cAAc;AAAA,IACZ,QAAQ,aAAW;AACjB,aAAO;AAAA,QACL,OAAO;AAAA,oCACqB,OAAO;AAAA;AAAA,QAEnC,MAAM,gBAAAA,SAAA,cAACW,uBAAA,IAAqB;AAAA,QAC5B,SAAS;AAAA,QACT,UAAU;AAAA,MACZ;AAAA,IACF;AAAA,EACF;AACF;;;AD7KO,IAAM,eAAe;AAAA,EAC1B,YAAY,oBAAI,IAAI;AAAA,EACpB,YAAY,CAAC;AAAA,EACb,kBAAkB,EAAE,cAAc,UAAU,KAAK,GAAG;AAClD,QAAI,mBAAmB;AACvB,QAAI,CAAC,MAAM;AACT,yBAAmB,aAAa;AAAA,IAClC;AACA,UAAM,YAAY,KAAK,WAAW,IAAI,gBAAgB;AACtD,QAAI,WAAW;AACb,UAAI,EAAE,cAAc,IAAI,KAAK,WAAW,IAAI,gBAAgB;AAC5D,YAAM,EAAE,GAAG,IAAI,KAAK,WAAW,IAAI,gBAAgB;AACnD,oBAAc,KAAK,YAAY;AAC/B,YAAM,cAAc,YAAY,gBAAgB,EAAE,SAAS,aAAa;AACxE,YAAM,UAAU,aAAa,aAAa,IAAI,iCACzC,cADyC;AAAA,QAE5C;AAAA,MACF,EAAC;AACD,WAAK,WAAW,IAAI,kBAAkB;AAAA,QACpC,IAAI;AAAA,QACJ;AAAA,QACA;AAAA,MACF,CAAC;AAAA,IACH,OAAO;AACL,YAAM,cAAc,YAAY,gBAAgB,EAAE,OAAO,YAAY;AACrE,YAAM,UAAU,aAAa,SAAS,iCACjC,cADiC;AAAA,QAEpC;AAAA,MACF,EAAC;AACD,UAAI,gBAAgB,CAAC;AACrB,oBAAc,KAAK,YAAY;AAC/B,WAAK,WAAW,IAAI,kBAAkB;AAAA,QACpC,IAAI;AAAA,QACJ,eAAe,CAAC,GAAG,aAAa;AAAA,QAChC;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AAAA,EACA,UAAU,EAAE,cAAc,WAAW,KAAM,KAAK,GAAG;AACjD,QAAI;AACF,UAAI,CAAC,KAAK,WAAW,aAAa,EAAE,GAAG;AACrC,aAAK,kBAAkB,EAAE,cAAc,UAAU,KAAK,CAAC;AAAA,MACzD;AACA,WAAK,WAAW,aAAa,EAAE,IAAI;AACnC,UAAI,OAAO,KAAK,KAAK,UAAU,EAAE,SAAS,KAAK;AAC7C,aAAK,aAAa,CAAC;AAAA,MACrB;AAAA,IACF,SAAS,KAAK;AACZ,cAAQ,MAAM,iBAAiB,GAAG;AAAA,IACpC;AAAA,EACF;AAAA,EACA,YAAY,kBAAkB;AAC5B,eAAW,CAAC,WAAW,SAAS,KAAK,KAAK,WAAW,QAAQ,GAAG;AAC9D,UAAI,CAAC,iBAAiB,KAAK,WAAS,MAAM,OAAO,UAAU,EAAE,GAAG;AAC9D,aAAK,WAAW,OAAO,SAAS;AAAA,MAClC;AAAA,IACF;AAAA,EACF;AACF;AAEA,aAAa,YAAY,aAAa,YAAY,KAAK,YAAY,CAAC;;;ADxC7D,IAAM,0BAA0B,MAAM;AAvB7C,MAAAC,KAAAC;AAwBE,QAAM,eAAeC,qBAAoBC,sBAAqB,kBAAkB;AAChF,QAAM,YAAYC,cAAYC,gBAAe;AAC7C,QAAM,eAAeC,qBAAmB;AACxC,QAAM,EAAE,aAAa,IAAI,gCAAgC,EAAE,YAAY,CAAC;AACxE,QAAM,gBAAgB,CAAC,CAAC,2BAA2B,yBAAyB,gBAAgB;AAC5F,QAAM,mBAAmBF,cAAYG,0BAAyB;AAC9D,QAAM,EAAE,iBAAiB,IAAIC,sBAAqB;AAClD,QAAM,WAAUP,OAAAD,MAAA,cAAc,MAAd,gBAAAA,IAAiB,SAAjB,gBAAAC,IAAuB;AAEvC,EAAAQ,YAAU,MAAM;AAjClB,QAAAT;AAkCI,QAAI,EAAC,6CAAc,OAAM;AACvB;AAAA,IACF;AAGA,QAAI,cAAcU,cAAa,aAAa,aAAa,KAAK,WAAW,CAAC,eAAe;AACvF;AAAA,IACF;AAEA,UAAM,oBAAoB,aAAa,SAASC,yBAAwB,aAAa,KAAK,EAAE,CAAC;AAC7F,UAAM,OAAO,aAAa,SAASC,gBAAe,aAAa,KAAK,EAAE,CAAC;AACvE,QAAI,mBAAmB;AACrB,YAAM,WAAU,6BAAM,eAAaZ,OAAA,6CAAc,oBAAmB,CAAC,MAAlC,gBAAAA,IAAsC,SAAS,KAAK;AACvF,mBAAa,UAAU,EAAE,cAAc,MAAM,UAAU,mBAAmB,aAAa,CAAC;AACxF,cAAQ,MAAM,oBAAoB,aAAa,IAAI;AAAA,IACrD;AAAA,EACF,GAAG,CAAC,eAAe,cAAc,cAAc,WAAW,YAAY,CAAC;AAEvE,EAAAa;AAAA,IACE,MAAM;AACJ,UAAI,EAAC,6CAAc,OAAM;AACvB;AAAA,MACF;AAGA,UAAI,cAAcH,cAAa,aAAa,aAAa,KAAK,WAAW,CAAC,eAAe;AACvF;AAAA,MACF;AAEA,YAAM,oBAAoB,aAAa,SAASC,yBAAwB,aAAa,KAAK,EAAE,CAAC;AAC7F,YAAM,OAAO,aAAa,SAASC,gBAAe,aAAa,KAAK,EAAE,CAAC;AACvE,YAAM,kBAAkB,aAAa,SAASE,sBAAqB;AACnE,UAAI,oBAAoB,mBAAmB;AACzC,cAAM,QAAQ,GAAG,6BAAM,IAAI,IACzB,gBAAgB,SAAS,IAAI,OAAO,gBAAgB,SAAS,CAAC,YAAY,EAC5E;AACA,yBAAiB,OAAO,EAAE,MAAM,QAAQ,CAAC;AAAA,MAC3C;AAAA,IACF;AAAA,IACA;AAAA,IACA,CAAC,eAAe,cAAc,WAAW,cAAc,gBAAgB;AAAA,EACzE;AACA,SAAO;AACT;;;AG7EA;AAAA,OAAOC,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C,SAAS,wBAAAC,uBAAsB,uBAAAC,4BAA2B;AAKnD,IAAM,iBAAiB,MAAM;AAClC,QAAM,eAAeC,qBAAoBC,sBAAqB,KAAK;AACnE,QAAM,CAAC,WAAW,YAAY,IAAIC,WAAS,KAAK;AAChD,QAAM,CAAC,MAAM,OAAO,IAAIA,WAAS,EAAE,OAAO,cAAc,aAAa,GAAG,CAAC;AAEzE,EAAAC,YAAU,MAAM;AACd,UAAMC,QAAO,6CAAc;AAC3B,QAAI,CAACA,SAAQA,MAAK,WAAW,QAAQ;AACnC;AAAA,IACF;AACA,QAAI;AACJ,QAAI;AACJ,QAAIA,MAAK,YAAY,SAAS,iBAAiB,GAAG;AAChD,oBAAc;AACd,cAAQ;AAAA,IACV,WAAWA,MAAK,YAAY,SAAS,oBAAoB,GAAG;AAC1D,cAAQ;AACR,oBACE;AAAA,IACJ,OAAO;AACL,oBAAcA,MAAK;AACnB,cAAQ;AAAA,IACV;AACA,YAAQ,EAAE,OAAO,YAAY,CAAC;AAC9B,iBAAa,IAAI;AAAA,EACnB,GAAG,CAAC,YAAY,CAAC;AAEjB,SACE,gBAAAC,SAAA,cAAC,eAAY,MAAM,WAAW,cAAc,cAAc,OAAO,KAAK,SACpE,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,WAAW,aAAa,KAC/C,KAAK,aAAY,KAAC,gBAAAA,SAAA,cAAC,UAAG,GAAE,kBACV,OAAO,SAAS,IACjC,CACF;AAEJ;;;ACzCA;AAAA,SAAS,aAAAC,mBAAiB;AAC1B,SAAS,wBAAAC,uBAAsB,uBAAAC,4BAA2B;AAQ1D,IAAM,oBAAoB,CAACC,sBAAqB,aAAaA,sBAAqB,SAAS;AAEpF,IAAM,oBAAoB,MAAM;AACrC,QAAM,eAAeC,qBAAoB,iBAAiB;AAC1D,QAAM,uBAAuB,2BAA2B,yBAAyB,WAAW;AAC5F,QAAM,uBAAuB,2BAA2B,yBAAyB,SAAS;AAC1F,QAAM,CAAC,cAAc,eAAe,IAAI,6BAA6B,cAAc,IAAI;AAEvF,EAAAC,YAAU,MAAM;AACd,QAAI,EAAC,6CAAc,OAAM;AACvB;AAAA,IACF;AAEA,YAAQ,MAAM,IAAI,aAAa,IAAI,KAAK,YAAY;AACpD,YAAQ,aAAa,MAAM;AAAA,MACzB,KAAKF,sBAAqB;AACxB,YAAI,CAAC,sBAAsB;AACzB;AAAA,QACF;AACA;AAAA,MACF,KAAKA,sBAAqB;AACxB,YAAI,aAAa,OAAO,aAAa,KAAK,IAAI;AAC5C,0BAAgB,CAAC,CAAC;AAAA,QACpB;AACA,YAAI,CAAC,sBAAsB;AACzB;AAAA,QACF;AACA;AAAA,MACF;AACE;AAAA,IACJ;AACA,iBAAa,UAAU,EAAE,aAAa,CAAC;AAAA,EACzC,GAAG,CAAC,cAAc,sBAAsB,sBAAsB,aAAa,IAAI,eAAe,CAAC;AAE/F,SAAO;AACT;;;AC5CA;AAAA,OAAOG,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C,SAAS,YAAAC,kBAAgB;AACzB,SAAuB,wBAAAC,uBAAsB,uBAAAC,4BAA2B;;;;;;;;;AASjE,SAAS,mCAAmC;AACjD,QAAM,eAAeC,qBAAoBC,sBAAqB,KAAK;AACnE,SAAO,gBAAAC,SAAA,cAAC,wBAAqB,OAAO,6CAAc,MAAM;AAC1D;AAEO,IAAM,uBAAuB,CAAC,EAAE,MAAM,MAAgC;AAC3E,QAAM,CAAC,YAAY,aAAa,IAAIC,WAAS,EAAE;AAC/C,QAAM,CAAC,eAAe,gBAAgB,IAAIA,WAAS,KAAK;AACxD,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,EAAAC,YAAU,MAAM;AACd,QACE,CAAC,UACA,+BAAO,UAAS,SAAQ,+BAAO,UAAS,SACxC,+BAAO,UAAS,SAAQ,+BAAO,QAAQ,SAAS,YACjD;AACA;AAAA,IACF;AACA,UAAM,eAAe,+BAAO;AAC5B,UAAM,WAAW,aAAa,SAAS,OAAO;AAC9C,UAAM,WAAW,aAAa,SAAS,OAAO;AAC9C,UAAM,YAAY,aAAa,SAAS,QAAQ;AAChD,QAAI,YAAY,UAAU;AACxB,oBAAc,uBAAuB;AAAA,IACvC,WAAW,UAAU;AACnB,oBAAc,YAAY;AAAA,IAC5B,WAAW,UAAU;AACnB,oBAAc,QAAQ;AAAA,IACxB,WAAW,WAAW;AACpB,oBAAc,QAAQ;AAAA,IACxB;AACA,qBAAiB,MAAM,SAAS,IAAI;AAAA,EACtC,GAAG,CAAC,KAAK,CAAC;AAEV,SAAO,aACL,gBAAAH,SAAA,cAAC,OAAO,MAAP,EAAY,MAAM,CAAC,CAAC,cACnB,gBAAAA,SAAA,cAAC,OAAO,QAAP,MACC,gBAAAA,SAAA,cAAC,OAAO,SAAP,IAAe,GAChB,gBAAAA,SAAA;AAAA,IAAC,OAAO;AAAA,IAAP;AAAA,MACC,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA;AAAA,QAEH,QAAQ;AAAA,MACV;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC,OAAO;AAAA,MAAP;AAAA,QACC,KAAK;AAAA,UACH,cAAc;AAAA,QAChB;AAAA;AAAA,MAEC,YAAY,QACX,gBAAAA,SAAA,cAAC,SAAI,OAAO,EAAE,UAAU,QAAQ,WAAW,OAAO,GAAG,KAAK,oBAAgB,KAAI,uBAAsB,IAClG;AAAA,MAGH,YAAY,YACX,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK;AAAA,UACL,OAAO,EAAE,UAAU,QAAQ,WAAW,OAAO;AAAA,UAC7C,KAAI;AAAA;AAAA,MACN,IACE;AAAA,MAEJ,gBAAAA,SAAA,cAAC,QAAK,SAAQ,QAAK,yBAAsB,UAAW;AAAA,IACtD;AAAA,IAEA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,MAAM,IAAI,OAAO,OAAO,qBAAqB,KAExE,YAAY,QACT,2HACA,MAGH,YAAY,YACT,2GACA,MAGH,CAAC,WAAW,aAAa,UAAU,mBAAmB,MAEtD,iBAAiB,CAAC,WACf,0BAA0B,UAAU,GAAG,eAAe,WAAW,UAAU,EAAE,yBAC7E,MACH,CAAC,iBAAiB,CAAC,WAChB,0BAA0B,UAAU,GAClC,eAAe,WAAW,UAAU,EACtC,2CACA,IACN;AAAA,IAGC,YAAY,QACX,gBAAAA,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,UAAO,SAAS,MAAM,OAAO,SAAS,OAAO,GAAG,KAAK,EAAE,GAAG,QAAQ,IAAI,KAAK,KAAG,QAE/E,GACA,gBAAAA,SAAA,cAAC,UAAO,UAAQ,MAAC,SAAQ,YAAW,SAAS,MAAM,cAAc,EAAE,GAAG,KAAK,EAAE,GAAG,OAAO,KAAG,iBAE1F,CACF,IACE;AAAA,IAEH,YAAY,YACX,gBAAAA,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,UAAO,SAAS,MAAM,cAAc,EAAE,GAAG,KAAK,EAAE,GAAG,QAAQ,IAAI,KAAK,KAAG,qBAExE,GACA,gBAAAA,SAAA,cAAC,UAAO,UAAQ,MAAC,SAAQ,YAAW,SAAS,MAAM,cAAc,EAAE,GAAG,KAAK,EAAE,GAAG,OAAO,KAAG,iBAE1F,CACF,IACE;AAAA,IAEH,CAAC,WACA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,OAAM,KAAK,EAAE,GAAG,OAAO,KACnC,gBAAAA,SAAA,cAAC,UAAO,UAAQ,MAAC,SAAQ,YAAW,SAAS,MAAM,cAAc,EAAE,KAAG,SAEtE,CACF,IACE;AAAA,EACN,CACF,CACF,IACE;AACN;;;ACvIA;AAAA,SAAS,aAAAI,aAAW,UAAAC,gBAAc;AAClC,SAAS,wBAAAC,uBAAsB,uBAAAC,4BAA2B;AAM1D,IAAMC,qBAAoB;AAAA,EACxBC,sBAAqB;AAAA,EACrBA,sBAAqB;AAAA,EACrBA,sBAAqB;AACvB;AACA,IAAI,iBAAgC;AAE7B,IAAM,yBAAyB,MAAM;AAC1C,QAAM,eAAeC,qBAAoBF,kBAAiB;AAC1D,QAAM,gBAAgBG,SAAO,CAAC;AAC9B,EAAAC,YAAU,MAAM;AAjBlB,QAAAC,KAAAC;AAkBI,QAAI,CAAC,cAAc;AACjB;AAAA,IACF;AACA,QAAI,aAAa,SAASL,sBAAqB,aAAa;AAC1D,uBAAiB,aAAa;AAAA,QAC5B;AAAA,QACA,YAAY,YAAY,OAAO,CAAC,MAAM,IAAI,EAAE,SAAS,cAAc,OAAO,CAAC;AAAA,MAC7E;AAAA,IACF,WAAW,aAAa,SAASA,sBAAqB,cAAc;AAClE,oBAAc,YAAUI,MAAA,aAAa,SAAb,gBAAAA,IAAmB,SAAQ;AACnD,uBAAiB,aAAa;AAAA,QAC5B;AAAA,QACA,YAAY,aAAa,QAAOC,MAAA,aAAa,SAAb,gBAAAA,IAAmB,OAAO;AAAA,MAC5D;AAAA,IACF;AAAA,EACF,GAAG,CAAC,YAAY,CAAC;AAEjB,SAAO;AACT;;;ACpCA;AAAA,OAAOC,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C;AAAA,EAEE,wBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,uBAAAC;AAAA,OACK;AACP,SAAS,aAAAC,kBAAiB;AAInB,IAAM,uBAAuB,MAAM;AACxC,QAAM,aAAaC,gBAAc;AACjC,QAAM,CAAC,kBAAkB,mBAAmB,IAAIC,WAAiD,IAAI;AACrG,QAAM,eAAeC,qBAAoB;AAAA,IACvCC,sBAAqB;AAAA,IACrBA,sBAAqB;AAAA,IACrBA,sBAAqB;AAAA,EACvB,CAAC;AAED,EAAAC,YAAU,MAAM;AACd,YAAQ,6CAAc,MAAM;AAAA,MAC1B,KAAKD,sBAAqB;AAAA,MAC1B,KAAKA,sBAAqB;AACxB,4BAAoB,IAAI;AACxB;AAAA,MACF,KAAKA,sBAAqB;AACxB,YAAI,6CAAc,KAAK,SAAS;AAC9B,8BAAoB,aAAa,IAAI;AAAA,QACvC;AACA;AAAA,MACF;AACE;AAAA,IACJ;AAAA,EACF,GAAG,CAAC,YAAY,CAAC;AAEjB,MAAI,CAAC,kBAAkB;AACrB,WAAO;AAAA,EACT;AAEA,QAAM,EAAE,aAAa,MAAM,QAAQ,QAAQ,IAAI;AAE/C,QAAM,QAAQ,IAAI,IAAI,OAAO,IAAI,WAAS,MAAM,IAAI,CAAC;AAErD,SACE,gBAAAE,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,MAAM,GAAG,6BAAM,IAAI,qCAAqC,MAAM,KAAK,KAAK,EAAE,KAAK,GAAG,CAAC;AAAA,MACnF,cAAc,CAAC,UAAmB,CAAC,SAAS,oBAAoB,IAAI;AAAA,MACpE,UAAU,MAAM;AACd,eAAO,QAAQ,WAAS;AACtB,qBAAW,gBAAgB,MAAM,IAAI,OAAO;AAAA,QAC9C,CAAC;AACD,4BAAoB,IAAI;AAAA,MAC1B;AAAA,MACA,MAAMC;AAAA;AAAA,EACR;AAEJ;;;AC1DA;AAAA,SAAS,aAAAC,mBAAiB;AAC1B,SAAS,wBAAAC,uBAAsB,uBAAAC,4BAA2B;AAE1D,IAAMC,qBAAoB;AAAA,EACxBF,sBAAqB;AAAA,EACrBA,sBAAqB;AAAA,EACrBA,sBAAqB;AAAA,EACrBA,sBAAqB;AACvB;AACO,IAAM,qBAAqB,MAAM;AACtC,QAAM,eAAeC,qBAAoBC,kBAAiB;AAC1D,EAAAH,YAAU,MAAM;AACd,QAAI,cAAc;AAChB,cAAQ,MAAM,IAAI,aAAa,IAAI,KAAK,YAAY;AAAA,IACtD;AAAA,EACF,GAAG,CAAC,YAAY,CAAC;AAEjB,SAAO;AACT;;;AClBA;AAAA,OAAOI,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C;AAAA,EAEE,wBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,uBAAAC;AAAA,OACK;AACP,SAAS,aAAAC,kBAAiB;AAInB,IAAM,mBAAmB,MAAM;AACpC,QAAM,aAAaC,gBAAc;AACjC,QAAM,eAAeC,qBAAoB;AAAA,IACvCC,sBAAqB;AAAA,IACrBA,sBAAqB;AAAA,IACrBA,sBAAqB;AAAA,EACvB,CAAC;AACD,QAAM,CAAC,kBAAkB,mBAAmB,IAAIC,WAA4C,IAAI;AAEhG,EAAAC,YAAU,MAAM;AACd,YAAQ,6CAAc,MAAM;AAAA,MAC1B,KAAKF,sBAAqB;AAAA,MAC1B,KAAKA,sBAAqB;AACxB,4BAAoB,IAAI;AACxB;AAAA,MACF,KAAKA,sBAAqB;AACxB,YAAI,6CAAc,KAAK,SAAS;AAC9B,8BAAoB,aAAa,IAAI;AAAA,QACvC;AACA;AAAA,MACF;AACE;AAAA,IACJ;AAAA,EACF,GAAG,CAAC,YAAY,CAAC;AAEjB,MAAI,CAAC,kBAAkB;AACrB,WAAO;AAAA,EACT;AAEA,QAAM,EAAE,aAAa,MAAM,OAAO,QAAQ,IAAI;AAE9C,SACE,gBAAAG,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAO,eAAe,MAAM,IAAI;AAAA,MAChC,cAAc,CAAC,UAAmB,CAAC,SAAS,oBAAoB,IAAI;AAAA,MACpE,MAAM,GAAG,6BAAM,IAAI,oCAAoC,+BAAO,IAAI;AAAA,MAClE,UAAU,MAAM;AACd,mBAAW,gBAAgB,MAAM,IAAI,OAAO;AAC5C,4BAAoB,IAAI;AAAA,MAC1B;AAAA,MACA,MAAMC;AAAA;AAAA,EACR;AAEJ;;;ACtDA;AAAA,OAAOC,YAAS,aAAAC,mBAAiB;AACjC,SAAS,SAAAC,eAAa;AACtB,SAAS,wBAAAC,wBAAsB,uBAAuB,uBAAAC,6BAA2B;AACjF,SAAS,qBAAAC,oBAAmB,qBAAAC,oBAAmB,mBAAAC,wBAAuB;AAO/D,IAAM,6BAA6B,MAAM;AAC9C,QAAM,eAAeC,sBAAoBC,uBAAqB,2BAA2B;AACzF,QAAM,CAAC,SAAS,UAAU,IAAI,mBAAmB,cAAc,YAAY;AAE3E,EAAAC,YAAU,MAAM;AACd,QAAI,EAAC,6CAAc,OAAM;AACvB;AAAA,IACF;AAEA,YAAQ,MAAM,IAAI,aAAa,IAAI,KAAK,YAAY;AACpD,UAAM,sBAAsB,aAAa;AACzC,QAAI,oBAAoB,SAAS,GAAG;AAClC,UAAI,KAAK;AACT,MAAAC,QAAM,EAAE,OAAO,oBAAoB,CAAC,EAAE,OAAO,OAAO,oBAAoB,CAAC,EAAE,MAAM,CAAC,EAC/E;AAAA,QACC,CAAC,EAAE,MAAM,MAAM,CAAC,CAAC;AAAA,QACjB,MAAM;AACJ,eAAK,aAAa,aAAa,SAAS;AAAA,YACtC,OAAO;AAAA,YACP,SAAS;AAAA,YACT,MAAM,gBAAAC,SAAA,cAACC,oBAAA,EAAkB,OAAO,EAAE,aAAa,SAAS,GAAG;AAAA,UAC7D,CAAC;AAAA,QACH;AAAA,MACF,EACC,KAAK,EAAE,OAAO,sBAAsB,QAAQ,GAAG,MAAM;AACpD,aAAK,aAAa,aAAa,SAAS;AAAA,UACtC,OAAO;AAAA,UACP,SAAS;AAAA,UACT,UAAU;AAAA,UACV,MAAM,gBAAAD,SAAA,cAACE,oBAAA,EAAkB,OAAO,EAAE,aAAa,SAAS,GAAG;AAAA,QAC7D,CAAC;AAAA,MACH,CAAC,EACA,KAAK,EAAE,OAAO,sBAAsB,QAAQ,GAAG,MAAM;AACpD,aAAK,aAAa,aAAa,SAAS;AAAA,UACtC,OAAO;AAAA,UACP,SAAS;AAAA,UACT,UAAU;AAAA,UACV,MAAM,gBAAAF,SAAA,cAACG,kBAAA,EAAgB,OAAO,EAAE,aAAa,SAAS,GAAG;AAAA,QAC3D,CAAC;AAAA,MACH,CAAC,EACA,UAAU,MAAM,IAAI;AACvB,iBAAW,EAAE;AAAA,IACf;AAAA,EAEF,GAAG,CAAC,cAAc,UAAU,CAAC;AAE7B,SAAO;AACT;;;AbjBA,IAAM,eAAuC,CAAC;AAEvC,SAAS,gBAAgB;AA1ChC,MAAAC,KAAAC;AA2CE,QAAM,cAAcC,cAAYC,mBAAiB;AACjD,QAAM,eAAeC,sBAAoB;AACzC,QAAM,0BAA0B,2BAA2B,KAAK,CAAC;AACjE,QAAM,YAAYF,cAAYG,iBAAe;AAC7C,QAAM,0BAA0B,oBAAoB;AACpD,QAAM,yBAAyB,0BAA0B;AACzD,QAAM,cAAc,gCAAgC;AACpD,QAAM,eAAeC,qBAAmB;AACxC,QAAM,iBAAiB,kBAAkB;AACzC,QAAM,EAAE,iBAAiB,IAAIC,sBAAqB;AAClD,QAAM,mBAAmBL,cAAYM,0BAAyB;AAC9D,QAAM,WAAUP,OAAAD,MAAA,cAAc,MAAd,gBAAAA,IAAiB,SAAjB,gBAAAC,IAAuB;AACvC,QAAM,EAAE,UAAU,IAAI,aAAa;AAEnC,QAAM,yBAAyBQ,cAAY,CAAC,YAAyD;AACnG,iBAAa,SAAS;AAAA,MACpB,OAAO,GAAG,QAAQ,QAAQ,oCAAoC,QAAQ,KAAK,IAAI;AAAA,MAC/E,SAAS;AAAA,IACX,CAAC;AAAA,EACH,GAAG,CAAC,CAAC;AAEL,EAAAC,gBAAe,EAAE,MAAM,sBAAsB,SAAS,uBAAuB,CAAC;AAE9E,EAAAC,YAAU,MAAM;AAlElB,QAAAX,KAAAC,KAAA,4CAAAW,KAAAC,KAAA;AAmEI,QAAI,CAAC,gBAAgB,wBAAwB;AAC3C;AAAA,IACF;AACA,YAAQ,aAAa,MAAM;AAAA,MACzB,KAAKC,uBAAqB;AACxB,gBAAQ,IAAI,aAAa,KAAK,KAAK,4BAA4B,aAAa,KAAK,IAAI;AACrF;AAAA,MACF,KAAKA,uBAAqB;AACxB,cAAId,MAAA,aAAa,SAAb,gBAAAA,IAAmB,iBAAcC,MAAA,aAAa,SAAb,gBAAAA,IAAmB,YAAW,QAAQ;AACzE,cAAI,CAAC,KAAK,IAAI,EAAE,UAAS,kBAAa,SAAb,mBAAmB,IAAI,GAAG;AACjD,yBAAa,SAAS;AAAA,cACpB,OAAO,WAAU,kBAAa,SAAb,mBAAmB,OAAO;AAAA,YAC7C,CAAC;AAAA,UACH,aAAW,kBAAa,SAAb,mBAAmB,aAAY,sBAAsB;AAC9D,yBAAa,SAAS;AAAA,cACpB,OAAO;AAAA,cACP,OAAO;AAAA,cACP,MACE,gBAAAc,SAAA,cAAC,OAAI,KAAK,EAAE,OAAO,uBAAuB,KACxC,gBAAAA,SAAA,cAACC,YAAA,IAAU,CACb;AAAA,YAEJ,CAAC;AAAA,UACH,OAAO;AACL,yBAAa,SAAS;AAAA,cACpB,SACE,kBAAa,SAAb,mBAAmB,YACnB;AAAA,cACF,OAAO;AAAA,YACT,CAAC;AAAA,UACH;AACA;AAAA,QACF;AAEA,cAAI,kBAAa,SAAb,mBAAmB,UAAS,UAAQ,kBAAa,SAAb,mBAAmB,UAAS,UAAQ,kBAAa,SAAb,mBAAmB,UAAS,MAAM;AAC5G;AAAA,QACF;AACA,cAAI,kBAAa,SAAb,mBAAmB,YAAW,QAAQ;AACxC;AAAA,QACF;AACA,YAAI,CAAC,wBAAwB;AAAO;AACpC,qBAAa,SAAS;AAAA,UACpB,OAAO,WAAU,kBAAa,SAAb,mBAAmB,OAAO,OAAM,kBAAa,SAAb,mBAAmB,WAAW;AAAA,QACjF,CAAC;AACD;AAAA,MACF,KAAKF,uBAAqB,cAAc;AACtC,cAAI,kBAAa,SAAb,mBAAmB,cAAWF,MAAA,aAAa,SAAb,gBAAAA,IAAmB,WAAU;AAC7D,uBAAa,SAAS;AAAA,YACpB,OAAO,iBAAiB,aAAa,KAAK,QAAQ;AAAA,UACpD,CAAC;AACD,6EAA0B,aAAa,KAAK;AAAA,QAC9C;AACA;AAAA,MACF;AAAA,MACA,KAAKE,uBAAqB;AACxB,cAAM,SAAQD,MAAA,aAAa,SAAb,gBAAAA,IAAmB;AACjC,YAAI,CAAC,aAAa,KAAK,SAAS;AAC9B,uBAAa,SAAS;AAAA,YACpB,OAAO,QAAQ,MAAM,MAAM,IAAI,MAAM,IAAI;AAAA,mBACnC,kBAAa,KAAK,gBAAlB,mBAA+B,IAAI;AAAA,UAC3C,CAAC;AAAA,QACH;AACA;AAAA,MACF,KAAKC,uBAAqB;AAAA,MAC1B,KAAKA,uBAAqB;AACxB,qBAAa,SAAS;AAAA,UACpB,OAAO,GAAG,aAAa,OAAO;AAAA,gBACxB,aAAa,KAAK,UAAU,WAAW,aAAa,KAAK,MAAM,EAAE;AAAA,QACzE,CAAC;AACD;AAAA,MACF,KAAKA,uBAAqB;AACxB,qBAAa,SAAS;AAAA,UACpB,OAAO,aAAa;AAAA,QACtB,CAAC;AACD;AAAA,MAEF,KAAKA,uBAAqB;AACxB,YAAI,aAAa,KAAK,cAAc,eAAe,YAAY,eAAe,sBAAsB;AAClG,gBAAM,gBAAgB,aAAa,SAASG,oBAAmB,aAAa,KAAK,SAAS,CAAC,KAAK;AAEhG,gBAAM,cAAc,aAAa,SAAS;AAAA,YACxC,OAAO,GAAG,aAAa,cAAc,aAAa,KAAK,IAAI,KAAK,aAAa,KAAK,KAAK;AAAA,YACvF,QACE,gBAAAF,SAAA;AAAA,cAAC;AAAA;AAAA,gBACC,SAAS,MAAM,eAAe,aAAa,KAAK,EAAE;AAAA,gBAClD,SAAQ;AAAA,gBACR,KAAK;AAAA,kBACH,iBAAiB;AAAA,kBACjB,YAAY;AAAA,kBACZ,OAAO;AAAA,kBACP,GAAG;AAAA,gBACL;AAAA;AAAA,cAEC,aAAa,KAAK,SAAS,SAAS,WAAW;AAAA,YAClD;AAAA,YAEF,UAAU;AAAA,UACZ,CAAC;AACD,uBAAa,aAAa,KAAK,EAAE,IAAI;AAAA,QACvC;AACA;AAAA,MACF,KAAKD,uBAAqB;AACxB,cAAM,SAAS,6CAAc,KAAK;AAClC,YAAI,WAAU,6CAAe,UAAS;AACpC,uBAAa,YAAY,6CAAe,aAAa,KAAK,GAAG;AAC7D,iBAAO,aAAa,6CAAc,KAAK,EAAE;AAAA,QAC3C;AACA;AAAA,MACF,KAAKA,uBAAqB;AACxB,YAAI,oBAAoB,GAAC,kBAAa,SAAb,mBAAmB,YAAW,CAAC,WAAW;AACjE,2BAAiB,oBAAoB,aAAa,KAAK,UAAU,IAAI;AAAA,YACnE,MAAM,aAAa,KAAK;AAAA,YACxB,MAAM;AAAA,UACR,CAAC;AAAA,QACH;AACA;AAAA,MACF;AACE;AAAA,IACJ;AAAA,EAEF,GAAG,CAAC,cAAc,wBAAwB,OAAO,wBAAwB,gBAAgB,CAAC;AAE1F,MAAI,wBAAwB;AAC1B,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,sBAAiB,GAClB,gBAAAA,SAAA,cAAC,0BAAqB,GACtB,gBAAAA,SAAA,cAAC,wBAAmB,GACnB,cAAcG,eAAa,YAAY,gBAAAH,SAAA,cAAC,uBAAkB,IAAK,MAChE,gBAAAA,SAAA,cAAC,4BAAuB,GACxB,gBAAAA,SAAA,cAAC,0BAAqB,GACtB,gBAAAA,SAAA,cAAC,sCAAiC,GAClC,gBAAAA,SAAA,cAAC,oBAAe,GAChB,gBAAAA,SAAA,cAAC,uBAAkB,GACnB,gBAAAA,SAAA,cAAC,6BAAwB,GACzB,gBAAAA,SAAA,cAAC,gCAA2B,CAC9B;AAEJ;;;AchNA;AAAA,OAAOI,YAAS,eAAAC,eAAa,WAAAC,WAAS,YAAAC,kBAAgB;AAO/C,IAAM,cAAc,CAAC,EAAE,SAAS,MAAwB;AAE7D,QAAM,cAAc,8BAA8B;AAGlD,QAAM,CAAC,WAAW,YAAY,IAAIC,WAAwB,IAAI;AAG9D,QAAM,iBAAiBC,cAAY,MAAM;AACvC,QAAI,aAAa,MAAM;AACrB,gBAAU,MAAM;AAChB,mBAAa,IAAI;AAAA,IACnB;AAAA,EACF,GAAG,CAAC,SAAS,CAAC;AAGd,QAAM,mBAAmBA;AAAA,IACvB,CAAO,OAAe,WAAmB;AAEvC,UAAI,aAAa,MAAM;AACrB;AAAA,MACF;AAEA,YAAM,MAAM,MAAM,OAAO,yBAAyB,cAAc;AAAA,QAC9D;AAAA,QACA;AAAA,MACF,CAAC;AAGD,UAAI,iBAAiB,YAAY,MAAM;AACrC,qBAAa,IAAI;AAAA,MACnB,CAAC;AAED,mBAAa,GAAG;AAAA,IAClB;AAAA,IACA,CAAC,SAAS;AAAA,EACZ;AAEA,QAAM,QAAQC,UAAQ,MAAM;AAC1B,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF,GAAG,CAAC,gBAAgB,aAAa,WAAW,gBAAgB,CAAC;AAE7D,SAAO,gBAAAC,SAAA,cAAC,WAAW,UAAX,EAAoB,SAAe,QAAS;AACtD;;;ACvDA;AAAA,OAAOC,cAAW;AAClB,SAAS,sBAAsB;AAWxB,IAAM,gBAAgB,MAAM;AAZnC,MAAAC,KAAAC,KAAA;AAaE,QAAM,EAAE,uBAAuB,IAAI,2BAA2B;AAC9D,QAAM,cAAc,CAAC;AACrB,QAAM,gBAAgB,eAAe,2BAA2B;AAChE,QAAM,EAAE,SAAS,IAAI,sBAAsB;AAC3C,QAAM,cAAc,aAAa,cAAc,SAAS;AACxD,QAAM,YAAY,aAAa;AAC/B,QAAM,aAAa,cAAc;AACjC,QAAM,EAAE,gBAAgB,gBAAgB,CAAC,EAAE,MAAI,MAAAA,OAAAD,MAAA,yCAAY,YAAZ,gBAAAA,IAAqB,YAArB,gBAAAC,IAA8B,YAA9B,mBAAuC,aAAY,CAAC;AAEnG,SACE,gBAAAC,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,MAAM,OAAO,KAC3C,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK,EAAE,MAAM,SAAS,UAAU,YAAY,WAAW,QAAQ,OAAO,mBAAmB;AAAA,MACzF,SAAQ;AAAA,MACR,OAAM;AAAA;AAAA,IAEL,aAAa,OAAO,KAAK,aAAa,EAAE,SAAS,IAChD,gBAAAA,SAAA,cAAC,uBAAY,aAA0B,aAA0B,QAAQ,wCAAiB,QAAW,IAErG,gBAAAA,SAAA,cAAC,8BAAiB;AAAA,EAEtB,CACF;AAEJ;;;ACrCA;AAAA,OAAOC,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C,SAAS,2BAAAC,2BAAyB,eAAAC,qBAAmB;;;ACDrD;AAAA,OAAOC,cAAW;AAGX,IAAMC,SAAQ,CAACC,QAAuF;AAAvF,MAAAC,MAAAD,KAAE,SAAO,aAAa,QAAQ,MAAM,MAAM,UAAU,cAAc,KAHxF,IAGsBC,KAA2E,kBAA3EA,KAA2E,CAAzE,SAAO,eAAa,SAAc,QAAM,YAAU,gBAAc;AACtF,SACE,gBAAAC,SAAA;AAAA,IAAC,MAAe;AAAA,IAAf;AAAA,MACC;AAAA,MACA;AAAA,MACA;AAAA,MACA,YAAY;AAAA,MACZ;AAAA,MACA,UAAU,CAAC,QAAQ,MAAS;AAAA,MAC5B;AAAA,OACI;AAAA,EACN;AAEJ;;;ADTO,IAAM,iBAAiB,MAAM;AAClC,QAAM,cAAcC,cAAYC,yBAAuB;AACvD,QAAM,CAAC,QAAQ,QAAQ,IAAIC,WAAS,CAAC,CAAC;AACtC,EAAAC,YAAU,MAAM;AACd,iBAAa,YAAY,QAAQ;AACjC,WAAO,MAAM;AACX,mBAAa,eAAe,QAAQ;AAAA,IACtC;AAAA,EACF,GAAG,CAAC,CAAC;AACL,SACE,gBAAAC,SAAA,cAAC,MAAe,UAAf,EAAwB,gBAAe,QAAO,UAAU,OACtD,OAAO,MAAM,GAAG,UAAU,EAAE,IAAI,WAAS;AACxC,WAAO,gBAAAA,SAAA,cAACC,QAAA,+BAAM,KAAK,MAAM,MAAQ,QAAzB,EAAgC,cAAc,WAAS,CAAC,SAAS,aAAa,YAAY,MAAM,EAAE,IAAG;AAAA,EAC/G,CAAC,GACD,gBAAAD,SAAA;AAAA,IAAC,MAAe;AAAA,IAAf;AAAA,MACC,KAAK;AAAA,QACH,UAAU;AAAA,SACN,CAAC,cAAc,CAAC,IAAI,EAAE,QAAQ,MAAM;AAAA;AAAA,EAE5C,CACF;AAEJ;;;AE7BA;AAAA,OAAOE,cAAW;AAClB,SAAS,iBAAAC,iBAAe,eAAAC,qBAAmB;;;ACD3C;AAAA,OAAOC,cAAW;AAClB,SAAS,aAAAC,mBAAiB;AAWnB,IAAM,mBAAmB,MAAM;AACpC,QAAM,EAAE,OAAO,aAAa,QAAQ,IAAI,oBAAoB;AAC5D,QAAM,cAAc,eAAe,cAAc,YAAY;AAC7D,QAAM,uBAAuB,mBAAmB,cAAc,YAAY;AAC1E,SACE,gBAAAC,SAAA,cAAC,MAAM,MAAN,EAAW,MAAM,sBAAsB,cAAc,eACpD,gBAAAA,SAAA,cAAC,MAAM,SAAN,EAAc,KAAK,EAAE,IAAI,MAAM,IAAI,MAAM,KACxC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,OAAM;AAAA,MACN,KAAK,EAAE,GAAG,QAAQ,cAAc,4BAA4B,IAAI,MAAM,IAAI,MAAM,IAAI,KAAK;AAAA;AAAA,IAEzF,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,YAAY,aAAa,OAAO,mBAAmB,KAAG,aAAW;AAAA,IAC9E,gBAAAA,SAAA,cAAC,MAAM,OAAN,EAAY,KAAK,EAAE,OAAO,mBAAmB,KAC5C,gBAAAA,SAAA,cAACC,aAAA,IAAU,CACb;AAAA,EACF,GACA,gBAAAD,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,GAAG,QAAQ,KAAK,MAAM,IAAI,MAAM,IAAI,KAAK,KACnE,gBAAAA,SAAA,cAAC,UAAK,GACN,gBAAAA,SAAA,cAAC,WACC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,sBAAsB,YAAY,YAAY,KACxE,KACH,GACA,gBAAAA,SAAA,cAAC,kBAAe,SAAkB,CACpC,CACF,GACA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,OAAO,sBAAsB,IAAI,KAAK,KAC7D,WACH,CACF,CACF;AAEJ;;;ADtCO,IAAME,SAAQ,MAAM;AACzB,QAAM,QAAQC,cAAYC,gBAAc,SAAS,KAAK,CAAC;AACvD,MAAI;AACJ,MAAI,UAAU,cAAc,cAAc;AACxC,oBAAgB,gBAAAC,SAAA,cAAC,sBAAiB;AAAA,EACpC;AACA,SAAO,gBAAAA,SAAA,cAAC,WAAK,aAAc;AAC7B;;;AEbA;AAAA,OAAOC,YAAS,eAAAC,eAAa,aAAAC,aAAW,WAAAC,WAAS,YAAAC,kBAAgB;AACjE,SAAS,YAAAC,kBAAgB;AACzB;AAAA,EACE,qBAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,sBAAAC;AAAA,OACK;AAMP,IAAI,aAAa;AAEjB,IAAM,aAAa,UAAU;AAAA,EAC3B,OAAO,EAAE,SAAS,EAAE;AAAA,EACpB,QAAQ,EAAE,QAAQ,OAAO,SAAS,EAAE;AACtC,CAAC;AAED,IAAM,kBAAkB,UAAU;AAAA,EAChC,MAAM,EAAE,YAAY,QAAQ;AAAA,EAC5B,QAAQ,EAAE,YAAY,OAAO;AAC/B,CAAC;AAED,IAAM,kBAAkB,UAAU;AAAA,EAChC,MAAM,EAAE,YAAY,OAAO;AAAA,EAC3B,QAAQ,EAAE,YAAY,QAAQ;AAChC,CAAC;AAED,IAAM,oBAAoB,cAAY;AACpC,MAAI,MAAM,CAAC;AACX,QAAM,MAAM;AACZ,QAAM,MAAM,WAAW,KAAK;AAC5B,QAAM,MAAM,WAAW,IAAI;AAC3B,WAAS,IAAI,KAAK,KAAK,KAAK,KAAK,KAAK;AACpC,QAAI,KAAK,CAAC;AAAA,EACZ;AACA,SAAO;AACT;AAEO,SAAS,cAAc;AAC5B,QAAM,cAAcC,cAAYC,mBAAiB;AACjD,QAAM,eAAeC,qBAAmB;AACxC,QAAM,aAAaC,gBAAc;AACjC,QAAM,CAAC,QAAQ,SAAS,IAAIC,WAAS,CAAC,CAAC;AACvC,QAAM,WAAWC,WAAS,OAAU,MAAM,EAAE;AAC5C,QAAM,cAAcL,cAAYM,kBAAiB;AAEjD,QAAM,iBAAiBC,UAAQ,MAAM,kBAAkB,QAAQ,GAAG,CAAC,QAAQ,CAAC;AAE5E,QAAM,kBAAkBC;AAAA,IACtB,CAAO,OAA0B,eAA1B,KAA0B,WAA1B,EAAE,SAAS,SAAS,GAAM;AAC/B,UAAI,CAAC,WAAW,CAAC,YAAY,SAAS,QAAQ;AAC5C;AAAA,MACF;AACA,UAAI,iBAAiB,aAAa,SAASC,oBAAmB,QAAQ,CAAC;AACvE,UAAI,CAAC,kBAAkB,aAAa;AAClC,cAAM,SAAS,MAAM,WAAW,QAAQ,QAAQ;AAChD,yBAAiB,iCAAQ;AAAA,MAC3B;AACA,YAAM,aAAa,gBAAgB,WAAW,QAAQ;AACtD,YAAM,gBAAgB,eAAe,aAAa,eAAe,MAAM;AACvE,YAAM,KAAK;AAEX,gBAAU,CAAAC,YAAU;AAClB,eAAO;AAAA,UACL,GAAGA;AAAA,UACH;AAAA,YACE;AAAA,YACA;AAAA,YACA,YAAY;AAAA,YACZ,eAAe,GAAG,aAAa;AAAA,YAC/B,YAAY,KAAK,OAAO,IAAI,MAAM,IAAI;AAAA,UACxC;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH;AAAA,IACA,CAAC,cAAc,aAAa,aAAa,gBAAgB,UAAU;AAAA,EACrE;AAEA,EAAAC,gBAAe;AAAA,IACb,MAAM;AAAA,IACN,SAAS;AAAA,EACX,CAAC;AAED,EAAAC,YAAU,MAAM;AACd,WAAO,kBAAkB;AAAA,EAC3B,GAAG,CAAC,eAAe,CAAC;AAEpB,SACE,gBAAAC,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,UAAU;AAAA,QACV,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,QACN,OAAO;AAAA,QACP,UAAU;AAAA,QACV,eAAe;AAAA,QACf,YAAY;AAAA,QACZ,QAAQ;AAAA,MACV;AAAA;AAAA,IAEC,OAAO,IAAI,WAAS;AACnB,aACE,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,KAAK,MAAM;AAAA,UACX,KAAK;AAAA,YACH,MAAM,MAAM;AAAA,YACZ,eAAe;AAAA,YACf,YAAY;AAAA,YACZ,UAAU;AAAA,YACV,QAAQ;AAAA,YACR,WAAW,GAAG,WAAW,CAAC,iBACxB,MAAM,eAAe,IAAI,gBAAgB,IAAI,gBAAgB,CAC/D;AAAA,UACF;AAAA,UACA,gBAAgB,MAAM,UAAU,OAAO,OAAO,UAAQ,KAAK,OAAO,MAAM,EAAE,CAAC;AAAA;AAAA,QAE3E,gBAAAA,SAAA,cAAC,WACC,gBAAAA,SAAA,cAAC,cAAS,IAAI,MAAM,SAAS,MAAK,QAAO,KAAI,SAAQ,CACvD;AAAA,QACC,MAAM,aACL,gBAAAA,SAAA;AAAA,UAAC;AAAA;AAAA,YACC,KAAK;AAAA,cACH,OAAO;AAAA,cACP,SAAS;AAAA,cACT,YAAY;AAAA,cACZ,cAAc;AAAA,YAChB;AAAA;AAAA,UAEA,gBAAAA,SAAA;AAAA,YAAC;AAAA;AAAA,cACC,KAAK;AAAA,gBACH,UAAU;AAAA,gBACV,YAAY;AAAA,gBACZ,OAAO;AAAA,cACT;AAAA;AAAA,YAEC,MAAM;AAAA,UACT;AAAA,QACF,IAEA;AAAA,MAEJ;AAAA,IAEJ,CAAC;AAAA,EACH;AAEJ;;;ACzJA;AAAA,OAAOC,YAAS,eAAAC,qBAAmB;AACnC,SAAS,kBAAAC,iBAAgB,iBAAAC,uBAAqB;AAGvC,SAAS,wBAAwB;AACtC,QAAM,UAAUC,gBAAc;AAE9B,QAAM,0BAA0BC,cAAY,MAAY;AACtD,UAAM,QAAQ,sBAAsB,KAAK;AAAA,EAC3C,IAAG,CAAC,OAAO,CAAC;AAEZ,EAAAC,gBAAe;AAAA,IACb,MAAM;AAAA,IACN,SAAS;AAAA,EACX,CAAC;AAED,SAAO,gBAAAC,SAAA,cAAAA,SAAA,cAAE;AACX;;;ACjBA;AAAA,SAAS,eAAAC,eAAa,aAAAC,aAAW,UAAAC,gBAAc;AAC/C;AAAA,EACE,2BAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,yBAAAC;AAAA,OACK;AAQA,IAAM,wBAAwB,MAAM;AACzC,QAAM,CAAC,cAAc,aAAa,IAAI,mBAAmB,SAAS,UAAU;AAC5E,QAAM,cAAcC,cAAYC,mBAAiB;AACjD,QAAM,kBAAkB,mBAAmB;AAC3C,QAAM,aAAaC,gBAAc;AACjC,QAAM,cAAcF,cAAYG,yBAAuB;AACvD,QAAM,EAAE,cAAc,eAAe,kBAAkB,qBAAqB,IAAIC,wBAAsB;AACtG,QAAM,mBAAmBC,SAAO,KAAK;AAErC,QAAM,WAAWC,cAAY,MAAY;AACvC,QAAI;AACF,UACE,gBACA,CAAC,mBACD,gBACA,iBACA,oBACA,sBACA;AACA;AAAA,MACF;AACA,oBAAc,IAAI;AAClB,uBAAiB,UAAU;AAC3B,YAAM,WAAW,kBAAkB;AAAA,IACrC,SAAS,OAAO;AACd,cAAQ,MAAM,KAAK;AACnB,uBAAiB,UAAU;AAC3B,oBAAc,KAAK;AAAA,IACrB;AAAA,EACF,IAAG;AAAA,IACD;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AAED,EAAAC,YAAU,MAAM;AACd,QAAI,CAAC,gBAAgB,CAAC,cAAc;AAClC,uBAAiB,UAAU;AAAA,IAC7B;AAAA,EACF,GAAG,CAAC,cAAc,YAAY,CAAC;AAE/B,EAAAA,YAAU,MAAM;AACd,QAAI,CAAC,eAAe,iBAAiB,WAAW,EAAC,2CAAa,eAAc;AAC1E;AAAA,IACF;AAEA,aAAS;AAAA,EAEX,GAAG,CAAC,WAAW,CAAC;AAClB;;;ArZgBO,IAAM,cAAcC,SAAM;AAAA,EAC/B,CACE;AAAA,IACE,WAAW;AAAA,IACX,YAAY;AAAA,IACZ,oBAAoB;AAAA,IACpB;AAAA,IACA;AAAA,IACA;AAAA,IACA,SAAS,EAAE,WAAW,IAAI,SAAS,IAAI,UAAU,IAAI,CAAC;AAAA,IACtD;AAAA,IACA,gBAAgB;AAAA,IAChB;AAAA,IACA;AAAA,EACF,GACA,QACG;AArGP,QAAAC,KAAAC,KAAA;AAsGI,UAAM,gBAAgBC,SAA2B;AACjD,UAAM,CAAC,UAAU,WAAW,IAAIH,SAAM,SAAS,KAAK;AAEpD,IAAAI,YAAU,MAAM;AACd,kBAAY,IAAI;AAChB,YAAM,MAAM,IAAI,iBAAiB;AACjC,YAAM,WAAW,IAAI,SAAS;AAC9B,YAAM,aAAa,IAAI,WAAW;AAClC,YAAM,mBAAmB,IAAI,iBAAiB;AAC9C,YAAM,WAAW,IAAI,SAAS;AAC9B,UAAI,mBAAmB;AAEvB,oBAAc,UAAU;AAAA,QACtB;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF,GAAG,CAAC,CAAC;AAEL,IAAAA,YAAU,MAAM;AACd,UAAI,CAAC,OAAO,CAAC,cAAc,SAAS;AAClC;AAAA,MACF;AACA,MAAC,IAA6C,UAAU,mBAAK,cAAc;AAAA,IAC7E,GAAG,CAAC,GAAG,CAAC;AAER,IAAAA,YAAU,MAAM;AAEd,aAAO,MAAM;AAnInB,YAAAH;AAoIQ,kBAAU,MAAM;AAChB,SAAAA,MAAA,+CAAe,YAAf,gBAAAA,IAAwB,WAAW;AAAA,MACrC;AAAA,IACF,GAAG,CAAC,CAAC;AAEL,UAAM,eAAe;AAQrB,UAAM,2BAAkC,6CAAc,oBAAmB;AACzE,UAAM,gBAAuB,6CAAc,SAAQ;AACnD,UAAM,iBAAwB,6CAAc,UAAS;AACrD,UAAM,sBAA6B,6CAAc,eAAc;AAE/D,UAAM,iBAAkC;AAAA,MACtC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAEA,QAAI,CAAC,YAAY,CAAC,WAAW;AAC3B,cAAQ,MAAM;AAAA;AAAA;AAAA;AAAA,SAIX;AACH,YAAM,MAAM,yDAAyD;AAAA,IACvE;AAEA,QAAI,CAAC,UAAU;AACb,aAAO;AAAA,IACT;AAEA,iBAAa;AAEb,WACE,gBAAAD,SAAA,cAAC,qBACC,gBAAAA,SAAA;AAAA,MAAC,mBAAmB;AAAA,MAAnB;AAAA,QACC,OAAO;AAAA,UACL;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA,WAAW;AAAA,YACT,iBAAiB;AAAA,YACjB,MAAM;AAAA,YACN,YAAY;AAAA,YACZ,OAAO;AAAA,UACT;AAAA,QACF;AAAA;AAAA,MAEA,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC,cAAc,aAAa;AAAA,UAC3B,UAASC,MAAA,cAAc,YAAd,gBAAAA,IAAuB;AAAA,UAChC,QAAOC,MAAA,cAAc,YAAd,gBAAAA,IAAuB;AAAA,UAC9B,gBAAe,mBAAc,YAAd,mBAAuB;AAAA,UACtC,QAAO,mBAAc,YAAd,mBAAuB;AAAA,UAC9B;AAAA;AAAA,QAEA,gBAAAF,SAAA,cAAC,sBAAmB,oBAAwC,kBAC1D,gBAAAA,SAAA,cAAC,kBAAkB,UAAlB,MACE,CAAAK,UAAQ;AAxMzB,cAAAJ;AAyMkB,gBAAM,SAASI,SAAA,gBAAAA,MAAM;AACrB,gBAAMC,WAAeL,MAAA,iCAAQ,WAAR,gBAAAA,IAAiB,OAAO,CAAC;AAC9C,gBAAM,EAAE,YAAAM,YAAW,IAAI,UAAU,CAAC;AAClC,cAAI,aAAa,CAAC,YAAY;AAC9B,cAAIA,eAAA,gBAAAA,YAAY,aAAa;AAC3B,yBAAa,CAAC,GAAGA,eAAA,gBAAAA,YAAY,WAAW,IAAI,GAAG,UAAU;AAAA,UAC3D;AAEA,iBACE,gBAAAP,SAAA;AAAA,YAAC;AAAA;AAAA,cAIC,WAAW,GAAGM,OAAM,IAAI,IAAI,KAAK,IAAI,CAAC;AAAA,cACtC,OAAO;AAAA;AAAA,gBAEL,QAAQA,OAAM;AAAA,gBACd,OAAO;AAAA;AAAA,kBAEL,MAAM;AAAA,gBACR;AAAA,cACF;AAAA;AAAA,YAEA,gBAAAN,SAAA,cAAC,mBACC,gBAAAA,SAAA,cAAC,UAAK,GACN,gBAAAA,SAAA,cAAC,2BAAwB,yBAAyB,qBAChD,gBAAAA,SAAA;AAAA,cAAC;AAAA;AAAA,gBACC,WAAW,yBAAyB,MAAM,CAAC;AAAA,gBAC3C,KAAK;AAAA,kBACH,IAAI;AAAA,kBACJ,MAAM;AAAA,kBACN,YAAY;AAAA,kBACZ,4BAA4B;AAAA,kBAC5B,UAAU;AAAA,gBACZ;AAAA;AAAA,cAEA,gBAAAA,SAAA;AAAA,gBAAC;AAAA;AAAA,kBACC,6BAA6B;AAAA,kBAC7B,kBAAkB;AAAA;AAAA,cACpB;AAAA,YACF,CACF,CACF;AAAA,UACF;AAAA,QAEJ,CACF,CACF;AAAA,MACF;AAAA,IACF,CACF;AAAA,EAEJ;AACF;AAEA,YAAY,cAAc;AAE1B,IAAM,YAAY,CAAC,EAAE,YAAY,MAAuC;AACtE,QAAM,EAAE,uBAAuB,IAAI,2BAA2B;AAC9D,QAAM,EAAE,qBAAqB,IAAI,yBAAyB;AAC1D,wBAAsB;AAEtB,SAAOQ,QAAM,EAAE,aAAa,wBAAwB,qBAAqB,CAAC,EACvE,KAAK,EAAE,sCAAqC,wBAAwB,KAAK,GAAG,MAAM,gBAAAR,SAAA,cAAC,mBAAc,CAAE,EACnG,KAAK,EAAE,kCAAmC,sBAAsB,KAAK,GAAG,MAAM,gBAAAA,SAAA,cAAC,iBAAY,CAAE,EAC7F,UAAU,MAAM,gBAAAA,SAAA,cAAC,sBAAiB,CAAE;AACzC;AAEA,IAAM,YAAY,MAAM;AACtB,QAAM,oBAAoBS,cAAYC,yBAAuB;AAC7D,QAAM,aAAaC,gBAAc;AACjC,EAAAP,YAAU,MAAM;AACd,UAAM,eAAe,MAAY;AAC/B,UAAI,mBAAmB;AACrB,cAAM,WAAW,MAAM;AAAA,MACzB;AAAA,IACF;AACA,WAAO,iBAAiB,YAAY,YAAY;AAChD,WAAO,MAAM;AACX,aAAO,oBAAoB,YAAY,YAAY;AAAA,IACrD;AAAA,EACF,GAAG,CAAC,YAAY,iBAAiB,CAAC;AAClC,SAAO;AACT;AAEA,SAAS,UAAU;AAAA,EACjB;AAAA,EACA;AACF,GAGG;AACD,QAAM,aAAa,cAAc;AACjC,QAAM,0BAA0B,0BAA0B;AAC1D,QAAM,EAAE,aAAa,OAAO,IAAI,mBAAmB;AACnD,SACE,gBAAAJ,SAAA,cAAC,gBAAgB,UAAhB,EAAyB,OAAO,EAAE,OAAO,KACxC,gBAAAA,SAAA,cAAAA,SAAA,gBACG,uCAAwC,gBAAAA,SAAA,cAAC,aAAQ,GAClD,gBAAAA,SAAA,cAAC,oBAAe,GAChB,gBAAAA,SAAA,cAAC,mBAAc,GACf,gBAAAA,SAAA,cAAC,yBAAoB,GACrB,gBAAAA,SAAA,cAACY,QAAA,IAAM,GACP,gBAAAZ,SAAA,cAAC,eAAU,GACV,CAAC,2BAA2B,gBAAAA,SAAA,cAAC,iBAAY,GAC1C,gBAAAA,SAAA,cAAC,2BAAsB,GACvB,gBAAAA,SAAA,cAAC,qBAAgB,GACjB,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA;AAAA,MACA;AAAA;AAAA,EACF,GACC,cAAc,eAAe,gBAAAA,SAAA,cAAC,aAAU,aAA0B,CACrE,CACF;AAEJ;;;AsZ7TA;AAAA,SAAS,aAAAa,YAAW,QAAAC,cAAY;AAGhC,IAAM,kBAAkB,OAAOC,YAAW,EAAE,GAAG,MAAM,iBAAiB,mBAAmB,CAAC;AAE1F,IAAMC,cAAa,OAAOC,QAAM;AAAA,EAC9B,GAAG;AAAA,EACH,GAAG;AAAA,EACH,cAAc;AAAA,EACd,iBAAiB;AAAA,EACjB,UAAU;AACZ,CAAC;AAEM,IAAM,WAAW;AAAA,EACtB,MAAMD;AAAA,EACN,SAAS;AACX;;;AChBA;;;ACAA;AAAA,OAAOE,YAAS,eAAAC,eAAa,UAAAC,UAAQ,YAAAC,kBAAgB;AACrD,SAAS,mBAAAC,kBAAiB,iBAAAC,uBAAqB;AAC/C;AAAA,EACE,mBAAAC;AAAA,EACA,oBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA;AAAA,EACA,aAAAC;AAAA,EACA,eAAAC;AAAA,OACK;;;ACTP;AACA,OAAOC,YAAS,eAAAC,eAAa,aAAAC,aAAW,YAAAC,kBAAgB;AACxD;AAAA,EAEE;AAAA,EACA,2BAAAC;AAAA,EACA;AAAA,EACA,wBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,aAAAC,YAAW,eAAAC,cAAa,YAAAC,iBAAgB;;;ACXjD;AAAA,OAAOC,cAAW;;;ACAlB;AAAA,OAAOC,YAAS,cAAAC,mBAAkB;AAG3B,IAAK,kBAAL,kBAAKC,qBAAL;AACL,EAAAA,kCAAA;AACA,EAAAA,kCAAA;AACA,EAAAA,kCAAA;AACA,EAAAA,kCAAA;AAJU,SAAAA;AAAA,GAAA;AAOL,IAAM,eAAe;AAAA,EAC1B,CAAC,eAAuB,GAAG,EAAE,MAAM,kBAAkB;AAAA,EACrD,CAAC,aAAqB,GAAG,EAAE,MAAM,aAAa;AAAA,EAC9C,CAAC,aAAqB,GAAG,EAAE,MAAM,aAAa;AAAA,EAC9C,CAAC,oBAA4B,GAAG,EAAE,MAAM,qBAAqB;AAC/D;AAQO,IAAM,qBAAqBC,SAAM,cAMrC;AAAA,EACD,iBAAiB;AAAA,EACjB,eAAe,MAAM;AACnB;AAAA,EACF;AAAA,EACA,OAAO;AAAA,EACP,YAAY,MAAM;AAChB;AAAA,EACF;AACF,CAAC;AAEM,IAAM,iBAAiB,MAAM;AAClC,QAAM,UAAUC,YAAW,kBAAkB;AAC7C,QAAM,aAAa,QAAQ,MAAM,QAAQ,eAAe;AAExD,SAAO,iCAAK,UAAL,EAAc,WAAW;AAClC;;;ADtCO,IAAM,gBAAgB,CAAC,EAAE,KAAAC,MAAK,SAAS,MAAgD;AAC5F,SAAO,gBAAAC,SAAA,cAAC,OAAI,KAAK,iBAAE,GAAG,SAAUD,SAAQ,QAAS;AACnD;AAEO,IAAM,aAAa,CAAC;AAAA,EACzB;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,EAAE,gBAAgB,iBAAiB,YAAY,cAAc,IAAI,eAAe;AAEtF,QAAM,aAAa,MAAM;AACvB,QAAI,8BAAsC;AACxC,uDAAgB;AAAA,IAClB,WAAW,8BAAsC;AAC/C,uDAAgB;AAAA,IAClB,WAAW,qCAA6C;AACtD,uDAAgB;AAAA,IAClB;AAEA,kBAAc,UAAQ,OAAO,CAAC;AAAA,EAChC;AAEA,SACE,gBAAAC,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,YAAY;AAAA,QACZ,gBAAgB;AAAA,QAChB,YAAY;AAAA,QACZ,WAAW;AAAA,QACX,UAAU;AAAA,QACV,wBAAwB;AAAA,QACxB,yBAAyB;AAAA,QACzB,YAAY;AAAA,QACZ,QAAQ;AAAA,QACR,OAAO,EAAE,eAAe,UAAU,KAAK,KAAK;AAAA,MAC9C;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,WAAK,SAAS,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,uBAAuB,KAAG,WAAQ,MAAM,OAAQ,CAAQ;AAAA,IACtF,WACC,WAEA,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,KAAK,MAAM,OAAO,EAAE,eAAe,SAAS,EAAE,KACxE,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,qBAAqB,KAAI,OAAQ,GACjD,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAI,OACvB,gBAAAA,SAAA,cAAC,UAAO,SAAS,YAAY,SAAQ,YAAW,UAAU,QAAM,MAEhE,GACA,gBAAAA,SAAA,cAAC,UAAO,UAAU,CAAC,CAAC,OAAO,SAAS,cAAY,KAEhD,CACF,CACF;AAAA,EAEJ;AAEJ;;;AErEA;AACA,wBAAsB;AADtB,OAAOC,YAAS,UAAAC,UAAQ,YAAAC,kBAAgB;AAOjC,IAAMC,kBAAiB,CAAC,EAAE,OAAO,SAAS,WAAW,UAAU,MAAM,WAAW,KAAK,MAAM;AAPlG,MAAAC,KAAAC;AAQE,QAAM,CAAC,MAAM,OAAO,IAAIC,WAAS,KAAK;AACtC,QAAM,MAAMC,SAAO,IAAI;AACvB,SACE,gBAAAC,SAAA,cAAC,OAAI,KAAK,EAAE,IAAI,KAAK,KACnB,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,IAAI,KAAK,KAAI,KAAM,GAChC,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,KAAK;AAAA,QACH,KAAK;AAAA,QACL,OAAO;AAAA,UACL,eAAe,WAAW,WAAW;AAAA,UACrC,YAAY,WAAW,UAAU;AAAA,QACnC;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,SAAS,MAAT,EAAc,MAAY,cAAc,WACvC,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC;AAAA,QACA;AAAA,QACA,SAAOJ,MAAA,QAAQ,KAAK,CAAC,EAAE,SAAS,MAAM,aAAa,SAAS,MAArD,gBAAAA,IAAwD,UAAS;AAAA,QACxE;AAAA;AAAA,IACF,GACA,gBAAAI,SAAA,cAAC,SAAS,QAAT,MACC,gBAAAA,SAAA;AAAA,MAAC,SAAS;AAAA,MAAT;AAAA,QACC,OAAM;AAAA,QACN,YAAY;AAAA,QACZ,KAAK;AAAA,UACH;AAAA;AAAA,aAEEH,MAAA,IAAI,YAAJ,gBAAAA,IAAa;AAAA;AAAA,UACf,QAAQ;AAAA,QACV;AAAA;AAAA,MAEC,QAAQ,IAAI,YAAU;AACrB,eACE,gBAAAG,SAAA;AAAA,UAAC,SAAS;AAAA,UAAT;AAAA,YACC,KAAK,OAAO;AAAA,YACZ,UAAU,MAAM,SAAS,OAAO,QAAQ;AAAA,YACxC,KAAK;AAAA,cACH,IAAI;AAAA,YACN;AAAA;AAAA,UAEC,OAAO;AAAA,QACV;AAAA,MAEJ,CAAC;AAAA,IACH,CACF,CACF;AAAA,IACC;AAAA,EACH,CACF;AAEJ;AAEAL,gBAAe,YAAY;AAAA,EACzB,OAAO,kBAAAM,QAAU,OAAO;AAAA,EACxB,SAAS,kBAAAA,QAAU,MAAM;AAAA,EACzB,WAAW,kBAAAA,QAAU;AAAA,EACrB,UAAU,kBAAAA,QAAU,KAAK;AAAA,EACzB,MAAM,kBAAAA,QAAU;AAAA,EAChB,UAAU,kBAAAA,QAAU;AACtB;;;AH9CA,IAAM,kBAAkB,CAAC,EAAE,SAAS,MAClC,gBAAAC,SAAA,cAAC,OAAI,KAAK,EAAE,GAAG,uBAAuB,OAAO,EAAE,GAAG,OAAO,EAAE,KAAI,QAAS;AAG1E,IAAM,UAAU,CAAC,EAAE,SAAS,MAA2C;AA5BvE,MAAAC,KAAAC;AA6BE,QAAM,EAAE,eAAe,IAAI,eAAe;AAC1C,QAAM,UAAUC,cAAY,aAAa;AACzC,QAAM,CAAC,aAAa,cAAc,IAAIC,WAAS,KAAK;AACpD,QAAM,CAAC,aAAa,cAAc,IAAIA,aAASH,MAAA,QAAQ,WAAW,CAAC,MAApB,gBAAAA,IAAuB,aAAY,SAAS;AAC3F,QAAM,UAAUE,cAAYE,wBAAuB;AACnD,QAAM,aAAaF,cAAYG,sBAAqB,OAAO,CAAC;AAC5D,QAAM,EAAE,oBAAoB,IAAIH,cAAY,wBAAwB;AACpE,QAAM,EAAE,SAAS,YAAY,SAAS,IAAI,mBAAmB;AAAA,IAC3D,UAAU,yBAAuBD,MAAA,QAAQ,YAAY,CAAC,MAArB,gBAAAA,IAAwB;AAAA,EAC3D,CAAC;AAED,SACE,gBAAAF,SAAA,cAAC,uBACC,gBAAAA,SAAA;AAAA,IAACO;AAAA,IAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAS,QAAQ;AAAA,MACjB,WAAW;AAAA,MACX,MAAM,gBAAAP,SAAA,cAACQ,YAAA,IAAU;AAAA,MACjB,UAAU,CAAC,aAAqB;AAC9B,iBAAS,MAAS;AAClB,uBAAe,QAAQ;AACvB,yDAAgB;AAAA,MAClB;AAAA;AAAA,EACF,GACA,gBAAAR,SAAA,cAAC,QAAK,KAAK,EAAE,KAAK,MAAM,YAAY,SAAS,KAC3C,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,MAAI;AAAA,MACJ,SAAS,MAAM;AACb,sBACI,iDAAgB,iBAChB,iDACI,cAAc;AAAA,UACd,aAAa;AAAA,UACb,SAAS,CAAC,QAAe;AACvB,qBAAS,GAAG;AAAA,UACd;AAAA,UACA,QAAQ,MAAM;AACZ,2BAAe,KAAK;AAAA,UACtB;AAAA,QACF,GACC,KAAK,MAAM;AACV,yBAAe,IAAI;AAAA,QACrB;AAAA,MACR;AAAA,MACA,UAAU,QAAQ,WAAW,WAAW,KAAK;AAAA;AAAA,IAE5C,cAAc,gBAAAA,SAAA,cAACS,WAAA,IAAS,IAAK,gBAAAT,SAAA,cAACQ,YAAA,IAAU;AAAA,IACxC,cAAc,mBAAmB;AAAA,EACpC,GAEA,gBAAAR,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,MAAI;AAAA,MACJ,SAAQ;AAAA,MACR,WAAU,iDAAgB,wBAAuB;AAAA,MACjD,SAAS,MAAM;AACb,YAAI,SAAS,SAAS;AACpB,mBAAS,QAAQ,OAAM,iDAAgB,uBAAsB;AAC7D,mBAAS,QAAQ,KAAK;AAAA,QACxB;AAAA,MACF;AAAA,MACA,UAAU,YAAW,iDAAgB,wBAAuB;AAAA;AAAA,IAE5D,gBAAAA,SAAA,cAACU,cAAA,IAAY;AAAA,IACZ,UAAU,eAAe;AAAA,EAC5B,GACA,gBAAAV,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,MACL,SAAS,MAAM,WAAW,KAAK;AAAA,MAC/B,QAAQ,MAAM,WAAW,IAAI;AAAA,MAC7B,OAAO,EAAE,SAAS,OAAO;AAAA;AAAA,EAC3B,CACF,GAEA,gBAAAA,SAAA,cAAC,QAAK,OAAM,UAAS,KAAK,EAAE,IAAI,MAAM,UAAU,SAAS,SAAS,cAAc,MAAM,KAAK,KAAK,KAAK,KACnG,gBAAAA,SAAA,cAAC,YACC,gBAAAA,SAAA,cAACQ,YAAA,IAAU,CACb,GACA,gBAAAR,SAAA,cAAC,SAAS,MAAT,EAAc,OAAO,YAAY,KAAK,EAAE,GAAG,KAAK,KAC/C,gBAAAA,SAAA;AAAA,IAAC,SAAS;AAAA,IAAT;AAAA,MACC,OAAO;AAAA,QACL,WAAW,eAAe,MAAM,UAAU;AAAA,QAC1C,YAAY;AAAA,MACd;AAAA;AAAA,EACF,CACF,CACF,CACF;AAEJ;AAEA,IAAM,cAAc,MAAM;AAxH1B,MAAAC;AAyHE,QAAM,UAAUU,gBAAc;AAC9B,QAAM,UAAUR,cAAY,aAAa;AACzC,QAAM,EAAE,oBAAoB,IAAIA,cAAY,wBAAwB;AAEpE,MAAI,QAAQ,YAAY,WAAW,GAAG;AACpC,WAAO,gBAAAH,SAAA,cAAAA,SAAA,cAAE;AAAA,EACX;AAEA,SACE,gBAAAA,SAAA,cAAC,uBACC,gBAAAA,SAAA;AAAA,IAACO;AAAA,IAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAS,QAAQ;AAAA,MACjB,WAAW,yBAAuBN,MAAA,QAAQ,YAAY,CAAC,MAArB,gBAAAA,IAAwB;AAAA,MAC1D,MAAM,gBAAAD,SAAA,cAACU,cAAA,IAAY;AAAA,MACnB,UAAU,CAAC,aAAqB;AAC9B,gBAAQ,qBAAqB,QAAQ;AAAA,MACvC;AAAA;AAAA,EACF,CACF;AAEJ;AAEO,IAAM,YAAY,MAAM;AAC7B,QAAM,EAAE,gBAAgB,WAAW,IAAI,eAAe;AACtD,QAAM,CAAC,OAAO,aAAa,IAAIN,WAA4B;AAE3D,QAAM,WAAWQ;AAAA,IACf,CAAC,QAAgB;AACf,gCAAkC,EAAE,WAAW,CAAC,CAAC,IAAI,CAAC;AACtD,oBAAc,GAAG;AAAA,IACnB;AAAA,IACA,CAAC,YAAY,aAAa;AAAA,EAC5B;AAEA,EAAAC,YAAU,MAAM;AACd,qDAAgB,kBAAkB,EAAE,OAAO,KAAK,GAAG,MAAM,CAAAC,WAAS,SAASA,MAAK;AAAA,EAClF,GAAG,CAAC,gBAAgB,QAAQ,CAAC;AAE7B,SACE,gBAAAd,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,qBACC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,GAAG,qBAAqB,KAAG,oOAIxD,GAEA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,KAAK;AAAA,QACL,OAAO;AAAA,UACL,eAAe;AAAA,UACf,KAAK;AAAA,QACP;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,WAAQ,UAAoB;AAAA,IAC7B,gBAAAA,SAAA,cAAC,iBAAY;AAAA,EACf,CACF,GACA,gBAAAA,SAAA,cAAC,cAAW,OAAc,SAAQ,+BAA8B,GAChE,gBAAAA,SAAA,cAAC,wBAAqB,OAA8B,CACtD;AAEJ;;;AI3LA;AAAA,OAAOe,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C,SAAS,mBAAAC,wBAAuB;AAMhC,IAAM,mBAAmB;AAElB,IAAM,0BAA0B;AAAA,EACrC,OAAO;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,UAAU;AAAA,IACR,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,SAAS;AAAA,IACP,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,OAAO;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,UAAU;AAAA,IACR,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,QAAQ;AAAA,IACN,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,KAAK;AAAA,IACH,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,SAAS;AAAA,IACP,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AACF;AAEO,IAAM,sBAAsB;AAAA,EACjC,OAAO;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,QAAQ;AAAA,IACN,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,SAAS;AAAA,IACP,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,QAAQ;AAAA,IACN,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,iBAAiB;AAAA,IACf,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,MAAM;AAAA,IACJ,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AAAA,EACA,OAAO;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,MAAM,GAAG,gBAAgB;AAAA,EAC3B;AACF;AAEA,IAAM,eAAe,CAAC,EAAE,OAAO,OAAO,QAAQ,MAC5C,gBAAAC,SAAA,cAAC,OAAI,KAAK,EAAE,GAAG,QAAQ,IAAI,OAAO,GAAG,OAAO,GAAG,MAAM,IAAI,oBAAoB,OAAO,EAAE,GAAG,OAAO,EAAE,KAChG,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,sBAAsB,IAAI,KAAK,KAAI,KAAM,GACzD,gBAAAA,SAAA,cAAC,QAAK,OAAM,YACT,WACC,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,MAAM,QAAQ,GAAG,UAAU,IAAI,qBAAqB,IAAI,KAAK,KACvE,gBAAAA,SAAA,cAAC,SAAI,OAAO,EAAE,WAAW,WAAW,OAAO,OAAO,GAAG,KAAK,SAAS,KAAK,OAAO,CACjF,GAEF,gBAAAA,SAAA,cAAC,YAAM,KAAM,CACf,CACF;AAGK,IAAM,cAAc,MAAM;AAxGjC,MAAAC,KAAAC,KAAA;AAyGE,QAAM,EAAE,gBAAgB,WAAW,IAAI,eAAe;AACtD,QAAM,CAAC,OAAO,QAAQ,IAAIC,WAA4B;AACtD,EAAAC,YAAU,MAAM;AACd,QAAI;AACF,uDAAgB;AAAA,IAClB,SAAS,KAAK;AACZ,kCAAoC,EAAE,WAAW,KAAK,CAAC;AACvD,eAAS,GAAY;AAAA,IACvB;AAAA,EACF,GAAG,CAAC,gBAAgB,UAAU,CAAC;AAC/B,SACE,gBAAAJ,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,iBAAc,KAAK,EAAE,SAAS,QAAQ,KAAK,MAAM,OAAO,EAAE,SAAS,QAAQ,EAAE,KAC5E,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SACEK,iBAAgB,WAAW,EAAE,UAC7BH,MAAA,qBAAoBD,MAAAI,iBAAgB,WAAW,EAAE,SAA7B,gBAAAJ,IAAmC,aAAiD,MAAxG,gBAAAC,IACI;AAAA,MAEN,OAAO,GAAGG,iBAAgB,WAAW,EAAE,IAAI,IAAIA,iBAAgB,WAAW,EAAE,OAAO;AAAA;AAAA,EACrF,GACA,gBAAAL,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,SACEK,iBAAgB,MAAM,EAAE,UACxB,8BAAwB,KAAAA,iBAAgB,MAAM,EAAE,SAAxB,mBAA8B,aAAqD,MAA3G,mBACI;AAAA,MAEN,OAAO,GAAGA,iBAAgB,MAAM,EAAE,IAAI,IAAIA,iBAAgB,MAAM,EAAE,OAAO;AAAA;AAAA,EAC3E,CACF,GACA,gBAAAL,SAAA,cAAC,cAAW,OAAc,SAAQ,uCAAsC,CAC1E;AAEJ;;;AC5IA;AAAA,OAAOM,YAAS,YAAAC,kBAAgB;AAChC,SAAkC,yBAA8C;AAChF,SAAS,mBAAAC,kBAAiB,mBAAAC,kBAAiB,gBAAAC,eAAc,eAAAC,cAAa,gBAAgB;AAStF,IAAM,UAAU;AAAA,EACd,IAAI;AAAA,EACJ,IAAI;AAAA,EACJ,IAAI;AACN;AAEA,IAAM,2BAA2B;AAAA,EAC/B,CAAC,kBAAkB,QAAQ,GAAG;AAAA,EAC9B,CAAC,kBAAkB,YAAY,GAAG;AAAA,EAClC,CAAC,kBAAkB,gBAAgB,GAAG;AAAA,EACtC,CAAC,kBAAkB,eAAe,GAAG;AAAA,EACrC,CAAC,kBAAkB,cAAc,GAAG;AAAA,EACpC,CAAC,kBAAkB,eAAe,GAAG;AAAA,EACrC,CAAC,kBAAkB,SAAS,GAAG;AACjC;AAEO,IAAM,6BAA6B,CAAC;AAAA,EACzC;AAAA,EACA,SAAS;AAAA,EACT;AAAA,EACA;AACF,MAKM;AACJ,QAAM,CAAC,aAAa,cAAc,IAAIC,WAAS,IAAI;AAEnD,SACE,gBAAAC,SAAA,cAAC,OAAI,KAAK,EAAE,IAAI,OAAO,GAAG,OAAO,GAAG,MAAM,IAAI,kBAAkB,KAC9D,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,sBAAsB,IAAI,KAAK,KAAI,KAAM,GACxD,UACC,gBAAAA,SAAA,cAAC,YACC,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,iBAAiB,KAC/B,gBAAAA,SAAA,cAACC,kBAAA,EAAgB,OAAM,UAAS,QAAO,UAAS,CAClD,GACA,gBAAAD,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,KAAK,KAChC,MACH,CACF,IAEA,gBAAAA,SAAA,cAAC,YACC,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,sBAAsB,KACpC,gBAAAA,SAAA,cAACE,kBAAA,EAAgB,OAAM,UAAS,QAAO,UAAS,CAClD,GACA,gBAAAF,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,KAAK,KAAG,QAEtC,CACF,GAEF,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAS,MAAM,eAAe,CAAC,WAAW;AAAA,MAC1C,OAAM;AAAA,MACN,KAAI;AAAA,MACJ,KAAK;AAAA,QACH,OAAO;AAAA,MACT;AAAA;AAAA,IAEC,cAAc,gBAAAA,SAAA,cAACG,cAAA,IAAY,IAAK,gBAAAH,SAAA,cAACI,eAAA,IAAa;AAAA,IAC/C,gBAAAJ,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK;AAAA,UACH,OAAO;AAAA,QACT;AAAA;AAAA,MAEC,cAAc,SAAS;AAAA,MAAO;AAAA,IACjC;AAAA,EACF,GACC,CAAC,cAAc,gBAAAA,SAAA,cAAC,WAAK,QAAS,IAAS,IAC1C;AAEJ;AAEA,IAAM,eAAe,CAAC;AAAA,EACpB;AAAA,EACA;AAAA,EACA,MAAAK;AACF,MAIM;AACJ,SACE,gBAAAL,SAAA,cAAC,OAAI,KAAK,EAAE,MAAM,OAAO,IAAI,KAAK,KAChC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,WAAU,KAAK,EAAE,YAAY,aAAa,GAAG,qBAAqB,KAC7E,KACH,GACA,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,IAAI,OAAO,YAAY,aAAa,KAC9CK,SACC,gBAAAL,SAAA,cAAC,QAAK,KAAK,EAAE,IAAI,KAAK,KACpB,gBAAAA,SAAA,cAACK,OAAA,EAAK,OAAM,QAAO,QAAO,QAAO,CACnC,GAEF,gBAAAL,SAAA,cAAC,QAAK,SAAQ,aAAW,KAAM,CACjC,CACF;AAEJ;AAEA,IAAM,oBAAoB,CAAC,EAAE,OAAO,MAAiE;AA/GrG,MAAAM,KAAAC,KAAA;AAgHE,SACE,gBAAAP,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,UAAS,iCAAQ,0BAAyB,OAAO;AAAA;AAAA,IAEjD,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,UAAU,OAAO,KAC5B,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,SAAOM,MAAA,iCAAQ,UAAR,gBAAAA,IAAe,MAAM,aAAY,QAAQ;AAAA,QAChD,QAAMC,MAAA,iCAAQ,UAAR,gBAAAA,IAAe,MAAM,aAAYN,mBAAkBC;AAAA;AAAA,IAC3D,GACA,gBAAAF,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,SAAO,sCAAQ,UAAR,mBAAe,MAAM,eAAc,QAAQ;AAAA,QAClD,QAAM,sCAAQ,UAAR,mBAAe,MAAM,aAAYC,mBAAkBC;AAAA;AAAA,IAC3D,IACC,iCAAQ,0BACP,gBAAAF,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,OAAM;AAAA,QACN,OAAO,GAAG,OAAO,uBAAuB,QAAQ,CAAC,CAAC;AAAA;AAAA,IACpD,IACE,IACN;AAAA,EACF;AAEJ;AAEA,IAAM,mBAAmB,CAAC,EAAE,OAAO,MAAgE;AACjG,SACE,gBAAAA,SAAA,cAAC,8BAA2B,OAAM,qCAAoC,SAAS,iCAAQ,eACrF,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,UAAU,OAAO,KAC5B,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,OAAM;AAAA,MACN,QAAO,iCAAQ,eAAc,cAAc;AAAA,MAC3C,OAAM,iCAAQ,eAAcC,mBAAkBC;AAAA;AAAA,EAChD,GACA,gBAAAF,SAAA,cAAC,gBAAa,OAAM,iBAAgB,QAAO,iCAAQ,iBAAgB,OAAO,MAAM,UAAU,CAC5F,CACF;AAEJ;AAEA,IAAM,aAAa,CAAC,EAAE,MAAM,MAAkD;AAC5E,SACE,gBAAAA,SAAA,cAAC,8BAA2B,OAAM,SAAQ,QAAO,YAAW,SAAS,CAAC,EAAC,+BAAO,cAC3E,SACC,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,UAAU,OAAO,KAC5B,gBAAAA,SAAA,cAAC,gBAAa,OAAM,cAAa,OAAO,YAAY,MAAM,SAAS,GAAG,GACtE,gBAAAA,SAAA,cAAC,gBAAa,OAAM,kBAAiB,OAAO,YAAY,MAAM,aAAa,GAAG,GAC9E,gBAAAA,SAAA,cAAC,gBAAa,OAAM,oBAAmB,OAAO,MAAM,gBAAgB,SAAS,GAAG,GAChF,gBAAAA,SAAA,cAAC,gBAAa,OAAM,gBAAe,OAAO,MAAM,YAAY,SAAS,GAAG,GACxE,gBAAAA,SAAA,cAAC,gBAAa,OAAM,gBAAe,OAAO,YAAY,MAAM,aAAa,KAAK,GAAG,GACjF,gBAAAA,SAAA,cAAC,gBAAa,OAAM,oBAAmB,OAAO,YAAY,MAAM,iBAAiB,KAAK,GAAG,GACzF,gBAAAA,SAAA,cAAC,gBAAa,OAAM,mBAAkB,OAAO,GAAG,MAAM,aAAa,OAAO,CAC5E,CAEJ;AAEJ;AAEA,IAAM,aAAa,CAAC,EAAE,MAAM,MAAkD;AAC5E,SACE,gBAAAA,SAAA,cAAC,8BAA2B,OAAM,SAAQ,QAAO,YAAW,SAAS,CAAC,EAAC,+BAAO,cAC3E,SACC,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,UAAU,OAAO,KAC5B,gBAAAA,SAAA,cAAC,gBAAa,OAAM,cAAa,OAAO,YAAY,MAAM,SAAS,GAAG,GACtE,gBAAAA,SAAA,cAAC,gBAAa,OAAM,kBAAiB,OAAO,YAAY,MAAM,aAAa,GAAG,GAC9E,gBAAAA,SAAA,cAAC,gBAAa,OAAM,oBAAmB,OAAO,MAAM,gBAAgB,SAAS,GAAG,GAChF,gBAAAA,SAAA,cAAC,gBAAa,OAAM,gBAAe,OAAO,MAAM,YAAY,SAAS,GAAG,GACxE,gBAAAA,SAAA,cAAC,gBAAa,OAAM,gBAAe,OAAO,YAAY,MAAM,aAAa,KAAK,GAAG,GACjF,gBAAAA,SAAA,cAAC,gBAAa,OAAM,oBAAmB,OAAO,YAAY,MAAM,iBAAiB,KAAK,GAAG,GACzF,gBAAAA,SAAA,cAAC,gBAAa,OAAM,mBAAkB,OAAO,GAAG,MAAM,aAAa,OAAO,CAC5E,CAEJ;AAEJ;AAEA,IAAMQ,UAAS,CAAC;AAAA,EACd;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,SACE,gBAAAR,SAAA,cAAC,cAAW,SACV,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,KAAK,MAAM,OAAO,EAAE,eAAe,SAAS,EAAE,KACzD,gBAAAA,SAAA,cAAC,UAAO,SAAQ,YAAW,SAAS,WAAS,cAE7C,GACA,gBAAAA,SAAA,cAAC,UAAO,UAAU,CAAC,QAAQ,SAAS,MAAM,UAAU,aAAa,QAAQ,yBAAyB,KAAG,sBAErG,CACF,CACF;AAEJ;AAEA,IAAM,yBAAyB,CAAC;AAAA,EAC9B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAKM;AA/NN,MAAAM,KAAAC,KAAA;AAgOE,MAAI,OAAO;AACT,WACE,gBAAAP,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,iBAAc,KAAK,EAAE,WAAW,SAAS,KACxC,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,wBAAwB,IAAI,KAAK,KAC/C,gBAAAA,SAAA,cAACE,kBAAA,IAAgB,CACnB,GACA,gBAAAF,SAAA,cAAC,QAAK,SAAQ,QAAK,0BAAwB,GAC3C,gBAAAA,SAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,GAAG,qBAAqB,KAClD,MAAM,OACT,CACF,GACA,gBAAAA,SAAA,cAACQ,SAAA,EAAO,SAAS,WAAW,OAAc,CAC5C;AAAA,EAEJ;AAEA,MAAI,QAAQ;AAEV,YAAQ,IAAI,MAAM;AAClB,WACE,gBAAAR,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,qBACC,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,qBAAqB,KAAG,uCAAqC,GAC7E,gBAAAA,SAAA,cAAC,oBAAiB,QAAQ,iCAAQ,kBAAkB,GACpD,gBAAAA,SAAA,cAAC,qBAAkB,QAAQ,iCAAQ,mBAAmB,GACtD,gBAAAA,SAAA,cAAC,cAAW,QAAOO,OAAAD,MAAA,iCAAQ,sBAAR,gBAAAA,IAA2B,UAA3B,gBAAAC,IAAkC,OAAO,GAC5D,gBAAAP,SAAA,cAAC,cAAW,QAAO,4CAAQ,sBAAR,mBAA2B,UAA3B,mBAAkC,OAAO,CAC9D,GACA,gBAAAA,SAAA,cAACQ,SAAA,EAAO,QAAgB,SAAS,WAAW,OAAc,CAC5D;AAAA,EAEJ;AAEA,MAAI,aAAa,QAAW;AAC1B,WACE,gBAAAR,SAAA,cAAC,iBAAc,KAAK,EAAE,WAAW,SAAS,KACxC,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,mBAAmB,SAAS,QAAQ,gBAAgB,SAAS,KAC3E,gBAAAA,SAAA,cAAC,WAAQ,MAAK,UAAS,OAAM,gBAAe,CAC9C,GACA,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,IAAI,KAAK,KAAG,6BAEtC,GACA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,SAAQ;AAAA,QACR,KAAK,EAAE,GAAG,sBAAsB,IAAI,KAAK;AAAA;AAAA,MACzC,GAAG,yBAAyB,QAAQ,CAAC;AAAA,IAAM,CAC/C;AAAA,EAEJ;AAEA,SAAO;AACT;AAEA,IAAM,iBAAiB,CAAC;AAAA,EACtB;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,SACE,gBAAAA,SAAA,cAAC,iBAAc,KAAK,EAAE,cAAc,4BAA4B,KAC9D,gBAAAA,SAAA,cAAC,QAAK,SAAQ,WAAQ,iBAAe,GACrC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,GAAG,oBAAoB,KAAG,4CAEvD,GACA,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC,SAAQ;AAAA,MACR,KAAK;AAAA,QACH,IAAI;AAAA,QACJ,OAAO;AAAA,UACL,eAAe;AAAA,UACf,KAAK;AAAA,QACP;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,SAAA;AAAA,MAAC;AAAA;AAAA,QACC,KAAK;AAAA,UACH,KAAK;AAAA,UACL,OAAO;AAAA,YACL,eAAe;AAAA,UACjB;AAAA,QACF;AAAA;AAAA,MAEC,OAAO,QAAQ,OAAO,EAAE,IAAI,CAAC,CAAC,KAAK,KAAK,MACvC,gBAAAA,SAAA;AAAA,QAAC;AAAA;AAAA,UACC;AAAA,UACA,UAAU,WAAW;AAAA,UACrB,SAAS,WAAW,MAAM,YAAY;AAAA,UACtC,KAAK,WAAW,MAAM,EAAE,IAAI,eAAe,IAAI,CAAC;AAAA,UAChD,SAAS,MAAM,UAAU,GAAG;AAAA;AAAA,QAE3B;AAAA,MACH,CACD;AAAA,IACH;AAAA,IACA,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,OAAO,EAAE,eAAe,SAAS,EAAE,KAC9C,gBAAAA,SAAA,cAAC,UAAO,SAAQ,WAAU,SAAS,WAAW,UAAU,CAAC,aACtD,YAAY,eAAe,YAC9B,CACF;AAAA,EACF,CACF;AAEJ;AAEO,IAAM,mBAAmB,MAAM;AACpC,QAAM,EAAE,gBAAgB,WAAW,IAAI,eAAe;AACtD,QAAM,CAAC,QAAQ,SAAS,IAAID,WAA6B,OAAO,KAAK,OAAO,EAAE,CAAC,CAAC;AAChF,QAAM,CAAC,OAAO,QAAQ,IAAIA,WAA4B;AACtD,QAAM,CAAC,UAAU,WAAW,IAAIA,WAA4B;AAC5D,QAAM,CAAC,QAAQ,SAAS,IAAIA,WAA8C;AAE1E,QAAM,YAAY,MAAM;AACtB,qCAAyC,EAAE,WAAW,OAAO,aAAa,MAAM,CAAC;AACjF,aAAS,MAAS;AAClB,cAAU,MAAS;AACnB,qDACI;AAAA,MACA,WAAS;AACP,oBAAY,KAAK;AAAA,MACnB;AAAA,MACA,CAAAU,YAAU;AACR,yCAAyC,EAAE,aAAa,KAAK,CAAC;AAC9D,kBAAUA,OAAM;AAAA,MAClB;AAAA,MACA;AAAA,MAED,MAAM,CAAAC,WAAS;AACd,uCAAyC,EAAE,WAAW,KAAK,CAAC;AAC5D,eAASA,MAAK;AAAA,IAChB;AAAA,EACJ;AAEA,SACE,gBAAAV,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA;AAAA,MACA,WAAW,aAAa,UAAa,aAAa,kBAAkB,YAAY,YAAY;AAAA;AAAA,EAC9F,GACA,gBAAAA,SAAA,cAAC,0BAAuB,OAAc,QAAgB,UAAoB,WAAsB,CAClG;AAEJ;AAEA,IAAM,eAAe,CAAC,KAAa,aAAqB;AACtD,QAAMW,KAAI,SAAS,cAAc,GAAG;AACpC,QAAM,OAAO,IAAI,KAAK,CAAC,KAAK,UAAU,KAAK,MAAM,CAAC,CAAC,GAAG;AAAA,IACpD,MAAM;AAAA,EACR,CAAC;AACD,EAAAA,GAAE,OAAO,IAAI,gBAAgB,IAAI;AACjC,EAAAA,GAAE,WAAW,GAAG,QAAQ;AACxB,EAAAA,GAAE,MAAM;AACV;;;AC7XA;AAAA,OAAOC,YAAS,aAAAC,aAAW,YAAAC,kBAAgB;AAC3C;AAAA,EAEE,iBAAAC;AAAA,EACA,4BAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,eAAAC;AAAA,OACK;AACP,SAAS,eAAAC,oBAAmB;AAWrB,IAAM,YAAY,MAAM;AAC7B,QAAM,EAAE,gBAAgB,WAAW,IAAI,eAAe;AACtD,QAAM,aAAaC,cAAYC,cAAa;AAC5C,QAAM,EAAE,WAAW,IAAI;AACvB,QAAM,UAAUD,cAAYE,wBAAuB;AACnD,QAAM,qBAAqBF,cAAYG,yBAAwB;AAC/D,QAAM,CAAC,OAAO,QAAQ,IAAIC,WAAmC;AAE7D,EAAAC,YAAU,MAAM;AACd,qDAAgB,mBAAmB,MAAM,SAAO;AAC9C,gCAAkC,EAAE,WAAW,KAAK,CAAC;AACrD,eAAS,GAAG;AAAA,IACd;AAAA,EACF,GAAG,CAAC,gBAAgB,UAAU,CAAC;AAE/B,SACE,gBAAAC,SAAA,cAAAA,SAAA,gBACE,gBAAAA,SAAA,cAAC,iBAAc,KAAK,EAAE,SAAS,QAAQ,OAAO,EAAE,eAAe,UAAU,YAAY,SAAS,EAAE,KAC7F,WACC,gBAAAA,SAAA;AAAA,IAAC,gBAAgB;AAAA,IAAhB;AAAA,MACC,KAAK;AAAA,QACH,OAAO;AAAA,QACP,aAAa;AAAA,QACb,IAAI;AAAA,QACJ,OAAO,EAAE,IAAI,GAAG,IAAI,OAAO,aAAa,MAAM;AAAA,MAChD;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAAC,SAAM,QAAQ,MAAM,SAAS,SAAS;AAAA,EACzC,GAEF,gBAAAA,SAAA,cAAC,QAAK,WAAU,UAAS,KAAK,EAAE,GAAG,OAAO,KACxC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,SAAQ,KAAK,EAAE,GAAG,sBAAsB,IAAI,MAAM,KAAG,+NAInE,GACA,gBAAAA,SAAA;AAAA,IAACC;AAAA,IAAA;AAAA,MACC,OAAM;AAAA,MACN,SAAS,cAAc,CAAC;AAAA,MACxB,MAAM,gBAAAD,SAAA,cAACE,cAAA,IAAY;AAAA,MACnB,WAAW,mBAAmB;AAAA,MAC9B,UAAU,CAAO,aAAqB;AACpC,yDAAgB;AAChB,yDAAgB,iBAAiB;AAAA,MACnC;AAAA;AAAA,EACF,CACF,CACF,GACA,gBAAAF,SAAA,cAAC,cAAW,OAAc,SAAQ,8BAA6B,GAC/D,gBAAAA,SAAA,cAAC,wBAAqB,OAAc,CACtC;AAEJ;;;AP9CA,IAAM,sBAAgE;AAAA,EACpE,cAAsB,GAAG,gBAAAG,SAAA,cAACC,cAAA,EAAY,OAAM,QAAO,QAAO,QAAO;AAAA,EACjE,cAAsB,GAAG,gBAAAD,SAAA,cAACE,YAAA,EAAU,OAAM,QAAO,QAAO,QAAO;AAAA,EAC/D,gBAAwB,GAAG,gBAAAF,SAAA,cAAC,aAAU,OAAM,QAAO,QAAO,QAAO;AAAA,EACjE,qBAA6B,GAAG,gBAAAA,SAAA,cAACG,mBAAA,EAAiB,OAAM,QAAO,QAAO,QAAO;AAC/E;AAEA,IAAMC,aAAY,CAAC,EAAE,SAAS,MAC5B,gBAAAJ,SAAA;AAAA,EAAC;AAAA;AAAA,IACC,KAAK;AAAA,MACH,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,YAAY;AAAA,MACZ,4BAA4B;AAAA,MAC5B,UAAU;AAAA,MACV,GAAG;AAAA,MACH,OAAO;AAAA,QACL,GAAG;AAAA,MACL;AAAA,MACA,WAAW;AAAA,MACX,WAAW;AAAA,MACX,OAAO;AAAA,QACL,WAAW;AAAA,MACb;AAAA,MACA,6BAA6B;AAAA,QAC3B,iBAAiB;AAAA,QACjB,WAAW;AAAA,QACX,iBAAiB;AAAA,MACnB;AAAA,MACA,uBAAuB;AAAA,QACrB,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,iBAAiB;AAAA,MACnB;AAAA,MACA,6BAA6B;AAAA,QAC3B,iBAAiB;AAAA,QACjB,cAAc;AAAA,MAChB;AAAA,IACF;AAAA;AAAA,EAEC;AACH;AAGF,IAAM,sBAAsB,MAAM;AAChC,QAAM,EAAE,gBAAgB,IAAI,eAAe;AAE3C,MAAI,gBAAgB,MAAM,gBAAAA,SAAA,cAAAA,SAAA,cAAE;AAE5B,MAAI,mCAA2C;AAC7C,oBAAgB;AAAA,EAClB,WAAW,mCAA2C;AACpD,oBAAgB;AAAA,EAClB,WAAW,qCAA6C;AACtD,oBAAgB;AAAA,EAClB,WAAW,0CAAkD;AAC3D,oBAAgB;AAAA,EAClB;AAEA,SAAO,gBAAAA,SAAA,cAAC,iBAAc,KAAK,iBAAiB;AAC9C;AAEA,IAAM,wBAAwB,MAAM;AAClC,QAAM,EAAE,iBAAiB,WAAW,IAAI,eAAe;AACvD,SACE,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,IAAI,MAAM,IAAI,OAAO,YAAY,UAAU,cAAc,4BAA4B,KAChG,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,mBAAmB,IAAI,MAAM,KAAI,oBAAoB,eAAe,CAAE,GACtF,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,UAAU,OAAO,IAAI,KAAK,KAAI,WAAW,IAAK,CAC7D;AAEJ;AAEA,IAAM,2BAA2B,MAAM;AACrC,SACE,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,QAAQ,6BAA6B,GAAG,MAAM,GAAG,OAAO,UAAU,SAAS,OAAO,EAAE,GAAG,OAAO,EAAE,KAC1G,gBAAAA,SAAA,cAAC,2BAAsB,GACvB,gBAAAA,SAAA,cAAC,yBAAoB,CACvB;AAEJ;AAEA,IAAM,uBAAuB,MAAM;AACjC,QAAM,EAAE,iBAAiB,YAAY,MAAM,IAAI,eAAe;AAE9D,SACE,gBAAAA,SAAA,cAAC,OAAI,KAAK,EAAE,GAAG,OAAO,OAAO,EAAE,SAAS,OAAO,EAAE,KAC9C,OAAO,KAAK,eAAe,EACzB,OAAO,SAAO,CAAC,MAAM,OAAO,GAAG,CAAC,CAAC,EACjC,IAAI,SAAO;AACV,UAAM,WAAW,OAAO,GAAG;AAC3B,UAAM,OAAO,MAAM,QAA2B;AAC9C,UAAM,kBAAkB,kBAAkB,YAAY,WAAW;AAEjE,QAAI,QAAQ;AACZ,QAAI,OAAO,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,OAAO,UAAU,UAAU,KAAG,QAAM;AAE/D,QAAI,oBAAoB,UAAU;AAChC,cAAQ;AACR,aAAO,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,OAAO,UAAU,UAAU,KAAG,QAAM;AAAA,IAC7D;AACA,QAAI,iBAAiB;AACnB,cAAQ;AACR,aAAO,gBAAAA,SAAA,cAACK,kBAAA,EAAgB,OAAM,QAAO,QAAO,QAAO;AAAA,IACrD;AACA,QAAI,KAAK,WAAW;AAClB,cAAQ;AACR,aAAO,gBAAAL,SAAA,cAACM,kBAAA,EAAgB,OAAM,QAAO,QAAO,QAAO;AAAA,IACrD;AAEA,WACE,gBAAAN,SAAA,cAAC,QAAK,KAAU,KAAK,EAAE,IAAI,OAAO,GAAG,OAAO,KAAK,MAAM,YAAY,SAAS,KACzE,MACD,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,GAAG,MAAM,KAAI,KAAK,IAAK,CACtC;AAAA,EAEJ,CAAC,CACL;AAEJ;AAEA,IAAM,sBAAsB,MAAM;AAChC,QAAM,UAAUO,gBAAc;AAC9B,QAAM,CAAC,YAAY,aAAa,IAAIC,WAAS,CAAC;AAC9C,QAAM,CAAC,OAAO,QAAQ,IAAIA,WAAS,YAAY;AAC/C,QAAM,iBAAiBC,SAAO,QAAQ,gBAAgB,CAAC;AAEvD,QAAM,aAAaC,cAAY,CAAC,MAAuB,UAA6C;AAClG,aAAS,eAAc,iCAAK,YAAL,EAAgB,CAAC,IAAI,GAAG,kCAAK,UAAU,IAAI,IAAM,OAAQ,EAAE;AAAA,EACpF,GAAG,CAAC,CAAC;AAEL,SACE,gBAAAV,SAAA;AAAA,IAAC,mBAAmB;AAAA,IAAnB;AAAA,MACC,OAAO;AAAA,QACL,gBAAgB,eAAe;AAAA,QAC/B,iBAAiB;AAAA,QACjB;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA;AAAA,IAEA,gBAAAA,SAAA,cAACI,YAAA,MACC,gBAAAJ,SAAA,cAAC,QAAK,SAAQ,QAAK,eAAa,GAChC,gBAAAA,SAAA,cAAC,QAAK,SAAQ,MAAK,KAAK,EAAE,GAAG,qBAAqB,KAAG,uEAErD,GACA,gBAAAA,SAAA,cAAC,QAAK,KAAK,EAAE,WAAW,UAAU,IAAI,OAAO,cAAc,SAAS,KAClE,gBAAAA,SAAA,cAAC,0BAAqB,GACtB,gBAAAA,SAAA,cAAC,8BAAyB,CAC5B,CACF;AAAA,EACF;AAEJ;AAEO,IAAM,cAAc,MAAM;AAC/B,SACE,gBAAAA,SAAA,cAACW,kBAAA,MACC,gBAAAX,SAAA,cAAC,oBAAiB,WAAU,aAC1B,gBAAAA,SAAA,cAAC,yBAAoB,CACvB,CACF;AAEJ;",
  "names": ["undefined", "collection", "data", "runInContext", "Array", "Date", "Error", "Function", "Math", "Object", "RegExp", "String", "TypeError", "Buffer", "Symbol", "Uint8Array", "Map", "Promise", "Set", "WeakMap", "isArray", "isObject", "result", "iteratee", "size", "values", "customizer", "key", "setTimeout", "includes", "object", "indexOf", "set", "clearTimeout", "index", "ary", "othValue", "map", "match", "transform", "parent", "clone", "isNaN", "lt", "at", "mergeWith", "merge", "parseInt", "chain", "value", "window", "undefined", "regexes", "ua", "j", "match", "require_lodash", "Buffer", "Symbol", "Uint8Array", "Map", "Promise", "Set", "WeakMap", "data", "isArray", "customizer", "isObject", "othValue", "SDPUtils", "sdp", "pt", "j", "match", "sdp", "l", "j", "sdp", "b", "c", "f", "h", "l", "y", "z", "a", "Fragment", "Portal", "Suspense", "to", "y", "data", "i", "checker", "React", "_a", "_b", "QUESTION_TYPE_TITLE", "theme", "useEffect", "useState", "ThemeTypes", "useState", "isBrowser", "updatedTheme", "useEffect", "React", "_a", "_b", "React", "React", "_a", "_b", "React", "_a", "_b", "_a", "_b", "css", "React", "React", "React", "React", "useState", "useState", "React", "React", "Root", "_a", "React", "React", "Root", "Track", "Range", "Thumb", "_a", "_b", "React", "React", "useEffect", "useRef", "Root", "styled", "React", "React", "React", "styled", "Root", "useEffect", "React", "useRef", "React", "_a", "_b", "css", "React", "Root", "Overlay", "Root", "Container", "Root", "Content", "Portal", "Root", "Trigger", "Root", "Trigger", "Content", "Portal", "React", "_a", "_b", "React", "Root", "Flex", "useCallback", "useRef", "theme", "useCallback", "useRef", "z", "React", "useEffect", "useRef", "React", "useRef", "useEffect", "Arrow", "Close", "Content", "Root", "Portal", "Trigger", "StyledContent", "Content", "Arrow", "StyledTrigger", "Trigger", "Popover", "Root", "Portal", "Close", "React", "selectHMSStats", "useHMSStatsStore", "dm", "Root", "Label", "useRef", "useRef", "_a", "_b", "selectHMSStats", "useHMSStatsStore", "React", "Label", "React", "CrossIcon", "css", "React", "CrossIcon", "_a", "_b", "React", "StyledTrigger", "StyledContent", "React", "_a", "_b", "css", "Root", "Select", "StyledTrigger", "StyledContent", "StyledItem", "Select", "StyledTrigger", "StyledContent", "React", "React", "React", "_a", "_b", "Icon", "React", "Content", "Root", "Trigger", "Root", "Trigger", "Content", "React", "useEffect", "useRef", "match", "selectIsConnectedToRoom", "useHMSActions", "useHMSStore", "React", "useEffect", "useMemo", "useRef", "selectHLSState", "useHMSActions", "useHMSStore", "useRecordingStreaming", "React", "useCallback", "useHMSActions", "useHMSStore", "React", "React", "Label", "useCallback", "useMemo", "useHMSStore", "useHMSVanillaStore", "useState", "useHMSStore", "useHMSStore", "_a", "useCallback", "_b", "value", "useHMSVanillaStore", "useMemo", "React", "useHMSActions", "useHMSStore", "useCallback", "useMemo", "useHMSStore", "import_lodash", "React", "useCallback", "useEffect", "useRef", "useState", "useState", "useRef", "useCallback", "_a", "layout", "useEffect", "_b", "React", "_a", "a", "b", "_a", "_b", "_a", "_b", "useHMSStore", "useMemo", "details", "useCallback", "selectAppData", "useHMSActions", "useHMSStore", "useHMSVanillaStore", "useHMSStore", "selectAppData", "useHMSActions", "useHMSVanillaStore", "useCallback", "view", "React", "_a", "_b", "useHMSActions", "useHMSStore", "useRef", "useEffect", "useMemo", "useRecordingStreaming", "selectHLSState", "React", "useEffect", "useRef", "useState", "match", "useHMSActions", "React", "useContext", "React", "useContext", "React", "useContext", "useEffect", "match", "P", "HMSRoomState", "selectRoomState", "useHMSActions", "useHMSStore", "parsedUserAgent", "_a", "_b", "parsedUserAgent", "useCallback", "_a", "_b", "on", "useCallback", "React", "useContext", "useHMSStore", "selectRoomState", "useHMSActions", "useEffect", "match", "HMSRoomState", "P", "isLeaveScreenEnabled", "prevState", "React", "useHMSActions", "useState", "useRef", "useEffect", "error", "match", "_a", "React", "useEffect", "useRef", "useState", "uuid", "HMSRoomState", "selectAppData", "selectIsConnectedToRoom", "selectRoomState", "useAwayNotifications", "useHMSActions", "useHMSStore", "React", "useEffect", "useMedia", "React", "Fragment", "useCallback", "useEffect", "useState", "DeviceType", "HMSRoomState", "selectLocalVideoTrackID", "selectRoomState", "selectVideoTrackByID", "useAVToggle", "useDevices", "useHMSActions", "useHMSStore", "useHMSVanillaStore", "MicOnIcon", "SettingsIcon", "SpeakerIcon", "VideoOnIcon", "React", "IconButton", "Icon", "React", "React", "_a", "_b", "React", "React", "useCallback", "useEffect", "useState", "useMedia", "CrossIcon", "React", "DialogPrimitive", "StyledContent", "React", "_a", "_b", "React", "Fragment", "useEffect", "useRef", "useState", "useMedia", "selectIsLocalVideoEnabled", "useHMSActions", "useHMSStore", "React", "ChevronDownIcon", "ChevronUpIcon", "React", "css", "ChevronUpIcon", "ChevronDownIcon", "useEffect", "useRef", "useState", "_a", "useHMSStore", "selectIsLocalVideoEnabled", "useHMSActions", "useMedia", "useEffect", "React", "Fragment", "_b", "useState", "useRef", "React", "React", "React", "useMedia", "useState", "useCallback", "useEffect", "_a", "CrossIcon", "Icon", "Content", "React", "_a", "useHMSActions", "useState", "useHMSStore", "useCallback", "SpeakerIcon", "SettingsIcon", "useDevices", "useAVToggle", "useHMSVanillaStore", "selectLocalVideoTrackID", "selectVideoTrackByID", "selectRoomState", "useEffect", "Fragment", "MicOnIcon", "DeviceType", "VideoOnIcon", "HMSRoomState", "React", "useHMSStore", "useHMSStore", "React", "React", "useState", "useMedia", "selectAvailableRoleNames", "selectIsConnectedToRoom", "useHMSStore", "React", "React", "useEffect", "useEffect", "useCallback", "useEffect", "useMemo", "useRef", "useState", "useMedia", "JoinForm_JoinBtnType", "parsedUserAgent", "selectPeerCount", "useHMSActions", "useHMSStore", "useHMSVanillaStore", "_a", "_b", "JoinForm_JoinBtnType", "useHMSStore", "selectPeerCount", "useHMSVanillaStore", "parsedUserAgent", "useMedia", "useCallback", "useHMSActions", "useState", "useEffect", "useMemo", "useState", "useHMSStore", "selectIsConnectedToRoom", "selectAvailableRoleNames", "useMedia", "_a", "data", "React", "React", "useMedia", "selectHLSState", "selectIsConnectedToRoom", "selectPermissions", "selectRolesMap", "useHMSActions", "useHMSStore", "React", "Fragment", "useState", "selectIsConnectedToRoom", "selectPermissions", "useHMSStore", "useRecordingStreaming", "VerticalMenuIcon", "React", "CrossIcon", "React", "CrossIcon", "React", "css", "React", "React", "AlertTriangleIcon", "CrossIcon", "React", "AlertTriangleIcon", "CrossIcon", "useState", "useHMSStore", "selectIsConnectedToRoom", "selectPermissions", "useRecordingStreaming", "React", "Fragment", "VerticalMenuIcon", "React", "Fragment", "useState", "selectIsConnectedToRoom", "selectPermissions", "useHMSStore", "useRecordingStreaming", "CrossIcon", "ExitIcon", "StopIcon", "useState", "useHMSStore", "selectIsConnectedToRoom", "selectPermissions", "useRecordingStreaming", "React", "Fragment", "open", "ExitIcon", "StopIcon", "CrossIcon", "useHMSStore", "selectIsConnectedToRoom", "selectPermissions", "useMedia", "selectRolesMap", "selectHLSState", "useHMSActions", "React", "React", "useMedia", "React", "Fragment", "useState", "match", "HMSTranscriptionMode", "selectAppData", "selectIsTranscriptionEnabled", "selectLocalPeerID", "useHMSActions", "useHMSStore", "CheckIcon", "InfoIcon", "OpenCaptionIcon", "PipIcon", "SettingsIcon", "React", "React", "useCallback", "useEffect", "useState", "selectPeers", "useHMSActions", "useHMSVanillaStore", "selectIsLocalVideoEnabled", "_a", "_b", "selectIsLocalVideoEnabled", "isMicActive", "isCamActive", "useState", "useHMSActions", "useHMSVanillaStore", "useCallback", "React", "useEffect", "selectPeers", "React", "React", "useCallback", "useEffect", "useMemo", "useState", "selectHMSMessages", "selectLocalPeerID", "selectPeerNameByID", "selectSessionStore", "selectUnreadHMSMessagesCount", "useHMSStore", "React", "Fragment", "useCallback", "useEffect", "useMemo", "useRef", "useState", "useMedia", "selectLocalPeerID", "selectLocalPeerName", "selectPeerNameByID", "selectSessionStore", "useHMSActions", "useHMSStore", "useHMSVanillaStore", "React", "useCallback", "useState", "selectPermissions", "useHMSActions", "useHMSStore", "CopyIcon", "CrossIcon", "EyeCloseIcon", "PeopleRemoveIcon", "VerticalMenuIcon", "React", "React", "useCallback", "selectLocalPeer", "selectSessionStore", "useHMSActions", "useHMSStore", "useHMSActions", "useHMSStore", "selectSessionStore", "useCallback", "selectLocalPeer", "useCallback", "selectSessionStore", "useHMSActions", "useHMSVanillaStore", "useHMSActions", "useHMSVanillaStore", "useCallback", "selectSessionStore", "_a", "_b", "useState", "useHMSActions", "useHMSStore", "selectPermissions", "useCallback", "React", "CopyIcon", "EyeCloseIcon", "PeopleRemoveIcon", "CrossIcon", "VerticalMenuIcon", "React", "useMedia", "_a", "useMedia", "React", "useEffect", "useState", "selectSessionStore", "useHMSStore", "useHMSStore", "selectSessionStore", "useState", "useEffect", "match", "formatTime", "_a", "_b", "React", "useHMSStore", "selectPeerNameByID", "Link", "Fragment", "useRef", "useMedia", "selectLocalPeerID", "useState", "formatTime", "data", "useHMSActions", "itemKey", "useCallback", "useEffect", "selectSessionStore", "useMemo", "useHMSVanillaStore", "selectLocalPeerName", "_a", "_b", "useHMSStore", "selectHMSMessages", "selectLocalPeerID", "selectUnreadHMSMessagesCount", "useState", "useCallback", "useEffect", "selectSessionStore", "useMemo", "React", "formatTime", "selectPeerNameByID", "React", "React", "React", "useRef", "useState", "useMedia", "selectAvailableRoleNames", "useHMSActions", "useHMSStore", "ChevronDownIcon", "ChevronUpIcon", "CrossIcon", "React", "_a", "useHMSStore", "selectAvailableRoleNames", "useState", "useHMSActions", "useRef", "CrossIcon", "ChevronUpIcon", "ChevronDownIcon", "useMedia", "React", "useState", "selectPermissions", "useHMSActions", "useHMSStore", "useRecordingStreaming", "AlertTriangleIcon", "React", "useCallback", "useState", "React", "useRef", "CheckIcon", "CrossIcon", "_a", "_b", "Icon", "css", "React", "CrossIcon", "Label", "_a", "_b", "useRef", "React", "css", "useState", "useCallback", "React", "Label", "useHMSStore", "selectPermissions", "useState", "useRecordingStreaming", "useHMSActions", "React", "AlertTriangleIcon", "React", "useEffect", "useMemo", "useRef", "useState", "match", "P", "selectHMSStats", "selectLocalPeerID", "selectTracksMap", "useHMSStatsStore", "useHMSStore", "_a", "useMemo", "useState", "useRef", "useEffect", "React", "Label", "useHMSStore", "selectTracksMap", "selectLocalPeerID", "_b", "useHMSStatsStore", "selectHMSStats", "StatsRow", "match", "P", "layer", "local", "React", "useCallback", "useRef", "useState", "useHMSActions", "AlertTriangleIcon", "CheckIcon", "_a", "_b", "useHMSActions", "useRef", "useState", "useCallback", "React", "selectedRole", "CheckIcon", "AlertTriangleIcon", "React", "useMedia", "React", "selectIsTranscriptionEnabled", "useHMSActions", "useHMSStore", "AlertTriangleIcon", "CrossIcon", "useHMSActions", "useHMSStore", "selectIsTranscriptionEnabled", "React", "CrossIcon", "id", "AlertTriangleIcon", "useMedia", "React", "React", "useCallback", "useEffect", "useState", "useState", "useCallback", "useEffect", "React", "React", "useCallback", "useState", "selectAvailableRoleNames", "useHMSActions", "useHMSStore", "MicOffIcon", "React", "selectPermissions", "useHMSStore", "useHMSStore", "selectPermissions", "React", "Label", "useHMSStore", "selectAvailableRoleNames", "useHMSActions", "useState", "useCallback", "React", "MicOffIcon", "useCallback", "selectLocalPeerID", "selectPeerMetadata", "useHMSActions", "useHMSStore", "useHMSVanillaStore", "useHMSActions", "useHMSStore", "selectLocalPeerID", "useHMSVanillaStore", "selectPeerMetadata", "useCallback", "useEffect", "useHMSActions", "useContext", "createContext", "useContext", "useHMSActions", "useEffect", "useHMSStore", "selectLocalPeerID", "useHMSActions", "selectAppData", "useState", "HMSTranscriptionMode", "selectIsTranscriptionEnabled", "React", "Fragment", "CheckIcon", "OpenCaptionIcon", "PipIcon", "SettingsIcon", "match", "InfoIcon", "React", "useRef", "useState", "match", "HMSTranscriptionMode", "selectIsConnectedToRoom", "selectIsLocalVideoEnabled", "selectIsTranscriptionAllowedByMode", "selectIsTranscriptionEnabled", "selectPeerCount", "selectPermissions", "useHMSActions", "useHMSStore", "useRecordingStreaming", "BrbIcon", "ClosedCaptionIcon", "CrossIcon", "EmojiIcon", "HamburgerMenuIcon", "HandIcon", "InfoIcon", "OpenCaptionIcon", "RecordIcon", "SettingsIcon", "React", "useCallback", "useEffect", "useRef", "useState", "useMedia", "a", "b", "import_lodash", "uuid", "match", "window", "navigator", "data", "window", "navigator", "c", "cc", "a", "b", "match", "cs", "window", "window", "f", "sdp", "shimGetDisplayMedia", "shimGetUserMedia", "shimOnTrack", "shimPeerConnection", "shimGetUserMedia", "window", "navigator", "a", "b", "c", "shimGetDisplayMedia", "window", "shimOnTrack", "window", "shimPeerConnection", "shimGetUserMedia", "window", "f", "shimGetUserMedia", "navigator", "RTCPeerConnection", "window", "SDPUtils", "match", "isFirefox", "data", "sdp", "window", "logging", "adapter", "shimPeerConnection", "shimGetUserMedia", "shimOnTrack", "import_lodash", "uuid", "uuidv4", "EventEmitter", "EventEmitter", "uuid", "require_package", "__commonJSMin", "exports", "module", "HMSRoomState", "HMSMessageType", "HMSNotificationSeverity", "HMSNotificationTypes", "HMSPlaylistType", "getScreenSharesByPeer", "tracks", "peer", "videoTrack", "audioTrack", "trackID", "track", "isScreenShare", "isAudio", "isVideo", "isAudioPlaylist", "isVideoPlaylist", "isDegraded", "isTrackEnabled", "store", "isRoleAllowedToPublish", "role", "_a", "video", "audio", "screen", "HMSLogLevel", "isTestEnv", "HMSLogger", "tag", "data", "mark", "level", "entry", "error", "parsedUserAgent", "UAParser", "isBrowser", "_a", "isNode", "checkIsSupported", "isSupported", "_a", "_b", "isSafari", "parsedUserAgent", "isFirefox", "DomainCategory", "getDomainCategory", "isBrowser", "baseurl", "domainCategory", "ErrorCodes", "HMSException", "_HMSException", "code", "name", "action", "message", "description", "isTerminal", "error", "terminalActions", "ErrorFactory", "action", "description", "HMSException", "ErrorCodes", "code", "isTerminal", "deviceInfo", "message", "deviceType", "jsonMessage", "entity", "LocalStorage", "key", "val", "i", "initializeLocalstoragePolyfill", "isBrowser", "e", "HMSLogger", "_a", "stringItem", "value", "stringValue", "getAnalyticsDeviceId", "id", "storage", "storageId", "uuid", "isPresent", "value", "sdk_version", "createUserAgent", "sdkEnv", "frameworkInfo", "sdk", "env", "domainCategory", "isNode", "convertObjectToString", "parsedOs", "parsedUserAgent", "parsedDevice", "parsedBrowser", "os", "replaceSpaces", "os_version", "browser", "device_model", "s", "object", "delimiter", "key", "isPresent", "AnalyticsEvent", "name", "level", "properties", "includesPII", "timestamp", "uuid", "getAnalyticsDeviceId", "__spreadProps", "__spreadValues", "AnalyticsEventFactory", "error", "additionalProperties", "requestedAt", "respondedAt", "endpoint", "_a", "_b", "props", "__objRest", "_c", "_d", "devices", "settings", "isUserSelection", "selection", "type", "stats", "track", "isDegraded", "restoredAt", "duration", "device", "started", "reason", "deviceInfo", "ok", "initialProperties", "errorProperties", "HMSException", "DeviceStorage", "LocalStorage", "devices", "value", "type", "deviceId", "groupId", "newSelection", "device", "HMSLogger", "selectedDevices", "current", "DeviceStorageManager", "HMSAudioPluginType", "HMSPluginUnsupportedTypes", "debounce", "fn", "delay", "timer", "args", "context", "HMSPeerType", "HMSRecordingState", "HLSPlaylistType", "HLSStreamType", "HMSTranscriptionState", "HMSTranscriptionMode", "HMSAudioMode", "DeviceType", "HMSIntersectionObserverWrapper", "element", "onIntersection", "_a", "entries", "entry", "isSupported", "isBrowser", "HMSLogger", "HMSIntersectionObserver", "HMSResizeObserverWrapper", "onResize", "options", "debounce", "HMSResizeObserver", "HMSVideoPluginType", "HMSVideoPluginCanvasContextType", "CLIENT_ANAYLTICS_PROD_ENDPOINT", "CLIENT_ANAYLTICS_QA_ENDPOINT", "MAX_SAFE_INTEGER", "HMSIdFactory", "uuidv4", "selectRoom", "store", "selectErrors", "selectRecentError", "createSelector", "errors", "selectRoomID", "room", "selectPeersMap", "selectMessagesMap", "selectMessageIDsInOrder", "selectTracksMap", "selectFullAppData", "store", "selectSpeakers", "store", "selectIsConnectedToRoom", "createSelector", "selectRoom", "room", "selectPeerCount", "isConnected", "selectHideLocalPeer", "store", "selectPeers", "selectPeersMap", "storePeers", "hideLocalPeer", "peerID", "selectTracks", "selectTracksMap", "storeTracks", "selectLocalPeer", "peers", "selectLocalPeerID", "selectLocalPeerName", "peer", "selectLocalPeerRoleName", "selectLocalAudioTrackID", "selectLocalVideoTrackID", "selectLocalAuxiliaryTrackIDs", "selectLocalTrackIDs", "audioTrackID", "videoTrackID", "auxiliaryTrackIDs", "trackIDs", "selectRemotePeers", "p", "selectDominantSpeaker", "selectSpeakers", "peersMap", "speakers", "speakersInOrder", "s1", "s2", "_a", "_b", "s1Level", "selectIsLocalScreenShared", "createSelector", "selectLocalPeer", "selectTracksMap", "localPeer", "tracksMap", "video", "audio", "getScreenSharesByPeer", "selectPeerScreenSharing", "selectPeersMap", "peersMap", "screensharePeer", "peerID", "peer", "selectIsSomeoneScreenSharing", "selectPeerSharingAudio", "selectPeersScreenSharing", "videoPeers", "audioPeers", "selectPeerSharingVideoPlaylist", "trackId", "track", "isVideoPlaylist", "isVideo", "selectPeerSharingAudioPlaylist", "isAudioPlaylist", "selectDegradedTracks", "selectTracks", "tracks", "isDegraded", "selectHMSMessagesCount", "selectMessageIDsInOrder", "messageIDs", "selectUnreadHMSMessagesCount", "selectMessagesMap", "messages", "m", "selectHMSMessages", "msgIDs", "msgMap", "msgId", "selectHMSBroadcastMessages", "_a", "selectUnreadHMSBroadcastMessagesCount", "selectRoomState", "selectRoom", "room", "selectIsInPreview", "roomState", "selectRoomStarted", "selectIsTranscriptionEnabled", "transcription", "selectRolesMap", "store", "selectAvailableRoleNames", "rolesMap", "selectLocalPeerRole", "selectPreviewRoleName", "selectPreviewRole", "roleName", "selectIsAllowedToSubscribe", "role", "selectPermissions", "selectRecordingState", "selectRTMPState", "selectHLSState", "selectTranscriptionsState", "selectSessionId", "selectRoomStartTime", "selectIsLargeRoom", "selectIsEffectsEnabled", "selectIsVBEnabled", "selectEffectsKey", "selectPollsMap", "store", "selectHandRaisedPeers", "createSelector", "selectPeers", "peers", "peer", "selectWhiteboards", "store", "selectWhiteboard", "whiteboards", "selectPlaylistMap", "type", "selectPlaylistSelection", "selectPlaylistProgress", "selectPlaylistCurrentTime", "selectPlaylistPlaybackRate", "selectPlaylistVolume", "selectPlaylist", "storePlaylist", "selectPlaylistSelectedItem", "currentSelection", "selectAudioPlaylist", "selectVideoPlaylist", "byIDCurry", "selector", "id", "HMS_STORE_TAG", "HMSLogger", "tag", "data", "mark", "level", "entry", "error", "selectPeerID", "_store", "peerID", "selectTrackID", "trackID", "selectRoleName", "roleName", "selectAppDataKey", "key", "selectPollID", "pollID", "selectPeerByIDBare", "selectPeersMap", "storePeers", "selectTrackByIDBare", "selectTracksMap", "storeTracks", "selectVideoTrackByIDBare", "track", "selectAudioTrackByIDBare", "selectScreenAudioTrackByIDBare", "selectScreenVideoTrackByIDBare", "selectPollByIDBare", "selectPollsMap", "storePolls", "selectPeerByID", "selectAppData", "selectFullAppData", "appData", "selectSessionStore", "selectPeerNameByID", "byIDCurry", "createSelector", "selectPeerByIDBare", "peer", "selectPeerTypeByID", "selectTrackByID", "selectTrackByIDBare", "selectVideoTrackByID", "selectVideoTrackByIDBare", "selectAudioTrackByID", "selectAudioTrackByIDBare", "selectScreenAudioTrackByID", "selectScreenAudioTrackByIDBare", "selectScreenVideoTrackByID", "selectScreenVideoTrackByIDBare", "selectVideoTrackByPeerID", "store", "peerID", "selectAudioTrackByPeerID", "selectAuxiliaryTracksByPeerID", "byIDCurry", "store", "peerID", "peer", "selectPeerByIDBare", "trackID", "selectSpeakerByTrackID", "selectTrackAudioByID", "createSelector", "speaker", "selectSpeakerByPeerID", "peerAudioTrack", "selectAudioTrackByPeerID", "selectPeerAudioByID", "selectConnectionQualityByPeerID", "selectAuxiliaryAudioByPeerID", "isAudio", "selectVideoPlaylistVideoTrackByPeerID", "selectTracksMap", "tracks", "track", "isVideoPlaylist", "isVideo", "selectVideoPlaylistAudioTrackByPeerID", "selectAudioPlaylistTrackByPeerID", "isAudioPlaylist", "selectScreenSharesByPeerId", "getScreenSharesByPeer", "selectScreenShareAudioByPeerID", "id", "createSelector", "selectScreenSharesByPeerId", "screenshare", "selectIsPeerAudioEnabled", "byIDCurry", "store", "peerID", "peer", "selectPeerByIDBare", "isTrackEnabled", "selectIsPeerVideoEnabled", "selectIsAudioLocallyMuted", "trackID", "selectIsLocallyMutedByPeerID", "selectIsScreenShareLocallyMutedByPeerID", "track", "selectAudioTrackVolume", "selectTrackByIDBare", "HMSLogger", "selectAudioVolumeByPeerID", "selectScreenshareAudioVolumeByPeerID", "selectSimulcastLayerByTrack", "selectMessagesByPeerIDInternal", "selectHMSMessages", "selectLocalPeerID", "selectPeerID", "messages", "localPeerID", "message", "_a", "selectMessagesByRoleInternal", "selectRoleName", "roleName", "_b", "selectBroadcastMessages", "selectUnreadMessageCountByRole", "m", "selectUnreadMessageCountByPeerID", "selectBroadcastMessagesUnreadCount", "selectMessagesByPeerID", "selectMessagesByRole", "selectMessagesUnreadCountByRole", "selectMessagesUnreadCountByPeerID", "selectPollByID", "byIDCurry", "selectPollByIDBare", "selectPeersWithAudioStatus", "createSelector", "selectPeersMap", "selectTracksMap", "peersMap", "tracksMap", "peer", "_a", "selectRoleChangeStoreRequest", "store", "selectRoleChangeRequest", "selectRolesMap", "request", "rolesMap", "selectIsAllowedToPublish", "selectLocalPeerRole", "role", "isRoleAllowedToPublish", "selectIsAllowedToPreviewMedia", "selectPreviewRole", "selectLocalVideoPlugins", "createSelector", "selectLocalVideoTrackID", "selectTracksMap", "trackID", "tracksMap", "track", "selectLocalAudioPlugins", "selectLocalAudioTrackID", "ConnectivityState", "ClientAnalyticsTransport", "LocalStorage", "env", "ws", "event", "requestBody", "url", "CLIENT_ANAYLTICS_PROD_ENDPOINT", "CLIENT_ANAYLTICS_QA_ENDPOINT", "response", "error", "HMSLogger", "events", "existingEvents", "existingEvent", "index", "storageEvent", "HTTPAnalyticsTransport", "FeedbackService", "response", "ErrorFactory", "_0", "__async", "token", "eventEndpoint", "info", "feedback", "HMSLogger", "url", "body", "__spreadProps", "__spreadValues", "err", "HMSException", "error", "message", "TransportFailureCategory", "TransportState", "HMSConnectionRole", "selectLocalPeerID", "store", "selectLocalAudioTrackID", "selectLocalVideoTrackID", "selectPeerID", "_store", "peerID", "selectTrackID", "trackID", "selectRemoteTrackStatsMap", "selectPeerStatsMap", "selectLocalTrackStatsMap", "localPeerStats", "createSelector", "storePeerStats", "localPeerID", "packetsLost", "_a", "jitter", "publishBitrate", "subscribeBitrate", "availablePublishBitrate", "availableSubscribeBitrate", "totalBytesSent", "totalBytesReceived", "selectPeerStatsByIDBare", "selectTrackStatsByIDBare", "storeTrackStats", "selectLocalTrackStatsByIDBare", "storeLocalTrackStats", "peerStatsByID", "byIDCurry", "trackStatsByID", "localAudioTrackStats", "trackStats", "localAudioTrackStatsByID", "localVideoTrackStats", "localVideoTrackStatsByID", "HMSRoomState", "selectHLSState", "selectIsConnectedToRoom", "selectPermissions", "selectRecordingState", "selectRoomState", "useHMSActions", "useHMSStore", "useRecordingStreaming", "AlertTriangleIcon", "CrossIcon", "_a", "useRecordingStreaming", "useHMSStore", "selectHLSState", "useMedia", "useRef", "useState", "useCallback", "useEffect", "React", "selectPermissions", "selectRecordingState", "StartRecording", "useHMSActions", "Popover", "selectIsConnectedToRoom", "selectRoomState", "HMSRoomState", "AlertTriangleIcon", "CrossIcon", "React", "useState", "useMedia", "selectLocalPeerName", "useHMSActions", "useHMSStore", "React", "ChevronLeftIcon", "CrossIcon", "React", "ChevronLeftIcon", "CrossIcon", "useHMSActions", "useHMSStore", "selectLocalPeerName", "useState", "useMedia", "React", "useCallback", "selectAppData", "useHMSActions", "useHMSStore", "useHMSVanillaStore", "useHMSStore", "selectAppData", "useHMSActions", "useHMSVanillaStore", "useCallback", "selectAppData", "useEffect", "useState", "useHMSStore", "useState", "useEffect", "MODALS", "useHMSActions", "useHMSStore", "selectPermissions", "selectIsConnectedToRoom", "useRecordingStreaming", "useState", "selectPeerCount", "useRef", "selectIsLocalVideoEnabled", "selectIsTranscriptionAllowedByMode", "HMSTranscriptionMode", "selectIsTranscriptionEnabled", "React", "HamburgerMenuIcon", "CrossIcon", "HandIcon", "ClosedCaptionIcon", "OpenCaptionIcon", "EmojiIcon", "BrbIcon", "SettingsIcon", "RecordIcon", "match", "InfoIcon", "useMedia", "React", "React", "HandIcon", "HandRaiseSlashedIcon", "css", "React", "HandRaiseSlashedIcon", "HandIcon", "React", "Fragment", "selectIsAllowedToPublish", "useHMSStore", "useScreenShare", "React", "Fragment", "useState", "VerticalMenuIcon", "React", "useState", "React", "React", "React", "React", "React", "React", "InfoIcon", "React", "InfoIcon", "React", "useState", "React", "MODALS", "useState", "React", "Fragment", "VerticalMenuIcon", "css", "useHMSStore", "selectIsAllowedToPublish", "useScreenShare", "React", "Fragment", "React", "useEffect", "HMSVirtualBackgroundTypes", "selectAppData", "selectIsLocalVideoEnabled", "useAVToggle", "useHMSActions", "useHMSStore", "VirtualBackgroundIcon", "useHMSStore", "selectIsLocalVideoEnabled", "selectAppData", "useHMSActions", "useAVToggle", "useEffect", "_a", "HMSVirtualBackgroundTypes", "React", "VirtualBackgroundIcon", "React", "selectUnreadHMSMessagesCount", "useHMSStore", "useHMSStore", "selectUnreadHMSMessagesCount", "React", "React", "Fragment", "useCallback", "useState", "useMedia", "HMSPeerType", "selectAvailableRoleNames", "selectHasPeerHandRaised", "selectIsLargeRoom", "selectLocalPeerID", "selectPeerCount", "selectPermissions", "useHMSStore", "AddIcon", "ChangeRoleIcon", "CrossIcon", "HandIcon", "MicOffIcon", "PeopleIcon", "VerticalMenuIcon", "React", "selectConnectionQualityByPeerID", "useHMSStore", "theme", "_a", "useHMSStore", "selectConnectionQualityByPeerID", "theme", "React", "React", "selectLocalPeerID", "selectPermissions", "useHMSActions", "useHMSStore", "PeopleRemoveIcon", "_a", "useHMSStore", "selectPermissions", "selectLocalPeerID", "useHMSActions", "React", "PeopleRemoveIcon", "React", "useEffect", "useHMSStore", "CrossIcon", "React", "useState", "match", "selectPermissions", "selectTracksMap", "useHMSActions", "useHMSStore", "MicOffIcon", "MicOnIcon", "PersonRectangleIcon", "VerticalMenuIcon", "VideoOffIcon", "VideoOnIcon", "useState", "React", "VerticalMenuIcon", "useHMSStore", "selectPermissions", "useHMSActions", "selectTracksMap", "_a", "_b", "PersonRectangleIcon", "match", "MicOffIcon", "MicOnIcon", "VideoOffIcon", "VideoOnIcon", "match", "P", "selectPermissions", "useHMSActions", "useHMSStore", "_a", "useHMSActions", "useHMSStore", "selectPermissions", "match", "P", "data", "_a", "React", "useHMSStore", "useEffect", "a", "b", "CrossIcon", "useEffect", "selectAppData", "useHMSStore", "useHMSStore", "selectAppData", "useEffect", "useState", "selectPeerMetadata", "selectPermissions", "useHMSActions", "useHMSStore", "_a", "_b", "useHMSActions", "useHMSStore", "selectPermissions", "selectPeerMetadata", "useState", "useState", "useHMSStore", "selectIsLargeRoom", "useCallback", "React", "Fragment", "selectPeerCount", "PeopleIcon", "selectLocalPeerID", "_a", "_b", "selectHasPeerHandRaised", "selectPermissions", "HMSPeerType", "HandIcon", "MicOffIcon", "CrossIcon", "AddIcon", "selectAvailableRoleNames", "VerticalMenuIcon", "ChangeRoleIcon", "useMedia", "React", "useEffect", "QuizActiveIcon", "QuizIcon", "useEffect", "React", "QuizActiveIcon", "QuizIcon", "React", "useHMSStore", "useHMSStore", "React", "Footer", "_a", "_b", "useMedia", "useEffect", "React", "React", "useCallback", "useState", "selectHLSState", "useHMSActions", "useHMSStore", "useRecordingStreaming", "useHMSStore", "selectHLSState", "useState", "useHMSActions", "useRecordingStreaming", "useCallback", "React", "React", "useEffect", "selectLocalPeerName", "selectLocalPeerRoleName", "useCustomEvent", "useHMSActions", "useHMSStore", "React", "Fragment", "useCallback", "useEffect", "useMemo", "useState", "useMeasure", "useMedia", "HMSRoomState", "selectAppData", "selectIsLocalVideoEnabled", "selectIsVBEnabled", "selectLocalPeer", "selectRoomState", "selectVideoTrackByID", "useAVToggle", "useAwayNotifications", "useHMSStore", "useParticipants", "useRecordingStreaming", "MicOffIcon", "SettingsIcon", "React", "useEffect", "useMedia", "match", "selectAppData", "selectVideoTrackByPeerID", "useHMSStore", "React", "React", "useEffect", "useMemo", "useRef", "useState", "selectLocalPeerRoleName", "selectPermissions", "selectPolls", "useHMSActions", "useHMSStore", "React", "selectPermissions", "useHMSStore", "ChevronLeftIcon", "ChevronRightIcon", "CrossIcon", "RecordIcon", "React", "ChevronLeftIcon", "CrossIcon", "Container", "React", "React", "React", "useHMSStore", "selectPermissions", "React", "Container", "useHMSActions", "useState", "selectLocalPeerRoleName", "useRef", "useEffect", "useMemo", "selectPolls", "_a", "a", "b", "_b", "React", "useMemo", "useState", "uuid", "useHMSActions", "useHMSStore", "useRecordingStreaming", "AddCircleIcon", "React", "useCallback", "useRef", "useState", "TrashIcon", "React", "AlertTriangleIcon", "CrossIcon", "React", "AlertTriangleIcon", "CrossIcon", "React", "React", "React", "CheckIcon", "React", "TrashIcon", "React", "TrashIcon", "React", "React", "React", "React", "React", "_a", "CheckIcon", "Label", "React", "CheckCircleIcon", "React", "CheckCircleIcon", "Label", "_a", "useRef", "useState", "useCallback", "index", "text", "options", "React", "TrashIcon", "React", "useMemo", "CheckCircleIcon", "_a", "useMemo", "React", "index", "CheckCircleIcon", "uuid", "_a", "_b", "useHMSActions", "useRecordingStreaming", "useHMSStore", "useState", "useMemo", "React", "Container", "question", "AddCircleIcon", "React", "useState", "selectPollByID", "useHMSStore", "ChevronLeftIcon", "ChevronRightIcon", "CrossIcon", "React", "CheckCircleIcon", "React", "CheckCircleIcon", "React", "selectLocalPeerID", "useHMSStore", "React", "React", "useEffect", "useState", "selectPollByID", "useHMSActions", "useHMSStore", "useHMSActions", "useHMSStore", "selectPollByID", "useState", "useEffect", "_a", "useHMSStore", "selectLocalPeerID", "React", "_a", "_a", "_b", "useHMSStore", "selectPollByID", "useState", "React", "Container", "ChevronLeftIcon", "CrossIcon", "ChevronRightIcon", "React", "useEffect", "useRef", "useState", "selectLocalPeer", "selectPeerNameByID", "selectPermissions", "selectPollByID", "useHMSActions", "useHMSStore", "ChevronLeftIcon", "CrossIcon", "React", "React", "useCallback", "useEffect", "useMemo", "useRef", "useState", "match", "selectLocalPeer", "selectLocalPeerRoleName", "useHMSActions", "useHMSStore", "CheckCircleIcon", "ChevronDownIcon", "CrossCircleIcon", "QuestionCard", "useHMSActions", "useHMSStore", "selectLocalPeer", "selectLocalPeerRoleName", "useState", "useEffect", "useRef", "useMemo", "useCallback", "React", "match", "respondedToQuiz", "isLive", "isCorrectAnswer", "pollEnded", "CheckCircleIcon", "CrossCircleIcon", "ChevronDownIcon", "_a", "React", "QuestionCard", "React", "useEffect", "useState", "_a", "_b", "useState", "useEffect", "React", "QuestionCard", "useHMSActions", "useHMSStore", "selectPollByID", "selectPeerNameByID", "selectPermissions", "useRef", "useState", "selectLocalPeer", "useEffect", "_a", "_b", "React", "Container", "ChevronLeftIcon", "CrossIcon", "React", "React", "CrossIcon", "React", "useEffect", "useState", "useHMSStore", "useHMSStore", "React", "_a", "useState", "useEffect", "React", "React", "useEffect", "useState", "useState", "useEffect", "React", "React", "React", "CrossIcon", "React", "useEffect", "useState", "useMedia", "match", "selectPeerCount", "useHMSStore", "CrossIcon", "React", "useCallback", "useRef", "useMedia", "match", "useHMSActions", "useHMSStore", "useHMSVanillaStore", "ChevronDownIcon", "React", "useCallback", "useEffect", "useRef", "useState", "useMedia", "data", "selectLocalPeer", "useHMSActions", "useHMSStore", "EmojiIcon", "PauseCircleIcon", "SendIcon", "VerticalMenuIcon", "React", "useState", "useMedia", "ChevronDownIcon", "ChevronUpIcon", "CrossIcon", "PersonIcon", "React", "useMemo", "useState", "useMedia", "HMSPeerType", "selectRemotePeers", "selectUnreadHMSMessagesCount", "useHMSStore", "CheckIcon", "PeopleIcon", "React", "useMedia", "Root", "_a", "_b", "CheckIcon", "useHMSStore", "selectUnreadHMSMessagesCount", "PeopleIcon", "useMemo", "HMSPeerType", "selectRemotePeers", "useState", "_a", "_b", "useState", "useMedia", "React", "PersonIcon", "ChevronUpIcon", "ChevronDownIcon", "CrossIcon", "useCallback", "selectAppData", "useHMSActions", "useHMSStore", "useHMSActions", "useHMSStore", "selectAppData", "useCallback", "useEffect", "useRef", "_a", "_b", "TextArea", "useState", "React", "Popover", "EmojiIcon", "data", "_a", "_b", "useHMSActions", "useRef", "useMedia", "useHMSStore", "selectLocalPeer", "useEffect", "useCallback", "VerticalMenuIcon", "PauseCircleIcon", "SendIcon", "React", "useCallback", "selectLocalPeer", "selectSessionStore", "useHMSActions", "useHMSStore", "_a", "_b", "useHMSActions", "useHMSStore", "selectSessionStore", "selectLocalPeer", "useCallback", "React", "React", "useEffect", "useState", "useMedia", "selectSessionStore", "useHMSStore", "PinIcon", "React", "ChevronDownIcon", "ChevronUpIcon", "React", "ChevronUpIcon", "ChevronDownIcon", "React", "React", "_a", "_b", "useHMSStore", "selectSessionStore", "useState", "useMedia", "useEffect", "React", "PinIcon", "_a", "_b", "useRef", "useHMSActions", "useHMSVanillaStore", "useHMSStore", "useMedia", "useCallback", "React", "match", "ChevronDownIcon", "React", "useEffect", "useState", "useMeasure", "VariableSizeList", "selectIsConnectedToRoom", "useHMSStore", "usePaginatedParticipants", "ChevronLeftIcon", "CrossIcon", "useState", "useEffect", "React", "VirtualizedParticipantItem", "data", "usePaginatedParticipants", "_a", "useHMSStore", "selectIsConnectedToRoom", "useMeasure", "ChevronLeftIcon", "CrossIcon", "search", "VariableSizeList", "React", "selectLocalPeer", "selectSessionStore", "useHMSActions", "useHMSStore", "PauseCircleIcon", "SettingsIcon", "_a", "_b", "useHMSActions", "useHMSStore", "selectLocalPeer", "selectSessionStore", "React", "Popover", "SettingsIcon", "PauseCircleIcon", "ParticipantCount", "React", "_a", "_b", "useState", "useHMSStore", "selectPeerCount", "useMedia", "useEffect", "match", "CrossIcon", "React", "useCallback", "useMemo", "useState", "useMeasure", "selectAudioTrackByPeerID", "selectHasPeerHandRaised", "selectIsPeerAudioEnabled", "selectLocalPeerID", "selectPeerMetadata", "selectPeerNameByID", "selectVideoTrackByID", "selectVideoTrackByPeerID", "useHMSStore", "HandIcon", "MicOffIcon", "React", "HMSPeerType", "selectPeerTypeByID", "selectSessionStore", "useHMSStore", "CallIcon", "PinIcon", "ShareScreenIcon", "useHMSStore", "selectSessionStore", "selectPeerTypeByID", "React", "Wrapper", "HMSPeerType", "CallIcon", "ShareScreenIcon", "PinIcon", "React", "useState", "useMedia", "selectLocalPeerID", "selectPeerByID", "selectPermissions", "selectTrackByID", "selectVideoTrackByPeerID", "useHMSStore", "useRemoteAVToggle", "CrossIcon", "VerticalMenuIcon", "React", "Fragment", "useMedia", "selectAvailableRoleNames", "selectPermissions", "selectSessionStore", "selectTrackByID", "useCustomEvent", "useHMSActions", "useHMSStore", "MicOffIcon", "MicOnIcon", "PersonSettingsIcon", "PinIcon", "RemoveUserIcon", "ShareScreenIcon", "SpeakerIcon", "StarIcon", "VideoOffIcon", "VideoOnIcon", "useHMSActions", "useHMSStore", "selectSessionStore", "React", "StarIcon", "PinIcon", "_a", "selectTrackByID", "Fragment", "selectPermissions", "selectAvailableRoleNames", "useCustomEvent", "useMedia", "VideoOnIcon", "VideoOffIcon", "MicOnIcon", "MicOffIcon", "PersonSettingsIcon", "SpeakerIcon", "RemoveUserIcon", "ShareScreenIcon", "_a", "_b", "useState", "theme", "useHMSStore", "selectLocalPeerID", "selectPermissions", "useRemoteAVToggle", "selectVideoTrackByPeerID", "selectTrackByID", "useMedia", "selectPeerByID", "React", "VerticalMenuIcon", "CrossIcon", "useHMSStore", "selectPeerMetadata", "selectHasPeerHandRaised", "React", "HandIcon", "selectVideoTrackByID", "selectVideoTrackByPeerID", "selectPeerNameByID", "selectAudioTrackByPeerID", "selectLocalPeerID", "selectIsPeerAudioEnabled", "useState", "useCallback", "useMeasure", "useMemo", "MicOffIcon", "React", "useEffect", "useRef", "useState", "useMedia", "HMSVirtualBackgroundTypes", "HMSRoomState", "selectIsLargeRoom", "selectIsLocalVideoEnabled", "selectLocalPeer", "selectRoomState", "selectVideoTrackByID", "useHMSActions", "useHMSStore", "CrossCircleIcon", "CrossIcon", "React", "HMSVirtualBackgroundTypes", "React", "Root", "React", "Title", "Icon", "React", "HMSVirtualBackgroundTypes", "_a", "useHMSActions", "useHMSStore", "selectLocalPeer", "selectIsLocalVideoEnabled", "selectVideoTrackByID", "useState", "selectRoomState", "selectIsLargeRoom", "useMedia", "useRef", "HMSRoomState", "useEffect", "HMSVirtualBackgroundTypes", "React", "CrossIcon", "CrossCircleIcon", "Wrapper", "_a", "_b", "useMedia", "useHMSStore", "selectAppData", "selectVideoTrackByPeerID", "match", "React", "useEffect", "React", "React", "css", "React", "css", "React", "React", "useMedia", "JoinForm_JoinBtnType", "useRecordingStreaming", "_a", "_b", "useMedia", "useRecordingStreaming", "JoinForm_JoinBtnType", "React", "useHMSStore", "selectLocalPeer", "selectVideoTrackByID", "useMedia", "useRecordingStreaming", "useState", "useAVToggle", "useParticipants", "selectAppData", "useAwayNotifications", "selectRoomState", "useCallback", "useEffect", "HMSRoomState", "React", "Container", "selectIsLocalVideoEnabled", "useMeasure", "useMemo", "MicOffIcon", "selectIsVBEnabled", "Fragment", "SettingsIcon", "React", "useMedia", "useMedia", "React", "useHMSActions", "useHMSStore", "selectLocalPeerRoleName", "selectLocalPeerName", "useCustomEvent", "useEffect", "React", "_a", "React", "useEffect", "useState", "useMedia", "match", "selectIsConnectedToRoom", "selectIsLocalScreenShared", "selectLocalPeerRoleName", "useHMSActions", "useHMSStore", "PeopleAddIcon", "ShareScreenIcon", "React", "useEffect", "useMemo", "useState", "selectLocalPeerID", "selectLocalPeerRoleName", "selectPeers", "selectPeerScreenSharing", "selectWhiteboard", "useHMSStore", "useHMSVanillaStore", "React", "useEffect", "useState", "useMedia", "PeopleAddIcon", "React", "React", "React", "useEffect", "useRef", "useMedia", "selectIsAllowedToPublish", "selectLocalPeer", "selectPeerByID", "selectVideoTrackByID", "useHMSStore", "ExpandIcon", "React", "useContext", "React", "ExpandIcon", "useMedia", "selectPeerByID", "selectLocalPeer", "useHMSStore", "selectVideoTrackByID", "selectIsAllowedToPublish", "useRef", "useEffect", "React", "useEffect", "ChevronLeftIcon", "ChevronRightIcon", "useEffect", "React", "ChevronLeftIcon", "ChevronRightIcon", "React", "React", "_a", "_b", "useEffect", "useMemo", "useState", "useMeasure", "useMedia", "selectTracksMap", "useHMSVanillaStore", "useHMSVanillaStore", "selectTracksMap", "useMemo", "useMeasure", "useMedia", "useState", "useEffect", "j", "h", "_a", "useMedia", "useState", "useEffect", "React", "page", "PeopleAddIcon", "React", "useEffect", "useState", "useMedia", "selectLocalPeer", "useHMSStore", "React", "useEffect", "useRef", "useState", "useMedia", "selectAppData", "selectSessionStore", "selectTrackByID", "useHMSStore", "React", "Root", "React", "css", "_a", "_b", "_a", "_b", "useMedia", "useState", "useHMSStore", "selectAppData", "selectSessionStore", "selectTrackByID", "useRef", "useEffect", "React", "page", "useMemo", "useMemo", "_a", "useHMSStore", "selectLocalPeer", "useMedia", "useState", "useEffect", "React", "page", "React", "useEffect", "useMemo", "useState", "useMedia", "useHMSStore", "React", "useRef", "useState", "useFullscreen", "useMedia", "screenfull", "selectLocalPeerID", "selectPeerByID", "selectScreenShareByPeerID", "useHMSStore", "ExpandIcon", "ShrinkIcon", "React", "useCallback", "useState", "CheckIcon", "ChevronDownIcon", "ChevronUpIcon", "useState", "useCallback", "React", "Popover", "ChevronUpIcon", "ChevronDownIcon", "CheckIcon", "React", "useHMSActions", "CrossIcon", "ShareScreenIcon", "useHMSActions", "React", "ShareScreenIcon", "CrossIcon", "Tile", "useHMSStore", "selectLocalPeerID", "selectScreenShareByPeerID", "theme", "selectPeerByID", "useState", "useMedia", "useRef", "useFullscreen", "screenfull", "React", "ShrinkIcon", "ExpandIcon", "_a", "useHMSStore", "useState", "useMedia", "useMemo", "useEffect", "React", "React", "useEffect", "useMemo", "useMedia", "useHMSStore", "useWhiteboard", "useMedia", "useWhiteboard", "React", "useHMSStore", "useMemo", "useEffect", "selectDominantSpeaker", "_a", "useHMSStore", "selectPeerScreenSharing", "selectWhiteboard", "selectPeers", "selectLocalPeerRoleName", "selectLocalPeerID", "useMemo", "useHMSVanillaStore", "useState", "useEffect", "React", "React", "useEffect", "useMemo", "selectAppData", "selectPeers", "selectPeerScreenSharing", "useHMSStore", "React", "useHMSStore", "selectPeers", "selectPeerScreenSharing", "useMemo", "smallTilePeers", "useEffect", "selectAppData", "React", "useEffect", "useEffect", "React", "React", "useEffect", "useRef", "useState", "Draggable", "useMedia", "selectIsTranscriptionEnabled", "selectPeerNameByID", "useHMSStore", "data", "_a", "useHMSStore", "selectPeerNameByID", "React", "useMedia", "useState", "selectIsTranscriptionEnabled", "useRef", "useEffect", "Draggable", "useEffect", "selectPeerScreenSharing", "useHMSStore", "useWhiteboard", "React", "_a", "useHMSStore", "selectLocalPeerRoleName", "selectIsConnectedToRoom", "selectIsLocalScreenShared", "useHMSActions", "useMedia", "useState", "useEffect", "match", "isNotAllowedToPublish", "hasSubscribedRolePublishing", "PeopleAddIcon", "isScreenOnlyPublishParams", "isSharingScreen", "ShareScreenIcon", "pdfAnnotatorActive", "urlToIframe", "React", "useMedia", "HMSRoomState", "selectRoomState", "useHMSStore", "React", "useMedia", "ChevronRightIcon", "useMedia", "React", "ChevronRightIcon", "React", "DeviceType", "selectIsLocalVideoEnabled", "selectLocalVideoTrackID", "selectVideoTrackByID", "useDevices", "useHMSActions", "useHMSStore", "CameraFlipIcon", "CheckIcon", "CrossIcon", "SpeakerIcon", "useHMSActions", "useDevices", "useHMSStore", "selectIsLocalVideoEnabled", "selectLocalVideoTrackID", "selectVideoTrackByID", "React", "CameraFlipIcon", "SpeakerIcon", "DeviceType", "CrossIcon", "Label", "CheckIcon", "Header", "useHMSStore", "selectRoomState", "useMedia", "HMSRoomState", "React", "useEffect", "selectLocalPeerRoleName", "useHMSVanillaStore", "useHMSVanillaStore", "useEffect", "selectLocalPeerRoleName", "_a", "_b", "useHMSStore", "selectRoomState", "selectIsConnectedToRoom", "useHMSActions", "useState", "selectAppData", "useRef", "useAwayNotifications", "useEffect", "HMSRoomState", "uuid", "React", "Header", "Footer", "React", "CopyIcon", "React", "CopyIcon", "React", "useEffect", "useEffect", "useHMSStore", "useHMSStore", "useEffect", "useEffect", "_a", "React", "useEffect", "selectAppData", "selectIsLocalAudioEnabled", "selectIsLocalVideoEnabled", "useHMSActions", "useHMSVanillaStore", "selectIsLocalAudioEnabled", "selectIsLocalVideoEnabled", "selectAppData", "useHMSVanillaStore", "useHMSActions", "useEffect", "React", "ExitIcon", "React", "useState", "useMedia", "React", "useState", "useMedia", "useHMSActions", "CheckIcon", "CrossIcon", "useMedia", "React", "useHMSActions", "useState", "_a", "_b", "CrossIcon", "CheckIcon", "Label", "React", "useMedia", "useMedia", "React", "useState", "useMedia", "a", "b", "React", "React", "Header", "ExitIcon", "React", "useEffect", "useState", "useMedia", "match", "P", "useState", "useMedia", "useEffect", "_a", "match", "P", "angle", "type", "React", "React", "useCallback", "useEffect", "HMSNotificationTypes", "HMSRoomState", "selectIsLocalScreenShared", "selectLocalPeerID", "selectPeerNameByID", "selectRoomState", "useAwayNotifications", "useCustomEvent", "useHMSNotifications", "useHMSStore", "useHMSVanillaStore", "GroupIcon", "React", "React", "React", "useEffect", "uuid", "selectLocalPeerID", "selectSessionStore", "useHMSStore", "ChatIcon", "useHMSStore", "selectSessionStore", "selectLocalPeerID", "useEffect", "_a", "_b", "uuid", "React", "ChatIcon", "useEffect", "useDebounce", "HMSNotificationTypes", "HMSRoomState", "selectHandRaisedPeers", "selectHasPeerHandRaised", "selectIsLocalScreenShared", "selectPeerByID", "selectRoomState", "useAwayNotifications", "useHMSNotifications", "useHMSStore", "useHMSVanillaStore", "React", "useCallback", "selectPeerByID", "useHMSActions", "useHMSStore", "ChatUnreadIcon", "HandIcon", "PeopleAddIcon", "PeopleRemoveIcon", "PoorConnectivityIcon", "React", "_a", "_b", "useHMSActions", "useHMSStore", "selectPeerByID", "useCallback", "PeopleAddIcon", "PeopleRemoveIcon", "HandIcon", "ChatUnreadIcon", "PoorConnectivityIcon", "_a", "_b", "useHMSNotifications", "HMSNotificationTypes", "useHMSStore", "selectRoomState", "useHMSVanillaStore", "selectIsLocalScreenShared", "useAwayNotifications", "useEffect", "HMSRoomState", "selectHasPeerHandRaised", "selectPeerByID", "useDebounce", "selectHandRaisedPeers", "React", "useEffect", "useState", "HMSNotificationTypes", "useHMSNotifications", "useHMSNotifications", "HMSNotificationTypes", "useState", "useEffect", "data", "React", "useEffect", "HMSNotificationTypes", "useHMSNotifications", "HMSNotificationTypes", "useHMSNotifications", "useEffect", "React", "useEffect", "useState", "useMedia", "HMSNotificationTypes", "useHMSNotifications", "useHMSNotifications", "HMSNotificationTypes", "React", "useState", "useMedia", "useEffect", "useEffect", "useRef", "HMSNotificationTypes", "useHMSNotifications", "notificationTypes", "HMSNotificationTypes", "useHMSNotifications", "useRef", "useEffect", "_a", "_b", "React", "useEffect", "useState", "HMSNotificationTypes", "useHMSActions", "useHMSNotifications", "MicOnIcon", "useHMSActions", "useState", "useHMSNotifications", "HMSNotificationTypes", "useEffect", "React", "MicOnIcon", "useEffect", "HMSNotificationTypes", "useHMSNotifications", "notificationTypes", "React", "useEffect", "useState", "HMSNotificationTypes", "useHMSActions", "useHMSNotifications", "MicOnIcon", "useHMSActions", "useHMSNotifications", "HMSNotificationTypes", "useState", "useEffect", "React", "MicOnIcon", "React", "useEffect", "match", "HMSNotificationTypes", "useHMSNotifications", "AlertTriangleIcon", "ClosedCaptionIcon", "OpenCaptionIcon", "useHMSNotifications", "HMSNotificationTypes", "useEffect", "match", "React", "AlertTriangleIcon", "ClosedCaptionIcon", "OpenCaptionIcon", "_a", "_b", "useHMSStore", "selectLocalPeerID", "useHMSNotifications", "selectRoomState", "useHMSVanillaStore", "useAwayNotifications", "selectIsLocalScreenShared", "useCallback", "useCustomEvent", "useEffect", "_n", "_o", "HMSNotificationTypes", "React", "GroupIcon", "selectPeerNameByID", "HMSRoomState", "React", "useCallback", "useMemo", "useState", "useState", "useCallback", "useMemo", "React", "React", "_a", "_b", "React", "React", "useEffect", "useState", "selectIsConnectedToRoom", "useHMSStore", "React", "Toast", "_a", "_b", "React", "useHMSStore", "selectIsConnectedToRoom", "useState", "useEffect", "React", "Toast", "React", "selectAppData", "useHMSStore", "React", "CrossIcon", "React", "CrossIcon", "Sheet", "useHMSStore", "selectAppData", "React", "React", "useCallback", "useEffect", "useMemo", "useState", "useMedia", "selectIsLargeRoom", "selectLocalPeerID", "selectPeerNameByID", "useCustomEvent", "useHMSActions", "useHMSStore", "useHMSVanillaStore", "useHMSStore", "selectLocalPeerID", "useHMSVanillaStore", "useHMSActions", "useState", "useMedia", "selectIsLargeRoom", "useMemo", "useCallback", "selectPeerNameByID", "emojis", "useCustomEvent", "useEffect", "React", "React", "useCallback", "useCustomEvent", "useHMSActions", "useHMSActions", "useCallback", "useCustomEvent", "React", "useCallback", "useEffect", "useRef", "selectIsConnectedToRoom", "selectPermissions", "useHMSActions", "useHMSStore", "useRecordingStreaming", "useHMSStore", "selectPermissions", "useHMSActions", "selectIsConnectedToRoom", "useRecordingStreaming", "useRef", "useCallback", "useEffect", "React", "_a", "_b", "useRef", "useEffect", "data", "theme", "typography", "match", "useHMSStore", "selectIsConnectedToRoom", "useHMSActions", "Sheet", "Indicator", "Root", "Indicator", "StyledRoot", "Root", "React", "useCallback", "useRef", "useState", "HMSRoomProvider", "useHMSActions", "CheckCircleIcon", "ConnectivityIcon", "CrossCircleIcon", "MicOnIcon", "VideoOnIcon", "React", "useCallback", "useEffect", "useState", "selectLocalAudioTrackID", "selectTrackAudioByID", "useHMSActions", "useHMSStore", "MicOnIcon", "SpeakerIcon", "StopIcon", "React", "React", "useContext", "DiagnosticsStep", "React", "useContext", "css", "React", "React", "useRef", "useState", "DeviceSelector", "_a", "_b", "useState", "useRef", "React", "PropTypes", "React", "_a", "_b", "useHMSStore", "useState", "selectLocalAudioTrackID", "selectTrackAudioByID", "DeviceSelector", "MicOnIcon", "StopIcon", "SpeakerIcon", "useHMSActions", "useCallback", "useEffect", "error", "React", "useEffect", "useState", "parsedUserAgent", "React", "_a", "_b", "useState", "useEffect", "parsedUserAgent", "React", "useState", "CheckCircleIcon", "CrossCircleIcon", "EyeCloseIcon", "EyeOpenIcon", "useState", "React", "CheckCircleIcon", "CrossCircleIcon", "EyeOpenIcon", "EyeCloseIcon", "Icon", "_a", "_b", "Footer", "result", "error", "a", "React", "useEffect", "useState", "selectDevices", "selectLocalMediaSettings", "selectLocalVideoTrackID", "useHMSStore", "VideoOnIcon", "useHMSStore", "selectDevices", "selectLocalVideoTrackID", "selectLocalMediaSettings", "useState", "useEffect", "React", "DeviceSelector", "VideoOnIcon", "React", "VideoOnIcon", "MicOnIcon", "ConnectivityIcon", "Container", "CheckCircleIcon", "CrossCircleIcon", "useHMSActions", "useState", "useRef", "useCallback", "HMSRoomProvider"]
}
